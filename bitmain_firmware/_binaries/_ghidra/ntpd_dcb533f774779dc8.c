// Decompiled: ntpd_dcb533f774779dc8

void _DT_INIT(void)

{
    FUN_0001c7cc();
    return;
}

void FUN_0001c270(int param_1, uint param_2, uint param_3, uint param_4)

{
    byte bVar1;
    undefined4 uVar2;
    int iVar3;
    int iVar4;
    int iVar5;
    uint uVar6;
    bool bVar7;
    uint local_884;
    uint local_880;
    int local_87c;
    uint local_878;
    byte local_874;
    char local_873;
    byte local_872;
    undefined1 local_871;
    uint local_870;
    uint local_86c;
    undefined4 local_868;
    uint local_864;
    uint local_860;
    uint local_85c;
    uint uStack_858;
    uint local_854;
    uint local_850;
    uint local_84c;
    uint local_848;
    int local_2c;

    iVar4 = param_1 + 4;
    local_2c = __stack_chk_guard;
    if ((*(uint *)(*(int *)(param_1 + 0x3c) + 0x90) & 0x40) != 0) {
        uVar2 = FUN_00027b78(iVar4);
        *(undefined4 *)(param_1 + 0x3c) = uVar2;
    }
    bVar1 = *(byte *)(param_1 + 0x5a);
    local_872 = ntp_minpoll;
    if ((param_4 & 0x800) == 0) {
        local_874 = *(byte *)(param_1 + 0x58) & 0x38 | (byte)(param_2 & 7) |
                    xmt_leap << 6;
        local_873 = sys_stratum;
        if (sys_stratum == '\x10') {
            local_873 = '\0';
        }
        if (ntp_minpoll < bVar1) {
            local_872 = bVar1;
        }
        local_871 = sys_precision;
        local_85c = *(uint *)(param_1 + 0x80);
        uStack_858 = *(uint *)(param_1 + 0x84);
        local_868 = sys_refid;
        uVar6 = *(uint *)(param_1 + 0x48);
        local_854 = uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10 |
                    (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18;
        uVar6 = *(uint *)(param_1 + 0x4c);
        local_850 = uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10 |
                    (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18;
        uVar6 = (uint)(longlong)(sys_rootdelay * 65536.0);
        local_870 = uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10 |
                    (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18;
        uVar6 = (uint)(0.0 < sys_rootdisp * 65536.0) *
                (int)(longlong)(sys_rootdisp * 65536.0);
        local_86c = uVar6 * 0x1000000 | (uVar6 >> 8 & 0xff) << 0x10 |
                    (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18;
        local_860 = sys_reftime._4_4_ << 0x18 |
                    (sys_reftime._4_4_ >> 8 & 0xff) << 0x10 |
                    (sys_reftime._4_4_ >> 0x10 & 0xff) << 8 |
                    sys_reftime._4_4_ >> 0x18;
        local_864 = (uint)sys_reftime << 0x18 |
                    ((uint)sys_reftime >> 8 & 0xff) << 0x10 |
                    ((uint)sys_reftime >> 0x10 & 0xff) << 8 |
                    (uint)sys_reftime >> 0x18;
        FUN_0007055c(&local_884);
        local_84c = local_884 << 0x18 | (local_884 >> 8 & 0xff) << 0x10 |
                    (local_884 >> 0x10 & 0xff) << 8 | local_884 >> 0x18;
        local_848 = local_880 << 0x18 | (local_880 >> 8 & 0xff) << 0x10 |
                    (local_880 >> 0x10 & 0xff) << 8 | local_880 >> 0x18;
    } else {
        local_864 = *(uint *)(param_1 + 0x68);
        local_860 = *(uint *)(param_1 + 0x6c);
        if (ntp_minpoll < bVar1) {
            local_872 = bVar1;
        }
        local_85c = *(uint *)(param_1 + 0x80);
        uStack_858 = *(uint *)(param_1 + 0x84);
        local_874 =
            ~((byte) ~(byte)(((*(byte *)(param_1 + 0x58) & 0x38 | param_2 & 7)
                              << 0x1a) >>
                             0x18) >>
              2);
        local_870 = *(uint *)(param_1 + 0x5c);
        local_868 = 0x45544152;
        local_871 = *(undefined1 *)(param_1 + 0x5b);
        local_86c = *(uint *)(param_1 + 0x60);
        sys_kodsent = sys_kodsent + 1;
        local_873 = '\0';
        local_854 = local_85c;
        local_850 = uStack_858;
        local_84c = local_85c;
        local_848 = uStack_858;
    }
    if (*(int *)(param_1 + 0x54) == 0x30) {
        FUN_00026cc0(iVar4, *(undefined4 *)(param_1 + 0x3c), 0, &local_874,
                     0x30);
    } else {
        if (param_3 < 0x10000) {
            iVar5 = 0x30;
        } else {
            uVar2 = FUN_00037700(iVar4, *(int *)(param_1 + 0x3c) + 0x18, 0,
                                 sys_private, 0);
            if (*(uint *)(param_1 + 0x54) < 0x49) {
                iVar5 = 0x30;
                FUN_00037700(*(int *)(param_1 + 0x3c) + 0x18, iVar4, param_3,
                             uVar2, 2);
            } else {
                FUN_00037700(*(int *)(param_1 + 0x3c) + 0x18, iVar4, param_3, 0,
                             2);
                *(uint *)(param_1 + 0x88) = *(uint *)(param_1 + 0x88) | 0x80;
                iVar5 = FUN_00039b24(0, &local_874, param_1, 0x30,
                                     (uint *)(param_1 + 0x88), uVar2);
                iVar5 = iVar5 + 0x30;
            }
        }
        FUN_0007055c(&local_884);
        iVar3 = FUN_000736a4(param_3, &local_874, iVar5);
        if (0xffff < param_3) {
            FUN_000730c4(param_3, 0);
        }
        FUN_00026cc0(iVar4, *(undefined4 *)(param_1 + 0x3c), 0, &local_874,
                     iVar3 + iVar5);
        FUN_0007055c(&local_87c);
        sys_authdelay._4_4_ = local_878 - local_880;
        local_87c = local_87c - local_884;
        bVar7 = local_878 < sys_authdelay._4_4_;
        local_878 = sys_authdelay._4_4_;
        sys_authdelay._0_4_ = local_87c;
        if (bVar7) {
            local_87c = local_87c + -1;
            sys_authdelay._0_4_ = local_87c;
        }
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0001c658(char *param_1, char *param_2)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if (param_1 == (char *)0x0) {
        iVar2 = 0;
    } else {
        iVar2 = strcmp(param_1, sys_groupname);
        if (iVar2 != 0) {
            if (param_2 == (char *)0x0) {
                iVar2 = 1;
            } else {
                iVar2 = strcmp(param_1, param_2);
                if (iVar2 != 0) {
                    iVar2 = 1;
                }
            }
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar2);
    }
    return;
}

void FUN_0001c6f0(void)

{
    int *piVar1;

    piVar1 = __errno_location();
    FUN_00075d40(3, "read system clock failed: %m (%d)", *piVar1);
    /* WARNING: Subroutine does not return */
    exit(1);
}

/* WARNING: Removing unreachable block (ram,0x0001c778) */

void main(int param_1, undefined4 *param_2)

{
    undefined4 *puVar1;
    int iVar2;
    __mode_t __mask;
    size_t sVar3;
    __uid_t _Var4;
    undefined4 uVar5;
    int *piVar6;
    pthread_t pVar7;
    __pid_t _Var8;
    pthread_t pVar9;
    time_t tVar10;
    time_t tVar11;
    int iVar12;
    int *piVar13;
    undefined4 extraout_r1;
    uint uVar14;
    code *pcVar15;
    char *pcVar16;
    int iVar17;
    int __status;
    int __nfds;
    undefined4 local_4d4;
    undefined4 *local_4d0;
    int local_4cc[2];
    int local_4c4;
    int local_4c0;
    timeval local_4bc;
    int local_4b4;
    int local_4b0;
    pthread_attr_t local_4ac[3];
    int iStack_430;
    char acStack_42c[1024];
    undefined4 local_2c[2];

    local_2c[0] = __stack_chk_guard;
    local_4d0 = param_2;
    local_4cc[0] = param_1;
    pthread_attr_init(local_4ac);
    iVar2 = pthread_attr_setstacksize(local_4ac, 0x8000);
    if (iVar2 != 0) {
        pcVar16 = strerror(iVar2);
        FUN_00075d40(3, "my_pthread_warmup: pthread_attr_setstacksize() -> %s",
                     pcVar16);
    }
    iVar2 = pthread_create((pthread_t *)&local_4bc, local_4ac,
                           (__start_routine *)&DAT_0002d458, (void *)0x0);
    pthread_attr_destroy(local_4ac);
    if (iVar2 == 0) {
        pthread_cancel(local_4bc.tv_sec);
        pthread_join(local_4bc.tv_sec, (void **)0x0);
    } else {
        pcVar16 = strerror(iVar2);
        FUN_00075d40(3, "my_pthread_warmup: pthread_create() -> %s", pcVar16);
    }
    __mask = umask(0);
    if (__mask == 0) {
        __mask = 0x12;
    }
    umask(__mask);
    saved_argc = local_4cc[0];
    saved_argv = local_4d0;
    progname = *local_4d0;
    initializing = 1;
    FUN_0002d48c(local_4cc, &local_4d0);
    if ((((*(uint *)(ntpdOptions._68_4_ + 0x450) & 0xf) != 0) ||
         ((*(uint *)(ntpdOptions._68_4_ + 0x550) & 0xf) != 0)) ||
        ((*(uint *)(ntpdOptions._68_4_ + 0x5d0) & 0xf) != 0)) {
        nofork = 1;
    }
    FUN_00075e3c(progname, 0xf000, 1);
    if ((*(uint *)(ntpdOptions._68_4_ + 0x390) & 0xf) == 0) {
        if (nofork != 0) {
            msyslog_term = 1;
        }
        if ((*(uint *)(ntpdOptions._68_4_ + 0x5d0) & 0xf) == 0) {
            local_4d4 = 0;
        } else {
            local_4d4 = 0;
            syslogit = 0;
        }
    } else {
        local_4d4 = *(undefined4 *)(ntpdOptions._68_4_ + 0x398);
        syslogit = 0;
        FUN_00075f28(local_4d4, 0);
    }
    FUN_00075d40(5, "%s: Starting", Version);
    FUN_0007d00c(acStack_42c, 0x400, "Command line:");
    sVar3 = strlen(acStack_42c);
    pcVar16 = acStack_42c + sVar3;
    if (0 < saved_argc) {
        iVar2 = 0;
        do {
            puVar1 = saved_argv + iVar2;
            iVar2 = iVar2 + 1;
            FUN_0007d00c(pcVar16, (int)local_2c - (int)pcVar16, " %s", *puVar1);
            sVar3 = strlen(pcVar16);
            pcVar16 = pcVar16 + sVar3;
        } while (iVar2 < saved_argc);
    }
    FUN_00075d40(6, "%s", acStack_42c);
    FUN_0007fc94(&LAB_0002d3d4);
    FUN_00080468(&LAB_0002d32c);
    FUN_000803ec(&LAB_0002d24c);
    _Var4 = getuid();
    if (_Var4 == 0) {
        uVar14 = *(uint *)(ntpdOptions._68_4_ + 0x3d0);
    } else {
        if ((*(uint *)(ntpdOptions._68_4_ + 0x5d0) & 0xf) == 0) {
            msyslog_term = 1;
            FUN_00075d40(3, "must be run as root, not uid %ld");
            /* WARNING: Subroutine does not return */
            exit(1);
        }
        uVar14 = *(uint *)(ntpdOptions._68_4_ + 0x3d0);
    }
    if ((uVar14 & 0xf) != 0) {
        listen_to_virtual_ips = 0;
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x310) & 0xf) != 0) {
        iVar2 = **(int **)(ntpdOptions._68_4_ + 0x31c);
        iVar17 = iVar2 + -1;
        piVar6 = *(int **)(ntpdOptions._68_4_ + 0x31c) + 2;
        if (0 < iVar2) {
            do {
                iVar17 = iVar17 + -1;
                iVar2 = FUN_00074fd8(*piVar6, 0, local_4ac);
                if (iVar2 == 0) {
                    uVar5 = 4;
                } else {
                    uVar5 = 5;
                }
                FUN_00026060(uVar5, *piVar6, 0xffffffff);
                piVar6 = piVar6 + 1;
            } while (iVar17 != -1);
        }
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x490) & 0xf) != 0) {
        priority_done = 0;
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x510) & 0xf) != 0) {
        config_priority = *(pthread_t *)(ntpdOptions._68_4_ + 0x518);
        config_priority_override = 1;
        priority_done = 0;
    }
    local_4b4 = -1;
    local_4b0 = -1;
    if ((*(uint *)(ntpdOptions._68_4_ + 0x790) & 0xf) == 0) {
        iVar2 = 0;
    } else {
        iVar2 = *(int *)(ntpdOptions._68_4_ + 0x798);
        if (iVar2 < 1) {
            iVar2 = 0;
        } else {
            nofork = 0;
            iVar17 = pipe(&local_4b4);
            if (iVar17 != 0) {
                piVar6 = __errno_location();
                pcVar16 = "Pipe creation failed for --wait-sync: %m";
                goto LAB_0002d8bc;
            }
            waitsync_fd_to_close = local_4b0;
        }
    }
    FUN_000751b4();
    FUN_0007055c(&local_4c4);
    FUN_00079ad4(local_4c0 * local_4c4);
    if (nofork == 0) {
        _Var8 = fork();
        iVar17 = local_4b4;
        if (_Var8 == -1) {
            piVar6 = __errno_location();
            pcVar16 = "fork: %m";
        LAB_0002d8bc:
            iVar2 = *piVar6;
            if (iVar2 == 0) {
                iVar2 = -1;
            }
            FUN_00075d40(3, pcVar16);
            /* WARNING: Subroutine does not return */
            exit(iVar2);
        }
        if (0 < _Var8) {
            __status = 0;
            if (iVar2 != 0) {
                __nfds = local_4b4 + 1;
                piVar6 = &local_4b0;
                close(waitsync_fd_to_close);
                tVar10 = time((time_t *)0x0);
                uVar14 = 1 << (iVar17 % 0x20 & 0xffU);
                while (true) {
                    tVar11 = time((time_t *)0x0);
                    local_4bc.tv_usec = 0;
                    piVar13 = piVar6;
                    if (tVar11 < iVar2 + tVar10) {
                        pVar7 = (iVar2 + tVar10) - tVar11;
                    } else {
                        pVar7 = 0;
                    }
                    do {
                        piVar13 = piVar13 + 1;
                        *piVar13 = 0;
                    } while (piVar13 != &iStack_430);
                    local_4bc.tv_sec = pVar7;
                    iVar12 = __fdelt_chk(iVar17);
                    *(uint *)((int)local_4ac + iVar12 * 4) =
                        *(uint *)((int)local_4ac + iVar12 * 4) | uVar14;
                    iVar12 = select(__nfds, (fd_set *)local_4ac, (fd_set *)0x0,
                                    (fd_set *)0x0, &local_4bc);
                    if (iVar12 != -1)
                        break;
                    piVar13 = __errno_location();
                    iVar12 = *piVar13;
                    if (iVar12 != 4) {
                        __status = iVar12;
                        if (iVar12 == 0) {
                            __status = -1;
                        }
                        FUN_00075d40(3, "--wait-sync select failed: %m");
                        goto LAB_0002dfb4;
                    }
                    if ((int)pVar7 < 1)
                        goto LAB_0002e160;
                }
                if (iVar12 != 0)
                    goto LAB_0002dfb4;
                do {
                    piVar6 = piVar6 + 1;
                    *piVar6 = 0;
                } while (piVar6 != &iStack_430);
                iVar17 = __fdelt_chk(iVar17);
                local_4bc.tv_sec = 0;
                local_4bc.tv_usec = 0;
                *(uint *)((int)local_4ac + iVar17 * 4) =
                    *(uint *)((int)local_4ac + iVar17 * 4) | uVar14;
                iVar17 = select(__nfds, (fd_set *)local_4ac, (fd_set *)0x0,
                                (fd_set *)0x0, &local_4bc);
                if (iVar17 == 0) {
                LAB_0002e160:
                    __status = 0x6e;
                    __fprintf_chk(stderr, 1,
                                  "%s: -w/--wait-sync %ld timed out.\n",
                                  progname, iVar2);
                }
            }
        LAB_0002dfb4:
            /* WARNING: Subroutine does not return */
            exit(__status);
        }
        closelog();
        if (syslog_file != (FILE *)0x0) {
            fclose(syslog_file);
            syslog_file = (FILE *)0x0;
            syslogit = 1;
        }
        FUN_00079f80(waitsync_fd_to_close);
        iVar2 = open64("/dev/null", 0);
        if (((iVar2 != 0) || (iVar2 = dup2(0, 1), iVar2 != 1)) ||
            (iVar2 = dup2(0, 2), iVar2 != 2)) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntpd.c", 0x244, 2,
                         "0 == open(\"/dev/null\", 0) && 1 == dup2(0, 1) && 2 "
                         "== dup2(0, 2)");
        }
        FUN_00075e3c(progname, 0, 1);
        FUN_000762c8(local_4d4);
        _Var8 = setsid();
        if (_Var8 == -1) {
            FUN_00075d40(3, "setsid(): %m");
        }
    }
    FUN_0001fce4(3, &DAT_0009e52c, 0x32000, 0, 0x1000, &DAT_0009e52c);
    FUN_0001fce4(8, extraout_r1, 0xfff00000, 0xffffffff, 0x100000,
                 &DAT_0009e4fc);
    FUN_0007e6c4(1, &LAB_0002d180);
    FUN_0007e6c4(2, &LAB_0002d180);
    FUN_0007e6c4(3, &LAB_0002d180);
    FUN_0007e6c4(0xf, &LAB_0002d180);
    FUN_0007e6c4(7, &LAB_0002d180);
    FUN_0007e6c4(10, &LAB_0002d1dc);
    FUN_0007e6c4(0xc, &LAB_0002d1dc);
    FUN_0007e6c4(0xd, 1);
    if (ssl_init_done == 0) {
        FUN_0007d690();
    }
    FUN_00072a24();
    FUN_00052660();
    FUN_00050d88();
    FUN_00041158();
    FUN_00051aa8();
    FUN_00050080();
    FUN_00034628();
    FUN_00041e60();
    FUN_00049d94();
    if (priority_done == 0) {
        pVar7 = sched_get_priority_max(1);
        local_4bc.tv_sec = pVar7;
        if (((config_priority_override != 0) &&
             (pVar9 = sched_get_priority_min(1), local_4bc.tv_sec = pVar7,
              (int)config_priority <= (int)pVar7)) &&
            (local_4bc.tv_sec = pVar9, (int)pVar9 < (int)config_priority)) {
            local_4bc.tv_sec = config_priority;
        }
        iVar2 = sched_setscheduler(0, 1, (sched_param *)&local_4bc);
        if (iVar2 == -1) {
            FUN_00075d40(3, "sched_setscheduler(): %m");
        } else {
            priority_done = priority_done + 1;
        }
        if (priority_done == 0) {
            iVar2 = setpriority(PRIO_PROCESS, 0, -0xc);
            if (iVar2 == -1) {
                FUN_00075d40(3, "setpriority() error: %m");
            } else {
                priority_done = priority_done + 1;
            }
            if (priority_done == 0) {
                FUN_00075d40(3, "set_process_priority: No way found to improve "
                                "our priority");
            }
        }
    }
    FUN_00049588();
    FUN_00025f4c();
    FUN_0003f8b0();
    FUN_000411c4(1);
    FUN_000235f8(local_4cc[0], local_4d0);
    FUN_00040b38(0, 1);
    FUN_00036294(6, 0);
    initializing = 0;
    was_alarmed = 0;
    do {
        iVar2 = DAT_000ca3e4;
        if (DAT_000ca3e0 != 0) {
            pcVar16 = strsignal(DAT_000ca3e4);
            if (pcVar16 == (char *)0x0) {
                pcVar16 = "";
            }
            FUN_00075d40(5, "%s exiting on signal %d (%s)", progname, iVar2,
                         pcVar16);
            FUN_000433b0();
            /* WARNING: Subroutine does not return */
            exit(0);
        }
        if (alarm_flag == 0) {
            if (was_alarmed != 0)
                goto LAB_0002db1c;
            FUN_0007a438();
            if (was_alarmed == 0) {
                iVar2 = FUN_0007b310();
                if (iVar2 == 0) {
                    FUN_00026f70();
                }
                goto LAB_0002db1c;
            }
            if (alarm_flag == 0)
                goto LAB_0002dbe4;
        LAB_0002dbd8:
            alarm_flag = 0;
            was_alarmed = 1;
        LAB_0002dbe4:
            FUN_00051c8c();
            was_alarmed = 0;
        } else {
            alarm_flag = 0;
            was_alarmed = 1;
        LAB_0002db1c:
            if (alarm_flag != 0)
                goto LAB_0002dbd8;
            if (was_alarmed != 0)
                goto LAB_0002dbe4;
        }
        iVar2 = FUN_0007b124();
        while (iVar2 != 0) {
            if (alarm_flag == 0) {
                if (was_alarmed != 0)
                    goto LAB_0002db94;
                pcVar15 = *(code **)(iVar2 + 0x50);
            } else {
                was_alarmed = 1;
                alarm_flag = 0;
            LAB_0002db94:
                FUN_00051c8c();
                pcVar15 = *(code **)(iVar2 + 0x50);
                was_alarmed = 0;
            }
            if (pcVar15 == (code *)0x0) {
                FUN_00075d40(3, "fatal: receive buffer callback NULL");
                /* WARNING: Subroutine does not return */
                abort();
            }
            (*pcVar15)(iVar2);
            FUN_0007af28(iVar2);
            iVar2 = FUN_0007b124();
        }
    } while (true);
}

/* WARNING: Control flow encountered bad instruction data */

void entry(undefined4 param_1, undefined4 *param_2)

{
    undefined4 *extraout_r1;
    undefined1 *unaff_r10;
    undefined4 unaff_r11;
    undefined1 in_NG;
    undefined1 in_ZR;
    char in_OV;
    undefined4 in_cr0;
    undefined4 in_cr15;

    if ((bool)in_ZR) {
        FUN_000588c8();
        param_2 = extraout_r1;
    }
    if ((bool)in_ZR) {
        coprocessor_function(0, 0, 2, in_cr15, in_cr0, in_cr15);
    }
    if ((bool)in_NG) {
        *unaff_r10 = (char)unaff_r11;
    }
    if (in_NG != in_OV) {
        *param_2 = unaff_r11;
    }
    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
}

/* WARNING: Removing unreachable block (ram,0x0001c7e0) */

void FUN_0001c7cc(void)

{
    __gmon_start__();
    return;
}

/* WARNING: Removing unreachable block (ram,0x0001c804) */
/* WARNING: Removing unreachable block (ram,0x0001c80a) */

void FUN_0001c7f0(void)

{
    return;
}

void _FINI_0(void)

{
    if (__bss_start__ == '\0') {
        __cxa_finalize(DAT_000c7004);
        FUN_0001c7f0();
        __bss_start__ = '\x01';
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0001c838) */
/* WARNING: Removing unreachable block (ram,0x0001c83e) */
/* WARNING: Removing unreachable block (ram,0x0001c8a8) */
/* WARNING: Removing unreachable block (ram,0x0001c8b0) */

void _INIT_0(void)

{
    return;
}

void FUN_0001c8c0(void)

{
    char cVar1;
    int iVar2;
    char *pcVar3;
    char *pcVar4;
    char *__s;
    uint uVar5;

    iVar2 = __stack_chk_guard;
    __s = lib_stringbuf + lib_nextbuf * 0x80;
    uVar5 = lib_nextbuf + 1;
    memset(__s, 0, 0x80);
    lib_nextbuf = uVar5 & 0xf;
    FUN_0007d00c(__s, 0x80, &DAT_0009d724);
    pcVar3 = strchr(__s, 0x65);
    if (pcVar3 == (char *)0x0) {
        pcVar3 = strchr(__s, 0x45);
        if (pcVar3 == (char *)0x0)
            goto LAB_0001c988;
        *pcVar3 = 'e';
    }
    cVar1 = pcVar3[1];
    if (cVar1 == '-') {
        cVar1 = pcVar3[2];
        pcVar3 = pcVar3 + 2;
    } else {
        pcVar3 = pcVar3 + 1;
    }
    pcVar4 = pcVar3;
    if (cVar1 == '0') {
        do {
            pcVar4 = pcVar4 + 1;
        } while (*pcVar4 == '0');
        if (pcVar3 != pcVar4) {
            FUN_0007e4b4(pcVar3, pcVar4, __s + (0x80 - (int)pcVar3));
        }
    }
LAB_0001c988:
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

void FUN_0001c9e0(char *param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if ((param_1 != (char *)0x0) &&
        (param_1 = *(char **)(param_1 + 4), param_1 != (char *)0x0)) {
        iVar2 = strncmp(param_1, "127.127.", 8);
        param_1 = (char *)(uint)(iVar2 == 0);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_0001ca54(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    undefined4 uStack_c;
    undefined4 uStack_8;
    undefined4 uStack_4;

    uStack_c = param_2;
    uStack_8 = param_3;
    uStack_4 = param_4;
    FUN_00075dc8(0, param_1, &uStack_c, __stack_chk_guard, &uStack_c,
                 __stack_chk_guard);
    /* WARNING: Subroutine does not return */
    _exit(1);
}

void FUN_0001caa0(int *param_1, undefined4 param_2)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if (param_1 == (int *)0x0) {
    LAB_0001cb88:
        if (iVar1 == __stack_chk_guard) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    param_1 = (int *)*param_1;
joined_r0x0001cad0:
    if (param_1 != (int *)0x0) {
        do {
            iVar2 = param_1[4];
            if (iVar2 == 0x16b) {
                FUN_00049000(0, 10, param_2, 0);
            } else if (iVar2 < 0x16c) {
                if (iVar2 == 0x113) {
                    FUN_00049000(0, 0xd, param_2, 0);
                } else if (iVar2 < 0x114) {
                    if (iVar2 == 0x107) {
                        FUN_00049000(0, 3, param_2, 0);
                    } else {
                        if (iVar2 == 0x10c)
                            goto code_r0x0001cb68;
                    LAB_0001cb14:
                        FUN_00075d40(
                            3,
                            "can not apply enable/disable token %d, unknown");
                    }
                } else if (iVar2 == 0x148) {
                    FUN_00049000(0, 9, param_2, 0);
                } else {
                    if (iVar2 != 0x16a)
                        goto LAB_0001cb14;
                    FUN_00049000(0, 0x1c, param_2, 0);
                }
            } else if (iVar2 == 0x19c) {
                FUN_00049000(0, 0xb, param_2, 0);
            } else if (iVar2 < 0x19d) {
                if (iVar2 == 0x17c) {
                    FUN_00049000(0, 8, param_2, 0);
                } else {
                    if (iVar2 != 0x181)
                        goto LAB_0001cb14;
                    FUN_00049000(0, 0x20, param_2, 0);
                }
            } else if (iVar2 == 0x1b4) {
                FUN_00049000(0, 0x1e, param_2, 0);
            } else if (iVar2 == 0x1b5) {
                FUN_00049000(0, 0x1f, param_2, 0);
            } else {
                if (iVar2 != 0x1b3)
                    goto LAB_0001cb14;
                FUN_00049000(0, 0x1d, param_2, 0);
            }
            param_1 = (int *)*param_1;
            if (param_1 == (int *)0x0)
                break;
        } while (true);
    }
    goto LAB_0001cb88;
code_r0x0001cb68:
    FUN_00049000(0, 1, param_2, 0);
    param_1 = (int *)*param_1;
    goto joined_r0x0001cad0;
}

void FUN_0001cd68(short *param_1, int param_2)

{
    short sVar1;
    uint uVar2;
    uint uVar3;
    bool bVar4;
    int iVar5;
    int iVar6;
    undefined4 uVar7;
    uint uVar8;

    iVar5 = __stack_chk_guard;
    sVar1 = *param_1;
    if (sVar1 == 2) {
        uVar8 = *(uint *)(param_1 + 2);
        uVar2 = uVar8 << 0x18;
        uVar3 = uVar2 | (uVar8 >> 8 & 0xff) << 0x10;
        if (uVar3 != 0x7f7f0000) {
            iVar6 = (uVar3 | (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18) +
                    0x80ffffff;
            if (iVar6 != 0) {
                iVar6 = 1;
            }
            if (uVar2 != 0x7f000000) {
                iVar6 = 0;
            }
            if (iVar6 == 0)
                goto LAB_0001cea0;
        LAB_0001ce3c:
            uVar7 = FUN_0007d2c0();
            FUN_00075d40(3, "attempt to configure invalid address %s", uVar7);
            iVar6 = 0;
            goto LAB_0001cdd4;
        }
    LAB_0001cea0:
        if (param_2 == 0x188 || (param_2 == 0x197 || param_2 == 0x183)) {
            bVar4 = (uVar2 & 0xf0000000) == 0xe0000000;
            goto LAB_0001ce14;
        }
        if (param_2 == 0x157) {
        LAB_0001cef0:
            if ((uVar8 & 0xf0) != 0xe0)
                goto LAB_0001ce3c;
        }
    } else {
        if (param_2 == 0x188 || (param_2 == 0x197 || param_2 == 0x183)) {
            bVar4 = (char)param_1[4] == -1;
        LAB_0001ce14:
            if (bVar4)
                goto LAB_0001ce3c;
            if (param_2 == 0x157) {
                if (sVar1 == 2) {
                    uVar8 = *(uint *)(param_1 + 2);
                    goto LAB_0001cef0;
                }
                goto LAB_0001ce30;
            }
        } else if (param_2 == 0x157) {
        LAB_0001ce30:
            if ((char)param_1[4] != -1)
                goto LAB_0001ce3c;
        }
        if (sVar1 == 10) {
            iVar6 = ipv6_works;
            if (ipv6_works != 0) {
                iVar6 = 1;
            }
            goto LAB_0001cdd4;
        }
    }
    iVar6 = 1;
LAB_0001cdd4:
    if (iVar5 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar6);
    }
    return;
}

void FUN_0001cf14(int param_1, undefined4 param_2, undefined4 *param_3,
                  undefined4 param_4, undefined4 param_5, undefined4 param_6,
                  int param_7)

{
    int iVar1;
    undefined4 uVar2;
    char *pcVar3;
    undefined1 auStack_40[28];
    int local_24;

    local_24 = __stack_chk_guard;
    if (param_1 == 0) {
        if (param_7 != 0) {
            do {
                __memcpy_chk(auStack_40, *(undefined4 *)(param_7 + 0x14),
                             *(undefined4 *)(param_7 + 0x10), 0x1c);
                iVar1 = FUN_0001cd68(auStack_40, param_3[1]);
                if (iVar1 != 0) {
                    if ((ntp_syslogmask & 1) != 0) {
                        if (*(short *)(param_3 + 2) == 10) {
                            pcVar3 = "(AAAA) ";
                        } else if (*(short *)(param_3 + 2) == 2) {
                            pcVar3 = "(A) ";
                        } else {
                            pcVar3 = "";
                        }
                        uVar2 = FUN_0007d2c0(auStack_40);
                        FUN_00075d40(6, "DNS %s %s-> %s", param_4, pcVar3,
                                     uVar2);
                    }
                    FUN_00042db8(auStack_40, 0, 0, 0xffffffff,
                                 *(undefined1 *)(param_3 + 4),
                                 *(undefined1 *)((int)param_3 + 0x11),
                                 *(undefined1 *)((int)param_3 + 0x12),
                                 *(undefined1 *)((int)param_3 + 0x13), *param_3,
                                 param_3[5], param_3[3], param_3[6]);
                    break;
                }
                param_7 = *(int *)(param_7 + 0x1c);
            } while (param_7 != 0);
        }
        if (local_24 == __stack_chk_guard) {
            free(param_3);
            return;
        }
    } else {
        free(param_3);
        pcVar3 = gai_strerror(param_1);
        FUN_00075d40(3, "giving up resolving host %s: %s (%d)", param_4, pcVar3,
                     param_1);
        if (local_24 == __stack_chk_guard) {
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001d27c(undefined4 param_1, ushort *param_2)

{
    ushort uVar1;
    int iVar2;
    int iVar3;
    bool bVar4;

    iVar2 = __stack_chk_guard;
    uVar1 = *param_2;
    bVar4 = (uVar1 & 0xfffd) == 0;
    if (uVar1 != 10 && !bVar4) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_config.c", 0x143d, uVar1 == 10 || bVar4,
                     "0 == ((addr)->sa.sa_family) || 2 == "
                     "((addr)->sa.sa_family) || 10 == ((addr)->sa.sa_family)");
    }
    iVar3 = FUN_00074fd8(param_1, uVar1, param_2);
    if (iVar3 != 0) {
        if ((*param_2 == 10) && (ipv6_works == 0)) {
            iVar3 = -1;
        } else {
            iVar3 = 1;
            param_2[1] = 0x7b00;
        }
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar3);
}

void FUN_0001d348(int *param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int extraout_r2;
    int *piVar4;
    int *extraout_r3;
    int iVar5;
    int extraout_r12;
    int iVar6;
    undefined8 uVar7;

    iVar1 = __stack_chk_guard;
    if (param_1 != (int *)0x0) {
        piVar4 = (int *)*param_1;
        if (piVar4 == (int *)0x0) {
            param_1 = (int *)0x0;
        } else {
            param_1 = (int *)0x0;
            iVar3 = 0x18b;
            iVar5 = 0x112;
            iVar6 = 0x137;
        LAB_0001d3c8:
            do {
                iVar2 = piVar4[4];
                uVar7 = CONCAT44(iVar2, param_1);
                if (iVar2 == 0x178) {
                    param_1 = (int *)((uint)param_1 | 0x200);
                } else if (iVar2 < 0x179) {
                    if (iVar2 == iVar5) {
                        param_1 = (int *)((uint)param_1 | 0x40);
                    } else if (iVar2 == iVar6) {
                        param_1 = (int *)((uint)param_1 | 0x100);
                    } else {
                        if (iVar2 != 0x108) {
                        LAB_0001d3f0:
                            do {
                                iVar6 = 0x1d3fc;
                                uVar7 = FUN_0001ca54(
                                    "peerflag_bits: option-token=%d");
                                iVar3 = extraout_r2;
                                piVar4 = extraout_r3;
                                iVar5 = extraout_r12;
                            LAB_0001d3fc:
                            } while ((int)((ulonglong)uVar7 >> 0x20) != 0x18a);
                            piVar4 = (int *)*piVar4;
                            param_1 = (int *)((uint)uVar7 | 2);
                            if (piVar4 == (int *)0x0)
                                break;
                            goto LAB_0001d3c8;
                        }
                        param_1 = (int *)((uint)param_1 | 0x800);
                    }
                } else if (iVar2 == iVar3) {
                    param_1 = (int *)((uint)param_1 | 0x20);
                } else {
                    if (iVar2 < 0x18c)
                        goto LAB_0001d3fc;
                    if (iVar2 == 0x1ae) {
                        param_1 = (int *)((uint)param_1 | 0x400);
                    } else {
                        if (iVar2 != 0x1bc)
                            goto LAB_0001d3f0;
                        param_1 = (int *)((uint)param_1 | 0x1000);
                    }
                }
                piVar4 = (int *)*piVar4;
            } while (piVar4 != (int *)0x0);
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_0001d474(int param_1, undefined4 param_2, void *param_3,
                  undefined4 param_4, undefined4 param_5, undefined4 param_6,
                  int param_7)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    char *pcVar5;
    int local_38;
    int local_34;
    int local_30;
    int local_2c;
    int local_28;
    int local_24;
    int local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    if (param_1 == 0) {
        if (0x1c < *(uint *)(param_7 + 0x10)) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_config.c", 0xdfe, 2,
                         "sizeof(peeraddr) >= res->ai_addrlen");
        }
        local_38 = param_1;
        local_34 = param_1;
        local_30 = param_1;
        local_2c = param_1;
        local_28 = param_1;
        local_24 = param_1;
        local_20 = param_1;
        __memcpy_chk(&local_38, *(undefined4 *)(param_7 + 0x14),
                     *(uint *)(param_7 + 0x10), 0x1c);
        if (((*(int *)((int)param_3 + 0x1c) == 0) ||
             (iVar1 = FUN_00027b78(param_3), iVar1 == 0)) &&
            (iVar1 = any_interface, (short)local_38 != 2)) {
            iVar1 = any6_interface;
        }
        iVar2 = FUN_000340bc(&local_38, iVar1, 0, 4);
        if (iVar2 == 0) {
            uVar3 = FUN_0002924c(iVar1);
            uVar4 = FUN_0007d2c0(&local_38);
            FUN_00075d40(3, "set trap %s -> %s failed.", uVar3, uVar4);
        }
        if (local_1c != __stack_chk_guard) {
        LAB_0001d5b8:
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
    } else {
        pcVar5 = gai_strerror(param_1);
        FUN_00075d40(3, "giving up resolving trap host %s: %s (%d)", param_4,
                     pcVar5, param_1);
        if (local_1c != __stack_chk_guard)
            goto LAB_0001d5b8;
    }
    free(param_3);
    return;
}

void FUN_0001d684(char *param_1)

{
    int iVar1;
    size_t __n;
    int iVar2;
    char *pcVar3;
    char *__s2;
    int *piVar4;
    char *__s;

    iVar1 = __stack_chk_guard;
    piVar4 = (int *)&DAT_000c7018;
    pcVar3 = DAT_000c7018;
    if (DAT_000c7018 != (char *)0x0) {
        do {
            iVar2 = strcmp(param_1, pcVar3);
            if (iVar2 == 0) {
                iVar2 = piVar4[1];
                if (iVar2 != 0)
                    goto LAB_0001d6e8;
                break;
            }
            piVar4 = piVar4 + 2;
            pcVar3 = (char *)*piVar4;
        } while (pcVar3 != (char *)0x0);
    }
    pcVar3 = param_1;
    if (DAT_000c7068 == (char *)0x0) {
        __s = (char *)0x0;
    } else {
        piVar4 = (int *)&DAT_000c7068;
        __s = DAT_000c7068;
        do {
            __n = strlen(__s);
            iVar2 = strncmp(param_1, __s, __n);
            if (iVar2 == 0) {
                __s = (char *)piVar4[1];
                pcVar3 = param_1 + __n;
                break;
            }
            piVar4 = piVar4 + 2;
            __s = (char *)*piVar4;
        } while (__s != (char *)0x0);
    }
    if (DAT_000c7090 != (char *)0x0) {
        piVar4 = (int *)&DAT_000c7090;
        __s2 = DAT_000c7090;
        do {
            iVar2 = strcmp(pcVar3, __s2);
            if (iVar2 == 0) {
                if (piVar4[1] != 0) {
                    iVar2 = piVar4[1] << ((uint)__s & 0xff);
                    goto LAB_0001d6e8;
                }
                break;
            }
            piVar4 = piVar4 + 2;
            __s2 = (char *)*piVar4;
        } while (__s2 != (char *)0x0);
    }
    FUN_00075d40(3, "logconfig: \'%s\' not recognized - ignored", param_1);
    iVar2 = 0;
LAB_0001d6e8:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2);
}

void FUN_0001d7dc(int param_1, FILE *param_2, int param_3)

{
    bool bVar1;
    undefined4 uVar2;
    undefined4 uVar3;
    char *pcVar4;
    size_t sVar5;
    void *__ptr;
    void *__ptr_00;
    tm *__tp;
    int iVar6;
    int *piVar7;
    int *piVar8;
    int *piVar9;
    int iVar10;
    char *__s1;
    undefined2 local_88[2];
    undefined1 local_84;
    undefined1 local_83;
    char local_7c[80];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (param_3 != 0) {
        __tp = localtime((time_t *)(param_1 + 0x20));
        sVar5 = strftime(local_7c, 0x50, "%Y-%m-%d %H:%M:%S", __tp);
        if (sVar5 == 0) {
            local_7c[0] = '\0';
        }
        if (*(int *)(param_1 + 0xc) == 1) {
            pcVar4 = "ntpq remote config from";
        } else {
            pcVar4 = "startup configuration file";
        }
        __fprintf_chk(param_2, 1, "# %s %s %s\n", local_7c, pcVar4,
                      *(undefined4 *)(param_1 + 0x18));
    }
    if (*(int **)(param_1 + 0xa0) != (int *)0x0) {
        for (piVar7 = (int *)**(int **)(param_1 + 0xa0); piVar7 != (int *)0x0;
             piVar7 = (int *)*piVar7) {
            while (iVar6 = piVar7[2], iVar6 != 0x13f) {
                piVar8 = piVar7;
                if (iVar6 == 0x1a3) {
                    uVar2 = FUN_0002c300(piVar7[1]);
                    iVar6 = piVar7[4];
                    __fprintf_chk(param_2, 1, "%s \"%s\"", uVar2, iVar6);
                    if (((piVar7[1] == 0x122) &&
                         (piVar8 = (int *)*piVar7, piVar8 != (int *)0x0)) &&
                        (piVar8[1] == 0x1b9)) {
                        uVar2 = FUN_0001c8c0((int)*(undefined8 *)(piVar8 + 4));
                        __fprintf_chk(param_2, 1, " %s\n", uVar2, iVar6);
                    } else {
                        fputc(10, param_2);
                        piVar8 = piVar7;
                    }
                } else if (iVar6 == 0x121) {
                    uVar2 = FUN_0002c300(piVar7[1]);
                    uVar3 = FUN_0001c8c0((int)*(undefined8 *)(piVar7 + 4));
                    __fprintf_chk(param_2, 1, "%s %s\n", uVar2, uVar3);
                }
                piVar7 = (int *)*piVar8;
                if (piVar7 == (int *)0x0)
                    goto LAB_0001d8e0;
            }
            uVar2 = FUN_0002c300(piVar7[1]);
            __fprintf_chk(param_2, 1, "%s %d\n", uVar2, piVar7[4]);
        }
    }
LAB_0001d8e0:
    if ((*(int **)(param_1 + 0x8c) != (int *)0x0) &&
        (piVar7 = (int *)**(int **)(param_1 + 0x8c), piVar7 != (int *)0x0)) {
        fwrite("logconfig", 1, 9, param_2);
        do {
            __fprintf_chk(param_2, 1, " %c%s", piVar7[1], piVar7[4]);
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
        fputc(10, param_2);
    }
    if (*(int *)(param_1 + 0x40) != 0) {
        __fprintf_chk(param_2, 1, "statsdir \"%s\"\n");
    }
    if ((*(int **)(param_1 + 0x3c) != (int *)0x0) &&
        (piVar7 = (int *)**(int **)(param_1 + 0x3c), piVar7 != (int *)0x0)) {
        fwrite("statistics", 1, 10, param_2);
        do {
            uVar2 = FUN_0002c300(piVar7[1]);
            __fprintf_chk(param_2, 1, " %s", uVar2);
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
        fputc(10, param_2);
    }
    if (*(int **)(param_1 + 0x44) != (int *)0x0) {
        for (piVar7 = (int *)**(int **)(param_1 + 0x44); piVar7 != (int *)0x0;
             piVar7 = (int *)*piVar7) {
            if (((int *)piVar7[2] != (int *)0x0) &&
                (piVar8 = *(int **)piVar7[2], piVar8 != (int *)0x0)) {
                uVar2 = FUN_0002c300(piVar7[1]);
                __fprintf_chk(param_2, 1, "filegen %s", uVar2);
                do {
                    while (iVar6 = piVar8[1], iVar6 == 0x1b1) {
                        uVar2 = FUN_0002c300(piVar8[4]);
                        __fprintf_chk(param_2, 1, " type %s", uVar2);
                        piVar8 = (int *)*piVar8;
                        if (piVar8 == (int *)0x0)
                            goto LAB_0001dac8;
                    }
                    if (iVar6 == 0x1be) {
                        uVar2 = FUN_0002c300(piVar8[4]);
                        __fprintf_chk(param_2, 1, " %s", uVar2);
                    } else if (iVar6 == 0x12a) {
                        __fprintf_chk(param_2, 1, " file %s", piVar8[4]);
                    }
                    piVar8 = (int *)*piVar8;
                } while (piVar8 != (int *)0x0);
            LAB_0001dac8:
                fputc(10, param_2);
            }
        }
    }
    if ((*(int **)(param_1 + 0x70) != (int *)0x0) &&
        (piVar7 = (int *)**(int **)(param_1 + 0x70), piVar7 != (int *)0x0)) {
        fwrite("crypto", 1, 6, param_2);
        do {
            uVar2 = FUN_0002c300(piVar7[1]);
            __fprintf_chk(param_2, 1, " %s %s", uVar2, piVar7[4]);
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
        fputc(10, param_2);
    }
    if (*(int *)(param_1 + 0x80) != 0) {
        __fprintf_chk(param_2, 1, "revoke %d\n");
    }
    if (*(int *)(param_1 + 0x78) != 0) {
        __fprintf_chk(param_2, 1, "keysdir \"%s\"\n");
    }
    if (*(int *)(param_1 + 0x74) != 0) {
        __fprintf_chk(param_2, 1, "keys \"%s\"\n");
    }
    if ((*(int **)(param_1 + 0x84) != (int *)0x0) &&
        (piVar7 = (int *)**(int **)(param_1 + 0x84), piVar7 != (int *)0x0)) {
        fwrite("trustedkey", 1, 10, param_2);
        do {
            while (piVar7[2] == 0x13f) {
                __fprintf_chk(param_2, 1, " %d", piVar7[4]);
                piVar7 = (int *)*piVar7;
                if (piVar7 == (int *)0x0)
                    goto LAB_0001dc40;
            }
            if (piVar7[2] == 0x141) {
                __fprintf_chk(param_2, 1, " (%d ... %d)", piVar7[4], piVar7[5]);
            }
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
    LAB_0001dc40:
        fputc(10, param_2);
    }
    if (*(int *)(param_1 + 0x68) != 0) {
        __fprintf_chk(param_2, 1, "controlkey %d\n");
    }
    if (*(int *)(param_1 + 0x7c) != 0) {
        __fprintf_chk(param_2, 1, "requestkey %d\n");
    }
    bVar1 = true;
    if (*(int **)(param_1 + 0x60) == (int *)0x0)
        goto LAB_0001dce0;
    piVar7 = (int *)**(int **)(param_1 + 0x60);
    pcVar4 = "enable";
    if (piVar7 == (int *)0x0)
        goto LAB_0001dce0;
    do {
        fputs(pcVar4, param_2);
        do {
            uVar2 = FUN_0002c300(piVar7[4]);
            __fprintf_chk(param_2, 1, " %s", uVar2);
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
        fputc(10, param_2);
    LAB_0001dce0:
    } while (
        ((bVar1) && (*(undefined4 **)(param_1 + 100) != (undefined4 *)0x0)) &&
        (piVar7 = (int *)**(undefined4 **)(param_1 + 100), pcVar4 = "disable",
         bVar1 = false, piVar7 != (int *)0x0));
    if ((*(int **)(param_1 + 0x38) != (int *)0x0) &&
        (piVar7 = (int *)**(int **)(param_1 + 0x38), piVar7 != (int *)0x0)) {
        fwrite(&DAT_0009dab8, 1, 3, param_2);
        do {
            while (piVar7[2] == 0x121) {
                uVar2 = FUN_0002c300(piVar7[1]);
                uVar3 = FUN_0001c8c0((int)*(undefined8 *)(piVar7 + 4));
                __fprintf_chk(param_2, 1, " %s %s", uVar2, uVar3);
                piVar7 = (int *)*piVar7;
                if (piVar7 == (int *)0x0)
                    goto LAB_0001de74;
            }
            if (piVar7[2] == 0x13f) {
                if (piVar7[1] == 0x10b) {
                    FUN_00076c70(local_88,
                                 "refclock_jjy.c : jjy_start_telephone : phone "
                                 "in the ntpd.conf must be specified." +
                                     piVar7[4] + 0x18);
                    uVar2 = FUN_0002c300(piVar7[1]);
                    __fprintf_chk(param_2, 1, " %s \"%04hu-%02hu-%02hu\"",
                                  uVar2, local_88[0], local_84, local_83);
                } else {
                    uVar2 = FUN_0002c300();
                    __fprintf_chk(param_2, 1, " %s %d", uVar2, piVar7[4]);
                }
            }
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
    LAB_0001de74:
        fputc(10, param_2);
    }
    if ((*(int **)(param_1 + 0x58) != (int *)0x0) &&
        (piVar7 = (int *)**(int **)(param_1 + 0x58), piVar7 != (int *)0x0)) {
        fwrite("rlimit", 1, 6, param_2);
        do {
            if (piVar7[2] != 0x13f) {
                /* WARNING: Subroutine does not return */
                FUN_0007fc54("ntp_config.c", 0x2f8, 2, "319 == atrv->type");
            }
            uVar2 = FUN_0002c300(piVar7[1]);
            __fprintf_chk(param_2, 1, " %s %d", uVar2, piVar7[4]);
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
        fputc(10, param_2);
    }
    if ((*(int **)(param_1 + 0x5c) != (int *)0x0) &&
        (piVar7 = (int *)**(int **)(param_1 + 0x5c), piVar7 != (int *)0x0)) {
        fwrite("tinker", 1, 6, param_2);
        do {
            if (piVar7[2] != 0x121) {
                /* WARNING: Subroutine does not return */
                FUN_0007fc54("ntp_config.c", 0x303, 2, "289 == atrv->type");
            }
            uVar2 = FUN_0002c300(piVar7[1]);
            uVar3 = FUN_0001c8c0((int)*(undefined8 *)(piVar7 + 4));
            __fprintf_chk(param_2, 1, " %s %s", uVar2, uVar3);
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
        fputc(10, param_2);
    }
    if (*(int *)(param_1 + 0x2c) != 0) {
        fwrite("broadcastclient\n", 1, 0x10, param_2);
    }
    if ((*(int **)(param_1 + 0x24) != (int *)0x0) &&
        (piVar7 = (int *)**(int **)(param_1 + 0x24), piVar7 != (int *)0x0)) {
        do {
            iVar6 = piVar7[2];
            pcVar4 = (char *)FUN_0002c300(piVar7[1]);
            fputs(pcVar4, param_2);
            if (*(short *)(iVar6 + 8) == 2) {
                fwrite(&DAT_0009db28, 1, 3, param_2);
            } else if (*(short *)(iVar6 + 8) == 10) {
                fwrite(&DAT_0009db2c, 1, 3, param_2);
            }
            __fprintf_chk(param_2, 1, " %s", *(undefined4 *)(iVar6 + 4));
            if ((char)piVar7[4] != '\0') {
                __fprintf_chk(param_2, 1, " minpoll %u");
            }
            if (*(char *)((int)piVar7 + 0x11) != '\0') {
                __fprintf_chk(param_2, 1, " maxpoll %u");
            }
            iVar10 = piVar7[5];
            if (iVar10 != 0) {
                pcVar4 = *(char **)(iVar6 + 4);
                sVar5 = strlen(pcVar4);
                if ((sVar5 < 9) ||
                    (iVar6 = memcmp(pcVar4, "127.127.", 8), iVar6 != 0)) {
                    __fprintf_chk(param_2, 1, " ttl %u", iVar10);
                } else {
                    __fprintf_chk(param_2, 1, " mode %u", iVar10);
                }
            }
            if ((char)piVar7[6] != '\x04') {
                __fprintf_chk(param_2, 1, " version %u");
            }
            if (piVar7[7] != 0) {
                __fprintf_chk(param_2, 1, " key %u");
            }
            if (piVar7[8] != 0) {
                __fprintf_chk(param_2, 1, " ident \"%s\"");
            }
            if (((int *)piVar7[3] != (int *)0x0) &&
                (piVar8 = *(int **)piVar7[3], piVar8 != (int *)0x0)) {
                if (piVar8[1] != 0x1be) {
                LAB_0001ed94:
                    /* WARNING: Subroutine does not return */
                    FUN_0007fc54("ntp_config.c", 0x340, 2, "446 == atrv->attr");
                }
                iVar6 = piVar8[2];
                while (true) {
                    if (iVar6 != 0x13f) {
                        /* WARNING: Subroutine does not return */
                        FUN_0007fc54("ntp_config.c", 0x341, 2,
                                     "319 == atrv->type");
                    }
                    uVar2 = FUN_0002c300(piVar8[4]);
                    __fprintf_chk(param_2, 1, " %s", uVar2);
                    piVar8 = (int *)*piVar8;
                    if (piVar8 == (int *)0x0)
                        break;
                    if (piVar8[1] != 0x1be)
                        goto LAB_0001ed94;
                    iVar6 = piVar8[2];
                }
            }
            fputc(10, param_2);
            if (*(int **)(param_1 + 0x54) != (int *)0x0) {
                for (piVar8 = (int *)**(int **)(param_1 + 0x54);
                     piVar8 != (int *)0x0; piVar8 = (int *)*piVar8) {
                    while (true) {
                        pcVar4 = *(char **)(piVar7[2] + 4);
                        iVar6 = strcmp(pcVar4, *(char **)(piVar8[1] + 4));
                        if (iVar6 != 0)
                            break;
                        __fprintf_chk(param_2, 1, "fudge %s", pcVar4);
                        if ((int *)piVar8[2] != (int *)0x0) {
                            for (piVar9 = *(int **)piVar8[2];
                                 piVar9 != (int *)0x0;
                                 piVar9 = (int *)*piVar9) {
                                while (iVar6 = piVar9[2], iVar6 != 0x13f) {
                                    if (iVar6 == 0x1a3) {
                                        uVar2 = FUN_0002c300(piVar9[1]);
                                        iVar6 = piVar9[4];
                                        pcVar4 = " %s %s";
                                        goto LAB_0001e274;
                                    }
                                    if (iVar6 == 0x121) {
                                        uVar2 = FUN_0002c300(piVar9[1]);
                                        uVar3 = FUN_0001c8c0(
                                            (int)*(undefined8 *)(piVar9 + 4));
                                        __fprintf_chk(param_2, 1, " %s %s",
                                                      uVar2, uVar3);
                                    }
                                    piVar9 = (int *)*piVar9;
                                    if (piVar9 == (int *)0x0)
                                        goto LAB_0001e294;
                                }
                                uVar2 = FUN_0002c300(piVar9[1]);
                                iVar6 = piVar9[4];
                                pcVar4 = " %s %d";
                            LAB_0001e274:
                                __fprintf_chk(param_2, 1, pcVar4, uVar2, iVar6);
                            }
                        }
                    LAB_0001e294:
                        fputc(10, param_2);
                        piVar8 = (int *)*piVar8;
                        if (piVar8 == (int *)0x0)
                            goto LAB_0001e2ac;
                    }
                }
            }
        LAB_0001e2ac:
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
    }
    if ((*(int **)(param_1 + 0x30) != (int *)0x0) &&
        (piVar7 = (int *)**(int **)(param_1 + 0x30), piVar7 != (int *)0x0)) {
        fwrite("manycastserver", 1, 0xe, param_2);
        do {
            __fprintf_chk(param_2, 1, " %s", piVar7[1]);
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
        fputc(10, param_2);
    }
    if ((*(int **)(param_1 + 0x34) != (int *)0x0) &&
        (piVar7 = (int *)**(int **)(param_1 + 0x34), piVar7 != (int *)0x0)) {
        fwrite("multicastclient", 1, 0xf, param_2);
        do {
            __fprintf_chk(param_2, 1, " %s", piVar7[1]);
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
        fputc(10, param_2);
    }
    if (*(int **)(param_1 + 0x28) != (int *)0x0) {
        for (piVar7 = (int *)**(int **)(param_1 + 0x28); piVar7 != (int *)0x0;
             piVar7 = (int *)*piVar7) {
            __fprintf_chk(param_2, 1, "unpeer %s\n",
                          *(undefined4 *)(piVar7[2] + 4));
        }
    }
    if ((*(int **)(param_1 + 0x4c) != (int *)0x0) &&
        (piVar7 = (int *)**(int **)(param_1 + 0x4c), piVar7 != (int *)0x0)) {
        fwrite(&DAT_0009dbc8, 1, 3, param_2);
        do {
            uVar2 = FUN_0002c300(piVar7[1]);
            __fprintf_chk(param_2, 1, " %s %d", uVar2, piVar7[4]);
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
        fputc(10, param_2);
    }
    if ((*(int **)(param_1 + 0x48) != (int *)0x0) &&
        (piVar7 = (int *)**(int **)(param_1 + 0x48), piVar7 != (int *)0x0)) {
        fwrite("discard", 1, 7, param_2);
        do {
            uVar2 = FUN_0002c300(piVar7[1]);
            __fprintf_chk(param_2, 1, " %s %d", uVar2, piVar7[4]);
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
        fputc(10, param_2);
    }
    if (*(int **)(param_1 + 0x50) != (int *)0x0) {
        for (piVar7 = (int *)**(int **)(param_1 + 0x50); piVar7 != (int *)0x0;
             piVar7 = (int *)*piVar7) {
            iVar6 = piVar7[1];
            if (iVar6 == 0) {
                if ((int *)piVar7[3] == (int *)0x0) {
                    pcVar4 = "default";
                } else {
                    piVar8 = *(int **)piVar7[3];
                    if (piVar8 == (int *)0x0) {
                        pcVar4 = "default";
                    } else if (piVar8[1] == 0x199) {
                        pcVar4 = "source";
                    } else {
                        do {
                            piVar8 = (int *)*piVar8;
                            if (piVar8 == (int *)0x0) {
                                pcVar4 = "default";
                                goto LAB_0001e538;
                            }
                        } while (piVar8[1] != 0x199);
                        pcVar4 = "source";
                    }
                }
            LAB_0001e538:
                __fprintf_chk(param_2, 1, "restrict %s", pcVar4);
                if (piVar7[2] != 0) {
                    __fprintf_chk(param_2, 1, " mask %s",
                                  *(undefined4 *)(piVar7[2] + 4));
                }
            } else {
                iVar10 = piVar7[2];
                pcVar4 = *(char **)(iVar6 + 4);
                if (iVar10 == 0)
                    goto LAB_0001e538;
                __s1 = *(char **)(iVar10 + 4);
                if (((*(short *)(iVar6 + 8) == 2) &&
                     (iVar6 = strcmp(pcVar4, "0.0.0.0"), iVar6 == 0)) &&
                    (iVar6 = strcmp(__s1, "0.0.0.0"), iVar6 == 0)) {
                    pcVar4 = "-4 default";
                } else {
                    if (((((*(short *)(iVar10 + 8) != 10) ||
                           (*pcVar4 != ':')) ||
                          ((pcVar4[1] != ':' ||
                            ((pcVar4[2] != '\0' || (*__s1 != ':')))))) ||
                         (__s1[1] != ':')) ||
                        (__s1[2] != '\0'))
                        goto LAB_0001e538;
                    pcVar4 = "-6 default";
                }
                __fprintf_chk(param_2, 1, "restrict %s", pcVar4);
            }
            __fprintf_chk(param_2, 1, " ippeerlimit %d",
                          (int)*(short *)(piVar7 + 5));
            if ((int *)piVar7[3] != (int *)0x0) {
                for (piVar8 = *(int **)piVar7[3]; piVar8 != (int *)0x0;
                     piVar8 = (int *)*piVar8) {
                    if (piVar8[1] != 0x199) {
                        uVar2 = FUN_0002c300();
                        __fprintf_chk(param_2, 1, " %s", uVar2);
                    }
                }
            }
            fputc(10, param_2);
        }
    }
    if (*(int **)(param_1 + 0xa4) != (int *)0x0) {
        for (piVar7 = (int *)**(int **)(param_1 + 0xa4); piVar7 != (int *)0x0;
             piVar7 = (int *)*piVar7) {
            uVar2 = FUN_0002c300(piVar7[3]);
            if (piVar7[1] == 0) {
                uVar3 = piVar7[2];
            } else {
                uVar3 = FUN_0002c300();
            }
            __fprintf_chk(param_2, 1, "interface %s %s\n", uVar2, uVar3);
        }
    }
    if ((*(int **)(param_1 + 0x90) != (int *)0x0) &&
        (piVar7 = (int *)**(int **)(param_1 + 0x90), piVar7 != (int *)0x0)) {
        fwrite("phone", 1, 5, param_2);
        do {
            __fprintf_chk(param_2, 1, " \"%s\"", piVar7[1]);
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
        fputc(10, param_2);
    }
    if (*(int **)(param_1 + 0x94) != (int *)0x0) {
        for (piVar7 = (int *)**(int **)(param_1 + 0x94); piVar7 != (int *)0x0;
             piVar7 = (int *)*piVar7) {
            __ptr = (void *)FUN_0002c758(piVar7[1]);
            __ptr_00 = (void *)FUN_0002c758(piVar7[2]);
            __fprintf_chk(param_2, 1, "setvar %s = %s", __ptr, __ptr_00);
            free(__ptr);
            free(__ptr_00);
            if (piVar7[3] != 0) {
                fwrite(" default", 1, 8, param_2);
            }
            fputc(10, param_2);
        }
    }
    if ((*(int **)(param_1 + 0x98) != (int *)0x0) &&
        (piVar7 = (int *)**(int **)(param_1 + 0x98), piVar7 != (int *)0x0)) {
        fwrite(&DAT_0009dc38, 1, 3, param_2);
        do {
            __fprintf_chk(param_2, 1, " %d", piVar7[1]);
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
        fputc(10, param_2);
    }
    if (*(int **)(param_1 + 0x9c) != (int *)0x0) {
        for (piVar7 = (int *)**(int **)(param_1 + 0x9c); piVar7 != (int *)0x0;
             piVar7 = (int *)*piVar7) {
            __fprintf_chk(param_2, 1, "trap %s",
                          *(undefined4 *)(piVar7[1] + 4));
            if ((int *)piVar7[2] != (int *)0x0) {
                for (piVar8 = *(int **)piVar7[2]; piVar8 != (int *)0x0;
                     piVar8 = (int *)*piVar8) {
                    while (piVar8[1] != 0x140) {
                        if (piVar8[1] == 0x189) {
                            __fprintf_chk(param_2, 1, " port %d", piVar8[4]);
                        }
                        piVar8 = (int *)*piVar8;
                        if (piVar8 == (int *)0x0)
                            goto LAB_0001eb20;
                    }
                    __fprintf_chk(param_2, 1, " interface %s", piVar8[4]);
                }
            }
        LAB_0001eb20:
            fputc(10, param_2);
        }
    }
    if ((*(int **)(param_1 + 0xa8) != (int *)0x0) &&
        (piVar7 = (int *)**(int **)(param_1 + 0xa8), piVar7 != (int *)0x0)) {
        fwrite("reset", 1, 5, param_2);
        do {
            uVar2 = FUN_0002c300(piVar7[1]);
            __fprintf_chk(param_2, 1, " %s", uVar2);
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
        fputc(10, param_2);
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(0);
}

void FUN_0001ee5c(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    uint uVar2;
    int *piVar3;
    uint uVar4;

    iVar1 = __stack_chk_guard;
    if (cfg_tree_history == (int *)0x0) {
        uVar4 = 0;
    } else {
        uVar4 = 0;
        piVar3 = cfg_tree_history;
        do {
            uVar2 = FUN_0001d7dc(piVar3, param_1, param_2);
            piVar3 = (int *)*piVar3;
            uVar4 = uVar4 | uVar2;
        } while (piVar3 != (int *)0x0);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar4);
}

void FUN_0001eef0(undefined4 *param_1, undefined4 *param_2)

{
    int iVar1;
    undefined4 *puVar2;

    iVar1 = __stack_chk_guard;
    if (param_1 == (undefined4 *)0x0) {
        param_1 = (undefined4 *)FUN_00074b04(0, 8, 0, 1);
    }
    if (param_2 != (undefined4 *)0x0) {
        puVar2 = (undefined4 *)param_1[1];
        *param_2 = 0;
        if (puVar2 == (undefined4 *)0x0) {
            *param_1 = param_2;
            param_1[1] = param_1;
        } else {
            *(undefined4 **)*puVar2 = param_2;
            param_1[1] = *puVar2;
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(param_1);
    }
    return;
}

void FUN_0001ef88(undefined4 *param_1, undefined4 *param_2)

{
    int iVar1;
    undefined4 *puVar2;
    undefined4 *puVar3;
    undefined4 uVar4;
    undefined4 *puVar5;

    iVar1 = __stack_chk_guard;
    puVar2 = param_2;
    if ((param_1 != (undefined4 *)0x0) &&
        (puVar2 = param_1, param_2 != (undefined4 *)0x0)) {
        puVar5 = (undefined4 *)param_2[1];
        if (puVar5 != (undefined4 *)0x0) {
            puVar3 = (undefined4 *)param_1[1];
            if (puVar3 == (undefined4 *)0x0) {
                uVar4 = param_2[1];
                *param_1 = *param_2;
                param_1[1] = uVar4;
            } else {
                *(undefined4 *)*puVar3 = *param_2;
                if (puVar5 == param_2) {
                    puVar5 = (undefined4 *)*puVar3;
                }
                param_1[1] = puVar5;
            }
        }
        free(param_2);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(puVar2);
    }
    return;
}

void FUN_0001f038(int *param_1, code *param_2)

{
    int iVar1;
    int *piVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    if (param_1 != (int *)0x0) {
        if (param_2 == (code *)0x0) {
            param_2 = free;
        }
        while (piVar2 = (int *)*param_1, piVar2 != (int *)0x0) {
            iVar3 = *piVar2;
            *param_1 = iVar3;
            if (iVar3 == 0) {
                param_1[1] = 0;
            } else if ((int *)param_1[1] == piVar2) {
                param_1[1] = (int)param_1;
            }
            (*param_2)();
        }
        free(param_1);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(0);
    }
    return;
}

void destroy_attr_val(void *param_1)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if (param_1 == (void *)0x0) {
        return;
    }
    if (*(int *)((int)param_1 + 8) == 0x1a3) {
        free(*(void **)((int)param_1 + 0x10));
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    free(param_1);
    return;
}

void FUN_0001f168(undefined4 param_1)

{
    int iVar1;
    int iVar2;
    bool bVar3;
    undefined8 in_d0;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00074b04(0, 0x18, 0, 1);
    bVar3 = iVar1 == __stack_chk_guard;
    *(undefined4 *)(iVar2 + 4) = param_1;
    *(undefined4 *)(iVar2 + 8) = 0x121;
    *(undefined8 *)(iVar2 + 0x10) = in_d0;
    if (bVar3) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001f1e0(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    int iVar2;
    bool bVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00074b04(0, 0x18, 0, 1);
    bVar3 = iVar1 == __stack_chk_guard;
    *(undefined4 *)(iVar2 + 4) = param_1;
    *(undefined4 *)(iVar2 + 0x10) = param_2;
    *(undefined4 *)(iVar2 + 8) = 0x13f;
    if (bVar3) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001f250(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    int iVar2;
    bool bVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00074b04(0, 0x18, 0, 1);
    bVar3 = iVar1 == __stack_chk_guard;
    *(undefined4 *)(iVar2 + 4) = param_1;
    *(undefined4 *)(iVar2 + 0x10) = param_2;
    *(undefined4 *)(iVar2 + 8) = 0x1b2;
    if (bVar3) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001f2c0(undefined4 param_1, undefined4 param_2, undefined4 param_3)

{
    int iVar1;
    int iVar2;
    bool bVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00074b04(0, 0x18, 0, 1);
    bVar3 = iVar1 == __stack_chk_guard;
    *(undefined4 *)(iVar2 + 4) = param_1;
    *(undefined4 *)(iVar2 + 0x10) = param_2;
    *(undefined4 *)(iVar2 + 0x14) = param_3;
    *(undefined4 *)(iVar2 + 8) = 0x141;
    if (bVar3) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001f338(undefined4 param_1, int param_2)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = FUN_00074b04(0, 0x18, 0, 1);
    *(undefined4 *)(iVar3 + 4) = param_1;
    if (param_2 == 0) {
        param_2 = FUN_00074c8c(&DAT_000a9528);
    }
    iVar2 = __stack_chk_guard;
    *(int *)(iVar3 + 0x10) = param_2;
    *(undefined4 *)(iVar3 + 8) = 0x1a3;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar3);
}

void FUN_0001f3d0(undefined4 param_1)

{
    int iVar1;
    int iVar2;
    bool bVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00074b04(0, 8, 0, 1);
    bVar3 = iVar1 == __stack_chk_guard;
    *(undefined4 *)(iVar2 + 4) = param_1;
    if (bVar3) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001f430(undefined4 param_1)

{
    int iVar1;
    int iVar2;
    bool bVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00074b04(0, 8, 0, 1);
    bVar3 = iVar1 == __stack_chk_guard;
    *(undefined4 *)(iVar2 + 4) = param_1;
    if (bVar3) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001f490(int param_1, uint param_2)

{
    int iVar1;
    int iVar2;
    bool bVar3;

    iVar1 = __stack_chk_guard;
    if (param_1 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_config.c", 0x4f3, 0, "((void *)0) != addr");
    }
    if (param_2 != 10 && (param_2 & 0xfffffffd) != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_config.c", 0x4f4, 0,
                     "2 == type || 10 == type || 0 == type");
    }
    iVar2 = FUN_00074b04(0, 0xc, 0, 1);
    bVar3 = iVar1 != __stack_chk_guard;
    *(int *)(iVar2 + 4) = param_1;
    *(short *)(iVar2 + 8) = (short)param_2;
    if (bVar3) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0001f55c(void *param_1)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if (param_1 == (void *)0x0) {
        return;
    }
    if (*(void **)((int)param_1 + 4) != (void *)0x0) {
        free(*(void **)((int)param_1 + 4));
        if (iVar1 != __stack_chk_guard) {
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
        free(param_1);
        return;
    }
    /* WARNING: Subroutine does not return */
    FUN_0007fc54("ntp_config.c", 0x504, 0, "((void *)0) != my_node->address");
}

void FUN_0001f5fc(int param_1, int param_2, int *param_3)

{
    bool bVar1;
    int iVar2;
    int *__ptr;
    undefined4 uVar3;
    uint uVar4;
    int iVar5;
    int *__ptr_00;

    iVar2 = __stack_chk_guard;
    __ptr = (int *)FUN_00074b04(0, 0x24, 0, 1);
    __ptr[1] = param_1;
    __ptr[2] = param_2;
    *(undefined1 *)(__ptr + 6) = 4;
    if (param_3 != (int *)0x0) {
        __ptr_00 = (int *)*param_3;
        if (__ptr_00 == (int *)0x0) {
            free(param_3);
        } else {
            bVar1 = false;
            do {
                while (true) {
                    iVar5 = *__ptr_00;
                    *param_3 = iVar5;
                    if (iVar5 == 0) {
                        param_3[1] = 0;
                    } else if ((int *)param_3[1] == __ptr_00) {
                        param_3[1] = (int)param_3;
                    }
                    iVar5 = __ptr_00[1];
                    if (iVar5 != 0x167)
                        break;
                    iVar5 = __ptr_00[4];
                    if (iVar5 - 3U < 0xfd) {
                        *(char *)(__ptr + 4) = (char)iVar5;
                    } else {
                        FUN_00075d40(6,
                                     "minpoll: provided value (%d) is out of "
                                     "range [%d-%d])",
                                     iVar5, 3, 0xff);
                        *(undefined1 *)(__ptr + 4) = 3;
                    }
                LAB_0001f758:
                    free(__ptr_00);
                    __ptr_00 = (int *)*param_3;
                    if (__ptr_00 == (int *)0x0)
                        goto LAB_0001f76c;
                }
                if (iVar5 < 0x168) {
                    if (iVar5 == 0x149) {
                        if (__ptr_00[4] == -1) {
                            FUN_00075d40(3, "key: invalid argument");
                            bVar1 = true;
                        } else {
                            __ptr[7] = __ptr_00[4];
                        }
                    } else if (iVar5 == 0x15f) {
                        uVar4 = __ptr_00[4];
                        if (uVar4 < 0x12) {
                            *(char *)((int)__ptr + 0x11) = (char)uVar4;
                        } else {
                            FUN_00075d40(6,
                                         "maxpoll: provided value (%d) is out "
                                         "of range [0-%d])",
                                         uVar4, 0x11);
                            *(undefined1 *)((int)__ptr + 0x11) = 0x11;
                        }
                    } else {
                        if (iVar5 != 0x138)
                            goto LAB_0001f73c;
                        __ptr[8] = __ptr_00[4];
                    }
                    goto LAB_0001f758;
                }
                if (iVar5 == 0x1b0) {
                    iVar5 = FUN_0001c9e0(param_2);
                    if (iVar5 == 0) {
                        uVar4 = __ptr_00[4];
                        if (uVar4 < 8) {
                        LAB_0001f7b8:
                            __ptr[5] = uVar4;
                        } else {
                            FUN_00075d40(3, "ttl: invalid argument");
                            bVar1 = true;
                        }
                    } else {
                        FUN_00075d40(3, "\'ttl\' does not apply for refclocks");
                        bVar1 = true;
                    }
                    goto LAB_0001f758;
                }
                if (iVar5 < 0x1b1) {
                    if (iVar5 == 0x169) {
                        iVar5 = FUN_0001c9e0(param_2);
                        if (iVar5 != 0) {
                            uVar4 = __ptr_00[4];
                            goto LAB_0001f7b8;
                        }
                        FUN_00075d40(
                            3, "\'mode\' does not apply for network peers");
                        bVar1 = true;
                    } else {
                    LAB_0001f73c:
                        uVar3 = FUN_0002bdf0();
                        bVar1 = true;
                        FUN_00075d40(3, "Unknown peer/server option token %s",
                                     uVar3);
                    }
                    goto LAB_0001f758;
                }
                if (iVar5 == 0x1b8) {
                    if ((uint)__ptr_00[4] < 0xff) {
                        *(char *)(__ptr + 6) = (char)__ptr_00[4];
                    } else {
                        FUN_00075d40(3, "version: invalid argument");
                        bVar1 = true;
                    }
                    goto LAB_0001f758;
                }
                if (iVar5 != 0x1be)
                    goto LAB_0001f73c;
                iVar5 = FUN_0001eef0(__ptr[3], __ptr_00);
                __ptr_00 = (int *)*param_3;
                __ptr[3] = iVar5;
            } while (__ptr_00 != (int *)0x0);
        LAB_0001f76c:
            free(param_3);
            if (bVar1) {
                free(__ptr);
                __ptr = __ptr_00;
            }
        }
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__ptr);
    }
    return;
}

void FUN_0001f91c(int param_1)

{
    ushort uVar1;
    int iVar2;
    int iVar3;
    ushort **ppuVar4;
    uint uVar5;
    uint uVar6;
    byte *pbVar7;

    iVar2 = __stack_chk_guard;
    iVar3 = FUN_00074b04(0, 0xc, 0, 1);
    ppuVar4 = __ctype_b_loc();
    uVar6 = 0;
    pbVar7 = (byte *)(*(int *)(param_1 + 4) + -1);
    while (true) {
        pbVar7 = pbVar7 + 1;
        uVar5 = (uint)*pbVar7;
        uVar1 = (*ppuVar4)[uVar5];
        if ((uVar1 & 0x800) == 0)
            break;
        uVar6 = (uVar5 - 0x30) + uVar6 * 10 | uVar6 & 0xff000000;
    }
    if (uVar6 < 0x10000 && uVar5 == 0) {
        *(short *)(iVar3 + 4) = (short)uVar6;
        *(uint *)(iVar3 + 8) = uVar1 & 0x800;
        FUN_0001f55c(param_1);
    } else {
        *(undefined2 *)(iVar3 + 4) = 0;
        *(int *)(iVar3 + 8) = param_1;
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar3);
    }
    return;
}

void FUN_0001fa00(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    int iVar2;
    bool bVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00074b04(0, 0xc, 0, 1);
    bVar3 = iVar1 == __stack_chk_guard;
    *(undefined4 *)(iVar2 + 4) = param_1;
    *(undefined4 *)(iVar2 + 8) = param_2;
    if (bVar3) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001fa68(undefined4 param_1, undefined4 param_2, undefined2 param_3,
                  undefined4 param_4, undefined4 param_5)

{
    int iVar1;
    int iVar2;
    bool bVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00074b04(0, 0x18, 0, 1);
    bVar3 = iVar1 == __stack_chk_guard;
    *(undefined4 *)(iVar2 + 4) = param_1;
    *(undefined4 *)(iVar2 + 8) = param_2;
    *(undefined2 *)(iVar2 + 0x14) = param_3;
    *(undefined4 *)(iVar2 + 0xc) = param_4;
    *(undefined4 *)(iVar2 + 0x10) = param_5;
    if (bVar3) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001fae8(char *param_1, undefined4 param_2, undefined4 param_3)

{
    int iVar1;
    char *pcVar2;
    int iVar3;
    bool bVar4;

    iVar1 = __stack_chk_guard;
    pcVar2 = strchr(param_1, 0x3d);
    if (pcVar2 != (char *)0x0) {
        *pcVar2 = '\0';
    }
    iVar3 = FUN_00074b04(0, 0x10, 0, 1);
    bVar4 = iVar1 != __stack_chk_guard;
    *(char **)(iVar3 + 4) = param_1;
    *(undefined4 *)(iVar3 + 8) = param_2;
    *(undefined4 *)(iVar3 + 0xc) = param_3;
    if (bVar4) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0001fb6c(int param_1, int param_2, undefined4 param_3)

{
    int iVar1;
    int iVar2;
    bool bVar3;

    iVar1 = __stack_chk_guard;
    if (param_2 == 0 && param_1 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_config.c", 0x698, param_2 != 0 || param_1 != 0,
                     "match_class != 0 || if_name != ((void *)0)");
    }
    iVar2 = FUN_00074b04(0, 0x10, 0, 1);
    bVar3 = iVar1 == __stack_chk_guard;
    *(int *)(iVar2 + 4) = param_1;
    *(int *)(iVar2 + 8) = param_2;
    *(undefined4 *)(iVar2 + 0xc) = param_3;
    if (bVar3) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001fc14(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    int iVar2;
    bool bVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00074b04(0, 0xc, 0, 1);
    bVar3 = iVar1 == __stack_chk_guard;
    *(undefined4 *)(iVar2 + 4) = param_1;
    *(undefined4 *)(iVar2 + 8) = param_2;
    if (bVar3) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001fc7c(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    int iVar2;
    bool bVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00074b04(0, 0xc, 0);
    bVar3 = iVar1 == __stack_chk_guard;
    *(undefined4 *)(iVar2 + 4) = param_1;
    *(undefined4 *)(iVar2 + 8) = param_2;
    if (bVar3) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Enum "__rlimit_resource": Some values do not have unique names */

void FUN_0001fce4(__rlimit_resource_t param_1, undefined4 param_2, uint param_3,
                  uint param_4)

{
    __rlimit_resource_t __resource;
    int iVar1;
    bool bVar2;
    rlimit64 local_30;
    int local_1c;

    local_1c = __stack_chk_guard;
    if (param_1 == RLIMIT_NOFILE) {
        local_30.rlim_cur._0_4_ = param_3;
        local_30.rlim_cur._4_4_ = param_4;
        local_30.rlim_max._0_4_ = param_3;
        local_30.rlim_max._4_4_ = param_4;
        iVar1 = setrlimit64(RLIMIT_NOFILE, &local_30);
        if (iVar1 == -1) {
            FUN_00075d40(3, "Cannot set RLIMIT_NOFILE: %m");
        }
    } else if (param_1 == __RLIMIT_MEMLOCK) {
        if ((*(uint *)(ntpdOptions._68_4_ + 0x5d0) & 0xf) == 0) {
            local_30.rlim_cur._0_4_ = param_3;
            local_30.rlim_cur._4_4_ = param_4;
            local_30.rlim_max._0_4_ = param_3;
            local_30.rlim_max._4_4_ = param_4;
            iVar1 = setrlimit64(__RLIMIT_MEMLOCK, &local_30);
            if (iVar1 == -1) {
                FUN_00075d40(3, "Cannot set RLIMIT_MEMLOCK: %m");
            }
        }
    } else {
        __resource = param_1;
        if (param_1 != RLIMIT_STACK) {
            __resource =
                FUN_0001ca54("ntp_rlimit: unexpected RLIMIT case: %d", param_1);
        }
        iVar1 = getrlimit64(__resource, &local_30);
        if (iVar1 == -1) {
            FUN_00075d40(param_1, "getrlimit(RLIMIT_STACK) failed: %m");
        } else {
            bVar2 = local_30.rlim_max._4_4_ <= param_4;
            if (param_4 == local_30.rlim_max._4_4_) {
                bVar2 = (uint)local_30.rlim_max <= param_3;
            }
            if (bVar2 && (param_4 != local_30.rlim_max._4_4_ ||
                          param_3 != (uint)local_30.rlim_max)) {
                FUN_00075d40(4,
                             "ntp_rlimit: using maximum allowed stack limit "
                             "%lu instead of %lu.",
                             (uint)local_30.rlim_max, param_3);
                param_3 = (uint)local_30.rlim_max;
                param_4 = local_30.rlim_max._4_4_;
            }
            local_30.rlim_cur._0_4_ = param_3;
            local_30.rlim_cur._4_4_ = param_4;
            iVar1 = setrlimit64(RLIMIT_STACK, &local_30);
            if (iVar1 == -1) {
                FUN_00075d40(3, "ntp_rlimit: Cannot set RLIMIT_STACK: %m");
            }
        }
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Control flow encountered bad instruction data */

void FUN_0001fe68(char *param_1)

{
    ushort uVar1;
    undefined2 uVar2;
    int iVar3;
    addrinfo *__dest;
    FILE *pFVar4;
    int iVar5;
    undefined4 uVar6;
    int *piVar7;
    uint uVar8;
    size_t sVar9;
    size_t sVar10;
    undefined4 *puVar11;
    undefined4 *puVar12;
    char *pcVar13;
    undefined4 *extraout_r3;
    undefined4 uVar14;
    addrinfo *paVar15;
    int iVar16;
    addrinfo *paVar17;
    int iVar18;
    addrinfo *paVar19;
    void *pvVar20;
    addrinfo **ppaVar21;
    char *pcVar22;
    undefined1 uVar23;
    undefined1 *puVar24;
    char *unaff_r10;
    int *piVar25;
    int *extraout_r12;
    undefined4 uVar26;
    bool bVar27;
    double dVar28;
    char *local_12c;
    addrinfo *local_128;
    addrinfo **local_124;
    addrinfo *local_d4;
    addrinfo local_d0;
    int local_a8;
    int iStack_a4;
    int local_a0;
    int iStack_9c;
    int local_98;
    undefined4 local_94[4];
    undefined4 local_84;
    addrinfo *local_80;
    addrinfo *local_7c;
    addrinfo *local_78;
    addrinfo *local_74;
    addrinfo *local_70;
    addrinfo *local_6c;
    undefined4 local_68;
    addrinfo *local_64;
    addrinfo *local_60;
    addrinfo *local_5c;
    addrinfo *local_58;
    addrinfo *local_54;
    addrinfo *local_50;
    undefined1 auStack_4c[8];
    int local_44;

    local_44 = __stack_chk_guard;
    __dest = (addrinfo *)FUN_00074b04(0, 0xb8, 0);
    memcpy(__dest, cfgt, 0xb8);
    memset(cfgt, 0, 0xb8);
    puVar11 = &cfg_tree_history;
    for (puVar12 = cfg_tree_history; puVar12 != (undefined4 *)0x0;
         puVar12 = (undefined4 *)*puVar12) {
        puVar11 = puVar12;
    }
LAB_0001fef8:
    __dest->ai_flags = 0;
    *puVar11 = __dest;
    puVar24 = ntpdOptions;
    if ((*(uint *)(ntpdOptions._68_4_ + 0x5d0) & 0xf) != 0) {
        pFVar4 = fopen64(*(char **)(ntpdOptions._68_4_ + 0x5d8), "w");
        if (pFVar4 == (FILE *)0x0) {
            piVar7 = __errno_location();
            iVar5 = *piVar7;
            FUN_00075c04(stderr, "can not create save file %s, error %d %m\n",
                         *(undefined4 *)(ntpdOptions._68_4_ + 0x5d8), iVar5);
            /* WARNING: Subroutine does not return */
            exit(iVar5);
        }
        iVar5 = FUN_0001ee5c(pFVar4, 0);
        if (iVar5 == 0) {
            __fprintf_chk(stderr, 1, "configuration saved to %s\n",
                          *(undefined4 *)(ntpdOptions._68_4_ + 0x5d8));
        } else {
            __fprintf_chk(stderr, 1, "--saveconfigquit %s error %d\n",
                          *(undefined4 *)(ntpdOptions._68_4_ + 0x5d8), iVar5);
        }
        /* WARNING: Subroutine does not return */
        exit(iVar5);
    }
    if (param_1 == (char *)0x0)
        goto LAB_0001ff98;
    if ((int *)__dest[1].ai_canonname == (int *)0x0) {
        uVar8 = FUN_00077f90();
        if (0x63df < uVar8)
            goto LAB_0001ff98;
        bVar27 = false;
    LAB_000205fc:
        iVar5 = FUN_00077dd0();
        FUN_00077fe4(iVar5 + -0xb);
    } else {
        piVar7 = *(int **)__dest[1].ai_canonname;
        if (piVar7 == (int *)0x0) {
            uVar8 = FUN_00077f90();
            if (0x63df < uVar8)
                goto LAB_0001ff98;
            bVar27 = false;
            goto LAB_000205fc;
        }
        bVar27 = false;
        do {
            while (piVar7[1] != 0x10b) {
                piVar7 = (int *)*piVar7;
                if (piVar7 == (int *)0x0)
                    goto LAB_00020450;
            }
            bVar27 = true;
            FUN_00077fe4(piVar7[4]);
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
    LAB_00020450:
        uVar8 = FUN_00077f90();
        if (uVar8 < 0x63e0)
            goto LAB_000205fc;
    }
    if (bVar27) {
        FUN_000711b8();
    }
LAB_0001ff98:
    if ((int *)__dest[5].ai_family == (int *)0x0)
        goto LAB_00020064;
    piVar7 = *(int **)__dest[5].ai_family;
    if (piVar7 == (int *)0x0)
        goto LAB_00020064;
    if (((*(uint *)(ntpdOptions._68_4_ + 0x3d0) & 0xf) != 0) ||
        ((*(uint *)(ntpdOptions._68_4_ + 0x310) & 0xf) != 0)) {
        if (param_1 == (char *)0x0) {
            FUN_00075d40(3,
                         "interface/nic rules are not allowed with --interface "
                         "(-I) or --novirtualips (-L)%s",
                         &DAT_000a9528);
            goto LAB_00020064;
        }
        FUN_00075d40(3,
                     "interface/nic rules are not allowed with --interface "
                     "(-I) or --novirtualips (-L)%s",
                     ", exiting");
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    paVar19 = (addrinfo *)0xffffffff;
    ppaVar21 = (addrinfo **)0x146;
    local_12c = "%d";
    do {
        local_d0.ai_flags = (int)paVar19;
        if (piVar7[2] == 0) {
            unaff_r10 = (char *)piVar7[1];
            param_1 = (char *)0x0;
            if ((addrinfo **)unaff_r10 == (addrinfo **)0x144)
                goto LAB_000205e0;
            if (0x144 < (int)unaff_r10)
                goto LAB_00020480;
            if ((addrinfo **)unaff_r10 == (addrinfo **)0x0) {
            LAB_00022a88:
                /* WARNING: Subroutine does not return */
                FUN_0007fc54("ntp_config.c", 0xbeb, 2,
                             "if_name != ((void *)0)");
            }
            if ((addrinfo **)unaff_r10 != (addrinfo **)0x104)
                goto LAB_000201b4;
            uVar6 = 0;
        LAB_00020498:
            iVar5 = piVar7[3];
            if (iVar5 == 0x139) {
            LAB_000205d0:
                uVar14 = 1;
                goto LAB_00020530;
            }
            if (iVar5 == 0x152) {
                uVar14 = 0;
                goto LAB_00020530;
            }
        } else {
            param_1 = (char *)FUN_00074c8c(piVar7[2]);
            unaff_r10 = (char *)piVar7[1];
            if ((addrinfo **)unaff_r10 == (addrinfo **)0x144) {
            LAB_000205e0:
                uVar6 = 1;
                goto LAB_00020498;
            }
            if (0x144 < (int)unaff_r10) {
            LAB_00020480:
                if ((addrinfo **)unaff_r10 == ppaVar21) {
                    uVar6 = 2;
                } else {
                    if ((addrinfo **)unaff_r10 != (addrinfo **)0x1bb) {
                    LAB_000201b4:
                        iVar5 = FUN_0001ca54(
                            "config_nic_rules: match-class-token=%d",
                            unaff_r10);
                        piVar25 = extraout_r12;
                        goto LAB_000201c4;
                    }
                    uVar6 = 3;
                }
                goto LAB_00020498;
            }
            if ((addrinfo **)unaff_r10 != (addrinfo **)0x0) {
                if ((addrinfo **)unaff_r10 != (addrinfo **)0x104)
                    goto LAB_000201b4;
                uVar6 = 0;
                goto LAB_00020498;
            }
            if (param_1 == (char *)0x0)
                goto LAB_00022a88;
            paVar15 = (addrinfo *)strchr(param_1, 0x2f);
            if (paVar15 == (addrinfo *)0x0) {
                iVar5 = FUN_00074fd8(param_1, 0, &local_68);
                if (iVar5 == 0)
                    goto LAB_000205bc;
            LAB_00020624:
                uVar6 = 5;
            } else {
                *(char *)&paVar15->ai_flags = '\0';
                iVar5 = FUN_00074fd8(param_1, 0, &local_68);
                local_128 = paVar15;
                if (iVar5 == 0) {
                    *(char *)&paVar15->ai_flags = '/';
                LAB_000205bc:
                    uVar6 = 4;
                } else {
                    iVar5 = sscanf((char *)((int)&paVar15->ai_flags + 1),
                                   local_12c, &local_d0);
                    if (iVar5 != 1)
                        goto LAB_00020624;
                    uVar6 = 5;
                    paVar15 = (addrinfo *)(local_d0.ai_flags |
                                           local_d0.ai_flags >> 0x1f);
                    if (((uint)local_68 & 0xffff) == 2) {
                        local_d0.ai_flags = (int)&DAT_00000020;
                    } else {
                        local_d0.ai_flags = 0x80;
                    }
                    if ((int)paVar15 <= local_d0.ai_flags) {
                        local_d0.ai_flags = (int)paVar15;
                    }
                }
            }
            iVar5 = piVar7[3];
            if (iVar5 == 0x139)
                goto LAB_000205d0;
            if (iVar5 == 0x152) {
                FUN_00026060(uVar6, param_1, local_d0.ai_flags, 0);
                FUN_00051c38(current_time + 2);
                goto LAB_00020558;
            }
        }
        if (iVar5 != 0x123)
            break;
    LAB_0002052c:
        uVar14 = 2;
    LAB_00020530:
        FUN_00026060(uVar6, param_1, local_d0.ai_flags, uVar14);
        FUN_00051c38(current_time + 2);
        if (param_1 != (char *)0x0) {
        LAB_00020558:
            free(param_1);
        }
        piVar7 = (int *)*piVar7;
        if (piVar7 == (int *)0x0) {
        LAB_00020064:
            if (__dest[2].ai_flags != 0) {
                FUN_00053708(2);
            }
            if (__dest[1].ai_next != (addrinfo *)0x0) {
                for (piVar7 = (int *)(__dest[1].ai_next)->ai_flags;
                     piVar7 != (int *)0x0; piVar7 = (int *)*piVar7) {
                    while (true) {
                        uVar6 = FUN_0002c300(piVar7[1]);
                        iVar5 = FUN_0003ca74();
                        if (iVar5 != 0)
                            break;
                        FUN_00075d40(3, "stats %s unrecognized", uVar6);
                        piVar7 = (int *)*piVar7;
                        if (piVar7 == (int *)0x0)
                            goto LAB_000200fc;
                    }
                    FUN_0003c8c8(iVar5, statsdir, uVar6,
                                 *(undefined1 *)(iVar5 + 0x14),
                                 *(byte *)(iVar5 + 0x15) | 0x80);
                }
            }
        LAB_000200fc:
            if (((int *)__dest[2].ai_family != (int *)0x0) &&
                (piVar7 = *(int **)__dest[2].ai_family, piVar7 != (int *)0x0)) {
                param_1 = (char *)0x1b1;
                local_12c = "filegen category \'%s\' unrecognized";
                local_128 = __dest;
                local_124 = (addrinfo **)puVar24;
                do {
                    paVar19 = (addrinfo *)FUN_0002c300(piVar7[1]);
                    iVar5 = FUN_0003ca74();
                    if (iVar5 == 0) {
                        FUN_00075d40(3, local_12c, paVar19);
                    } else {
                        if (((int *)piVar7[2] != (int *)0x0) &&
                            (piVar25 = *(int **)piVar7[2],
                             piVar25 != (int *)0x0)) {
                            ppaVar21 = (addrinfo **)0x173;
                            unaff_r10 = (char *)0x1ba;
                            __dest = (addrinfo *)0x1bd;
                            puVar24 = (undefined1 *)0x186;
                            do {
                                pcVar13 = (char *)piVar25[1];
                                if (pcVar13 == param_1) {
                                    paVar15 = (addrinfo *)piVar25[4];
                                    if (paVar15 != (addrinfo *)ppaVar21) {
                                        if ((int)paVar15 < 0x174) {
                                            if (((paVar15 !=
                                                  (addrinfo *)0x11b) &&
                                                 (paVar15 !=
                                                  (addrinfo *)0x16c)) &&
                                                (paVar15 !=
                                                 (addrinfo *)0x103)) {
                                            LAB_00020520:
                                                uVar6 = FUN_0001ca54(
                                                    "config-monitor: "
                                                    "type-token=%d");
                                                goto LAB_0002052c;
                                            }
                                        } else if (((paVar15 !=
                                                     (addrinfo *)unaff_r10) &&
                                                    (paVar15 != __dest)) &&
                                                   (paVar15 !=
                                                    (addrinfo *)puVar24))
                                            goto LAB_00020520;
                                    }
                                } else if (pcVar13 == (char *)0x1be) {
                                    iVar18 = piVar25[4];
                                    if (iVar18 != 0x126) {
                                        if (iVar18 < 0x127) {
                                            if (iVar18 != 0x11e)
                                                goto LAB_000206e0;
                                        } else if ((iVar18 != 0x151) &&
                                                   (iVar18 != 0x170)) {
                                        LAB_000206e0:
                                            FUN_00075d40(3, "Unknown filegen "
                                                            "flag token %d");
                                            /* WARNING: Subroutine does not
                                             * return */
                                            exit(1);
                                        }
                                    }
                                } else {
                                    if (pcVar13 != (char *)0x12a) {
                                        FUN_00075d40(
                                            3,
                                            "Unknown filegen option token %d");
                                        /* WARNING: Subroutine does not return
                                         */
                                        exit(1);
                                    }
                                LAB_000201c4:
                                    paVar19 = (addrinfo *)piVar25[4];
                                }
                                piVar25 = (int *)*piVar25;
                            } while (piVar25 != (int *)0x0);
                        }
                        FUN_0003c8c8(iVar5, statsdir, paVar19);
                    }
                    piVar7 = (int *)*piVar7;
                    puVar24 = (undefined1 *)local_124;
                    __dest = local_128;
                } while (piVar7 != (int *)0x0);
            }
            if ((*(addrinfo **)((int)(__dest + 3) + 0x10) == (addrinfo *)0x0) ||
                (piVar7 = (int *)(*(addrinfo **)((int)(__dest + 3) + 0x10))
                              ->ai_flags,
                 piVar7 == (int *)0x0))
                goto LAB_00020258;
            goto LAB_00020218;
        }
    } while (true);
    FUN_0001ca54("config_nic_rules: action-token=%d");
    puVar11 = extraout_r3;
    goto LAB_0001fef8;
LAB_00020218:
    do {
        iVar5 = piVar7[1];
        if (iVar5 == 0x138) {
            uVar6 = 2;
        } else if (iVar5 < 0x139) {
            if (iVar5 != 0x11d) {
                if (iVar5 == 0x135) {
                    uVar6 = 1;
                    goto LAB_00020244;
                }
            LAB_0002077c:
                FUN_0001ca54("config_auth: attr-token=%d");
            }
            uVar6 = 9;
        } else if (iVar5 == 0x18d) {
            uVar6 = 8;
        } else {
            if (iVar5 != 0x18e)
                goto LAB_0002077c;
            uVar6 = 4;
        }
    LAB_00020244:
        FUN_0003c018(uVar6, piVar7[4]);
        piVar7 = (int *)*piVar7;
    } while (piVar7 != (int *)0x0);
LAB_00020258:
    paVar19 = *(addrinfo **)((int)(__dest + 3) + 0x18);
    if (paVar19 != (addrinfo *)0x0) {
        if (keysdir != &default_keysdir) {
            free(keysdir);
            paVar19 = *(addrinfo **)((int)(__dest + 3) + 0x18);
        }
        keysdir = (undefined5 *)FUN_00074c8c(paVar19);
    }
    paVar19 = *(addrinfo **)((int)(__dest + 4) + 8);
    if (paVar19 != (addrinfo *)0x0) {
        if (ntp_signd_socket != &DAT_000c960c) {
            free(ntp_signd_socket);
            paVar19 = *(addrinfo **)((int)(__dest + 4) + 8);
        }
        ntp_signd_socket = (undefined *)FUN_00074c8c(paVar19);
    }
    if ((*(addrinfo **)((int)(__dest + 3) + 0xc) != (addrinfo *)0x0) &&
        (cryptosw == 0)) {
        FUN_0003b78c();
        cryptosw = 1;
    }
    paVar19 = *(addrinfo **)((int)(__dest + 4) + 4);
    if (paVar19 != (addrinfo *)0x0) {
        piVar7 = (int *)paVar19->ai_flags;
        if (piVar7 == (int *)0x0) {
            paVar19 = (addrinfo *)0x0;
        } else {
            paVar19 = (addrinfo *)0x0;
            do {
                if (piVar7[2] == 0x13f) {
                    if (piVar7[4] - 2U < 0xfffe) {
                        paVar19 = (addrinfo *)((int)&paVar19->ai_flags + 1);
                    }
                } else {
                    if (piVar7[2] != 0x141) {
                        /* WARNING: Subroutine does not return */
                        FUN_0007fc54("ntp_config.c", 0x7dc, 0,
                                     "321 == my_val->type");
                    }
                    iVar18 = piVar7[4];
                    iVar5 = piVar7[5];
                    if (iVar5 < 0x10000 && (iVar18 <= iVar5 && 0 < iVar18)) {
                        paVar19 =
                            (addrinfo *)((int)paVar19 + ((iVar5 + 1) - iVar18));
                    }
                }
                piVar7 = (int *)*piVar7;
            } while (piVar7 != (int *)0x0);
        }
    }
    FUN_00072cd4(paVar19);
    if (*(addrinfo **)((int)(__dest + 3) + 0x14) != (addrinfo *)0x0) {
        FUN_00053500();
    }
    if (*(addrinfo **)((int)(__dest + 3) + 8) != (addrinfo *)0x0) {
        ctl_auth_keyid = *(addrinfo **)((int)(__dest + 3) + 8);
    }
    if (*(addrinfo **)((int)(__dest + 3) + 0x1c) != (addrinfo *)0x0) {
        info_auth_keyid = *(addrinfo **)((int)(__dest + 3) + 0x1c);
    }
    if ((*(addrinfo **)((int)(__dest + 4) + 4) != (addrinfo *)0x0) &&
        (piVar7 = (int *)(*(addrinfo **)((int)(__dest + 4) + 4))->ai_flags,
         piVar7 != (int *)0x0)) {
        local_12c = "Ignoring invalid trustedkey %d, min 1 max %d.";
        do {
            if (piVar7[2] == 0x13f) {
                iVar5 = piVar7[4];
                if (iVar5 - 1U < 0xffff) {
                    FUN_000730c4(iVar5, 1);
                } else {
                    FUN_00075d40(
                        5, "Ignoring invalid trustedkey %d, min 1 max %d.",
                        iVar5, 0xffff);
                }
            } else {
                iVar5 = piVar7[4];
                unaff_r10 = (char *)piVar7[5];
                if ((int)unaff_r10 < 0x10000 &&
                    (0 < iVar5 && iVar5 <= (int)unaff_r10)) {
                    do {
                        iVar18 = iVar5 + 1;
                        FUN_000730c4(iVar5);
                        iVar5 = iVar18;
                    } while (iVar18 <= (int)unaff_r10);
                } else {
                    FUN_00075d40(5,
                                 "Ignoring invalid trustedkey range %d ... %d, "
                                 "min 1 max %d.",
                                 iVar5, unaff_r10, 0xffff);
                }
            }
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
    }
    paVar19 = *(addrinfo **)(__dest + 4);
    if ((undefined1 *)((int)&paVar19[-1].ai_next + 1U) < (undefined1 *)0x1d) {
        sys_revoke = SUB41(paVar19, 0);
    } else if (paVar19 != (addrinfo *)0x0) {
        FUN_00075d40(3, "\'revoke\' value %d ignored");
    }
    paVar15 = *(addrinfo **)((int)(__dest + 1) + 0x18);
    paVar19 = sys_minclock;
    pcVar13 = (char *)sys_maxclock;
    pcVar22 = (char *)sys_minsane;
    if (paVar15 == (addrinfo *)0x0) {
        bVar27 = SBORROW4((int)sys_maxclock, (int)sys_minclock);
        iVar5 = (int)sys_maxclock - (int)sys_minclock;
        paVar15 = sys_maxclock;
        if ((int)sys_minclock <= (int)sys_maxclock) {
            bVar27 = SBORROW4((int)sys_minclock, (int)sys_minsane);
            iVar5 = (int)sys_minclock - (int)sys_minsane;
            paVar15 = sys_minsane;
        }
        if (paVar15 == sys_minclock || iVar5 < 0 != bVar27)
            goto LAB_00020fb8;
    } else {
        piVar7 = (int *)paVar15->ai_flags;
        if (piVar7 == (int *)0x0) {
            bVar27 = SBORROW4((int)sys_maxclock, (int)sys_minclock);
            iVar5 = (int)sys_maxclock - (int)sys_minclock;
            paVar17 = sys_maxclock;
            if ((int)sys_minclock <= (int)sys_maxclock) {
                bVar27 = SBORROW4((int)sys_minclock, (int)sys_minsane);
                iVar5 = (int)sys_minclock - (int)sys_minsane;
                paVar17 = sys_minsane;
            }
            if (paVar17 == sys_minclock || iVar5 < 0 != bVar27)
                goto LAB_00020fb8;
        } else {
            local_12c = "Using minimum bcpollbstep floor %d, %d requested";
            unaff_r10 = "Using minimum tos floor %d, %d requested";
            local_128 = (addrinfo *)0x9e120;
            local_124 = (addrinfo **)0x9e188;
            do {
                iVar5 = piVar7[1];
                if (iVar5 == 0x15b) {
                    pcVar13 = (char *)(longlong) * (double *)(piVar7 + 4);
                    if ((int)pcVar13 < 1) {
                        piVar7[4] = 0;
                        piVar7[5] = 0x3ff00000;
                        pcVar13 = (char *)0x1;
                    }
                } else if (iVar5 < 0x15c) {
                    if (iVar5 == 0x10d) {
                        dVar28 = *(double *)(piVar7 + 4);
                        if (4.0 < dVar28) {
                            FUN_00075d40(4,
                                         "Using maximum bcpollbstep ceiling "
                                         "%d, %d requested",
                                         4, (int)(longlong)dVar28);
                            piVar7[4] = 0;
                            piVar7[5] = 0x40100000;
                        } else if (dVar28 < 0.0) {
                            FUN_00075d40(4,
                                         "Using minimum bcpollbstep floor %d, "
                                         "%d requested",
                                         0, (int)(longlong)dVar28);
                            piVar7[4] = 0;
                            piVar7[5] = 0;
                        }
                    } else if (iVar5 == 0x114) {
                        dVar28 = *(double *)(piVar7 + 4);
                        if (15.0 < dVar28) {
                            FUN_00075d40(
                                4, "Using maximum tos ceiling %d, %d requested",
                                0xf, (int)(longlong)dVar28);
                            piVar7[4] = 0;
                            piVar7[5] = 0x402e0000;
                        } else if (dVar28 < 1.0) {
                            FUN_00075d40(
                                4, "Using minimum tos floor %d, %d requested",
                                1, (int)(longlong)dVar28);
                            piVar7[4] = 0;
                            piVar7[5] = 0x3ff00000;
                        }
                    }
                } else if (iVar5 == 0x163) {
                    paVar19 = (addrinfo *)(longlong) * (double *)(piVar7 + 4);
                    if ((int)paVar19 < 1) {
                        piVar7[4] = 0;
                        piVar7[5] = 0x3ff00000;
                        paVar19 = (addrinfo *)0x1;
                    }
                } else if ((iVar5 == 0x168) &&
                           (pcVar22 =
                                (char *)(longlong) * (double *)(piVar7 + 4),
                            (int)pcVar22 < 0)) {
                    pcVar22 = (char *)0x0;
                    piVar7[4] = 0;
                    piVar7[5] = 0;
                }
                piVar7 = (int *)*piVar7;
            } while (piVar7 != (int *)0x0);
            bVar27 = SBORROW4((int)paVar19, (int)pcVar13);
            iVar5 = (int)paVar19 - (int)pcVar13;
            if ((int)paVar19 <= (int)pcVar13) {
                bVar27 = SBORROW4((int)pcVar22, (int)paVar19);
                iVar5 = (int)pcVar22 - (int)paVar19;
            }
            if (iVar5 < 0 == bVar27) {
            LAB_00020fb8:
                FUN_00075d40(
                    3,
                    "tos error: must have minsane (%d) < minclock (%d) <= "
                    "maxclock (%d) - daemon will not operate properly!",
                    pcVar22, paVar19, pcVar13);
            }
            paVar15 = *(addrinfo **)((int)(__dest + 1) + 0x18);
            if (paVar15 == (addrinfo *)0x0)
                goto LAB_00020cdc;
        }
        piVar7 = (int *)paVar15->ai_flags;
        if (piVar7 != (int *)0x0) {
        LAB_00020acc:
            switch (piVar7[1] + -0x10b) {
            case 0:
                goto LAB_00020cd0;
            case 1:
                break;
            case 2:
                uVar6 = 0x21;
                goto LAB_00020cc0;
            case 3:
                uVar6 = 0x19;
                goto LAB_00020cc0;
            case 4:
                break;
            case 5:
                break;
            case 6:
                break;
            case 7:
                break;
            case 8:
                break;
            case 9:
                uVar6 = 0x12;
                goto LAB_00020cc0;
            case 10:
                break;
            case 0xb:
                uVar6 = 0x13;
                goto LAB_00020cc0;
            case 0xc:
                break;
            case 0xd:
                break;
            case 0xe:
                break;
            case 0xf:
                break;
            case 0x10:
                break;
            case 0x11:
                break;
            case 0x12:
                break;
            case 0x13:
                break;
            case 0x14:
                break;
            case 0x15:
                break;
            case 0x16:
                break;
            case 0x17:
                break;
            case 0x18:
                break;
            case 0x19:
                break;
            case 0x1a:
                break;
            case 0x1b:
                break;
            case 0x1c:
                break;
            case 0x1d:
                break;
            case 0x1e:
                break;
            case 0x1f:
                break;
            case 0x20:
                break;
            case 0x21:
                break;
            case 0x22:
                break;
            case 0x23:
                break;
            case 0x24:
                break;
            case 0x25:
                break;
            case 0x26:
                break;
            case 0x27:
                uVar6 = 0x11;
                goto LAB_00020cc0;
            case 0x28:
                break;
            case 0x29:
                break;
            case 0x2a:
                break;
            case 0x2b:
                break;
            case 0x2c:
                break;
            case 0x2d:
                break;
            case 0x2e:
                break;
            case 0x2f:
                break;
            case 0x30:
                break;
            case 0x31:
                break;
            case 0x32:
                break;
            case 0x33:
                break;
            case 0x34:
                break;
            case 0x35:
                break;
            case 0x36:
                break;
            case 0x37:
                break;
            case 0x38:
                break;
            case 0x39:
                break;
            case 0x3a:
                break;
            case 0x3b:
                break;
            case 0x3c:
                break;
            case 0x3d:
                break;
            case 0x3e:
                break;
            case 0x3f:
                break;
            case 0x40:
                break;
            case 0x41:
                break;
            case 0x42:
                break;
            case 0x43:
                break;
            case 0x44:
                break;
            case 0x45:
                break;
            case 0x46:
                break;
            case 0x47:
                break;
            case 0x48:
                break;
            case 0x49:
                break;
            case 0x4a:
                break;
            case 0x4b:
                break;
            case 0x4c:
                break;
            case 0x4d:
                break;
            case 0x4e:
                break;
            case 0x4f:
                break;
            case 0x50:
                uVar6 = 0xf;
                goto LAB_00020cc0;
            case 0x51:
                break;
            case 0x52:
                uVar6 = 0x16;
                goto LAB_00020cc0;
            case 0x53:
                break;
            case 0x54:
                break;
            case 0x55:
                break;
            case 0x56:
                break;
            case 0x57:
                break;
            case 0x58:
                uVar6 = 0xe;
                goto LAB_00020cc0;
            case 0x59:
                break;
            case 0x5a:
                uVar6 = 0x15;
                goto LAB_00020cc0;
            case 0x5b:
                break;
            case 0x5c:
                break;
            case 0x5d:
                uVar6 = 0x10;
                goto LAB_00020cc0;
            case 0x5e:
                break;
            case 0x5f:
                break;
            case 0x60:
                break;
            case 0x61:
                break;
            case 0x62:
                break;
            case 99:
                break;
            case 100:
                break;
            case 0x65:
                break;
            case 0x66:
                break;
            case 0x67:
                break;
            case 0x68:
                break;
            case 0x69:
                break;
            case 0x6a:
                break;
            case 0x6b:
                break;
            case 0x6c:
                break;
            case 0x6d:
                break;
            case 0x6e:
                break;
            case 0x6f:
                break;
            case 0x70:
                break;
            case 0x71:
                break;
            case 0x72:
                break;
            case 0x73:
                break;
            case 0x74:
                uVar6 = 0x1a;
                goto LAB_00020cc0;
            case 0x75:
                uVar6 = 0x1b;
            LAB_00020cc0:
                FUN_00049000((int)*(undefined8 *)(piVar7 + 4), uVar6, 0);
            LAB_00020cd0:
                piVar7 = (int *)*piVar7;
                if (piVar7 == (int *)0x0)
                    goto LAB_00020cdc;
                goto LAB_00020acc;
            }
            FUN_0001ca54("config-tos: attr-token=%d");
            /* WARNING: Bad instruction - Truncating control flow here */
            halt_baddata();
        }
    }
LAB_00020cdc:
    if ((*(addrinfo **)((int)(__dest + 2) + 0xc) != (addrinfo *)0x0) &&
        (piVar7 = (int *)(*(addrinfo **)((int)(__dest + 2) + 0xc))->ai_flags,
         piVar7 != (int *)0x0)) {
        paVar19 = (addrinfo *)0x38e38e39;
        pcVar13 = "mru %s %d out of range, ignored.";
    LAB_00020d04:
        iVar5 = mru_mindepth;
        iVar3 = mru_incalloc;
        iVar18 = mru_initalloc;
        switch (piVar7[1]) {
        case 0x13a:
            iVar3 = piVar7[4];
            if (-1 < piVar7[4])
                goto LAB_00021014;
            goto LAB_0002108c;
        case 0x13b:
            if (piVar7[4] < 0)
                goto LAB_0002108c;
            uVar8 = piVar7[4] << 10;
            iVar5 = 0x950;
            goto LAB_000210bc;
        case 0x13c:
            iVar18 = piVar7[4];
            iVar16 = iVar18;
            goto joined_r0x00021004;
        case 0x13d:
            if (piVar7[4] < 0)
                goto LAB_0002108c;
            uVar8 = piVar7[4] << 10;
            iVar5 = 0x658;
            goto LAB_000210bc;
        case 0x13e:
            break;
        case 0x13f:
            break;
        case 0x140:
            break;
        case 0x141:
            break;
        case 0x142:
            break;
        case 0x143:
            break;
        case 0x144:
            break;
        case 0x145:
            break;
        case 0x146:
            break;
        case 0x147:
            break;
        case 0x148:
            break;
        case 0x149:
            break;
        case 0x14a:
            break;
        case 0x14b:
            break;
        case 0x14c:
            break;
        case 0x14d:
            break;
        case 0x14e:
            break;
        case 0x14f:
            break;
        case 0x150:
            break;
        case 0x151:
            break;
        case 0x152:
            break;
        case 0x153:
            break;
        case 0x154:
            break;
        case 0x155:
            break;
        case 0x156:
            break;
        case 0x157:
            break;
        case 0x158:
            break;
        case 0x159:
            break;
        case 0x15a:
            mru_maxage = piVar7[4];
            goto LAB_00021014;
        case 0x15b:
            break;
        case 0x15c:
            mru_maxdepth = piVar7[4];
            if (mru_maxdepth < 0) {
            LAB_00022ab8:
                mru_maxdepth = -1;
            }
            goto LAB_00021014;
        case 0x15d:
            break;
        case 0x15e:
            if (piVar7[4] < 0)
                goto LAB_00022ab8;
            iVar5 = 0x7a8;
            uVar8 = piVar7[4] << 10;
        LAB_000210bc:
            **(uint **)((int)&__DT_PLTGOT + iVar5) = uVar8 / 0x48;
            iVar5 = mru_mindepth;
            iVar3 = mru_incalloc;
            iVar18 = mru_initalloc;
            goto LAB_00021014;
        case 0x15f:
            break;
        case 0x160:
            break;
        case 0x161:
            break;
        case 0x162:
            break;
        case 0x163:
            break;
        case 0x164:
            iVar5 = piVar7[4];
            iVar16 = piVar7[4];
        joined_r0x00021004:
            if (iVar16 < 0) {
            LAB_0002108c:
                uVar6 = FUN_0002c300();
                FUN_00075d40(3, "mru %s %d out of range, ignored.", uVar6,
                             piVar7[4]);
                iVar5 = mru_mindepth;
                iVar3 = mru_incalloc;
                iVar18 = mru_initalloc;
            }
        LAB_00021014:
            mru_initalloc = iVar18;
            mru_incalloc = iVar3;
            mru_mindepth = iVar5;
            piVar7 = (int *)*piVar7;
            if (piVar7 == (int *)0x0)
                goto LAB_00021020;
            goto LAB_00020d04;
        }
        uVar6 = FUN_0002c300();
        iVar5 = piVar7[1];
        pcVar13 = "Unknown mru option %s (%d)";
        goto LAB_00021078;
    }
LAB_00021020:
    if ((*(addrinfo **)((int)(__dest + 2) + 8) != (addrinfo *)0x0) &&
        (piVar7 = (int *)(*(addrinfo **)((int)(__dest + 2) + 8))->ai_flags,
         piVar7 != (int *)0x0)) {
        pcVar13 = (char *)0x166;
        paVar19 = (addrinfo *)0x16b;
        pcVar22 = "discard average %d out of range, ignored.";
        do {
            iVar5 = piVar7[1];
            if (iVar5 == 0x166) {
                ntp_minpkt = piVar7[4];
            } else if (iVar5 == 0x16b) {
                mon_age = piVar7[4];
            } else {
                if (iVar5 != 0x10a) {
                    uVar6 = FUN_0002c300();
                    iVar5 = piVar7[1];
                    pcVar13 = "Unknown discard option %s (%d)";
                LAB_00021078:
                    FUN_00075d40(3, pcVar13, uVar6, iVar5);
                    /* WARNING: Subroutine does not return */
                    exit(1);
                }
                if ((uint)piVar7[4] < 0x100) {
                    ntp_minpoll = (undefined1)piVar7[4];
                } else {
                    FUN_00075d40(3,
                                 "discard average %d out of range, ignored.");
                }
            }
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
    }
    if ((*(addrinfo **)((int)(__dest + 2) + 0x10) != (addrinfo *)0x0) &&
        (unaff_r10 =
             (char *)(*(addrinfo **)((int)(__dest + 2) + 0x10))->ai_flags,
         (addrinfo *)unaff_r10 != (addrinfo *)0x0)) {
    LAB_00021160:
        paVar15 = (addrinfo *)((addrinfo *)unaff_r10)->ai_protocol;
        uVar1 = *(ushort *)&((addrinfo *)unaff_r10)->ai_addr;
        local_12c = (char *)(uint)uVar1;
        paVar19 = paVar15;
        if (paVar15 == (addrinfo *)0x0)
            goto LAB_00021454;
        paVar15 = (addrinfo *)paVar15->ai_flags;
        if (paVar15 != (addrinfo *)0x0) {
            paVar17 = (addrinfo *)0x0;
            paVar19 = (addrinfo *)0x0;
        LAB_00021188:
            switch (paVar15->ai_family) {
            case 0x131:
                paVar17 = (addrinfo *)((uint)paVar17 | 0x2000);
                goto LAB_000213d4;
            case 0x132:
                break;
            case 0x133:
                break;
            case 0x134:
                break;
            case 0x135:
                break;
            case 0x136:
                break;
            case 0x137:
                break;
            case 0x138:
                break;
            case 0x139:
                paVar17 = (addrinfo *)((uint)paVar17 | 1);
                goto LAB_000213d4;
            case 0x13a:
                break;
            case 0x13b:
                break;
            case 0x13c:
                break;
            case 0x13d:
                break;
            case 0x13e:
                break;
            case 0x13f:
                break;
            case 0x140:
                break;
            case 0x141:
                break;
            case 0x142:
                break;
            case 0x143:
                break;
            case 0x144:
                break;
            case 0x145:
                break;
            case 0x146:
                break;
            case 0x147:
                break;
            case 0x148:
                break;
            case 0x149:
                break;
            case 0x14a:
                break;
            case 0x14b:
                break;
            case 0x14c:
                paVar17 = (addrinfo *)((uint)paVar17 | 0x800);
                goto LAB_000213d4;
            case 0x14d:
                paVar17 = (addrinfo *)((uint)paVar17 | 0x1000);
                goto LAB_000213d4;
            case 0x14e:
                break;
            case 0x14f:
                break;
            case 0x150:
                paVar17 = (addrinfo *)((uint)paVar17 | 0x40);
                goto LAB_000213d4;
            case 0x151:
                break;
            case 0x152:
                break;
            case 0x153:
                break;
            case 0x154:
                break;
            case 0x155:
                break;
            case 0x156:
                paVar17 = (addrinfo *)((uint)paVar17 | 0x400);
                goto LAB_000213d4;
            case 0x157:
                break;
            case 0x158:
                break;
            case 0x159:
                break;
            case 0x15a:
                break;
            case 0x15b:
                break;
            case 0x15c:
                break;
            case 0x15d:
                break;
            case 0x15e:
                break;
            case 0x15f:
                break;
            case 0x160:
                break;
            case 0x161:
                break;
            case 0x162:
                break;
            case 0x163:
                break;
            case 0x164:
                break;
            case 0x165:
                break;
            case 0x166:
                break;
            case 0x167:
                break;
            case 0x168:
                break;
            case 0x169:
                break;
            case 0x16a:
                break;
            case 0x16b:
                break;
            case 0x16c:
                break;
            case 0x16d:
                break;
            case 0x16e:
                break;
            case 0x16f:
                break;
            case 0x170:
                break;
            case 0x171:
                paVar17 = (addrinfo *)((uint)paVar17 | 0x100);
                goto LAB_000213d4;
            case 0x172:
                paVar17 = (addrinfo *)((uint)paVar17 | 0x4000);
                goto LAB_000213d4;
            case 0x173:
                break;
            case 0x174:
                break;
            case 0x175:
                paVar17 = (addrinfo *)((uint)paVar17 | 0x20);
                goto LAB_000213d4;
            case 0x176:
                paVar17 = (addrinfo *)((uint)paVar17 | 0x10);
                goto LAB_000213d4;
            case 0x177:
                paVar17 = (addrinfo *)((uint)paVar17 | 0x80);
                goto LAB_000213d4;
            case 0x178:
                break;
            case 0x179:
                paVar17 = (addrinfo *)((uint)paVar17 | 2);
                goto LAB_000213d4;
            case 0x17a:
                paVar17 = (addrinfo *)((uint)paVar17 | 0x200);
                goto LAB_000213d4;
            case 0x17b:
                paVar17 = (addrinfo *)((uint)paVar17 | 4);
                goto LAB_000213d4;
            case 0x17c:
                break;
            case 0x17d:
                paVar19 = (addrinfo *)((uint)paVar19 | 0x2000);
                goto LAB_000213d4;
            case 0x17e:
                break;
            case 0x17f:
                break;
            case 0x180:
                break;
            case 0x181:
                break;
            case 0x182:
                break;
            case 0x183:
                break;
            case 0x184:
                break;
            case 0x185:
                break;
            case 0x186:
                break;
            case 0x187:
                break;
            case 0x188:
                break;
            case 0x189:
                break;
            case 0x18a:
                break;
            case 0x18b:
                break;
            case 0x18c:
                break;
            case 0x18d:
                break;
            case 0x18e:
                break;
            case 399:
                break;
            case 400:
                break;
            case 0x191:
                break;
            case 0x192:
                break;
            case 0x193:
                break;
            case 0x194:
                break;
            case 0x195:
                break;
            case 0x196:
                break;
            case 0x197:
                break;
            case 0x198:
                break;
            case 0x199:
                paVar19 = (addrinfo *)((uint)paVar19 | 0x4000);
                goto LAB_000213d4;
            case 0x19a:
                break;
            case 0x19b:
                break;
            case 0x19c:
                break;
            case 0x19d:
                break;
            case 0x19e:
                break;
            case 0x19f:
                break;
            case 0x1a0:
                break;
            case 0x1a1:
                break;
            case 0x1a2:
                break;
            case 0x1a3:
                break;
            case 0x1a4:
                break;
            case 0x1a5:
                break;
            case 0x1a6:
                break;
            case 0x1a7:
                break;
            case 0x1a8:
                break;
            case 0x1a9:
                break;
            case 0x1aa:
                break;
            case 0x1ab:
                break;
            case 0x1ac:
                break;
            case 0x1ad:
                break;
            case 0x1ae:
                break;
            case 0x1af:
                break;
            case 0x1b0:
                break;
            case 0x1b1:
                break;
            case 0x1b2:
                break;
            case 0x1b3:
                break;
            case 0x1b4:
                break;
            case 0x1b5:
                break;
            case 0x1b6:
                break;
            case 0x1b7:
                break;
            case 0x1b8:
                paVar17 = (addrinfo *)((uint)paVar17 | 8);
            LAB_000213d4:
                paVar15 = (addrinfo *)paVar15->ai_flags;
                if (paVar15 == (addrinfo *)0x0)
                    goto code_r0x000213e0;
                goto LAB_00021188;
            }
            FUN_0001ca54("config_access: flag-type-token=%d");
            paVar19 = paVar15;
            goto LAB_00021454;
        }
        paVar17 = (addrinfo *)((addrinfo *)unaff_r10)->ai_family;
        paVar19 = paVar15;
        if (paVar17 == (addrinfo *)0x0) {
            local_50 = (addrinfo *)0x0;
            goto LAB_000227e8;
        }
        goto LAB_000214b8;
    }
LAB_00021778:
    if (*(addrinfo **)((int)(__dest + 2) + 0x1c) == (addrinfo *)0x0)
        goto LAB_000217e0;
    piVar7 = (int *)(*(addrinfo **)((int)(__dest + 2) + 0x1c))->ai_flags;
    if (piVar7 == (int *)0x0)
        goto LAB_000217e0;
    paVar19 = (addrinfo *)0x182;
LAB_00021794:
    paVar15 = (addrinfo *)piVar7[1];
    if (paVar15 == paVar19) {
        uVar6 = 6;
    } else if ((int)paVar19 < (int)paVar15) {
        if (paVar15 == (addrinfo *)0x1a0) {
            uVar6 = 5;
        } else if ((int)paVar15 < 0x1a1) {
            if (paVar15 == (addrinfo *)0x19e)
                goto LAB_00021870;
            if (paVar15 != (addrinfo *)0x19f)
                goto LAB_00021864;
            uVar6 = 4;
        } else if (paVar15 == (addrinfo *)0x1a1) {
            uVar6 = 8;
        } else {
            if (paVar15 != (addrinfo *)0x1a6)
                goto LAB_00021864;
            uVar6 = 0xf;
        }
    } else if (paVar15 == (addrinfo *)0x120) {
        uVar6 = 7;
    } else if ((int)paVar15 < 0x121) {
        if (paVar15 != (addrinfo *)0x105)
            goto LAB_00021864;
        uVar6 = 10;
    } else if (paVar15 == (addrinfo *)0x133) {
        uVar6 = 0xc;
    } else {
        if (paVar15 != (addrinfo *)0x136)
            goto LAB_00021864;
        uVar6 = 0xb;
    }
LAB_000217cc:
    FUN_00040b38((int)*(undefined8 *)(piVar7 + 4), uVar6);
    piVar7 = (int *)*piVar7;
    if (piVar7 != (int *)0x0)
        goto LAB_00021794;
LAB_000217e0:
    if (*(addrinfo **)((int)(__dest + 2) + 0x18) == (addrinfo *)0x0)
        goto LAB_0002192c;
    piVar7 = (int *)(*(addrinfo **)((int)(__dest + 2) + 0x18))->ai_flags;
    if (piVar7 == (int *)0x0)
        goto LAB_0002192c;
    local_12c = "\'rlimit memlock\' value of %d is unexpected!";
    pcVar22 = "mlockall() failed: %m";
    pcVar13 = "munlockall() failed: %m";
    local_128 = (addrinfo *)&DAT_0009e4fc;
    unaff_r10 = &DAT_0009e52c;
    local_124 = (addrinfo **)&DAT_000a9528;
LAB_00021834:
    iVar5 = piVar7[1];
    if (iVar5 == 0x162)
        goto LAB_00021984;
    if (iVar5 == 0x19a) {
        FUN_0001fce4(3, 0x19a, piVar7[4] << 0xc, (piVar7[4] << 0xc) >> 0x1f,
                     0x1000, unaff_r10);
    } else {
        if (iVar5 != 300)
            goto code_r0x00021858;
        FUN_0001fce4(7, 1, piVar7[4], piVar7[4] >> 0x1f, 1, local_124);
    }
LAB_00021920:
    piVar7 = (int *)*piVar7;
    if (piVar7 != (int *)0x0)
        goto LAB_00021834;
LAB_0002192c:
    FUN_0001caa0(*(addrinfo **)(__dest + 3), 1);
    FUN_0001caa0(*(addrinfo **)((int)(__dest + 3) + 4), 0);
    if ((*(addrinfo **)((int)(__dest + 4) + 0xc) != (addrinfo *)0x0) &&
        (piVar7 = (int *)(*(addrinfo **)((int)(__dest + 4) + 0xc))->ai_flags,
         piVar7 != (int *)0x0)) {
        do {
            iVar5 = piVar7[1];
            if (iVar5 == 0x2d) {
                uVar8 = FUN_0001d684(piVar7[4]);
                ntp_syslogmask = ntp_syslogmask & ~uVar8;
            } else if (iVar5 == 0x3d) {
                ntp_syslogmask = FUN_0001d684(piVar7[4]);
            } else {
                if (iVar5 != 0x2b)
                    goto code_r0x00021978;
                uVar8 = FUN_0001d684(piVar7[4]);
                ntp_syslogmask = uVar8 | ntp_syslogmask;
            }
            piVar7 = (int *)*piVar7;
            if (piVar7 == (int *)0x0)
                break;
        } while (true);
    }
    if ((*(addrinfo **)((int)(__dest + 4) + 0x10) != (addrinfo *)0x0) &&
        (piVar7 = (int *)(*(addrinfo **)((int)(__dest + 4) + 0x10))->ai_flags,
         piVar7 != (int *)0x0)) {
        uVar8 = 0;
        do {
            if (uVar8 < 9) {
                uVar6 = FUN_00074c8c(piVar7[1]);
                *(undefined4 *)(sys_phone + uVar8 * 4) = uVar6;
                *(undefined4 *)(sys_phone + (uVar8 + 1) * 4) = 0;
                uVar8 = uVar8 + 1;
            } else {
                FUN_00075d40(6,
                             "phone: Number of phone entries exceeds %zu. "
                             "Ignoring phone %s...",
                             9, piVar7[1]);
            }
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
    }
    if ((*(addrinfo **)((int)(__dest + 4) + 0x14) != (addrinfo *)0x0) &&
        (piVar7 = (int *)(*(addrinfo **)((int)(__dest + 4) + 0x14))->ai_flags,
         piVar7 != (int *)0x0)) {
        pvVar20 = (void *)0x0;
        do {
            sVar9 = strlen((char *)piVar7[1]);
            sVar10 = strlen((char *)piVar7[2]);
            iVar5 = sVar9 + sVar10 + 2;
            pvVar20 = (void *)FUN_00074b04(pvVar20, iVar5, 0);
            FUN_0007d00c(pvVar20, iVar5, "%s=%s", piVar7[1], piVar7[2]);
            if (piVar7[3] == 0) {
                uVar6 = 0;
            } else {
                uVar6 = 0x20;
            }
            FUN_000348e4(pvVar20, iVar5, uVar6);
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
        if (pvVar20 != (void *)0x0) {
            free(pvVar20);
        }
    }
    if ((*(addrinfo **)((int)(__dest + 4) + 0x18) != (addrinfo *)0x0) &&
        (piVar7 = (int *)(*(addrinfo **)((int)(__dest + 4) + 0x18))->ai_flags,
         piVar7 != (int *)0x0)) {
        uVar8 = 0;
        do {
            if (uVar8 < 8) {
                *(char *)((int)&sys_ttl + uVar8) = (char)piVar7[1];
                uVar8 = uVar8 + 1;
            } else {
                FUN_00075d40(6,
                             "ttl: Number of TTL entries exceeds %zu. Ignoring "
                             "TTL %d...",
                             8, piVar7[1]);
            }
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
        sys_ttlmax = uVar8 - 1;
    }
    if (*(addrinfo **)(__dest + 5) != (addrinfo *)0x0) {
        for (piVar7 = (int *)(*(addrinfo **)(__dest + 5))->ai_flags;
             piVar7 != (int *)0x0; piVar7 = (int *)*piVar7) {
            iVar5 = piVar7[1];
            if (iVar5 == 0x14e) {
                FUN_00053708(4, piVar7[4]);
                pvVar20 = saveconfigdir;
            } else {
                pvVar20 = saveconfigdir;
                if (iVar5 < 0x14f) {
                    if (iVar5 == 0x122) {
                        if (*(char *)piVar7[4] == '\0') {
                            stats_drift_file = 0;
                            FUN_00075d40(6, "config: driftfile disabled");
                            pvVar20 = saveconfigdir;
                        } else {
                            FUN_00053708(1);
                            pvVar20 = saveconfigdir;
                        }
                    } else if (iVar5 < 0x123) {
                        if (iVar5 == 0x109) {
                            if (piVar7[4] - 3U < 0x1d) {
                                sys_automax = (undefined1)piVar7[4];
                            } else {
                                FUN_00075d40(3, "\'automax\' value %d ignored");
                                pvVar20 = saveconfigdir;
                            }
                        } else if (iVar5 == 0x111) {
                            FUN_00049000((int)*(undefined8 *)(piVar7 + 4), 4,
                                         0);
                            pvVar20 = saveconfigdir;
                        } else {
                        LAB_00022bfc:
                            FUN_00075d40(3,
                                         "config_vars(): unexpected token %d");
                            pvVar20 = saveconfigdir;
                        }
                    } else if (iVar5 == 0x124) {
                        qos = piVar7[4] << 2;
                    } else {
                        if (iVar5 != 0x138)
                            goto LAB_00022bfc;
                        sys_ident = piVar7[4];
                    }
                } else if (iVar5 == 0x187) {
                    FUN_00053708(3, piVar7[4]);
                    pvVar20 = saveconfigdir;
                } else if (iVar5 < 0x188) {
                    if (iVar5 == 0x154) {
                        iVar5 = FUN_00075f28(piVar7[4], 1);
                        pvVar20 = saveconfigdir;
                        if (iVar5 == -1) {
                            FUN_00075d40(3, "Cannot open logfile %s: %m",
                                         piVar7[4]);
                            pvVar20 = saveconfigdir;
                        }
                    } else {
                        if (iVar5 != 0x174)
                            goto LAB_00022bfc;
                    LAB_00022d50:
                        wander_threshold._0_4_ = piVar7[4];
                        wander_threshold._4_4_ = piVar7[5];
                    }
                } else if (iVar5 == 0x1a6) {
                    FUN_00040b38((int)*(undefined8 *)(piVar7 + 4), 0xf);
                    pvVar20 = saveconfigdir;
                } else {
                    if (iVar5 == 0x1b9)
                        goto LAB_00022d50;
                    if (iVar5 != 0x196)
                        goto LAB_00022bfc;
                    if (saveconfigdir != (void *)0x0) {
                        free(saveconfigdir);
                    }
                    pcVar13 = (char *)piVar7[4];
                    pvVar20 = (void *)strlen(pcVar13);
                    if (pvVar20 != (void *)0x0) {
                        if ((pcVar13 + (int)pvVar20)[-1] == '/') {
                            pvVar20 = (void *)FUN_00074c8c(pcVar13);
                        } else {
                            saveconfigdir =
                                (void *)FUN_00074b04(0, (int)pvVar20 + 2, 0);
                            FUN_0007d00c(saveconfigdir, (int)pvVar20 + 2,
                                         &DAT_0009e610, piVar7[4], 0x2f);
                            pvVar20 = saveconfigdir;
                        }
                    }
                }
            }
            saveconfigdir = pvVar20;
        }
    }
    FUN_00028720();
    local_84 = local_84 & 0xffff0000;
    if (*(addrinfo **)((int)(__dest + 4) + 0x1c) != (addrinfo *)0x0) {
        for (piVar7 =
                 (int *)(*(addrinfo **)((int)(__dest + 4) + 0x1c))->ai_flags;
             piVar7 != (int *)0x0; piVar7 = (int *)*piVar7) {
            if ((undefined4 *)piVar7[2] == (undefined4 *)0x0) {
                uVar8 = 0x480f;
                iVar5 = 0;
            LAB_00021d5c:
                local_68 = (addrinfo *)0x0;
                local_64 = (addrinfo *)0x0;
                local_60 = (addrinfo *)0x0;
                local_5c = (addrinfo *)0x0;
                local_58 = (addrinfo *)0x0;
                local_54 = (addrinfo *)0x0;
                local_50 = (addrinfo *)0x0;
                iVar18 =
                    FUN_0001d27c(*(undefined4 *)(piVar7[1] + 4), &local_68);
                if (iVar18 == 1) {
                    uVar1 = (ushort)(uVar8 >> 8) | (ushort)(uVar8 << 8);
                    local_68 = (addrinfo *)CONCAT22(uVar1, (short)local_68);
                    if (iVar5 == 0) {
                    LAB_00023378:
                        iVar5 = any_interface;
                        if ((short)local_68 != 2) {
                            iVar5 = any6_interface;
                        }
                    } else {
                        local_68 =
                            (addrinfo *)CONCAT22(uVar1, (undefined2)local_84);
                    }
                    iVar18 = FUN_000340bc(&local_68, iVar5, 0, 4);
                    if (iVar18 == 0) {
                        uVar6 = FUN_0002924c(iVar5);
                        uVar14 = FUN_0007d2c0(&local_68);
                        FUN_00075d40(3, "set trap %s -> %s failed.", uVar6,
                                     uVar14);
                    }
                } else {
                    local_d0.ai_flags = 0;
                    local_d0.ai_family = 0;
                    local_d0.ai_addrlen = 0;
                    local_d0.ai_addr = (sockaddr *)0x0;
                    local_d0.ai_canonname = (char *)0x0;
                    local_d0.ai_next = (addrinfo *)0x0;
                    local_d0.ai_protocol = 0x11;
                    local_d0.ai_socktype = 2;
                    FUN_0007d00c(auStack_4c, 8, "%u", uVar8);
                    local_d0.ai_flags = 0x400;
                    puVar11 = (undefined4 *)FUN_00074b04(0, 0x20, 0, 1);
                    if (iVar5 != 0) {
                        local_d0.ai_family = (int)*(ushort *)(iVar5 + 0x8c);
                        puVar11[7] = 1;
                        uVar6 = *(undefined4 *)(iVar5 + 0x1c);
                        uVar14 = *(undefined4 *)(iVar5 + 0x20);
                        uVar26 = *(undefined4 *)(iVar5 + 0x24);
                        *puVar11 = *(undefined4 *)(iVar5 + 0x18);
                        puVar11[1] = uVar6;
                        puVar11[2] = uVar14;
                        puVar11[3] = uVar26;
                        uVar6 = *(undefined4 *)(iVar5 + 0x2c);
                        uVar14 = *(undefined4 *)(iVar5 + 0x30);
                        puVar11[4] = *(undefined4 *)(iVar5 + 0x28);
                        puVar11[5] = uVar6;
                        puVar11[6] = uVar14;
                    }
                LAB_00021e4c:
                    iVar5 =
                        FUN_00079464(*(undefined4 *)(piVar7[1] + 4), auStack_4c,
                                     &local_d0, 2, FUN_0001d474, puVar11);
                    if (iVar5 == 0) {
                        FUN_00075d40(
                            3, "config_trap: getaddrinfo_sometime(%s,%s): %m",
                            *(undefined4 *)(piVar7[1] + 4), auStack_4c);
                    }
                }
            } else {
                paVar19 = *(addrinfo **)piVar7[2];
                if (paVar19 == (addrinfo *)0x0) {
                    local_68 = paVar19;
                    local_64 = paVar19;
                    local_60 = paVar19;
                    local_5c = paVar19;
                    local_58 = paVar19;
                    local_54 = paVar19;
                    local_50 = paVar19;
                    iVar5 =
                        FUN_0001d27c(*(undefined4 *)(piVar7[1] + 4), &local_68);
                    if (iVar5 == 1) {
                        local_68 = (addrinfo *)CONCAT22(0xf48, (short)local_68);
                        goto LAB_00023378;
                    }
                    local_d0.ai_protocol = 0x11;
                    local_d0.ai_socktype = 2;
                    local_d0.ai_flags = (int)paVar19;
                    local_d0.ai_family = (int)paVar19;
                    local_d0.ai_addrlen = (socklen_t)paVar19;
                    local_d0.ai_addr = (sockaddr *)paVar19;
                    local_d0.ai_canonname = (char *)paVar19;
                    local_d0.ai_next = paVar19;
                    FUN_0007d00c(auStack_4c, 8, "%u", 0x480f);
                    local_d0.ai_flags = 0x400;
                    puVar11 = (undefined4 *)FUN_00074b04(0, 0x20, 0, 1);
                    goto LAB_00021e4c;
                }
                bVar27 = false;
                iVar5 = 0;
                uVar8 = 0;
                do {
                    if (paVar19->ai_family != 0x189) {
                        if (paVar19->ai_family != 0x140)
                            goto LAB_00021d3c;
                        local_84 = 0;
                        local_80 = (addrinfo *)0x0;
                        local_7c = (addrinfo *)0x0;
                        local_78 = (addrinfo *)0x0;
                        local_74 = (addrinfo *)0x0;
                        local_70 = (addrinfo *)0x0;
                        local_6c = (addrinfo *)0x0;
                        iVar5 = FUN_0001d27c(paVar19->ai_addrlen, &local_84);
                        if (iVar5 == 1) {
                            iVar5 = FUN_00027b78(&local_84);
                            if (iVar5 == 0) {
                                uVar6 = FUN_0007d2c0(&local_84);
                                FUN_00075d40(
                                    3, "can\'t find interface with address %s",
                                    uVar6);
                                bVar27 = true;
                            }
                            goto LAB_00021d3c;
                        }
                        goto LAB_00021e98;
                    }
                    uVar8 = paVar19->ai_addrlen;
                    if (0xfffe < uVar8 - 1) {
                        FUN_00075d40(3, "invalid port number %d, trap ignored");
                        uVar8 = paVar19->ai_addrlen;
                        bVar27 = true;
                    }
                    uVar8 = uVar8 & 0xffff;
                LAB_00021d3c:
                    paVar19 = (addrinfo *)paVar19->ai_flags;
                } while (paVar19 != (addrinfo *)0x0);
                if (!bVar27) {
                    if (uVar8 == 0) {
                        uVar8 = 0x480f;
                    }
                    goto LAB_00021d5c;
                }
            }
        LAB_00021e98:
        }
    }
    if (*(addrinfo **)((int)(__dest + 1) + 0xc) != (addrinfo *)0x0) {
        FUN_00049000(0, 1, *(addrinfo **)((int)(__dest + 1) + 0xc), 0);
    }
    if ((*(addrinfo **)((int)(__dest + 1) + 0x10) != (addrinfo *)0x0) &&
        (piVar7 = (int *)(*(addrinfo **)((int)(__dest + 1) + 0x10))->ai_flags,
         piVar7 != (int *)0x0)) {
        do {
            local_64 = (addrinfo *)0x0;
            local_60 = (addrinfo *)0x0;
            local_5c = (addrinfo *)0x0;
            local_58 = (addrinfo *)0x0;
            local_54 = (addrinfo *)0x0;
            local_50 = (addrinfo *)0x0;
            local_68 = (addrinfo *)(uint) * (ushort *)(piVar7 + 2);
            iVar5 = FUN_0001d27c(piVar7[1], &local_68);
            if (iVar5 == 1) {
                FUN_00049000(0, 6, 0, &local_68);
                sys_manycastserver = 1;
            }
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
    }
    if ((*(addrinfo **)((int)(__dest + 1) + 0x14) != (addrinfo *)0x0) &&
        (piVar7 = (int *)(*(addrinfo **)((int)(__dest + 1) + 0x14))->ai_flags,
         piVar7 != (int *)0x0)) {
        do {
            local_64 = (addrinfo *)0x0;
            local_60 = (addrinfo *)0x0;
            local_5c = (addrinfo *)0x0;
            local_58 = (addrinfo *)0x0;
            local_54 = (addrinfo *)0x0;
            local_50 = (addrinfo *)0x0;
            local_68 = (addrinfo *)(uint) * (ushort *)(piVar7 + 2);
            iVar5 = FUN_0001d27c(piVar7[1], &local_68);
            if (iVar5 == 1) {
                FUN_00049000(0, 6, 0, &local_68);
            }
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
        FUN_00049000(0, 6, 1, 0);
    }
    if (0 < cmdline_server_count) {
        do {
            local_68 = (addrinfo *)0x0;
            local_64 = (addrinfo *)0x0;
            local_60 = (addrinfo *)0x0;
            local_5c = (addrinfo *)0x0;
            local_58 = (addrinfo *)0x0;
            local_54 = (addrinfo *)0x0;
            local_50 = (addrinfo *)0x0;
            paVar19 = (addrinfo *)FUN_00074fd8(*cmdline_servers, 0, &local_68);
            if (paVar19 == (addrinfo *)0x0) {
                puVar12 = (undefined4 *)FUN_00074b04(0, 0x1c, 0, 1);
                puVar11 = cmdline_servers;
                *(undefined2 *)(puVar12 + 2) = 0;
                *(undefined1 *)(puVar12 + 4) = 3;
                puVar12[1] = 0x197;
                *puVar12 = 0x100;
                *(undefined1 *)((int)puVar12 + 0x11) = 4;
                local_d0.ai_family = (int)*(ushort *)(puVar12 + 2);
                local_d0.ai_socktype = 2;
                local_d0.ai_protocol = 0x11;
                local_d0.ai_flags = (int)paVar19;
                local_d0.ai_addrlen = (socklen_t)paVar19;
                local_d0.ai_addr = (sockaddr *)paVar19;
                local_d0.ai_canonname = (char *)paVar19;
                local_d0.ai_next = paVar19;
                FUN_00078e68(*puVar11, &DAT_0009e38c, &local_d0, 2,
                             FUN_0001cf14, puVar12, 0);
            } else {
                local_68 = (addrinfo *)CONCAT22(0x7b00, (short)local_68);
                iVar5 = FUN_0001cd68(&local_68, 0x197);
                if (iVar5 != 0) {
                    FUN_00042db8(&local_68, 0, 0, 0xffffffff, 3, 4, 0, 0, 0x100,
                                 0, 0, 0);
                }
            }
            cmdline_server_count = cmdline_server_count + -1;
            cmdline_servers = cmdline_servers + 1;
        } while (0 < cmdline_server_count);
    }
    if ((*(addrinfo **)((int)(__dest + 1) + 4) != (addrinfo *)0x0) &&
        (piVar7 = (int *)(*(addrinfo **)((int)(__dest + 1) + 4))->ai_flags,
         piVar7 != (int *)0x0)) {
        do {
            local_68 = (addrinfo *)0x0;
            local_64 = (addrinfo *)0x0;
            local_60 = (addrinfo *)0x0;
            local_5c = (addrinfo *)0x0;
            local_58 = (addrinfo *)0x0;
            local_54 = (addrinfo *)0x0;
            local_50 = (addrinfo *)0x0;
            iVar5 = piVar7[1];
            if (iVar5 == 0x183) {
                uVar23 = 1;
            LAB_00022354:
                paVar19 = (addrinfo *)FUN_00074fd8(
                    *(undefined4 *)(piVar7[2] + 4),
                    *(undefined2 *)(piVar7[2] + 8), &local_68);
                if (paVar19 == (addrinfo *)0x0) {
                    puVar11 = (undefined4 *)FUN_00074b04(0, 0x1c, 0, 1);
                    uVar2 = *(undefined2 *)(piVar7[2] + 8);
                    puVar11[1] = piVar7[1];
                    *(undefined1 *)(puVar11 + 4) = uVar23;
                    *(undefined2 *)(puVar11 + 2) = uVar2;
                    *(char *)((int)puVar11 + 0x11) = (char)piVar7[6];
                    *(char *)((int)puVar11 + 0x12) = (char)piVar7[4];
                    *(undefined1 *)((int)puVar11 + 0x13) =
                        *(undefined1 *)((int)piVar7 + 0x11);
                    uVar6 = FUN_0001d348(piVar7[3]);
                    iVar18 = piVar7[7];
                    iVar5 = piVar7[8];
                    puVar11[5] = piVar7[5];
                    puVar11[3] = iVar18;
                    puVar11[6] = iVar5;
                    *puVar11 = uVar6;
                    local_d0.ai_family = (int)*(ushort *)(puVar11 + 2);
                    local_d0.ai_socktype = 2;
                    local_d0.ai_protocol = 0x11;
                    local_d0.ai_flags = (int)paVar19;
                    local_d0.ai_addrlen = (socklen_t)paVar19;
                    local_d0.ai_addr = (sockaddr *)paVar19;
                    local_d0.ai_canonname = (char *)paVar19;
                    local_d0.ai_next = paVar19;
                    FUN_00078e68(*(undefined4 *)(piVar7[2] + 4), &DAT_0009e38c,
                                 &local_d0, 2, FUN_0001cf14, puVar11, 0);
                } else {
                    local_68 = (addrinfo *)CONCAT22(0x7b00, (short)local_68);
                    iVar5 = FUN_0001cd68(&local_68, piVar7[1]);
                    if (iVar5 != 0) {
                        uVar6 = FUN_0001d348(piVar7[3]);
                        FUN_00042db8(&local_68, 0, 0, 0xffffffff, uVar23,
                                     (char)piVar7[6], (char)piVar7[4],
                                     *(undefined1 *)((int)piVar7 + 0x11), uVar6,
                                     piVar7[5], piVar7[7], piVar7[8]);
                    }
                }
            } else {
                if (iVar5 < 0x184) {
                    if (iVar5 != 0x10f) {
                        if (iVar5 != 0x157)
                            goto LAB_00022f48;
                        goto LAB_00022f78;
                    }
                    uVar23 = 5;
                    goto LAB_00022354;
                }
                if (iVar5 != 0x188) {
                    if (iVar5 != 0x197) {
                    LAB_00022f48:
                        /* WARNING: Subroutine does not return */
                        FUN_0007fc54("ntp_config.c", 0xfd9, 2, "hmode != 0");
                    }
                LAB_00022f78:
                    if (iVar5 != 0x188) {
                        uVar23 = 3;
                        goto LAB_00022354;
                    }
                }
                iVar5 = piVar7[2];
                local_68 = (addrinfo *)(uint) * (ushort *)(iVar5 + 8);
                uVar6 = FUN_0001d348(piVar7[3]);
                FUN_00042db8(&local_68, *(undefined4 *)(iVar5 + 4), 0,
                             0xffffffff, 3, (char)piVar7[6], (char)piVar7[4],
                             *(undefined1 *)((int)piVar7 + 0x11), uVar6,
                             piVar7[5], piVar7[7], piVar7[8]);
            }
            piVar7 = (int *)*piVar7;
        } while (piVar7 != (int *)0x0);
    }
    if (*(addrinfo **)((int)(__dest + 1) + 8) != (addrinfo *)0x0) {
        for (piVar7 = (int *)(*(addrinfo **)((int)(__dest + 1) + 8))->ai_flags;
             piVar7 != (int *)0x0; piVar7 = (int *)*piVar7) {
            if (piVar7[2] == 0) {
                iVar5 = FUN_0004217c(*(undefined2 *)(piVar7 + 1));
                if (iVar5 != 0) {
                    uVar6 = FUN_0007d2c0(iVar5 + 0x10);
                    FUN_00075d40(5, "unpeered %s", uVar6);
                    FUN_000467d8(iVar5, &DAT_0009d858);
                    FUN_000424cc(iVar5);
                }
            } else {
                local_64 = (addrinfo *)0x0;
                local_60 = (addrinfo *)0x0;
                local_5c = (addrinfo *)0x0;
                local_58 = (addrinfo *)0x0;
                local_54 = (addrinfo *)0x0;
                local_50 = (addrinfo *)0x0;
                local_68 = (addrinfo *)(uint) * (ushort *)(piVar7[2] + 8);
                pcVar13 = *(char **)(piVar7[2] + 4);
                iVar5 = FUN_0001d27c(pcVar13, &local_68);
                piVar25 = peer_list;
                if (iVar5 < 1) {
                    for (; piVar25 != (int *)0x0; piVar25 = (int *)*piVar25) {
                        if (((char *)piVar25[0xb] != (char *)0x0) &&
                            (iVar5 = strcasecmp((char *)piVar25[0xb], pcVar13),
                             iVar5 == 0)) {
                            FUN_00075d40(5, "unpeered %s", pcVar13);
                            FUN_000467d8(piVar25, &DAT_0009d858);
                            FUN_000424cc(piVar25);
                            break;
                        }
                    }
                    local_d0.ai_flags = 0;
                    local_d0.ai_addrlen = 0;
                    local_d0.ai_addr = (sockaddr *)0x0;
                    local_d0.ai_canonname = (char *)0x0;
                    local_d0.ai_next = (addrinfo *)0x0;
                    local_d0.ai_family = (int)*(ushort *)(piVar7[2] + 8);
                    local_d0.ai_socktype = 2;
                    local_d0.ai_protocol = 0x11;
                    FUN_00079464(pcVar13, &DAT_0009e38c, &local_d0, 2,
                                 &LAB_0001d0d0, 0);
                } else {
                    iVar5 = FUN_00041f34(&local_68, 0, 0, 0xffffffff, 0, 0);
                    if (iVar5 != 0) {
                        uVar6 = FUN_0007d2c0(&local_68);
                        FUN_00075d40(5, "unpeered %s", uVar6);
                        FUN_000467d8(iVar5, &DAT_0009d858);
                        FUN_000424cc(iVar5);
                    }
                }
            }
        }
    }
    if ((*(addrinfo **)((int)(__dest + 2) + 0x14) == (addrinfo *)0x0) ||
        (piVar7 = (int *)(*(addrinfo **)((int)(__dest + 2) + 0x14))->ai_flags,
         piVar7 == (int *)0x0))
        goto LAB_0002265c;
    do {
        bVar27 = false;
        iVar18 = piVar7[1];
        local_68 = (addrinfo *)0x0;
        local_64 = (addrinfo *)0x0;
        local_60 = (addrinfo *)0x0;
        local_5c = (addrinfo *)0x0;
        local_58 = (addrinfo *)0x0;
        local_54 = (addrinfo *)0x0;
        local_50 = (addrinfo *)0x0;
        iVar5 = FUN_0001d27c(*(undefined4 *)(iVar18 + 4), &local_68);
        if (iVar5 == 1) {
            if ((((uint)local_68 & 0xffff) != 2) ||
                (((int)local_64 << 0x18 | ((uint)local_64 >> 8 & 0xff)
                                              << 0x10) != 0x7f7f0000)) {
                uVar6 = FUN_0007d2c0(&local_68);
                FUN_00075d40(3,
                             "inappropriate address %s for the fudge command, "
                             "line ignored",
                             uVar6);
                goto LAB_000225c4;
            }
            memset(&local_d0, 0, 0x48);
            if (((undefined4 *)piVar7[2] != (undefined4 *)0x0) &&
                (piVar25 = *(int **)piVar7[2], piVar25 != (int *)0x0))
                goto LAB_000225f0;
        LAB_00023178:
            FUN_0004abac(&local_68, &local_d0, 0);
        } else {
            FUN_00075d40(
                3,
                "unrecognized fudge reference clock address %s, line ignored",
                *(undefined4 *)(iVar18 + 4));
        LAB_000225c4:
            memset(&local_d0, 0, 0x48);
            if ((int *)piVar7[2] != (int *)0x0) {
                piVar25 = *(int **)piVar7[2];
                bVar27 = true;
                if (piVar25 != (int *)0x0) {
                LAB_000225f0:
                    do {
                        iVar5 = piVar25[1];
                        uVar8 = (uint)local_d0.ai_flags >> 0x10;
                        if (iVar5 == 0x130) {
                            if (piVar25[4] == 0) {
                                local_d0.ai_flags._1_1_ =
                                    local_d0.ai_flags._1_1_ & 0xf7;
                            } else {
                                local_d0.ai_flags._1_1_ =
                                    local_d0.ai_flags._1_1_ | 8;
                            }
                            local_d0.ai_flags = CONCAT22(
                                CONCAT11(
                                    local_d0.ai_flags._3_1_,
                                    ~((byte) ~(byte)((uVar8 << 0x19) >> 0x18) >>
                                      1)),
                                (undefined2)local_d0.ai_flags);
                        } else if (iVar5 < 0x131) {
                            uVar2 =
                                (undefined2)((uint)local_d0.ai_flags >> 0x10);
                            if (iVar5 == 0x12e) {
                                if (piVar25[4] == 0) {
                                    local_d0.ai_flags._1_1_ =
                                        local_d0.ai_flags._1_1_ & 0xfd;
                                } else {
                                    local_d0.ai_flags._1_1_ =
                                        local_d0.ai_flags._1_1_ | 2;
                                }
                                local_d0.ai_flags =
                                    CONCAT22(uVar2,
                                             (undefined2)local_d0.ai_flags) |
                                    0x200000;
                            } else if (iVar5 < 0x12f) {
                                if (iVar5 != 0x12d)
                                    goto LAB_0002318c;
                                if (piVar25[4] == 0) {
                                    local_d0.ai_flags._1_1_ =
                                        local_d0.ai_flags._1_1_ & 0xfe;
                                } else {
                                    local_d0.ai_flags._1_1_ =
                                        local_d0.ai_flags._1_1_ | 1;
                                }
                                local_d0.ai_flags =
                                    CONCAT22(uVar2,
                                             (undefined2)local_d0.ai_flags) |
                                    0x100000;
                            } else {
                                if (piVar25[4] == 0) {
                                    local_d0.ai_flags._1_1_ =
                                        local_d0.ai_flags._1_1_ & 0xfb;
                                } else {
                                    local_d0.ai_flags._1_1_ =
                                        local_d0.ai_flags._1_1_ | 4;
                                }
                                local_d0.ai_flags =
                                    CONCAT22(uVar2,
                                             (undefined2)local_d0.ai_flags) |
                                    0x400000;
                            }
                        } else if (iVar5 == 0x1a2) {
                            local_d0.ai_flags = local_d0.ai_flags | 0x40000;
                            local_98 = piVar25[4];
                        } else if (iVar5 < 0x1a3) {
                            if (iVar5 != 400) {
                            LAB_0002318c:
                                uVar6 = FUN_0002bdf0();
                                FUN_00075d40(
                                    3, "Unexpected fudge flag %s (%d) for %s",
                                    uVar6, piVar25[1],
                                    *(undefined4 *)(iVar18 + 4));
                                iVar5 = piVar25[1];
                                if (iVar5 == 0) {
                                    iVar5 = 1;
                                }
                                /* WARNING: Subroutine does not return */
                                exit(iVar5);
                            }
                            local_94[0] = 0;
                            local_d0.ai_flags = local_d0.ai_flags | 0x80000;
                            pcVar13 = (char *)piVar25[4];
                            sVar9 = strlen(pcVar13);
                            if (3 < sVar9) {
                                sVar9 = 4;
                            }
                            __memcpy_chk(local_94, pcVar13, sVar9, 0xc);
                        } else if (iVar5 == 0x1a7) {
                            local_d0.ai_flags = local_d0.ai_flags | 0x10000;
                            local_a8 = piVar25[4];
                            iStack_a4 = piVar25[5];
                        } else {
                            if (iVar5 != 0x1a8)
                                goto LAB_0002318c;
                            local_d0.ai_flags = local_d0.ai_flags | 0x20000;
                            local_a0 = piVar25[4];
                            iStack_9c = piVar25[5];
                        }
                        piVar25 = (int *)*piVar25;
                    } while (piVar25 != (int *)0x0);
                    if (!bVar27)
                        goto LAB_00023178;
                }
            }
        }
        piVar7 = (int *)*piVar7;
        if (piVar7 == (int *)0x0) {
        LAB_0002265c:
            if (*(addrinfo **)((int)(__dest + 5) + 8) != (addrinfo *)0x0) {
                for (piVar7 = (int *)(*(addrinfo **)((int)(__dest + 5) + 8))
                                  ->ai_flags;
                     piVar7 != (int *)0x0; piVar7 = (int *)*piVar7) {
                    iVar5 = piVar7[1];
                    if (iVar5 == 0x142) {
                        FUN_00028fac();
                    } else if (iVar5 < 0x143) {
                        if (iVar5 == 0x107) {
                            FUN_0004b0b0();
                        } else if (iVar5 == 0x11a) {
                            FUN_000344e0();
                        } else if (iVar5 == 0x106) {
                            FUN_000430d0();
                        }
                    } else if (iVar5 == 0x1a4) {
                        FUN_00049460();
                    } else if (iVar5 == 0x1a9) {
                        FUN_000523f0();
                    } else if (iVar5 == 0x161) {
                        FUN_00042fa4();
                    }
                }
            }
            if (local_44 != __stack_chk_guard) {
                /* WARNING: Subroutine does not return */
                __stack_chk_fail();
            }
            return;
        }
    } while (true);
code_r0x000213e0:
    if ((((uint)paVar17 & 0x1000) != 0) && (DAT_000c9610 == 0)) {
        DAT_000c9610 = 1;
        pcVar13 = "mssntp restrict bit ignored, this ntpd was configured "
                  "without --enable-ntp-signd.";
        __fprintf_chk(stderr, 1, "%s\n",
                      "mssntp restrict bit ignored, this ntpd was configured "
                      "without --enable-ntp-signd.");
        FUN_00075d40(4, "%s",
                     "mssntp restrict bit ignored, this ntpd was configured "
                     "without --enable-ntp-signd.");
    }
    paVar15 = paVar17;
    pcVar22 = (char *)((uint)paVar17 & 0x840);
    if ((addrinfo *)((uint)paVar17 & 0x840) == (addrinfo *)0x800) {
        if (((addrinfo *)unaff_r10)->ai_family == 0) {
            if (((uint)paVar19 & 0x4000) == 0) {
                pcVar13 = "default";
            } else {
                pcVar13 = "source";
            }
        } else {
            pcVar13 = *(char **)(((addrinfo *)unaff_r10)->ai_family + 4);
        }
        __fprintf_chk(stderr, 1, "restrict %s: %s\n", pcVar13,
                      "KOD does nothing without LIMITED.");
        FUN_00075d40(4, "restrict %s: %s", pcVar13,
                     "KOD does nothing without LIMITED.");
        pcVar22 = "KOD does nothing without LIMITED.";
    }
LAB_00021454:
    local_84 = 0;
    local_80 = (addrinfo *)0x0;
    local_7c = (addrinfo *)0x0;
    local_78 = (addrinfo *)0x0;
    local_74 = (addrinfo *)0x0;
    local_70 = (addrinfo *)0x0;
    local_6c = (addrinfo *)0x0;
    paVar17 = (addrinfo *)((addrinfo *)unaff_r10)->ai_family;
    local_d4 = (addrinfo *)0x0;
    if (paVar17 == (addrinfo *)0x0) {
        local_124 = &local_54;
        local_128 = (addrinfo *)&local_50;
        local_50 = paVar17;
        if (((uint)paVar19 & 0x4000) != 0) {
            local_68 = paVar17;
            local_64 = paVar17;
            local_60 = paVar17;
            local_5c = paVar17;
            local_58 = paVar17;
            local_54 = paVar17;
            FUN_00051008(1, 0, 0, (int)(short)uVar1, paVar19, paVar15, 0);
            goto LAB_00021760;
        }
    LAB_000227e8:
        local_6c = (addrinfo *)0x0;
        pcVar13 = (char *)0x0;
        local_84._2_2_ = 0;
        local_84._0_2_ = 2;
        local_68._2_2_ = (undefined2)((uint)local_50 >> 0x10);
        local_68._0_2_ = 2;
        local_d4 = local_6c;
        local_80 = local_6c;
        local_7c = local_6c;
        local_78 = local_6c;
        local_74 = local_6c;
        local_70 = local_6c;
        local_64 = local_50;
        local_60 = local_50;
        local_5c = local_50;
        local_58 = local_50;
        local_54 = local_50;
        FUN_00051008(1, &local_84, &local_68, (int)(short)uVar1, paVar19,
                     paVar15, 0);
        local_84 = CONCAT22(local_84._2_2_, 10);
        local_68 = (addrinfo *)CONCAT22(local_68._2_2_, 10);
    } else {
    LAB_000214b8:
        local_6c = (addrinfo *)0x0;
        local_84 = (uint)(ushort)paVar17->ai_socktype;
        local_d4 = local_6c;
        local_80 = local_6c;
        local_7c = local_6c;
        local_78 = local_6c;
        local_74 = local_6c;
        local_70 = local_6c;
        iVar5 = FUN_0001d27c(paVar17->ai_family, &local_84);
        if (iVar5 == 1) {
            pcVar13 = (char *)0x0;
        } else {
            local_d0.ai_flags = 0;
            local_d0.ai_addrlen = 0;
            local_d0.ai_addr = (sockaddr *)0x0;
            local_d0.ai_canonname = (char *)0x0;
            pcVar22 = (char *)0x2;
            local_d0.ai_next = (addrinfo *)0x0;
            local_d0.ai_protocol = 0x11;
            local_d4 = (addrinfo *)0x0;
            local_d0.ai_family =
                (int)*(ushort *)(((addrinfo *)unaff_r10)->ai_family + 8);
            local_d0.ai_socktype = 2;
            iVar5 =
                getaddrinfo(*(char **)(((addrinfo *)unaff_r10)->ai_family + 4),
                            "ntp", &local_d0, &local_d4);
            paVar17 = local_d4;
            if (iVar5 != 0) {
                FUN_00075d40(
                    3,
                    "restrict: ignoring line %d, address/host \'%s\' unusable.",
                    ((addrinfo *)unaff_r10)->ai_addrlen,
                    *(undefined4 *)(((addrinfo *)unaff_r10)->ai_family + 4));
                goto LAB_00021760;
            }
            if (local_d4 == (addrinfo *)0x0) {
                /* WARNING: Subroutine does not return */
                FUN_0007fc54("ntp_config.c", 0xacf, 2,
                             "ai_list != ((void *)0)");
            }
            if (local_d4->ai_addr == (sockaddr *)0x0) {
                /* WARNING: Subroutine does not return */
                FUN_0007fc54("ntp_config.c", 0xad1, 2,
                             "pai->ai_addr != ((void *)0)");
            }
            if (0x1c < local_d4->ai_addrlen) {
                /* WARNING: Subroutine does not return */
                FUN_0007fc54("ntp_config.c", 0xad3, 2,
                             "sizeof(addr) >= pai->ai_addrlen");
            }
            __memcpy_chk(&local_84, local_d4->ai_addr, local_d4->ai_addrlen,
                         0x1c);
            pcVar13 = (char *)paVar17;
            if ((local_84 & 0xfff7) != 2) {
                /* WARNING: Subroutine does not return */
                FUN_0007fc54("ntp_config.c", 0xad7, 2,
                             "2 == ((&addr)->sa.sa_family) || 10 == "
                             "((&addr)->sa.sa_family)");
            }
        }
        bVar27 = (local_84 & 0xffff) != 10;
        local_64 = (addrinfo *)0x0;
        local_60 = (addrinfo *)0x0;
        local_5c = (addrinfo *)0x0;
        local_58 = (addrinfo *)0x0;
        local_124 = &local_54;
        local_54 = (addrinfo *)0x0;
        local_50 = (addrinfo *)0x0;
        local_128 = (addrinfo *)&local_50;
        paVar17 = local_128;
        if (bVar27) {
            paVar17 = (addrinfo *)0xffffffff;
        }
        local_68 = (addrinfo *)(local_84 & 0xffff);
        if (!bVar27) {
            memset(&local_60, 0xff, 0x10);
            paVar17 = local_64;
        }
        local_64 = paVar17;
        if (((addrinfo *)unaff_r10)->ai_socktype != 0) {
            local_64 = (addrinfo *)0x0;
            local_60 = (addrinfo *)0x0;
            local_5c = (addrinfo *)0x0;
            local_58 = (addrinfo *)0x0;
            local_54 = (addrinfo *)0x0;
            local_50 = (addrinfo *)0x0;
            local_68 = (addrinfo *)(uint) *
                       (ushort *)(((addrinfo *)unaff_r10)->ai_socktype + 8);
            iVar5 = FUN_0001d27c(
                *(undefined4 *)(((addrinfo *)unaff_r10)->ai_socktype + 4),
                &local_68);
            if (iVar5 != 1) {
                FUN_00075d40(
                    3, "restrict: ignoring line %d, mask \'%s\' unusable.",
                    ((addrinfo *)unaff_r10)->ai_addrlen,
                    *(undefined4 *)(((addrinfo *)unaff_r10)->ai_socktype + 4));
                goto LAB_00021760;
            }
        }
    }
    local_12c = (char *)(int)(short)uVar1;
    local_124 = &local_54;
    local_128 = (addrinfo *)&local_50;
    pcVar22 = (char *)0x0;
    while (
        (FUN_00051008(1, &local_84, &local_68, local_12c, paVar19, paVar15, 0),
         (addrinfo *)pcVar13 != (addrinfo *)0x0 &&
             (pcVar13 = (char *)((addrinfo *)pcVar13)->ai_next,
              (addrinfo *)pcVar13 != (addrinfo *)0x0))) {
        if (((addrinfo *)pcVar13)->ai_addr == (sockaddr *)0x0) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_config.c", 0xafa, 2,
                         "pai->ai_addr != ((void *)0)");
        }
        if (0x1c < ((addrinfo *)pcVar13)->ai_addrlen) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_config.c", 0xafc, 2,
                         "sizeof(addr) >= pai->ai_addrlen");
        }
        local_84 = 0;
        local_80 = (addrinfo *)0x0;
        local_7c = (addrinfo *)0x0;
        local_78 = (addrinfo *)0x0;
        local_74 = (addrinfo *)0x0;
        local_70 = (addrinfo *)0x0;
        local_6c = (addrinfo *)0x0;
        __memcpy_chk(&local_84, ((addrinfo *)pcVar13)->ai_addr,
                     ((addrinfo *)pcVar13)->ai_addrlen, 0x1c);
        if ((local_84 & 0xfff7) != 2) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_config.c", 0xb01, 2,
                         "2 == ((&addr)->sa.sa_family) || 10 == "
                         "((&addr)->sa.sa_family)");
        }
        local_64 = (addrinfo *)0x0;
        local_60 = (addrinfo *)0x0;
        local_5c = (addrinfo *)0x0;
        local_58 = (addrinfo *)0x0;
        local_54 = (addrinfo *)0x0;
        local_50 = (addrinfo *)0x0;
        local_68 = (addrinfo *)(local_84 & 0xffff);
        if ((local_84 & 0xffff) == 10) {
            memset(&local_60, 0xff, 0x10);
        } else {
            local_64 = (addrinfo *)0xffffffff;
        }
    }
    if (local_d4 != (addrinfo *)0x0) {
        freeaddrinfo(local_d4);
    }
LAB_00021760:
    unaff_r10 = (char *)((addrinfo *)unaff_r10)->ai_flags;
    if ((addrinfo *)unaff_r10 == (addrinfo *)0x0)
        goto code_r0x0002176c;
    goto LAB_00021160;
code_r0x0002176c:
    unaff_r10 = (char *)0x0;
    goto LAB_00021778;
code_r0x00021858:
    FUN_0001ca54("config-rlimit: value-token=%d");
LAB_00021864:
    FUN_0001ca54("config_tinker: attr-token=%d");
LAB_00021870:
    uVar6 = 3;
    goto LAB_000217cc;
code_r0x00021978:
    FUN_0001ca54("config-logconfig: modifier=\'%c\'");
LAB_00021984:
    if (((*(addrinfo **)((int)puVar24 + 0x44))[0x2e].ai_addrlen & 0xf) == 0) {
        iVar5 = piVar7[4];
        if (iVar5 == -1) {
            paVar19 = (addrinfo *)&cur_memlock;
            if ((cur_memlock != 0) && (iVar5 = munlockall(), iVar5 == -1)) {
                FUN_00075d40(3, pcVar13);
            }
            cur_memlock = 0;
        } else if (iVar5 < 0) {
            FUN_00075d40(4, local_12c);
        } else {
            paVar19 = (addrinfo *)&cur_memlock;
            if (cur_memlock != 1) {
                iVar5 = mlockall(3);
                if (iVar5 == -1) {
                    FUN_00075d40(3, pcVar22);
                }
                iVar5 = piVar7[4];
            }
            FUN_0001fce4(8, 0x100000, iVar5 << 0x14, (iVar5 << 0x14) >> 0x1f,
                         0x100000, local_128);
            cur_memlock = 1;
        }
    }
    goto LAB_00021920;
}

void FUN_00023528(undefined4 param_1)

{
    undefined4 uVar1;
    undefined1 auStack_9c[128];
    int local_1c;

    local_1c = __stack_chk_guard;
    uVar1 = FUN_0007d2c0();
    FUN_0007d00c(auStack_9c, 0x80, "remote config from %s", uVar1);
    FUN_0002c38c(auStack_9c, 0);
    memset(cfgt, 0, 0xb8);
    cfgt._176_4_ = 5;
    FUN_00029988();
    FUN_0002c40c();
    cfgt._12_4_ = 1;
    cfgt._32_4_ = time((time_t *)0x0);
    FUN_0007d2c0(param_1);
    cfgt._24_4_ = FUN_00074c8c();
    FUN_0001fe68(0);
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000235f8(undefined4 param_1, undefined4 param_2)

{
    size_t sVar1;
    undefined4 uVar2;
    int iVar3;
    char acStack_124[256];
    int local_24;

    local_24 = __stack_chk_guard;
    config_file = "/etc/ntp.conf";
    FUN_0007d00c(acStack_124, 0x100, "daemon_version=\"%s\"", Version);
    sVar1 = strlen(acStack_124);
    FUN_000348e4(acStack_124, sVar1 + 1);
    set_tod_using = &LAB_0001ccec;
    FUN_0002e238(param_1, param_2);
    memset(cfgt, 0, 0xb8);
    cfgt._176_4_ = 5;
    uVar2 = FUN_00074cfc(config_file);
    iVar3 = FUN_0002c38c(uVar2, "r");
    if (iVar3 == 0) {
        uVar2 = FUN_00074cfc(config_file);
        FUN_00075d40(6, "getconfig: Couldn\'t open <%s>: %m", uVar2);
        FUN_00028720();
    } else {
        cfgt._24_4_ = FUN_00074c8c();
        FUN_00029988();
        FUN_0002c40c();
        cfgt._12_4_ = 0;
        cfgt._32_4_ = time((time_t *)0x0);
        FUN_0001fe68(1);
    }
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00023f60(short *param_1)

{
    int iVar1;
    bool bVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    if (*param_1 == 2) {
        bVar2 = *(int *)(param_1 + 2) == 0;
    } else if (*param_1 == 10) {
        iVar3 = memcmp(param_1 + 4, &in6addr_any, 0x10);
        bVar2 = iVar3 == 0;
    } else {
        bVar2 = false;
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(bVar2);
    }
    return;
}

void FUN_00023ff0(short *param_1)

{
    short sVar1;
    bool bVar2;
    int iVar3;
    int iVar4;
    int *piVar5;

    iVar3 = __stack_chk_guard;
    piVar5 = remoteaddr_list;
    if (remoteaddr_list != (int *)0x0) {
        sVar1 = *param_1;
        do {
            if ((short)piVar5[1] == sVar1) {
                if (sVar1 == 2) {
                    bVar2 = piVar5[2] == *(int *)(param_1 + 2);
                } else {
                    iVar4 = memcmp(piVar5 + 3, param_1 + 4, 0x10);
                    if (iVar4 != 0)
                        goto LAB_00024034;
                    bVar2 = piVar5[7] == *(int *)(param_1 + 0xc);
                }
                if (bVar2) {
                    piVar5 = (int *)piVar5[8];
                    break;
                }
            }
        LAB_00024034:
            piVar5 = (int *)*piVar5;
        } while (piVar5 != (int *)0x0);
    }
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(piVar5);
    }
    return;
}

void FUN_000240d4(undefined4 *param_1, undefined4 param_2)

{
    int iVar1;
    undefined4 *puVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    undefined4 uVar5;
    bool bVar6;

    iVar1 = __stack_chk_guard;
    puVar2 = (undefined4 *)FUN_00074b04(0, 0x24, 0);
    bVar6 = iVar1 == __stack_chk_guard;
    uVar3 = param_1[1];
    uVar4 = param_1[2];
    uVar5 = param_1[3];
    puVar2[1] = *param_1;
    puVar2[2] = uVar3;
    puVar2[3] = uVar4;
    puVar2[4] = uVar5;
    uVar3 = param_1[5];
    uVar4 = param_1[6];
    puVar2[5] = param_1[4];
    puVar2[6] = uVar3;
    puVar2[7] = uVar4;
    puVar2[8] = param_2;
    *puVar2 = remoteaddr_list;
    remoteaddr_list = puVar2;
    if (bVar6) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002416c(void *param_1)

{
    int iVar1;
    void *__s;
    bool bVar2;

    iVar1 = __stack_chk_guard;
    __s = (void *)FUN_00074b04(0, 0xc0, 0);
    if (param_1 == (void *)0x0) {
        memset(__s, 0, 0xc0);
        *(undefined4 *)((int)__s + 0xc) = 0xffffffff;
        *(undefined4 *)((int)__s + 0x10) = 0xffffffff;
        *(undefined2 *)((int)__s + 0x8e) = DAT_000ca240;
    } else {
        memcpy(__s, param_1, 0xc0);
    }
    bVar2 = iVar1 == __stack_chk_guard;
    iVar1 = sys_ifnum + 1;
    *(int *)((int)__s + 0x14) = sys_ifnum;
    sys_ifnum = iVar1;
    *(undefined4 *)((int)__s + 0xa0) = current_time;
    if (bVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

void FUN_0002423c(int param_1, int param_2, short *param_3)

{
    int iVar1;
    undefined4 uVar2;
    bool bVar3;
    undefined4 local_18;
    int local_14;

    local_18 = 1;
    local_14 = __stack_chk_guard;
    if (*param_3 == 2) {
        iVar1 = setsockopt(param_2, 1, 6, &local_18, 4);
        if (iVar1 != 0) {
            uVar2 = FUN_0007d2c0(param_3);
            FUN_00075d40(
                3, "setsockopt(SO_BROADCAST) enable failure on address %s: %m",
                uVar2);
        }
    }
    bVar3 = local_14 == __stack_chk_guard;
    *(uint *)(param_1 + 0x90) = *(uint *)(param_1 + 0x90) | 0x400;
    if (bVar3) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(1);
}

void FUN_000242f0(int param_1, int param_2)

{
    int iVar1;
    char *pcVar2;
    int local_14[2];
    int local_c;

    local_c = __stack_chk_guard;
    iVar1 = any_interface;
    if (param_1 != 2) {
        iVar1 = any6_interface;
    }
    local_14[0] = param_2;
    if (((iVar1 != 0) && (*(int *)(iVar1 + 0xc) != -1)) &&
        (iVar1 = setsockopt(*(int *)(iVar1 + 0xc), 1, 2, local_14, 4),
         iVar1 != 0)) {
        if (local_14[0] == 0) {
            pcVar2 = "off";
        } else {
            pcVar2 = "on";
        }
        FUN_00075d40(
            3, "set_wildcard_reuse: setsockopt(SO_REUSEADDR, %s) failed: %m",
            pcVar2);
    }
    if (local_c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_000243d4(int param_1)

{
    int iVar1;
    undefined4 uVar2;
    char *pcVar3;
    int *piVar4;
    int local_24[2];
    int local_1c;

    local_1c = __stack_chk_guard;
    local_24[0] = param_1;
    if (ep_list != (int *)0x0) {
        piVar4 = ep_list;
        do {
            if ((((piVar4[0x24] & 0x80U) == 0) && (piVar4[3] != -1)) &&
                (iVar1 = setsockopt(piVar4[3], 1, 2, local_24, 4),
                 iVar1 != 0)) {
                uVar2 = FUN_0007d2c0(piVar4 + 6);
                pcVar3 = "on";
                if (local_24[0] == 0) {
                    pcVar3 = "off";
                }
                FUN_00075d40(3,
                             "set_reuseaddr: setsockopt(%s, SO_REUSEADDR, %s) "
                             "failed: %m",
                             uVar2, pcVar3);
            }
            piVar4 = (int *)*piVar4;
        } while (piVar4 != (int *)0x0);
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000244c8(undefined4 *param_1)

{
    short sVar1;
    short sVar2;
    undefined4 *puVar3;
    undefined4 *puVar4;
    int iVar5;
    undefined4 uVar6;
    int iVar7;
    uint uVar8;
    uint uVar9;
    uint *puVar10;
    uint *puVar11;
    uint uVar12;
    uint uVar13;
    int iVar14;
    uint uVar15;
    uint uVar16;
    undefined4 *puVar17;
    uint *puVar18;
    uint *puVar19;
    bool bVar20;
    uint local_50;
    uint *local_4c;
    uint local_48;
    uint local_40;

    iVar5 = __stack_chk_guard;
    puVar17 = param_1 + 6;
    uVar6 = FUN_00071720(puVar17);
    param_1[0x26] = uVar6;
    puVar3 = &ep_list;
    for (puVar4 = ep_list; puVar4 != (undefined4 *)0x0;
         puVar4 = (undefined4 *)*puVar4) {
        puVar3 = puVar4;
    }
    *param_1 = 0;
    *puVar3 = param_1;
    ninterfaces = ninterfaces + 1;
    if ((param_1[0x2d] == 0) && ((param_1[0x24] & 0x14) == 0x10)) {
        sVar1 = *(short *)(param_1 + 0x23);
        if (sVar1 == 2) {
            local_4c = &mc4_list;
            uVar15 = mc4_list;
        LAB_000245a4:
            if (uVar15 == 0) {
                local_50 = *local_4c;
            } else {
                local_48 = 0;
                local_40 = 0;
                local_50 = 0;
            LAB_000245c4:
                do {
                    while ((uVar16 = *(uint *)(uVar15 + 4),
                            *(short *)(uVar15 + 0x8c) != sVar1 ||
                                (iVar7 = strcmp((char *)(param_1 + 0x1b),
                                                (char *)(uVar15 + 0x6c)),
                                 iVar7 != 0))) {
                    LAB_000245f4:
                        uVar15 = uVar16;
                        if (uVar16 == 0)
                            goto LAB_00024710;
                    }
                    sVar2 = *(short *)(param_1 + 0xd);
                    if (sVar2 != *(short *)(param_1 + 6)) {
                        /* WARNING: Subroutine does not return */
                        FUN_0007fc54(
                            "ntp_io.c", 699, 0,
                            "((a)->sa.sa_family) == ((a_mask)->sa.sa_family)");
                    }
                    if (*(short *)(uVar15 + 0x34) !=
                        *(short *)(uVar15 + 0x18)) {
                        /* WARNING: Subroutine does not return */
                        FUN_0007fc54(
                            "ntp_io.c", 700, 0,
                            "((b)->sa.sa_family) == ((b_mask)->sa.sa_family)");
                    }
                    bVar20 = false;
                    if (sVar2 == *(short *)(uVar15 + 0x34)) {
                        if (sVar2 == 2) {
                            if (param_1[0xe] == *(int *)(uVar15 + 0x38)) {
                            LAB_00024898:
                                puVar11 = param_1 + 7;
                                puVar18 = (uint *)(uVar15 + 0x1c);
                                puVar10 = param_1 + 0xe;
                                iVar7 = 4;
                                goto LAB_000248a8;
                            }
                        } else {
                            puVar10 = param_1 + 0xf;
                            iVar7 =
                                memcmp(puVar10, (void *)(uVar15 + 0x3c), 0x10);
                            if ((iVar7 == 0) &&
                                (param_1[0x13] == *(int *)(uVar15 + 0x4c))) {
                                if (sVar2 != 10)
                                    goto LAB_00024898;
                                puVar11 = param_1 + 8;
                                puVar18 = (uint *)(uVar15 + 0x20);
                                iVar7 = 0x10;
                            LAB_000248a8:
                                puVar19 = (uint *)((int)puVar11 + iVar7);
                                if (puVar11 < puVar19) {
                                    uVar12 = (*puVar11 ^ *puVar18) & *puVar10;
                                    while (uVar12 == 0) {
                                        puVar11 = puVar11 + 1;
                                        if (puVar19 <= puVar11)
                                            goto LAB_00024900;
                                        puVar18 = puVar18 + 1;
                                        puVar10 = puVar10 + 1;
                                        uVar12 =
                                            (*puVar18 ^ *puVar11) & *puVar10;
                                    }
                                } else {
                                LAB_00024900:
                                    bVar20 = true;
                                }
                            }
                        }
                    }
                    if (sVar1 == 10) {
                        uVar9 =
                            ((uint) * (byte *)(uVar15 + 0x28) << 0x1e) >> 0x1f;
                        uVar13 =
                            (uint)(*(int *)(uVar15 + 0x90) << 0x16) >> 0x1f;
                        uVar12 = (uint)((*(uint *)(uVar15 + 0x20) & 0x80ff) ==
                                        0x80fe);
                        uVar8 = uVar12 ^ 1;
                    } else {
                        uVar13 = 0;
                        uVar8 = 1;
                        uVar9 = 0;
                        uVar12 = 0;
                    }
                    if ((uVar8 & local_50) != 0)
                        goto LAB_00024564;
                    if (!bVar20) {
                        if ((uVar12 & (local_50 ^ 1)) != 0)
                            goto LAB_000246b8;
                        goto LAB_000245f4;
                    }
                    if ((((uVar13 ^ 1) & local_48) != 0) ||
                        ((uVar9 & (local_40 ^ 1)) != 0))
                        goto LAB_00024564;
                    if (((uVar12 & (local_50 ^ 1)) == 0) &&
                        (((uVar13 & (local_48 ^ 1)) == 0 &&
                          (((uVar9 ^ 1) & local_40) == 0))))
                        goto LAB_000245f4;
                LAB_000246b8:
                    uVar12 = *local_4c;
                    puVar10 = local_4c;
                    if (uVar12 != uVar15) {
                        if (uVar12 != 0) {
                            for (uVar8 = *(uint *)(uVar12 + 4); uVar8 != 0;
                                 uVar8 = *(uint *)(uVar8 + 4)) {
                                if (uVar8 == uVar15) {
                                    puVar10 = (uint *)(uVar12 + 4);
                                    goto LAB_00024700;
                                }
                                uVar12 = uVar8;
                            }
                        }
                        goto LAB_000245f4;
                    }
                LAB_00024700:
                    *puVar10 = uVar16;
                    uVar15 = uVar16;
                } while (uVar16 != 0);
            LAB_00024710:
                bVar20 = local_50 != 0;
                local_50 = *local_4c;
                if (bVar20) {
                    if (local_50 != 0) {
                        do {
                            uVar15 = local_50;
                            local_50 = *(uint *)(uVar15 + 4);
                        } while (local_50 != 0);
                        local_4c = (uint *)(uVar15 + 4);
                    }
                    goto LAB_0002474c;
                }
            }
        LAB_00024918:
            param_1[1] = local_50;
            *local_4c = (uint)param_1;
        } else {
            local_4c = &mc6_list;
            uVar15 = mc6_list;
            if (sVar1 != 10)
                goto LAB_000245a4;
            local_48 = (uint)(param_1[0x24] << 0x16) >> 0x1f;
            local_40 = ((uint) * (byte *)(param_1 + 10) << 0x1e) >> 0x1f;
            local_50 = (uint)((param_1[8] & 0x80ff) == 0x80fe);
            if (mc6_list != 0)
                goto LAB_000245c4;
            if (local_50 == 0)
                goto LAB_00024918;
        LAB_0002474c:
            param_1[1] = 0;
            *local_4c = (uint)param_1;
        }
        iVar7 = param_1[3];
        if (iVar7 != -1) {
            if (*(short *)(param_1 + 6) == 2) {
                iVar7 = setsockopt(iVar7, 0, 0x20, param_1 + 7, 4);
                if (iVar7 != 0) {
                    uVar6 = FUN_0007d2c0(puVar17);
                    if (iVar5 == __stack_chk_guard) {
                        FUN_00075d40(3,
                                     "setsockopt IP_MULTICAST_IF %s fails: %m",
                                     uVar6);
                        return;
                    }
                    goto LAB_00024a20;
                }
            } else if ((*(short *)(param_1 + 6) == 10) &&
                       (iVar7 =
                            setsockopt(iVar7, 0x29, 0x11, param_1 + 0x2c, 4),
                        iVar7 != 0)) {
                iVar7 = param_1[0x2c];
                if (*(short *)(param_1 + 6) == 2) {
                    iVar14 = 0;
                } else {
                    iVar14 = param_1[0xc];
                }
                if (iVar7 != iVar14) {
                    uVar6 = FUN_0007d2c0(puVar17);
                    if (iVar5 == __stack_chk_guard) {
                        FUN_00075d40(
                            3,
                            "setsockopt IPV6_MULTICAST_IF %u for %s fails: %m",
                            iVar7, uVar6);
                        return;
                    }
                    goto LAB_00024a20;
                }
            }
        }
    }
LAB_00024564:
    if (iVar5 == __stack_chk_guard) {
        return;
    }
LAB_00024a20:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00024a54(int param_1)

{
    int iVar1;
    undefined4 uVar2;
    undefined4 uVar3;
    char *pcVar4;

    iVar1 = __stack_chk_guard;
    if (*(int *)(param_1 + 0xb4) == 0) {
        pcVar4 = "Listen normally";
    } else {
        pcVar4 = "Listen and drop";
    }
    uVar3 = *(undefined4 *)(param_1 + 0x14);
    uVar2 = FUN_0007d454(param_1 + 0x18);
    FUN_00075d40(6, "%s on %d %s %s", pcVar4, uVar3, param_1 + 0x6c, uVar2);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00024af8(int param_1, short *param_2)

{
    undefined4 uVar1;
    int iVar2;
    undefined4 local_38;
    undefined4 local_34;
    undefined4 local_30;
    undefined4 uStack_2c;
    undefined4 uStack_28;
    undefined4 uStack_24;
    undefined4 local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    if (*param_2 == 2) {
        local_38 = *(undefined4 *)(param_2 + 2);
        local_34 = 0;
        iVar2 = setsockopt(*(int *)(param_1 + 0xc), 0, 0x23, &local_38, 8);
        if (iVar2 != 0) {
            uVar1 = 0;
            goto LAB_00024b4c;
        }
    } else if (*param_2 == 10) {
        local_30 = *(undefined4 *)(param_2 + 4);
        uStack_2c = *(undefined4 *)(param_2 + 6);
        uStack_28 = *(undefined4 *)(param_2 + 8);
        uStack_24 = *(undefined4 *)(param_2 + 10);
        local_20 = *(undefined4 *)(param_1 + 0xb0);
        iVar2 =
            setsockopt(*(int *)(param_1 + 0xc), 0x29, 0x14, &local_30, 0x14);
        if (iVar2 != 0) {
            uVar1 = 0;
            goto LAB_00024b4c;
        }
    }
    uVar1 = 1;
    *(uint *)(param_1 + 0x90) = *(uint *)(param_1 + 0x90) | 0x40;
    *(int *)(param_1 + 0x9c) = *(int *)(param_1 + 0x9c) + 1;
LAB_00024b4c:
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar1);
}

void FUN_00024bf8(char *param_1, int *param_2, int param_3)

{
    bool bVar1;
    int iVar2;
    char *pcVar3;
    int *piVar4;
    int iVar5;
    undefined1 auStack_84[24];
    undefined1 auStack_6c[24];
    int local_54;
    int local_50;
    int local_4c;
    int local_48;
    int local_44;
    int local_40;
    int local_3c;
    undefined4 local_38;
    undefined4 local_34;
    undefined4 local_30;
    int local_2c;

    local_2c = __stack_chk_guard;
    iVar2 = FUN_00023f60(param_2);
    if (nic_rule_list != (int *)0x0) {
        piVar4 = nic_rule_list;
        do {
            switch (piVar4[2]) {
            case 0:
                if (iVar2 == 0 && -1 < param_3 << 0x1d) {
                LAB_00024da0:
                    piVar4 = (int *)piVar4[1];
                    goto LAB_00024d78;
                }
                break;
            case 1:
                if ((short)*param_2 == 2)
                    goto LAB_00024da0;
                break;
            case 2:
                if ((short)*param_2 == 10)
                    goto LAB_00024da0;
                break;
            case 3:
                iVar5 = iVar2;
            joined_r0x00024d50:
                if (iVar5 != 0)
                    goto LAB_00024da0;
                break;
            case 4:
                if ((param_1 != (char *)0x0) &&
                    (iVar5 = fnmatch((char *)piVar4[3], param_1, 0x10),
                     iVar5 == 0))
                    goto LAB_00024da0;
                break;
            case 5:
                iVar5 = piVar4[0xb];
                if (iVar5 != -1) {
                    local_54 = *param_2;
                    local_50 = param_2[1];
                    local_4c = param_2[2];
                    local_48 = param_2[3];
                    local_38 = 0;
                    local_34 = 0;
                    local_30 = 0;
                    local_44 = param_2[4];
                    local_40 = param_2[5];
                    local_3c = param_2[6];
                    FUN_00085d2c(auStack_84, &local_54);
                    local_38 = 0;
                    local_34 = 0;
                    local_30 = 0;
                    local_54 = piVar4[4];
                    local_50 = piVar4[5];
                    local_4c = piVar4[6];
                    local_48 = piVar4[7];
                    local_3c = piVar4[10];
                    local_44 = piVar4[8];
                    local_40 = piVar4[9];
                    FUN_00085d2c(auStack_6c, &local_54);
                    iVar5 = FUN_00085548(auStack_84, auStack_6c, iVar5);
                    goto joined_r0x00024d50;
                }
                if ((short)piVar4[4] == (short)*param_2) {
                    if ((short)piVar4[4] == 2) {
                        bVar1 = param_2[1] == piVar4[5];
                    } else {
                        iVar5 = memcmp(param_2 + 2, piVar4 + 6, 0x10);
                        if (iVar5 != 0)
                            break;
                        bVar1 = param_2[6] == piVar4[10];
                    }
                    if (bVar1)
                        goto LAB_00024da0;
                }
            }
            piVar4 = (int *)*piVar4;
        } while (piVar4 != (int *)0x0);
    }
    if (param_3 << 0x1d < 0) {
        piVar4 = (int *)0x0;
    } else if (iVar2 == 0) {
        pcVar3 = param_1;
        if (param_1 != (char *)0x0) {
            pcVar3 = (char *)0x1;
        }
        if (listen_to_virtual_ips != 0) {
            pcVar3 = (char *)0x0;
        }
        if ((pcVar3 == (char *)0x0) ||
            (pcVar3 = strchr(param_1, 0x3a), pcVar3 == (char *)0x0)) {
            piVar4 = nic_rule_list;
            if (nic_rule_list != (int *)0x0) {
                piVar4 = (int *)0x1;
            }
        } else {
            piVar4 = (int *)0x1;
        }
    } else {
        piVar4 = (int *)0x2;
    }
LAB_00024d78:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(piVar4);
    }
    return;
}

void FUN_00024ed0(int param_1, int param_2, int param_3, int param_4)

{
    bool bVar1;
    int iVar2;
    int iVar3;
    int *piVar4;
    undefined4 uVar5;
    uint uVar6;
    uint uVar7;
    uint uVar8;
    uint uVar9;
    void *pvVar10;
    uint *puVar11;
    double dVar12;
    undefined8 uVar13;
    ssize_t local_694;
    int local_68c;
    uint local_688;
    socklen_t local_678;
    iovec local_674[2];
    msghdr local_664;
    sockaddr sStack_648;
    uint local_62c[384];
    int local_2c;

    local_2c = __stack_chk_guard;
    iVar2 = FUN_0007b088();
    if (iVar2 != 0) {
        if (*(int *)(param_2 + 0xb4) == 0) {
            local_664.msg_iov = local_674;
            local_678 = 0x1c;
            local_674[0].iov_base = (void *)(iVar2 + 0x58);
            local_664.msg_namelen = 0x1c;
            pvVar10 = (void *)(iVar2 + 4);
            local_674[0].iov_len = 0x848;
            local_664.msg_iovlen = 1;
            local_664.msg_control = local_62c;
            local_664.msg_controllen = 0x600;
            local_664.msg_name = pvVar10;
            local_664.msg_flags = *(int *)(param_2 + 0xb4);
            local_694 = recvmsg(param_1, &local_664, 0);
            *(ssize_t *)(iVar2 + 0x54) = local_694;
            if (local_694 != 0) {
                if (local_694 == -1) {
                    piVar4 = __errno_location();
                    if (*piVar4 == 0xb)
                        goto LAB_000252a8;
                } else if (-1 < local_694) {
                    if ((*(short *)(iVar2 + 4) == 2) &&
                        (*(short *)(iVar2 + 8) == 0x7f7f)) {
                        uVar5 = FUN_0007d2c0(pvVar10);
                        FUN_00075d40(3,
                                     "recvfrom(%s) fd=%d: refclock srcadr on a "
                                     "network interface!",
                                     uVar5, param_1);
                    } else if (((*(short *)(param_2 + 0x8c) != 10) ||
                                ((((*(int *)(iVar2 + 0xc) != 0 ||
                                    (*(int *)(iVar2 + 0x10) != 0)) ||
                                   (*(int *)(iVar2 + 0x14) != 0)) ||
                                  (*(int *)(iVar2 + 0x18) != 0x1000000)))) ||
                               ((((*(int *)(param_2 + 0x20) == 0 &&
                                   (*(int *)(param_2 + 0x24) == 0)) &&
                                  (*(int *)(param_2 + 0x28) == 0)) &&
                                 (*(int *)(param_2 + 0x2c) == 0x1000000)))) {
                        *(int *)(iVar2 + 0x3c) = param_2;
                        *(int *)(iVar2 + 0x40) = param_1;
                        local_68c = param_4;
                        if ((0xb < local_664.msg_controllen) &&
                            (puVar11 = (uint *)local_664.msg_control,
                             (uint *)local_664.msg_control != (uint *)0x0)) {
                            while (true) {
                                if (puVar11[2] == 0x23) {
                                    local_688 = puVar11[3];
                                    uVar6 = puVar11[4];
                                    if ((measured_tick < sys_tick) &&
                                        (1e-09 < sys_tick)) {
                                        dVar12 = ((double)(longlong)(int)uVar6 *
                                                  1e-09) /
                                                 sys_tick;
                                        uVar6 =
                                            (uint)(longlong)(sys_tick *
                                                             (double)((uint)(0.0 <
                                                                             dVar12) *
                                                                      (int)(longlong)
                                                                          dVar12) *
                                                             1000000000.0);
                                    }
                                    if ((int)uVar6 < 0) {
                                        do {
                                            local_688 = local_688 - 1;
                                            uVar7 = uVar6 + 1000000000;
                                            uVar6 = uVar7;
                                        } while ((int)uVar7 < 0);
                                    } else {
                                        uVar7 = uVar6;
                                        if (999999999 < (int)uVar6) {
                                            uVar7 = uVar6 + 0xc4653600;
                                            uVar8 = local_688;
                                            if (999999999 < (int)uVar7) {
                                                uVar8 = uVar6 + 0x88ca0000;
                                            }
                                            if (uVar7 == 999999999 ||
                                                (int)(uVar6 + 0x88ca6c01) < 0 !=
                                                    SBORROW4(uVar7,
                                                             999999999)) {
                                                local_688 = uVar8 + 1;
                                            } else {
                                                uVar7 = uVar8 + 0x6c00;
                                                local_688 = local_688 + 2;
                                            }
                                        }
                                    }
                                    uVar13 = VectorShiftRight(
                                        CONCAT44(uVar7, uVar7), 0x20);
                                    uVar13 =
                                        VectorShiftLeft(uVar13, 0x20, 0x40, 0);
                                    uVar6 = FUN_0009d518(
                                        (uint)uVar13 + 500000000,
                                        (int)((ulonglong)uVar13 >> 0x20) +
                                            (uint)(0xe2329aff < (uint)uVar13),
                                        1000000000, 0);
                                    iVar3 = FUN_00079a2c();
                                    dVar12 = ((double)(longlong)iVar3 +
                                              (double)(longlong)iVar3) *
                                             2.3283064365386963e-10 * sys_fuzz;
                                    bVar1 = dVar12 < 0.0;
                                    if (bVar1) {
                                        dVar12 = -dVar12;
                                    }
                                    uVar8 = (uint)bVar1;
                                    dVar12 = ldexp(dVar12, 0x20);
                                    uVar13 = FUN_0009d558(
                                        SUB84(dVar12, 0),
                                        (int)((ulonglong)dVar12 >> 0x20));
                                    uVar7 = (uint)uVar13 ^ -uVar8;
                                    uVar9 = uVar8 + uVar7;
                                    local_68c = uVar6 + uVar9;
                                    param_3 =
                                        local_688 + 0x83aa7e80 +
                                        ((uint)((ulonglong)uVar13 >> 0x20) ^
                                         -(uint)(uVar8 != 0)) +
                                        (uint)CARRY4(uVar8, uVar7) +
                                        (uint)CARRY4(uVar6, uVar9);
                                }
                                if (*puVar11 < 0xc)
                                    break;
                                puVar11 = (uint *)((int)puVar11 +
                                                   (*puVar11 + 3 & 0xfffffffc));
                                if (((uint *)((int)local_664.msg_control +
                                              local_664.msg_controllen) <
                                     puVar11 + 3) ||
                                    ((uint *)((int)local_664.msg_control +
                                              local_664.msg_controllen) <
                                     (uint *)((int)puVar11 +
                                              (*puVar11 + 3 & 0xfffffffc))))
                                    break;
                            }
                        }
                        *(int *)(iVar2 + 0x48) = param_3;
                        *(int *)(iVar2 + 0x4c) = local_68c;
                        *(code **)(iVar2 + 0x50) = receive;
                        FUN_0007afc4(iVar2);
                        *(int *)(param_2 + 0xa4) = *(int *)(param_2 + 0xa4) + 1;
                        packets_received = packets_received + 1;
                        goto LAB_00024f7c;
                    }
                    packets_dropped = packets_dropped + 1;
                    FUN_0007af28(iVar2);
                    goto LAB_00024f7c;
                }
                uVar5 = FUN_0007d2c0(pvVar10);
                FUN_00075d40(3, "recvfrom(%s) fd=%d: %m", uVar5, param_1);
            }
        LAB_000252a8:
            FUN_0007af28(iVar2);
            goto LAB_00024f7c;
        }
        FUN_0007af28();
    }
    local_678 = 0x1c;
    local_694 = recvfrom(param_1, local_62c, 0x4b0, 0, &sStack_648, &local_678);
    if (*(int *)(param_2 + 0xb4) == 0) {
        packets_dropped = packets_dropped + 1;
    } else {
        packets_ignored = packets_ignored + 1;
    }
LAB_00024f7c:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(local_694);
}

void FUN_00025414(short *param_1)

{
    short sVar1;
    bool bVar2;
    int iVar3;
    int iVar4;
    int *piVar5;
    int *piVar6;

    iVar3 = __stack_chk_guard;
    piVar5 = remoteaddr_list;
    if (remoteaddr_list != (int *)0x0) {
        sVar1 = *param_1;
        piVar6 = remoteaddr_list;
        do {
            if ((short)piVar6[1] == sVar1) {
                if (sVar1 == 2) {
                    bVar2 = piVar6[2] == *(int *)(param_1 + 2);
                } else {
                    iVar4 = memcmp(piVar6 + 3, param_1 + 4, 0x10);
                    if (iVar4 != 0)
                        goto LAB_00025458;
                    bVar2 = piVar6[7] == *(int *)(param_1 + 0xc);
                }
                if ((bVar2) && (piVar5 = (int *)piVar6[8],
                                (((int *)piVar6[8])[0x24] & 0x40U) == 0x40))
                    break;
            }
        LAB_00025458:
            piVar5 = (int *)*piVar6;
            piVar6 = piVar5;
        } while (piVar5 != (int *)0x0);
    }
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(piVar5);
    }
    return;
}

void FUN_00025508(uint param_1, int param_2)

{
    bool bVar1;
    int iVar2;
    uint uVar3;
    int iVar4;
    uint uVar5;
    bool bVar6;

    iVar2 = __stack_chk_guard;
    if (0x3ff < param_1) {
        FUN_00075d40(3,
                     "Too many sockets in use, FD_SETSIZE %d exceeded by fd %d",
                     0x400, param_1);
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    if (param_2 == 0) {
        iVar4 = __fdelt_chk();
        uVar5 = param_1 & 0x1f;
        if ((int)param_1 < (int)DAT_000ca2c4) {
            param_1 = DAT_000ca2c4;
        }
        DAT_000ca2c4 = param_1;
        (&DAT_000ca244)[iVar4] = (&DAT_000ca244)[iVar4] | 1 << uVar5;
    } else {
        iVar4 = __fdelt_chk();
        uVar5 = DAT_000ca2c4;
        bVar6 = DAT_000ca2c4 != 0;
        bVar1 = param_1 == DAT_000ca2c4;
        (&DAT_000ca244)[iVar4] =
            (&DAT_000ca244)[iVar4] & ~(1 << (param_1 & 0x1f));
        if (bVar6 && bVar1) {
            do {
                uVar5 = uVar5 - 1;
                iVar4 = __fdelt_chk(uVar5);
                uVar3 = uVar5;
                if (((int)(&DAT_000ca244)[iVar4] >> (uVar5 & 0x1f) & 1U) != 0)
                    break;
                uVar3 = DAT_000ca2c4;
            } while (uVar5 != 0);
            DAT_000ca2c4 = uVar3;
            if (param_1 == DAT_000ca2c4) {
                /* WARNING: Subroutine does not return */
                FUN_0007fc54("ntp_io.c", 0x17c, 2, "fd != maxactivefd");
            }
        }
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000256b8(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    undefined4 *puVar2;
    bool bVar3;

    iVar1 = __stack_chk_guard;
    puVar2 = (undefined4 *)FUN_00074b04(0, 0xc, 0);
    bVar3 = iVar1 == __stack_chk_guard;
    puVar2[1] = param_1;
    puVar2[2] = param_2;
    *puVar2 = fd_list;
    fd_list = puVar2;
    if (bVar3) {
        FUN_00025508(param_1, 0);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00025740(sockaddr *param_1, int param_2, int param_3, int param_4)

{
    int iVar1;
    int iVar2;
    int iVar3;
    uint *puVar4;
    undefined4 uVar5;
    undefined4 uVar6;
    socklen_t __len;
    uint uVar7;
    char *pcVar8;
    char *pcVar9;
    sa_family_t sVar10;
    bool bVar11;
    undefined4 local_34;
    undefined4 local_30;
    int local_2c;

    local_34 = 1;
    local_30 = 0;
    local_2c = __stack_chk_guard;
    if ((param_1->sa_family != 10) || (ipv6_works != 0)) {
        iVar1 = socket((uint)param_1->sa_family, 2, 0);
        if (iVar1 == -1) {
            puVar4 = (uint *)__errno_location();
            uVar7 = *puVar4;
            if (param_1->sa_family == 10) {
                pcVar9 = "6";
            } else {
                pcVar9 = "";
            }
            uVar5 = FUN_0007d2c0(param_1);
            FUN_00075d40(
                3, "socket(AF_INET%s, SOCK_DGRAM, 0) failed on address %s: %m",
                pcVar9, uVar5);
            bVar11 = 0x5c < uVar7;
            if (uVar7 != 0x5d) {
                bVar11 = uVar7 != 0x60;
            }
            if (bVar11 && (uVar7 != 0x5d && uVar7 != 0x61)) {
                *puVar4 = uVar7;
                FUN_00075d40(
                    3,
                    "unexpected socket() error %m code %d (not EPROTONOSUPPORT "
                    "nor EAFNOSUPPORT nor EPFNOSUPPORT) - exiting",
                    uVar7);
                /* WARNING: Subroutine does not return */
                exit(1);
            }
        } else {
            iVar1 = FUN_0007d070();
            if (param_3 == 0) {
                iVar2 = setsockopt(iVar1, 1, 2, &local_34, 4);
                if (iVar2 == 0)
                    goto LAB_000257d0;
                pcVar9 = "on";
            LAB_000258a4:
                uVar5 = FUN_0007d2c0(param_1);
                FUN_00075d40(
                    3, "setsockopt SO_REUSEADDR %s fails for address %s: %m",
                    pcVar9, uVar5);
            } else {
                iVar2 = setsockopt(iVar1, 1, 2, &local_30, 4);
                if (iVar2 != 0) {
                    pcVar9 = "off";
                    goto LAB_000258a4;
                }
            LAB_000257d0:
                sVar10 = param_1->sa_family;
                if (sVar10 == 2) {
                    iVar2 = setsockopt(iVar1, 0, 1, &qos, 4);
                    uVar5 = qos;
                    if (iVar2 != 0) {
                        uVar6 = FUN_0007d2c0(param_1);
                        FUN_00075d40(
                            3,
                            "setsockopt IP_TOS (%02x) fails on address %s: %m",
                            uVar5, uVar6);
                    }
                    if (param_2 != 0) {
                        FUN_0002423c(param_4, iVar1, param_1);
                    }
                    sVar10 = param_1->sa_family;
                }
                if (sVar10 == 10) {
                    iVar2 = setsockopt(iVar1, 0x29, 0x43, &qos, 4);
                    uVar5 = qos;
                    if (iVar2 != 0) {
                        uVar6 = FUN_0007d2c0(param_1);
                        FUN_00075d40(3,
                                     "setsockopt IPV6_TCLASS (%02x) fails on "
                                     "address %s: %m",
                                     uVar5, uVar6);
                    }
                    iVar2 = FUN_00085110();
                    if ((iVar2 == 0) &&
                        (iVar2 = setsockopt(iVar1, 0x29, 0x1a, &local_34, 4),
                         iVar2 != 0)) {
                        uVar5 = FUN_0007d2c0(param_1);
                        FUN_00075d40(
                            3,
                            "setsockopt IPV6_V6ONLY on fails on address %s: %m",
                            uVar5);
                    }
                    sVar10 = param_1->sa_family;
                }
                iVar2 = FUN_00023f60(param_1);
                if (iVar2 == 0) {
                    FUN_000242f0(sVar10, 1);
                    sVar10 = param_1->sa_family;
                }
                if (sVar10 == 2) {
                    __len = 0x10;
                } else {
                    __len = 0x1c;
                }
                iVar2 = bind(iVar1, param_1, __len);
                iVar3 = FUN_00023f60(param_1);
                if (iVar3 == 0) {
                    FUN_000242f0(param_1->sa_family);
                }
                if (-1 < iVar2) {
                    iVar2 = setsockopt(iVar1, 1, 0x23, &local_34, 4);
                    if (iVar2 != 0) {
                        uVar5 = FUN_0007d2c0(param_1);
                        FUN_00075d40(7,
                                     "setsockopt SO_TIMESTAMPNS on fails on "
                                     "address %s: %m",
                                     uVar5);
                    }
                    FUN_0007d244(iVar1);
                    FUN_000256b8(iVar1, 0);
                    goto LAB_00025864;
                }
                if (param_3 == 0) {
                    if (param_1->sa_family == 10) {
                        pcVar9 = "6";
                    } else {
                        pcVar9 = "";
                    }
                    uVar5 = FUN_0007d2c0(param_1);
                    uVar7 = (uint)param_1->sa_family;
                    bVar11 = uVar7 == 2;
                    if (bVar11) {
                        uVar7 = *(uint *)(param_1->sa_data + 2);
                    }
                    if (bVar11) {
                        iVar2 = (uVar7 & 0xf0) - 0xe0;
                    } else {
                        iVar2 = (byte)param_1->sa_data[6] - 0xff;
                    }
                    if (iVar2 == 0) {
                        pcVar8 = " (multicast)";
                    } else {
                        pcVar8 = "";
                    }
                    FUN_00075d40(
                        3, "bind(%d) AF_INET%s %s#%d%s flags 0x%x failed: %m",
                        iVar1, pcVar9, uVar5,
                        *(ushort *)param_1->sa_data >> 8 |
                            *(ushort *)param_1->sa_data << 8,
                        pcVar8, *(undefined4 *)(param_4 + 0x90));
                }
            }
            close(iVar1);
        }
    }
    iVar1 = -1;
LAB_00025864:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar1);
}

void FUN_00025be0(int param_1)

{
    undefined4 *puVar1;
    int iVar2;
    int iVar3;
    undefined4 *puVar4;
    undefined4 *puVar5;

    iVar2 = __stack_chk_guard;
    puVar4 = &fd_list;
    puVar5 = fd_list;
    if (fd_list[1] != param_1) {
        puVar5 = (undefined4 *)*fd_list;
        puVar4 = fd_list;
        while (true) {
            puVar1 = puVar5;
            if (puVar1 == (undefined4 *)0x0) {
                return;
            }
            if (puVar1[1] == param_1)
                break;
            puVar5 = (undefined4 *)*puVar1;
            puVar4 = puVar1;
        }
        puVar5 = (undefined4 *)*puVar4;
    }
    iVar3 = puVar5[2];
    *puVar4 = *puVar5;
    if ((iVar3 != 0) && (iVar3 != 1)) {
        FUN_00075d40(3,
                     "internal error - illegal descriptor type %d - EXITING");
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    close(puVar5[1]);
    free(puVar5);
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    FUN_00025508(param_1, 1);
    return;
}

void FUN_00025ce8(undefined4 *param_1)

{
    undefined4 *puVar1;
    int iVar2;
    int iVar3;
    undefined4 *puVar4;
    undefined4 *puVar5;

    iVar2 = __stack_chk_guard;
    puVar5 = &asyncio_reader_list;
    puVar4 = asyncio_reader_list;
    if (param_1 == asyncio_reader_list) {
    LAB_00025d5c:
        *puVar5 = *puVar4;
    } else if (asyncio_reader_list != (undefined4 *)0x0) {
        puVar4 = (undefined4 *)*asyncio_reader_list;
        puVar5 = asyncio_reader_list;
        while (puVar1 = puVar4, puVar1 != (undefined4 *)0x0) {
            if (param_1 == puVar1) {
                puVar4 = (undefined4 *)*puVar5;
                goto LAB_00025d5c;
            }
            puVar5 = puVar1;
            puVar4 = (undefined4 *)*puVar1;
        }
    }
    if (param_1[1] != -1) {
        FUN_00025be0();
    }
    iVar3 = __stack_chk_guard;
    param_1[1] = 0xffffffff;
    if (iVar2 == iVar3) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00025da4(void *param_1)

{
    uint uVar1;
    int *piVar2;
    uint uVar3;
    uint *__buf;
    uint local_141c[1280];
    int local_1c;

    local_1c = __stack_chk_guard;
    if (disable_dynamic_updates == 0) {
        __buf = local_141c;
        uVar1 = read(*(int *)((int)param_1 + 4), __buf, 0x1400);
        if ((int)uVar1 < 0) {
            piVar2 = __errno_location();
            if (*piVar2 != 0x69) {
                FUN_00075d40(3, "routing socket reports: %m - disabling");
                goto LAB_00025ecc;
            }
            FUN_00075d40(3, "routing socket reports: %m");
        } else if (((0xf < (int)uVar1) && (0xf < local_141c[0])) &&
                   (local_141c[0] <= uVar1)) {
            do {
                uVar3 = (ushort)__buf[1] - 3;
                if ((uVar3 & 0xffff) < 0x17) {
                    uVar3 = 1 << (uVar3 & 0xff);
                    if ((uVar3 & 0x666000) == 0) {
                        if ((uVar3 & 1) != 0)
                            break;
                    } else {
                        FUN_00051c38(current_time + 2);
                    }
                }
                uVar3 = *__buf + 3 & 0xfffffffc;
                uVar1 = uVar1 - uVar3;
                __buf = (uint *)((int)__buf + uVar3);
                if ((((int)uVar1 < 0x10) || (*__buf < 0x10)) ||
                    (uVar1 < *__buf))
                    break;
            } while (true);
        }
        if (local_1c == __stack_chk_guard) {
            return;
        }
    } else {
    LAB_00025ecc:
        FUN_00025ce8(param_1);
        if (local_1c == __stack_chk_guard) {
            free(param_1);
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00025f4c(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_0007ae28(10);
    interface_interval = 300;
    addremove_io_fd = &DAT_0002566c;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00026060(int param_1, int param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    undefined4 *puVar2;
    undefined4 uVar3;
    int iVar4;
    bool bVar5;

    iVar1 = __stack_chk_guard;
    puVar2 = (undefined4 *)FUN_00074b04(0, 0x30, 0, 1);
    puVar2[0xb] = param_3;
    puVar2[2] = param_1;
    puVar2[1] = param_4;
    if (param_1 == 4) {
        if (param_2 == 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_io.c", 0x4b7, 0, "((void *)0) != if_name");
        }
        uVar3 = FUN_00074c8c(param_2);
        puVar2[3] = uVar3;
    } else if (param_1 == 5) {
        if (param_2 == 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_io.c", 0x4ba, 0, "((void *)0) != if_name");
        }
        iVar4 = FUN_00074fd8(param_2, 0, puVar2 + 4);
        if (iVar4 == 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_io.c", 0x4bd, 0, "is_ip");
        }
    } else if (param_2 != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_io.c", 0x4bf, 0, "((void *)0) == if_name");
    }
    bVar5 = iVar1 == __stack_chk_guard;
    *puVar2 = nic_rule_list;
    nic_rule_list = puVar2;
    if (bVar5) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x000262b8) */

void FUN_00026274(int param_1, undefined4 param_2)

{
    FUN_0002423c(param_1, *(undefined4 *)(param_1 + 0xc), param_2);
    return;
}

void FUN_00026318(int param_1, short *param_2)

{
    short sVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    undefined4 uVar5;
    undefined4 local_24;
    undefined4 local_20;
    int local_1c;

    sVar1 = *(short *)(param_1 + 0x18);
    local_24 = 0;
    local_20 = 0;
    local_1c = __stack_chk_guard;
    if (sVar1 != *param_2) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54(
            "ntp_io.c", 0x95e, 0,
            "((maddr)->sa.sa_family) == ((&iface->sin)->sa.sa_family)");
    }
    if (sVar1 == 2) {
        iVar2 = setsockopt(*(int *)(param_1 + 0xc), 0, 0x22, &local_24, 4);
        if (iVar2 != 0) {
            uVar5 = *(undefined4 *)(param_1 + 0xc);
            uVar3 = FUN_0007d2c0(param_1 + 0x18);
            uVar4 = FUN_0007d2c0(param_2);
            FUN_00075d40(3,
                         "setsockopt IP_MULTICAST_LOOP failed: %m on socket "
                         "%d, addr %s for multicast address %s",
                         uVar5, uVar3, uVar4);
        }
    } else if (sVar1 == 10) {
        iVar2 = setsockopt(*(int *)(param_1 + 0xc), 0x29, 0x13, &local_20, 4);
        if (iVar2 != 0) {
            uVar5 = *(undefined4 *)(param_1 + 0xc);
            uVar3 = FUN_0007d2c0(param_1 + 0x18);
            uVar4 = FUN_0007d2c0(param_2);
            FUN_00075d40(3,
                         "setsockopt IPV6_MULTICAST_LOOP failed: %m on socket "
                         "%d, addr %s for multicast address %s",
                         uVar5, uVar3, uVar4);
        }
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00026470(void)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    int *piVar4;
    uint uVar5;
    int *piVar6;
    int iVar7;
    int *piVar8;

    iVar1 = __stack_chk_guard;
    FUN_000243d4(1);
    if (ep_list == (int *)0x0) {
        FUN_000243d4(0);
    } else {
        iVar7 = 0;
        piVar6 = ep_list;
        do {
            uVar5 = piVar6[0x24];
            if ((((uVar5 & 0x84) == 0) && (piVar6[0x2d] == 0)) &&
                ((uVar5 & 8) != 0)) {
                if ((short)piVar6[0x14] != 2) {
                    /* WARNING: Subroutine does not return */
                    FUN_0007fc54("ntp_io.c", 0xa46, 0,
                                 "(2 == ((&interf->bcast)->sa.sa_family))");
                }
                if ((uVar5 & 0x20) == 0) {
                    piVar8 = piVar6 + 0x14;
                    *(undefined2 *)(piVar6 + 0x23) = 2;
                    iVar2 = FUN_00025740(piVar8, 1, 0, piVar6);
                    piVar6[4] = iVar2;
                    if (iVar2 == -1) {
                        piVar4 = __errno_location();
                        if (1 < *piVar4 - 0x62U) {
                            uVar3 = FUN_0007d2c0(piVar8);
                            FUN_00075d40(6,
                                         "failed to listen for broadcasts to "
                                         "%s on interface #%d %s",
                                         uVar3, piVar6[5], piVar6 + 0x1b);
                        }
                    } else {
                        iVar7 = iVar7 + 1;
                        piVar6[0x24] = piVar6[0x24] | 0x20;
                        uVar3 = FUN_0007d2c0(piVar8);
                        FUN_00075d40(
                            6,
                            "Listen for broadcasts to %s on interface #%d %s",
                            uVar3, piVar6[5], piVar6 + 0x1b);
                    }
                } else {
                    iVar7 = iVar7 + 1;
                }
            }
            piVar6 = (int *)*piVar6;
        } while (piVar6 != (int *)0x0);
        FUN_000243d4(0);
        if (iVar7 != 0) {
            broadcast_client_enabled = 1;
            if (iVar1 == __stack_chk_guard) {
                return;
            }
            goto LAB_00026630;
        }
    }
    broadcast_client_enabled = 0;
    if (iVar1 == __stack_chk_guard) {
        FUN_00075d40(3, "Unable to listen for broadcasts, no broadcast "
                        "interfaces available");
        return;
    }
LAB_00026630:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00026740(short *param_1)

{
    short sVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    void *__ptr;
    char *pcVar5;
    int iVar6;
    undefined4 uVar7;

    iVar2 = __stack_chk_guard;
    if (*param_1 == 2) {
        iVar6 = (*(uint *)(param_1 + 2) & 0xf0) - 0xe0;
    } else {
        iVar6 = *(byte *)(param_1 + 4) - 0xff;
    }
    if (iVar6 != 0) {
        return;
    }
    iVar6 = FUN_00025414();
    if (iVar6 == 0) {
        __ptr = (void *)FUN_0002416c();
        uVar3 = *(undefined4 *)(param_1 + 2);
        uVar4 = *(undefined4 *)(param_1 + 4);
        uVar7 = *(undefined4 *)(param_1 + 6);
        *(undefined4 *)((int)__ptr + 0x18) = *(undefined4 *)param_1;
        *(undefined4 *)((int)__ptr + 0x1c) = uVar3;
        *(undefined4 *)((int)__ptr + 0x20) = uVar4;
        *(undefined4 *)((int)__ptr + 0x24) = uVar7;
        uVar3 = *(undefined4 *)(param_1 + 10);
        uVar4 = *(undefined4 *)(param_1 + 0xc);
        *(undefined4 *)((int)__ptr + 0x28) = *(undefined4 *)(param_1 + 8);
        *(undefined4 *)((int)__ptr + 0x2c) = uVar3;
        *(undefined4 *)((int)__ptr + 0x30) = uVar4;
        sVar1 = *(short *)((int)__ptr + 0x18);
        *(undefined2 *)((int)__ptr + 0x1a) = 0x7b00;
        *(short *)((int)__ptr + 0x8c) = sVar1;
        *(short *)((int)__ptr + 0x34) = sVar1;
        if (sVar1 == 10) {
            memset((void *)((int)__ptr + 0x3c), 0xff, 0x10);
        } else {
            *(undefined4 *)((int)__ptr + 0x38) = 0xffffffff;
        }
        FUN_000243d4(1);
        *(undefined4 *)((int)__ptr + 0x10) = 0xffffffff;
        iVar6 = FUN_00025740((undefined4 *)((int)__ptr + 0x18), 0, 0, __ptr);
        *(int *)((int)__ptr + 0xc) = iVar6;
        if (iVar6 == -1) {
            free(__ptr);
            __ptr = DAT_000ca2c8;
            if (((*param_1 != 2) && (__ptr = DAT_000ca2cc, *param_1 != 10)) ||
                (__ptr == (void *)0x0)) {
                uVar3 = FUN_0007d2c0(param_1);
                if (iVar2 == __stack_chk_guard) {
                    uVar4 = 3;
                    pcVar5 =
                        "No multicast socket available to use for address %s";
                    goto LAB_000267dc;
                }
                goto LAB_000269d4;
            }
            uVar3 = *(undefined4 *)(param_1 + 2);
            uVar4 = *(undefined4 *)(param_1 + 4);
            uVar7 = *(undefined4 *)(param_1 + 6);
            *(undefined4 *)((int)__ptr + 0x50) = *(undefined4 *)param_1;
            *(undefined4 *)((int)__ptr + 0x54) = uVar3;
            *(undefined4 *)((int)__ptr + 0x58) = uVar4;
            *(undefined4 *)((int)__ptr + 0x5c) = uVar7;
            uVar3 = *(undefined4 *)(param_1 + 10);
            uVar4 = *(undefined4 *)(param_1 + 0xc);
            *(undefined4 *)((int)__ptr + 0x60) = *(undefined4 *)(param_1 + 8);
            *(undefined4 *)((int)__ptr + 100) = uVar3;
            *(undefined4 *)((int)__ptr + 0x68) = uVar4;
            uVar3 = FUN_0007d2c0(param_1);
            FUN_00075d40(
                3, "multicast address %s using wildcard interface #%d %s",
                uVar3, *(undefined4 *)((int)__ptr + 0x14), (int)__ptr + 0x6c);
        } else {
            uVar3 = 0;
            *(undefined4 *)((int)__ptr + 0xb4) = 0;
            *(uint *)((int)__ptr + 0x90) = *(uint *)((int)__ptr + 0x90) | 0x100;
            if (*param_1 != 2) {
                uVar3 = *(undefined4 *)(param_1 + 0xc);
            }
            *(undefined4 *)((int)__ptr + 0xb0) = uVar3;
            FUN_0007e4b4((int)__ptr + 0x6c, "multicast", 0x20);
            FUN_000244c8(__ptr);
            FUN_00024a54(__ptr);
        }
        iVar6 = FUN_00024af8(__ptr, param_1);
        if (iVar6 != 0) {
            uVar3 = FUN_0007d2c0((int)__ptr + 0x18);
            uVar4 = FUN_0007d2c0(param_1);
            FUN_00075d40(6, "Joined %s socket to multicast group %s", uVar3,
                         uVar4);
        }
        if (iVar2 == __stack_chk_guard) {
            FUN_000240d4(param_1, __ptr);
            return;
        }
    } else {
        uVar3 = FUN_0007d2c0(param_1);
        if (iVar2 == __stack_chk_guard) {
            uVar4 = 6;
            pcVar5 = "Duplicate request found for multicast address %s";
        LAB_000267dc:
            FUN_00075d40(uVar4, pcVar5, uVar3);
            return;
        }
    }
LAB_000269d4:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x00026efc */
/* WARNING: Restarted to delay deadcode elimination for space: register */

void FUN_00026cc0(sockaddr *param_1, int param_2, int param_3, void *param_4,
                  size_t param_5)

{
    bool bVar1;
    int iVar2;
    ssize_t sVar3;
    undefined4 uVar4;
    socklen_t __addr_len;
    bool bVar5;
    int local_3c;
    undefined1 local_35;
    undefined4 local_34;
    undefined4 local_30;
    int local_2c;

    bVar5 = false;
    local_34 = 0;
    local_30 = 0;
    local_2c = __stack_chk_guard;
    if (param_1->sa_family == 2) {
        bVar5 = (*(uint *)(param_1->sa_data + 2) & 0xf0) == 0xe0;
        if (bVar5) {
            param_2 = mc4_list;
        }
    } else if (param_1->sa_data[6] == -1) {
        bVar5 = true;
        param_2 = mc6_list;
    }
    local_3c = param_3;
    if (param_2 != 0) {
        do {
            bVar1 = bVar5;
            if (local_3c < 1) {
                bVar1 = false;
            }
            if ((bVar1) && (local_3c != *(int *)(param_2 + 0x94))) {
                if (*(short *)(param_2 + 0x18) == 2) {
                    local_35 = (undefined1)local_3c;
                    iVar2 = setsockopt(*(int *)(param_2 + 0xc), 0, 0x21,
                                       &local_35, 1);
                joined_r0x00026e58:
                    if (iVar2 != 0) {
                        uVar4 = FUN_0007d2c0(param_2 + 0x18);
                        FUN_00075d40(
                            3,
                            "setsockopt IP_MULTICAST_TTL/IPV6_MULTICAST_HOPS "
                            "fails on address %s: %m",
                            uVar4);
                        goto LAB_00026ddc;
                    }
                } else if (*(short *)(param_2 + 0x18) == 10) {
                    iVar2 = setsockopt(*(int *)(param_2 + 0xc), 0x29, 0x12,
                                       &local_3c, 4);
                    goto joined_r0x00026e58;
                }
                *(int *)(param_2 + 0x94) = local_3c;
            }
        LAB_00026ddc:
            if (param_1->sa_family == 2) {
                __addr_len = 0x10;
            } else {
                __addr_len = 0x1c;
            }
            sVar3 = sendto(*(int *)(param_2 + 0xc), param_4, param_5, 0,
                           param_1, __addr_len);
            if (sVar3 == -1) {
                *(int *)(param_2 + 0xac) = *(int *)(param_2 + 0xac) + 1;
                packets_notsent = packets_notsent + 1;
            } else {
                *(int *)(param_2 + 0xa8) = *(int *)(param_2 + 0xa8) + 1;
                packets_sent = packets_sent + 1;
            }
            if (bVar5) {
                param_2 = *(int *)(param_2 + 4);
            }
            bVar1 = bVar5;
            if (param_2 == 0) {
                bVar1 = false;
            }
        } while (bVar1);
        if (param_2 == 0) {
            param_2 = 0;
        } else {
            param_2 = param_2 + 0x18;
        }
        FUN_00052ebc(
            SUB84((double)*(uint *)((int)param_4 + 4), 0),
            (int)((ulonglong)(double)*(uint *)((int)param_4 + 4) >> 0x20),
            SUB84((double)*(uint *)((int)param_4 + 8), 0), param_2, param_1,
            (int)param_4 + 0x18, (int)param_4 + 0x20);
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00026f70(void)

{
    int iVar1;
    undefined4 uVar2;
    int iVar3;
    ssize_t sVar4;
    int *piVar5;
    char *pcVar6;
    int iVar7;
    uint uVar8;
    undefined1 uVar9;
    int iVar10;
    undefined1 *puVar11;
    size_t sVar12;
    uint uVar13;
    int *piVar14;
    uint uVar15;
    __time_t local_57c;
    __suseconds_t _Stack_578;
    __time_t local_574;
    __suseconds_t _Stack_570;
    __time_t local_56c;
    __suseconds_t _Stack_568;
    timeval local_564;
    fd_set fStack_55c;
    undefined1 auStack_4dc[1200];
    int local_2c;

    local_2c = __stack_chk_guard;
    handler_calls = handler_calls + 1;
    memcpy(&fStack_55c, &DAT_000ca244, 0x80);
    iVar1 = select(DAT_000ca2c4 + 1, &fStack_55c, (fd_set *)0x0, (fd_set *)0x0,
                   (timeval *)0x0);
    if (iVar1 < 0) {
        piVar5 = __errno_location();
        iVar10 = *piVar5;
        if (iVar10 != 4) {
            iVar3 = DAT_000ca2c4 + 1;
            uVar13 = DAT_000ca2c4;
            if (0xfe < (int)DAT_000ca2c4) {
                uVar13 = 0xff;
            }
            if ((int)uVar13 < 0) {
                puVar11 = &DAT_000ca2d0;
            } else {
                puVar11 = &DAT_000ca2d0;
                uVar15 = uVar13;
                do {
                    iVar7 = __fdelt_chk(uVar15);
                    uVar8 = uVar15 & 0x1f;
                    uVar15 = uVar15 - 1;
                    if (((int)(&DAT_000ca244)[iVar7] >> uVar8 & 1U) == 0) {
                        uVar9 = 0x2d;
                    } else {
                        uVar9 = 0x23;
                    }
                    *puVar11 = uVar9;
                    puVar11 = puVar11 + 1;
                } while (uVar15 != 0xffffffff);
                puVar11 = (undefined1 *)(uVar13 + 0xca2d1);
            }
            *puVar11 = 0;
            FUN_00075d40(3, "select(%d, %s, 0L, 0L, &0.0) error: %m", iVar3,
                         &DAT_000ca2d0);
            if (iVar10 == 9) {
                if ((int)DAT_000ca2c4 < 0) {
                    iVar1 = 1;
                    uVar13 = 0;
                } else {
                    uVar8 = 0;
                    uVar15 = 0;
                    do {
                        iVar1 = __fdelt_chk(uVar8);
                        uVar13 = uVar15;
                        if ((((int)(&DAT_000ca244)[iVar1] >>
                                  ((int)uVar8 % 0x20 & 0xffU) &
                              1U) != 0) &&
                            (sVar4 = read(uVar8, &local_564, 0), uVar13 = uVar8,
                             sVar4 == -1)) {
                            FUN_00075d40(3,
                                         "Removing bad file descriptor %d from "
                                         "select set",
                                         uVar8);
                            iVar1 = __fdelt_chk(uVar8);
                            (&DAT_000ca244)[iVar1] =
                                (&DAT_000ca244)[iVar1] &
                                ~(1 << ((int)uVar8 % 0x20 & 0xffU));
                            uVar13 = uVar15;
                        }
                        uVar8 = uVar8 + 1;
                        uVar15 = uVar13;
                    } while ((int)uVar8 <= (int)DAT_000ca2c4);
                    iVar1 = uVar13 + 1;
                    if (DAT_000ca2c4 == uVar13) {
                        uVar13 = DAT_000ca2c4;
                    }
                }
                DAT_000ca2c4 = uVar13;
                local_564.tv_sec = 0;
                local_564.tv_usec = 0;
                memcpy(&fStack_55c, &DAT_000ca244, 0x80);
                iVar1 = select(iVar1, &fStack_55c, (fd_set *)0x0, (fd_set *)0x0,
                               &local_564);
                if (0 < iVar1)
                    goto LAB_0002706c;
            }
        }
        if ((iVar1 == -1) && (*piVar5 != 4)) {
            FUN_00075d40(3, "select() error: %m");
        }
    } else if (iVar1 != 0) {
    LAB_0002706c:
        FUN_0007055c(&local_57c);
        local_574 = local_57c;
        _Stack_570 = _Stack_578;
        handler_pkts = handler_pkts + 1;
        piVar5 = ep_list;
        if (DAT_000ca3d0 != (int *)0x0) {
            piVar14 = DAT_000ca3d0;
            do {
                iVar10 = piVar14[5];
                iVar1 = __fdelt_chk(iVar10);
                if ((fStack_55c.fds_bits[iVar1] >> (iVar10 % 0x20 & 0xffU) &
                     1U) != 0) {
                    local_56c = local_574;
                    _Stack_568 = _Stack_570;
                    iVar1 = FUN_0007b088();
                    if (iVar1 == 0) {
                        iVar3 = read(iVar10, auStack_4dc, 0x4b0);
                        packets_dropped = packets_dropped + 1;
                    } else {
                        sVar12 = piVar14[4];
                        if (0x847 < sVar12 - 1) {
                            sVar12 = 0x848;
                        }
                        do {
                            iVar3 =
                                read(iVar10, (void *)(iVar1 + 0x58), sVar12);
                            if (-1 < iVar3) {
                                if (iVar3 != 0) {
                                    iVar7 = piVar14[3];
                                    *(int *)(iVar1 + 0x54) = iVar3;
                                    *(int *)(iVar1 + 4) = iVar7;
                                    iVar7 = piVar14[1];
                                    *(int *)(iVar1 + 0x40) = iVar10;
                                    *(undefined4 *)(iVar1 + 0x3c) = 0;
                                    *(__time_t *)(iVar1 + 0x48) = local_56c;
                                    *(__suseconds_t *)(iVar1 + 0x4c) =
                                        _Stack_568;
                                    *(int *)(iVar1 + 0x50) = iVar7;
                                    iVar1 = FUN_0004a81c(piVar14, iVar1);
                                    if (iVar1 == 0) {
                                        piVar14[6] = piVar14[6] + 1;
                                        packets_received = packets_received + 1;
                                    }
                                    goto LAB_000271f4;
                                }
                                piVar5 = __errno_location();
                                iVar7 = *piVar5;
                                break;
                            }
                            piVar5 = __errno_location();
                            iVar7 = *piVar5;
                        } while (iVar7 == 4);
                        FUN_0007af28(iVar1);
                        *piVar5 = iVar7;
                    }
                    if (iVar3 < 0) {
                        piVar5 = __errno_location();
                        iVar1 = *piVar5;
                        if (iVar1 != 0xb) {
                            uVar2 = FUN_0007b36c(piVar14[3] + 0x10);
                            *piVar5 = iVar1;
                            pcVar6 = "%s read: %m";
                        LAB_000270e4:
                            FUN_00075d40(3, pcVar6, uVar2);
                            FUN_00025508(iVar10, 1);
                            goto LAB_000270f8;
                        }
                    } else {
                    LAB_000271f4:
                        if (iVar3 == 0) {
                            uVar2 = FUN_0007b36c(piVar14[3] + 0x10);
                            pcVar6 = "%s read EOF";
                            goto LAB_000270e4;
                        }
                    }
                    do {
                        while (true) {
                            local_564.tv_sec = local_574;
                            local_564.tv_usec = _Stack_570;
                            iVar1 = FUN_0007b088();
                            if (iVar1 == 0)
                                break;
                            sVar12 = piVar14[4];
                            if (0x847 < sVar12 - 1) {
                                sVar12 = 0x848;
                            }
                            while (true) {
                                sVar4 = read(iVar10, (void *)(iVar1 + 0x58),
                                             sVar12);
                                if (-1 < sVar4)
                                    break;
                                piVar5 = __errno_location();
                                iVar3 = *piVar5;
                                if (iVar3 != 4)
                                    goto LAB_000272d0;
                            }
                            if (sVar4 == 0) {
                                piVar5 = __errno_location();
                                iVar3 = *piVar5;
                            LAB_000272d0:
                                FUN_0007af28(iVar1);
                                piVar14 = (int *)*piVar14;
                                *piVar5 = iVar3;
                                goto joined_r0x000272f4;
                            }
                            iVar3 = piVar14[3];
                            *(ssize_t *)(iVar1 + 0x54) = sVar4;
                            *(int *)(iVar1 + 0x40) = iVar10;
                            *(int *)(iVar1 + 4) = iVar3;
                            iVar3 = piVar14[1];
                            *(undefined4 *)(iVar1 + 0x3c) = 0;
                            *(__time_t *)(iVar1 + 0x48) = local_564.tv_sec;
                            *(__suseconds_t *)(iVar1 + 0x4c) =
                                local_564.tv_usec;
                            *(int *)(iVar1 + 0x50) = iVar3;
                            iVar1 = FUN_0004a81c(piVar14, iVar1);
                            if (iVar1 == 0) {
                                piVar14[6] = piVar14[6] + 1;
                                packets_received = packets_received + 1;
                            }
                        }
                        sVar4 = read(iVar10, auStack_4dc, 0x4b0);
                        packets_dropped = packets_dropped + 1;
                    } while (0 < sVar4);
                }
            LAB_000270f8:
                piVar14 = (int *)*piVar14;
            joined_r0x000272f4:
                piVar5 = ep_list;
            } while (piVar14 != (int *)0x0);
        }
    joined_r0x00027308:
        piVar14 = asyncio_reader_list;
        if (piVar5 != (int *)0x0) {
            iVar1 = 1;
        LAB_0002736c:
            uVar13 = piVar5[3];
            if (-1 < (int)uVar13)
                goto LAB_00027330;
        LAB_00027360:
            iVar1 = iVar1 + 1;
            if (iVar1 != 1) {
                if ((piVar5[0x24] & 0x20U) != 0)
                    goto code_r0x00027324;
                goto LAB_00027418;
            }
            goto LAB_0002736c;
        }
        while (piVar5 = piVar14, piVar14 != (int *)0x0) {
            while (true) {
                piVar14 = (int *)*piVar5;
                iVar1 = __fdelt_chk(piVar5[1]);
                if ((fStack_55c.fds_bits[iVar1] >> (piVar5[1] % 0x20 & 0xffU) &
                     1U) == 0)
                    break;
                (*(code *)piVar5[3])(piVar5);
                piVar5 = piVar14;
                if (piVar14 == (int *)0x0)
                    goto LAB_00027498;
            }
        }
    LAB_00027498:
        if (blocking_children_alloc != 0) {
            uVar13 = 0;
            do {
                iVar1 = *(int *)(blocking_children + uVar13 * 4);
                if (((iVar1 != 0) && (*(int *)(iVar1 + 0x34) != -1)) &&
                    (iVar10 = __fdelt_chk(),
                     (fStack_55c.fds_bits[iVar10] >>
                          (*(int *)(iVar1 + 0x34) % 0x20 & 0xffU) &
                      1U) != 0)) {
                    *(int *)(iVar1 + 0x44) = *(int *)(iVar1 + 0x44) + 1;
                    blocking_child_ready_seen = blocking_child_ready_seen + 1;
                }
                uVar13 = uVar13 + 1;
            } while (uVar13 < blocking_children_alloc);
        }
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
code_r0x00027324:
    uVar13 = piVar5[4];
    if (-1 < (int)uVar13) {
    LAB_00027330:
        iVar10 = __fdelt_chk(uVar13);
        if ((fStack_55c.fds_bits[iVar10] >> (uVar13 & 0x1f) & 1U) != 0) {
            do {
                iVar10 = FUN_00024ed0(uVar13, piVar5, local_574, _Stack_570);
            } while (0 < iVar10);
        }
    }
    if (iVar1 == 2) {
    LAB_00027418:
        piVar5 = (int *)*piVar5;
        goto joined_r0x00027308;
    }
    goto LAB_00027360;
}

void FUN_000277b8(undefined4 param_1, uint param_2)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00023ff0();
    if ((iVar2 != 0) && ((param_2 & *(uint *)(iVar2 + 0x90)) != 0)) {
        iVar2 = 0;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2);
}

/* WARNING: Type propagation algorithm not settling */

void FUN_00027818(sockaddr *param_1, undefined4 param_2, int param_3)

{
    bool bVar1;
    byte bVar2;
    byte bVar3;
    ushort uVar4;
    bool bVar5;
    int __fd;
    int iVar6;
    int *piVar7;
    uint uVar8;
    socklen_t __len;
    uint uVar9;
    uint uVar10;
    uint *puVar11;
    byte *pbVar12;
    char *pcVar13;
    byte *pbVar14;
    int *piVar15;
    socklen_t local_80[2];
    sockaddr local_78;
    uint local_5c;
    undefined4 local_58;
    uint local_54;
    uint local_50;
    uint local_4c;
    undefined4 local_48;
    uint local_44;
    uint local_40;
    undefined4 local_3c;
    uint local_38;
    uint local_34;
    uint local_30;
    uint local_2c;
    uint local_28;
    int local_24;

    local_24 = __stack_chk_guard;
    if ((param_1->sa_family != 0) &&
        (__fd = socket((uint)param_1->sa_family, 2, 0), __fd != -1)) {
        if (param_3 == 0) {
        LAB_00027870:
            if (param_1->sa_family == 2) {
                __len = 0x10;
            } else {
                __len = 0x1c;
            }
            iVar6 = connect(__fd, param_1, __len);
            if (iVar6 != -1) {
                local_80[0] = 0x1c;
                iVar6 = getsockname(__fd, &local_78, local_80);
                close(__fd);
                if (iVar6 != -1) {
                    piVar7 = (int *)FUN_000277b8(&local_78, param_2);
                    if ((piVar7 != (int *)0x0) && (piVar7[0x2d] == 0))
                        goto LAB_00027a2c;
                    piVar7 = (int *)0x0;
                    local_40 = 0;
                    local_3c = 0;
                    local_38 = 0;
                    local_34 = 0;
                    local_30 = 0;
                    local_2c = 0;
                    local_28 = 0;
                    if (ep_list != (int *)0x0) {
                        piVar15 = ep_list;
                        do {
                            if (((piVar15[0x2d] == 0) &&
                                 (*(ushort *)(piVar15 + 0x23) ==
                                  local_78.sa_family)) &&
                                (uVar9 = piVar15[0x24] & 0x84, uVar9 == 0)) {
                                uVar4 = *(ushort *)(piVar15 + 6);
                                if (uVar4 != *(ushort *)(piVar15 + 0x23)) {
                                    /* WARNING: Subroutine does not return */
                                    FUN_0007fc54("ntp_io.c", 0x103e, 0,
                                                 "((a1)->sa.sa_family) == "
                                                 "((a2)->sa.sa_family)");
                                }
                                local_58 = uVar9;
                                local_5c = (uint)uVar4;
                                local_54 = uVar9;
                                local_50 = uVar9;
                                local_4c = uVar9;
                                local_48 = uVar9;
                                local_44 = uVar9;
                                if (uVar4 == 2) {
                                    uVar10 = piVar15[7];
                                    uVar8 =
                                        local_78.sa_data._2_4_ << 0x18 |
                                        ((uint)local_78.sa_data._2_4_ >> 8 &
                                         0xff)
                                            << 0x10 |
                                        ((uint)local_78.sa_data._2_4_ >> 0x10 &
                                         0xff)
                                            << 8 |
                                        (uint)local_78.sa_data._2_4_ >> 0x18;
                                    uVar10 = uVar10 << 0x18 |
                                             (uVar10 >> 8 & 0xff) << 0x10 |
                                             (uVar10 >> 0x10 & 0xff) << 8 |
                                             uVar10 >> 0x18;
                                    if (uVar10 < uVar8) {
                                        uVar8 = uVar8 - uVar10;
                                    } else {
                                        uVar8 = uVar10 - uVar8;
                                    }
                                    local_58 = uVar8 << 0x18 |
                                               (uVar8 >> 8 & 0xff) << 0x10 |
                                               (uVar8 >> 0x10 & 0xff) << 8 |
                                               uVar8 >> 0x18;
                                } else {
                                    pbVar14 = (byte *)(piVar15 + 8);
                                    pcVar13 = local_78.sa_data + 6;
                                    bVar1 = false;
                                    bVar5 = false;
                                    puVar11 = &local_54;
                                    do {
                                        if (bVar5) {
                                            bVar2 = *pbVar14;
                                            bVar3 = *pcVar13;
                                        joined_r0x000279c4:
                                            if (bVar1) {
                                                bVar1 = true;
                                                bVar5 = true;
                                                *(byte *)puVar11 =
                                                    bVar3 - bVar2;
                                            } else {
                                                bVar5 = true;
                                                *(byte *)puVar11 =
                                                    bVar2 - bVar3;
                                            }
                                        } else {
                                            bVar3 = *pcVar13;
                                            bVar2 = *pbVar14;
                                            if (bVar3 != bVar2) {
                                                bVar1 = bVar2 < bVar3;
                                                goto joined_r0x000279c4;
                                            }
                                            *(char *)puVar11 = '\0';
                                        }
                                        puVar11 = (uint *)((int)puVar11 + 1);
                                        pbVar14 = pbVar14 + 1;
                                        pcVar13 = pcVar13 + 1;
                                    } while (puVar11 != &local_44);
                                }
                                if (piVar7 == (int *)0x0) {
                                LAB_00027ae8:
                                    local_40 = local_5c;
                                    local_3c = local_58;
                                    local_38 = local_54;
                                    local_34 = local_50;
                                    local_30 = local_4c;
                                    local_2c = local_48;
                                    local_28 = uVar9;
                                    piVar7 = piVar15;
                                } else {
                                    if (local_40 != local_5c) {
                                        /* WARNING: Subroutine does not return
                                         */
                                        FUN_0007fc54("ntp_io.c", 0x1071, 0,
                                                     "((d1)->sa.sa_family) == "
                                                     "((d2)->sa.sa_family)");
                                    }
                                    if (local_40 == 2) {
                                        if ((local_58 << 0x18 |
                                             (local_58 >> 8 & 0xff) << 0x10 |
                                             (local_58 >> 0x10 & 0xff) << 8 |
                                             local_58 >> 0x18) <
                                            (local_3c << 0x18 |
                                             (local_3c >> 8 & 0xff) << 0x10 |
                                             (local_3c >> 0x10 & 0xff) << 8 |
                                             local_3c >> 0x18))
                                            goto LAB_00027ae8;
                                    } else {
                                        pbVar12 = (byte *)((int)&local_58 + 3);
                                        pbVar14 = (byte *)((int)&local_3c + 3);
                                        do {
                                            pbVar12 = pbVar12 + 1;
                                            pbVar14 = pbVar14 + 1;
                                            if (*pbVar12 < *pbVar14)
                                                goto LAB_00027ae8;
                                        } while (
                                            (*pbVar12 <= *pbVar14) &&
                                            (pbVar12 !=
                                             (byte *)((int)&local_48 + 3)));
                                    }
                                }
                            }
                            piVar15 = (int *)*piVar15;
                        } while (piVar15 != (int *)0x0);
                        if (piVar7 != (int *)0x0) {
                            if (piVar7[0x2d] != 0) {
                                piVar7 = (int *)0x0;
                            }
                            goto LAB_00027a2c;
                        }
                    }
                }
                goto LAB_00027a70;
            }
        } else {
            local_80[1] = 1;
            iVar6 = setsockopt(__fd, 1, 6, local_80 + 1, 4);
            if (iVar6 != -1)
                goto LAB_00027870;
        }
        close(__fd);
    }
LAB_00027a70:
    piVar7 = (int *)0x0;
LAB_00027a2c:
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(piVar7);
    }
    return;
}

void FUN_00027b78(short *param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00027818(param_1, 0x80, 0);
    if ((iVar2 == 0) && (iVar2 = any6_interface, *param_1 == 2)) {
        iVar2 = any_interface;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2);
}

void FUN_00027c04(code *param_1, undefined4 param_2)

{
    int iVar1;
    undefined4 *puVar2;
    undefined4 uVar3;
    undefined4 *puVar4;
    undefined4 *puVar5;
    undefined4 *puVar6;
    undefined4 *puVar7;
    uint uVar8;
    undefined4 uVar9;
    undefined4 local_1cc;
    undefined4 local_1b0;
    undefined4 *local_1ac;
    undefined1 local_1a8;
    uint local_1a4;
    undefined4 local_1a0;
    undefined4 local_19c;
    undefined4 local_198;
    undefined4 local_194;
    undefined4 local_190;
    undefined4 local_18c;
    undefined1 auStack_188[32];
    uint local_168;
    uint local_164;
    uint local_160;
    uint local_104;
    undefined4 local_100;
    undefined1 auStack_fc[12];
    undefined4 local_f0;
    undefined4 local_ec;
    short local_e4;
    undefined2 local_e2;
    uint local_e0;
    undefined1 local_dc[20];
    short local_c8;
    undefined2 local_c6;
    short local_ac;
    undefined2 local_aa;
    undefined1 auStack_90[32];
    short local_70;
    ushort local_6e;
    uint local_6c;
    undefined4 local_4c;
    int local_48;
    undefined1 local_3c;
    undefined1 local_3b;
    undefined1 local_3a;
    undefined1 local_39;
    undefined1 local_38;
    undefined1 local_37;
    undefined1 local_36;
    undefined1 local_35;
    undefined1 local_34;
    undefined1 local_33;
    undefined1 local_32;
    undefined1 local_31;
    undefined1 local_30;
    undefined1 local_2f;
    undefined1 local_2e;
    undefined1 local_2d;
    int local_2c;

    local_1b0 = 0;
    local_2c = __stack_chk_guard;
    iVar1 = FUN_00080d88(0xffffffff, &local_1b0);
    if (iVar1 != 0) {
        local_1cc = 0;
    LAB_00027c54:
        if (local_2c != __stack_chk_guard) {
            /* WARNING: Subroutine does not return */
            __stack_chk_fail(local_1cc);
        }
        return;
    }
    DAT_000ca240 = DAT_000ca240 ^ 1;
    iVar1 = FUN_000810a0(local_1b0);
    if (iVar1 == 0) {
        local_1cc = 0;
        do {
            while (true) {
                iVar1 = FUN_00081014(local_1b0, auStack_188);
                if (iVar1 != 0)
                    goto LAB_00027fa0;
                if ((local_164 & 0xfffffff7) != 2)
                    goto LAB_00027f8c;
                if (local_164 == 2)
                    break;
                if ((local_164 != 10) || (ipv6_works != 0)) {
                LAB_00027d30:
                    memset(auStack_fc, 0, 0xc0);
                    local_6e = DAT_000ca240;
                    local_f0 = 0xffffffff;
                    local_ec = 0xffffffff;
                    local_2d = 1;
                    local_3c = 0;
                    local_3b = 0;
                    local_3a = 0;
                    local_39 = 0;
                    local_38 = 0;
                    local_37 = 0;
                    local_36 = 0;
                    local_35 = 0;
                    local_34 = 0;
                    local_33 = 0;
                    local_32 = 0;
                    local_31 = 0;
                    local_30 = 0;
                    local_2f = 0;
                    local_2e = 0;
                    FUN_0007e4b4(auStack_90, auStack_188, 0x20);
                    local_e2 = 0x7b00;
                    local_c6 = 0x7b00;
                    local_e4 = (short)local_168;
                    local_4c = local_100;
                    local_aa = 0x7b00;
                    if (((local_168 & 0xffff) == 2) &&
                        (local_e0 = local_160, (local_104 & 8) != 0)) {
                        local_6c = local_6c | 8;
                    }
                    if ((local_104 & 0x20) == 0) {
                        uVar8 = 0;
                    } else {
                        uVar8 = 0x200;
                    }
                    uVar8 = local_104 & 0x17 | uVar8 | local_6c;
                    local_c8 = local_e4;
                    local_ac = local_e4;
                    local_70 = local_e4;
                    local_6c = uVar8;
                    if ((uVar8 & 4) != 0) {
                        if ((local_168 & 0xffff) == 2) {
                            if ((local_e0 & 0xff) != 0x7f)
                                goto LAB_00027e70;
                        } else {
                            iVar1 = memcmp(&local_3c, local_dc, 0x10);
                            if (iVar1 != 0) {
                            LAB_00027e70:
                                uVar8 = uVar8 & 0xfffffffb;
                                local_6c = uVar8;
                            }
                        }
                    }
                    iVar1 = FUN_00024bf8(auStack_90, &local_e4, uVar8);
                    if (iVar1 != 1) {
                        if (iVar1 == 0) {
                            local_48 = 0;
                        } else if (iVar1 == 2) {
                            local_48 = 1;
                        }
                        if ((((local_6c & 1) != 0) &&
                             (iVar1 = FUN_00023f60(&local_e4), iVar1 == 0)) &&
                            ((local_e4 == 2 || (local_e4 == 10)))) {
                            puVar2 =
                                (undefined4 *)FUN_000277b8(&local_e4, 0x80);
                            if ((puVar2 == (undefined4 *)0x0) ||
                                (puVar2[3] == -1)) {
                                puVar2 = (undefined4 *)FUN_0002416c(auStack_fc);
                                puVar7 = puVar2 + 6;
                                iVar1 = FUN_00025740(puVar7, 0, 0, puVar2);
                                puVar2[3] = iVar1;
                                if (iVar1 == -1) {
                                    if ((puVar2[0x24] & 8) == 0) {
                                    LAB_00028508:
                                        if (puVar2[4] != -1)
                                            goto LAB_00028514;
                                    } else if (puVar2[4] != -1)
                                        goto LAB_000284e0;
                                LAB_00028614:
                                    uVar9 = puVar2[5];
                                    uVar3 = FUN_0007d2c0(puVar7);
                                    FUN_00075d40(3,
                                                 "unable to create socket on "
                                                 "%s (%d) for %s#%d",
                                                 puVar2 + 0x1b, uVar9, uVar3,
                                                 0x7b);
                                    free(puVar2);
                                    uVar3 = FUN_0007d2c0(&local_e4);
                                    FUN_00075d40(6,
                                                 "failed to init interface for "
                                                 "address %s",
                                                 uVar3);
                                } else {
                                    FUN_00024a54(puVar2);
                                    if ((puVar2[0x24] & 8) == 0) {
                                    LAB_000284fc:
                                        if (puVar2[3] == -1)
                                            goto LAB_00028508;
                                    } else {
                                        if (puVar2[4] != -1) {
                                        LAB_000284e0:
                                            uVar3 = FUN_0007d2c0(puVar2 + 0x14);
                                            FUN_00075d40(
                                                6,
                                                "Listening on broadcast "
                                                "address %s#%d",
                                                uVar3, 0x7b);
                                            goto LAB_000284fc;
                                        }
                                        if (puVar2[3] == -1)
                                            goto LAB_00028614;
                                    }
                                LAB_00028514:
                                    local_1a0 = 0;
                                    local_19c = 0;
                                    local_198 = 0;
                                    local_194 = 0;
                                    local_190 = 0;
                                    local_18c = 0;
                                    local_1a4 = (uint) * (ushort *)(puVar2 + 6);
                                    if (*(ushort *)(puVar2 + 6) == 10) {
                                        memset(&local_19c, 0xff, 0x10);
                                    } else {
                                        local_1a0 = 0xffffffff;
                                    }
                                    FUN_00051008(1, puVar7, &local_1a4,
                                                 0xfffffffc, 0x3000, 1, 0);
                                    if (((loopback_interface ==
                                          (undefined4 *)0x0) &&
                                         (*(short *)(puVar2 + 0x23) == 2)) &&
                                        ((puVar2[0x24] & 4) != 0)) {
                                        loopback_interface = puVar2;
                                    }
                                    FUN_000240d4(puVar7, puVar2);
                                    FUN_000244c8(puVar2);
                                    local_1a8 = 2;
                                    local_1ac = puVar2;
                                    if (param_1 == (code *)0x0) {
                                        local_1cc = 1;
                                    } else {
                                        (*param_1)(param_2, &local_1ac);
                                        local_1cc = 1;
                                    }
                                }
                            } else {
                                puVar7 = puVar2 + 0x1b;
                                if (*(ushort *)((int)puVar2 + 0x8e) ==
                                    DAT_000ca240) {
                                    FUN_0007e4b4(puVar7, "*multiple*", 0x20);
                                    iVar1 = puVar2[0x2d];
                                } else {
                                    FUN_0007e4b4(puVar7, auStack_90, 0x20);
                                    puVar2[0x2d] = local_48;
                                    iVar1 = local_48;
                                }
                                if (local_48 != iVar1) {
                                    uVar3 = FUN_0007d2c0(&local_e4);
                                    FUN_00075d40(
                                        3,
                                        "WARNING: conflicting enable "
                                        "configuration for interfaces %s and "
                                        "%s for address %s - unsupported "
                                        "configuration - address DISABLED",
                                        auStack_90, puVar7, uVar3);
                                    puVar2[0x2d] = 1;
                                }
                                local_1a8 = 1;
                                *(ushort *)((int)puVar2 + 0x8e) = DAT_000ca240;
                                local_1ac = puVar2;
                                if (param_1 != (code *)0x0) {
                                    (*param_1)(param_2, &local_1ac);
                                }
                            }
                        }
                    }
                }
            LAB_00027f8c:
                iVar1 = FUN_0008117c(local_1b0);
                if (iVar1 != 0)
                    goto LAB_00027fa0;
            }
            if (ipv4_works != 0)
                goto LAB_00027d30;
            iVar1 = FUN_0008117c(local_1b0);
        } while (iVar1 == 0);
    } else {
        local_1cc = 0;
    }
LAB_00027fa0:
    FUN_00081260(&local_1b0);
    puVar2 = ep_list;
    while (puVar7 = puVar2, puVar7 != (undefined4 *)0x0) {
        uVar8 = puVar7[0x24];
        puVar2 = (undefined4 *)*puVar7;
        if (((uVar8 & 0x180) == 0) &&
            (*(ushort *)((int)puVar7 + 0x8e) != DAT_000ca240)) {
            puVar5 = &ep_list;
            puVar6 = puVar7;
            if (puVar7 == ep_list) {
            LAB_0002803c:
                *puVar5 = *puVar6;
            } else if (ep_list != (undefined4 *)0x0) {
                puVar4 = (undefined4 *)*ep_list;
                puVar5 = ep_list;
                while (puVar6 = puVar4, puVar6 != (undefined4 *)0x0) {
                    if (puVar6 == puVar7)
                        goto LAB_0002803c;
                    puVar5 = puVar6;
                    puVar4 = (undefined4 *)*puVar6;
                }
            }
            if ((puVar7[0x2d] == 0) && ((uVar8 & 0x10) != 0)) {
                if (*(short *)(puVar7 + 0x23) == 2) {
                    puVar6 = &mc4_list;
                } else {
                    puVar6 = &mc6_list;
                }
                puVar5 = (undefined4 *)*puVar6;
                puVar4 = puVar7;
                if (puVar7 == puVar5) {
                LAB_000280b0:
                    *puVar6 = puVar4[1];
                } else if (puVar5 != (undefined4 *)0x0) {
                    for (puVar4 = (undefined4 *)puVar5[1];
                         puVar4 != (undefined4 *)0x0;
                         puVar4 = (undefined4 *)puVar4[1]) {
                        if (puVar7 == puVar4) {
                            puVar6 = puVar5 + 1;
                            goto LAB_000280b0;
                        }
                        puVar5 = puVar4;
                    }
                }
            }
            puVar6 = (undefined4 *)remoteaddr_list[8];
        joined_r0x000280cc:
            puVar4 = remoteaddr_list;
            puVar5 = &remoteaddr_list;
            if (puVar7 == puVar6)
                goto LAB_00028108;
            puVar6 = (undefined4 *)*remoteaddr_list;
            puVar5 = remoteaddr_list;
            while (puVar4 = puVar6, puVar4 != (undefined4 *)0x0) {
                if (puVar7 == (undefined4 *)puVar4[8])
                    goto code_r0x00028100;
                puVar5 = puVar4;
                puVar6 = (undefined4 *)*puVar4;
            }
            if (puVar7[3] != -1) {
                uVar9 = puVar7[5];
                uVar3 = FUN_0007d2c0(puVar7 + 6);
                FUN_00075d40(
                    6,
                    "Deleting interface #%d %s, %s#%d, interface stats: "
                    "received=%ld, sent=%ld, dropped=%ld, active_time=%ld secs",
                    uVar9, puVar7 + 0x1b, uVar3,
                    *(ushort *)((int)puVar7 + 0x1a) >> 8 |
                        *(ushort *)((int)puVar7 + 0x1a) << 8,
                    puVar7[0x29], puVar7[0x2a], puVar7[0x2b],
                    current_time - puVar7[0x28]);
                FUN_00025be0(puVar7[3]);
                puVar7[3] = 0xffffffff;
            }
            if (puVar7[4] != -1) {
                uVar3 = FUN_0007d2c0(puVar7 + 0x14);
                FUN_00075d40(
                    6,
                    "stop listening for broadcasts to %s on interface #%d %s",
                    uVar3, puVar7[5], puVar7 + 0x1b);
                FUN_00025be0(puVar7[4]);
                puVar7[4] = 0xffffffff;
            }
            ninterfaces = ninterfaces + -1;
            FUN_00041414(puVar7);
            local_1a0 = 0;
            local_19c = 0;
            local_198 = 0;
            local_194 = 0;
            local_190 = 0;
            local_18c = 0;
            local_1a4 = (uint) * (ushort *)(puVar7 + 6);
            if (*(ushort *)(puVar7 + 6) == 10) {
                memset(&local_19c, 0xff, 0x10);
            } else {
                local_1a0 = 0xffffffff;
            }
            FUN_00051008(4, puVar7 + 6, &local_1a4, 0xfffffffd, 0x3000, 1, 0);
            local_1a8 = 3;
            local_1ac = puVar7;
            if (param_1 != (code *)0x0) {
                (*param_1)(param_2, &local_1ac);
            }
            while (puVar7[0x2e] != 0) {
                FUN_00042358(puVar7[0x2e], 0);
            }
            if (puVar7 == loopback_interface) {
                loopback_interface = (undefined4 *)0x0;
            }
            free(puVar7);
        }
    }
    FUN_000425bc();
    if (broadcast_client_enabled != 0) {
        FUN_00026470();
    }
    puVar2 = ep_list;
    if (sys_bclient != 0) {
        FUN_00026470();
        puVar2 = ep_list;
    }
joined_r0x00028308:
    if (puVar2 != (undefined4 *)0x0) {
        do {
            if ((puVar2[0x24] & 0x140) == 0x100) {
                puVar7 = &remoteaddr_list;
                do {
                    puVar7 = (undefined4 *)*puVar7;
                    if (puVar7 == (undefined4 *)0x0)
                        goto LAB_00028318;
                } while (puVar2 != (undefined4 *)puVar7[8]);
                iVar1 = FUN_00024af8(puVar2, puVar7 + 1);
                if (iVar1 != 0)
                    goto code_r0x0002836c;
            }
        LAB_00028318:
            puVar2 = (undefined4 *)*puVar2;
            if (puVar2 == (undefined4 *)0x0)
                break;
        } while (true);
    }
    goto LAB_00027c54;
code_r0x00028100:
    puVar4 = (undefined4 *)*puVar5;
LAB_00028108:
    *puVar5 = *puVar4;
    free(puVar4);
    puVar6 = (undefined4 *)remoteaddr_list[8];
    goto joined_r0x000280cc;
code_r0x0002836c:
    uVar3 = FUN_0007d2c0(puVar2 + 6);
    uVar9 = FUN_0007d2c0(puVar7 + 1);
    FUN_00075d40(6, "Joined %s socket to multicast group %s", uVar3, uVar9);
    puVar2 = (undefined4 *)*puVar2;
    goto joined_r0x00028308;
}

/* WARNING: Globals starting with '_' overlap smaller symbols at the same
 * address */

void FUN_00028720(void)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    int iVar4;
    undefined4 *puVar5;
    sockaddr local_54;
    undefined4 local_44;
    undefined4 local_40;
    undefined4 local_3c;
    undefined4 local_38;
    undefined4 local_34;
    undefined4 local_30;
    int local_2c;

    puVar5 = (undefined4 *)&DAT_000ca240;
    local_2c = __stack_chk_guard;
    if ((DAT_000ca3d4 == 0) &&
        ((*(uint *)(ntpdOptions._68_4_ + 0x5d0) & 0xf) == 0)) {
        DAT_000ca2c4 = 0;
        DAT_000ca3d4 = 1;
        do {
            puVar5 = puVar5 + 1;
            *puVar5 = 0;
        } while (puVar5 != (undefined4 *)0xca2c0);
        local_54.sa_data[10] = '\0';
        local_54.sa_data[0xb] = '\0';
        local_54.sa_data[0xc] = '\0';
        local_54.sa_data[0xd] = '\0';
        local_44 = 0;
        local_40 = 0;
        local_3c = 0;
        local_38 = 0;
        local_34 = 0;
        local_30 = 0;
        if (ipv6_works != 0) {
            local_54.sa_data[10] = '\n';
            local_54.sa_data[0xb] = '\0';
            local_54.sa_data[0xc] = '\0';
            local_54.sa_data[0xd] = '{';
            local_40 = in6addr_any;
            local_3c = ___memcpy_chk;
            local_38 = ___res_init;
            local_34 = _tcgetattr;
            iVar1 = FUN_00024bf8(0, local_54.sa_data + 10, 0);
            if (iVar1 != 1) {
                iVar2 = FUN_0002416c(0);
                FUN_0007e4b4(iVar2 + 0x6c, "v6wildcard", 0x20);
                iVar4 = iVar2 + 0x18;
                *(undefined4 *)(iVar2 + 0x18) = local_54.sa_data._10_4_;
                *(undefined4 *)(iVar2 + 0x24) = local_3c;
                *(undefined4 *)(iVar2 + 0x1c) = local_44;
                *(undefined4 *)(iVar2 + 0x20) = local_40;
                *(undefined4 *)(iVar2 + 0x28) = local_38;
                *(undefined4 *)(iVar2 + 0x2c) = local_34;
                *(undefined4 *)(iVar2 + 0x30) = local_30;
                *(undefined2 *)(iVar2 + 0x8c) = 10;
                *(undefined2 *)(iVar2 + 0x34) = 10;
                memset((void *)(iVar2 + 0x3c), 0xff, 0x10);
                *(undefined4 *)(iVar2 + 0x90) = 0x81;
                *(uint *)(iVar2 + 0xb4) = (uint)(iVar1 == 2);
                iVar1 = FUN_00025740(iVar4, 0, 1, iVar2);
                *(int *)(iVar2 + 0xc) = iVar1;
                if (iVar1 == -1) {
                    uVar3 = FUN_0007d2c0(iVar4);
                    FUN_00075d40(3,
                                 "unable to bind to wildcard address %s - "
                                 "another process may be running - EXITING",
                                 uVar3);
                    /* WARNING: Subroutine does not return */
                    exit(1);
                }
                DAT_000ca2cc = iVar2;
                any6_interface = iVar2;
                FUN_000240d4(iVar4, iVar2);
                FUN_000244c8(iVar2);
                FUN_00024a54(iVar2);
            }
        }
        if (ipv4_works != 0) {
            local_44 = 0;
            local_54.sa_data[10] = '\x02';
            local_54.sa_data[0xb] = '\0';
            local_54.sa_data[0xc] = '\0';
            local_54.sa_data[0xd] = '{';
            iVar1 = FUN_00024bf8(0, local_54.sa_data + 10, 0);
            if (iVar1 != 1) {
                iVar2 = FUN_0002416c(0);
                FUN_0007e4b4(iVar2 + 0x6c, "v4wildcard", 0x20);
                iVar4 = iVar2 + 0x18;
                *(undefined4 *)(iVar2 + 0x18) = local_54.sa_data._10_4_;
                *(undefined4 *)(iVar2 + 0x24) = local_3c;
                *(undefined4 *)(iVar2 + 0x1c) = local_44;
                *(undefined4 *)(iVar2 + 0x20) = local_40;
                *(undefined4 *)(iVar2 + 0x28) = local_38;
                *(undefined4 *)(iVar2 + 0x2c) = local_34;
                *(undefined4 *)(iVar2 + 0x30) = local_30;
                *(undefined2 *)(iVar2 + 0x8c) = 2;
                *(undefined2 *)(iVar2 + 0x34) = 2;
                *(uint *)(iVar2 + 0xb4) = (uint)(iVar1 == 2);
                *(undefined2 *)(iVar2 + 0x50) = 2;
                *(undefined4 *)(iVar2 + 0x54) = 0;
                *(undefined2 *)(iVar2 + 0x52) = 0x7b00;
                *(undefined4 *)(iVar2 + 0x38) = 0xffffffff;
                *(undefined4 *)(iVar2 + 0x90) = 0x89;
                iVar1 = FUN_00025740(iVar4, 0, 1, iVar2);
                *(int *)(iVar2 + 0xc) = iVar1;
                if (iVar1 == -1) {
                    uVar3 = FUN_0007d2c0(iVar4);
                    FUN_00075d40(3,
                                 "unable to bind to wildcard address %s - "
                                 "another process may be running - EXITING",
                                 uVar3);
                    /* WARNING: Subroutine does not return */
                    exit(1);
                }
                DAT_000ca2c8 = iVar2;
                any_interface = iVar2;
                FUN_000240d4(iVar4, iVar2);
                FUN_000244c8(iVar2);
                FUN_00024a54(iVar2);
            }
        }
        FUN_00027c04(0);
        FUN_000243d4(0);
        iVar1 = socket(0x10, 3, 0);
        if (iVar1 < 0) {
            FUN_00075d40(3, "unable to open routing socket (%m) - using polled "
                            "interface update");
        } else {
            iVar1 = FUN_0007d070();
            local_54.sa_data[2] = '\0';
            local_54.sa_data[3] = '\0';
            local_54.sa_data[4] = '\0';
            local_54.sa_data[5] = '\0';
            local_54.sa_family = 0x10;
            local_54.sa_data[0] = '\0';
            local_54.sa_data[1] = '\0';
            local_54.sa_data[6] = 'q';
            local_54.sa_data[7] = '\a';
            local_54.sa_data[8] = '\0';
            local_54.sa_data[9] = '\0';
            iVar2 = bind(iVar1, &local_54, 0xc);
            if (iVar2 < 0) {
                FUN_00075d40(3, "bind failed on routing socket (%m) - using "
                                "polled interface update");
            } else {
                FUN_0007d244(iVar1);
                puVar5 = (undefined4 *)FUN_00074b04(0, 0x10, 0, 1);
                puVar5[3] = FUN_00025da4;
                puVar5[1] = iVar1;
                *puVar5 = asyncio_reader_list;
                asyncio_reader_list = puVar5;
                FUN_000256b8(iVar1, 0);
                FUN_00075d40(6,
                             "Listening on routing socket on fd #%d for "
                             "interface updates",
                             iVar1);
            }
        }
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00028ba4(void)

{
    int iVar1;
    int iVar2;
    sem_t *__sem;
    int iVar3;
    uint uVar4;

    iVar3 = __stack_chk_guard;
    if ((disable_dynamic_updates == 0) &&
        (iVar2 = FUN_00027c04(), iVar1 = __stack_chk_guard, iVar2 != 0)) {
        if (iVar3 == __stack_chk_guard) {
            if (blocking_children_alloc != 0) {
                uVar4 = 0;
                do {
                    iVar3 = *(int *)(blocking_children + uVar4 * 4);
                    if ((iVar3 != 0) && (__sem = *(sem_t **)(iVar3 + 0x30),
                                         __sem != (sem_t *)0x0)) {
                        sem_post(__sem);
                    }
                    uVar4 = uVar4 + 1;
                } while (uVar4 < blocking_children_alloc);
            }
            if (iVar1 == __stack_chk_guard) {
                return;
            }
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
    } else if (iVar3 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00028c28(short *param_1)

{
    short sVar1;
    bool bVar2;
    int iVar3;
    int *piVar4;
    short *psVar5;
    int iVar6;
    int iVar7;
    short sVar8;
    uint uVar9;
    uint uVar10;
    int *piVar11;

    iVar3 = __stack_chk_guard;
    piVar4 = (int *)FUN_00027818(param_1, 0x84, 1);
    if (piVar4 == (int *)0x0) {
        if (ep_list == (int *)0x0) {
            sVar8 = *param_1;
        } else {
            sVar8 = *param_1;
            piVar4 = ep_list;
            do {
                uVar10 = piVar4[0x24];
                if (((((uVar10 & 0x80) == 0) && (piVar4[0x2d] == 0)) &&
                     (sVar1 = (short)piVar4[6], sVar1 == sVar8)) &&
                    ((uVar10 & 4) == 0)) {
                    if (sVar8 == 2) {
                        uVar9 = *(uint *)(param_1 + 2);
                        if (((((uVar9 & 0xf0) == 0xe0) &&
                              ((uVar10 & 0x10) != 0)) ||
                             (((short)piVar4[0x14] == 2 &&
                               (piVar4[0x15] == uVar9)))) ||
                            (sVar8 = sVar1,
                             ((piVar4[7] ^ uVar9) & piVar4[0xe]) == 0))
                            goto LAB_00028c60;
                    } else if (((char)param_1[4] == -1) &&
                               ((uVar10 & 0x10) != 0)) {
                        if (((sVar8 != 10) ||
                             ((*(byte *)((int)param_1 + 9) & 0xf) != 2)) ||
                            (sVar8 = sVar1, (piVar4[8] & 0xc0ffU) == 0x80fe))
                            goto LAB_00028c60;
                    } else {
                        sVar8 = sVar1;
                        if (sVar1 == 10) {
                            if ((((short)piVar4[0x14] == 10) &&
                                 (iVar6 =
                                      memcmp(piVar4 + 0x16, param_1 + 4, 0x10),
                                  iVar6 == 0)) &&
                                (piVar4[0x1a] == *(int *)(param_1 + 0xc)))
                                goto LAB_00028c60;
                            piVar11 = piVar4 + 6;
                            psVar5 = (short *)FUN_000763ac(piVar11);
                            sVar8 = *psVar5;
                            psVar5 = (short *)FUN_000763ac(param_1);
                            if (*psVar5 == sVar8) {
                                psVar5 = (short *)FUN_000763ac(piVar11);
                                if (*psVar5 == 2) {
                                    iVar6 = FUN_000763ac(piVar11);
                                    iVar7 = *(int *)(iVar6 + 4);
                                    iVar6 = FUN_000763ac(param_1);
                                    bVar2 = iVar7 == *(int *)(iVar6 + 4);
                                } else {
                                    iVar6 = FUN_000763ac(piVar11);
                                    iVar7 = FUN_000763ac(param_1);
                                    iVar6 = memcmp((void *)(iVar6 + 8),
                                                   (void *)(iVar7 + 8), 0x10);
                                    if (iVar6 != 0)
                                        goto LAB_00028d28;
                                    iVar6 = FUN_000763ac(piVar11);
                                    iVar7 = *(int *)(iVar6 + 0x18);
                                    iVar6 = FUN_000763ac(param_1);
                                    bVar2 = iVar7 == *(int *)(iVar6 + 0x18);
                                }
                                if (bVar2)
                                    goto LAB_00028c60;
                            }
                        LAB_00028d28:
                            sVar8 = *param_1;
                        }
                    }
                }
                piVar4 = (int *)*piVar4;
            } while (piVar4 != (int *)0x0);
        }
        piVar4 = any_interface;
        if (sVar8 != 2) {
            piVar4 = any6_interface;
        }
    }
LAB_00028c60:
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(piVar4);
    }
    return;
}

void FUN_00028eb8(int param_1, short *param_2, int param_3)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = any6_interface;
    if ((*param_2 == 2) && (iVar2 = loopback_interface, iVar3 = any_interface,
                            param_2[2] == 0x7f7f)) {
    LAB_00028f70:
        if (iVar2 == iVar3) {
        LAB_00028f84:
            iVar2 = FUN_00027b78(param_2);
        }
        if (iVar2 == 0)
            goto LAB_00028f1c;
    } else {
        if ((*(byte *)(param_1 + 0x48) & 0x36) != 0) {
            iVar2 = FUN_00028c28(param_2);
            goto LAB_00028f70;
        }
        if ((param_3 == 0) || (iVar2 = param_3, param_3 == iVar3))
            goto LAB_00028f84;
    }
    if ((*(uint *)(iVar2 + 0x90) & 0x80) != 0) {
        iVar2 = 0;
    }
LAB_00028f1c:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar2);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00029054) */

void FUN_00028fac(void)

{
    packets_dropped = 0;
    packets_ignored = 0;
    packets_received = 0;
    packets_sent = 0;
    packets_notsent = 0;
    handler_calls = 0;
    handler_pkts = 0;
    io_timereset = current_time;
    return;
}

undefined4 FUN_00029084(undefined4 *param_1)

{
    int iVar1;

    param_1[7] = 1;
    iVar1 = __stack_chk_guard;
    *param_1 = DAT_000ca3d0;
    DAT_000ca3d0 = param_1;
    FUN_000256b8(param_1[5], 1);
    if (iVar1 == __stack_chk_guard) {
        return 1;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000290fc(undefined4 *param_1)

{
    undefined4 *puVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 *puVar4;
    undefined4 *puVar5;

    param_1[7] = 0;
    iVar2 = __stack_chk_guard;
    if (param_1 == DAT_000ca3d0) {
        puVar5 = &DAT_000ca3d0;
        puVar4 = DAT_000ca3d0;
    LAB_00029178:
        uVar3 = param_1[5];
        *puVar5 = *puVar4;
        FUN_00025be0(uVar3);
        FUN_0007b1c0(param_1[5]);
        param_1[5] = 0xffffffff;
    } else if (DAT_000ca3d0 != (undefined4 *)0x0) {
        puVar4 = (undefined4 *)*DAT_000ca3d0;
        puVar5 = DAT_000ca3d0;
        while (puVar1 = puVar4, puVar1 != (undefined4 *)0x0) {
            if (param_1 == puVar1) {
                puVar4 = (undefined4 *)*puVar5;
                goto LAB_00029178;
            }
            puVar5 = puVar1;
            puVar4 = (undefined4 *)*puVar1;
        }
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x000292ac) */

void FUN_0002924c(int param_1)

{
    if (param_1 != 0) {
        FUN_0007d2c0(param_1 + 0x18);
        return;
    }
    return;
}

void FUN_000292c0(short *param_1, short *param_2)

{
    int iVar1;
    short *psVar2;

    iVar1 = __stack_chk_guard;
    fwrite("Stack now", 1, 9, stderr);
    if (param_1 <= param_2) {
        do {
            psVar2 = param_1 + 1;
            __fprintf_chk(stderr, 1, " %d", (int)*param_1);
            param_1 = psVar2;
        } while (psVar2 <= param_2);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    fputc(10, stderr);
    return;
}

void FUN_00029370(FILE *param_1, int param_2)

{
    int iVar1;
    char *pcVar2;

    iVar1 = __stack_chk_guard;
    if (param_2 < 0xd0) {
        pcVar2 = "token";
    } else {
        pcVar2 = "nterm";
    }
    __fprintf_chk(param_1, 1, "%s %s (", pcVar2, (&DAT_000c46e0)[param_2]);
    if (iVar1 == __stack_chk_guard) {
        fputc(0x29, param_1);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00029418(char *param_1, undefined4 param_2)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if (param_1 == (char *)0x0) {
        param_1 = "Deleting";
    }
    if (yydebug == 0) {
        return;
    }
    __fprintf_chk(stderr, 1, &DAT_000a14fc, param_1);
    FUN_00029370(stderr, param_2);
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    fputc(10, stderr);
    return;
}

void FUN_000294e4(char *param_1, byte *param_2)

{
    byte *pbVar1;
    byte bVar2;
    int iVar3;
    uint uVar4;
    char *pcVar5;
    byte *pbVar6;

    iVar3 = __stack_chk_guard;
    uVar4 = (uint)*param_2;
    if (uVar4 == 0x22) {
        uVar4 = 0;
        pbVar6 = param_2;
        while (bVar2 = pbVar6[1], bVar2 != 0x27) {
            if (bVar2 < 0x28) {
                if (bVar2 == 0x22) {
                    if (param_1 != (char *)0x0) {
                        param_1[uVar4] = '\0';
                    }
                    goto LAB_00029528;
                }
            LAB_000295a4:
                pbVar6 = pbVar6 + 1;
            } else {
                if (bVar2 == 0x2c)
                    break;
                if (bVar2 != 0x5c)
                    goto LAB_000295a4;
                pbVar1 = pbVar6 + 2;
                pbVar6 = pbVar6 + 2;
                if (*pbVar1 != 0x5c)
                    break;
            }
            if (param_1 != (char *)0x0) {
                param_1[uVar4] = *pbVar6;
            }
            uVar4 = uVar4 + 1;
        }
    }
    if (param_1 == (char *)0x0) {
        if (iVar3 == __stack_chk_guard) {
            strlen((char *)param_2);
            return;
        }
    } else {
        pcVar5 = stpcpy(param_1, (char *)param_2);
        uVar4 = (int)pcVar5 - (int)param_1;
    LAB_00029528:
        if (iVar3 == __stack_chk_guard) {
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar4);
}

void FUN_000295d8(uint *param_1, undefined4 *param_2, short *param_3,
                  int param_4)

{
    uint uVar1;
    uint uVar2;
    uint uVar3;
    char *pcVar4;
    int iVar5;
    char cVar6;
    int iVar7;
    short *psVar8;
    char *pcVar9;
    undefined4 uVar10;
    int iVar11;
    int iVar12;
    bool bVar13;
    undefined4 local_40[5];
    int local_2c;

    uVar10 = (&DAT_000c46e0)[param_4];
    local_2c = __stack_chk_guard;
    uVar1 = FUN_000294e4(0, uVar10);
    uVar3 = uVar1;
    if (param_4 == -2) {
        iVar5 = 0;
        uVar2 = 0xc;
        pcVar4 = "syntax error";
        goto LAB_0002974c;
    }
    local_40[0] = uVar10;
    iVar5 = (int)(short)(&DAT_0009f658)[*param_3];
    if (iVar5 != -0xd7) {
        iVar12 = 0x297 - iVar5;
        if (iVar5 < 0) {
            iVar7 = -iVar5;
        } else {
            iVar7 = 0;
        }
        if (0xcf < iVar12) {
            iVar12 = 0xd0;
        }
        if (iVar7 < iVar12) {
            psVar8 =
                (short *)(&DAT_0009f9c0 + (iVar5 + 0x7fffffff + iVar7) * 2);
            iVar11 = 1;
            do {
                psVar8 = psVar8 + 1;
                iVar5 = iVar11;
                if (iVar7 != 1 && iVar7 == *psVar8) {
                    if (iVar11 == 5)
                        goto LAB_00029850;
                    iVar5 = iVar11 + 1;
                    local_40[iVar11] = (&DAT_000c46e0)[iVar7];
                    uVar2 = FUN_000294e4(0);
                    bVar13 = CARRY4(uVar2, uVar3);
                    uVar3 = uVar2 + uVar3;
                    if (bVar13)
                        goto LAB_00029720;
                }
                iVar7 = iVar7 + 1;
                iVar11 = iVar5;
            } while (iVar7 != iVar12);
            switch (iVar5) {
            case 1:
                uVar1 = uVar3;
                goto LAB_00029850;
            case 2:
                uVar2 = 0x29;
                pcVar4 = "syntax error, unexpected %s, expecting %s";
                break;
            case 3:
                uVar2 = 0x2f;
                pcVar4 = "syntax error, unexpected %s, expecting %s or %s";
                break;
            case 4:
                uVar2 = 0x35;
                pcVar4 =
                    "syntax error, unexpected %s, expecting %s or %s or %s";
                break;
            case 5:
                uVar2 = 0x3b;
                pcVar4 = "syntax error, unexpected %s, expecting %s or %s or "
                         "%s or %s";
                break;
            default:
                pcVar4 = (char *)0x0;
                uVar2 = strlen((char *)0x0);
            }
            goto LAB_0002974c;
        }
    }
LAB_00029850:
    uVar2 = 0x1b;
    iVar5 = 1;
    pcVar4 = "syntax error, unexpected %s";
    uVar3 = uVar1;
LAB_0002974c:
    uVar1 = uVar2 + uVar3;
    if (CARRY4(uVar2, uVar3)) {
    LAB_00029720:
        uVar10 = 2;
    } else if (*param_1 < uVar1) {
        if (uVar1 * 2 < uVar1) {
            *param_1 = 0xffffffff;
        } else {
            *param_1 = uVar1 * 2;
        }
        uVar10 = 1;
    } else {
        pcVar9 = (char *)*param_2;
        cVar6 = *pcVar4;
        iVar12 = 0;
        while (*pcVar9 = cVar6, cVar6 != '\0') {
            bVar13 = cVar6 == '%';
            cVar6 = pcVar4[1];
            if ((bVar13) && (iVar12 < iVar5 && cVar6 == 's')) {
                pcVar4 = pcVar4 + 2;
                iVar7 = FUN_000294e4(pcVar9, local_40[iVar12]);
                cVar6 = *pcVar4;
                pcVar9 = pcVar9 + iVar7;
                iVar12 = iVar12 + 1;
            } else {
                pcVar9 = pcVar9 + 1;
                pcVar4 = pcVar4 + 1;
            }
        }
        uVar10 = 0;
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar10);
    }
    return;
}

void FUN_000298ac(undefined4 param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_0002c704();
    *(undefined4 *)(iVar2 + 0x28) = *(undefined4 *)(iVar2 + 0x20);
    *(undefined4 *)(iVar2 + 0x2c) = *(undefined4 *)(iVar2 + 0x24);
    FUN_00075d40(3, "line %d column %d %s", *(undefined4 *)(iVar2 + 0x28),
                 *(undefined4 *)(iVar2 + 0x2c), param_1);
    iVar3 = FUN_0002c69c();
    if (iVar3 == 0) {
        iVar2 = FUN_0007d00c(remote_config._2052_4_ + 0x118910,
                             0x400 - remote_config._2052_4_, "column %d %s",
                             *(undefined4 *)(iVar2 + 0x2c), param_1);
        if (0 < iVar2) {
            remote_config._2052_4_ = remote_config._2052_4_ + iVar2;
        }
        remote_config._2056_4_ = remote_config._2056_4_ + 1;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00029988(void)

{
    byte bVar1;
    short sVar2;
    short *__dest;
    undefined4 uVar3;
    char *pcVar4;
    undefined1 uVar5;
    short sVar6;
    uint *puVar7;
    char cVar8;
    int iVar9;
    uint *puVar10;
    undefined4 uVar11;
    uint uVar12;
    uint uVar13;
    int iVar14;
    uint uVar15;
    short *psVar16;
    short *psVar17;
    short *psVar18;
    int iVar19;
    uint uVar20;
    uint local_960;
    uint local_954;
    uint *local_950;
    int local_948;
    uint local_940;
    uint uStack_93c;
    ushort local_938;
    int local_934;
    char *local_908;
    undefined4 local_904;
    short local_900[200];
    uint auStack_770[401];
    char acStack_12c[128];
    undefined1 auStack_ac[128];
    int local_2c;

    local_904 = 0x80;
    local_2c = __stack_chk_guard;
    local_908 = acStack_12c;
    if (yydebug != 0) {
        fwrite("Starting parse\n", 1, 0xf, stderr);
    }
    local_950 = auStack_770;
    iVar14 = 0;
    local_948 = 0;
    yynerrs = 0;
    yychar = 0xfffffffe;
    local_960 = 200;
    puVar10 = local_950;
    psVar17 = local_900;
    psVar18 = local_900;
    do {
        *psVar17 = (short)iVar14;
        __dest = psVar18;
        if (psVar18 + local_960 + 0x7fffffff <= psVar17) {
            iVar19 = (int)psVar17 - (int)psVar18 >> 1;
            iVar9 = iVar19 + 1;
            if (local_960 < 1000) {
                local_960 = (local_960 + 0x7fffffff) * 2 + 2;
                if (999 < local_960) {
                    local_960 = 1000;
                }
                __dest = (short *)FUN_00074b04(0, local_960 * 10 + 7, 0);
                if (__dest != (short *)0x0) {
                    memcpy(__dest, psVar18, iVar9 * 2);
                    puVar7 = (uint *)((int)__dest +
                                      (local_960 * 2 + 7 & 0xfffffff8));
                    memcpy(puVar7, local_950, iVar9 * 8);
                    if (psVar18 != local_900) {
                        free(psVar18);
                    }
                    psVar17 = __dest + iVar19;
                    puVar10 = puVar7 + iVar9 * 2 + -2;
                    local_950 = puVar7;
                    if (yydebug == 0) {
                        if (psVar17 < __dest + (local_960 - 1))
                            goto LAB_00029b84;
                    } else {
                        __fprintf_chk(stderr, 1,
                                      "Stack size increased to %lu\n",
                                      local_960);
                        if (psVar17 < __dest + (local_960 - 1))
                            goto LAB_0002a280;
                    }
                    uVar11 = 1;
                    goto LAB_0002a3f0;
                }
            }
        LAB_0002a76c:
            __dest = psVar18;
            uVar11 = 2;
            FUN_000298ac("memory exhausted");
        LAB_0002a3f0:
            if (yychar == 0xfffffffe)
                goto LAB_0002a41c;
            uVar15 = yychar;
            if (yychar < 0x1ca)
                goto LAB_0002a4c0;
            uVar5 = 2;
            goto LAB_0002a410;
        }
    LAB_0002a280:
        if (yydebug != 0) {
            __fprintf_chk(stderr, 1, "Entering state %d\n", iVar14);
        }
    LAB_00029b84:
        if (iVar14 == 0xd8) {
            uVar11 = 0;
            goto LAB_0002a3f0;
        }
        iVar19 = iVar14 * 2;
        sVar6 = (&DAT_0009f658)[iVar14];
        psVar18 = __dest;
        if (sVar6 == -0xd7) {
        LAB_00029c18:
            uVar15 = (uint)(ushort)(&DAT_000a05ec)[iVar14];
            if (uVar15 == 0) {
                if (yychar == 0xfffffffe) {
                    uVar15 = 0xfffffffe;
                } else if (yychar < 0x1ca) {
                    uVar15 = (uint)(byte)(&DAT_0009fef0)[yychar];
                } else {
                    uVar15 = 2;
                }
                if (local_948 == 0) {
                    yynerrs = yynerrs + 1;
                    iVar14 =
                        FUN_000295d8(&local_904, &local_908, psVar17, uVar15);
                    if (iVar14 == 0) {
                        FUN_000298ac(local_908);
                    } else {
                        if (iVar14 == 1) {
                            if (local_908 != acStack_12c) {
                                free(local_908);
                            }
                            local_908 = (char *)FUN_00074b04(0, local_904, 0);
                            if (local_908 == (char *)0x0) {
                                local_904 = 0x80;
                                local_908 = acStack_12c;
                                FUN_000298ac("syntax error");
                                goto LAB_0002a76c;
                            }
                            iVar14 = FUN_000295d8(&local_904, &local_908,
                                                  psVar17, uVar15);
                            pcVar4 = local_908;
                        } else {
                            pcVar4 = "syntax error";
                        }
                        FUN_000298ac(pcVar4);
                        if (iVar14 == 2)
                            goto LAB_0002a76c;
                    }
                } else if (local_948 == 3) {
                    if ((int)yychar < 1) {
                        if (yychar == 0) {
                            uVar11 = 1;
                            uVar15 = 0;
                        LAB_0002a4c0:
                            uVar5 = (&DAT_0009fef0)[uVar15];
                        LAB_0002a410:
                            FUN_00029418("Cleanup: discarding lookahead",
                                         uVar5);
                        LAB_0002a41c:
                            if (yydebug != 0) {
                                FUN_000292c0(__dest, psVar17);
                            }
                            for (; __dest != psVar17; psVar17 = psVar17 + -1) {
                                FUN_00029418("Cleanup: popping",
                                             *(undefined2 *)(&DAT_000a0d28 +
                                                             *psVar17 * 2));
                            }
                            if (__dest != local_900) {
                                free(__dest);
                            }
                            if (local_908 != acStack_12c) {
                                free(local_908);
                            }
                            if (local_2c == __stack_chk_guard) {
                                return;
                            }
                            /* WARNING: Subroutine does not return */
                            __stack_chk_fail(uVar11);
                        }
                    } else {
                        FUN_00029418("Error: discarding", uVar15);
                        yychar = 0xfffffffe;
                    }
                }
                while ((((sVar6 == -0xd7 ||
                          (uVar15 = (int)sVar6 + 1, 0x296 < uVar15)) ||
                         (iVar14 = uVar15 * 2,
                          *(short *)(&DAT_0009f9c0 + iVar14) != 1)) ||
                        (iVar14 = (int)*(short *)(&DAT_000a00bc + iVar14),
                         iVar14 < 1))) {
                    if (psVar17 == __dest) {
                        uVar11 = 1;
                        goto LAB_0002a3f0;
                    }
                    puVar10 = puVar10 + -2;
                    FUN_00029418("Error: popping",
                                 *(undefined2 *)(&DAT_000a0d28 + iVar19));
                    psVar17 = psVar17 + -1;
                    sVar6 = *psVar17;
                    if (yydebug != 0) {
                        FUN_000292c0(__dest, psVar17);
                    }
                    iVar19 = sVar6 * 2;
                    sVar6 = (&DAT_0009f658)[sVar6];
                }
                puVar7 = puVar10 + 2;
                puVar10[2] = (uint)yylval;
                puVar10[3] = yylval._4_4_;
                if (yydebug != 0) {
                    __fprintf_chk(stderr, 1, &DAT_000a14fc, "Shifting");
                    FUN_00029370(stderr,
                                 *(undefined2 *)(&DAT_000a0d28 + iVar14 * 2));
                    fputc(10, stderr);
                }
                local_948 = 3;
            } else {
            LAB_00029c34:
                bVar1 = (&DAT_000a0954)[uVar15];
                uVar13 = (uint)bVar1;
                iVar14 = 1 - uVar13;
                local_954 = puVar10[iVar14 * 2];
                uStack_93c = puVar10[iVar14 * 2 + 1];
                if (yydebug == 0) {
                    local_934 = uVar15 << 1;
                } else {
                    local_934 = uVar15 * 2;
                    uVar20 = (uint) * (ushort *)(&DAT_000a0a9c + local_934);
                    __fprintf_chk(stderr, 1,
                                  "Reducing stack by rule %d (line %lu):\n",
                                  uVar15 - 1, uVar20);
                    if (uVar13 != 0) {
                        uVar12 = 0;
                        psVar16 = psVar17 + iVar14;
                        do {
                            uVar12 = uVar12 + 1;
                            __fprintf_chk(stderr, 1, "   $%d = ", uVar12,
                                          uVar20);
                            FUN_00029370(stderr, *(undefined2 *)(&DAT_000a0d28 +
                                                                 *psVar16 * 2));
                            fputc(10, stderr);
                            psVar16 = psVar16 + 1;
                        } while (uVar13 != uVar12);
                    }
                }
                switch (uVar15) {
                case 5:
                    iVar14 = FUN_0002c704();
                    FUN_00075d40(3, "syntax error in %s line %d, column %d",
                                 iVar14 + 0x30, *(undefined4 *)(iVar14 + 0x28),
                                 *(undefined4 *)(iVar14 + 0x2c));
                    break;
                case 6:
                    break;
                case 7:
                    break;
                case 8:
                    break;
                case 9:
                    break;
                case 10:
                    break;
                case 0xb:
                    break;
                case 0xc:
                    break;
                case 0xd:
                    break;
                case 0xe:
                    break;
                case 0xf:
                    break;
                case 0x10:
                    break;
                case 0x11:
                    break;
                case 0x12:
                    break;
                case 0x13:
                    break;
                case 0x14:
                    uVar11 = FUN_0001f5fc(puVar10[-4], puVar10[-2], *puVar10);
                    cfgt._36_4_ = FUN_0001eef0(cfgt._36_4_, uVar11);
                    break;
                case 0x15:
                    break;
                case 0x16:
                    break;
                case 0x17:
                    break;
                case 0x18:
                    break;
                case 0x19:
                    break;
                case 0x1a:
                    break;
                case 0x1b:
                    local_954 = FUN_0001f490(*puVar10, puVar10[-2]);
                    break;
                case 0x1c:
                    local_954 = FUN_0001f490(*puVar10, 0);
                    break;
                case 0x1d:
                    local_954 = 2;
                    break;
                case 0x1e:
                    local_954 = 10;
                    break;
                case 0x1f:
                    local_954 = 0;
                    break;
                case 0x20:
                    local_954 = FUN_0001eef0(puVar10[-2], *puVar10);
                    break;
                case 0x21:
                    break;
                case 0x22:
                    break;
                case 0x23:
                    break;
                case 0x24:
                    local_954 = FUN_0001f1e0(0x1be, *puVar10);
                    break;
                case 0x25:
                    break;
                case 0x26:
                    break;
                case 0x27:
                    break;
                case 0x28:
                    break;
                case 0x29:
                    break;
                case 0x2a:
                    break;
                case 0x2b:
                    break;
                case 0x2c:
                    break;
                case 0x2d:
                    local_954 = FUN_0001f1e0(puVar10[-2], *puVar10);
                    break;
                case 0x2e:
                    local_954 = FUN_0001f250(puVar10[-2], *puVar10);
                    break;
                case 0x2f:
                    break;
                case 0x30:
                    break;
                case 0x31:
                    break;
                case 0x32:
                    break;
                case 0x33:
                    break;
                case 0x34:
                    break;
                case 0x35:
                    local_954 = FUN_0001f338(puVar10[-2], *puVar10);
                    break;
                case 0x36:
                    break;
                case 0x37:
                    iVar14 = FUN_0001f91c(*puVar10);
                    if (iVar14 != 0) {
                        cfgt._40_4_ = FUN_0001eef0(cfgt._40_4_);
                    }
                    break;
                case 0x38:
                    break;
                case 0x39:
                    break;
                case 0x3a:
                    cfgt._44_4_ = 1;
                    break;
                case 0x3b:
                    cfgt._48_4_ = FUN_0001ef88(cfgt._48_4_, *puVar10);
                    break;
                case 0x3c:
                    cfgt._52_4_ = FUN_0001ef88(cfgt._52_4_, *puVar10);
                    break;
                case 0x3d:
                    cfgt._176_4_ = *puVar10;
                    break;
                case 0x3e:
                    uVar11 = FUN_0001f1e0(puVar10[-2], *puVar10);
                    cfgt._160_4_ = FUN_0001eef0(cfgt._160_4_, uVar11);
                    break;
                case 0x3f:
                    cfgt._104_4_ = *puVar10;
                    break;
                case 0x40:
                    cfgt._108_4_ = cfgt._108_4_ + 1;
                    cfgt._112_4_ = FUN_0001ef88(cfgt._112_4_, *puVar10);
                    break;
                case 0x41:
                    cfgt._116_4_ = *puVar10;
                    break;
                case 0x42:
                    cfgt._120_4_ = *puVar10;
                    break;
                case 0x43:
                    cfgt._124_4_ = *puVar10;
                    break;
                case 0x44:
                    cfgt._128_4_ = *puVar10;
                    break;
                case 0x45:
                    cfgt._132_4_ = FUN_0001f038(cfgt._132_4_, destroy_attr_val);
                    cfgt._132_4_ = FUN_0001ef88(cfgt._132_4_, *puVar10);
                    break;
                case 0x46:
                    cfgt._136_4_ = *puVar10;
                    break;
                case 0x47:
                    local_954 = 0;
                    break;
                case 0x48:
                    local_954 = FUN_0001eef0(puVar10[-2], *puVar10);
                    break;
                case 0x49:
                    local_954 = FUN_0001f338(puVar10[-2], *puVar10);
                    break;
                case 0x4a:
                    local_954 = 0;
                    cfgt._128_4_ = *puVar10;
                    FUN_00075d40(4,
                                 "\'crypto revoke %d\' is deprecated, please "
                                 "use \'revoke %d\' instead.",
                                 cfgt._128_4_, cfgt._128_4_);
                    break;
                case 0x4b:
                    break;
                case 0x4c:
                    break;
                case 0x4d:
                    break;
                case 0x4e:
                    break;
                case 0x4f:
                    break;
                case 0x50:
                    cfgt._56_4_ = FUN_0001ef88(cfgt._56_4_, *puVar10);
                    break;
                case 0x51:
                    local_954 = FUN_0001eef0(puVar10[-2], *puVar10);
                    break;
                case 0x52:
                    local_954 = FUN_0001eef0(0, *puVar10);
                    break;
                case 0x53:
                    local_954 = FUN_0001f168(
                        SUB84((double)(longlong)(int)*puVar10, 0), puVar10[-2]);
                    break;
                case 0x54:
                    local_954 =
                        FUN_0001f168((int)*(undefined8 *)puVar10, puVar10[-2]);
                    break;
                case 0x55:
                    local_954 = FUN_0001f168(
                        SUB84((double)(longlong)(int)*puVar10, 0), puVar10[-2]);
                    break;
                case 0x56:
                    local_954 = FUN_0001f1e0(0x10b, *puVar10);
                    break;
                case 0x57:
                    break;
                case 0x58:
                    break;
                case 0x59:
                    break;
                case 0x5a:
                    break;
                case 0x5b:
                    break;
                case 0x5c:
                    break;
                case 0x5d:
                    break;
                case 0x5e:
                    break;
                case 0x5f:
                    break;
                case 0x60:
                    break;
                case 0x61:
                    break;
                case 0x62:
                    cfgt._60_4_ = FUN_0001ef88(cfgt._60_4_, *puVar10);
                    break;
                case 99:
                    iVar14 = FUN_0002c69c();
                    if (iVar14 == 0) {
                        free((void *)*puVar10);
                        FUN_000298ac("statsdir remote configuration ignored");
                    } else {
                        cfgt._64_4_ = *puVar10;
                    }
                    break;
                case 100:
                    uVar11 = FUN_0001fa00(puVar10[-2], *puVar10);
                    cfgt._68_4_ = FUN_0001eef0(cfgt._68_4_, uVar11);
                    break;
                case 0x65:
                    uVar15 = puVar10[-2];
                    uVar11 = FUN_0001f3d0(*puVar10);
                    local_954 = FUN_0001eef0(uVar15, uVar11);
                    break;
                case 0x66:
                    uVar11 = FUN_0001f3d0(*puVar10);
                    local_954 = FUN_0001eef0(0, uVar11);
                    break;
                case 0x67:
                    break;
                case 0x68:
                    break;
                case 0x69:
                    break;
                case 0x6a:
                    break;
                case 0x6b:
                    break;
                case 0x6c:
                    break;
                case 0x6d:
                    break;
                case 0x6e:
                    break;
                case 0x6f:
                    local_954 = 0;
                    break;
                case 0x70:
                    local_954 = FUN_0001eef0(puVar10[-2], *puVar10);
                    break;
                case 0x71:
                    iVar14 = FUN_0002c69c();
                    if (iVar14 == 0) {
                        free((void *)*puVar10);
                        FUN_000298ac("filegen file remote config ignored");
                        local_954 = 0;
                    } else {
                        local_954 = FUN_0001f338(puVar10[-2], *puVar10);
                    }
                    break;
                case 0x72:
                    iVar14 = FUN_0002c69c();
                    if (iVar14 == 0) {
                        FUN_000298ac("filegen type remote config ignored");
                        local_954 = 0;
                    } else {
                        local_954 = FUN_0001f1e0(puVar10[-2], *puVar10);
                    }
                    break;
                case 0x73:
                    iVar14 = FUN_0002c69c();
                    if (iVar14 == 0) {
                        if (*puVar10 == 0x151) {
                            pcVar4 = "filegen link remote config ignored";
                        } else {
                            pcVar4 = "filegen nolink remote config ignored";
                        }
                        FUN_000298ac(pcVar4);
                        local_954 = 0;
                    } else {
                        local_954 = FUN_0001f1e0(0x1be, *puVar10);
                    }
                    break;
                case 0x74:
                    local_954 = FUN_0001f1e0(0x1be, *puVar10);
                    break;
                case 0x75:
                    break;
                case 0x76:
                    break;
                case 0x77:
                    break;
                case 0x78:
                    break;
                case 0x79:
                    break;
                case 0x7a:
                    break;
                case 0x7b:
                    break;
                case 0x7c:
                    break;
                case 0x7d:
                    break;
                case 0x7e:
                    break;
                case 0x7f:
                    break;
                case 0x80:
                    cfgt._72_4_ = FUN_0001ef88(cfgt._72_4_, *puVar10);
                    break;
                case 0x81:
                    cfgt._76_4_ = FUN_0001ef88(cfgt._76_4_, *puVar10);
                    break;
                case 0x82:
                    uVar13 = puVar10[-4];
                    uVar15 = puVar10[-2];
                    uVar20 = *puVar10;
                    iVar14 = FUN_0002c704();
                    uVar11 = FUN_0001fa68(uVar13, 0, (int)(short)uVar15, uVar20,
                                          *(undefined4 *)(iVar14 + 0x10));
                    cfgt._80_4_ = FUN_0001eef0(cfgt._80_4_, uVar11);
                    break;
                case 0x83:
                    uVar13 = puVar10[-8];
                    uVar12 = puVar10[-4];
                    uVar15 = puVar10[-2];
                    uVar20 = *puVar10;
                    iVar14 = FUN_0002c704();
                    uVar11 =
                        FUN_0001fa68(uVar13, uVar12, (int)(short)uVar15, uVar20,
                                     *(undefined4 *)(iVar14 + 0x10));
                    cfgt._80_4_ = FUN_0001eef0(cfgt._80_4_, uVar11);
                    break;
                case 0x84:
                    uVar13 = *puVar10;
                    uVar15 = puVar10[-2];
                    iVar14 = FUN_0002c704();
                    uVar11 = FUN_0001fa68(0, 0, (int)(short)uVar15, uVar13,
                                          *(undefined4 *)(iVar14 + 0x10));
                    cfgt._80_4_ = FUN_0001eef0(cfgt._80_4_, uVar11);
                    break;
                case 0x85:
                    uVar11 = FUN_00074c8c("0.0.0.0");
                    uVar11 = FUN_0001f490(uVar11, 2);
                    uVar3 = FUN_00074c8c("0.0.0.0");
                    uVar3 = FUN_0001f490(uVar3, 2);
                    uVar15 = puVar10[-2];
                    uVar13 = *puVar10;
                    iVar14 = FUN_0002c704();
                    uVar11 =
                        FUN_0001fa68(uVar11, uVar3, (int)(short)uVar15, uVar13,
                                     *(undefined4 *)(iVar14 + 0x10));
                    cfgt._80_4_ = FUN_0001eef0(cfgt._80_4_, uVar11);
                    break;
                case 0x86:
                    uVar11 = FUN_00074c8c(&DAT_000a17fc);
                    uVar11 = FUN_0001f490(uVar11, 10);
                    uVar3 = FUN_00074c8c(&DAT_000a17fc);
                    uVar3 = FUN_0001f490(uVar3, 10);
                    uVar15 = puVar10[-2];
                    uVar13 = *puVar10;
                    iVar14 = FUN_0002c704();
                    uVar11 =
                        FUN_0001fa68(uVar11, uVar3, (int)(short)uVar15, uVar13,
                                     *(undefined4 *)(iVar14 + 0x10));
                    cfgt._80_4_ = FUN_0001eef0(cfgt._80_4_, uVar11);
                    break;
                case 0x87:
                    uVar15 = *puVar10;
                    uVar11 = FUN_0001f3d0(puVar10[-4]);
                    uVar13 = FUN_0001eef0(uVar15, uVar11);
                    uVar15 = puVar10[-2];
                    *puVar10 = uVar13;
                    iVar14 = FUN_0002c704();
                    uVar11 = FUN_0001fa68(0, 0, (int)(short)uVar15, uVar13,
                                          *(undefined4 *)(iVar14 + 0x10));
                    cfgt._80_4_ = FUN_0001eef0(cfgt._80_4_, uVar11);
                    break;
                case 0x88:
                    local_954 = 0xffffffff;
                    break;
                case 0x89:
                    local_954 = *puVar10;
                    if (0x65 < local_954 + 1) {
                        iVar14 = FUN_0002c704();
                        FUN_00075d40(3,
                                     "Unreasonable ippeerlimit value (%d) in "
                                     "%s line %d, column %d.  Using 0.",
                                     *puVar10, iVar14 + 0x30,
                                     *(undefined4 *)(iVar14 + 0x28),
                                     *(undefined4 *)(iVar14 + 0x2c));
                        local_954 = 0;
                        *puVar10 = 0;
                    }
                    break;
                case 0x8a:
                    local_954 = 0;
                    break;
                case 0x8b:
                    uVar15 = puVar10[-2];
                    uVar11 = FUN_0001f3d0(*puVar10);
                    local_954 = FUN_0001eef0(uVar15, uVar11);
                    break;
                case 0x8c:
                    break;
                case 0x8d:
                    break;
                case 0x8e:
                    break;
                case 0x8f:
                    break;
                case 0x90:
                    break;
                case 0x91:
                    break;
                case 0x92:
                    break;
                case 0x93:
                    break;
                case 0x94:
                    break;
                case 0x95:
                    break;
                case 0x96:
                    break;
                case 0x97:
                    break;
                case 0x98:
                    break;
                case 0x99:
                    break;
                case 0x9a:
                    break;
                case 0x9b:
                    break;
                case 0x9c:
                    break;
                case 0x9d:
                    local_954 = FUN_0001eef0(puVar10[-2], *puVar10);
                    break;
                case 0x9e:
                    local_954 = FUN_0001eef0(0, *puVar10);
                    break;
                case 0x9f:
                    local_954 = FUN_0001f1e0(puVar10[-2], *puVar10);
                    break;
                case 0xa0:
                    break;
                case 0xa1:
                    break;
                case 0xa2:
                    break;
                case 0xa3:
                    local_954 = FUN_0001eef0(puVar10[-2], *puVar10);
                    break;
                case 0xa4:
                    local_954 = FUN_0001eef0(0, *puVar10);
                    break;
                case 0xa5:
                    local_954 = FUN_0001f1e0(puVar10[-2], *puVar10);
                    break;
                case 0xa6:
                    break;
                case 0xa7:
                    break;
                case 0xa8:
                    break;
                case 0xa9:
                    break;
                case 0xaa:
                    break;
                case 0xab:
                    break;
                case 0xac:
                    break;
                case 0xad:
                    break;
                case 0xae:
                    uVar11 = FUN_0001fc14(puVar10[-2], *puVar10);
                    cfgt._84_4_ = FUN_0001eef0(cfgt._84_4_, uVar11);
                    break;
                case 0xaf:
                    local_954 = FUN_0001eef0(puVar10[-2], *puVar10);
                    break;
                case 0xb0:
                    local_954 = FUN_0001eef0(0, *puVar10);
                    break;
                case 0xb1:
                    local_954 =
                        FUN_0001f168((int)*(undefined8 *)puVar10, puVar10[-2]);
                    break;
                case 0xb2:
                    local_954 = FUN_0001f1e0(puVar10[-2], *puVar10);
                    break;
                case 0xb3:
                    if (*puVar10 < 0x11) {
                        local_954 = FUN_0001f1e0(puVar10[-2]);
                    } else {
                        local_954 = 0;
                        FUN_000298ac("fudge factor: stratum value not in "
                                     "[0..16], ignored");
                    }
                    break;
                case 0xb4:
                    local_954 = FUN_0001f338(puVar10[-2], *puVar10);
                    break;
                case 0xb5:
                    local_954 = FUN_0001f338(puVar10[-2], *puVar10);
                    break;
                case 0xb6:
                    break;
                case 0xb7:
                    break;
                case 0xb8:
                    break;
                case 0xb9:
                    break;
                case 0xba:
                    break;
                case 0xbb:
                    break;
                case 0xbc:
                    cfgt._88_4_ = FUN_0001ef88(cfgt._88_4_, *puVar10);
                    break;
                case 0xbd:
                    local_954 = FUN_0001eef0(puVar10[-2], *puVar10);
                    break;
                case 0xbe:
                    local_954 = FUN_0001eef0(0, *puVar10);
                    break;
                case 0xbf:
                    local_954 = FUN_0001f1e0(puVar10[-2], *puVar10);
                    break;
                case 0xc0:
                    break;
                case 0xc1:
                    break;
                case 0xc2:
                    break;
                case 0xc3:
                    cfgt._96_4_ = FUN_0001ef88(cfgt._96_4_, *puVar10);
                    break;
                case 0xc4:
                    cfgt._100_4_ = FUN_0001ef88(cfgt._100_4_, *puVar10);
                    break;
                case 0xc5:
                    local_954 = FUN_0001eef0(puVar10[-2], *puVar10);
                    break;
                case 0xc6:
                    local_954 = FUN_0001eef0(0, *puVar10);
                    break;
                case 199:
                    local_954 = FUN_0001f1e0(0x1be, *puVar10);
                    break;
                case 200:
                    iVar14 = FUN_0002c69c();
                    if (iVar14 == 0) {
                        uVar11 = FUN_0002c300(*puVar10);
                        FUN_0007d00c(
                            auStack_ac, 0x80,
                            "enable/disable %s remote configuration ignored",
                            uVar11);
                        FUN_000298ac(auStack_ac);
                        local_954 = 0;
                    } else {
                        local_954 = FUN_0001f1e0(0x1be, *puVar10);
                    }
                    break;
                case 0xc9:
                    break;
                case 0xca:
                    break;
                case 0xcb:
                    break;
                case 0xcc:
                    break;
                case 0xcd:
                    break;
                case 0xce:
                    break;
                case 0xcf:
                    break;
                case 0xd0:
                    break;
                case 0xd1:
                    break;
                case 0xd2:
                    break;
                case 0xd3:
                    break;
                case 0xd4:
                    break;
                case 0xd5:
                    cfgt._92_4_ = FUN_0001ef88(cfgt._92_4_, *puVar10);
                    break;
                case 0xd6:
                    local_954 = FUN_0001eef0(puVar10[-2], *puVar10);
                    break;
                case 0xd7:
                    local_954 = FUN_0001eef0(0, *puVar10);
                    break;
                case 0xd8:
                    local_954 =
                        FUN_0001f168((int)*(undefined8 *)puVar10, puVar10[-2]);
                    break;
                case 0xd9:
                    break;
                case 0xda:
                    break;
                case 0xdb:
                    break;
                case 0xdc:
                    break;
                case 0xdd:
                    break;
                case 0xde:
                    break;
                case 0xdf:
                    break;
                case 0xe0:
                    break;
                case 0xe1:
                    break;
                case 0xe2:
                    break;
                case 0xe3:
                    break;
                case 0xe4:
                    break;
                case 0xe5:
                    uVar11 =
                        FUN_0001f168((int)*(undefined8 *)puVar10, puVar10[-2]);
                    cfgt._160_4_ = FUN_0001eef0(cfgt._160_4_, uVar11);
                    break;
                case 0xe6:
                    uVar11 = FUN_0001f1e0(puVar10[-2], *puVar10);
                    cfgt._160_4_ = FUN_0001eef0(cfgt._160_4_, uVar11);
                    break;
                case 0xe7:
                    uVar11 = FUN_0001f338(puVar10[-2], *puVar10);
                    cfgt._160_4_ = FUN_0001eef0(cfgt._160_4_, uVar11);
                    break;
                case 0xe8:
                    iVar14 = FUN_0002c69c();
                    if (iVar14 == 0) {
                        free((void *)*puVar10);
                        uVar11 = FUN_0002c300(puVar10[-2]);
                        FUN_0007d00c(auStack_ac, 0x40,
                                     "%s remote config ignored", uVar11);
                        FUN_000298ac(auStack_ac);
                    } else {
                        uVar11 = FUN_0001f338(puVar10[-2], *puVar10);
                        cfgt._160_4_ = FUN_0001eef0(cfgt._160_4_, uVar11);
                    }
                    break;
                case 0xe9:
                    iVar14 = FUN_0002c69c();
                    if (iVar14 == 0) {
                        free((void *)puVar10[-2]);
                        FUN_000298ac("remote includefile ignored");
                    } else {
                        uVar15 = FUN_0002c624();
                        if (uVar15 < 6) {
                            uVar11 = FUN_00074cfc(puVar10[-2]);
                            iVar14 = FUN_0002c52c(uVar11, "r");
                            if (iVar14 == 0) {
                                __fprintf_chk(
                                    stderr, 1,
                                    "getconfig: Couldn\'t open <%s>\n", uVar11);
                                FUN_00075d40(3,
                                             "getconfig: Couldn\'t open <%s>",
                                             uVar11);
                            }
                        } else {
                            fwrite("getconfig: Maximum include file level "
                                   "exceeded.\n",
                                   1, 0x30, stderr);
                            FUN_00075d40(3, "getconfig: Maximum include file "
                                            "level exceeded.");
                        }
                        free((void *)puVar10[-2]);
                    }
                    break;
                case 0xea:
                    FUN_0002c48c();
                    break;
                case 0xeb:
                    break;
                case 0xec:
                    cfgt._140_4_ = FUN_0001ef88(cfgt._140_4_, *puVar10);
                    break;
                case 0xed:
                    cfgt._144_4_ = FUN_0001ef88(cfgt._144_4_, *puVar10);
                    break;
                case 0xee:
                    cfgt._148_4_ = FUN_0001eef0(cfgt._148_4_, *puVar10);
                    break;
                case 0xef:
                    uVar11 = FUN_0001fc14(puVar10[-2], *puVar10);
                    cfgt._156_4_ = FUN_0001eef0(cfgt._156_4_, uVar11);
                    break;
                case 0xf0:
                    cfgt._152_4_ = FUN_0001ef88(cfgt._152_4_, *puVar10);
                    break;
                case 0xf1:
                    break;
                case 0xf2:
                    break;
                case 0xf3:
                    break;
                case 0xf4:
                    break;
                case 0xf5:
                    FUN_000298ac("Built without LEAP_SMEAR support.");
                    break;
                case 0xf6:
                    break;
                case 0xf7:
                    break;
                case 0xf8:
                    break;
                case 0xf9:
                    break;
                case 0xfa:
                    break;
                case 0xfb:
                    iVar14 = FUN_0002c69c();
                    if (iVar14 == 0) {
                        free((void *)*puVar10);
                        FUN_000298ac("driftfile remote configuration ignored");
                    } else {
                        uVar11 = FUN_0001f338(0x122, *puVar10);
                        cfgt._160_4_ = FUN_0001eef0(cfgt._160_4_, uVar11);
                    }
                    break;
                case 0xfc:
                    iVar14 = FUN_0002c69c();
                    if (iVar14 == 0) {
                        free((void *)puVar10[-2]);
                        FUN_000298ac("driftfile remote configuration ignored");
                    } else {
                        uVar11 = FUN_0001f338(0x122, puVar10[-2]);
                        cfgt._160_4_ = FUN_0001eef0(cfgt._160_4_, uVar11);
                        uVar11 =
                            FUN_0001f168((int)*(undefined8 *)puVar10, 0x1b9);
                        cfgt._160_4_ = FUN_0001eef0(cfgt._160_4_, uVar11);
                        FUN_00075d40(
                            4,
                            "\'driftfile FILENAME WanderValue\' is deprecated, "
                            "please use separate \'driftfile FILENAME\' and "
                            "\'nonvolatile WanderValue\' lines instead.");
                    }
                    break;
                case 0xfd:
                    iVar14 = FUN_0002c69c();
                    if (iVar14 == 0) {
                        FUN_000298ac("driftfile remote configuration ignored");
                    } else {
                        uVar11 = FUN_00074c8c(&DAT_000a9528);
                        uVar11 = FUN_0001f338(0x122, uVar11);
                        cfgt._160_4_ = FUN_0001eef0(cfgt._160_4_, uVar11);
                    }
                    break;
                case 0xfe:
                    local_954 =
                        FUN_0001fae8(puVar10[-6], puVar10[-2], *puVar10);
                    break;
                case 0xff:
                    break;
                case 0x100:
                    local_954 = 0;
                    break;
                case 0x101:
                    local_954 = 0;
                    break;
                case 0x102:
                    local_954 = FUN_0001eef0(puVar10[-2], *puVar10);
                    break;
                case 0x103:
                    local_954 = FUN_0001f1e0(puVar10[-2], *puVar10);
                    break;
                case 0x104:
                    uVar15 = puVar10[-2];
                    uVar11 = FUN_00074c8c(*(undefined4 *)(*puVar10 + 4));
                    local_954 = FUN_0001f338(uVar15, uVar11);
                    FUN_0001f55c(*puVar10);
                    break;
                case 0x105:
                    local_954 = FUN_0001eef0(puVar10[-2], *puVar10);
                    break;
                case 0x106:
                    local_954 = FUN_0001eef0(0, *puVar10);
                    break;
                case 0x107:
                    pcVar4 = (char *)*puVar10;
                    cVar8 = *pcVar4;
                    if (((byte)(cVar8 - 0x2b) < 0x13) &&
                        ((1 << (uint)(byte)(cVar8 - 0x2b) & 0x40005U) != 0)) {
                        pcVar4 = pcVar4 + 1;
                    } else {
                        cVar8 = '=';
                    }
                    uVar11 = FUN_00074c8c(pcVar4);
                    local_954 = FUN_0001f338(cVar8, uVar11);
                    free((void *)*puVar10);
                    break;
                case 0x108:
                    uVar11 = FUN_0001fb6c(*puVar10, 0, puVar10[-2]);
                    cfgt._164_4_ = FUN_0001eef0(cfgt._164_4_, uVar11);
                    break;
                case 0x109:
                    uVar11 = FUN_0001fb6c(0, *puVar10, puVar10[-2]);
                    cfgt._164_4_ = FUN_0001eef0(cfgt._164_4_, uVar11);
                    break;
                case 0x10a:
                    break;
                case 0x10b:
                    break;
                case 0x10c:
                    break;
                case 0x10d:
                    break;
                case 0x10e:
                    break;
                case 0x10f:
                    break;
                case 0x110:
                    break;
                case 0x111:
                    break;
                case 0x112:
                    break;
                case 0x113:
                    cfgt._168_4_ = FUN_0001ef88(cfgt._168_4_, *puVar10);
                    break;
                case 0x114:
                    uVar15 = puVar10[-2];
                    uVar11 = FUN_0001f3d0(*puVar10);
                    local_954 = FUN_0001eef0(uVar15, uVar11);
                    break;
                case 0x115:
                    uVar11 = FUN_0001f3d0(*puVar10);
                    local_954 = FUN_0001eef0(0, uVar11);
                    break;
                case 0x116:
                    break;
                case 0x117:
                    break;
                case 0x118:
                    break;
                case 0x119:
                    break;
                case 0x11a:
                    break;
                case 0x11b:
                    break;
                case 0x11c:
                    break;
                case 0x11d:
                    uVar15 = puVar10[-2];
                    uVar11 = FUN_0001f3d0(*puVar10);
                    local_954 = FUN_0001eef0(uVar15, uVar11);
                    break;
                case 0x11e:
                    uVar11 = FUN_0001f3d0(*puVar10);
                    local_954 = FUN_0001eef0(0, uVar11);
                    break;
                case 0x11f:
                    local_954 = FUN_0001eef0(puVar10[-2], *puVar10);
                    break;
                case 0x120:
                    local_954 = FUN_0001eef0(0, *puVar10);
                    break;
                case 0x121:
                    local_954 = FUN_0001f1e0(0x69, *puVar10);
                    break;
                case 0x122:
                    break;
                case 0x123:
                    local_954 = FUN_0001f2c0(0x2d, puVar10[-6], puVar10[-2]);
                    break;
                case 0x124:
                    uVar15 = puVar10[-2];
                    uVar11 = FUN_0001f430(*puVar10);
                    local_954 = FUN_0001eef0(uVar15, uVar11);
                    break;
                case 0x125:
                    uVar11 = FUN_0001f430(*puVar10);
                    local_954 = FUN_0001eef0(0, uVar11);
                    break;
                case 0x126:
                    local_954 = FUN_0001eef0(puVar10[-2], *puVar10);
                    break;
                case 0x127:
                    local_954 = FUN_0001eef0(0, *puVar10);
                    break;
                case 0x128:
                    local_954 = *puVar10;
                    if (1 < local_954) {
                        local_954 = 1;
                        FUN_000298ac("Integer value is not boolean (0 or 1). "
                                     "Assuming 1");
                    }
                    break;
                case 0x129:
                    local_954 = 1;
                    break;
                case 0x12a:
                    local_954 = 0;
                    break;
                case 299:
                    local_940 = SUB84((double)(longlong)(int)*puVar10, 0);
                    local_954 = local_940;
                    uStack_93c =
                        (uint)((ulonglong)(double)(longlong)(int)*puVar10 >>
                               0x20);
                    break;
                case 300:
                    break;
                case 0x12d:
                    local_954 = FUN_00077e5c(*puVar10);
                    free((void *)*puVar10);
                    break;
                case 0x12e:
                    uVar11 = FUN_0001fc7c(puVar10[-4], puVar10[-2]);
                    cfgt._172_4_ = FUN_0001eef0(cfgt._172_4_, uVar11);
                    old_config_style = 1;
                    break;
                case 0x12f:
                    old_config_style = 0;
                    break;
                case 0x130:
                    local_954 = FUN_0001eef0(puVar10[-4], puVar10[-2]);
                    break;
                case 0x131:
                    local_954 = FUN_0001eef0(0, puVar10[-2]);
                    break;
                case 0x132:
                    local_954 =
                        FUN_0001f168((int)*(undefined8 *)puVar10, puVar10[-4]);
                    break;
                case 0x133:
                    break;
                case 0x134:
                    break;
                case 0x135:
                    local_954 = FUN_0001eef0(puVar10[-2], *puVar10);
                    break;
                case 0x136:
                    local_954 = FUN_0001eef0(0, *puVar10);
                    break;
                case 0x137:
                    local_954 = 0;
                    break;
                case 0x138:
                    local_954 = puVar10[-2];
                    uStack_93c = puVar10[-1];
                    break;
                case 0x139:
                    local_954 = *puVar10;
                    break;
                case 0x13a:
                    local_954 = FUN_0001eef0(puVar10[-2], *puVar10);
                    break;
                case 0x13b:
                    local_954 = FUN_0001eef0(0, *puVar10);
                    break;
                case 0x13c:
                    local_954 = 0;
                    break;
                case 0x13d:
                    local_954 = FUN_0001eef0(puVar10[-4], puVar10[-2]);
                    break;
                case 0x13e:
                    local_954 = FUN_0001eef0(0, puVar10[-2]);
                    break;
                case 0x13f:
                    local_954 =
                        FUN_0001f168((int)*(undefined8 *)puVar10, puVar10[-4]);
                }
                local_938 = (ushort)bVar1;
                if (yydebug == 0) {
                    puVar10 = puVar10 + (short)local_938 * -2;
                    psVar17 = psVar17 + -(int)(short)local_938;
                    uVar15 = (uint) * (ushort *)(&DAT_000a1090 + local_934);
                } else {
                    __fprintf_chk(stderr, 1, &DAT_000a14fc, "-> $$ =");
                    uVar15 = (uint) * (ushort *)(&DAT_000a1090 + local_934);
                    FUN_00029370(stderr, uVar15);
                    fputc(10, stderr);
                    puVar10 = puVar10 + (short)local_938 * -2;
                    psVar17 = psVar17 + -(int)(short)local_938;
                    if (yydebug != 0) {
                        FUN_000292c0(__dest, psVar17);
                    }
                }
                puVar7 = puVar10 + 2;
                iVar14 = (uVar15 - 0xd0) * 2;
                sVar6 = *psVar17;
                sVar2 = *(short *)(&DAT_000a131c + iVar14);
                puVar10[2] = local_954;
                uVar15 = (int)sVar2 + (int)sVar6;
                puVar10[3] = uStack_93c;
                if ((uVar15 < 0x297) &&
                    (iVar19 = uVar15 * 2,
                     (int)*(short *)(&DAT_0009f9c0 + iVar19) == (int)sVar6)) {
                    iVar14 = (int)*(short *)(&DAT_000a00bc + iVar19);
                } else {
                    iVar14 = (int)*(short *)(&DAT_000a13f4 + iVar14);
                }
            }
        } else {
            if (yychar == 0xfffffffe) {
                if (yydebug != 0) {
                    fwrite("Reading a token: ", 1, 0x11, stderr);
                }
                yychar = FUN_0002c834();
                if ((int)yychar < 1)
                    goto LAB_0002a4f4;
            LAB_00029bc0:
                if ((int)yychar < 0x1ca) {
                    uVar15 = (uint)(byte)(&DAT_0009fef0)[yychar];
                } else {
                    uVar15 = 2;
                }
                if (yydebug != 0) {
                    __fprintf_chk(stderr, 1, &DAT_000a14fc, "Next token is");
                    FUN_00029370(stderr, uVar15);
                    fputc(10, stderr);
                }
            } else {
                if (0 < (int)yychar)
                    goto LAB_00029bc0;
            LAB_0002a4f4:
                yychar = 0;
                uVar15 = yydebug;
                if (yydebug != 0) {
                    fwrite("Now at end of input.\n", 1, 0x15, stderr);
                    uVar15 = 0;
                }
            }
            uVar13 = (int)sVar6 + uVar15;
            if (0x296 < uVar13)
                goto LAB_00029c18;
            iVar9 = uVar13 * 2;
            sVar2 = *(short *)(&DAT_0009f9c0 + iVar9);
            if ((int)sVar2 != uVar15)
                goto LAB_00029c18;
            iVar14 = (int)*(short *)(&DAT_000a00bc + iVar9);
            if (iVar14 < 1) {
                uVar15 = -iVar14;
                goto LAB_00029c34;
            }
            if (local_948 != 0) {
                local_948 = local_948 + -1;
            }
            if (yydebug != 0) {
                __fprintf_chk(stderr, 1, &DAT_000a14fc, "Shifting");
                FUN_00029370(stderr, (int)sVar2);
                fputc(10, stderr);
            }
            puVar7 = puVar10 + 2;
            yychar = 0xfffffffe;
            *puVar7 = (uint)yylval;
            puVar10[3] = yylval._4_4_;
        }
        psVar17 = psVar17 + 1;
        puVar10 = puVar7;
    } while (true);
}

/* WARNING: Removing unreachable block (ram,0x0002be50) */

void FUN_0002bdf0(void)

{
    return;
}

void FUN_0002be64(uint param_1, int param_2)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if ((param_2 != 0) && (*(int *)(param_2 + 8) == 0)) {
        iVar2 = *(int *)(param_2 + 0xc) + 1;
        if (iVar2 != 0) {
            iVar2 = 1;
        }
        if (param_1 != 0xffffffff && iVar2 == 0) {
            param_1 = param_1 & 0xff;
            *(uint *)(param_2 + 0xc) = param_1;
            if (*(int *)(param_2 + 4) != 0) {
                conf_file_sum = conf_file_sum - param_1;
            }
            if (param_1 == 10) {
                *(undefined4 *)(param_2 + 0x10) =
                    *(undefined4 *)(param_2 + 0x18);
                *(undefined4 *)(param_2 + 0x14) =
                    *(undefined4 *)(param_2 + 0x1c);
                *(undefined4 *)(param_2 + 0x1c) = 0xffffffff;
            }
            *(int *)(param_2 + 0x14) = *(int *)(param_2 + 0x14) + -1;
            goto LAB_0002bef4;
        }
    }
    param_1 = 0xffffffff;
LAB_0002bef4:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(param_1);
    }
    return;
}

void FUN_0002bf44(char *param_1, char *param_2)

{
    int iVar1;
    size_t __n;
    void *__ptr;
    FILE *pFVar2;

    iVar1 = __stack_chk_guard;
    __n = strlen(param_1);
    __ptr = (void *)FUN_00074b04(0, __n + 0x34, 0, 1);
    *(undefined4 *)((int)__ptr + 0x10) = 1;
    *(undefined4 *)((int)__ptr + 0xc) = 0xffffffff;
    memcpy((void *)((int)__ptr + 0x30), param_1, __n);
    if (param_2 != (char *)0x0) {
        pFVar2 = fopen64(param_1, param_2);
        *(FILE **)((int)__ptr + 4) = pFVar2;
        if (pFVar2 == (FILE *)0x0) {
            free(__ptr);
            __ptr = (void *)0x0;
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__ptr);
}

void FUN_0002c008(void *param_1)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if (param_1 == (void *)0x0) {
        return;
    }
    if (*(FILE **)((int)param_1 + 4) != (FILE *)0x0) {
        fclose(*(FILE **)((int)param_1 + 4));
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    free(param_1);
    return;
}

void FUN_0002c084(int param_1)

{
    int iVar1;
    uint uVar2;
    FILE *__stream;
    byte *pbVar3;
    int iVar4;

    iVar1 = __stack_chk_guard;
    if ((param_1 == 0) || (*(int *)(param_1 + 8) != 0)) {
    LAB_0002c160:
        uVar2 = 0xffffffff;
    } else {
        uVar2 = *(uint *)(param_1 + 0xc);
        if (uVar2 == 0xffffffff) {
            __stream = *(FILE **)(param_1 + 4);
            if (__stream == (FILE *)0x0) {
                pbVar3 = remote_config + remote_config._2048_4_;
                uVar2 = (uint)(byte)remote_config[remote_config._2048_4_];
                if (0x7f < uVar2) {
                    iVar4 = *(int *)(param_1 + 0x14) - (int)pbVar3;
                    do {
                        pbVar3 = pbVar3 + 1;
                        *(byte **)(param_1 + 0x14) = pbVar3 + iVar4;
                        uVar2 = (uint)*pbVar3;
                    } while (0x7f < uVar2);
                }
                if (uVar2 != 0) {
                    remote_config._2048_4_ = pbVar3 + -0x11850f;
                    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
                    goto LAB_0002c0f8;
                }
                remote_config._2048_4_ = pbVar3 + -0x118510;
            } else {
                while (uVar2 = fgetc(__stream), uVar2 != 0xffffffff) {
                    if ((int)uVar2 < 0x80) {
                        *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
                        conf_file_sum = uVar2 + conf_file_sum;
                        goto LAB_0002c0f8;
                    }
                    __stream = *(FILE **)(param_1 + 4);
                    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
                }
            }
            if (*(int *)(param_1 + 0x14) == 0)
                goto LAB_0002c160;
        } else {
            *(undefined4 *)(param_1 + 0xc) = 0xffffffff;
            if (*(int *)(param_1 + 4) != 0) {
                conf_file_sum = uVar2 + conf_file_sum;
            }
            *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
        LAB_0002c0f8:
            if (uVar2 != 10)
                goto LAB_0002c104;
        }
        uVar2 = 10;
        *(undefined4 *)(param_1 + 0x18) = *(undefined4 *)(param_1 + 0x10);
        *(undefined4 *)(param_1 + 0x1c) = *(undefined4 *)(param_1 + 0x14);
        *(int *)(param_1 + 0x10) = *(int *)(param_1 + 0x10) + 1;
        *(undefined4 *)(param_1 + 0x14) = 0;
    }
LAB_0002c104:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2);
    }
    return;
}

void FUN_0002c240(void)

{
    int iVar1;
    ushort **ppuVar2;
    undefined4 uVar3;
    uint uVar4;
    undefined1 *puVar5;

    iVar1 = __stack_chk_guard;
    puVar5 = yytext;
    uVar4 = (uint)yytext[0];
    if (uVar4 != 0) {
        ppuVar2 = __ctype_b_loc();
        do {
            if (((*ppuVar2)[uVar4] & 0x2000) == 0) {
                yylval._0_4_ = FUN_00074c8c(yytext);
                uVar3 = 0x1a3;
                goto LAB_0002c2d0;
            }
            puVar5 = puVar5 + 1;
            uVar4 = (uint)(byte)*puVar5;
        } while (uVar4 != 0);
    }
    uVar3 = 0x1bf;
    yylval._0_4_ = 0x1bf;
LAB_0002c2d0:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

/* WARNING: Removing unreachable block (ram,0x0002c368) */

void FUN_0002c300(void)

{
    return;
}

void FUN_0002c38c(int param_1)

{
    int iVar1;
    uint uVar2;

    iVar1 = __stack_chk_guard;
    uVar2 = DAT_000ca3d8;
    if (DAT_000ca3d8 != 0) {
        uVar2 = 1;
    }
    if (param_1 == 0) {
        uVar2 = uVar2 | 1;
    }
    if (uVar2 == 0) {
        DAT_000ca3d8 = FUN_0002bf44(param_1);
        uVar2 = DAT_000ca3d8;
        if (DAT_000ca3d8 != 0) {
            uVar2 = 1;
        }
    } else {
        uVar2 = 0;
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2);
    }
    return;
}

void FUN_0002c40c(void)

{
    int iVar1;
    int *piVar2;
    bool bVar3;

    iVar1 = __stack_chk_guard;
    bVar3 = DAT_000ca3d8 != (int *)0x0;
    piVar2 = DAT_000ca3d8;
    while (bVar3) {
        piVar2 = (int *)*piVar2;
        FUN_0002c008();
        bVar3 = piVar2 != (int *)0x0;
    }
    DAT_000ca3d8 = (int *)0x0;
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0002c48c(void)

{
    int *piVar1;
    int iVar2;
    int *piVar3;
    bool bVar4;
    int iVar5;

    iVar2 = __stack_chk_guard;
    piVar1 = DAT_000ca3d8;
    if (DAT_000ca3d8 == (int *)0x0) {
        bVar4 = false;
    } else {
        iVar5 = DAT_000ca3d8[2];
        piVar3 = (int *)*DAT_000ca3d8;
        DAT_000ca3d8[2] = 1;
        bVar4 = iVar5 == 0;
        while (piVar3 != (int *)0x0) {
            piVar3 = (int *)*piVar3;
            FUN_0002c008();
        }
        *piVar1 = 0;
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(bVar4);
    }
    return;
}

void FUN_0002c52c(int param_1)

{
    int iVar1;
    undefined4 *puVar2;
    undefined4 uVar3;

    iVar1 = __stack_chk_guard;
    if (param_1 == 0) {
        uVar3 = 0;
    } else {
        puVar2 = (undefined4 *)FUN_0002bf44(param_1);
        if (puVar2 == (undefined4 *)0x0) {
            uVar3 = 0;
        } else {
            uVar3 = 1;
            *puVar2 = DAT_000ca3d8;
            DAT_000ca3d8 = puVar2;
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar3);
    }
    return;
}

void FUN_0002c5ac(void)

{
    int iVar1;
    int *piVar2;

    iVar1 = __stack_chk_guard;
    piVar2 = DAT_000ca3d8;
    if (DAT_000ca3d8 != (int *)0x0) {
        if ((int *)*DAT_000ca3d8 == (int *)0x0) {
            piVar2 = (int *)0x0;
        } else {
            DAT_000ca3d8 = (int *)*DAT_000ca3d8;
            FUN_0002c008(piVar2);
            piVar2 = (int *)0x1;
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(piVar2);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0002c68c) */

void FUN_0002c624(void)

{
    int *piVar1;

    piVar1 = DAT_000ca3d8;
    if (DAT_000ca3d8 != (int *)0x0) {
        do {
            piVar1 = (int *)*piVar1;
        } while (piVar1 != (int *)0x0);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0002c6f4) */

void FUN_0002c69c(void)

{
    return;
}

/* WARNING: Removing unreachable block (ram,0x0002c748) */

void FUN_0002c704(void)

{
    return;
}

void FUN_0002c758(char *param_1)

{
    int iVar1;
    size_t sVar2;
    undefined4 uVar3;
    size_t sVar4;
    char *pcVar5;
    int iVar6;

    iVar1 = __stack_chk_guard;
    sVar2 = strlen(param_1);
    iVar6 = sVar2 + 3;
    uVar3 = FUN_00074b04(0, iVar6, 0);
    if ((*param_1 == '\"') ||
        ((sVar4 = strcspn(param_1, special_chars),
          sVar2 <= sVar4 &&
              (pcVar5 = strchr(param_1, 0x20), pcVar5 == (char *)0x0)))) {
        FUN_0007e4b4(uVar3, param_1, iVar6);
    } else {
        FUN_0007d00c(uVar3, iVar6, "\"%s\"", param_1);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_0002c834(void)

{
    byte bVar1;
    ushort uVar2;
    uint uVar3;
    ushort **ppuVar4;
    char *pcVar5;
    int __c;
    uint uVar6;
    __int32_t **pp_Var7;
    int *piVar8;
    long lVar9;
    undefined1 *puVar10;
    byte *pbVar11;
    int iVar12;
    bool bVar13;
    uint uVar14;
    undefined1 *puVar15;
    uint uVar16;
    ushort *puVar17;
    int iVar18;
    int local_30;
    int local_2c;

    bVar1 = 0;
    local_2c = __stack_chk_guard;
    iVar12 = DAT_000ca3d8;
LAB_0002c894:
    uVar3 = FUN_0002c084(iVar12);
    if (uVar3 == 0xffffffff) {
        iVar12 = FUN_0002c5ac();
        if (iVar12 != 0) {
            uVar3 = 0x1bf;
            goto LAB_0002c8f4;
        }
        uVar3 = 0;
        goto LAB_0002cbe4;
    }
    ppuVar4 = __ctype_b_loc();
    if (((*ppuVar4)[uVar3] & 0x2000) == 0) {
        if (old_config_style != 0) {
            if (uVar3 != 10)
                goto LAB_0002c920;
            goto LAB_0002c8e0;
        }
        if (uVar3 == 0x3b)
            goto LAB_0002c8e0;
    LAB_0002c920:
        pcVar5 = strchr(special_chars, uVar3);
        iVar12 = DAT_000ca3d8;
        if ((pcVar5 == (char *)0x0) || (DAT_000ca3dc != 0)) {
            iVar18 = 0;
            FUN_0002be64(uVar3, DAT_000ca3d8);
            *(undefined4 *)(iVar12 + 0x20) = *(undefined4 *)(iVar12 + 0x10);
            *(undefined4 *)(iVar12 + 0x24) = *(undefined4 *)(iVar12 + 0x14);
            puVar10 = yytext;
            puVar15 = (undefined1 *)((int)&yynerrs + 3);
            __c = FUN_0002c084(iVar12);
            while (__c != -1) {
                puVar15 = puVar15 + 1;
                *puVar15 = (char)__c;
                if (((*ppuVar4)[__c] & 0x2000) != 0) {
                    if (__c != 0x22)
                        goto LAB_0002c9e4;
                LAB_0002cb0c:
                    puVar15 = (undefined1 *)((int)&yynerrs + iVar18 + 3);
                    goto LAB_0002cb58;
                }
                if (old_config_style == 0) {
                    if (__c == 0x3b)
                        goto LAB_0002c9e4;
                } else if (__c == 10)
                    goto LAB_0002c9e4;
                if (__c == 0x22)
                    goto LAB_0002cb0c;
                if ((DAT_000ca3dc == 0) && (pcVar5 = strchr(special_chars, __c),
                                            pcVar5 != (char *)0x0))
                    goto LAB_0002c9e4;
                if (__c == 0x23)
                    goto LAB_0002cac8;
                iVar18 = iVar18 + 1;
                if (iVar18 == 0x401)
                    goto LAB_0002cb94;
                __c = FUN_0002c084(DAT_000ca3d8);
            }
        LAB_0002ca98:
            __c = -1;
            goto LAB_0002c9e4;
        }
        if ((uVar3 == 0x3d) && (old_config_style != 0)) {
            DAT_000ca3dc = 1;
        }
        yytext[0] = (byte)uVar3;
        yytext[1] = 0;
        goto LAB_0002c8f4;
    }
    iVar12 = DAT_000ca3d8;
    if (old_config_style == 0) {
        if (uVar3 != 0x3b)
            goto LAB_0002c894;
    } else if (uVar3 != 10)
        goto LAB_0002c894;
LAB_0002c8e0:
    uVar3 = 0x1bf;
    DAT_000ca3dc = 0;
    goto LAB_0002c8f4;
LAB_0002cb58:
    __c = FUN_0002c084(DAT_000ca3d8);
    if (__c == -1)
        goto code_r0x0002cb68;
    if (__c == 10 || __c == 0x22) {
        if (__c == 0x22) {
            bVar1 = 1;
            __c = FUN_0002c084(DAT_000ca3d8);
        } else {
            bVar1 = 1;
        }
        goto LAB_0002c9e4;
    }
    iVar18 = iVar18 + 1;
    puVar15 = puVar15 + 1;
    *puVar15 = (char)__c;
    if (iVar18 == 0x401)
        goto LAB_0002cb94;
    goto LAB_0002cb58;
code_r0x0002cb68:
    bVar1 = 1;
    goto LAB_0002c9e4;
    while (iVar12 != 10) {
    LAB_0002cac8:
        iVar12 = FUN_0002c084(DAT_000ca3d8);
        if (iVar12 == -1)
            goto LAB_0002ca98;
    }
    __c = 10;
LAB_0002c9e4:
    iVar12 = DAT_000ca3d8;
    FUN_0002be64(__c, DAT_000ca3d8);
    yytext[iVar18] = 0;
    if (iVar18 != 0)
        goto code_r0x0002ca10;
    goto LAB_0002c894;
LAB_0002cb94:
    yytext[0x32] = 0;
    FUN_00075d40(3,
                 "configuration item on line %d longer than limit of %lu, "
                 "began with \'%s\'",
                 *(undefined4 *)(DAT_000ca3d8 + 0x10), 0x32, yytext);
    iVar12 = FUN_0002c69c();
    if (iVar12 != 0) {
        /* WARNING: Subroutine does not return */
        exit(0x400);
    }
    goto LAB_0002cbdc;
code_r0x0002ca10:
    bVar13 = (bool)(bVar1 ^ 1);
    if (DAT_000ca3dc != 0) {
        bVar13 = false;
    }
    if (bVar13) {
        uVar16 = (uint)yytext[0];
        if (uVar16 == 0) {
        LAB_0002cffc:
            iVar12 = sscanf(yytext, "%u", &local_30);
            if (iVar12 == 1) {
                if (-1 < local_30)
                    goto LAB_0002d050;
                uVar16 = (uint)yytext[0];
            } else {
                uVar16 = (uint)yytext[0];
            }
        LAB_0002cd20:
            if (uVar16 == 0x30) {
                pp_Var7 = __ctype_tolower_loc();
                if ((*pp_Var7)[yytext[1]] != 0x78)
                    goto LAB_0002cd30;
                uVar3 = (uint)yytext[2];
                if (uVar3 != 0) {
                    bVar13 = true;
                    iVar12 = 2;
                    goto LAB_0002cd3c;
                }
            LAB_0002cfb8:
                iVar12 = sscanf(yytext + 2, "%x", &yylval);
            } else {
                if (uVar16 != 0) {
                LAB_0002cd30:
                    bVar13 = false;
                    iVar12 = 0;
                    uVar3 = uVar16;
                LAB_0002cd3c:
                    puVar17 = *ppuVar4;
                    pbVar11 = yytext + iVar12;
                    do {
                        if (bVar13) {
                            uVar2 = puVar17[(short)uVar3] & 0x1000;
                        } else {
                            uVar2 = puVar17[(short)uVar3] & 0x800;
                        }
                        if (uVar2 == 0) {
                            uVar3 = (uint)((uVar16 - 0x2b & 0xfd) == 0);
                            uVar16 = (uint)(byte)yytext[uVar3];
                            pbVar11 = yytext + uVar3;
                            if (uVar16 != 0) {
                                iVar12 = 0;
                                goto LAB_0002cdbc;
                            }
                            iVar12 = 0;
                            goto LAB_0002cdd4;
                        }
                        pbVar11 = pbVar11 + 1;
                        uVar3 = (uint)*pbVar11;
                    } while (uVar3 != 0);
                    if ((uVar16 == 0x30) && (pp_Var7 = __ctype_tolower_loc(),
                                             (*pp_Var7)[yytext[1]] == 0x78))
                        goto LAB_0002cfb8;
                }
                iVar12 = sscanf(yytext, "%u", &yylval);
            }
            if (iVar12 == 1) {
                uVar3 = 0x1b2;
                goto LAB_0002cbe4;
            }
            pcVar5 = "U_int cannot be represented: %s";
        } else {
            uVar3 = 0x3ac;
            uVar6 = uVar16;
            do {
                while (uVar14 = *(uint *)(sst + uVar3 * 4),
                       (uVar14 & 0xff) == uVar6) {
                    puVar10 = puVar10 + 1;
                    uVar6 = (uint)(byte)*puVar10;
                    if (uVar6 == 0) {
                        uVar6 = (uVar14 << 0x16) >> 0x1e;
                        if (uVar6 != 3) {
                            DAT_000ca3dc = uVar6;
                            if ((uVar3 == 0x197) && (old_config_style == 0)) {
                                DAT_000ca3dc = 0;
                            }
                            goto LAB_0002c8f4;
                        }
                        goto LAB_0002ccdc;
                    }
                    uVar3 = (uVar14 << 0xb) >> 0x15;
                    if (uVar3 == 0)
                        goto LAB_0002ccdc;
                }
                uVar3 = uVar14 >> 0x15;
            } while (uVar3 != 0);
        LAB_0002ccdc:
            uVar3 = (uint)(uVar16 == 0x2d);
            pbVar11 = yytext + uVar3;
            uVar6 = (uint)(byte)yytext[uVar3];
            if (uVar6 != 0) {
                do {
                    if (((*ppuVar4)[uVar6] & 0x800) == 0)
                        goto LAB_0002cd20;
                    pbVar11 = pbVar11 + 1;
                    uVar6 = (uint)*pbVar11;
                } while (uVar6 != 0);
            }
            if (uVar3 == 0)
                goto LAB_0002cffc;
        LAB_0002d050:
            piVar8 = __errno_location();
            *piVar8 = 0;
            lVar9 = strtol(yytext, (char **)0x0, 10);
            yylval = (double)CONCAT44(yylval._4_4_, lVar9);
            if ((lVar9 != 0) || (*piVar8 != 0x16 && *piVar8 != 0x22)) {
                uVar3 = 0x13f;
                goto LAB_0002cbe4;
            }
            pcVar5 = "Integer cannot be represented: %s";
        }
        FUN_00075d40(3, pcVar5, yytext);
        iVar12 = FUN_0002c69c();
        if (iVar12 != 0) {
        LAB_0002cf7c:
            /* WARNING: Subroutine does not return */
            exit(1);
        }
    LAB_0002cbdc:
        uVar3 = 0;
        yylval = (double)((ulonglong)yylval & 0xffffffff00000000);
        goto LAB_0002cbe4;
    }
    if (yytext[0] == 0x2d) {
        if (yytext[1] == 0x34) {
            uVar3 = 0x145;
        } else {
            if (yytext[1] != 0x36)
                goto LAB_0002ca40;
            uVar3 = 0x147;
        }
    LAB_0002c8f4:
        yylval = (double)CONCAT44(yylval._4_4_, uVar3);
        goto LAB_0002cbe4;
    }
LAB_0002ca40:
    if (DAT_000ca3dc == 1) {
        DAT_000ca3dc = 0;
    }
    goto LAB_0002ca48;
joined_r0x0002d0c4:
    if (bVar1 == 0)
        goto LAB_0002d0ec;
    uVar3 = uVar3 + 1;
    if ((puVar17[bVar1] & 0x800) == 0)
        goto LAB_0002cdd4;
    pbVar11 = pbVar11 + 1;
    bVar1 = *pbVar11;
    iVar12 = iVar12 + 1;
    goto joined_r0x0002d0c4;
LAB_0002d0ec:
    if (iVar12 != 0)
        goto LAB_0002ce4c;
    goto LAB_0002ca48;
    while (true) {
        pbVar11 = pbVar11 + 1;
        uVar16 = (uint)*pbVar11;
        iVar12 = iVar12 + 1;
        uVar3 = uVar3 + 1;
        if (uVar16 == 0)
            break;
    LAB_0002cdbc:
        if ((puVar17[uVar16] & 0x800) == 0) {
            if (uVar16 == 0x2e) {
                pbVar11 = yytext + uVar3 + 1;
                bVar1 = yytext[uVar3 + 1];
                goto joined_r0x0002d0c4;
            }
            break;
        }
    }
LAB_0002cdd4:
    if (iVar12 != 0) {
        bVar1 = yytext[uVar3];
        if (bVar1 != 0) {
            pp_Var7 = __ctype_tolower_loc();
            if ((*pp_Var7)[bVar1] != 0x65)
                goto LAB_0002ca48;
            iVar12 = uVar3 + 1;
            uVar16 = (uint)(byte)yytext[uVar3 + 1];
            if ((uVar16 - 0x2b & 0xfd) == 0) {
                iVar12 = uVar3 + 2;
                uVar16 = (uint)(byte)yytext[uVar3 + 2];
            }
            if (uVar16 != 0) {
                pbVar11 = yytext + iVar12;
                do {
                    if ((puVar17[uVar16] & 0x800) == 0)
                        goto LAB_0002ca48;
                    pbVar11 = pbVar11 + 1;
                    uVar16 = (uint)*pbVar11;
                } while (uVar16 != 0);
            }
        }
    LAB_0002ce4c:
        piVar8 = __errno_location();
        *piVar8 = 0;
        yylval = strtod(yytext, (char **)0x0);
        if ((yylval == 0.0) && (*piVar8 == 0x22)) {
            FUN_00075d40(3, "Double too large to represent: %s", yytext);
            goto LAB_0002cf7c;
        }
        uVar3 = 0x121;
        goto LAB_0002cbe4;
    }
LAB_0002ca48:
    uVar3 = FUN_0002c240();
LAB_0002cbe4:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_0002d48c(int *param_1, int *param_2)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar2 = __stack_chk_guard;
    if (DAT_000ca3e8 == 0) {
        DAT_000ca3ec = FUN_0007998c(ntpdOptions, *param_1, *param_2);
    }
    iVar3 = *param_2;
    iVar1 = DAT_000ca3ec * 4;
    *param_1 = *param_1 - DAT_000ca3ec;
    *param_2 = iVar3 + iVar1;
    DAT_000ca3e8 = 1;
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002e238(int param_1, undefined4 param_2)

{
    long lVar1;
    size_t sVar2;
    uint uVar3;
    int iVar4;
    char *pcVar5;
    int *piVar6;
    undefined4 local_38[3];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (ipv4_works == 0) {
        if (ipv6_works == 0) {
            FUN_00075d40(3,
                         "Neither IPv4 nor IPv6 networking detected, fatal.");
            /* WARNING: Subroutine does not return */
            exit(1);
        }
        if ((*(uint *)(ntpdOptions._68_4_ + 0x10) & 0xf) != 0) {
            FUN_00075d40(4, "-4/--ipv4 ignored, IPv4 networking not found.");
        }
    } else if (ipv6_works == 0) {
        if ((*(uint *)(ntpdOptions._68_4_ + 0x50) & 0xf) != 0) {
            FUN_00075d40(4, "-6/--ipv6 ignored, IPv6 networking not found.");
        }
    } else {
        if ((*(uint *)(ntpdOptions._68_4_ + 0x10) & 0xf) == 0) {
            if ((*(uint *)(ntpdOptions._68_4_ + 0x50) & 0xf) != 0) {
                ipv4_works = 0;
            }
            uVar3 = *(uint *)(ntpdOptions._68_4_ + 0x90);
            goto joined_r0x0002e50c;
        }
        ipv6_works = 0;
    }
    uVar3 = *(uint *)(ntpdOptions._68_4_ + 0x90);
joined_r0x0002e50c:
    if ((uVar3 & 0xf) == 0) {
        if ((*(uint *)(ntpdOptions._68_4_ + 0xd0) & 0xf) != 0) {
            FUN_00049000(0, 3, 0);
        }
        uVar3 = *(uint *)(ntpdOptions._68_4_ + 0x110);
    } else {
        FUN_00049000(0, 3, 1, 0);
        uVar3 = *(uint *)(ntpdOptions._68_4_ + 0x110);
    }
    if ((uVar3 & 0xf) != 0) {
        FUN_00049000(0, 1, 1, 0);
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x150) & 0xf) != 0) {
        config_file = *(undefined4 *)(ntpdOptions._68_4_ + 0x158);
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x210) & 0xf) != 0) {
        FUN_00053708(1, *(undefined4 *)(ntpdOptions._68_4_ + 0x218));
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x250) & 0xf) != 0) {
        allow_panic = 1;
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x290) & 0xf) != 0) {
        force_step_once = 1;
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x350) & 0xf) != 0) {
        FUN_00053500(*(undefined4 *)(ntpdOptions._68_4_ + 0x358));
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x4d0) & 0xf) != 0) {
        FUN_00053708(3, *(undefined4 *)(ntpdOptions._68_4_ + 0x4d8));
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x550) & 0xf) != 0) {
        mode_ntpdate = 1;
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x590) & 0xf) != 0) {
        pcVar5 = *(char **)(ntpdOptions._68_4_ + 0x598);
        iVar4 = sscanf(pcVar5, "%lf", local_38);
        if (iVar4 == 1) {
            FUN_00049000(local_38[0], 4, 0);
        } else {
            FUN_00075d40(3, "command line broadcast delay value %s undecodable",
                         pcVar5);
        }
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x610) & 0xf) != 0) {
        FUN_00053708(2, *(undefined4 *)(ntpdOptions._68_4_ + 0x618));
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x650) & 0xf) != 0) {
        iVar4 = **(int **)(ntpdOptions._68_4_ + 0x65c);
        piVar6 = *(int **)(ntpdOptions._68_4_ + 0x65c) + 2;
        do {
            while (true) {
                pcVar5 = (char *)*piVar6;
                lVar1 = strtol(pcVar5, (char **)0x0, 10);
                if (0xfffe < lVar1 - 1U)
                    break;
                iVar4 = iVar4 + -1;
                FUN_000730c4(lVar1, 1);
                piVar6 = piVar6 + 1;
                if (iVar4 < 1)
                    goto LAB_0002e3dc;
            }
            iVar4 = iVar4 + -1;
            FUN_00075d40(3, "command line trusted key %s is invalid", pcVar5);
            piVar6 = piVar6 + 1;
        } while (0 < iVar4);
    }
LAB_0002e3dc:
    if ((*(uint *)(ntpdOptions._68_4_ + 0x710) & 0xf) != 0) {
        iVar4 = **(int **)(ntpdOptions._68_4_ + 0x71c);
        piVar6 = *(int **)(ntpdOptions._68_4_ + 0x71c) + 2;
        do {
            pcVar5 = (char *)*piVar6;
            iVar4 = iVar4 + -1;
            sVar2 = strlen(pcVar5);
            FUN_000348e4(pcVar5, sVar2 + 1, 3);
            piVar6 = piVar6 + 1;
        } while (0 < iVar4);
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x750) & 0xf) != 0) {
        iVar4 = **(int **)(ntpdOptions._68_4_ + 0x75c);
        piVar6 = *(int **)(ntpdOptions._68_4_ + 0x75c) + 2;
        do {
            pcVar5 = (char *)*piVar6;
            iVar4 = iVar4 + -1;
            sVar2 = strlen(pcVar5);
            FUN_000348e4(pcVar5, sVar2 + 1, 0x23);
            piVar6 = piVar6 + 1;
        } while (0 < iVar4);
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 2000) & 0xf) != 0) {
        FUN_00040b38(0, 3);
    }
    iVar4 = interface_interval;
    if (((*(uint *)(ntpdOptions._68_4_ + 0x6d0) & 0xf) == 0) ||
        (iVar4 = *(int *)(ntpdOptions._68_4_ + 0x6d8), -1 < iVar4)) {
        interface_interval = iVar4;
        if (0 < param_1) {
            cmdline_server_count = param_1;
            cmdline_servers = param_2;
        }
    } else {
        __fprintf_chk(
            stderr, 1,
            "command line interface update interval %ld must not be negative\n",
            iVar4);
        FUN_00075d40(
            3,
            "command line interface update interval %ld must not be negative",
            iVar4);
        if (0 < param_1) {
            cmdline_server_count = param_1;
            cmdline_servers = param_2;
        }
        FUN_0009b180(ntpdOptions, 2);
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002e740(short *param_1, undefined4 param_2, undefined4 param_3)

{
    EVP_MD_CTX *ctx;
    char *name;
    EVP_MD *type;
    short *d;
    size_t cnt;
    undefined4 local_68;
    undefined4 local_64;
    uint uStack_60;
    undefined4 local_5c[16];
    int local_1c;

    local_1c = __stack_chk_guard;
    local_68 = param_3;
    local_64 = param_2;
    while (
        (DAT_000ca3f4 == 0 || (0xe0f < (uint)(current_time - DAT_000ca404)))) {
        DAT_000ca3f4 = FUN_00079a2c();
        DAT_000ca3f8 = FUN_00079a2c();
        DAT_000ca3fc = FUN_00079a2c();
        DAT_000ca400 = FUN_00079a2c();
        DAT_000ca404 = current_time;
    }
    ctx = (EVP_MD_CTX *)EVP_MD_CTX_new();
    EVP_MD_CTX_set_flags(ctx, 8);
    name = OBJ_nid2sn(4);
    type = EVP_get_digestbyname(name);
    EVP_DigestInit_ex(ctx, type, (ENGINE *)0x0);
    EVP_DigestUpdate(ctx, &DAT_000ca3f4, 0x10);
    EVP_DigestUpdate(ctx, &local_64, 4);
    EVP_DigestUpdate(ctx, &local_68, 4);
    if (*param_1 == 2) {
        cnt = 4;
        d = param_1 + 2;
    } else {
        d = param_1 + 4;
        cnt = 0x10;
    }
    EVP_DigestUpdate(ctx, d, cnt);
    EVP_DigestUpdate(ctx, param_1 + 1, 2);
    EVP_DigestUpdate(ctx, &DAT_000ca3f4, 0x10);
    EVP_DigestFinal(ctx, (uchar *)local_5c, &uStack_60);
    EVP_MD_CTX_free(ctx);
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(local_5c[0]);
    }
    return;
}

void FUN_0002e8c0(int param_1, undefined4 param_2, undefined4 param_3)

{
    int iVar1;
    undefined4 uVar2;

    iVar1 = __stack_chk_guard;
    uVar2 = FUN_0002e740(param_1 + 4, *(undefined4 *)(param_1 + 0x48),
                         *(undefined4 *)(param_1 + 0x4c));
    FUN_0007d00c(param_2, param_3, "%08x%08x%08x",
                 *(undefined4 *)(param_1 + 0x48),
                 *(undefined4 *)(param_1 + 0x4c), uVar2);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002e948(short *param_1, int param_2)

{
    bool bVar1;
    int iVar2;
    int iVar3;
    undefined1 *puVar4;
    int iVar5;

    iVar2 = __stack_chk_guard;
    iVar5 = 0;
    puVar4 = ctl_traps + 8;
    do {
        if ((((puVar4[0x2a] & 1) != 0) &&
             (param_1[1] == *(short *)(puVar4 + -6))) &&
            (*(short *)(puVar4 + -8) == *param_1)) {
            if (*(short *)(puVar4 + -8) == 2) {
                bVar1 = *(int *)(param_1 + 2) == *(int *)(puVar4 + -4);
            } else {
                iVar3 = memcmp(param_1 + 4, puVar4, 0x10);
                if (iVar3 != 0)
                    goto LAB_0002e9a0;
                bVar1 = *(int *)(param_1 + 0xc) == *(int *)(puVar4 + 0x10);
            }
            if ((bVar1) && (*(int *)(puVar4 + 0x14) == param_2)) {
                puVar4 = ctl_traps + iVar5 * 0x34;
                goto LAB_0002e9b4;
            }
        }
    LAB_0002e9a0:
        iVar5 = iVar5 + 1;
        puVar4 = puVar4 + 0x34;
        if (iVar5 == 3) {
            puVar4 = (undefined1 *)0x0;
        LAB_0002e9b4:
            if (iVar2 == __stack_chk_guard) {
                return;
            }
            /* WARNING: Subroutine does not return */
            __stack_chk_fail(puVar4);
        }
    } while (true);
}

void FUN_0002ea58(byte *param_1, undefined4 *param_2)

{
    ushort uVar1;
    int iVar2;
    ushort **ppuVar3;
    undefined4 uVar4;
    byte *pbVar5;
    byte *pbVar6;
    byte *pbVar7;
    byte *pbVar8;
    byte *pbVar9;
    byte *pbVar10;
    byte *pbVar11;
    byte *pbVar12;
    uint uVar13;

    iVar2 = __stack_chk_guard;
    pbVar12 = DAT_000ca40c;
    pbVar9 = DAT_000ca408;
    pbVar10 = DAT_000ca408;
    if (DAT_000ca408 < DAT_000ca40c) {
        do {
            uVar13 = (uint)*pbVar9;
            pbVar10 = pbVar9 + 1;
            if (uVar13 != 0x2c) {
                ppuVar3 = __ctype_b_loc();
                pbVar8 = (byte *)((*ppuVar3)[uVar13] & 0x2000);
                if (((*ppuVar3)[uVar13] & 0x2000) == 0) {
                    if (pbVar12 <= pbVar9)
                        goto LAB_0002eaf0;
                    pbVar10 = pbVar9;
                    goto LAB_0002eb44;
                }
            }
            pbVar9 = pbVar10;
        } while (pbVar10 != pbVar12);
    }
    DAT_000ca408 = pbVar10;
    pbVar8 = (byte *)0x0;
    goto LAB_0002eaf0;
LAB_0002eb44:
    if (uVar13 == 0x3d) {
        if (pbVar8 == (byte *)0x0) {
            pbVar8 = pbVar10;
        }
    } else {
        pbVar11 = pbVar10;
        if (uVar13 == 0x2c)
            goto LAB_0002eb64;
    }
    pbVar11 = pbVar12;
    if (pbVar10 == pbVar12 + -1)
        goto LAB_0002eb64;
    pbVar10 = pbVar10 + 1;
    uVar13 = (uint)*pbVar10;
    goto LAB_0002eb44;
LAB_0002eb64:
    *param_2 = 0;
    pbVar10 = pbVar11;
    if (pbVar8 != (byte *)0x0) {
        if (pbVar8 + 1 != pbVar11) {
            pbVar5 = pbVar8 + 1;
            do {
                pbVar7 = pbVar5 + 1;
                pbVar6 = pbVar11;
                if (((*ppuVar3)[*pbVar5] & 0x2000) == 0)
                    goto joined_r0x0002ebb8;
                pbVar5 = pbVar7;
            } while (pbVar11 != pbVar7);
        }
    LAB_0002ec50:
        uVar13 = 0;
        pbVar5 = pbVar10;
        goto LAB_0002ec54;
    }
    goto LAB_0002ec84;
    while (pbVar6 = pbVar7 + -1, pbVar10 = pbVar5,
           ((*ppuVar3)[pbVar7[-1]] & 0x2000) != 0) {
    joined_r0x0002ebb8:
        pbVar7 = pbVar6;
        if (pbVar7 == pbVar5)
            goto LAB_0002ec50;
    }
    uVar13 = (int)pbVar7 - (int)pbVar5;
    if (0x7f < uVar13) {
        numctlbadpkts = numctlbadpkts + 1;
        if (((ntp_syslogmask & 2) != 0) && (DAT_000ca490 <= current_time)) {
            DAT_000ca490 = current_time + 300;
            uVar4 = FUN_0007d2c0(DAT_000ca494);
            FUN_00075d40(
                4, "Possible \'ntpdx\' exploit from %s#%u (possibly spoofed)",
                uVar4,
                *(ushort *)(DAT_000ca494 + 2) >> 8 |
                    *(ushort *)(DAT_000ca494 + 2) << 8);
            pbVar12 = DAT_000ca40c;
        }
        pbVar8 = (byte *)0x0;
        DAT_000ca408 = pbVar12;
        goto LAB_0002eaf0;
    }
LAB_0002ec54:
    __memcpy_chk(&DAT_000ca410, pbVar5, uVar13, 0x80);
    (&DAT_000ca410)[uVar13] = 0;
    *param_2 = &DAT_000ca410;
    pbVar10 = pbVar8;
LAB_0002ec84:
    if (param_1 == (byte *)0x0) {
        pbVar8 = &DAT_000a50f8;
    } else {
        uVar1 = *(ushort *)(param_1 + 2);
        pbVar8 = param_1;
        if ((uVar1 & 0x80) == 0) {
            do {
                if ((uVar1 & 0x40) == 0) {
                    pbVar5 = *(byte **)(pbVar8 + 4);
                    if (pbVar10 == pbVar9) {
                    LAB_0002ecf8:
                        if (*pbVar5 == 0 || *pbVar5 == 0x3d) {
                            DAT_000ca408 = pbVar11;
                            if (pbVar11 != pbVar12) {
                                DAT_000ca408 = pbVar11 + 1;
                            }
                            goto LAB_0002eaf0;
                        }
                    } else if ((*pbVar5 != 0) &&
                               (pbVar6 = pbVar9, *pbVar9 == *pbVar5)) {
                        do {
                            pbVar5 = pbVar5 + 1;
                            if (pbVar6 == pbVar10 + -1)
                                goto LAB_0002ecf8;
                        } while ((*pbVar5 != 0) &&
                                 (pbVar6 = pbVar6 + 1, *pbVar6 == *pbVar5));
                    }
                }
                pbVar5 = pbVar8 + 8;
                uVar1 = *(ushort *)(pbVar8 + 10);
                pbVar8 = pbVar5;
            } while ((uVar1 & 0x80) == 0);
        }
        *param_2 = 0;
    }
LAB_0002eaf0:
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(pbVar8);
    }
    return;
}

void FUN_0002edd4(int param_1)

{
    uint uVar1;
    int iVar2;
    int iVar3;
    uint *puVar4;
    uint *puVar5;
    uint *puVar6;
    undefined1 *puVar7;

    iVar2 = __stack_chk_guard;
    puVar6 = DAT_000ca498 + -0x3292a;
    if (((param_1 == 0) && (DAT_000ca6a0 != 0)) &&
        (puVar5 = (uint *)((int)DAT_000ca498 + -0xca4a6),
         puVar5 < (uint *)0x1d4)) {
        *(undefined1 *)DAT_000ca498 = 0xd;
        puVar7 = (undefined1 *)((int)DAT_000ca498 + 1);
        DAT_000ca498 = (uint *)((int)DAT_000ca498 + 2);
        *puVar7 = 10;
        puVar6 = puVar5;
    }
    for (puVar5 = puVar6 + 3; ((uint)puVar5 & 3) != 0;
         puVar5 = (uint *)((int)puVar5 + 1)) {
        *(undefined1 *)DAT_000ca498 = 0;
        DAT_000ca498 = (uint *)((int)DAT_000ca498 + 1);
    }
    DAT_000ca4a6 =
        (ushort)(byte)((uint)puVar6 >> 8) | (ushort)((int)puVar6 << 8);
    DAT_000ca4a4 = (ushort)(byte)((uint)DAT_000ca6a8 >> 8) |
                   (ushort)((int)DAT_000ca6a8 << 8);
    DAT_000ca49d =
        (byte)param_1 |
        ~((byte) ~(byte)(((DAT_000ca6a4 & 0x1f) << 0x19) >> 0x18) >> 1);
    if (DAT_000ca6ac == '\0') {
        if ((DAT_000ca6ad == '\0') || (sys_authenticate == 0)) {
            FUN_00026cc0(DAT_000ca494, DAT_000ca6b4, 0xfffffffa, &DAT_000ca49c,
                         puVar5);
        } else {
            if (((uint)puVar5 & 7) != 0) {
                iVar3 = (int)puVar5 - (int)DAT_000ca498;
                puVar4 = DAT_000ca498;
                do {
                    DAT_000ca498 = (uint *)((int)puVar4 + 1);
                    *(undefined1 *)puVar4 = 0;
                    puVar5 = (uint *)((int)DAT_000ca498 + iVar3);
                    puVar4 = DAT_000ca498;
                } while (((uint)puVar5 & 7) != 0);
            }
            uVar1 = DAT_000ca6b0;
            *DAT_000ca498 =
                DAT_000ca6b0 << 0x18 | (DAT_000ca6b0 >> 8 & 0xff) << 0x10 |
                (DAT_000ca6b0 >> 0x10 & 0xff) << 8 | DAT_000ca6b0 >> 0x18;
            iVar3 = FUN_000736a4(uVar1, &DAT_000ca49c, puVar5);
            FUN_00026cc0(DAT_000ca494, DAT_000ca6b4, 0xfffffffb, &DAT_000ca49c,
                         (undefined1 *)(iVar3 + (int)puVar5));
        }
        if (param_1 == 0) {
            numctlresponses = numctlresponses + 1;
        } else {
            numctlfrags = numctlfrags + 1;
        }
    } else {
        puVar7 = ctl_traps;
        do {
            if ((*(byte *)((int)puVar7 + 0x32) & 1) != 0) {
                DAT_000ca49e = *(ushort *)((int)puVar7 + 0x30) >> 8 |
                               *(ushort *)((int)puVar7 + 0x30) << 8;
                DAT_000ca49c = sys_leap << 6 | 6U |
                               (*(byte *)((int)puVar7 + 0x33) & 7) << 3;
                FUN_00026cc0(puVar7, *(undefined4 *)((int)puVar7 + 0x1c),
                             0xfffffffc, &DAT_000ca49c, puVar5);
                if (param_1 == 0) {
                    *(short *)((int)puVar7 + 0x30) =
                        *(short *)((int)puVar7 + 0x30) + 1;
                }
                numasyncmsgs = numasyncmsgs + 1;
            }
            puVar7 = (undefined1 *)((int)puVar7 + 0x34);
        } while ((undefined4 *)puVar7 != &numctlinputresp);
    }
    DAT_000ca6a8 = (undefined1 *)((int)puVar6 + (int)DAT_000ca6a8);
    DAT_000ca498 = (uint *)&DAT_000ca4a8;
    DAT_000ca6b8 = DAT_000ca6b8 + 1;
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002f104(int param_1, int param_2, int param_3)

{
    int *piVar1;
    undefined1 *puVar2;
    int iVar3;
    void *pvVar4;
    uint __n;
    size_t __n_00;
    int iVar5;
    int iVar6;
    int iVar7;
    void *pvVar8;

    iVar3 = __stack_chk_guard;
    if (param_3 == 0) {
        DAT_000ca6a0 = 1;
        if (DAT_000ca6bc == 0) {
            iVar5 = 3;
        } else {
            *DAT_000ca498 = 0x2c;
            if (param_2 == 0) {
                iVar5 = 0;
            } else {
                iVar5 = 0;
                iVar7 = param_1;
                do {
                    piVar1 = (int *)(iVar7 + 4);
                    iVar7 = iVar7 + 8;
                    iVar5 = iVar5 + *piVar1;
                } while (iVar7 != param_1 + param_2 * 8);
            }
            if ((uint)(DAT_000ca6c0 + 2 + iVar5) < 0x48) {
                DAT_000ca6c0 = DAT_000ca6c0 + 2;
                DAT_000ca498[1] = 0x20;
                iVar5 = 3;
                DAT_000ca498 = DAT_000ca498 + 2;
            } else {
                DAT_000ca498[1] = 0xd;
                iVar5 = 3;
                DAT_000ca6c0 = 0;
                puVar2 = DAT_000ca498 + 2;
                DAT_000ca498 = DAT_000ca498 + 3;
                *puVar2 = 10;
            }
        }
    } else {
        iVar5 = 0;
    }
    if (param_2 != 0) {
        iVar6 = 0;
        iVar7 = param_1;
        do {
            __n_00 = *(uint *)(iVar7 + 4);
            pvVar8 = *(void **)(param_1 + iVar6 * 8);
            if (pvVar8 != (void *)0x0 && __n_00 != 0) {
                __n = DAT_000ca6c4 - (int)DAT_000ca498;
                pvVar4 = pvVar8;
                if (__n < __n_00 + iVar5) {
                    do {
                        if (__n_00 <= __n) {
                            __n = __n_00;
                        }
                        __n_00 = __n_00 - __n;
                        pvVar8 = (void *)((int)pvVar4 + __n);
                        pvVar4 = memcpy(DAT_000ca498, pvVar4, __n);
                        DAT_000ca498 = (undefined1 *)((int)pvVar4 + __n);
                        DAT_000ca6c0 = __n + DAT_000ca6c0;
                        FUN_0002edd4(0x20);
                        __n = DAT_000ca6c4 - (int)DAT_000ca498;
                        pvVar4 = pvVar8;
                    } while (__n < __n_00 + iVar5);
                }
                pvVar8 = memcpy(DAT_000ca498, pvVar8, __n_00);
                DAT_000ca6bc = 1;
                DAT_000ca498 = (undefined1 *)((int)pvVar8 + __n_00);
                DAT_000ca6c0 = __n_00 + DAT_000ca6c0;
            }
            iVar6 = iVar6 + 1;
            iVar7 = iVar7 + 8;
        } while (iVar6 != param_2);
    }
    if (iVar3 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002f350(char *param_1, int param_2, int param_3)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    char *local_2c;
    size_t local_28;
    undefined *local_24;
    undefined4 local_20;
    int local_1c;
    int local_18;
    int local_14;

    local_14 = __stack_chk_guard;
    local_2c = param_1;
    local_28 = strlen(param_1);
    local_20 = 1;
    if (param_2 != 0 && param_3 != 0) {
        uVar3 = 3;
    } else {
        uVar3 = 2;
    }
    local_24 = &DAT_000a5268;
    iVar1 = param_2;
    iVar2 = param_3;
    if (param_2 == 0 || param_3 == 0) {
        iVar1 = local_1c;
        iVar2 = local_18;
    }
    local_18 = iVar2;
    local_1c = iVar1;
    FUN_0002f104(&local_2c, uVar3, 0);
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002f3f0(undefined4 param_1, undefined4 param_2, int param_3)

{
    int iVar1;
    char *__s;
    size_t sVar2;

    iVar1 = __stack_chk_guard;
    if (param_3 == 0) {
        __s = (char *)FUN_0007a66c(param_2);
    } else {
        __s = (char *)FUN_0007d2c0(param_3);
    }
    sVar2 = strlen(__s);
    if (iVar1 == __stack_chk_guard) {
        FUN_0002f350(param_1, __s, sVar2);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002f474(undefined4 param_1, undefined4 param_2)

{
    ushort **ppuVar1;
    uint uVar2;
    int iVar3;
    byte *pbVar4;
    undefined4 local_28;
    int local_24;

    iVar3 = 0;
    local_28 = param_2;
    local_24 = __stack_chk_guard;
    pbVar4 = (byte *)&local_28;
    do {
        uVar2 = (uint)*pbVar4;
        if (uVar2 == 0)
            break;
        ppuVar1 = __ctype_b_loc();
        iVar3 = iVar3 + 1;
        if (((*ppuVar1)[uVar2] & 0x6000) != 0x4000 || uVar2 == 0x2c) {
            *pbVar4 = 0x2e;
        }
        pbVar4 = pbVar4 + 1;
    } while (iVar3 != 4);
    FUN_0002f350(param_1, &local_28, iVar3);
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002f528(char *param_1, int param_2, int param_3)

{
    bool bVar1;
    char *local_34;
    size_t local_30;
    undefined *local_2c;
    undefined4 local_28;
    int local_24;
    int local_20;
    undefined *local_1c;
    undefined4 local_18;
    int local_14;

    local_14 = __stack_chk_guard;
    local_34 = param_1;
    local_30 = strlen(param_1);
    bVar1 = param_2 != 0 && param_3 != 0;
    if (bVar1) {
        local_2c = &DAT_000a526c;
        local_1c = &DAT_000aa078;
        local_28 = 2;
        local_18 = 1;
        local_24 = param_2;
        local_20 = param_3;
        FUN_0002f104(&local_34, 4, 0);
    } else {
        local_2c = &DAT_000a5270;
        local_28 = 3;
        FUN_0002f104(&local_34, 2, bVar1);
    }
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002f604(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    uint uVar1;
    char *local_ac;
    size_t local_a8;
    char acStack_a4[122];
    undefined4 local_2a;
    undefined2 local_26;
    int local_24;
    undefined4 uStack_c;
    undefined4 uStack_8;
    undefined4 uStack_4;

    local_24 = __stack_chk_guard;
    uStack_c = param_2;
    uStack_8 = param_3;
    uStack_4 = param_4;
    uVar1 = FUN_0007c654(acStack_a4, 0x80, param_1, &uStack_c, &uStack_c);
    if (0x7f < uVar1) {
        local_2a = 0x2e2e2e5b;
        local_26 = 0x5d;
    }
    local_a8 = strlen(acStack_a4);
    local_ac = acStack_a4;
    FUN_0002f104(&local_ac, 1, 0);
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002f734(undefined2 param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    DAT_000ca4a6 = 0;
    DAT_000ca49d =
        ~((byte) ~(byte)(((DAT_000ca6a4 & 0x1f) << 0x1a) >> 0x18) >> 2);
    numctlerrors = numctlerrors + 1;
    DAT_000ca4a0 = param_1;
    if ((DAT_000ca6ad == '\0') || (sys_authenticate == 0)) {
        FUN_00026cc0(DAT_000ca494, DAT_000ca6b4, 0xfffffffd, &DAT_000ca49c,
                     0xc);
    } else {
        iVar2 = FUN_000736a4(DAT_000ca6b0, &DAT_000ca49c, 0xc);
        FUN_00026cc0(DAT_000ca494, DAT_000ca6b4, 0xfffffffe, &DAT_000ca49c,
                     iVar2 + 0xc);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x0002fc54) */

void FUN_0002fbb8(int param_1)

{
    ushort *puVar1;
    uint uVar2;
    int iVar3;

    if (param_1 != 0) {
        uVar2 = *(ushort *)(param_1 + 2) & 0x80;
        iVar3 = param_1 + 8;
        if ((*(ushort *)(param_1 + 2) & 0x80) == 0) {
            do {
                puVar1 = (ushort *)(iVar3 + 2);
                uVar2 = uVar2 + 1;
                iVar3 = iVar3 + 8;
            } while ((*puVar1 & 0x80) == 0);
            if (0xffff < uVar2) {
                /* WARNING: Subroutine does not return */
                FUN_0007fc54("ntp_control.c", 0x142d, 1,
                             "c <= (32767 * 2 + 1)");
            }
        }
    }
    return;
}

void FUN_0002fc68(undefined4 param_1, undefined4 param_2)

{
    uint uVar1;
    undefined1 auStack_2c[24];
    int local_14;

    local_14 = __stack_chk_guard;
    uVar1 = FUN_0007d00c(auStack_2c, 0x18, "0x%lx", param_2);
    if (0x17 < uVar1) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_control.c", 0x6d7, 2,
                     "rc >= 0 && (size_t)rc < sizeof(buffer)");
    }
    FUN_0002f350(param_1, auStack_2c, uVar1);
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002fd0c(undefined4 param_1, undefined4 param_2)

{
    uint uVar1;
    undefined1 auStack_2c[24];
    int local_14;

    local_14 = __stack_chk_guard;
    uVar1 = FUN_0007d00c(auStack_2c, 0x18, &DAT_000a548c, param_2);
    if (0x17 < uVar1) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_control.c", 0x6e9, 2,
                     "rc >= 0 && (size_t)rc < sizeof(buffer)");
    }
    FUN_0002f350(param_1, auStack_2c, uVar1);
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002fdb0(undefined4 param_1, undefined4 param_2)

{
    uint uVar1;
    undefined1 auStack_2c[24];
    int local_14;

    local_14 = __stack_chk_guard;
    uVar1 = FUN_0007d00c(auStack_2c, 0x18, "%lu", param_2);
    if (0x17 < uVar1) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_control.c", 0x692, 2,
                     "rc >= 0 && (size_t)rc < sizeof(buffer)");
    }
    FUN_0002f350(param_1, auStack_2c, uVar1);
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002fe54(undefined4 param_1)

{
    uint uVar1;
    int iVar2;
    uint uVar3;
    char local_4c;
    char local_4b;
    char local_4a;
    undefined1 local_49;
    undefined1 auStack_48[28];
    int local_2c;

    local_2c = __stack_chk_guard;
    uVar1 = rand();
    iVar2 = rand();
    local_49 = 0x2e;
    uVar3 = uVar1 ^ iVar2 << 0x10;
    local_4c = (char)uVar1 + (char)((int)uVar3 / 0x1a) * -0x1a + 'a';
    local_4b = (char)((int)uVar3 >> 5) +
               (char)(((int)uVar3 >> 5) / 0x1a) * -0x1a + 'a';
    local_4a = (char)((int)uVar3 >> 10) +
               (char)(((int)uVar3 >> 10) / 0x1a) * -0x1a + 'a';
    FUN_0007d00c(auStack_48, 0x1c, "%d", param_1);
    FUN_0002fdb0(&local_4c, (int)uVar3 >> 0xf);
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002ff38(undefined4 param_1, undefined4 *param_2)

{
    uint uVar1;
    undefined1 auStack_2c[24];
    int local_14;

    local_14 = __stack_chk_guard;
    uVar1 =
        FUN_0007d00c(auStack_2c, 0x18, "0x%08lx.%08lx", *param_2, param_2[1]);
    if (0x17 < uVar1) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_control.c", 0x6fd, 2,
                     "rc >= 0 && (size_t)rc < sizeof(buffer)");
    }
    FUN_0002f350(param_1, auStack_2c, uVar1);
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002ffe4(int param_1, int param_2, undefined4 param_3)

{
    uint uVar1;
    char *__s;
    size_t sVar2;
    char *pcVar3;
    char *pcVar4;
    int iVar5;
    uint uVar6;
    uint uVar7;
    int iVar8;
    int iVar9;
    undefined4 local_ac;
    uint local_a8;
    undefined4 local_a4;
    undefined4 local_a0;
    undefined4 local_9c;
    undefined4 local_98;
    undefined4 local_94;
    undefined4 local_90;
    uint local_8c;
    undefined4 local_88;
    undefined4 local_84;
    undefined4 local_80;
    undefined4 local_7c;
    undefined4 local_78;
    char local_74[4];
    undefined4 local_70;
    undefined4 uStack_6c;
    undefined4 local_68;
    undefined4 uStack_64;
    undefined4 local_60;
    undefined4 uStack_5c;
    char local_58[12];
    undefined1 auStack_4c[32];
    int local_2c;

    local_70 = 0x72646461;
    uStack_6c = 0x75252e;
    local_68 = 0x6b73616d;
    uStack_64 = 0x75252e;
    local_60 = 0x73746968;
    uStack_5c = 0x75252e;
    local_a8 = 0;
    local_a4 = 0;
    local_a0 = 0;
    local_2c = __stack_chk_guard;
    builtin_strncpy(local_58, "flags.%u", 9);
    local_9c = 0;
    local_98 = 0;
    local_94 = 0;
    local_8c = 0;
    local_88 = 0;
    local_84 = 0;
    local_80 = 0;
    local_7c = 0;
    local_78 = 0;
    if (param_2 == 0) {
        uVar6 = *(uint *)(param_1 + 0x14);
        uVar7 = *(uint *)(param_1 + 0x18);
        local_a8 = uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10 |
                   (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18;
        local_ac = 2;
        local_8c = uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 |
                   (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18;
        local_90 = 2;
    } else {
        local_a4 = *(undefined4 *)(param_1 + 0x14);
        local_ac = 10;
        local_a0 = *(undefined4 *)(param_1 + 0x18);
        local_9c = *(undefined4 *)(param_1 + 0x1c);
        local_98 = *(undefined4 *)(param_1 + 0x20);
        local_90 = 10;
        local_88 = *(undefined4 *)(param_1 + 0x24);
        local_84 = *(undefined4 *)(param_1 + 0x28);
        local_80 = *(undefined4 *)(param_1 + 0x2c);
        local_7c = *(undefined4 *)(param_1 + 0x30);
    }
    iVar9 = 0;
    iVar8 = 4;
    local_74[0] = '\0';
    local_74[1] = '\0';
    local_74[2] = '\0';
    local_74[3] = '\0';
    uVar6 = 0;
    do {
        if (iVar9 < 2) {
            uVar6 = rand();
            iVar9 = 0x1d;
            iVar5 = rand();
            uVar6 = uVar6 ^ iVar5 << 0x10;
        } else {
            iVar9 = iVar9 + -2;
        }
        uVar7 = uVar6 >> 2;
        for (; uVar6 = uVar6 & 3, local_74[uVar6] != '\0'; uVar6 = uVar6 + 1) {
        }
        if (uVar6 == 2) {
            FUN_0007d00c(auStack_4c, 0x20, &local_60, param_3);
            FUN_0002fdb0(auStack_4c, *(undefined4 *)(param_1 + 4));
        } else {
            if (uVar6 == 3) {
                FUN_0007d00c(auStack_4c, 0x20, local_58, param_3);
                pcVar3 = (char *)FUN_0007dff8(*(undefined2 *)(param_1 + 10));
                pcVar4 = (char *)FUN_0007e060(*(undefined2 *)(param_1 + 8));
                uVar1 = lib_nextbuf;
                __s = pcVar4;
                if (*pcVar3 != '\0') {
                    __s = lib_stringbuf + lib_nextbuf * 0x80;
                    memset(__s, 0, 0x80);
                    lib_nextbuf = uVar1 + 1 & 0xf;
                    FUN_0007d00c(__s, 0x80, "%s %s", pcVar3, pcVar4);
                }
            } else if (uVar6 == 1) {
                FUN_0007d00c(auStack_4c, 0x20, &local_68, param_3);
                __s = (char *)FUN_0007d2c0(&local_90);
            } else {
                FUN_0007d00c(auStack_4c, 0x20, &local_70, param_3);
                __s = (char *)FUN_0007d2c0(&local_ac);
            }
            sVar2 = strlen(__s);
            FUN_0002f350(auStack_4c, __s, sVar2);
        }
        iVar8 = iVar8 + -1;
        local_74[uVar6] = '\x01';
        uVar6 = uVar7;
    } while (iVar8 != 0);
    FUN_0002fe54(param_3);
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003034c(undefined4 param_1, int param_2, undefined4 param_3)

{
    uint uVar1;
    undefined *puVar2;
    undefined1 auStack_3c[40];
    int local_14;

    local_14 = __stack_chk_guard;
    if (param_2 == 0) {
        puVar2 = &DAT_000a54cc;
    } else {
        puVar2 = &DAT_000a54c4;
    }
    uVar1 = FUN_0007d00c(auStack_3c, 0x28, puVar2, param_3);
    if (uVar1 < 0x28) {
        FUN_0002f350(param_1, auStack_3c, uVar1);
        if (local_14 == __stack_chk_guard) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    /* WARNING: Subroutine does not return */
    FUN_0007fc54("ntp_control.c", 0x681, 2,
                 "rc >= 0 && (size_t)rc < sizeof(buffer)");
}

void FUN_00030410(undefined4 param_1, undefined1 *param_2, int param_3)

{
    ushort uVar1;
    byte bVar2;
    size_t sVar3;
    void *pvVar4;
    char *pcVar5;
    int iVar6;
    char *pcVar7;
    undefined *puVar8;
    undefined *puVar9;
    int iVar10;
    char *pcVar11;
    char *pcVar12;
    char *local_208;
    int local_204;
    char acStack_200[468];
    int local_2c[2];

    local_2c[0] = __stack_chk_guard;
    switch (param_1) {
    case 1:
        if (((param_3 != 0) || (*(char **)(param_2 + 0x20) == (char *)0x0)) ||
            (**(char **)(param_2 + 0x20) == '\0')) {
            FUN_0002fdb0("type", *param_2);
        }
        break;
    case 2:
        FUN_0002f528("timecode", *(undefined4 *)(param_2 + 8),
                     *(undefined2 *)(param_2 + 4));
        break;
    case 3:
        FUN_0002fdb0(&DAT_000a54e0, *(undefined4 *)(param_2 + 0xc));
        break;
    case 4:
        FUN_0002fdb0("noreply", *(undefined4 *)(param_2 + 0x10));
        break;
    case 5:
        FUN_0002fdb0("badformat", *(undefined4 *)(param_2 + 0x14));
        break;
    case 6:
        FUN_0002fdb0("baddata", *(undefined4 *)(param_2 + 0x18));
        break;
    case 7:
        if ((param_3 != 0) || ((param_2[2] & 1) != 0)) {
            FUN_0003034c(SUB84(*(double *)(param_2 + 0x28) * 1000.0, 0),
                         "fudgetime1", 1, 3);
        }
        break;
    case 8:
        if ((param_3 != 0) || ((param_2[2] & 2) != 0)) {
            FUN_0003034c(SUB84(*(double *)(param_2 + 0x30) * 1000.0, 0),
                         "fudgetime2", 1, 3);
        }
        break;
    case 9:
        if ((param_3 != 0) || ((param_2[2] & 4) != 0)) {
            FUN_0002fd0c("stratum", *(undefined4 *)(param_2 + 0x38));
        }
        break;
    case 10:
        if ((param_3 != 0) || ((param_2[2] & 8) != 0)) {
            if (*(int *)(param_2 + 0x38) < 2) {
                FUN_0002f474("refid", *(undefined4 *)(param_2 + 0x3c));
            } else {
                FUN_0002f3f0("refid", *(undefined4 *)(param_2 + 0x3c), 0);
            }
        }
        break;
    case 0xb:
        FUN_0002fdb0("flags", param_2[1]);
        break;
    case 0xc:
        pcVar7 = *(char **)(param_2 + 0x20);
        if ((pcVar7 == (char *)0x0) || (*pcVar7 == '\0')) {
            if (param_3 != 0) {
                FUN_0002f528("device", &DAT_000a9528, 0);
            }
        } else {
            sVar3 = strlen(pcVar7);
            FUN_0002f528("device", pcVar7, sVar3);
        }
        break;
    case 0xd:
        FUN_0007d00c(acStack_200, 0x1d4, &DAT_000a5534, "clock_var_list");
        sVar3 = strlen(acStack_200);
        puVar8 = &UNK_000c4ef0;
        pcVar11 = acStack_200 + sVar3;
        pcVar7 = pcVar11;
        while (uVar1 = *(ushort *)(puVar8 + 10), puVar9 = puVar8,
               (uVar1 & 0x80) == 0) {
            while (puVar8 = puVar9 + 8, (uVar1 & 0x40) == 0) {
                pcVar12 = *(char **)(puVar9 + 0xc);
                sVar3 = strlen(pcVar12);
                if (local_2c <= pcVar7 + sVar3 + 1)
                    goto LAB_00030524;
                pcVar5 = pcVar11;
                if (pcVar7 != pcVar11) {
                    *pcVar7 = ',';
                    pcVar5 = pcVar7 + 1;
                }
                pcVar7 = pcVar5 + sVar3;
                memcpy(pcVar5, pcVar12, sVar3);
                uVar1 = *(ushort *)(puVar9 + 0x12);
                puVar9 = puVar8;
                if ((uVar1 & 0x80) != 0)
                    goto LAB_00030524;
            }
        }
    LAB_00030524:
        iVar10 = *(int *)(param_2 + 0x44);
        if (iVar10 != 0) {
            uVar1 = *(ushort *)(iVar10 + 2);
            bVar2 = (byte)uVar1;
            if ((uVar1 & 0x80) == 0) {
                do {
                    if (((uVar1 & 0x40) == 0) &&
                        (pcVar12 = *(char **)(iVar10 + 4),
                         pcVar12 != (char *)0x0)) {
                        pcVar5 = pcVar12;
                        if (*pcVar12 == '=' || *pcVar12 == '\0') {
                            sVar3 = 0;
                            iVar6 = 1;
                        } else {
                            do {
                                pcVar5 = pcVar5 + 1;
                            } while (*pcVar5 != '=' && *pcVar5 != '\0');
                            sVar3 = (int)pcVar5 - (int)pcVar12;
                            iVar6 = sVar3 + 1;
                        }
                        if (local_2c <= pcVar7 + iVar6)
                            break;
                        pcVar5 = pcVar11;
                        if (pcVar7 != pcVar11) {
                            *pcVar7 = ',';
                            pcVar12 = *(char **)(iVar10 + 4);
                            pcVar5 = pcVar7 + 1;
                        }
                        pcVar7 = pcVar5 + sVar3;
                        pvVar4 = memcpy(pcVar5, pcVar12, sVar3);
                        *(byte *)((int)pvVar4 + sVar3) = bVar2 & 0x80;
                    }
                    if ((iVar10 + 8 == 0) ||
                        (uVar1 = *(ushort *)(iVar10 + 10), iVar10 = iVar10 + 8,
                         (uVar1 & 0x80) != 0))
                        break;
                } while (true);
            }
        }
        if (pcVar7 + 2 < local_2c) {
            *pcVar7 = '\"';
            pcVar7[1] = '\0';
            local_204 = (int)(pcVar7 + 1) - (int)acStack_200;
            local_208 = acStack_200;
            FUN_0002f104(&local_208, 1, 0);
        }
    }
    if (local_2c[0] != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00030888(undefined4 param_1, int param_2, int param_3)

{
    uint uVar1;
    int iVar2;
    int iVar3;
    undefined1 *puVar4;
    bool bVar5;
    undefined1 auStack_fc[200];
    int local_34[2];

    local_34[0] = __stack_chk_guard;
    iVar3 = param_3;
    puVar4 = auStack_fc;
    while (true) {
        bVar5 = iVar3 != 0;
        if (bVar5) {
            iVar3 = iVar3 + -1;
            iVar2 = iVar3 * 8;
        } else {
            iVar2 = 0x38;
        }
        if (!bVar5) {
            iVar3 = 7;
        }
        uVar1 = FUN_0007d00c(puVar4, (int)local_34 - (int)puVar4, " %.2f",
                             (double *)(param_2 + iVar2),
                             *(double *)(param_2 + iVar2) * 1000.0);
        if (((int)uVar1 < 0) || ((uint)((int)local_34 - (int)puVar4) <= uVar1))
            break;
        puVar4 = puVar4 + uVar1;
        if (param_3 == iVar3) {
            FUN_0002f350(param_1, auStack_fc, (int)puVar4 - (int)auStack_fc);
            if (local_34[0] != __stack_chk_guard) {
                /* WARNING: Subroutine does not return */
                __stack_chk_fail();
            }
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    FUN_0007fc54("ntp_control.c", 0x746, 2,
                 "rc >= 0 && (size_t)rc < (size_t)(ep - cp)");
}

void FUN_0003099c(undefined4 param_1, int param_2)

{
    tm *ptVar1;
    uint uVar2;
    int local_28;
    undefined1 auStack_24[16];
    int local_14;

    local_28 = param_2 + 0x7c558180;
    local_14 = __stack_chk_guard;
    ptVar1 = gmtime(&local_28);
    if (ptVar1 != (tm *)0x0) {
        uVar2 = FUN_0007d00c(auStack_24, 0x10, "%04d%02d%02d%02d%02d",
                             ptVar1->tm_year + 0x76c, ptVar1->tm_mon + 1,
                             ptVar1->tm_mday, ptVar1->tm_hour, ptVar1->tm_min);
        if (0xf < uVar2) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_control.c", 0x6c4, 2,
                         "rc >= 0 && (size_t)rc < sizeof(buffer)");
        }
        FUN_0002f350(param_1, auStack_24, uVar2);
    }
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00030a90(undefined4 param_1, int param_2)

{
    EVP_MD *md;
    int iVar1;
    size_t sVar2;
    char *__dest;
    ushort uVar3;
    uint uVar4;
    char *pcVar5;
    undefined *puVar6;
    undefined *puVar7;
    undefined4 *puVar8;
    char *pcVar9;
    char *__s;
    char *local_208;
    int local_204;
    char acStack_200[468];
    int local_2c[2];

    local_2c[0] = __stack_chk_guard;
    switch (param_1) {
    case 1:
        FUN_0002fdb0("config",
                     ((*(uint *)(param_2 + 0x44) ^ 2) << 0x1e) >> 0x1f);
        break;
    case 2:
        FUN_0002fdb0("authenable", *(int *)(param_2 + 0x7c) == 0);
        break;
    case 3:
        FUN_0002fdb0("authentic",
                     (uint)(*(int *)(param_2 + 0x44) << 0x1d) >> 0x1f);
        break;
    case 4:
        FUN_0002f3f0("srcadr", 0, param_2 + 0x10);
        break;
    case 5:
        FUN_0002fdb0("srcport", *(ushort *)(param_2 + 0x12) >> 8 |
                                    *(ushort *)(param_2 + 0x12) << 8);
        break;
    case 6:
        iVar1 = *(int *)(param_2 + 0x38);
        if (iVar1 != 0) {
            iVar1 = iVar1 + 0x18;
        }
        FUN_0002f3f0("dstadr", 0, iVar1);
        break;
    case 7:
        if (*(int *)(param_2 + 0x38) == 0) {
            uVar3 = 0;
        } else {
            uVar3 = *(ushort *)(*(int *)(param_2 + 0x38) + 0x1a);
            uVar3 = uVar3 >> 8 | uVar3 << 8;
        }
        FUN_0002fdb0("dstport", uVar3);
        break;
    case 8:
        FUN_0002fdb0(&DAT_000a55d4, *(undefined1 *)(param_2 + 0x5b));
        break;
    case 9:
        FUN_0002fdb0("hmode", *(undefined1 *)(param_2 + 0x3f));
        break;
    case 10:
        FUN_0002fdb0("stratum", *(undefined1 *)(param_2 + 0x5d));
        break;
    case 0xb:
        FUN_0002fdb0("ppoll", *(undefined1 *)(param_2 + 0x5e));
        break;
    case 0xc:
        FUN_0002fdb0("hpoll", *(undefined1 *)(param_2 + 0x40));
        break;
    case 0xd:
        FUN_0002fd0c("precision", (int)*(char *)(param_2 + 0x5f));
        break;
    case 0xe:
        FUN_0003034c(SUB84(*(double *)(param_2 + 0x60) * 1000.0, 0),
                     "rootdelay", 1, 3);
        break;
    case 0xf:
        FUN_0003034c(SUB84(*(double *)(param_2 + 0x68) * 1000.0, 0), "rootdisp",
                     1, 3);
        break;
    case 0x10:
        if (((*(uint *)(param_2 + 0x44) & 8) == 0) &&
            (*(byte *)(param_2 + 0x5d) - 2 < 0xe)) {
            FUN_0002f3f0("refid", *(undefined4 *)(param_2 + 0x70));
        } else {
            FUN_0002f474("refid", *(undefined4 *)(param_2 + 0x70));
        }
        break;
    case 0x11:
        FUN_0002ff38("reftime", param_2 + 0x74);
        break;
    case 0x12:
        FUN_0002ff38(&DAT_000a5620, param_2 + 0x248);
        break;
    case 0x13:
        FUN_0002ff38("rec", param_2 + 0x240);
        break;
    case 0x14:
        if (*(double *)(param_2 + 0x280) != 0.0) {
            FUN_0003034c(SUB84(*(double *)(param_2 + 0x280) * 1000.0, 0),
                         "xleave", 1, 3);
        }
        break;
    case 0x15:
        FUN_0002fc68("reach", *(undefined1 *)(param_2 + 0x12a));
        break;
    case 0x16:
        FUN_0002fdb0("unreach", *(undefined4 *)(param_2 + 0x2c4));
        break;
    case 0x17:
        FUN_0002fdb0("timer", *(int *)(param_2 + 0x2d0) - current_time);
        break;
    case 0x18:
        FUN_0003034c(SUB84(*(double *)(param_2 + 0x268) * 1000.0, 0), "delay",
                     1, 3);
        break;
    case 0x19:
        FUN_0003034c(SUB84(*(double *)(param_2 + 0x260) * 1000.0, 0), "offset",
                     1, 3);
        break;
    case 0x1a:
        FUN_0003034c(SUB84(*(double *)(param_2 + 0x270) * 1000.0, 0), "jitter",
                     1, 3);
        break;
    case 0x1b:
        FUN_0003034c(SUB84(*(double *)(param_2 + 0x278) * 1000.0, 0),
                     "dispersion", 1, 3);
        break;
    case 0x1c:
        if (*(uint *)(param_2 + 0x7c) < 0x10000) {
            FUN_0002fdb0("keyid");
        } else {
            FUN_0002fc68("keyid");
        }
        break;
    case 0x1d:
        FUN_00030888("filtdelay", param_2 + 0x148,
                     *(undefined4 *)(param_2 + 0x140));
        break;
    case 0x1e:
        FUN_00030888("filtoffset", param_2 + 0x188,
                     *(undefined4 *)(param_2 + 0x140));
        break;
    case 0x1f:
        FUN_0002fdb0("pmode", *(undefined1 *)(param_2 + 0x5c));
        break;
    case 0x20:
        FUN_0002fdb0("received", *(undefined4 *)(param_2 + 0x2e8));
        break;
    case 0x21:
        FUN_0002fdb0(&DAT_000a567c, *(undefined4 *)(param_2 + 0x2e4));
        break;
    case 0x22:
        FUN_00030888("filtdisp", param_2 + 0x1c8,
                     *(undefined4 *)(param_2 + 0x140));
        break;
    case 0x23:
        FUN_0002fc68("flash", *(undefined4 *)(param_2 + 300));
        break;
    case 0x24:
        if ((*(uint *)(param_2 + 0x44) & 8) == 0) {
            if (*(int *)(param_2 + 0x4c) - 1U < 7) {
                FUN_0002fd0c(
                    &DAT_0009dc38,
                    *(undefined1 *)((int)&sys_ttl + *(int *)(param_2 + 0x4c)));
            }
        } else {
            FUN_0002fdb0(&DAT_0009dc38, *(undefined4 *)(param_2 + 0x4c));
        }
        break;
    case 0x25:
        FUN_0007d00c(acStack_200, 0x1d4, &DAT_000a5534, "peer_var_list");
        sVar2 = strlen(acStack_200);
        puVar6 = &UNK_000c4f68;
        pcVar9 = acStack_200 + sVar2;
        pcVar5 = pcVar9;
        while (uVar3 = *(ushort *)(puVar6 + 10), puVar7 = puVar6,
               (uVar3 & 0x80) == 0) {
            while (puVar6 = puVar7 + 8, (uVar3 & 0x40) == 0) {
                __s = *(char **)(puVar7 + 0xc);
                sVar2 = strlen(__s);
                if (local_2c <= pcVar5 + sVar2 + 1)
                    goto LAB_00030f20;
                __dest = pcVar9;
                if (pcVar5 != pcVar9) {
                    *pcVar5 = ',';
                    __dest = pcVar5 + 1;
                }
                pcVar5 = __dest + sVar2;
                memcpy(__dest, __s, sVar2);
                uVar3 = *(ushort *)(puVar7 + 0x12);
                puVar7 = puVar6;
                if ((uVar3 & 0x80) != 0)
                    goto LAB_00030f20;
            }
        }
    LAB_00030f20:
        if (pcVar5 + 2 < local_2c) {
            *pcVar5 = '\"';
            pcVar5[1] = '\0';
            local_204 = (int)(pcVar5 + 1) - (int)acStack_200;
            local_208 = acStack_200;
            FUN_0002f104(&local_208, 1, 0);
        }
        break;
    case 0x26:
        if (0.0 < *(double *)(param_2 + 0x2a0)) {
            FUN_0003034c(SUB84(*(double *)(param_2 + 0x2a0) / 1000.0, 0),
                         &DAT_000a55c8, 1, 3);
        }
        break;
    case 0x27:
        if (0.0 < *(double *)(param_2 + 0x2b8)) {
            FUN_0003034c(SUB84(*(double *)(param_2 + 0x2b8) / 1000.0, 0), "out",
                         1, 3);
        }
        break;
    case 0x28:
        FUN_0002fdb0("headway", *(undefined4 *)(param_2 + 0x2c8));
        break;
    case 0x29:
        if (*(double *)(param_2 + 0x288) != 0.0) {
            FUN_0003034c(SUB84(*(double *)(param_2 + 0x288) * 1000.0, 0),
                         &DAT_000a5624, 1, 3);
        }
        break;
    case 0x2a:
        pcVar5 = *(char **)(param_2 + 0x2c);
        if (pcVar5 != (char *)0x0) {
            sVar2 = strlen(pcVar5);
            FUN_0002f528("srchost", pcVar5, sVar2);
        }
        break;
    case 0x2b:
        FUN_0002fdb0("timerec", current_time - *(int *)(param_2 + 0x2dc));
        break;
    case 0x2c:
        FUN_0002fdb0("timereach", current_time - *(int *)(param_2 + 0x2e0));
        break;
    case 0x2d:
        FUN_0002fdb0("badauth", *(undefined4 *)(param_2 + 0x2f0));
        break;
    case 0x2e:
        FUN_0002fdb0("bogusorg", *(undefined4 *)(param_2 + 0x2f8));
        break;
    case 0x2f:
        FUN_0002fdb0("oldpkt", *(undefined4 *)(param_2 + 0x2fc));
        break;
    case 0x30:
        FUN_0002fdb0("seldisp", *(undefined4 *)(param_2 + 0x300));
        break;
    case 0x31:
        FUN_0002fdb0("selbroken", *(undefined4 *)(param_2 + 0x304));
        break;
    case 0x32:
        FUN_0002fdb0("candidate", *(undefined1 *)(param_2 + 0x128));
        break;
    case 0x33:
        if (*(int *)(param_2 + 0x88) != 0) {
            FUN_0002fc68("flags");
        }
        break;
    case 0x34:
        pcVar5 = *(char **)(param_2 + 0x94);
        if (pcVar5 != (char *)0x0) {
            sVar2 = strlen(pcVar5);
            FUN_0002f528(&DAT_000a3bf0, pcVar5, sVar2);
        }
        break;
    case 0x35:
        break;
    case 0x36:
        puVar8 = *(undefined4 **)(param_2 + 0xdc);
        if (puVar8 != (undefined4 *)0x0) {
            FUN_0002fd0c("initsequence", puVar8[1]);
            FUN_0002fc68("initkey", *puVar8);
            uVar4 = *(uint *)(param_2 + 0xd0);
            FUN_0003099c("timestamp",
                         uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 |
                             (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18);
        }
        break;
    case 0x37:
        break;
    case 0x38:
        break;
    case 0x39:
        if (*(uint *)(param_2 + 0x88) != 0) {
            pcVar5 = OBJ_nid2sn(*(uint *)(param_2 + 0x88) >> 0x10);
            md = EVP_get_digestbyname(pcVar5);
            iVar1 = EVP_MD_pkey_type(md);
            pcVar5 = OBJ_nid2ln(iVar1);
            sVar2 = strlen(pcVar5);
            FUN_0002f528("signature", pcVar5, sVar2);
        }
        break;
    case 0x3a:
        pcVar5 = *(char **)(param_2 + 0x50);
        if (pcVar5 != (char *)0x0) {
            sVar2 = strlen(pcVar5);
            FUN_0002f528("ident", pcVar5, sVar2);
        }
    }
    if (local_2c[0] == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00031480(int param_1)

{
    ushort uVar1;
    bool bVar2;
    bool bVar3;
    int iVar4;
    undefined4 uVar5;
    int iVar6;
    char *pcVar7;
    size_t sVar8;
    EVP_MD *md;
    uint uVar9;
    undefined4 uVar10;
    uint uVar11;
    undefined1 uVar12;
    int *piVar13;
    char *pcVar14;
    undefined *puVar15;
    undefined *puVar16;
    char *pcVar17;
    undefined8 in_d0;
    undefined4 extraout_s1;
    undefined4 extraout_s1_00;
    double dVar18;
    undefined8 uVar19;
    int local_224;
    int local_220;
    char *local_218;
    int local_214;
    undefined1 auStack_210[16];
    char acStack_200[468];
    int local_2c[2];

    uVar10 = (undefined4)((ulonglong)in_d0 >> 0x20);
    local_2c[0] = __stack_chk_guard;
    if ((param_1 - 0x3bU < 0x10) && (current_time != DAT_000ca6cc)) {
        memset(&DAT_000ca6d0, 0, 0x80);
        iVar6 = adjtimex(&DAT_000ca6d0);
        if (iVar6 < 0) {
            FUN_00075d40(3, "ntp_adjtime() for mode 6 query failed: %m");
            uVar10 = extraout_s1_00;
        } else {
            DAT_000ca6cc = current_time;
            uVar10 = extraout_s1;
        }
    }
    uVar5 = hostval._12_4_;
    pcVar17 = sys_ident;
    pcVar7 = Version;
    switch (param_1) {
    case 1:
        FUN_0002fdb0(&DAT_000a55d4, sys_leap);
        break;
    case 2:
        FUN_0002fdb0("stratum", sys_stratum);
        break;
    case 3:
        FUN_0002fd0c("precision", (int)sys_precision);
        break;
    case 4:
        FUN_0003034c(SUB84(sys_rootdelay * 1000.0, 0), "rootdelay", 1, 3);
        break;
    case 5:
        FUN_0003034c(SUB84(sys_rootdisp * 1000.0, 0), "rootdisp", 1, 3);
        break;
    case 6:
        if (sys_stratum - 2 < 0xe) {
            FUN_0002f3f0("refid", sys_refid, 0);
        } else {
            FUN_0002f474("refid", sys_refid);
        }
        break;
    case 7:
        FUN_0002ff38("reftime", &sys_reftime);
        break;
    case 8:
        FUN_0002fdb0(&DAT_000a5734, sys_poll);
        break;
    case 9:
        if (sys_peer == 0) {
            FUN_0002fdb0("peer");
        } else {
            FUN_0002fdb0("peer", *(undefined2 *)(sys_peer + 0x3c));
        }
        break;
    case 10:
        FUN_0003034c(SUB84(last_offset * 1000.0, 0), "offset", 1, 6);
        break;
    case 0xb:
        FUN_0003034c(SUB84(drift_comp * 1000000.0, 0), "frequency", 1, 3);
        break;
    case 0xc:
        FUN_0003034c(SUB84(sys_jitter * 1000.0, 0), "sys_jitter", 1, 6);
        break;
    case 0xd:
        FUN_0003034c(SUB84(clock_jitter * 1000.0, 0), "clk_jitter", 1, 3);
        break;
    case 0xe:
        FUN_0007055c(&local_224);
        FUN_0002ff38("clock", &local_224);
        break;
    case 0xf:
        sVar8 = strlen(&DAT_000ca854);
        FUN_0002f528("processor", &DAT_000ca854, sVar8);
        break;
    case 0x10:
        FUN_0007d00c(acStack_200, 0x100, "%s/%s", &DAT_000ca750, &DAT_000ca7d2);
        sVar8 = strlen(acStack_200);
        FUN_0002f528("system", acStack_200, sVar8);
        break;
    case 0x11:
        sVar8 = strlen(Version);
        FUN_0002f528("version", pcVar7, sVar8);
        break;
    case 0x12:
        FUN_0003034c(SUB84(clock_stability * 1000000.0, 0), "clk_wander", 1, 3);
        break;
    case 0x13:
        FUN_0007d00c(acStack_200, 0x1d4, &DAT_000a5534, "sys_var_list");
        sVar8 = strlen(acStack_200);
        puVar15 = &UNK_000c5148;
        bVar3 = true;
        pcVar7 = acStack_200 + sVar8;
        while (uVar1 = *(ushort *)(puVar15 + 10), puVar16 = puVar15,
               (uVar1 & 0x80) == 0) {
            while (puVar15 = puVar16 + 8, (uVar1 & 0x40) == 0) {
                pcVar17 = *(char **)(puVar16 + 0xc);
                iVar6 = (int)local_2c - (int)pcVar7;
                sVar8 = strlen(pcVar17);
                iVar4 = DAT_000ca8d8;
                if (iVar6 <= (int)(sVar8 + 1))
                    goto joined_r0x00032630;
                pcVar14 = pcVar7;
                if (!bVar3) {
                    *pcVar7 = ',';
                    pcVar14 = pcVar7 + 1;
                }
                bVar3 = false;
                pcVar7 = pcVar14 + sVar8;
                memcpy(pcVar14, pcVar17, sVar8);
                uVar1 = *(ushort *)(puVar16 + 0x12);
                puVar16 = puVar15;
                if ((uVar1 & 0x80) != 0)
                    goto LAB_0003261c;
            }
        }
    LAB_0003261c:
        iVar6 = (int)local_2c - (int)pcVar7;
        iVar4 = DAT_000ca8d8;
    joined_r0x00032630:
        do {
            if ((iVar4 == 0) || ((*(ushort *)(iVar4 + 2) & 0x80) != 0))
                goto LAB_00032a38;
            bVar2 = bVar3;
            if (((*(ushort *)(iVar4 + 2) & 0x40) == 0) &&
                (pcVar17 = *(char **)(iVar4 + 4), pcVar17 != (char *)0x0)) {
                pcVar14 = strchr(pcVar17, 0x3d);
                if (pcVar14 == (char *)0x0) {
                    sVar8 = strlen(pcVar17);
                } else {
                    sVar8 = (int)pcVar14 - (int)pcVar17;
                }
                if (iVar6 <= (int)(sVar8 + 1))
                    goto LAB_00032a38;
                bVar2 = false;
                pcVar14 = pcVar7;
                if (bVar3) {
                    *pcVar7 = ',';
                    pcVar17 = *(char **)(iVar4 + 4);
                    pcVar14 = pcVar7 + 1;
                }
                pcVar7 = pcVar14 + sVar8;
                memcpy(pcVar14, pcVar17, sVar8);
                iVar6 = (int)local_2c - (int)pcVar7;
            }
            bVar3 = bVar2;
            iVar4 = iVar4 + 8;
        } while (true);
    case 0x14:
        if (sys_tai != 0) {
            FUN_0002fdb0(&DAT_000a57a8);
        }
        break;
    case 0x15:
        FUN_0003dfc4(&local_224);
        if (local_220 != 0) {
            FUN_0003099c("leapsec");
        }
        break;
    case 0x16:
        FUN_0003dfc4(&local_224);
        if (local_224 != 0) {
            FUN_0003099c("expire");
        }
        break;
    case 0x17:
        FUN_0002fdb0("mintc", ntp_minpoll);
        break;
    case 0x18:
        FUN_0002fc68("mru_enabled", mon_enabled);
        break;
    case 0x19:
        FUN_0002fdb0("mru_depth", mru_entries);
        break;
    case 0x1a:
        FUN_0002fdb0("mru_deepest", mru_peakentries);
        break;
    case 0x1b:
        FUN_0002fdb0("mru_mindepth", mru_mindepth);
        break;
    case 0x1c:
        FUN_0002fd0c("mru_maxage", mru_maxage);
        break;
    case 0x1d:
        FUN_0002fdb0("mru_maxdepth", mru_maxdepth);
        break;
    case 0x1e:
        dVar18 = (double)mru_entries * 0.0703125;
        uVar9 = (uint)(0.0 < dVar18) * (int)(longlong)dVar18;
        if (0.5 <= dVar18 - (double)uVar9) {
            uVar9 = uVar9 + 1;
        }
        FUN_0002fdb0("mru_mem", uVar9);
        break;
    case 0x1f:
        dVar18 = (double)mru_maxdepth * 0.0703125;
        uVar9 = (uint)(0.0 < dVar18) * (int)(longlong)dVar18;
        if (0.5 <= dVar18 - (double)uVar9) {
            uVar9 = uVar9 + 1;
        }
        FUN_0002fdb0("mru_maxmem", uVar9);
        break;
    case 0x20:
        FUN_0002fdb0("ss_uptime", current_time);
        break;
    case 0x21:
        FUN_0002fdb0("ss_reset", current_time - sys_stattime);
        break;
    case 0x22:
        FUN_0002fdb0("ss_received", sys_received);
        break;
    case 0x23:
        FUN_0002fdb0("ss_thisver", sys_newversion);
        break;
    case 0x24:
        FUN_0002fdb0("ss_oldver", sys_oldversion);
        break;
    case 0x25:
        FUN_0002fdb0("ss_badformat", sys_badlength);
        break;
    case 0x26:
        FUN_0002fdb0("ss_badauth", sys_badauth);
        break;
    case 0x27:
        FUN_0002fdb0("ss_declined", sys_declined);
        break;
    case 0x28:
        FUN_0002fdb0("ss_restricted", sys_restricted);
        break;
    case 0x29:
        FUN_0002fdb0("ss_limited", sys_limitrejected);
        break;
    case 0x2a:
        FUN_0002fdb0("ss_kodsent", sys_kodsent);
        break;
    case 0x2b:
        FUN_0002fdb0("ss_processed", sys_processed);
        break;
    case 0x2c:
        FUN_0002fdb0("ss_lamport", sys_lamport);
        break;
    case 0x2d:
        FUN_0002fdb0("ss_tsrounding", sys_tsrounding);
        break;
    case 0x2e:
        if (sys_peer == 0) {
            sVar8 = 9;
            pcVar7 = "0.0.0.0:0";
        } else if (*(int *)(sys_peer + 0x38) == 0) {
            sVar8 = 9;
            pcVar7 = "0.0.0.0:0";
        } else {
            pcVar7 = (char *)FUN_0007d454(sys_peer + 0x10);
            sVar8 = strlen(pcVar7);
        }
        FUN_0002f350("peeradr", pcVar7, sVar8);
        break;
    case 0x2f:
        if (sys_peer == 0) {
            uVar12 = 0;
        } else {
            uVar12 = *(undefined1 *)(sys_peer + 0x3f);
        }
        FUN_0002fdb0("peermode", uVar12);
        break;
    case 0x30:
        FUN_0003034c(SUB84(sys_bdelay * 1000.0, 0), "bcastdelay", 1, 3);
        break;
    case 0x31:
        uVar9 = -((int)(uint)sys_authdelay >> 0x1f);
        uVar11 = (int)(uint)sys_authdelay >> 0x1f ^ sys_authdelay._4_4_;
        dVar18 = (double)FUN_0009d40c(
            uVar11 + uVar9, (-(uint)(uVar9 != 0) ^ (uint)sys_authdelay) +
                                (uint)CARRY4(uVar11, uVar9));
        dVar18 = ldexp(dVar18, -0x20);
        if (uVar9 != 0) {
            dVar18 = -dVar18;
        }
        FUN_0003034c(SUB84(dVar18 * 1000.0, 0), "authdelay", 1, 3);
        break;
    case 0x32:
        FUN_0002fdb0("authkeys", authnumkeys);
        break;
    case 0x33:
        FUN_0002fdb0("authfreek", authnumfreekeys);
        break;
    case 0x34:
        FUN_0002fdb0("authklookups", authkeylookups);
        break;
    case 0x35:
        FUN_0002fdb0("authknotfound", authkeynotfound);
        break;
    case 0x36:
        FUN_0002fdb0("authkuncached", authkeyuncached);
        break;
    case 0x37:
        FUN_0002fdb0("authkexpired", authkeyexpired);
        break;
    case 0x38:
        FUN_0002fdb0("authencrypts", authencryptions);
        break;
    case 0x39:
        FUN_0002fdb0("authdecrypts", authdecryptions);
        break;
    case 0x3a:
        FUN_0002fdb0("authreset", current_time - auth_timereset);
        break;
    case 0x3b:
        FUN_0003034c(SUB84((double)(longlong)DAT_000ca6d4 * 1e-06, 0),
                     "koffset", 0, 0xffffffff);
        break;
    case 0x3c:
        uVar19 =
            FixedToFP(CONCAT44(uVar10, DAT_000ca6d8), 0x20, 0x40, 0x10, 0, 0);
        FUN_0003034c((int)uVar19, "kfreq", 0, 0xffffffff);
        break;
    case 0x3d:
        FUN_0003034c(SUB84((double)(longlong)DAT_000ca6dc * 0.001, 0),
                     "kmaxerr", 0, 6);
        break;
    case 0x3e:
        FUN_0003034c(SUB84((double)(longlong)DAT_000ca6e0 * 0.001, 0),
                     "kesterr", 0, 6);
        break;
    case 0x3f:
        pcVar7 = (char *)FUN_0007e0c8(DAT_000ca6e4);
        sVar8 = strlen(pcVar7);
        FUN_0002f528("kstflags", pcVar7, sVar8);
        break;
    case 0x40:
        FUN_0002fd0c("ktimeconst", DAT_000ca6e8);
        break;
    case 0x41:
        FUN_0003034c(SUB84((double)(longlong)DAT_000ca6ec * 0.001, 0),
                     "kprecis", 0, 6);
        break;
    case 0x42:
        uVar19 =
            FixedToFP(CONCAT44(uVar10, DAT_000ca6f0), 0x20, 0x40, 0x10, 0, 0);
        FUN_0003034c((int)uVar19, "kfreqtol", 0, 0xffffffff);
        break;
    case 0x43:
        if (DAT_000ca708 == 0) {
            FUN_0002fd0c("kppsfreq");
        } else {
            uVar19 = FixedToFP(CONCAT44(uVar10, DAT_000ca700), 0x20, 0x40, 0x10,
                               0, 0);
            FUN_0003034c((int)uVar19, "kppsfreq", 0, 0xffffffff);
        }
        break;
    case 0x44:
        if (DAT_000ca708 == 0) {
            FUN_0002fd0c("kppsstab");
        } else {
            uVar19 = FixedToFP(CONCAT44(uVar10, DAT_000ca70c), 0x20, 0x40, 0x10,
                               0, 0);
            FUN_0003034c((int)uVar19, "kppsstab", 0, 0xffffffff);
        }
        break;
    case 0x45:
        if (DAT_000ca708 == 0) {
            FUN_0002fd0c("kppsjitter");
        } else {
            FUN_0003034c(SUB84((double)(longlong)DAT_000ca704 * 1e-06, 0),
                         "kppsjitter", 1, 3);
        }
        break;
    case 0x46:
        if (DAT_000ca708 == 0) {
            FUN_0002fd0c("kppscalibdur");
        } else {
            FUN_0002fd0c("kppscalibdur", 1 << (DAT_000ca708 & 0xff));
        }
        break;
    case 0x47:
        if (DAT_000ca708 == 0) {
            FUN_0002fd0c("kppscalibs");
        } else {
            FUN_0002fd0c("kppscalibs", DAT_000ca714);
        }
        break;
    case 0x48:
        if (DAT_000ca708 == 0) {
            FUN_0002fd0c("kppscaliberrs");
        } else {
            FUN_0002fd0c("kppscaliberrs", DAT_000ca718);
        }
        break;
    case 0x49:
        if (DAT_000ca708 == 0) {
            FUN_0002fd0c("kppsjitexc");
        } else {
            FUN_0002fd0c("kppsjitexc", DAT_000ca710);
        }
        break;
    case 0x4a:
        if (DAT_000ca708 == 0) {
            FUN_0002fd0c("kppsstbexc");
        } else {
            FUN_0002fd0c("kppsstbexc", DAT_000ca71c);
        }
        break;
    case 0x4b:
        FUN_0002fdb0("iostats_reset", current_time - io_timereset);
        break;
    case 0x4c:
        uVar10 = FUN_0007ad80();
        FUN_0002fdb0("total_rbuf", uVar10);
        break;
    case 0x4d:
        uVar10 = FUN_0007acd8();
        FUN_0002fdb0("free_rbuf", uVar10);
        break;
    case 0x4e:
        uVar10 = FUN_0007ad2c();
        FUN_0002fdb0("used_rbuf", uVar10);
        break;
    case 0x4f:
        uVar10 = FUN_0007add4();
        FUN_0002fdb0("rbuf_lowater", uVar10);
        break;
    case 0x50:
        FUN_0002fdb0("io_dropped", packets_dropped);
        break;
    case 0x51:
        FUN_0002fdb0("io_ignored", packets_ignored);
        break;
    case 0x52:
        FUN_0002fdb0("io_received", packets_received);
        break;
    case 0x53:
        FUN_0002fdb0("io_sent", packets_sent);
        break;
    case 0x54:
        FUN_0002fdb0("io_sendfailed", packets_notsent);
        break;
    case 0x55:
        FUN_0002fdb0("io_wakeups", handler_calls);
        break;
    case 0x56:
        FUN_0002fdb0("io_goodwakeups", handler_pkts);
        break;
    case 0x57:
        FUN_0002fdb0("timerstats_reset", current_time - timer_timereset);
        break;
    case 0x58:
        FUN_0002fdb0("timer_overruns", alarm_overflow);
        break;
    case 0x59:
        FUN_0002fdb0("timer_xmts", timer_xmtcalls);
        break;
    case 0x5a:
        FUN_0003034c(SUB84(sys_fuzz * 1000.0, 0), &DAT_000a5afc, 1, 3);
        break;
    case 0x5b:
        FUN_0003034c(SUB84(wander_threshold * 1000000.0, 0),
                     "clk_wander_threshold", 1, 3);
        break;
    case 0x5c:
        break;
    case 0x5d:
        break;
    case 0x5e:
        if (crypto_flags != 0) {
            FUN_0002fc68("flags");
        }
        break;
    case 0x5f:
        if (hostval._12_4_ != 0) {
            sVar8 = strlen((char *)hostval._12_4_);
            FUN_0002f528(&DAT_000a3bf0, uVar5, sVar8);
        }
        break;
    case 0x60:
        if (hostval._0_4_ != 0) {
            FUN_0003099c("update",
                         hostval._0_4_ << 0x18 |
                             ((uint)hostval._0_4_ >> 8 & 0xff) << 0x10 |
                             ((uint)hostval._0_4_ >> 0x10 & 0xff) << 8 |
                             (uint)hostval._0_4_ >> 0x18);
        }
        break;
    case 0x61:
        if (cinfo != (int *)0x0) {
            piVar13 = cinfo;
            do {
                FUN_0007d00c(acStack_200, 0x100, "%s %s 0x%x", piVar13[0xc],
                             piVar13[0xd], piVar13[1]);
                sVar8 = strlen(acStack_200);
                FUN_0002f528(&DAT_000a5b28, acStack_200, sVar8);
                uVar9 = FUN_0007d00c(auStack_210, 0x10, "%04d%02d%02d%02d%02d",
                                     *(undefined2 *)((int)piVar13 + 0x26),
                                     *(undefined1 *)((int)piVar13 + 0x2a),
                                     *(undefined1 *)((int)piVar13 + 0x2b),
                                     (char)piVar13[0xb],
                                     *(undefined1 *)((int)piVar13 + 0x2d));
                if (0xf < uVar9) {
                    /* WARNING: Subroutine does not return */
                    FUN_0007fc54("ntp_control.c", 0x6a9, 2,
                                 "rc >= 0 && (size_t)rc < sizeof(buffer)");
                }
                FUN_0002f350("until", auStack_210, uVar9);
                piVar13 = (int *)*piVar13;
            } while (piVar13 != (int *)0x0);
        }
        break;
    case 0x62:
        if (crypto_flags != 0) {
            pcVar7 = OBJ_nid2sn(crypto_flags >> 0x10);
            md = EVP_get_digestbyname(pcVar7);
            iVar6 = EVP_MD_pkey_type(md);
            pcVar7 = OBJ_nid2ln(iVar6);
            FUN_0007e4b4(acStack_200, pcVar7, 0x100);
            sVar8 = strlen(acStack_200);
            FUN_0002f528("signature", acStack_200, sVar8);
        }
        break;
    case 99:
        break;
    case 100:
        if (sys_ident != (char *)0x0) {
            sVar8 = strlen(sys_ident);
            FUN_0002f528("ident", pcVar17, sVar8);
        }
        break;
    case 0x65:
        if (crypto_flags != 0) {
            pcVar7 = OBJ_nid2ln(crypto_nid);
            FUN_0007e4b4(acStack_200, pcVar7, 0x100);
            sVar8 = strlen(acStack_200);
            FUN_0002f528("digest", acStack_200, sVar8);
        }
    }
switchD_00031504_default:
    if (local_2c[0] == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
LAB_00032a38:
    if (2 < iVar6) {
        *pcVar7 = '\"';
        pcVar7[1] = '\0';
        local_214 = (int)(pcVar7 + 1) - (int)acStack_200;
        local_218 = acStack_200;
        FUN_0002f104(&local_218, 1, 0);
    }
    goto switchD_00031504_default;
}

/* WARNING: Removing unreachable block (ram,0x000333e0) */

void FUN_00033338(byte *param_1)

{
    uint uVar1;
    uint uVar2;

    if ((param_1 != (byte *)0x0) && (uVar2 = (uint)*param_1, uVar2 != 0)) {
        uVar1 = 1;
        while (uVar2 != 0) {
            if (7 < uVar2 >> 4) {
                return;
            }
            if ((uVar1 & *(uint *)(&DAT_000a5100 + (uVar2 >> 4) * 4) >>
                             ((uVar2 & 0xf) << 1)) == 0) {
                return;
            }
            param_1 = param_1 + 1;
            uVar1 = 2;
            uVar2 = (uint)*param_1;
        }
    }
    return;
}

void FUN_00033348(byte *param_1, undefined4 param_2, int param_3, int param_4)

{
    uint uVar1;
    byte *pbVar2;
    bool in_ZR;

    pbVar2 = param_1;
    if ((!in_ZR) && (pbVar2 = (byte *)(uint)*param_1, pbVar2 != (byte *)0x0)) {
        uVar1 = 1;
        while (pbVar2 != (byte *)0x0) {
            if (7 < (uint)pbVar2 >> 4) {
                pbVar2 = (byte *)0x0;
                goto LAB_000333b8;
            }
            pbVar2 = (byte *)(uVar1 & *(uint *)(&DAT_000a5100 +
                                                ((uint)pbVar2 >> 4) * 4) >>
                                          (((uint)pbVar2 & 0xf) << 1));
            if (pbVar2 == (byte *)0x0)
                goto LAB_000333b8;
            param_1 = param_1 + 1;
            uVar1 = 2;
            pbVar2 = (byte *)(uint)*param_1;
        }
        pbVar2 = (byte *)0x1;
    }
LAB_000333b8:
    if (**(int **)(param_4 + param_3) != **(int **)(param_4 + param_3)) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(pbVar2);
    }
    return;
}

void FUN_000333f0(int param_1, undefined4 param_2)

{
    byte bVar1;
    short sVar2;
    int iVar3;
    int iVar4;
    ushort *puVar5;
    ushort uVar6;
    uint uVar7;
    int iVar8;
    uint uVar9;
    bool bVar11;
    uint uVar10;

    iVar3 = __stack_chk_guard;
    uVar7 = *(uint *)(param_1 + 0x54);
    DAT_000ca494 = param_1 + 4;
    DAT_000ca6b4 = *(undefined4 *)(param_1 + 0x3c);
    numctlreq = numctlreq + 1;
    if ((int)uVar7 < 0xc) {
        uVar6 = (ushort) * (byte *)(param_1 + 0x59);
        sVar2 = *(short *)(param_1 + 0x60);
        numctltooshort = numctltooshort + 1;
    LAB_0003346c:
        if ((uVar6 & 0x80) != 0) {
            numctlinputresp = numctlinputresp + 1;
        }
        if ((uVar6 & 0x20) != 0) {
            numctlinputfrag = numctlinputfrag + 1;
        }
        if ((uVar6 & 0x40) != 0) {
            numctlinputerr = numctlinputerr + 1;
        }
        if (sVar2 != 0) {
            numctlbadoffset = numctlbadoffset + 1;
        }
    } else {
        bVar1 = *(byte *)(param_1 + 0x59);
        uVar6 = (ushort)bVar1;
        sVar2 = *(short *)(param_1 + 0x60);
        if (((bVar1 & 0xe0) != 0) || (sVar2 != 0))
            goto LAB_0003346c;
        uVar9 = (uint) * (byte *)(param_1 + 0x58) << 0x1a;
        uVar10 = uVar9 >> 0x1d;
        DAT_000ca8dc = (byte)(uVar9 >> 0x1d);
        if (uVar10 - 1 < 4) {
            DAT_000ca6a8 = 0;
            uVar9 = (uint)(*(ushort *)(param_1 + 0x62) >> 8) |
                    (*(ushort *)(param_1 + 0x62) & 0xff) << 8;
            DAT_000ca49e = *(undefined2 *)(param_1 + 0x5a);
            DAT_000ca4a2 = *(ushort *)(param_1 + 0x5e);
            DAT_000ca6ac = 0;
            DAT_000ca6ad = 0;
            DAT_000ca49c = sys_leap << 6 | 6U | (byte)(uVar10 << 3);
            DAT_000ca6b0 = 0;
            DAT_000ca8dd = '\0';
            DAT_000ca6a0 = 0;
            DAT_000ca6c0 = 0;
            DAT_000ca6bc = 0;
            DAT_000ca6c8 = DAT_000ca4a2 >> 8 | DAT_000ca4a2 << 8;
            DAT_000ca498 = &DAT_000ca4a8;
            DAT_000ca6b8 = 1;
            DAT_000ca6c4 = &DAT_000ca67c;
            DAT_000ca4a0 = sVar2;
            DAT_000ca6a4 = bVar1;
            if (((int)uVar9 <= (int)(uVar7 - 0xc)) && ((uVar7 & 3) == 0)) {
                uVar10 = uVar9 + 0x13 & 0xfffffff8;
                iVar8 = uVar7 - uVar10;
                if ((iVar8 - 4U < 0x15) && (sys_authenticate != 0)) {
                    DAT_000ca6ad = 1;
                    uVar7 = *(uint *)(param_1 + 0x58 + uVar10);
                    DAT_000ca6b0 = uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 |
                                   (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18;
                    iVar4 = FUN_000732ac();
                    if (iVar4 == 0) {
                        uVar6 = (ushort)DAT_000ca6a4;
                    } else {
                        iVar8 = FUN_00073770(DAT_000ca6b0, param_1 + 0x58,
                                             *(int *)(param_1 + 0x54) - iVar8,
                                             iVar8);
                        if (iVar8 == 0) {
                            DAT_000ca6b0 = 0;
                            uVar6 = (ushort)DAT_000ca6a4;
                        } else {
                            DAT_000ca8dd = '\x01';
                            uVar6 = (ushort)DAT_000ca6a4;
                        }
                    }
                }
                DAT_000ca408 = param_1 + 100;
                DAT_000ca40c = DAT_000ca408 + uVar9;
                if (uVar6 == 0) {
                    puVar5 = (ushort *)&UNK_000c5480;
                } else {
                    puVar5 = (ushort *)&UNK_000c5480;
                    do {
                        puVar5 = puVar5 + 4;
                        if (*puVar5 == 0xffff) {
                            bVar11 = iVar3 == __stack_chk_guard;
                            if (bVar11) {
                                iVar3 = 3;
                            }
                            numctlbadop = numctlbadop + 1;
                            if (!bVar11)
                                goto LAB_00033704;
                            goto LAB_00033638;
                        }
                    } while (*puVar5 != uVar6);
                }
                if ((puVar5[1] == 1) && ((DAT_000ca8dd == '\0' ||
                                          (DAT_000ca6b0 != ctl_auth_keyid)))) {
                    if (iVar3 == __stack_chk_guard) {
                        iVar3 = 1;
                    LAB_00033638:
                        FUN_0002f734(iVar3);
                        return;
                    }
                } else if (iVar3 == __stack_chk_guard) {
                    /* WARNING: Could not recover jumptable at 0x0003372c. Too
                     * many branches */
                    /* WARNING: Treating indirect jump as call */
                    (**(code **)(puVar5 + 2))(param_1, param_2);
                    return;
                }
                goto LAB_00033704;
            }
            FUN_0002f734(2);
            numctldatatooshort = numctldatatooshort + 1;
        } else {
            numctlbadversion = numctlbadversion + 1;
        }
    }
    if (iVar3 == __stack_chk_guard) {
        return;
    }
LAB_00033704:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00033890) */

void FUN_000337f8(void)

{
    return;
}

/* WARNING: Removing unreachable block (ram,0x00033958) */

void FUN_0003389c(void)

{
    return;
}

void FUN_000340bc(undefined4 *param_1, undefined4 param_2, int param_3,
                  undefined1 param_4)

{
    byte bVar1;
    uint uVar2;
    int iVar3;
    int iVar4;
    undefined4 uVar5;
    undefined4 uVar6;
    undefined1 uVar7;
    undefined4 uVar8;
    undefined1 *puVar9;
    undefined4 *puVar10;
    undefined4 *puVar11;

    iVar3 = __stack_chk_guard;
    iVar4 = FUN_0002e948();
    uVar2 = current_time;
    if (iVar4 == 0) {
        puVar9 = ctl_traps;
        iVar4 = 0;
        puVar10 = (undefined4 *)0x0;
        do {
            puVar11 = (undefined4 *)puVar9;
            if (((ctl_traps[iVar4 * 0x34 + 0x32] & 5) == 1) &&
                (uVar2 < *(int *)((int)puVar9 + 0x20) + 0xe10U)) {
                num_ctl_traps = num_ctl_traps + -1;
                *(undefined1 *)((int)puVar9 + 0x32) = 0;
            } else {
                bVar1 = *(byte *)((int)puVar9 + 0x32);
                if (((bVar1 & 1) != 0) &&
                    (puVar11 = puVar10, (bVar1 & 4) == 0)) {
                    if (param_3 == 0) {
                        puVar11 = (undefined4 *)puVar9;
                        if (puVar10 != (undefined4 *)0x0) {
                            if ((*(byte *)((int)puVar10 + 0x32) & 2) != 0) {
                                bVar1 = bVar1 & 2;
                                goto joined_r0x000342fc;
                            }
                            if ((bVar1 & 2) == 0)
                                goto LAB_000342e4;
                        }
                    } else if (((param_3 == 1) && ((bVar1 & 2) != 0)) &&
                               (puVar11 = (undefined4 *)puVar9,
                                puVar10 != (undefined4 *)0x0)) {
                        bVar1 = *(byte *)((int)puVar10 + 0x32) & 1;
                    joined_r0x000342fc:
                        puVar11 = puVar10;
                        if (bVar1 != 0) {
                        LAB_000342e4:
                            puVar11 = puVar10;
                            if ((uint)puVar10[10] <
                                *(uint *)((int)puVar9 + 0x28)) {
                                puVar11 = (undefined4 *)puVar9;
                            }
                        }
                    }
                }
            }
            iVar4 = iVar4 + 1;
            puVar9 = (undefined1 *)((int)puVar9 + 0x34);
            puVar10 = puVar11;
        } while (iVar4 != 3);
        if (puVar11 == (undefined4 *)0x0) {
            uVar5 = 0;
        } else {
            *(undefined2 *)(puVar11 + 0xc) = 1;
            uVar2 = current_time;
            puVar11[0xb] = 0;
            puVar11[9] = 0;
            puVar11[10] = uVar2;
            puVar11[8] = uVar2;
            uVar5 = param_1[1];
            uVar6 = param_1[2];
            uVar8 = param_1[3];
            *puVar11 = *param_1;
            puVar11[1] = uVar5;
            puVar11[2] = uVar6;
            puVar11[3] = uVar8;
            if (param_3 == 0) {
                uVar8 = 5;
            }
            uVar5 = param_1[5];
            uVar6 = param_1[6];
            puVar11[4] = param_1[4];
            puVar11[5] = uVar5;
            puVar11[6] = uVar6;
            puVar11[7] = param_2;
            *(undefined1 *)((int)puVar11 + 0x33) = param_4;
            if (param_3 == 0) {
                *(char *)((int)puVar11 + 0x32) = (char)uVar8;
            } else {
                if (param_3 == 2) {
                    uVar7 = 3;
                } else {
                    uVar7 = 1;
                }
                *(undefined1 *)((int)puVar11 + 0x32) = uVar7;
            }
            uVar5 = 1;
            num_ctl_traps = num_ctl_traps + 1;
        }
        goto LAB_00034134;
    }
    if (param_3 == 1) {
        if ((*(byte *)(iVar4 + 0x32) & 4) != 0) {
        LAB_00034174:
            uVar5 = 1;
            goto LAB_00034134;
        }
        *(undefined1 *)(iVar4 + 0x32) = 1;
    } else if (param_3 == 2) {
        if ((*(byte *)(iVar4 + 0x32) & 4) != 0)
            goto LAB_00034174;
        *(undefined1 *)(iVar4 + 0x32) = 3;
    } else if (param_3 == 0) {
        *(undefined1 *)(iVar4 + 0x32) = 5;
    }
    uVar5 = 1;
    *(int *)(iVar4 + 0x2c) = *(int *)(iVar4 + 0x2c) + 1;
    *(uint *)(iVar4 + 0x20) = current_time;
LAB_00034134:
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar5);
    }
    return;
}

void FUN_000343d4(undefined4 param_1, undefined4 param_2, int param_3)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    uint uVar4;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_0002e948();
    if (iVar2 != 0) {
        uVar4 = ((uint) * (byte *)(iVar2 + 0x32) << 0x1d) >> 0x1f;
        if (param_3 == 0) {
            uVar4 = 0;
        }
        if (uVar4 == 0) {
            uVar3 = 1;
            *(undefined1 *)(iVar2 + 0x32) = 0;
            num_ctl_traps = num_ctl_traps + -1;
            goto LAB_0003443c;
        }
    }
    uVar3 = 0;
LAB_0003443c:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

/* WARNING: Removing unreachable block (ram,0x000345dc) */

void FUN_000344e0(void)

{
    ctltimereset = current_time;
    numctlreq = 0;
    numctlbadpkts = 0;
    numctlresponses = 0;
    numctlfrags = 0;
    numctlerrors = 0;
    numctltooshort = 0;
    numctlinputresp = 0;
    numctlinputfrag = 0;
    numctlinputerr = 0;
    numctlbadoffset = 0;
    numctlbadversion = 0;
    numctldatatooshort = 0;
    numctlbadop = 0;
    numasyncmsgs = 0;
    return;
}

void FUN_00034628(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    uname((utsname *)&DAT_000ca750);
    FUN_000344e0();
    DAT_000ca8de = 0;
    DAT_000ca8df = 0;
    ctl_auth_keyid = 0;
    num_ctl_traps = 0;
    ctl_traps[0x32] = 0;
    ctl_traps[0x66] = 0;
    ctl_traps[0x9a] = 0;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000346c8(int *param_1, undefined4 param_2, undefined2 param_3)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int iVar4;
    undefined4 uVar5;
    int iVar6;
    int iVar7;

    iVar1 = __stack_chk_guard;
    iVar7 = *param_1;
    iVar3 = FUN_0002fbb8(iVar7);
    iVar4 = FUN_00074b04(iVar7, (iVar3 + 2) * 8, 0);
    *param_1 = iVar4;
    uVar5 = FUN_00074b04(0, param_2, 0);
    iVar2 = __stack_chk_guard;
    iVar7 = iVar3 * 8;
    iVar6 = iVar4 + iVar7 + 8;
    *(short *)(iVar4 + iVar7) = (short)iVar3;
    *(undefined2 *)(iVar4 + iVar7 + 2) = param_3;
    *(undefined4 *)(iVar4 + iVar7 + 4) = uVar5;
    *(undefined2 *)(iVar4 + iVar7 + 8) = 0;
    *(undefined4 *)(iVar6 + 4) = 0;
    *(undefined2 *)(iVar6 + 2) = 0x80;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003478c(int *param_1, char *param_2, size_t param_3,
                  undefined4 param_4)

{
    char cVar1;
    ushort uVar2;
    int iVar3;
    void *pvVar4;
    char *pcVar5;
    char *pcVar6;
    int iVar7;
    char *pcVar8;

    iVar3 = __stack_chk_guard;
    if (param_3 == 0 || param_2 == (char *)0x0) {
    LAB_000348a4:
        if (iVar3 == __stack_chk_guard) {
            return;
        }
    } else {
        iVar7 = *param_1;
        if (iVar7 != 0) {
            uVar2 = *(ushort *)(iVar7 + 2);
            while ((uVar2 & 0x80) == 0) {
                pcVar8 = *(char **)(iVar7 + 4);
                if (pcVar8 == (char *)0x0) {
                    pcVar8 = (char *)0x0;
                LAB_0003488c:
                    pvVar4 = (void *)FUN_00074b04(pcVar8, param_3, 0);
                    pvVar4 = memcpy(pvVar4, param_2, param_3);
                    *(short *)(iVar7 + 2) = (short)param_4;
                    *(void **)(iVar7 + 4) = pvVar4;
                    goto LAB_000348a4;
                }
                pcVar6 = param_2;
                if (*pcVar8 == '=') {
                LAB_00034830:
                    if (*pcVar6 == '=')
                        goto LAB_0003488c;
                } else if (*param_2 == *pcVar8) {
                    pcVar6 = param_2 + 1;
                    pcVar5 = pcVar8;
                    do {
                        pcVar5 = pcVar5 + 1;
                        if (*pcVar5 == '=')
                            goto LAB_00034830;
                        cVar1 = *pcVar6;
                        pcVar6 = pcVar6 + 1;
                    } while (cVar1 == *pcVar5);
                }
                uVar2 = *(ushort *)(iVar7 + 10);
                iVar7 = iVar7 + 8;
            }
        }
        pvVar4 = (void *)FUN_000346c8(param_1, param_3, param_4);
        if (iVar3 == __stack_chk_guard) {
            memcpy(pvVar4, param_2, param_3);
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x0003493c) */

void FUN_000348e4(undefined4 param_1, undefined4 param_2, undefined4 param_3)

{
    FUN_0003478c(&DAT_000ca8d8, param_1, param_2, param_3);
    return;
}

void FUN_0003494c(int param_1, uint param_2)

{
    void *pvVar1;
    void *pvVar2;
    tm *__tp;
    size_t sVar3;
    int iVar4;
    char *pcVar5;
    undefined4 uVar6;
    FILE *__stream;
    int *piVar7;
    uint uVar8;
    time_t tStack_3c0;
    char *local_3bc;
    size_t local_3b8;
    char acStack_3b4[128];
    char acStack_334[128];
    char acStack_2b4[144];
    char acStack_224[512];
    int local_24;

    pvVar1 = DAT_000ca408;
    local_24 = __stack_chk_guard;
    if ((param_2 & 0x100) == 0) {
        if (saveconfigdir == 0) {
            FUN_0002f604("%s",
                         "saveconfig prohibited, no saveconfigdir configured");
            FUN_0002edd4(0);
            if ((ntp_syslogmask & 1) != 0) {
                uVar6 = FUN_0007d2c0(param_1 + 4);
                FUN_00075d40(5, "saveconfig from %s rejected, no saveconfigdir",
                             uVar6);
            }
        } else {
            uVar8 = DAT_000ca40c - (int)DAT_000ca408;
            if ((uVar8 != 0) &&
                ((pvVar2 = memchr(DAT_000ca408, 0, uVar8),
                  pvVar2 == (void *)0x0 ||
                      (uVar8 = (int)pvVar2 - (int)pvVar1, uVar8 != 0)))) {
                if (uVar8 < 0x80) {
                    __memcpy_chk(acStack_3b4, pvVar1, uVar8, 0x80);
                    acStack_3b4[uVar8] = '\0';
                    time(&tStack_3c0);
                    __tp = localtime(&tStack_3c0);
                    sVar3 = strftime(acStack_334, 0x80, acStack_3b4, __tp);
                    if (sVar3 == 0) {
                        FUN_0007e4b4(acStack_334, acStack_3b4, 0x80);
                    }
                    iVar4 = FUN_00033338(acStack_334);
                    if (iVar4 == 0) {
                        FUN_0002f604(
                            "saveconfig rejects unsafe file name \'%s\'",
                            acStack_334);
                        FUN_0002edd4(0);
                        uVar6 = FUN_0007d2c0(param_1 + 4);
                        FUN_00075d40(
                            5, "saveconfig rejects unsafe file name from %s",
                            uVar6);
                    } else {
                        pcVar5 = strpbrk(acStack_334, "\\/");
                        if (pcVar5 == (char *)0x0) {
                            uVar8 = FUN_0007d00c(acStack_224, 0x200, "%s%s",
                                                 saveconfigdir, acStack_334);
                            if (uVar8 < 0x200) {
                                iVar4 = open64(acStack_224, 0x2c1, 0x180);
                                if ((iVar4 == -1) ||
                                    (__stream = fdopen(iVar4, "w"),
                                     __stream == (FILE *)0x0)) {
                                    piVar7 = __errno_location();
                                    pcVar5 = strerror(*piVar7);
                                    FUN_0002f604("Unable to save configuration "
                                                 "to file \'%s\': %s",
                                                 acStack_334, pcVar5);
                                    uVar6 = FUN_0007d2c0(param_1 + 4);
                                    FUN_00075d40(3,
                                                 "saveconfig %s from %s failed",
                                                 acStack_334, uVar6);
                                } else {
                                    iVar4 = FUN_0001ee5c(__stream, 1);
                                    if (iVar4 == -1) {
                                        piVar7 = __errno_location();
                                        pcVar5 = strerror(*piVar7);
                                        FUN_0002f604(
                                            "Unable to save configuration to "
                                            "file \'%s\': %s",
                                            acStack_334, pcVar5);
                                        uVar6 = FUN_0007d2c0(param_1 + 4);
                                        FUN_00075d40(
                                            3, "saveconfig %s from %s failed",
                                            acStack_334, uVar6);
                                    } else {
                                        FUN_0002f604(
                                            "Configuration saved to \'%s\'",
                                            acStack_334);
                                        uVar6 = FUN_0007d2c0(param_1 + 4);
                                        FUN_00075d40(5,
                                                     "Configuration saved to "
                                                     "\'%s\' (requested by %s)",
                                                     acStack_224, uVar6);
                                        FUN_0007d00c(
                                            acStack_2b4, 0x8d, "%s%s",
                                            "savedconfig=", acStack_334);
                                        sVar3 = strlen(acStack_2b4);
                                        FUN_000348e4(acStack_2b4, sVar3 + 1);
                                    }
                                    fclose(__stream);
                                }
                                FUN_0002edd4(0);
                            } else {
                                FUN_0002f604("saveconfig exceeded maximum path "
                                             "length (%u)",
                                             0x200);
                                FUN_0002edd4(0);
                                uVar6 = FUN_0007d2c0(param_1 + 4);
                                FUN_00075d40(5,
                                             "saveconfig exceeded maximum path "
                                             "length from %s",
                                             uVar6);
                            }
                        } else {
                            FUN_0007d00c(acStack_224, 0x80,
                                         "saveconfig does not allow directory "
                                         "in filename");
                            local_3b8 = strlen(acStack_224);
                            local_3bc = acStack_224;
                            FUN_0002f104(&local_3bc, 1, 0);
                            FUN_0002edd4(0);
                            uVar6 = FUN_0007d2c0(param_1 + 4);
                            FUN_00075d40(
                                5,
                                "saveconfig rejects unsafe file name from %s",
                                uVar6);
                        }
                    }
                } else {
                    FUN_0002f604(
                        "saveconfig exceeded maximum raw name length (%u)",
                        0x80);
                    FUN_0002edd4(0);
                    uVar6 = FUN_0007d2c0(param_1 + 4);
                    FUN_00075d40(
                        5,
                        "saveconfig exceeded maximum raw name length from %s",
                        uVar6);
                }
            }
        }
    } else {
        FUN_0002f604("%s", "saveconfig prohibited by restrict ... nomodify");
        FUN_0002edd4(0);
        if ((ntp_syslogmask & 1) != 0) {
            uVar6 = FUN_0007d2c0(param_1 + 4);
            FUN_00075d40(
                5, "saveconfig from %s rejected due to nomodify restriction",
                uVar6);
        }
        sys_restricted = sys_restricted + 1;
    }
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00035034(char *param_1)

{
    ushort uVar1;
    int iVar2;
    int iVar3;
    size_t __n;
    int iVar4;
    undefined *puVar5;
    void *__s2;

    iVar3 = __stack_chk_guard;
    __n = strlen(param_1);
    uVar1 = *(ushort *)(DAT_000ca8d8 + 2);
    iVar2 = DAT_000ca8d8;
    do {
        if ((uVar1 & 0x80) != 0) {
            puVar5 = (undefined *)0x0;
        LAB_000350c4:
            if (iVar3 != __stack_chk_guard) {
                /* WARNING: Subroutine does not return */
                __stack_chk_fail(puVar5);
            }
            return;
        }
        __s2 = *(void **)(iVar2 + 4);
        if ((__s2 != (void *)0x0) &&
            (iVar4 = memcmp(param_1, __s2, __n), iVar4 == 0)) {
            if (*(char *)((int)__s2 + __n) == '=') {
                puVar5 = (undefined *)((int)__s2 + __n + 1);
                goto LAB_000350c4;
            }
            if (*(char *)((int)__s2 + __n) == '\0') {
                puVar5 = &DAT_000a9528;
                goto LAB_000350c4;
            }
        }
        uVar1 = *(ushort *)(iVar2 + 10);
        iVar2 = iVar2 + 8;
    } while (true);
}

void FUN_00035108(void *param_1)

{
    ushort uVar1;
    void *pvVar2;
    int iVar3;

    iVar3 = __stack_chk_guard;
    if (param_1 == (void *)0x0) {
        return;
    }
    uVar1 = *(ushort *)((int)param_1 + 2);
    pvVar2 = param_1;
    while ((uVar1 & 0x80) == 0) {
        free(*(void **)((int)pvVar2 + 4));
        uVar1 = *(ushort *)((int)pvVar2 + 10);
        pvVar2 = (void *)((int)pvVar2 + 8);
    }
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    free(param_1);
    return;
}

/* WARNING: Type propagation algorithm not settling */
/* WARNING: Restarted to delay deadcode elimination for space: stack */

void FUN_0003519c(int param_1, uint param_2)

{
    short sVar1;
    size_t sVar2;
    int iVar3;
    undefined4 uVar4;
    uint uVar5;
    uint uVar6;
    ushort *puVar7;
    uint uVar8;
    int iVar9;
    char *__s2;
    undefined4 *puVar10;
    undefined4 *puVar11;
    int *__s2_00;
    char *pcVar12;
    int *piVar13;
    bool bVar14;
    int local_3ac;
    uint local_3a4;
    ushort local_38a;
    ushort local_388;
    ushort local_386;
    uint local_384;
    int local_380;
    uint local_37c;
    int local_378;
    int local_374;
    uint local_370;
    byte *local_36c;
    int local_368;
    int local_364;
    int local_360;
    uint local_35c;
    uint local_358;
    undefined1 auStack_354[28];
    int local_338[32];
    short local_2b8[2];
    int local_2b4[111];
    undefined4 local_f8;
    undefined2 local_f4;
    undefined4 local_f0;
    undefined2 local_ec;
    undefined4 local_e8;
    undefined2 local_e4;
    undefined4 local_e0;
    undefined2 local_dc;
    char local_d8[4];
    char acStack_d4[4];
    undefined1 local_d0;
    undefined1 auStack_cc[32];
    char acStack_ac[128];
    int local_2c;

    local_2c = __stack_chk_guard;
    if ((param_2 & 0x4000) == 0) {
        local_370 = param_2 & 0x4000;
        FUN_0003478c(&local_370, "nonce", 6, 0);
        FUN_0003478c(&local_370, "frags", 6, 0);
        FUN_0003478c(&local_370, "limit", 6, 0);
        FUN_0003478c(&local_370, "mincount", 9, 0);
        FUN_0003478c(&local_370, "resall", 7, 0);
        FUN_0003478c(&local_370, "resany", 7, 0);
        FUN_0003478c(&local_370, "maxlstint", 10, 0);
        FUN_0003478c(&local_370, "laddr", 6, 0);
        iVar3 = 0;
        do {
            FUN_0007d00c(acStack_ac, 0x80, "last.%d", iVar3);
            sVar2 = strlen(acStack_ac);
            FUN_0003478c(&local_370, acStack_ac, sVar2 + 1, 0);
            iVar9 = iVar3 + 1;
            FUN_0007d00c(acStack_ac, 0x80, "addr.%d", iVar3);
            sVar2 = strlen(acStack_ac);
            FUN_0003478c(&local_370, acStack_ac, sVar2 + 1, 0);
            iVar3 = iVar9;
        } while (iVar9 != 0x10);
        local_386 = 0;
        pcVar12 = (char *)0x0;
        local_38a = 0;
        local_3a4 = 0;
        local_384 = 0;
        local_380 = 0;
        local_3ac = 0;
        local_388 = 0;
        local_37c = 0;
        memset(local_338, 0, 0x80);
        memset(local_2b8, 0, 0x1c0);
    LAB_000353e8:
        iVar3 = FUN_0002ea58(local_370, &local_36c);
        if ((iVar3 == 0) || ((*(ushort *)(iVar3 + 2) & 0x80) != 0)) {
            FUN_00035108(local_370);
            local_370 = 0;
            if (pcVar12 == (char *)0x0)
                goto LAB_000351fc;
            iVar3 = sscanf(pcVar12, "%08x%08x%08x", &local_368, &local_364,
                           &local_360);
            if (iVar3 == 3) {
                iVar3 = FUN_0002e740(param_1 + 4, local_368, local_364);
                FUN_0007055c(&local_35c);
                local_35c = local_35c - local_368;
                uVar8 = local_358 - local_364;
                if (local_358 < uVar8) {
                    local_35c = local_35c - 1;
                }
                bVar14 = local_35c == 0xf;
                if (local_35c < 0x10) {
                    bVar14 = iVar3 == local_360;
                }
                local_358 = uVar8;
                if (bVar14) {
                    free(pcVar12);
                    if (local_38a == 0) {
                        if (0xff < local_384 - 1) {
                        LAB_00035d8c:
                            FUN_0002f734(6);
                            goto LAB_000351fc;
                        }
                        local_38a = 0x80;
                    } else {
                        if (0x80 < local_38a)
                            goto LAB_00035d8c;
                        if (local_384 == 0) {
                            local_384 = 0xffffffff;
                        }
                    }
                    if (local_3a4 == 0)
                        goto LAB_00035df8;
                    __s2_00 = local_2b4 + 1;
                    uVar8 = 0;
                    piVar13 = local_338;
                    do {
                        uVar5 = FUN_0007d544((int)__s2_00 + 0xfffffff8);
                        puVar10 = *(undefined4 **)(mon_hash +
                                                   (uVar5 &
                                                    (1 << mon_hash_bits) - 1U &
                                                    0xffff) *
                                                       4);
                        if (puVar10 != (undefined4 *)0x0) {
                            sVar1 = *(short *)((int)__s2_00 + -6);
                            do {
                                if ((*(short *)((int)puVar10 + 0x2e) ==
                                     sVar1) &&
                                    (*(short *)((int)__s2_00 + 0xfffffff8) ==
                                     *(short *)(puVar10 + 0xb))) {
                                    if (*(short *)((int)__s2_00 + 0xfffffff8) ==
                                        2) {
                                        bVar14 =
                                            puVar10[0xc] ==
                                            *(int *)((int)__s2_00 + 0xfffffffc);
                                    } else {
                                        iVar3 = memcmp(puVar10 + 0xd, __s2_00,
                                                       0x10);
                                        if (iVar3 != 0)
                                            goto LAB_000358bc;
                                        bVar14 = puVar10[0x11] ==
                                                 *(int *)((int)__s2_00 + 0x10);
                                    }
                                    if (bVar14) {
                                        if ((puVar10[6] ==
                                             local_338[uVar8 * 2]) &&
                                            (puVar10[7] == piVar13[1])) {
                                            if (local_3a4 == 0)
                                                goto LAB_00035df8;
                                            FUN_0002ff38("last.older",
                                                         puVar10 + 6);
                                            pcVar12 = (char *)FUN_0007d454(
                                                puVar10 + 0xb);
                                            sVar2 = strlen(pcVar12);
                                            FUN_0002f350("addr.older", pcVar12,
                                                         sVar2);
                                            if (local_384 < 2) {
                                                FUN_0007055c(&local_35c);
                                                FUN_0002e8c0(param_1,
                                                             acStack_ac, 0x80);
                                                sVar2 = strlen(acStack_ac);
                                                FUN_0002f350("nonce",
                                                             acStack_ac, sVar2);
                                                goto LAB_00035a5c;
                                            }
                                            puVar10 = (undefined4 *)puVar10[1];
                                            if (puVar10 ==
                                                (undefined4 *)mon_mru_list)
                                                goto LAB_00035e0c;
                                            goto LAB_00035a20;
                                        }
                                        break;
                                    }
                                }
                            LAB_000358bc:
                                puVar10 = (undefined4 *)*puVar10;
                            } while (puVar10 != (undefined4 *)0x0);
                        }
                        uVar8 = uVar8 + 1;
                        piVar13 = piVar13 + 2;
                        __s2_00 = (int *)((int)__s2_00 + 0x1c);
                    } while (uVar8 != local_3a4);
                    if (uVar8 == 0) {
                    LAB_00035df8:
                        puVar10 = (undefined4 *)mon_mru_list._4_4_;
                        if ((undefined1 *)mon_mru_list._4_4_ == mon_mru_list) {
                        LAB_00035e0c:
                            FUN_0007055c(&local_35c);
                            FUN_0002e8c0(param_1, acStack_ac, 0x80);
                            sVar2 = strlen(acStack_ac);
                            FUN_0002f350("nonce", acStack_ac, sVar2);
                            FUN_0002ff38(&DAT_000a5f1c, &local_35c);
                        } else {
                        LAB_00035a20:
                            FUN_0007055c(&local_35c);
                            FUN_0002e8c0(param_1, acStack_ac, 0x80);
                            sVar2 = strlen(acStack_ac);
                            FUN_0002f350("nonce", acStack_ac, sVar2);
                            if (puVar10 == (undefined4 *)0x0) {
                                FUN_0002ff38(&DAT_000a5f1c, &local_35c);
                            } else {
                            LAB_00035a5c:
                                if ((DAT_000ca6b8 < local_38a) &&
                                    (local_384 != 0)) {
                                    puVar11 = (undefined4 *)0x0;
                                    uVar8 = 0;
                                    while (true) {
                                        if ((((local_380 <= (int)puVar10[9]) &&
                                              ((local_388 == 0 ||
                                                ((local_388 &
                                                  ~*(ushort *)(puVar10 + 10)) ==
                                                 0)))) &&
                                             ((local_386 == 0 ||
                                               ((local_386 &
                                                 *(ushort *)(puVar10 + 10)) !=
                                                0)))) &&
                                            (((local_37c == 0 ||
                                               (local_35c - puVar10[6] <=
                                                local_37c)) &&
                                              ((local_3ac == 0 ||
                                                (puVar10[3] == local_3ac)))))) {
                                            local_d8[0] = 'f';
                                            local_d8[1] = 'i';
                                            local_d8[2] = 'r';
                                            local_d8[3] = 's';
                                            acStack_d4[0] = 't';
                                            acStack_d4[1] = '.';
                                            acStack_d4[2] = '%';
                                            acStack_d4[3] = 'd';
                                            iVar9 = 6;
                                            local_d0 = 0;
                                            local_f8 = 0x252e7463;
                                            local_dc = 0;
                                            local_f4 = 100;
                                            local_f0 = 0x252e766d;
                                            local_e0 = 0;
                                            local_ec = 100;
                                            local_e8 = 0x252e7372;
                                            local_e4 = 100;
                                            uVar5 = rand();
                                            iVar3 = rand();
                                            uVar5 = uVar5 ^ iVar3 << 0x10;
                                            do {
                                                for (uVar6 = uVar5 & 7;
                                                     uVar6 = uVar6 % 6,
                                                    *(char *)((int)&local_e0 +
                                                              uVar6) != '\0';
                                                     uVar6 = uVar6 + 1) {
                                                }
                                                switch (uVar6) {
                                                case 1:
                                                    FUN_0007d00c(
                                                        auStack_cc, 0x20,
                                                        "last.%d", uVar8);
                                                    FUN_0002ff38(auStack_cc,
                                                                 puVar10 + 6);
                                                    break;
                                                case 2:
                                                    FUN_0007d00c(auStack_cc,
                                                                 0x20, local_d8,
                                                                 uVar8);
                                                    FUN_0002ff38(auStack_cc,
                                                                 puVar10 + 4);
                                                    break;
                                                case 3:
                                                    FUN_0007d00c(
                                                        auStack_cc, 0x20,
                                                        &local_f8, uVar8);
                                                    FUN_0002fd0c(auStack_cc,
                                                                 puVar10[9]);
                                                    break;
                                                case 4:
                                                    FUN_0007d00c(
                                                        auStack_cc, 0x20,
                                                        &local_f0, uVar8);
                                                    FUN_0002fdb0(
                                                        auStack_cc,
                                                        *(undefined1
                                                              *)((int)puVar10 +
                                                                 0x2a));
                                                    break;
                                                case 5:
                                                    FUN_0007d00c(
                                                        auStack_cc, 0x20,
                                                        &local_e8, uVar8);
                                                    FUN_0002fc68(
                                                        auStack_cc,
                                                        *(undefined2
                                                              *)(puVar10 + 10));
                                                    break;
                                                default:
                                                    FUN_0007d00c(
                                                        auStack_cc, 0x20,
                                                        "addr.%d", uVar8);
                                                    pcVar12 =
                                                        (char *)FUN_0007d454(
                                                            puVar10 + 0xb);
                                                    sVar2 = strlen(pcVar12);
                                                    FUN_0002f350(auStack_cc,
                                                                 pcVar12,
                                                                 sVar2);
                                                }
                                                iVar9 = iVar9 + -1;
                                                *(undefined1 *)((int)&local_e0 +
                                                                uVar6) = 1;
                                                uVar5 = uVar5 >> 3;
                                            } while (iVar9 != 0);
                                            if (uVar8 == 0) {
                                                FUN_0002fe54(0);
                                            }
                                            uVar8 = uVar8 + 1;
                                            puVar11 = puVar10;
                                        }
                                        puVar10 = (undefined4 *)puVar10[1];
                                        if ((puVar10 ==
                                             (undefined4 *)mon_mru_list) ||
                                            (puVar10 == (undefined4 *)0x0))
                                            break;
                                        if ((local_38a <= DAT_000ca6b8) ||
                                            (local_384 <= uVar8))
                                            goto LAB_00035dec;
                                    }
                                    if (1 < uVar8) {
                                        FUN_0002fe54(uVar8 - 1);
                                    }
                                    FUN_0002ff38(&DAT_000a5f1c, &local_35c);
                                    if (puVar11 != (undefined4 *)0x0) {
                                        FUN_0002ff38("last.newest",
                                                     puVar11 + 6);
                                    }
                                }
                            }
                        }
                    LAB_00035dec:
                        FUN_0002edd4(0);
                        goto LAB_000351fc;
                    }
                    FUN_0002f734(5);
                    goto LAB_000351fc;
                }
            }
            free(pcVar12);
            goto LAB_000351fc;
        }
        __s2 = *(char **)(iVar3 + 4);
        if (local_36c == (byte *)0x0) {
            local_36c = &DAT_000a5204;
        }
        iVar9 = strcmp("nonce", __s2);
        if (iVar9 == 0) {
            free(pcVar12);
            pcVar12 = (char *)(uint)*local_36c;
            if (pcVar12 != (char *)0x0) {
                pcVar12 = (char *)FUN_00074c8c();
            }
            goto LAB_000353e8;
        }
        iVar9 = strcmp("frags", __s2);
        if (iVar9 == 0) {
            iVar3 = sscanf((char *)local_36c, "%hu", &local_38a);
        joined_r0x000356d4:
            if (iVar3 != 1)
                goto LAB_00035534;
            goto LAB_000353e8;
        }
        iVar9 = strcmp("limit", __s2);
        if (iVar9 != 0) {
            iVar9 = strcmp("mincount", __s2);
            if (iVar9 != 0) {
                iVar9 = strcmp("resall", __s2);
                puVar7 = &local_388;
                if (iVar9 != 0) {
                    iVar9 = strcmp("resany", __s2);
                    if (iVar9 != 0) {
                        iVar9 = strcmp("maxlstint", __s2);
                        if (iVar9 == 0) {
                            iVar3 = sscanf((char *)local_36c, "%u", &local_37c);
                            goto joined_r0x000356d4;
                        }
                        iVar9 = strcmp("laddr", __s2);
                        if (iVar9 != 0) {
                            iVar9 = sscanf(__s2, "last.%d", &local_35c);
                            if ((iVar9 == 1) && (local_35c < 0x10)) {
                                iVar3 = sscanf((char *)local_36c, "0x%08x.%08x",
                                               &local_378, &local_374);
                                if (iVar3 != 2)
                                    goto LAB_00035534;
                                sVar1 = local_2b8[local_35c * 0xe];
                                local_338[local_35c * 2] = local_378;
                                local_338[local_35c * 2 + 1] = local_374;
                                if (sVar1 == 2) {
                                    bVar14 = local_2b4[local_35c * 7] != 0 &&
                                             local_3a4 == local_35c;
                                } else {
                                    if ((((local_2b4[local_35c * 7 + 1] == 0) &&
                                          (local_2b4[local_35c * 7 + 2] ==
                                           0)) &&
                                         (local_2b4[local_35c * 7 + 3] == 0)) &&
                                        (local_2b4[local_35c * 7 + 4] == 0))
                                        goto LAB_000353e8;
                                    bVar14 = local_3a4 == local_35c;
                                }
                                if (!bVar14)
                                    goto LAB_000353e8;
                            } else {
                                iVar3 = sscanf(*(char **)(iVar3 + 4), "addr.%d",
                                               &local_35c);
                                if ((iVar3 != 1) || (0xf < local_35c))
                                    goto LAB_000353e8;
                                iVar3 = FUN_000744ec(
                                    local_36c, local_2b8 + local_35c * 0xe);
                                if (iVar3 == 0)
                                    goto LAB_00035534;
                                if ((local_338[local_35c * 2] == 0) ||
                                    (local_338[local_35c * 2 + 1] == 0 ||
                                     local_3a4 != local_35c))
                                    goto LAB_000353e8;
                            }
                            local_3a4 = local_3a4 + 1;
                            goto LAB_000353e8;
                        }
                        iVar3 = FUN_000744ec(local_36c, auStack_354);
                        if (iVar3 == 0)
                            goto LAB_00035534;
                        local_3ac = FUN_000277b8(auStack_354, 0);
                        goto LAB_000353e8;
                    }
                    puVar7 = &local_386;
                }
                iVar3 = sscanf((char *)local_36c, "0x%hx", puVar7);
                goto joined_r0x000356d4;
            }
            iVar3 = sscanf((char *)local_36c, "%d", &local_380);
            if (iVar3 != 1)
                goto LAB_00035534;
            if (local_380 < 0) {
                local_380 = 0;
            }
            goto LAB_000353e8;
        }
        iVar3 = sscanf((char *)local_36c, "%u", &local_384);
        if (iVar3 == 1)
            goto LAB_000353e8;
    LAB_00035534:
        free(pcVar12);
        FUN_00035108(local_370);
    } else {
        FUN_0002f734(1);
        if ((ntp_syslogmask & 1) != 0) {
            uVar4 = FUN_0007d2c0(param_1 + 4);
            FUN_00075d40(
                5, "mrulist from %s rejected due to nomrulist restriction",
                uVar4);
        }
        sys_restricted = sys_restricted + 1;
    }
LAB_000351fc:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00036294(uint param_1, int param_2, int param_3)

{
    ushort uVar1;
    undefined4 uVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    size_t sVar5;
    int iVar6;
    char cVar7;
    int iVar8;
    char *__s;
    uint uVar9;
    undefined1 auStack_180[64];
    byte local_140;
    char local_13f;
    int local_13c;
    char *local_134;
    size_t local_130;
    char acStack_12c[256];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (param_2 == 0) {
        if ((uint)DAT_000ca8de == (param_1 & 0xff)) {
            if (0xe < DAT_000ca8df)
                goto LAB_00036420;
            DAT_000ca8df = DAT_000ca8df + 1;
        } else {
            DAT_000ca8df = 1;
        }
        DAT_000ca8de = (byte)param_1;
        uVar2 = FUN_0003389c();
        uVar3 = FUN_0007e39c(param_1);
        uVar9 = param_1;
        FUN_0007d00c(acStack_12c, 0x100, "0.0.0.0 %04x %02x %s", uVar2, param_1,
                     uVar3);
        if (param_3 != 0) {
            sVar5 = strlen(acStack_12c);
            FUN_0007d00c(acStack_12c + sVar5, 0x100 - sVar5, " %s", param_3,
                         uVar9, uVar3);
        }
        uVar9 = ntp_syslogmask & 2;
    } else {
        if ((uint) * (byte *)(param_2 + 0x49) == (param_1 & 0x7f)) {
            if (0xe < *(byte *)(param_2 + 0x4a))
                goto LAB_00036420;
            cVar7 = *(byte *)(param_2 + 0x4a) + 1;
        } else {
            cVar7 = '\x01';
        }
        *(char *)(param_2 + 0x49) = (char)(param_1 & 0x7f);
        *(char *)(param_2 + 0x4a) = cVar7;
        if ((*(short *)(param_2 + 0x10) == 2) &&
            (*(short *)(param_2 + 0x14) == 0x7f7f)) {
            uVar2 = FUN_0007b36c(param_2 + 0x10);
        } else {
            uVar2 = FUN_0007d2c0();
        }
        uVar3 = FUN_000337f8(param_2);
        uVar4 = FUN_0007e39c(param_1);
        uVar9 = param_1;
        FUN_0007d00c(acStack_12c, 0x100, "%s %04x %02x %s", uVar2, uVar3,
                     param_1, uVar4);
        if (param_3 != 0) {
            sVar5 = strlen(acStack_12c);
            FUN_0007d00c(acStack_12c + sVar5, 0x100 - sVar5, " %s", param_3,
                         uVar3, uVar9, uVar4);
        }
        uVar9 = ntp_syslogmask & 0x20;
    }
    if (uVar9 != 0) {
        FUN_00075d40(6, "%s", acStack_12c);
    }
    FUN_000531d4(acStack_12c);
    if (0 < num_ctl_traps) {
        if ((param_1 & 0x80) == 0) {
            DAT_000ca6a8 = 0;
            DAT_000ca6ad = 0;
            DAT_000ca4a2 = 0;
            DAT_000ca6a4 = 7;
            DAT_000ca498 = &DAT_000ca4a8;
            DAT_000ca6c4 = &DAT_000ca67c;
            DAT_000ca6ac = 1;
            iVar6 = FUN_0003389c();
            DAT_000ca4a0 = (ushort)((uint)iVar6 >> 8) | (ushort)(iVar6 << 8);
            iVar6 = 1;
            do {
                iVar8 = iVar6 + 1;
                FUN_00031480(iVar6);
                iVar6 = iVar8;
            } while (iVar8 != 0x14);
        } else {
            if (param_2 == 0)
                goto LAB_00036420;
            DAT_000ca4a2 = *(ushort *)(param_2 + 0x3c) >> 8 |
                           *(ushort *)(param_2 + 0x3c) << 8;
            DAT_000ca6c4 = &DAT_000ca67c;
            DAT_000ca498 = &DAT_000ca4a8;
            DAT_000ca6ac = 1;
            DAT_000ca6a4 = 7;
            DAT_000ca6a8 = 0;
            DAT_000ca6ad = 0;
            iVar6 = FUN_000337f8(param_2);
            DAT_000ca4a0 = (ushort)((uint)iVar6 >> 8) | (ushort)(iVar6 << 8);
            iVar6 = 1;
            do {
                iVar8 = iVar6 + 1;
                FUN_00030a90(iVar6, param_2);
                iVar6 = iVar8;
            } while (iVar8 != 0x33);
            if (param_1 == 0x8b) {
                local_13c = 0;
                FUN_0004abac(param_2 + 0x10, 0, auStack_180);
                FUN_0002fc68("refclockstatus",
                             local_140 & 0xf | local_13f << 4);
                iVar6 = 1;
                do {
                    iVar8 = iVar6 + 1;
                    FUN_00030410(iVar6, auStack_180, 0);
                    iVar6 = iVar8;
                } while (iVar8 != 0xe);
                if ((local_13c != 0) &&
                    (uVar1 = *(ushort *)(local_13c + 2), (uVar1 & 0x80) == 0)) {
                    iVar6 = local_13c;
                    do {
                        if ((uVar1 & 0x20) != 0) {
                            __s = *(char **)(iVar6 + 4);
                            local_130 = strlen(__s);
                            local_134 = __s;
                            FUN_0002f104(&local_134, 1, 0);
                        }
                    } while ((iVar6 + 8 != 0) &&
                             (uVar1 = *(ushort *)(iVar6 + 10),
                              iVar6 = iVar6 + 8, (uVar1 & 0x80) == 0));
                }
                FUN_00035108(local_13c);
            }
        }
        FUN_0002edd4(0);
    }
LAB_00036420:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

undefined4 FUN_000366ac(undefined4 param_1, undefined4 param_2,
                        undefined4 param_3, undefined4 param_4)

{
    undefined4 uVar1;
    undefined1 auStack_224[512];
    int local_24;
    undefined4 uStack_4;

    local_24 = __stack_chk_guard;
    uStack_4 = param_4;
    uVar1 = FUN_00075afc(auStack_224, 0x200, param_3, &uStack_4, &uStack_4);
    FUN_00036294(param_1, param_2, auStack_224);
    if (local_24 == __stack_chk_guard) {
        return uVar1;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00036740(uint *param_1, int *param_2, int param_3)

{
    int iVar1;
    void *pvVar2;
    uint uVar3;
    void *__src;
    uint uVar4;
    uint extraout_r2;
    uint uVar5;
    void *pvVar6;
    uint __n;
    uint unaff_r9;
    uint uVar7;
    bool bVar8;

    iVar1 = __stack_chk_guard;
    uVar3 = param_2[2];
    uVar5 = uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
            (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18;
    if (0xffe7 < uVar5) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_crypto.c", 0x6ee, 2, "vallen <= (65535 - (6 * 4))");
    }
    uVar7 = param_2[4];
    __n = uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 |
          (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18;
    pvVar6 = (void *)(((uVar5 + 3 >> 2) + 2 + (__n + 3 >> 2)) * 4 + 0x10);
    if ((uint)((int)pvVar6 + param_3) < 0x831) {
        pvVar2 = (void *)*param_2;
        bVar8 = uVar5 == 0;
        uVar4 = param_2[1];
        if (bVar8) {
            unaff_r9 = 0;
        }
        param_1[4] = uVar3;
        param_1[2] = (uint)pvVar2;
        if (bVar8) {
            pvVar2 = (void *)0x1;
        }
        param_1[3] = uVar4;
        if (!bVar8) {
            pvVar2 = (void *)param_2[3];
            if (pvVar2 == (void *)0x0) {
                pvVar2 = (void *)0x1;
                unaff_r9 = 0;
            } else {
                uVar3 = uVar5 >> 2;
                unaff_r9 = uVar3;
                if (uVar3 * 4 < uVar5) {
                    unaff_r9 = uVar3 + 1;
                    param_1[uVar3 + 5] = 0;
                }
                memcpy(param_1 + 5, pvVar2, uVar5);
                uVar7 = param_2[4];
                pvVar2 = (void *)(unaff_r9 + 1);
                uVar4 = extraout_r2;
            }
        }
        param_1[unaff_r9 + 5] = uVar7;
        if ((__n != 0) && (__src = (void *)param_2[5], __src != (void *)0x0)) {
            uVar5 = __n >> 2;
            uVar3 = uVar5 * 4;
            if (uVar3 < __n) {
                uVar5 = (int)pvVar2 + uVar5 + 4;
                uVar4 = 0;
            }
            if (uVar3 < __n) {
                param_1[uVar5 + 1] = uVar4;
            }
            pvVar2 = memcpy(param_1 + (int)pvVar2 + 5, __src, __n);
        }
        uVar3 = (uint)(ushort)*param_1 << 0x18 |
                (uint)(ushort)((ushort)*param_1 >> 8) << 0x10 | (uint)pvVar6;
        if (pvVar6 < (void *)0xffe8) {
            pvVar2 = pvVar6;
        }
        *param_1 = (int)pvVar6 * 0x1000000 |
                   (((uint)pvVar6 & 0xff00) >> 8) << 0x10 |
                   (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18;
        if ((void *)0xffe7 < pvVar6) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_crypto.c", 0x717, 1, "len <= (65535 - (6 * 4))");
        }
    } else {
        pvVar2 = (void *)0x0;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(pvVar2);
}

void FUN_000368fc(void)

{
    undefined4 local_14;
    undefined4 local_10;
    int local_c;

    local_10 = 0;
    local_14 = 0;
    local_c = __stack_chk_guard;
    if (sys_leap != '\x03') {
        FUN_0007055c(&local_14);
    }
    if (local_c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(local_14);
}

void FUN_00036970(BIGNUM *param_1, BIGNUM *param_2)

{
    int iVar1;
    uchar *to;
    EVP_MD_CTX *ctx;
    EVP_MD *type;
    int iVar2;
    size_t local_60;
    uchar auStack_5c[64];
    int local_1c;

    local_1c = __stack_chk_guard;
    iVar1 = BN_num_bits(param_1);
    iVar2 = iVar1 + 7;
    if (iVar2 < 0) {
        iVar2 = iVar1 + 0xe;
    }
    local_60 = iVar2 >> 3;
    to = (uchar *)FUN_00074b04(0, local_60, 0);
    BN_bn2bin(param_1, to);
    ctx = (EVP_MD_CTX *)EVP_MD_CTX_new();
    EVP_MD_CTX_set_flags(ctx, 8);
    type = EVP_md5();
    EVP_DigestInit_ex(ctx, type, (ENGINE *)0x0);
    EVP_DigestUpdate(ctx, to, local_60);
    EVP_DigestFinal(ctx, auStack_5c, &local_60);
    EVP_MD_CTX_free(ctx);
    BN_bin2bn(auStack_5c, local_60, param_2);
    free(to);
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00036a5c(uint *param_1, uint *param_2, int param_3)

{
    uint uVar1;
    int iVar2;
    undefined4 uVar3;
    uint uVar4;
    EVP_MD_CTX *ctx;
    int iVar5;
    uint uVar6;
    uint uVar7;
    uint uVar8;
    uint uVar9;
    uint uVar10;
    EVP_PKEY *pkey;
    uint uVar11;

    iVar2 = __stack_chk_guard;
    uVar8 = *param_1;
    uVar4 = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10;
    if ((uVar8 << 0x18 & 0x40000000) != 0)
        goto LAB_00036acc;
    uVar8 = (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
    if (uVar8 < 0x18) {
    LAB_00036b5c:
        uVar3 = 0x101;
    } else {
        if ((uVar4 == 0x82040000) &&
            ((*(char *)(param_3 + 0x5c) == '\x05' ||
              ((*(byte *)(param_3 + 0x48) & 0x20) != 0)))) {
            uVar6 = param_1[1];
            if ((uint) * (ushort *)(param_3 + 0x84) ==
                (uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10 |
                 (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18)) {
            LAB_00036b14:
                uVar6 = param_1[4];
                uVar6 = uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10 |
                        (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18;
                if (uVar6 - 1 < 0xffe7) {
                    uVar1 = uVar6 + 3 >> 2;
                    uVar9 = param_1[uVar1 + 5];
                    uVar9 = uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10 |
                            (uVar9 >> 0x10 & 0xff) << 8 | uVar9 >> 0x18;
                    if (((uVar9 < 0xffe8) &&
                         (uVar8 = uVar8 - 0x18, uVar1 * 4 <= uVar8)) &&
                        ((uVar9 + 3 & 0xfffffffc) <= uVar8 + uVar1 * -4)) {
                        uVar7 = param_1[2];
                        uVar8 = param_1[3];
                        uVar7 = uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 |
                                (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18;
                        uVar8 = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 |
                                (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
                        if (uVar7 == 0 || uVar7 < uVar8) {
                        LAB_00036ca4:
                            uVar3 = 0x102;
                            goto LAB_00036ad0;
                        }
                        if (param_2 != (uint *)0x0) {
                            uVar11 = *param_2;
                            uVar10 = param_2[1];
                            uVar11 =
                                uVar11 << 0x18 | (uVar11 >> 8 & 0xff) << 0x10 |
                                (uVar11 >> 0x10 & 0xff) << 8 | uVar11 >> 0x18;
                            uVar10 =
                                uVar10 << 0x18 | (uVar10 >> 8 & 0xff) << 0x10 |
                                (uVar10 >> 0x10 & 0xff) << 8 | uVar10 >> 0x18;
                            if (uVar10 != 0 && uVar11 != 0) {
                                if (uVar7 < uVar11)
                                    goto LAB_00036ca4;
                                if (uVar7 < uVar10 || uVar8 < uVar10) {
                                    uVar3 = 0x103;
                                    goto LAB_00036ad0;
                                }
                            }
                        }
                        if (uVar4 != 0x82020000) {
                            pkey = DAT_000ca8e0;
                            if ((crypto_flags & *(uint *)(param_3 + 0x88) &
                                 0x10) == 0) {
                                pkey = *(EVP_PKEY **)(param_3 + 0x8c);
                            }
                            if ((uVar9 == 0 || pkey == (EVP_PKEY *)0x0) ||
                                (*(int *)(param_3 + 0x90) == 0))
                                goto LAB_00036acc;
                            uVar4 = EVP_PKEY_size(pkey);
                            if (uVar4 != uVar9) {
                                uVar3 = 0x107;
                                goto LAB_00036ad0;
                            }
                            ctx = (EVP_MD_CTX *)EVP_MD_CTX_new(uVar4);
                            EVP_DigestInit(ctx, *(EVP_MD **)(param_3 + 0x90));
                            EVP_DigestUpdate(ctx, param_1 + 2, uVar6 + 0xc);
                            iVar5 = EVP_VerifyFinal(
                                ctx, (uchar *)(param_1 + uVar1 + 6), uVar9,
                                pkey);
                            if (iVar5 < 1) {
                                EVP_MD_CTX_free(ctx);
                                uVar3 = 0x108;
                                goto LAB_00036ad0;
                            }
                            EVP_MD_CTX_free(ctx);
                            if ((*(uint *)(param_3 + 0x88) & 0x200) != 0) {
                                uVar3 = 0x100;
                                *(uint *)(param_3 + 0x88) =
                                    *(uint *)(param_3 + 0x88) | 0x400;
                                goto LAB_00036ad0;
                            }
                        }
                        uVar3 = 0x100;
                        goto LAB_00036ad0;
                    }
                }
                goto LAB_00036b5c;
            }
        } else {
            uVar6 = param_1[1];
            if ((uint) * (ushort *)(param_3 + 0x3c) ==
                (uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10 |
                 (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18))
                goto LAB_00036b14;
        }
    LAB_00036acc:
        uVar3 = 0x10f;
    }
LAB_00036ad0:
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar3);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00036db0) */

void FUN_00036cd4(void)

{
    return;
}

void FUN_00036dbc(uint param_1, undefined4 *param_2, undefined2 *param_3)

{
    int iVar1;
    ulong uVar2;
    char *__nptr;
    char acStack_4f[35];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (0x17 < param_1) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_crypto.c", 0x7f9, 0, "len < sizeof(v)");
    }
    __nptr = acStack_4f + 0xb;
    __strncpy_chk(__nptr, *param_2, param_1, 0x18);
    if (param_1 < 0xd) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_crypto.c", 0x7fb, 0, "len >= 13");
    }
    uVar2 = strtoul(__nptr + (param_1 - 3), (char **)0x0, 10);
    acStack_4f[param_1 + 8] = '\0';
    *(char *)(param_3 + 4) = (char)uVar2;
    uVar2 = strtoul(__nptr + (param_1 - 5), (char **)0x0, 10);
    acStack_4f[param_1 + 6] = '\0';
    *(char *)((int)param_3 + 7) = (char)uVar2;
    uVar2 = strtoul(__nptr + (param_1 - 7), (char **)0x0, 10);
    acStack_4f[param_1 + 4] = '\0';
    *(char *)(param_3 + 3) = (char)uVar2;
    uVar2 = strtoul(__nptr + (param_1 - 9), (char **)0x0, 10);
    acStack_4f[param_1 + 2] = '\0';
    *(char *)((int)param_3 + 5) = (char)uVar2;
    uVar2 = strtoul(__nptr + (param_1 - 0xb), (char **)0x0, 10);
    acStack_4f[param_1] = '\0';
    *(char *)(param_3 + 2) = (char)uVar2;
    uVar2 = strtoul(__nptr, (char **)0x0, 10);
    iVar1 = __stack_chk_guard;
    if (uVar2 < 0x32) {
        uVar2 = uVar2 + 100;
    } else if (0x95 < uVar2)
        goto LAB_00036ee8;
    uVar2 = uVar2 + 0x76c;
LAB_00036ee8:
    *(undefined1 *)((int)param_3 + 9) = 0;
    *param_3 = (short)uVar2;
    param_3[1] = 0;
    if (local_2c == iVar1) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000371e8(char *param_1, void *param_2, undefined4 param_3)

{
    FILE *__stream;
    char *pcVar1;
    int iVar2;
    EVP_PKEY *pkey;
    ulong e;
    int *piVar3;
    int *piVar4;
    int *piVar5;
    int *local_334;
    int local_330;
    char acStack_32c[256];
    char acStack_22c[2];
    undefined1 auStack_22a[254];
    undefined1 auStack_12c[256];
    int local_2c;
    int local_1c;

    piVar3 = (int *)0x82c;
    local_1c = __stack_chk_guard;
    piVar5 = pkinfo;
    if (pkinfo != (int *)0x0) {
        do {
            piVar3 = piVar5;
            piVar4 = (int *)strcmp(param_1, (char *)piVar3[2]);
            if (piVar4 == (int *)0x0) {
                if (local_1c == __stack_chk_guard) {
                    return;
                }
                goto LAB_00037290;
            }
            piVar5 = (int *)*piVar3;
            piVar3 = piVar4;
        } while (piVar5 != (int *)0x0);
    }
    if (local_1c != __stack_chk_guard) {
    LAB_00037290:
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(piVar3);
    }
    local_2c = __stack_chk_guard;
    if (*param_1 == '/') {
        FUN_0007e4b4(acStack_32c, param_1, 0x100);
    } else {
        FUN_0007d00c(acStack_32c, 0x100, "%s/%s", keysdir, param_1);
    }
    __stream = fopen64(acStack_32c, "r");
    if (__stream == (FILE *)0x0) {
        local_334 = (int *)0x0;
    } else {
        pcVar1 = fgets(acStack_22c, 0x100, __stream);
        if (pcVar1 == (char *)0x0) {
            pcVar1 = "crypto_key: empty file %s";
        } else {
            pcVar1 = strrchr(pcVar1, 0x2e);
            if (pcVar1 != (char *)0x0) {
                iVar2 = sscanf(pcVar1 + 1, "%u", &local_330);
                if (iVar2 == 1) {
                    pkey = PEM_read_PrivateKey(__stream, (EVP_PKEY **)0x0,
                                               (undefined1 *)0x0, param_2);
                    fclose(__stream);
                    if (pkey == (EVP_PKEY *)0x0) {
                        e = ERR_get_error();
                        pcVar1 = ERR_error_string(e, (char *)0x0);
                        FUN_00075d40(3, "crypto_key: %s", pcVar1);
                        /* WARNING: Subroutine does not return */
                        exit(-1);
                    }
                    local_334 = (int *)FUN_00074b04(0, 0x10, 0);
                    *local_334 = (int)pkinfo;
                    local_334[1] = (int)pkey;
                    pkinfo = local_334;
                    iVar2 = FUN_00074c8c(param_1);
                    local_334[3] = local_330;
                    local_334[2] = iVar2;
                    pcVar1 = strrchr(acStack_22c, 10);
                    if (pcVar1 != (char *)0x0) {
                        *pcVar1 = '\0';
                    }
                    iVar2 = EVP_PKEY_size(pkey);
                    FUN_0007d00c(auStack_12c, 0x100, "%s mod %d", auStack_22a,
                                 iVar2 << 3);
                    FUN_000532d0(param_3, auStack_12c);
                } else {
                    FUN_00075d40(3, "crypto_key: invalid filestamp %s",
                                 acStack_32c);
                    fclose(__stream);
                    local_334 = (int *)0x0;
                }
                goto LAB_000370f0;
            }
            pcVar1 = "crypto_key: no filestamp %s";
        }
        local_334 = (int *)0x0;
        FUN_00075d40(3, pcVar1, acStack_32c);
        fclose(__stream);
    }
LAB_000370f0:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(local_334);
}

void FUN_00037700(short *param_1, int param_2, uint param_3, uint param_4,
                  int param_5)

{
    EVP_MD_CTX *ctx;
    char *name;
    EVP_MD *type;
    uint uVar1;
    size_t cnt;
    uint local_98;
    undefined4 local_94;
    undefined4 local_90;
    uint local_8c;
    uint local_88;
    undefined4 local_84;
    undefined4 uStack_80;
    undefined4 uStack_7c;
    undefined4 uStack_78;
    uint local_74;
    uint local_70;
    uint local_6c[16];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (param_2 == 0) {
        uVar1 = 0;
    } else {
        if (*param_1 == 2) {
            local_94 = *(undefined4 *)(param_1 + 2);
            local_88 = param_4 << 0x18 | (param_4 >> 8 & 0xff) << 0x10 |
                       (param_4 >> 0x10 & 0xff) << 8 | param_4 >> 0x18;
            local_90 = *(undefined4 *)(param_2 + 4);
            local_8c = param_3 << 0x18 | (param_3 >> 8 & 0xff) << 0x10 |
                       (param_3 >> 0x10 & 0xff) << 8 | param_3 >> 0x18;
            cnt = 0x10;
        } else if (*param_1 == 10) {
            local_94 = *(undefined4 *)(param_1 + 4);
            local_70 = param_4 << 0x18 | (param_4 >> 8 & 0xff) << 0x10 |
                       (param_4 >> 0x10 & 0xff) << 8 | param_4 >> 0x18;
            local_90 = *(undefined4 *)(param_1 + 6);
            local_8c = *(uint *)(param_1 + 8);
            local_88 = *(uint *)(param_1 + 10);
            local_74 = param_3 << 0x18 | (param_3 >> 8 & 0xff) << 0x10 |
                       (param_3 >> 0x10 & 0xff) << 8 | param_3 >> 0x18;
            cnt = 0x28;
            local_84 = *(undefined4 *)(param_2 + 8);
            uStack_80 = *(undefined4 *)(param_2 + 0xc);
            uStack_7c = *(undefined4 *)(param_2 + 0x10);
            uStack_78 = *(undefined4 *)(param_2 + 0x14);
        } else {
            cnt = 0;
        }
        ctx = (EVP_MD_CTX *)EVP_MD_CTX_new();
        EVP_MD_CTX_set_flags(ctx, 8);
        name = OBJ_nid2sn(crypto_nid);
        type = EVP_get_digestbyname(name);
        EVP_DigestInit_ex(ctx, type, (ENGINE *)0x0);
        EVP_DigestUpdate(ctx, &local_94, cnt);
        EVP_DigestFinal(ctx, (uchar *)local_6c, &local_98);
        EVP_MD_CTX_free(ctx);
        uVar1 = local_6c[0] << 0x18 | (local_6c[0] >> 8 & 0xff) << 0x10 |
                (local_6c[0] >> 0x10 & 0xff) << 8 | local_6c[0] >> 0x18;
        if (param_5 != 0) {
            FUN_000733b4(param_3, crypto_nid, local_6c, local_98, 0);
            FUN_000730c4(param_3, param_5);
        }
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar1);
}

void FUN_0003789c(int param_1, int param_2)

{
    int iVar1;
    uint uVar2;
    uint uVar3;
    int iVar4;
    int iVar5;
    uint *puVar6;
    EVP_MD_CTX *ctx;
    uint uVar7;
    int iVar8;
    undefined4 uVar9;
    uint local_30;
    int local_2c;

    local_2c = __stack_chk_guard;
    if (param_2 == 0) {
        uVar9 = 0x10f;
    } else {
        uVar2 = FUN_000368fc();
        if (*(int *)(param_1 + 0xf0) == 0) {
            uVar9 = FUN_00074bcc(0, 100, 4);
            *(undefined4 *)(param_1 + 0xf0) = uVar9;
        }
        do {
            do {
                uVar3 = FUN_00079a2c();
            } while (uVar3 < 0x10000);
            iVar4 = FUN_00072f54();
        } while (iVar4 != 0);
        iVar4 = 0;
        uVar7 = (uint) * (byte *)(param_1 + 0x5e);
        if ((uint) * (byte *)(param_1 + 0x40) <=
            (uint) * (byte *)(param_1 + 0x5e)) {
            uVar7 = (uint) * (byte *)(param_1 + 0x40);
        }
        iVar1 = 1 << uVar7;
        uVar7 = iVar1 * 100;
        if ((uint)(1 << sys_automax) <= (uint)(iVar1 * 100)) {
            uVar7 = 1 << sys_automax;
        }
        iVar8 = uVar7 - iVar1;
        if (*(char *)(param_1 + 0x3f) == '\x05') {
            uVar9 = 0;
        } else {
            uVar9 = *(undefined4 *)(param_1 + 0xa8);
        }
        do {
            *(uint *)(*(int *)(param_1 + 0xf0) + iVar4 * 4) = uVar3;
            *(int *)(param_1 + 0xf4) = iVar4;
            uVar3 = FUN_00037700(param_2 + 0x18, param_1 + 0x10, uVar3, uVar9,
                                 iVar8 + iVar1 * 2);
            iVar5 = FUN_00072edc();
            if ((iVar5 != 0) || ((uVar2 == 0 || uVar3 < 0x10000) || iVar8 < 0))
                break;
            iVar4 = iVar4 + 1;
            iVar8 = iVar8 - iVar1;
        } while (iVar4 != 100);
        puVar6 = *(uint **)(param_1 + 0x11c);
        if (puVar6 == (uint *)0x0) {
            puVar6 = (uint *)FUN_00074b04(0, 8, 0, 0);
            *(uint **)(param_1 + 0x11c) = puVar6;
        }
        uVar7 = *(uint *)(param_1 + 0xf4);
        puVar6[1] = uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 |
                    (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18;
        *puVar6 = uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                  (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18;
        *(uint *)(param_1 + 0x110) =
            uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 |
            (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18;
        *(undefined4 *)(param_1 + 0x118) = 0x8000000;
        *(undefined4 *)(param_1 + 0x120) = 0;
        *(undefined4 *)(param_1 + 0x114) = hostval._0_4_;
        if (uVar2 == 0) {
            uVar9 = 0x100;
        } else {
            if (*(int *)(param_1 + 0x124) == 0) {
                uVar9 = FUN_00074b04(0, DAT_000ca8e4, 0);
                *(undefined4 *)(param_1 + 0x124) = uVar9;
            }
            ctx = (EVP_MD_CTX *)EVP_MD_CTX_new();
            EVP_DigestInit(ctx, DAT_000ca8e8);
            EVP_DigestUpdate(ctx, (void *)(param_1 + 0x110), 0xc);
            EVP_DigestUpdate(ctx, *(void **)(param_1 + 0x11c), 8);
            iVar4 = EVP_SignFinal(ctx, *(uchar **)(param_1 + 0x124), &local_30,
                                  DAT_000ca8e0);
            if (iVar4 != 0) {
                if (DAT_000ca8e4 < local_30) {
                    /* WARNING: Subroutine does not return */
                    FUN_0007fc54("ntp_crypto.c", 0x18d, 2,
                                 "len <= sign_siglen");
                }
                *(uint *)(param_1 + 0x120) =
                    local_30 << 0x18 | (local_30 >> 8 & 0xff) << 0x10 |
                    (local_30 >> 0x10 & 0xff) << 8 | local_30 >> 0x18;
                *(uint *)(param_1 + 0x44) = *(uint *)(param_1 + 0x44) | 0x8000;
            }
            EVP_MD_CTX_free(ctx);
            uVar9 = 0x100;
        }
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar9);
}

void FUN_00037b88(int param_1)

{
    int iVar1;
    uint uVar2;
    undefined *puVar3;
    undefined4 uVar4;
    undefined1 auStack_11c[256];
    int local_1c;

    uVar2 = *(uint *)(param_1 + 0x88);
    local_1c = __stack_chk_guard;
    if ((uVar2 & 0x20) == 0) {
        if ((uVar2 & 0x40) != 0) {
            uVar4 = 0x2080000;
            puVar3 = &DAT_000a60a4;
            goto LAB_00037be0;
        }
        if ((uVar2 & 0x80) != 0) {
            uVar4 = 0x2090000;
            puVar3 = &DAT_000a60a0;
            goto LAB_00037be0;
        }
    } else {
        uVar4 = 0x2070000;
        puVar3 = &DAT_000a60a8;
    LAB_00037be0:
        FUN_0007d00c(auStack_11c, 0x100, "ntpkey_%spar_%s", puVar3,
                     *(undefined4 *)(param_1 + 0x50));
        iVar1 = FUN_000371e8(auStack_11c, 0, param_1 + 0x10);
        *(int *)(param_1 + 0xac) = iVar1;
        if (iVar1 != 0)
            goto LAB_00037c20;
    }
    FUN_00075d40(5, "crypto_ident: no identity parameters found for group %s",
                 *(undefined4 *)(param_1 + 0x50));
    uVar4 = 0x2000000;
LAB_00037c20:
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar4);
}

void FUN_00037c90(undefined4 param_1, uint param_2, uint param_3, char *param_4)

{
    int iVar1;
    uint uVar2;
    uint __n;
    uint *puVar3;
    int iVar4;

    iVar1 = __stack_chk_guard;
    uVar2 = FUN_000368fc();
    if (param_4 == (char *)0x0) {
        iVar4 = 0x18;
        __n = 0;
    } else {
        __n = strlen(param_4);
        if (0xffe6 < __n) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_crypto.c", 0x6bd, 2, "slen < (65535 - (6 * 4))");
        }
        iVar4 = __n + 0x18;
    }
    puVar3 = (uint *)FUN_00074b04(0, iVar4, 0, 1);
    if (param_2 != 0) {
        if ((param_2 & 0xffff) != 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_crypto.c", 0x6c5, 0,
                         "0 == (opcode & ~0xffff0000)");
        }
        param_2 = iVar4 + param_2;
        *puVar3 = param_2 * 0x1000000 | (param_2 >> 8 & 0xff) << 0x10 |
                  (param_2 >> 0x10 & 0xff) << 8 | param_2 >> 0x18;
        puVar3[1] = param_3 << 0x18 | (param_3 >> 8 & 0xff) << 0x10 |
                    (param_3 >> 0x10 & 0xff) << 8 | param_3 >> 0x18;
        puVar3[2] = uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 |
                    (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18;
        if (param_4 == (char *)0x0) {
            puVar3[4] = 0;
        }
        puVar3[3] = hostval._0_4_;
        if (param_4 != (char *)0x0) {
            puVar3[4] = __n << 0x18 | (__n >> 8 & 0xff) << 0x10 |
                        (__n >> 0x10 & 0xff) << 8 | __n >> 0x18;
            memcpy(puVar3 + 5, param_4, __n);
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(puVar3);
    }
    return;
}

void FUN_00037dec(void)

{
    EVP_MD_CTX *ctx;
    int iVar1;
    undefined4 uVar2;
    uint uVar3;
    undefined *puVar4;
    int *piVar5;
    uint local_158;
    time_t local_154;
    uint local_150[2];
    int local_148;
    int local_144;
    short local_13c;
    undefined1 auStack_12c[256];
    int local_2c;

    iVar1 = __stack_chk_guard;
    uVar3 = FUN_000368fc();
    hostval._0_4_ = uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                    (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18;
    if (hostval._0_4_ == 0) {
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        local_2c = __stack_chk_guard;
        ctx = (EVP_MD_CTX *)EVP_MD_CTX_new();
        if (pubkey._8_4_ != 0) {
            pubkey._16_4_ = 0;
            pubkey._0_4_ = hostval._0_4_;
            if (pubkey._20_4_ == 0) {
                pubkey._20_4_ = FUN_00074b04(0, DAT_000ca8e4, 0);
            }
            EVP_DigestInit(ctx, DAT_000ca8e8);
            EVP_DigestUpdate(ctx, pubkey, 0xc);
            EVP_DigestUpdate(ctx, (void *)pubkey._12_4_,
                             pubkey._8_4_ << 0x18 |
                                 ((uint)pubkey._8_4_ >> 8 & 0xff) << 0x10 |
                                 ((uint)pubkey._8_4_ >> 0x10 & 0xff) << 8 |
                                 (uint)pubkey._8_4_ >> 0x18);
            iVar1 = EVP_SignFinal(ctx, (uchar *)pubkey._20_4_, &local_158,
                                  DAT_000ca8e0);
            if (iVar1 != 0) {
                if (DAT_000ca8e4 < local_158) {
                    /* WARNING: Subroutine does not return */
                    FUN_0007fc54("ntp_crypto.c", 0x74c, 2,
                                 "len <= sign_siglen");
                }
                pubkey._16_4_ =
                    local_158 << 0x18 | (local_158 >> 8 & 0xff) << 0x10 |
                    (local_158 >> 0x10 & 0xff) << 8 | local_158 >> 0x18;
            }
        }
        uVar2 = hostval._0_4_;
        for (piVar5 = (int *)cinfo; hostval._0_4_ = uVar2, piVar5 != (int *)0x0;
             piVar5 = (int *)*piVar5) {
            piVar5[0x13] = 0;
            piVar5[0xf] = uVar2;
            if (piVar5[0x14] == 0) {
                uVar2 = FUN_00074b04(0, DAT_000ca8e4, 0);
                piVar5[0x14] = uVar2;
            }
            EVP_DigestInit(ctx, DAT_000ca8e8);
            EVP_DigestUpdate(ctx, piVar5 + 0xf, 0xc);
            uVar3 = piVar5[0x11];
            EVP_DigestUpdate(ctx, (void *)piVar5[0x12],
                             uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                                 (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18);
            iVar1 = EVP_SignFinal(ctx, (uchar *)piVar5[0x14], &local_158,
                                  DAT_000ca8e0);
            if (iVar1 != 0) {
                if (DAT_000ca8e4 < local_158) {
                    /* WARNING: Subroutine does not return */
                    FUN_0007fc54("ntp_crypto.c", 0x761, 2,
                                 "len <= sign_siglen");
                }
                piVar5[0x13] =
                    local_158 << 0x18 | (local_158 >> 8 & 0xff) << 0x10 |
                    (local_158 >> 0x10 & 0xff) << 8 | local_158 >> 0x18;
            }
            uVar2 = hostval._0_4_;
        }
        tai_leap._0_4_ = uVar2;
        tai_leap._4_4_ = hostval._4_4_;
        FUN_0003ded4(local_150);
        iVar1 = memcmp(local_150, &local_148, 8);
        if (iVar1 == 0) {
            local_154 = time((time_t *)0x0);
            FUN_0003dbf8(local_150, local_154 + -0x7c558180);
        }
        local_158 = 0xc;
        if ((tai_leap._12_4_ == 0) || (tai_leap._8_4_ != 0xc000000)) {
            free((void *)tai_leap._12_4_);
            tai_leap._12_4_ = FUN_00074b04(0, local_158, 0);
            tai_leap._8_4_ =
                local_158 << 0x18 | (local_158 >> 8 & 0xff) << 0x10 |
                (local_158 >> 0x10 & 0xff) << 8 | local_158 >> 0x18;
        }
        uVar2 = tai_leap._12_4_;
        uVar3 = (uint)local_13c;
        if ((int)uVar3 < 0xb) {
            memset((void *)tai_leap._12_4_, 0, local_158);
        } else {
            *(uint *)tai_leap._12_4_ =
                uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18;
            *(uint *)(uVar2 + 4) =
                local_150[0] << 0x18 | (local_150[0] >> 8 & 0xff) << 0x10 |
                (local_150[0] >> 0x10 & 0xff) << 8 | local_150[0] >> 0x18;
            if (local_144 < 0) {
                puVar4 = (undefined *)(local_150[0] + 0x20f580);
            } else {
                puVar4 = &UNK_00093a80 + local_148;
            }
            *(uint *)(uVar2 + 8) =
                (int)puVar4 << 0x18 | ((uint)puVar4 >> 8 & 0xff) << 0x10 |
                ((uint)puVar4 >> 0x10 & 0xff) << 8 | (uint)puVar4 >> 0x18;
        }
        if (tai_leap._20_4_ == 0) {
            tai_leap._20_4_ = FUN_00074b04(0, DAT_000ca8e4, 0);
        }
        EVP_DigestInit(ctx, DAT_000ca8e8);
        EVP_DigestUpdate(ctx, tai_leap, 0xc);
        EVP_DigestUpdate(ctx, (void *)tai_leap._12_4_, local_158);
        iVar1 = EVP_SignFinal(ctx, (uchar *)tai_leap._20_4_, &local_158,
                              DAT_000ca8e0);
        if (iVar1 != 0) {
            if (DAT_000ca8e4 < local_158) {
                /* WARNING: Subroutine does not return */
                FUN_0007fc54("ntp_crypto.c", 0x793, 2, "len <= sign_siglen");
            }
            tai_leap._16_4_ =
                local_158 << 0x18 | (local_158 >> 8 & 0xff) << 0x10 |
                (local_158 >> 0x10 & 0xff) << 8 | local_158 >> 0x18;
        }
        crypto_flags = crypto_flags | 2;
        FUN_0007d00c(auStack_12c, 0x100, "signature update ts %u",
                     hostval._0_4_ << 0x18 |
                         ((uint)hostval._0_4_ >> 8 & 0xff) << 0x10 |
                         ((uint)hostval._0_4_ >> 0x10 & 0xff) << 8 |
                         (uint)hostval._0_4_ >> 0x18);
        FUN_000532d0(0, auStack_12c);
        EVP_MD_CTX_free(ctx);
        if (local_2c != __stack_chk_guard) {
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00037ef8) */

void FUN_00037e64(void)

{
    if ((((DAT_000ca8e8 != 0) && (DAT_000ca8e0 != 0)) &&
         (tai_leap._12_4_ != 0)) &&
        (tai_leap._8_4_ == 0xc000000)) {
        FUN_00037dec();
        return;
    }
    return;
}

void FUN_00037f0c(void *param_1)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if (*(void **)((int)param_1 + 0xc) != (void *)0x0) {
        free(*(void **)((int)param_1 + 0xc));
    }
    if (*(void **)((int)param_1 + 0x14) != (void *)0x0) {
        free(*(void **)((int)param_1 + 0x14));
    }
    if (iVar1 == __stack_chk_guard) {
        memset(param_1, 0, 0x18);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00037f84(void *param_1)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if (*(EVP_PKEY **)((int)param_1 + 8) != (EVP_PKEY *)0x0) {
        EVP_PKEY_free(*(EVP_PKEY **)((int)param_1 + 8));
    }
    if (*(void **)((int)param_1 + 0x30) != (void *)0x0) {
        free(*(void **)((int)param_1 + 0x30));
    }
    if (*(void **)((int)param_1 + 0x34) != (void *)0x0) {
        free(*(void **)((int)param_1 + 0x34));
    }
    if (*(BIGNUM **)((int)param_1 + 0x38) != (BIGNUM *)0x0) {
        BN_free(*(BIGNUM **)((int)param_1 + 0x38));
    }
    FUN_00037f0c((int)param_1 + 0x3c);
    if (iVar1 == __stack_chk_guard) {
        free(param_1);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003801c(uchar *param_1, uint param_2, uint param_3)

{
    X509 *x;
    int iVar1;
    EVP_PKEY *pEVar2;
    undefined4 uVar3;
    X509_NAME *pXVar4;
    char *pcVar5;
    int iVar6;
    EVP_MD *pEVar7;
    ASN1_INTEGER *a;
    long lVar8;
    undefined4 *puVar9;
    BIO_METHOD *type;
    BIO *out;
    X509_EXTENSION *ex;
    ASN1_OBJECT *o;
    int iVar10;
    ASN1_OCTET_STRING *pAVar11;
    BIGNUM *pBVar12;
    void *__dest;
    ulong uVar13;
    int iVar14;
    int loc;
    char *pcVar15;
    uchar *local_13c;
    undefined2 local_138[2];
    undefined1 local_134;
    undefined1 local_133;
    undefined1 local_132;
    undefined1 local_131;
    undefined1 local_130;
    char acStack_12c[256];
    int local_2c;

    local_2c = __stack_chk_guard;
    local_13c = param_1;
    x = d2i_X509((X509 **)0x0, &local_13c, param_2);
    if (x == (X509 *)0x0) {
        uVar13 = ERR_get_error();
        pcVar15 = ERR_error_string(uVar13, (char *)0x0);
        FUN_00075d40(3, "cert_parse: %s", pcVar15);
        iVar1 = 0;
        goto LAB_00038348;
    }
    iVar1 = FUN_00074b04(0, 0x54, 0, 1);
    pEVar2 = X509_get_pubkey(x);
    *(EVP_PKEY **)(iVar1 + 8) = pEVar2;
    if (pEVar2 == (EVP_PKEY *)0x0) {
        uVar13 = ERR_get_error();
        pcVar15 = ERR_error_string(uVar13, (char *)0x0);
        pcVar5 = "cert_parse: %s";
        uVar3 = 3;
    LAB_000384dc:
        FUN_00075d40(uVar3, pcVar5, pcVar15);
    } else {
        uVar3 = X509_get_version(x);
        pcVar15 = acStack_12c;
        *(undefined4 *)(iVar1 + 0xc) = uVar3;
        pXVar4 = X509_get_subject_name(x);
        X509_NAME_oneline(pXVar4, pcVar15, 0x100);
        pcVar5 = strstr(pcVar15, "CN=");
        if (pcVar5 == (char *)0x0) {
            FUN_00075d40(5, "cert_parse: invalid subject %s", pcVar15);
            goto LAB_00038450;
        }
        uVar3 = FUN_00074c8c(pcVar5 + 3);
        *(undefined4 *)(iVar1 + 0x30) = uVar3;
        iVar6 = X509_get_signature_nid(x);
        *(int *)(iVar1 + 0x10) = iVar6;
        pcVar5 = OBJ_nid2sn(iVar6);
        pEVar7 = EVP_get_digestbyname(pcVar5);
        *(EVP_MD **)(iVar1 + 0x14) = pEVar7;
        a = X509_get_serialNumber(x);
        lVar8 = ASN1_INTEGER_get(a);
        *(long *)(iVar1 + 0x18) = lVar8;
        pXVar4 = X509_get_issuer_name(x);
        X509_NAME_oneline(pXVar4, pcVar15, 0x100);
        pcVar5 = strstr(pcVar15, "CN=");
        if (pcVar5 == (char *)0x0) {
            uVar3 = 5;
            pcVar5 = "cert_parse: invalid issuer %s";
            goto LAB_000384dc;
        }
        iVar14 = iVar1 + 0x1c;
        uVar3 = FUN_00074c8c(pcVar5 + 3);
        *(undefined4 *)(iVar1 + 0x34) = uVar3;
        puVar9 = (undefined4 *)X509_get0_notBefore(x);
        FUN_00036dbc(*puVar9, puVar9 + 2, iVar14);
        puVar9 = (undefined4 *)X509_get0_notAfter(x);
        FUN_00036dbc(*puVar9, puVar9 + 2, iVar1 + 0x26);
        iVar6 = X509_get_ext_count(x);
        if (0 < iVar6) {
            loc = 0;
            do {
                while (true) {
                    ex = X509_get_ext(x, loc);
                    o = X509_EXTENSION_get_object(ex);
                    iVar10 = OBJ_obj2nid(o);
                    if (iVar10 != 0x52)
                        break;
                    loc = loc + 1;
                    pAVar11 = X509_EXTENSION_get_data(ex);
                    pBVar12 = BN_bin2bn(pAVar11->data + 2, pAVar11->length + -2,
                                        (BIGNUM *)0x0);
                    *(BIGNUM **)(iVar1 + 0x38) = pBVar12;
                    if (loc == iVar6)
                        goto LAB_00038288;
                }
                if (iVar10 == 0x7e) {
                    type = BIO_s_mem();
                    out = BIO_new(type);
                    X509V3_EXT_print(out, ex, 0, 0);
                    BIO_gets(out, pcVar15, 0x100);
                    BIO_free(out);
                    iVar10 = strcmp(pcVar15, "Trust Root");
                    if (iVar10 == 0) {
                        *(uint *)(iVar1 + 4) = *(uint *)(iVar1 + 4) | 1;
                    } else {
                        iVar10 = strcmp(pcVar15, "Private");
                        if (iVar10 == 0) {
                            *(uint *)(iVar1 + 4) = *(uint *)(iVar1 + 4) | 8;
                        }
                    }
                }
                loc = loc + 1;
            } while (loc != iVar6);
        }
    LAB_00038288:
        pcVar15 = *(char **)(iVar1 + 0x30);
        pcVar5 = *(char **)(iVar1 + 0x34);
        iVar6 = strcmp(pcVar15, pcVar5);
        if (iVar6 == 0) {
            iVar6 = X509_verify(x, *(EVP_PKEY **)(iVar1 + 8));
            if (0 < iVar6)
                goto LAB_000382c0;
            FUN_00075d40(5, "cert_parse: signature not verified %s",
                         *(undefined4 *)(iVar1 + 0x30));
        } else {
            iVar6 = strcmp((char *)hostval._12_4_, pcVar5);
            if (iVar6 == 0) {
                FUN_00075d40(5, "cert_parse: certificate trail loop %s",
                             pcVar15);
            } else {
            LAB_000382c0:
                FUN_00077758(local_138, param_3, 0);
                iVar6 = FUN_00036cd4(iVar14, iVar1 + 0x26);
                if ((iVar6 < 1) &&
                    (iVar6 = FUN_00036cd4(iVar14, local_138), -1 < iVar6)) {
                    *(uint *)(iVar1 + 0x40) =
                        param_3 << 0x18 | (param_3 >> 8 & 0xff) << 0x10 |
                        (param_3 >> 0x10 & 0xff) << 8 | param_3 >> 0x18;
                    *(uint *)(iVar1 + 0x44) =
                        param_2 << 0x18 | (param_2 >> 8 & 0xff) << 0x10 |
                        (param_2 >> 0x10 & 0xff) << 8 | param_2 >> 0x18;
                    __dest = (void *)FUN_00074b04(0, param_2, 0);
                    *(void **)(iVar1 + 0x48) = __dest;
                    memcpy(__dest, param_1, param_2);
                    X509_free(x);
                    goto LAB_00038348;
                }
                FUN_00075d40(5,
                             "cert_parse: invalid times %s first "
                             "%u-%02u-%02uT%02u:%02u:%02u last "
                             "%u-%02u-%02uT%02u:%02u:%02u fstamp "
                             "%u-%02u-%02uT%02u:%02u:%02u",
                             *(undefined4 *)(iVar1 + 0x30),
                             *(undefined2 *)(iVar1 + 0x1c),
                             *(undefined1 *)(iVar1 + 0x20),
                             *(undefined1 *)(iVar1 + 0x21),
                             *(undefined1 *)(iVar1 + 0x22),
                             *(undefined1 *)(iVar1 + 0x23),
                             *(undefined1 *)(iVar1 + 0x24),
                             *(undefined2 *)(iVar1 + 0x26),
                             *(undefined1 *)(iVar1 + 0x2a),
                             *(undefined1 *)(iVar1 + 0x2b),
                             *(undefined1 *)(iVar1 + 0x2c),
                             *(undefined1 *)(iVar1 + 0x2d),
                             *(undefined1 *)(iVar1 + 0x2e), local_138[0],
                             local_134, local_133, local_132, local_131,
                             local_130);
            }
        }
    }
LAB_00038450:
    FUN_00037f84(iVar1);
    X509_free(x);
    iVar1 = 0;
LAB_00038348:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar1);
}

void FUN_00038530(int param_1)

{
    int iVar1;
    undefined4 *puVar2;
    undefined4 *puVar3;
    int iVar4;
    uint uVar5;
    uint uVar6;
    char *__s1;
    undefined4 *puVar7;
    undefined4 *puVar8;
    undefined4 *puVar9;

    iVar1 = __stack_chk_guard;
    uVar5 = *(uint *)(param_1 + 0x10);
    uVar6 = *(uint *)(param_1 + 0xc);
    puVar3 = (undefined4 *)FUN_0003801c(
        param_1 + 0x14,
        uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
            (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18,
        uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10 |
            (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18);
    puVar9 = cinfo;
    puVar8 = puVar3;
    if (puVar3 != (undefined4 *)0x0) {
        if (cinfo != (undefined4 *)0x0) {
            __s1 = (char *)puVar3[0xc];
            puVar2 = cinfo;
            puVar7 = &cinfo;
            do {
                puVar8 = puVar2;
                iVar4 = strcmp(__s1, (char *)puVar8[0xc]);
                if ((iVar4 == 0) &&
                    (iVar4 = strcmp((char *)puVar3[0xd], (char *)puVar8[0xd]),
                     iVar4 == 0)) {
                    uVar5 = puVar3[0x10];
                    uVar6 = puVar8[0x10];
                    if ((uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                         (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18) <=
                        (uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10 |
                         (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18)) {
                        FUN_00037f84(puVar3);
                        goto LAB_000385d4;
                    }
                    *puVar7 = *puVar8;
                    FUN_00037f84(puVar8);
                    puVar9 = cinfo;
                    break;
                }
                puVar2 = (undefined4 *)*puVar8;
                puVar7 = puVar8;
            } while ((undefined4 *)*puVar8 != (undefined4 *)0x0);
        }
        *puVar3 = puVar9;
        puVar8 = puVar3;
        cinfo = puVar3;
    LAB_000385d4:
        puVar8[1] = puVar8[1] | 4;
        FUN_00037dec();
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(puVar8);
}

void FUN_00038650(int param_1, int param_2)

{
    undefined2 uVar1;
    undefined2 uVar2;
    uint uVar3;
    undefined4 uVar4;
    DSA_SIG *pDVar5;
    X509 *pXVar6;
    char *pcVar7;
    EVP_MD *pEVar8;
    void *pvVar9;
    BN_CTX *pBVar10;
    BIGNUM *pBVar11;
    BIGNUM *pBVar12;
    BIGNUM *r;
    DSA *r_00;
    RSA *rsa;
    size_t __size;
    uint *puVar13;
    ulong uVar14;
    EVP_PKEY *pEVar15;
    uint uVar16;
    int iVar17;
    uint uVar18;
    int iVar19;
    undefined4 uVar20;
    undefined4 uVar21;
    uint *__src;
    uint uVar22;
    int iVar23;
    uint uVar24;
    uint uVar25;
    uint uVar26;
    uint uVar27;
    int iVar28;
    undefined2 local_194;
    uint local_190;
    uchar *local_14c;
    uint *local_148;
    BIGNUM *local_144;
    BIGNUM *local_140;
    BIGNUM *local_13c;
    BIGNUM *local_138;
    BIGNUM *local_134;
    BIGNUM *local_130;
    undefined1 auStack_12c[256];
    int local_2c;

    iVar28 = *(int *)(param_2 + 0x54);
    uVar3 = iVar28 - 0x30;
    uVar16 = *(byte *)(param_2 + 0x58) & 7;
    local_2c = __stack_chk_guard;
    if (0x18 < (int)uVar3) {
        iVar23 = 0x30;
        uVar26 = 0;
        local_190 = 0;
        do {
            iVar17 = iVar23 + 3;
            if (-1 < iVar23) {
                iVar17 = iVar23;
            }
            uVar24 = *(uint *)(param_2 + 0x58 + (iVar17 >> 2) * 4);
            __src = (uint *)(param_2 + 0x58 + (iVar17 >> 2) * 4);
            uVar18 = uVar24 << 0x18 | (uVar24 >> 8 & 0xff) << 0x10;
            uVar22 = (uVar24 >> 0x10 & 0xff) << 8;
            uVar25 = uVar18 | uVar22 | uVar24 >> 0x18;
            uVar22 = uVar22 | uVar24 >> 0x18;
            uVar24 = (__src[1] >> 0x10 & 0xff) << 8 | __src[1] >> 0x18;
            if ((uVar18 << 2) >> 0x1a != 2 || uVar22 < 8) {
                uVar18 = uVar18 | 0x40000000;
                sys_badlength = sys_badlength + 1;
            }
            if (uVar3 < uVar22) {
            LAB_00038f48:
                iVar28 = 0x101;
                goto LAB_00038850;
            }
            if (uVar22 < 0x18) {
                if (uVar18 == 0x82010000) {
                LAB_00038ad0:
                    if (*(int *)(param_1 + 0x88) == 0) {
                        if (uVar22 < 0x18) {
                            /* WARNING: Subroutine does not return */
                            FUN_0007fc54("ntp_crypto.c", 0x231, 2,
                                         "len >= (6 * 4)");
                        }
                        if ((uVar26 - 1 < 0x200) && (uVar26 <= uVar22 - 0x18)) {
                            if ((crypto_flags & 0x10) == 0) {
                                if (uVar16 - 1 < 2) {
                                    if ((crypto_flags & 0xf0) == 0) {
                                        if ((local_190 & 0xf0) != 0) {
                                        LAB_00038f20:
                                            uVar3 = *__src;
                                            iVar28 = 0x106;
                                            uVar25 =
                                                uVar3 << 0x18 |
                                                (uVar3 >> 8 & 0xff) << 0x10 |
                                                (uVar3 >> 0x10 & 0xff) << 8 |
                                                uVar3 >> 0x18;
                                            goto LAB_0003880c;
                                        }
                                    } else if ((local_190 & 0xf0) == 0)
                                        goto LAB_00038f20;
                                }
                            } else {
                                if ((local_190 & 0x10) == 0)
                                    goto LAB_00038f20;
                                local_190 = local_190 | 0x2300;
                            }
                            uVar3 = local_190 >> 0x10;
                            pcVar7 = OBJ_nid2sn(uVar3);
                            pEVar8 = EVP_get_digestbyname(pcVar7);
                            if (pEVar8 != (EVP_MD *)0x0) {
                                local_194 = (undefined2)uVar24;
                                *(undefined2 *)(param_1 + 0x84) = local_194;
                                if (uVar16 == 4) {
                                    local_190 = local_190 | 0x1000;
                                }
                                if ((local_190 & 2) == 0) {
                                    local_190 = local_190 | 0x4000;
                                }
                                RAND_bytes((uchar *)(param_1 + 0xa4), 4);
                                *(uint *)(param_1 + 0x88) = local_190;
                                *(EVP_MD **)(param_1 + 0x90) = pEVar8;
                                if (*(void **)(param_1 + 0x94) != (void *)0x0) {
                                    free(*(void **)(param_1 + 0x94));
                                }
                                pvVar9 = (void *)FUN_00074b04(0, uVar26 + 1, 0);
                                *(void **)(param_1 + 0x94) = pvVar9;
                                memcpy(pvVar9, __src + 5, uVar26);
                                *(undefined1 *)(*(int *)(param_1 + 0x94) +
                                                uVar26) = 0;
                                if (*(void **)(param_1 + 0x98) != (void *)0x0) {
                                    free(*(void **)(param_1 + 0x98));
                                }
                                uVar4 = FUN_00074c8c(
                                    *(undefined4 *)(param_1 + 0x94));
                                uVar1 = *(undefined2 *)(param_1 + 0x84);
                                uVar20 = *(undefined4 *)(param_1 + 0x94);
                                uVar2 = *(undefined2 *)(param_1 + 0x3c);
                                *(undefined4 *)(param_1 + 0x98) = uVar4;
                                pcVar7 = OBJ_nid2ln(uVar3);
                                FUN_0007d00c(auStack_12c, 0x100,
                                             "assoc %d %d host %s %s", uVar2,
                                             uVar1, uVar20, pcVar7);
                                goto LAB_00038bb0;
                            }
                            uVar3 = *__src;
                            iVar28 = 0x105;
                            uVar25 =
                                uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                                (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18;
                        } else {
                            uVar3 = *__src;
                            iVar28 = 0x101;
                            uVar25 =
                                uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                                (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18;
                        }
                    } else {
                        if (*(ushort *)(param_1 + 0x84) == uVar24)
                            goto LAB_00038bbc;
                        uVar3 = *__src;
                        iVar28 = 0x10f;
                        uVar25 = uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                                 (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18;
                    }
                LAB_0003880c:
                    uVar4 = FUN_0007e39c(iVar28);
                    FUN_0007d00c(auStack_12c, 0x100, "%04x %d %02x %s", uVar25,
                                 uVar24, iVar28, uVar4);
                    FUN_000532d0(param_1 + 0x10, auStack_12c);
                    goto LAB_00038850;
                }
                if (uVar18 < 0x82010001) {
                    if (uVar18 != 0x2060000) {
                        if (uVar18 < 0x2060001) {
                            if ((uVar18 != 0x2020000) && (uVar18 != 0x2030000))
                                goto LAB_00038a64;
                        } else if (((uVar18 != 0x2080000) &&
                                    (uVar18 != 0x2090000)) &&
                                   (uVar18 != 0x2070000)) {
                        joined_r0x00038a24:
                            if ((uVar18 & 0xc0000000) != 0)
                                goto LAB_00038a28;
                            if (*(int *)(param_1 + 0xe8) == 0) {
                                pvVar9 = (void *)FUN_00074b04(0, uVar22, 0);
                                pvVar9 = memcpy(pvVar9, __src, uVar22);
                                *(void **)(param_1 + 0xe8) = pvVar9;
                                goto LAB_00038bbc;
                            }
                            goto LAB_000389d4;
                        }
                    }
                    iVar28 = 0x101;
                    goto LAB_0003880c;
                }
                if (uVar18 == 0x82050000) {
                LAB_00038bc8:
                    iVar28 = FUN_00036a5c(__src, 0, param_1);
                    uVar3 = iVar28 - 0x100;
                    if (uVar3 != 0) {
                        uVar3 = 1;
                    }
                    uVar18 = uVar3;
                    if (uVar26 != 0xc) {
                        uVar18 = uVar3 | 1;
                    }
                    if (uVar18 == 0) {
                        if (sys_leap != '\x03') {
                            uVar3 = __src[5];
                            FUN_0003e2f0(
                                uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                                    (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18,
                                *(undefined4 *)(param_2 + 0x48));
                        }
                        tai_leap._0_4_ = __src[2];
                        uVar26 = 0xc;
                        tai_leap._4_4_ = __src[3];
                        FUN_00037dec();
                        uVar3 = __src[5];
                        FUN_000366ac(
                            0xe, param_1, "%d seconds",
                            uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                                (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18);
                        uVar18 = __src[6];
                        uVar25 = __src[7];
                        *(uint *)(param_1 + 0x88) =
                            *(uint *)(param_1 + 0x88) | 0x4000;
                        *(uint *)(param_1 + 300) =
                            *(uint *)(param_1 + 300) & 0xffffff7f;
                        uVar3 = __src[3];
                        uVar24 = __src[5];
                        FUN_0007d00c(
                            auStack_12c, 0x100,
                            "leap TAI offset %d at %u expire %u fs %u",
                            uVar24 << 0x18 | (uVar24 >> 8 & 0xff) << 0x10 |
                                (uVar24 >> 0x10 & 0xff) << 8 | uVar24 >> 0x18,
                            uVar18 << 0x18 | (uVar18 >> 8 & 0xff) << 0x10 |
                                (uVar18 >> 0x10 & 0xff) << 8 | uVar18 >> 0x18,
                            uVar25 << 0x18 | (uVar25 >> 8 & 0xff) << 0x10 |
                                (uVar25 >> 0x10 & 0xff) << 8 | uVar25 >> 0x18,
                            uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                                (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18);
                        FUN_000532d0(param_1 + 0x10, auStack_12c);
                        iVar28 = *(int *)(param_2 + 0x54);
                    } else {
                        if (uVar3 != 0)
                            goto LAB_00038804;
                        iVar28 = *(int *)(param_2 + 0x54);
                    }
                } else {
                    if (0x82050000 < uVar18) {
                        if (uVar18 != 0x82070000) {
                            if (uVar18 < 0x82070001)
                                goto LAB_000387d4;
                            goto LAB_000388ac;
                        }
                        goto LAB_00038cc4;
                    }
                    uVar3 = uVar26;
                    if (uVar18 == 0x82030000) {
                    LAB_00038950:
                        iVar28 = FUN_00036a5c(__src, param_1 + 0xb8, param_1);
                        if (iVar28 != 0x100)
                            goto LAB_00038804;
                        uVar26 = EVP_PKEY_size(DAT_000ca8ec);
                        if (uVar26 == uVar3) {
                            rsa = (RSA *)EVP_PKEY_get0_RSA(DAT_000ca8ec);
                            __size = RSA_size(rsa);
                            puVar13 = (uint *)malloc(__size);
                            if (puVar13 != (uint *)0x0) {
                                iVar28 = RSA_private_decrypt(
                                    uVar3, (uchar *)(__src + 5),
                                    (uchar *)puVar13, rsa, 4);
                                if (iVar28 != 4) {
                                    iVar28 = 0x10b;
                                    free(puVar13);
                                    uVar3 = *__src;
                                    uVar25 = uVar3 << 0x18 |
                                             (uVar3 >> 8 & 0xff) << 0x10 |
                                             (uVar3 >> 0x10 & 0xff) << 8 |
                                             uVar3 >> 0x18;
                                    goto LAB_0003880c;
                                }
                                uVar3 = *puVar13;
                                free(puVar13);
                                FUN_00043ebc(param_1);
                                uVar27 = uVar3 << 0x18 |
                                         (uVar3 >> 8 & 0xff) << 0x10 |
                                         (uVar3 >> 0x10 & 0xff) << 8 |
                                         uVar3 >> 0x18;
                                uVar18 = __src[2];
                                uVar25 = uVar16 - 1;
                                uVar24 = __src[3];
                                uVar3 = uVar25;
                                if (uVar25 < 2) {
                                    uVar3 = *(uint *)(param_1 + 0xa4);
                                }
                                *(uint *)(param_1 + 0x88) =
                                    *(uint *)(param_1 + 0x88) | 0x800;
                                if (uVar25 < 2) {
                                    uVar27 = uVar27 ^ uVar3;
                                }
                                *(uint *)(param_1 + 300) =
                                    *(uint *)(param_1 + 300) & 0xffffff7f;
                                *(uint *)(param_1 + 0xa8) = uVar27;
                                FUN_0007d00c(auStack_12c, 0x100,
                                             "cook %x ts %u fs %u", uVar27,
                                             uVar18 << 0x18 |
                                                 (uVar18 >> 8 & 0xff) << 0x10 |
                                                 (uVar18 >> 0x10 & 0xff) << 8 |
                                                 uVar18 >> 0x18,
                                             uVar24 << 0x18 |
                                                 (uVar24 >> 8 & 0xff) << 0x10 |
                                                 (uVar24 >> 0x10 & 0xff) << 8 |
                                                 uVar24 >> 0x18);
                                goto LAB_00038bb0;
                            }
                        }
                        uVar3 = *__src;
                        iVar28 = 0x10b;
                        uVar25 = uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                                 (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18;
                        goto LAB_0003880c;
                    }
                    if (uVar18 == 0x82040000)
                        goto LAB_00038b0c;
                    if (uVar18 != 0x82020000)
                        goto joined_r0x00038a24;
                }
            } else {
                uVar26 = __src[4];
                uVar3 = __src[3];
                uVar26 = uVar26 << 0x18 | (uVar26 >> 8 & 0xff) << 0x10 |
                         (uVar26 >> 0x10 & 0xff) << 8 | uVar26 >> 0x18;
                local_190 = uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                            (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18;
                if ((uVar26 == 0) || (uVar22 - 0x18 < uVar26))
                    goto LAB_00038f48;
                if (uVar18 == 0x82040000) {
                LAB_00038b0c:
                    iVar28 = FUN_00036a5c(__src, param_1 + 0xd0, param_1);
                    if (iVar28 != 0x100)
                        goto LAB_00038804;
                    if (((*(byte *)(param_1 + 0x48) & 0x20) != 0) &&
                        (*(ushort *)(param_1 + 0x84) != uVar24)) {
                        iVar28 = *(int *)(param_2 + 0x54);
                        goto LAB_000389d4;
                    }
                    uVar3 = __src[2];
                    if (uVar3 == 0)
                        goto LAB_00038bbc;
                    puVar13 = *(uint **)(param_1 + 0xdc);
                    if (puVar13 == (uint *)0x0) {
                        puVar13 = (uint *)FUN_00074b04(0, 8, 0, 0);
                        uVar3 = __src[2];
                        *(uint **)(param_1 + 0xdc) = puVar13;
                    }
                    uVar25 = __src[3];
                    uVar24 = __src[6];
                    uVar18 = __src[5];
                    *(uint *)(param_1 + 0xd0) = uVar3;
                    *(uint *)(param_1 + 0xd4) = uVar25;
                    uVar18 = uVar18 << 0x18 | (uVar18 >> 8 & 0xff) << 0x10 |
                             (uVar18 >> 0x10 & 0xff) << 8 | uVar18 >> 0x18;
                    uVar27 = *(uint *)(param_1 + 0x88);
                    uVar24 = uVar24 << 0x18 | (uVar24 >> 8 & 0xff) << 0x10 |
                             (uVar24 >> 0x10 & 0xff) << 8 | uVar24 >> 0x18;
                    *puVar13 = uVar18;
                    puVar13[1] = uVar24;
                    *(uint *)(param_1 + 0xa0) = uVar18;
                    *(uint *)(param_1 + 0x88) = uVar27 | 0x1000;
                    *(uint *)(param_1 + 300) =
                        *(uint *)(param_1 + 300) & 0xffffff7f;
                    FUN_0007d00c(
                        auStack_12c, 0x100, "auto seq %d key %x ts %u fs %u",
                        uVar24, uVar18,
                        uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                            (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18,
                        uVar25 << 0x18 | (uVar25 >> 8 & 0xff) << 0x10 |
                            (uVar25 >> 0x10 & 0xff) << 8 | uVar25 >> 0x18);
                } else {
                    if (0x82040000 < uVar18) {
                        if (uVar18 == 0x82070000) {
                        LAB_00038cc4:
                            iVar28 = FUN_00036a5c(__src, 0, param_1);
                            if (iVar28 == 0x100) {
                                iVar28 = *(int *)(param_1 + 0xac);
                                if (iVar28 == 0) {
                                    FUN_00075d40(
                                        5, "crypto_iff: scheme unavailable");
                                    iVar28 = 0x10e;
                                } else {
                                    uVar3 = __src[3];
                                    if ((uVar3 << 0x18 |
                                         (uVar3 >> 8 & 0xff) << 0x10 |
                                         (uVar3 >> 0x10 & 0xff) << 8 |
                                         uVar3 >> 0x18) ==
                                        *(uint *)(iVar28 + 0xc)) {
                                        iVar28 = EVP_PKEY_get0_DSA(
                                            *(undefined4 *)(iVar28 + 4));
                                        if (iVar28 == 0) {
                                            FUN_00075d40(
                                                5, "crypto_iff: defective key");
                                            iVar28 = 0x104;
                                        } else if (*(int *)(param_1 + 0xb0) ==
                                                   0) {
                                            FUN_00075d40(5,
                                                         "crypto_iff: missing "
                                                         "challenge");
                                            iVar28 = 0x10e;
                                        } else {
                                            pBVar10 = BN_CTX_new();
                                            pBVar11 = BN_new();
                                            pBVar12 = BN_new();
                                            uVar3 = __src[4];
                                            local_144 = (BIGNUM *)(__src + 5);
                                            pDVar5 = d2i_DSA_SIG(
                                                (DSA_SIG **)0x0,
                                                (uchar **)&local_144,
                                                uVar3 << 0x18 |
                                                    (uVar3 >> 8 & 0xff)
                                                        << 0x10 |
                                                    (uVar3 >> 0x10 & 0xff)
                                                        << 8 |
                                                    uVar3 >> 0x18);
                                            if (pDVar5 == (DSA_SIG *)0x0) {
                                                iVar28 = 0x10f;
                                                BN_free(pBVar12);
                                                BN_free(pBVar11);
                                                BN_CTX_free(pBVar10);
                                                uVar14 = ERR_get_error();
                                                pcVar7 = ERR_error_string(
                                                    uVar14, (char *)0x0);
                                                FUN_00075d40(3,
                                                             "crypto_iff: %s",
                                                             pcVar7);
                                            } else {
                                                DSA_get0_key(iVar28, &local_130,
                                                             0);
                                                DSA_get0_pqg(iVar28, &local_140,
                                                             0, &local_13c);
                                                DSA_SIG_get0(pDVar5, &local_138,
                                                             &local_134);
                                                BN_mod_exp(
                                                    pBVar12, local_130,
                                                    *(BIGNUM **)(param_1 +
                                                                 0xb0),
                                                    local_140, pBVar10);
                                                BN_mod_exp(pBVar11, local_13c,
                                                           local_138, local_140,
                                                           pBVar10);
                                                BN_mod_mul(pBVar12, pBVar12,
                                                           pBVar11, local_140,
                                                           pBVar10);
                                                FUN_00036970(pBVar12, pBVar12);
                                                iVar28 =
                                                    BN_cmp(pBVar12, local_134);
                                                BN_free(pBVar12);
                                                BN_free(pBVar11);
                                                BN_CTX_free(pBVar10);
                                                BN_free(*(BIGNUM **)(param_1 +
                                                                     0xb0));
                                                *(undefined4 *)(param_1 +
                                                                0xb0) = 0;
                                                DSA_SIG_free(pDVar5);
                                                if (iVar28 == 0) {
                                                    uVar3 = __src[3];
                                                    uVar3 =
                                                        uVar3 << 0x18 |
                                                        (uVar3 >> 8 & 0xff)
                                                            << 0x10 |
                                                        (uVar3 >> 0x10 & 0xff)
                                                            << 8 |
                                                        uVar3 >> 0x18;
                                                    uVar4 = *(
                                                        undefined4 *)(param_1 +
                                                                      0x98);
                                                    *(uint *)(param_1 + 300) =
                                                        *(uint *)(param_1 +
                                                                  300) &
                                                        0xffffff7f;
                                                    *(uint *)(param_1 + 0x88) =
                                                        *(uint *)(param_1 +
                                                                  0x88) |
                                                        0x200;
                                                    pcVar7 = "iff %s fs %u";
                                                LAB_000395e4:
                                                    FUN_0007d00c(auStack_12c,
                                                                 0x100, pcVar7,
                                                                 uVar4, uVar3);
                                                    goto LAB_00038bb0;
                                                }
                                                FUN_00075d40(
                                                    5, "crypto_iff: identity "
                                                       "not verified");
                                                iVar28 = 0x10e;
                                            }
                                        }
                                    } else {
                                        iVar28 = 0x103;
                                        FUN_00075d40(
                                            5,
                                            "crypto_iff: invalid filestamp %u");
                                    }
                                }
                            }
                        } else if (uVar18 < 0x82070001) {
                            if (uVar18 == 0x82050000)
                                goto LAB_00038bc8;
                        LAB_000387d4:
                            if (uVar18 != 0x82060000)
                                goto joined_r0x00038a24;
                            iVar28 = FUN_00036a5c(__src, 0, param_1);
                            if (iVar28 == 0x100) {
                                iVar28 = FUN_00038530(__src);
                                if (iVar28 == 0)
                                    goto LAB_00039268;
                                iVar17 = *(int *)(iVar28 + 0x10);
                                *(uint *)(param_1 + 300) =
                                    *(uint *)(param_1 + 300) & 0xffffff7f;
                                uVar20 = *(undefined4 *)(iVar28 + 0x30);
                                uVar21 = *(undefined4 *)(iVar28 + 0x34);
                                uVar4 = *(undefined4 *)(iVar28 + 4);
                                *(uint *)(param_1 + 0x88) =
                                    *(uint *)(param_1 + 0x88) | 0x2000;
                                pcVar7 = OBJ_nid2ln(iVar17);
                                uVar3 = __src[3];
                                FUN_0007d00c(auStack_12c, 0x100,
                                             "sign %s %s 0x%x %s (%u) fs %u",
                                             uVar20, uVar21, uVar4, pcVar7,
                                             iVar17,
                                             uVar3 << 0x18 |
                                                 (uVar3 >> 8 & 0xff) << 0x10 |
                                                 (uVar3 >> 0x10 & 0xff) << 8 |
                                                 uVar3 >> 0x18);
                                goto LAB_00038bb0;
                            }
                        } else {
                        LAB_000388ac:
                            if (uVar18 == 0x82080000) {
                                iVar28 = FUN_00036a5c(__src, 0, param_1);
                                if (iVar28 == 0x100) {
                                    iVar28 = *(int *)(param_1 + 0xac);
                                    if (iVar28 == 0) {
                                        FUN_00075d40(
                                            5, "crypto_gq: scheme unavailable");
                                        iVar28 = 0x10e;
                                    } else {
                                        uVar3 = __src[3];
                                        if ((uVar3 << 0x18 |
                                             (uVar3 >> 8 & 0xff) << 0x10 |
                                             (uVar3 >> 0x10 & 0xff) << 8 |
                                             uVar3 >> 0x18) <
                                            *(uint *)(iVar28 + 0xc)) {
                                            iVar28 = 0x103;
                                            FUN_00075d40(5,
                                                         "crypto_gq: invalid "
                                                         "filestamp %u");
                                        } else {
                                            iVar28 = EVP_PKEY_get0_RSA(
                                                *(undefined4 *)(iVar28 + 4));
                                            if (iVar28 == 0) {
                                                FUN_00075d40(
                                                    5,
                                                    "crypto_gq: defective key");
                                                iVar28 = 0x104;
                                            } else {
                                                RSA_get0_key(iVar28, &local_13c,
                                                             0, &local_138);
                                                if (*(int *)(param_1 + 0xb0) ==
                                                    0) {
                                                    FUN_00075d40(
                                                        5, "crypto_gq: missing "
                                                           "challenge");
                                                    iVar28 = 0x10e;
                                                } else {
                                                    pBVar10 = BN_CTX_new();
                                                    pBVar11 = BN_new();
                                                    pBVar12 = BN_new();
                                                    uVar3 = __src[4];
                                                    local_140 =
                                                        (BIGNUM *)(__src + 5);
                                                    pDVar5 = d2i_DSA_SIG(
                                                        (DSA_SIG **)0x0,
                                                        (uchar **)&local_140,
                                                        uVar3 << 0x18 |
                                                            (uVar3 >> 8 & 0xff)
                                                                << 0x10 |
                                                            (uVar3 >> 0x10 &
                                                             0xff)
                                                                << 8 |
                                                            uVar3 >> 0x18);
                                                    if (pDVar5 ==
                                                        (DSA_SIG *)0x0) {
                                                        iVar28 = 0x10f;
                                                        BN_CTX_free(pBVar10);
                                                        BN_free(pBVar11);
                                                        BN_free(pBVar12);
                                                        uVar14 =
                                                            ERR_get_error();
                                                        pcVar7 =
                                                            ERR_error_string(
                                                                uVar14,
                                                                (char *)0x0);
                                                        FUN_00075d40(
                                                            3, "crypto_gq: %s",
                                                            pcVar7);
                                                    } else {
                                                        DSA_SIG_get0(
                                                            pDVar5, &local_134,
                                                            &local_130);
                                                        if (*(BIGNUM *
                                                                  *)(param_1 +
                                                                     0xb4) ==
                                                            (BIGNUM *)0x0) {
                                                            FUN_00075d40(
                                                                5, "crypto_gq: "
                                                                   "missing "
                                                                   "group key");
                                                            iVar28 = 0x10e;
                                                        } else {
                                                            BN_mod_exp(
                                                                pBVar12,
                                                                *(BIGNUM *
                                                                      *)(param_1 +
                                                                         0xb4),
                                                                *(BIGNUM *
                                                                      *)(param_1 +
                                                                         0xb0),
                                                                local_13c,
                                                                pBVar10);
                                                            BN_mod_exp(
                                                                pBVar11,
                                                                local_134,
                                                                local_138,
                                                                local_13c,
                                                                pBVar10);
                                                            BN_mod_mul(
                                                                pBVar11,
                                                                pBVar12,
                                                                pBVar11,
                                                                local_13c,
                                                                pBVar10);
                                                            FUN_00036970(
                                                                pBVar11,
                                                                pBVar11);
                                                            iVar28 = BN_cmp(
                                                                pBVar11,
                                                                local_130);
                                                            BN_CTX_free(
                                                                pBVar10);
                                                            BN_free(pBVar11);
                                                            BN_free(pBVar12);
                                                            BN_free(*(
                                                                BIGNUM *
                                                                    *)(param_1 +
                                                                       0xb0));
                                                            *(undefined4
                                                                  *)(param_1 +
                                                                     0xb0) = 0;
                                                            DSA_SIG_free(
                                                                pDVar5);
                                                            if (iVar28 == 0) {
                                                                uVar3 =
                                                                    __src[3];
                                                                uVar3 =
                                                                    uVar3
                                                                        << 0x18 |
                                                                    (uVar3 >>
                                                                         8 &
                                                                     0xff)
                                                                        << 0x10 |
                                                                    (uVar3 >>
                                                                         0x10 &
                                                                     0xff)
                                                                        << 8 |
                                                                    uVar3 >>
                                                                        0x18;
                                                                uVar4 = *(
                                                                    undefined4
                                                                        *)(param_1 +
                                                                           0x98);
                                                                *(uint
                                                                      *)(param_1 +
                                                                         300) =
                                                                    *(uint
                                                                          *)(param_1 +
                                                                             300) &
                                                                    0xffffff7f;
                                                                *(uint
                                                                      *)(param_1 +
                                                                         0x88) =
                                                                    *(uint
                                                                          *)(param_1 +
                                                                             0x88) |
                                                                    0x200;
                                                                pcVar7 =
                                                                    "gq %s fs "
                                                                    "%u";
                                                                goto LAB_000395e4;
                                                            }
                                                            FUN_00075d40(
                                                                5,
                                                                "crypto_gq: "
                                                                "identity not "
                                                                "verified");
                                                            iVar28 = 0x10e;
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            } else {
                                if (uVar18 != 0x82090000)
                                    goto joined_r0x00038a24;
                                iVar28 = FUN_00036a5c(__src, 0, param_1);
                                if (iVar28 == 0x100) {
                                    iVar28 = *(int *)(param_1 + 0xac);
                                    if (iVar28 == 0) {
                                        FUN_00075d40(
                                            5, "crypto_mv: scheme unavailable");
                                        iVar28 = 0x10e;
                                    } else {
                                        uVar3 = __src[3];
                                        if ((uVar3 << 0x18 |
                                             (uVar3 >> 8 & 0xff) << 0x10 |
                                             (uVar3 >> 0x10 & 0xff) << 8 |
                                             uVar3 >> 0x18) ==
                                            *(uint *)(iVar28 + 0xc)) {
                                            iVar28 = EVP_PKEY_get0_DSA(
                                                *(undefined4 *)(iVar28 + 4));
                                            if (iVar28 == 0) {
                                                FUN_00075d40(
                                                    5,
                                                    "crypto_mv: defective key");
                                                iVar28 = 0x104;
                                            } else {
                                                DSA_get0_pqg(iVar28, &local_144,
                                                             0);
                                                DSA_get0_key(iVar28, &local_140,
                                                             &local_13c);
                                                if (*(int *)(param_1 + 0xb0) ==
                                                    0) {
                                                    FUN_00075d40(
                                                        5, "crypto_mv: missing "
                                                           "challenge");
                                                    iVar28 = 0x10e;
                                                } else {
                                                    pBVar10 = BN_CTX_new();
                                                    pBVar11 = BN_new();
                                                    pBVar12 = BN_new();
                                                    r = BN_new();
                                                    uVar3 = __src[4];
                                                    local_148 = __src + 5;
                                                    r_00 = d2i_DSAparams(
                                                        (DSA **)0x0,
                                                        (uchar **)&local_148,
                                                        uVar3 << 0x18 |
                                                            (uVar3 >> 8 & 0xff)
                                                                << 0x10 |
                                                            (uVar3 >> 0x10 &
                                                             0xff)
                                                                << 8 |
                                                            uVar3 >> 0x18);
                                                    if (r_00 == (DSA *)0x0) {
                                                        uVar14 =
                                                            ERR_get_error();
                                                        pcVar7 =
                                                            ERR_error_string(
                                                                uVar14,
                                                                (char *)0x0);
                                                        FUN_00075d40(
                                                            3, "crypto_mv: %s",
                                                            pcVar7);
                                                        iVar28 = 0x10f;
                                                    } else {
                                                        DSA_get0_pqg(
                                                            r_00, &local_138,
                                                            &local_134,
                                                            &local_130);
                                                        BN_mod_exp(
                                                            pBVar12, local_134,
                                                            local_140,
                                                            local_144, pBVar10);
                                                        BN_mod_exp(r, local_130,
                                                                   local_13c,
                                                                   local_144,
                                                                   pBVar10);
                                                        BN_mod_mul(
                                                            pBVar12, pBVar12, r,
                                                            local_144, pBVar10);
                                                        BN_mod_mul(
                                                            pBVar12, pBVar12,
                                                            local_138,
                                                            local_144, pBVar10);
                                                        iVar28 = BN_cmp(
                                                            pBVar12,
                                                            *(BIGNUM *
                                                                  *)(param_1 +
                                                                     0xb0));
                                                        BN_CTX_free(pBVar10);
                                                        BN_free(pBVar11);
                                                        BN_free(pBVar12);
                                                        BN_free(r);
                                                        BN_free(*(
                                                            BIGNUM **)(param_1 +
                                                                       0xb0));
                                                        *(undefined4
                                                              *)(param_1 +
                                                                 0xb0) = 0;
                                                        DSA_free(r_00);
                                                        if (iVar28 == 0) {
                                                            uVar3 = __src[3];
                                                            uVar3 =
                                                                uVar3 << 0x18 |
                                                                (uVar3 >> 8 &
                                                                 0xff)
                                                                    << 0x10 |
                                                                (uVar3 >> 0x10 &
                                                                 0xff)
                                                                    << 8 |
                                                                uVar3 >> 0x18;
                                                            uVar4 = *(
                                                                undefined4
                                                                    *)(param_1 +
                                                                       0x98);
                                                            *(uint *)(param_1 +
                                                                      300) =
                                                                *(uint
                                                                      *)(param_1 +
                                                                         300) &
                                                                0xffffff7f;
                                                            *(uint *)(param_1 +
                                                                      0x88) =
                                                                *(uint
                                                                      *)(param_1 +
                                                                         0x88) |
                                                                0x200;
                                                            pcVar7 =
                                                                "mv %s fs %u";
                                                            goto LAB_000395e4;
                                                        }
                                                        FUN_00075d40(
                                                            5, "crypto_mv: "
                                                               "identity not "
                                                               "verified");
                                                        iVar28 = 0x10e;
                                                    }
                                                }
                                            }
                                        } else {
                                            iVar28 = 0x103;
                                            FUN_00075d40(5,
                                                         "crypto_mv: invalid "
                                                         "filestamp %u");
                                        }
                                    }
                                }
                            }
                        }
                        goto LAB_00038804;
                    }
                    if (uVar18 == 0x82010000)
                        goto LAB_00038ad0;
                    if (uVar18 < 0x82010001) {
                    LAB_00038a64:
                        if (uVar18 != 0x2010000)
                            goto joined_r0x00038a24;
                        if ((*(uint *)(param_1 + 0x88) & 0x100) != 0) {
                        LAB_00038a28:
                            iVar28 = 0x10f;
                            goto LAB_0003880c;
                        }
                        if (*(void **)(param_1 + 0xe8) != (void *)0x0) {
                            if (*(ushort *)(param_1 + 0x84) != uVar24)
                                goto LAB_00038a28;
                            free(*(void **)(param_1 + 0xe8));
                        }
                        pvVar9 = (void *)FUN_00074b04(0, uVar22, 0);
                        pvVar9 = memcpy(pvVar9, __src, uVar22);
                        *(uint *)((int)pvVar9 + 4) =
                            (uint) * (ushort *)(param_1 + 0x3c) << 0x18 |
                            (uint)(*(ushort *)(param_1 + 0x3c) >> 8) << 0x10;
                        *(void **)(param_1 + 0xe8) = pvVar9;
                        goto LAB_00038ad0;
                    }
                    if (uVar18 != 0x82020000) {
                        uVar3 = uVar26;
                        if (uVar18 != 0x82030000)
                            goto joined_r0x00038a24;
                        goto LAB_00038950;
                    }
                    iVar28 = FUN_00036a5c(__src, 0, param_1);
                    if (iVar28 != 0x100)
                        goto LAB_00038804;
                    iVar28 = FUN_00038530(__src);
                    if (iVar28 == 0) {
                    LAB_00039268:
                        uVar3 = *__src;
                        iVar28 = 0x10d;
                        uVar25 = uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                                 (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18;
                        goto LAB_0003880c;
                    }
                    if (*(void **)(param_1 + 0x98) != (void *)0x0) {
                        free(*(void **)(param_1 + 0x98));
                    }
                    uVar4 = FUN_00074c8c(*(undefined4 *)(iVar28 + 0x34));
                    iVar19 = *(int *)(param_1 + 0x9c);
                    pcVar7 = *(char **)(iVar28 + 0x34);
                    *(int *)(param_1 + 0x9c) = iVar28;
                    *(undefined4 *)(param_1 + 0x98) = uVar4;
                    iVar17 = strcmp(*(char **)(iVar28 + 0x30), pcVar7);
                    if (iVar17 == 0) {
                        if ((*(uint *)(iVar28 + 4) & 1) != 0) {
                            uVar3 = *(uint *)(param_1 + 0x88);
                            uVar4 = *(undefined4 *)(iVar28 + 0x38);
                            *(uint *)(param_1 + 0x88) = uVar3 | 0x100;
                            *(undefined4 *)(param_1 + 0xb4) = uVar4;
                            if ((*(int *)(param_1 + 0x50) == 0) ||
                                ((uVar3 & 0xf0) == 0)) {
                                *(uint *)(param_1 + 0x88) = uVar3 | 0x300;
                            }
                            goto LAB_00038ff4;
                        }
                    } else {
                    LAB_00038ff4:
                        if (iVar19 != 0) {
                            local_130 = *(BIGNUM **)(iVar19 + 0x48);
                            uVar3 = *(uint *)(iVar19 + 0x44);
                            pXVar6 = d2i_X509(
                                (X509 **)0x0, (uchar **)&local_130,
                                uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                                    (uVar3 >> 0x10 & 0xff) << 8 |
                                    uVar3 >> 0x18);
                            if (pXVar6 == (X509 *)0x0) {
                                iVar28 = 0x10d;
                                *(uint *)(iVar19 + 4) =
                                    *(uint *)(iVar19 + 4) | 0x80;
                            } else {
                                iVar17 = X509_verify(
                                    pXVar6, *(EVP_PKEY **)(iVar28 + 8));
                                if (iVar17 < 1) {
                                    iVar28 = 0x109;
                                    X509_free(pXVar6);
                                    *(uint *)(iVar19 + 4) =
                                        *(uint *)(iVar19 + 4) | 0x80;
                                } else {
                                    X509_free(pXVar6);
                                    iVar17 = FUN_00036cd4(iVar19 + 0x1c,
                                                          iVar28 + 0x1c);
                                    if ((-1 < iVar17) &&
                                        (iVar17 = FUN_00036cd4(iVar19 + 0x1c,
                                                               iVar28 + 0x26),
                                         iVar17 < 1)) {
                                        *(uint *)(iVar19 + 4) =
                                            *(uint *)(iVar19 + 4) | 2;
                                        goto LAB_00039798;
                                    }
                                    iVar28 = 0x10a;
                                    *(uint *)(iVar19 + 4) =
                                        *(uint *)(iVar19 + 4) | 0x80;
                                }
                            }
                        LAB_00038804:
                            uVar3 = *__src;
                            uVar25 =
                                uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                                (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18;
                            goto LAB_0003880c;
                        }
                    }
                LAB_00039798:
                    if (*(int *)(param_1 + 0x8c) == 0) {
                        local_14c = *(uchar **)(iVar28 + 0x48);
                        uVar3 = *(uint *)(iVar28 + 0x44);
                        pXVar6 = d2i_X509(
                            (X509 **)0x0, &local_14c,
                            uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                                (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18);
                        pEVar15 = X509_get_pubkey(pXVar6);
                        *(EVP_PKEY **)(param_1 + 0x8c) = pEVar15;
                        X509_free(pXVar6);
                    }
                    uVar4 = *(undefined4 *)(iVar28 + 0x30);
                    iVar17 = *(int *)(iVar28 + 0x10);
                    uVar20 = *(undefined4 *)(iVar28 + 0x34);
                    *(uint *)(param_1 + 300) =
                        *(uint *)(param_1 + 300) & 0xffffff7f;
                    uVar21 = *(undefined4 *)(iVar28 + 4);
                    pcVar7 = OBJ_nid2ln(iVar17);
                    uVar3 = __src[3];
                    FUN_0007d00c(
                        auStack_12c, 0x100, "cert %s %s 0x%x %s (%u) fs %u",
                        uVar4, uVar20, uVar21, pcVar7, iVar17,
                        uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                            (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18);
                }
            LAB_00038bb0:
                FUN_000532d0(param_1 + 0x10, auStack_12c);
            LAB_00038bbc:
                iVar28 = *(int *)(param_2 + 0x54);
            }
        LAB_000389d4:
            iVar23 = (uVar22 + 3 & 0xfffffffc) + iVar23;
            uVar3 = iVar28 - iVar23;
        } while (0x18 < (int)uVar3);
    }
    iVar28 = 0x100;
LAB_00038850:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar28);
    }
    return;
}

void FUN_00039b24(int param_1, int param_2, int param_3, int param_4,
                  uint *param_5)

{
    int iVar1;
    int iVar2;
    BIGNUM *pBVar3;
    BN_CTX *pBVar4;
    uint uVar5;
    DSA_SIG *pDVar6;
    undefined4 uVar7;
    EVP_PKEY *pEVar8;
    RSA *rsa;
    BIGNUM *pBVar9;
    BIGNUM *pBVar10;
    DSA *a;
    BIGNUM *pBVar11;
    BIGNUM *r;
    BIGNUM *r_00;
    BIGNUM *pBVar12;
    X509 *x;
    X509 *x_00;
    long version;
    ASN1_INTEGER *a_00;
    ASN1_TIME *pAVar13;
    X509_NAME *pXVar14;
    size_t len;
    X509_EXTENSION *ex;
    int iVar15;
    EVP_MD_CTX *pEVar16;
    ulong uVar17;
    char *pcVar18;
    uint uVar19;
    uint uVar20;
    uint uVar21;
    uint uVar22;
    int iVar23;
    undefined4 uVar24;
    int loc;
    int *piVar25;
    int *piVar26;
    int *piVar27;
    int *piVar28;
    uint uVar29;
    uint uVar30;
    uint local_290;
    int local_28c;
    int local_288;
    BIGNUM *local_26c;
    BIGNUM *local_268;
    BIGNUM *local_264;
    BIGNUM *local_260;
    BIGNUM *local_25c;
    BIGNUM *local_258;
    BIGNUM *local_254[3];
    uint local_248;
    uint local_244;
    uint local_240;
    BIGNUM *local_23c;
    uint local_238;
    uchar *local_234;
    char acStack_230[516];
    int local_2c;

    iVar23 = param_4 + 3;
    if (-1 < param_4) {
        iVar23 = param_4;
    }
    iVar23 = iVar23 >> 2;
    local_2c = __stack_chk_guard;
    iVar1 = param_2 + iVar23 * 4;
    uVar22 = *param_5;
    uVar30 = uVar22 >> 8 & 0xff;
    uVar5 = uVar22 << 0x18 | uVar30 << 0x10;
    uVar21 = (uVar22 >> 0x10 & 0xff) << 8;
    uVar29 = uVar5 | uVar21 | uVar22 >> 0x18;
    if (param_1 == 0) {
        uVar20 = param_5[1];
        local_28c = param_3 + 4;
        uVar19 = (uVar20 >> 0x10 & 0xff) << 8;
        local_290 = uVar19 | uVar20 >> 0x18;
        *(uint *)(param_2 + iVar23 * 4) =
            uVar30 << 8 | 0x8000000 | uVar22 & 0xff;
        *(uint *)(iVar1 + 4) = uVar20;
        local_288 = FUN_000368fc();
        if (uVar5 == 0x82010000) {
        LAB_0003a9dc:
            uVar24 = FUN_00036740(iVar1, hostval, param_4);
            *(uint *)(iVar1 + 0xc) =
                crypto_flags << 0x18 | (crypto_flags >> 8 & 0xff) << 0x10 |
                (crypto_flags >> 0x10 & 0xff) << 8 | crypto_flags >> 0x18;
            goto LAB_00039c10;
        }
        if (uVar5 < 0x82010001) {
            if (uVar5 == 0x2060000)
                goto LAB_0003a968;
            if (uVar5 < 0x2060001) {
                if (uVar5 == 0x2020000)
                    goto LAB_00039e64;
                if (uVar5 == 0x2030000)
                    goto LAB_0003aa10;
                if (uVar5 == 0x2010000)
                    goto LAB_0003a9dc;
            } else if (((uVar5 == 0x2080000) || (uVar5 == 0x2090000)) ||
                       (uVar5 == 0x2070000))
                goto LAB_00039c08;
        } else {
            if (uVar5 == 0x82050000)
                goto LAB_0003a94c;
            if (uVar5 < 0x82050001) {
                if (uVar5 == 0x82030000) {
                LAB_0003a3a4:
                    uVar5 = param_5[4];
                    pBVar3 =
                        (BIGNUM *)(uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                                   (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18);
                    if (((undefined1 *)((int)&pBVar3[-1].flags + 3U) <
                         (undefined1 *)0xffe6) &&
                        (&pBVar3[1].top <=
                         (undefined1 *)(uVar21 | uVar22 >> 0x18))) {
                        local_25c = (BIGNUM *)(param_5 + 5);
                        local_258 = pBVar3;
                        pEVar8 =
                            d2i_PublicKey(6, (EVP_PKEY **)0x0,
                                          (uchar **)&local_25c, (long)pBVar3);
                        if (pEVar8 == (EVP_PKEY *)0x0) {
                            uVar17 = ERR_get_error();
                            pcVar18 = ERR_error_string(uVar17, (char *)0x0);
                            uVar24 = 0x104;
                            FUN_00075d40(3, "crypto_encrypt: %s", pcVar18);
                        } else {
                            local_248 = 0;
                            local_244 = 0;
                            local_240 = 0;
                            local_23c = (BIGNUM *)0x0;
                            local_238 = 0;
                            local_234 = (uchar *)0x0;
                            uVar5 = FUN_000368fc();
                            local_248 =
                                uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                                (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
                            local_244 = hostval._0_4_;
                            local_258 = (BIGNUM *)EVP_PKEY_size(pEVar8);
                            local_240 = (int)local_258 << 0x18 |
                                        ((uint)local_258 >> 8 & 0xff) << 0x10 |
                                        ((uint)local_258 >> 0x10 & 0xff) << 8 |
                                        (uint)local_258 >> 0x18;
                            pBVar3 = (BIGNUM *)FUN_00074b04(0, local_258, 0, 0);
                            local_23c = pBVar3;
                            rsa = (RSA *)EVP_PKEY_get0_RSA(pEVar8);
                            iVar2 = RSA_public_encrypt(4, (uchar *)local_254,
                                                       (uchar *)pBVar3, rsa, 4);
                            if (0 < iVar2) {
                                EVP_PKEY_free(pEVar8);
                                if (uVar5 != 0) {
                                    local_234 = (uchar *)FUN_00074b04(
                                        0, DAT_000ca8e4, 0, 0);
                                    pEVar16 = (EVP_MD_CTX *)EVP_MD_CTX_new();
                                    EVP_DigestInit(pEVar16, DAT_000ca8e8);
                                    EVP_DigestUpdate(pEVar16, &local_248, 0xc);
                                    EVP_DigestUpdate(pEVar16, local_23c,
                                                     (size_t)local_258);
                                    iVar23 = EVP_SignFinal(pEVar16, local_234,
                                                           (uint *)&local_258,
                                                           DAT_000ca8e0);
                                    if (iVar23 != 0) {
                                        pBVar3 = local_258;
                                        if (DAT_000ca8e4 < local_258) {
                                            /* WARNING: Subroutine does not
                                             * return */
                                            FUN_0007fc54(
                                                "ntp_crypto.c", 0x65f, 2,
                                                "vallen <= sign_siglen");
                                        }
                                        goto LAB_0003a03c;
                                    }
                                    goto LAB_0003a044;
                                }
                                goto LAB_00039d6c;
                            }
                            uVar17 = ERR_get_error();
                            pcVar18 = ERR_error_string(uVar17, (char *)0x0);
                            uVar24 = 0x10b;
                            FUN_00075d40(3, "crypto_encrypt: %s", pcVar18);
                            free(local_23c);
                            EVP_PKEY_free(pEVar8);
                        }
                        goto LAB_0003a348;
                    }
                    goto LAB_0003a344;
                }
                if (uVar5 == 0x82040000) {
                    param_1 = FUN_0004217c(uVar19 | uVar20 >> 0x18);
                    if (param_1 != 0)
                        goto LAB_00039e0c;
                    goto LAB_0003adb8;
                }
                if (uVar5 == 0x82020000)
                    goto LAB_0003acac;
            } else {
                if (uVar5 == 0x82070000)
                    goto LAB_0003a2ec;
                if (uVar5 < 0x82070001) {
                    if (uVar5 == 0x82060000)
                        goto LAB_0003b068;
                } else {
                    if (uVar5 == 0x82080000)
                        goto LAB_0003a050;
                    if (uVar5 == 0x82090000)
                        goto LAB_0003a600;
                }
            }
        }
        if (-1 < (int)uVar29) {
        LAB_00039c08:
            uVar24 = 8;
            goto LAB_00039c10;
        }
        goto LAB_0003adb8;
    }
    local_28c = param_1 + 0x10;
    if (-1 < (int)uVar29) {
        uVar5 = uVar5 >> 0x10;
        uVar21 = param_5[1];
        *(uint *)(param_1 + 0x80) = uVar22;
        local_290 = (uVar21 >> 0x10 & 0xff) << 8 | uVar21 >> 0x18;
        *(uint *)(param_2 + iVar23 * 4) =
            uVar30 << 8 | 0x8000000 | uVar5 * 0x10000 >> 0x18;
        *(uint *)(iVar1 + 4) = uVar21;
        local_288 = FUN_000368fc();
        if (uVar5 == 0x206) {
        LAB_0003a968:
            FUN_00077758(local_254, local_288, 0);
            piVar28 = cert_host;
            iVar2 = FUN_00036cd4(local_254, cert_host + 7);
            if ((-1 < iVar2) &&
                (iVar2 = FUN_00036cd4(local_254, (int)piVar28 + 0x26),
                 iVar2 < 1)) {
            LAB_0003a9b0:
                uVar24 = FUN_00036740(iVar1, piVar28 + 0xf, param_4);
                goto LAB_00039c10;
            }
            uVar24 = 0x10a;
        } else {
            if (uVar5 * 0x10000 < 0x2060000 || uVar5 == 0x206) {
                if (uVar5 == 0x202) {
                LAB_00039e64:
                    local_244 = param_5[3];
                    local_248 = param_5[2];
                    local_240 = param_5[4];
                    local_23c = (BIGNUM *)(param_5 + 5);
                    local_238 = 0;
                    local_234 = (uchar *)0x0;
                    uVar24 = FUN_00036740(iVar1, &local_248, param_4);
                    goto LAB_00039c10;
                }
                if (uVar5 != 0x203) {
                    if (uVar5 == 0x201)
                        goto LAB_0003a9dc;
                    goto LAB_00039c08;
                }
            LAB_0003aa10:
                iVar23 = 0x8c4;
                goto LAB_0003a950;
            }
            if (uVar5 == 0x208) {
                if (*(int *)(param_1 + 0xac) == 0) {
                LAB_0003b03c:
                    uVar24 = 0x10e;
                } else {
                    iVar2 = EVP_PKEY_get0_RSA(
                        *(undefined4 *)(*(int *)(param_1 + 0xac) + 4));
                    if (iVar2 != 0) {
                        if (*(BIGNUM **)(param_1 + 0xb0) != (BIGNUM *)0x0) {
                            BN_free(*(BIGNUM **)(param_1 + 0xb0));
                        }
                        pBVar3 = BN_new();
                        *(BIGNUM **)(param_1 + 0xb0) = pBVar3;
                        RSA_get0_key(iVar2, local_254, 0);
                        iVar23 = BN_num_bits(local_254[0]);
                        iVar2 = iVar23 + 7;
                        if (iVar2 < 0) {
                            iVar2 = iVar23 + 0xe;
                        }
                        local_258 = (BIGNUM *)(iVar2 >> 3);
                        BN_rand(*(BIGNUM **)(param_1 + 0xb0),
                                (int)local_258 << 3, -1, 1);
                        pBVar4 = BN_CTX_new();
                        BN_div((BIGNUM *)0x0, *(BIGNUM **)(param_1 + 0xb0),
                               *(BIGNUM **)(param_1 + 0xb0), local_254[0],
                               pBVar4);
                        BN_CTX_free(pBVar4);
                        local_248 = 0;
                        local_244 = 0;
                        local_240 = 0;
                        local_23c = (BIGNUM *)0x0;
                        local_238 = 0;
                        local_234 = (uchar *)0x0;
                        uVar5 = FUN_000368fc();
                        uVar30 = *(uint *)(*(int *)(param_1 + 0xac) + 0xc);
                        local_244 =
                            uVar30 << 0x18 | (uVar30 >> 8 & 0xff) << 0x10 |
                            (uVar30 >> 0x10 & 0xff) << 8 | uVar30 >> 0x18;
                        local_248 = uVar5 << 0x18 |
                                    (uVar5 >> 8 & 0xff) << 0x10 |
                                    (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
                        local_240 = (int)local_258 << 0x18 |
                                    ((uint)local_258 >> 8 & 0xff) << 0x10 |
                                    ((uint)local_258 >> 0x10 & 0xff) << 8 |
                                    (uint)local_258 >> 0x18;
                        local_23c = (BIGNUM *)FUN_00074b04(0, local_258, 0, 0);
                        BN_bn2bin(*(BIGNUM **)(param_1 + 0xb0),
                                  (uchar *)local_23c);
                        if (uVar5 != 0) {
                            local_234 =
                                (uchar *)FUN_00074b04(0, DAT_000ca8e4, 0, 0);
                            pEVar16 = (EVP_MD_CTX *)EVP_MD_CTX_new();
                            EVP_DigestInit(pEVar16, DAT_000ca8e8);
                            EVP_DigestUpdate(pEVar16, &local_248, 0xc);
                            EVP_DigestUpdate(pEVar16, local_23c,
                                             (size_t)local_258);
                            iVar23 =
                                EVP_SignFinal(pEVar16, local_234,
                                              (uint *)&local_258, DAT_000ca8e0);
                            if (iVar23 != 0) {
                                pBVar3 = local_258;
                                if (DAT_000ca8e4 < local_258) {
                                    /* WARNING: Subroutine does not return */
                                    FUN_0007fc54("ntp_crypto.c", 0x9fa, 2,
                                                 "len <= sign_siglen");
                                }
                            LAB_0003a03c:
                                local_238 = (int)pBVar3 << 0x18 |
                                            ((uint)pBVar3 >> 8 & 0xff) << 0x10 |
                                            ((uint)pBVar3 >> 0x10 & 0xff) << 8 |
                                            (uint)pBVar3 >> 0x18;
                            }
                        LAB_0003a044:
                            EVP_MD_CTX_free(pEVar16);
                        }
                    LAB_00039d6c:
                        uVar24 = FUN_00036740(iVar1, &local_248, param_4);
                        FUN_00037f0c(&local_248);
                        goto LAB_00039c10;
                    }
                    uVar24 = 0x104;
                    FUN_00075d40(5, "crypto_alice2: defective key");
                }
            } else if (uVar5 == 0x209) {
                if (*(int *)(param_1 + 0xac) == 0)
                    goto LAB_0003b03c;
                iVar2 = EVP_PKEY_get0_DSA(
                    *(undefined4 *)(*(int *)(param_1 + 0xac) + 4));
                if (iVar2 != 0) {
                    DSA_get0_pqg(iVar2, local_254, 0);
                    if (*(BIGNUM **)(param_1 + 0xb0) != (BIGNUM *)0x0) {
                        BN_free(*(BIGNUM **)(param_1 + 0xb0));
                    }
                    pBVar3 = BN_new();
                    *(BIGNUM **)(param_1 + 0xb0) = pBVar3;
                    iVar23 = BN_num_bits(local_254[0]);
                    iVar2 = iVar23 + 7;
                    if (iVar2 < 0) {
                        iVar2 = iVar23 + 0xe;
                    }
                    local_258 = (BIGNUM *)(iVar2 >> 3);
                    BN_rand(*(BIGNUM **)(param_1 + 0xb0), (int)local_258 << 3,
                            -1, 1);
                    pBVar4 = BN_CTX_new();
                    BN_div((BIGNUM *)0x0, *(BIGNUM **)(param_1 + 0xb0),
                           *(BIGNUM **)(param_1 + 0xb0), local_254[0], pBVar4);
                    BN_CTX_free(pBVar4);
                    local_248 = 0;
                    local_244 = 0;
                    local_240 = 0;
                    local_23c = (BIGNUM *)0x0;
                    local_238 = 0;
                    local_234 = (uchar *)0x0;
                    uVar5 = FUN_000368fc();
                    uVar30 = *(uint *)(*(int *)(param_1 + 0xac) + 0xc);
                    local_244 = uVar30 << 0x18 | (uVar30 >> 8 & 0xff) << 0x10 |
                                (uVar30 >> 0x10 & 0xff) << 8 | uVar30 >> 0x18;
                    local_248 = uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                                (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
                    local_240 = (int)local_258 << 0x18 |
                                ((uint)local_258 >> 8 & 0xff) << 0x10 |
                                ((uint)local_258 >> 0x10 & 0xff) << 8 |
                                (uint)local_258 >> 0x18;
                    local_23c = (BIGNUM *)FUN_00074b04(0, local_258, 0, 0);
                    BN_bn2bin(*(BIGNUM **)(param_1 + 0xb0), (uchar *)local_23c);
                    if (uVar5 != 0) {
                        local_234 =
                            (uchar *)FUN_00074b04(0, DAT_000ca8e4, 0, 0);
                        pEVar16 = (EVP_MD_CTX *)EVP_MD_CTX_new();
                        EVP_DigestInit(pEVar16, DAT_000ca8e8);
                        EVP_DigestUpdate(pEVar16, &local_248, 0xc);
                        EVP_DigestUpdate(pEVar16, local_23c, (size_t)local_258);
                        iVar23 =
                            EVP_SignFinal(pEVar16, local_234,
                                          (uint *)&local_258, DAT_000ca8e0);
                        if (iVar23 != 0) {
                            pBVar3 = local_258;
                            if (DAT_000ca8e4 < local_258) {
                                /* WARNING: Subroutine does not return */
                                FUN_0007fc54("ntp_crypto.c", 0xb52, 2,
                                             "len <= sign_siglen");
                            }
                            goto LAB_0003a03c;
                        }
                        goto LAB_0003a044;
                    }
                    goto LAB_00039d6c;
                }
                uVar24 = 0x104;
                FUN_00075d40(5, "crypto_alice3: defective key");
            } else {
                if (uVar5 != 0x207)
                    goto LAB_00039c08;
                if (*(int *)(param_1 + 0xac) == 0) {
                    uVar24 = 0x10e;
                    FUN_00075d40(5, "crypto_alice: scheme unavailable");
                } else {
                    iVar2 = EVP_PKEY_get0_DSA(
                        *(undefined4 *)(*(int *)(param_1 + 0xac) + 4));
                    if (iVar2 != 0) {
                        if (*(BIGNUM **)(param_1 + 0xb0) != (BIGNUM *)0x0) {
                            BN_free(*(BIGNUM **)(param_1 + 0xb0));
                        }
                        pBVar3 = BN_new();
                        *(BIGNUM **)(param_1 + 0xb0) = pBVar3;
                        DSA_get0_pqg(iVar2, 0, local_254);
                        iVar23 = BN_num_bits(local_254[0]);
                        iVar2 = iVar23 + 7;
                        if (iVar2 < 0) {
                            iVar2 = iVar23 + 0xe;
                        }
                        local_258 = (BIGNUM *)(iVar2 >> 3);
                        BN_rand(*(BIGNUM **)(param_1 + 0xb0),
                                (int)local_258 << 3, -1, 1);
                        pBVar4 = BN_CTX_new();
                        BN_div((BIGNUM *)0x0, *(BIGNUM **)(param_1 + 0xb0),
                               *(BIGNUM **)(param_1 + 0xb0), local_254[0],
                               pBVar4);
                        BN_CTX_free(pBVar4);
                        local_248 = 0;
                        local_244 = 0;
                        local_240 = 0;
                        local_23c = (BIGNUM *)0x0;
                        local_238 = 0;
                        local_234 = (uchar *)0x0;
                        uVar5 = FUN_000368fc();
                        uVar30 = *(uint *)(*(int *)(param_1 + 0xac) + 0xc);
                        local_244 =
                            uVar30 << 0x18 | (uVar30 >> 8 & 0xff) << 0x10 |
                            (uVar30 >> 0x10 & 0xff) << 8 | uVar30 >> 0x18;
                        local_248 = uVar5 << 0x18 |
                                    (uVar5 >> 8 & 0xff) << 0x10 |
                                    (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
                        local_240 = (int)local_258 << 0x18 |
                                    ((uint)local_258 >> 8 & 0xff) << 0x10 |
                                    ((uint)local_258 >> 0x10 & 0xff) << 8 |
                                    (uint)local_258 >> 0x18;
                        local_23c = (BIGNUM *)FUN_00074b04(0, local_258, 0, 0);
                        BN_bn2bin(*(BIGNUM **)(param_1 + 0xb0),
                                  (uchar *)local_23c);
                        if (uVar5 != 0) {
                            local_234 =
                                (uchar *)FUN_00074b04(0, DAT_000ca8e4, 0, 0);
                            pEVar16 = (EVP_MD_CTX *)EVP_MD_CTX_new();
                            EVP_DigestInit(pEVar16, DAT_000ca8e8);
                            EVP_DigestUpdate(pEVar16, &local_248, 0xc);
                            EVP_DigestUpdate(pEVar16, local_23c,
                                             (size_t)local_258);
                            iVar23 =
                                EVP_SignFinal(pEVar16, local_234,
                                              (uint *)&local_258, DAT_000ca8e0);
                            if (iVar23 != 0) {
                                pBVar3 = local_258;
                                if (DAT_000ca8e4 < local_258) {
                                    /* WARNING: Subroutine does not return */
                                    FUN_0007fc54("ntp_crypto.c", 0x8b0, 2,
                                                 "len <= sign_siglen");
                                }
                                goto LAB_0003a03c;
                            }
                            goto LAB_0003a044;
                        }
                        goto LAB_00039d6c;
                    }
                    uVar24 = 0x104;
                    FUN_00075d40(5, "crypto_alice: defective key");
                }
            }
        }
        goto LAB_0003a348;
    }
    uVar19 = param_5[1];
    local_290 = (uVar19 >> 0x10 & 0xff) << 8 | uVar19 >> 0x18;
    *(uint *)(param_2 + iVar23 * 4) = uVar30 << 8 | 0x8000000 | uVar22 & 0xff;
    *(uint *)(iVar1 + 4) = uVar19;
    local_288 = FUN_000368fc();
    if (uVar5 == 0x82050000) {
    LAB_0003a94c:
        iVar23 = 0xa08;
    LAB_0003a950:
        uVar24 = FUN_00036740(
            iVar1, *(undefined4 *)((int)&__DT_PLTGOT + iVar23), param_4);
        goto LAB_00039c10;
    }
    if (uVar5 < 0x82050001) {
        if (uVar5 != 0x82020000) {
            if (uVar5 < 0x82020001) {
                if (uVar5 == 0x82010000)
                    goto LAB_0003a9dc;
            } else {
                if (uVar5 == 0x82030000)
                    goto LAB_0003a3a4;
                if (uVar5 == 0x82040000) {
                LAB_00039e0c:
                    *(uint *)(param_1 + 0x44) =
                        *(uint *)(param_1 + 0x44) & 0xffff7fff;
                    uVar24 = FUN_00036740(iVar1, param_1 + 0x110, param_4);
                    goto LAB_00039c10;
                }
            }
            goto LAB_0003adb8;
        }
    LAB_0003acac:
        uVar5 = (*param_5 >> 0x10 & 0xff) << 8 | *param_5 >> 0x18;
        if (0x13 < uVar5) {
            uVar30 = param_5[4];
            uVar30 = uVar30 << 0x18 | (uVar30 >> 8 & 0xff) << 0x10 |
                     (uVar30 >> 0x10 & 0xff) << 8 | uVar30 >> 0x18;
            if ((uVar30 <= uVar5 - 0x14) && (uVar30 - 1 < 0x200)) {
                __memcpy_chk(acStack_230, param_5 + 5, uVar30, 0x201);
                acStack_230[uVar30] = '\0';
                if (cinfo != (int *)0x0) {
                    piVar28 = (int *)0x0;
                    piVar25 = cinfo;
                    piVar26 = (int *)0x0;
                    do {
                        uVar5 = piVar25[1];
                        piVar27 = piVar26;
                        if (((((uVar5 & 0x88) == 0) &&
                              (iVar23 =
                                   strcmp(acStack_230, (char *)piVar25[0xc]),
                               iVar23 == 0)) &&
                             (iVar23 =
                                  strcmp(acStack_230, (char *)piVar25[0xd]),
                              piVar27 = piVar25, iVar23 == 0)) &&
                            (piVar27 = piVar26, (uVar5 & 1) != 0)) {
                            piVar28 = piVar25;
                        }
                        piVar25 = (int *)*piVar25;
                        piVar26 = piVar27;
                    } while (piVar25 != (int *)0x0);
                    if (((piVar28 != (int *)0x0) ||
                         (piVar28 = piVar27, piVar27 != (int *)0x0)) &&
                        (local_288 != 0))
                        goto LAB_0003a9b0;
                }
                goto LAB_00039c08;
            }
        }
        goto LAB_0003a344;
    }
    if (uVar5 == 0x82070000) {
    LAB_0003a2ec:
        if (iffkey_info == 0) {
            uVar24 = 0x10e;
            FUN_00075d40(5, "crypto_bob: scheme unavailable");
        } else {
            uVar24 = EVP_PKEY_get0_DSA(*(undefined4 *)(iffkey_info + 4));
            DSA_get0_pqg(uVar24, &local_260, &local_25c, &local_258);
            DSA_get0_key(uVar24, 0, local_254);
            uVar5 = (*param_5 >> 0x10 & 0xff) << 8 | *param_5 >> 0x18;
            if (0x13 < uVar5) {
                uVar30 = param_5[4];
                pBVar3 =
                    (BIGNUM *)(uVar30 << 0x18 | (uVar30 >> 8 & 0xff) << 0x10 |
                               (uVar30 >> 0x10 & 0xff) << 8 | uVar30 >> 0x18);
                if ((pBVar3 <= (BIGNUM *)(uVar5 - 0x14)) &&
                    (local_264 = pBVar3,
                     (undefined1 *)((int)&pBVar3[-1].flags + 3U) <
                         (undefined1 *)0xffe7)) {
                    pBVar3 = BN_bin2bn((uchar *)(param_5 + 5), (int)pBVar3,
                                       (BIGNUM *)0x0);
                    if (pBVar3 == (BIGNUM *)0x0) {
                        uVar17 = ERR_get_error();
                        pcVar18 = ERR_error_string(uVar17, (char *)0x0);
                        uVar24 = 0x10f;
                        FUN_00075d40(3, "crypto_bob: %s", pcVar18);
                    } else {
                        pBVar4 = BN_CTX_new();
                        pBVar9 = BN_new();
                        pBVar10 = BN_new();
                        pDVar6 = DSA_SIG_new();
                        BN_rand(pBVar9, (int)local_264 << 3, -1, 1);
                        BN_mod_mul(pBVar10, local_254[0], pBVar3, local_25c,
                                   pBVar4);
                        BN_add(pBVar10, pBVar10, pBVar9);
                        BN_div((BIGNUM *)0x0, pBVar10, pBVar10, local_25c,
                               pBVar4);
                        BN_mod_exp(pBVar9, local_258, pBVar9, local_260,
                                   pBVar4);
                        FUN_00036970(pBVar9, pBVar9);
                        DSA_SIG_set0(pDVar6, pBVar10, pBVar9);
                        BN_CTX_free(pBVar4);
                        BN_free(pBVar3);
                        local_264 =
                            (BIGNUM *)i2d_DSA_SIG(pDVar6, (uchar **)0x0);
                        if (local_264 == (BIGNUM *)0x0) {
                            uVar17 = ERR_get_error();
                            pcVar18 = ERR_error_string(uVar17, (char *)0x0);
                            uVar24 = 0x10f;
                            FUN_00075d40(3, "crypto_bob: %s", pcVar18);
                            DSA_SIG_free(pDVar6);
                        } else {
                            if (local_264 < (BIGNUM *)0xffe8) {
                                local_248 = 0;
                                local_244 = 0;
                                local_240 = 0;
                                local_23c = (BIGNUM *)0x0;
                                local_238 = 0;
                                local_234 = (uchar *)0x0;
                                uVar5 = FUN_000368fc();
                                uVar30 = *(uint *)(iffkey_info + 0xc);
                                local_244 = uVar30 << 0x18 |
                                            (uVar30 >> 8 & 0xff) << 0x10 |
                                            (uVar30 >> 0x10 & 0xff) << 8 |
                                            uVar30 >> 0x18;
                                local_248 = uVar5 << 0x18 |
                                            (uVar5 >> 8 & 0xff) << 0x10 |
                                            (uVar5 >> 0x10 & 0xff) << 8 |
                                            uVar5 >> 0x18;
                                local_240 =
                                    (int)local_264 << 0x18 |
                                    ((uint)local_264 >> 8 & 0xff) << 0x10 |
                                    ((uint)local_264 >> 0x10 & 0xff) << 8 |
                                    (uint)local_264 >> 0x18;
                                local_268 =
                                    (BIGNUM *)FUN_00074b04(0, local_264, 0, 0);
                                local_23c = local_268;
                                i2d_DSA_SIG(pDVar6, (uchar **)&local_268);
                                DSA_SIG_free(pDVar6);
                                if (uVar5 != 0) {
                                    local_234 = (uchar *)FUN_00074b04(
                                        0, DAT_000ca8e4, 0, 0);
                                    pEVar16 = (EVP_MD_CTX *)EVP_MD_CTX_new();
                                    EVP_DigestInit(pEVar16, DAT_000ca8e8);
                                    EVP_DigestUpdate(pEVar16, &local_248, 0xc);
                                    EVP_DigestUpdate(pEVar16, local_23c,
                                                     (size_t)local_264);
                                    iVar23 = EVP_SignFinal(pEVar16, local_234,
                                                           (uint *)&local_264,
                                                           DAT_000ca8e0);
                                    if (iVar23 != 0) {
                                        pBVar3 = local_264;
                                        if (DAT_000ca8e4 < local_264) {
                                            /* WARNING: Subroutine does not
                                             * return */
                                            FUN_0007fc54("ntp_crypto.c", 0x921,
                                                         2,
                                                         "len <= sign_siglen");
                                        }
                                        goto LAB_0003a03c;
                                    }
                                    goto LAB_0003a044;
                                }
                                goto LAB_00039d6c;
                            }
                            uVar24 = 0x101;
                            FUN_00075d40(3,
                                         "crypto_bob: signature is too big: %u",
                                         local_264);
                            DSA_SIG_free(pDVar6);
                        }
                    }
                    goto LAB_0003a348;
                }
            }
        LAB_0003a344:
            uVar24 = 0x101;
        }
    } else if (uVar5 < 0x82070001) {
        if (uVar5 == 0x82060000) {
        LAB_0003b068:
            uVar5 = FUN_000368fc();
            if (uVar5 != 0) {
                uVar30 = (*param_5 >> 0x10 & 0xff) << 8 | *param_5 >> 0x18;
                if (0x13 < uVar30) {
                    uVar21 = param_5[4];
                    pBVar3 = (BIGNUM *)(uVar21 << 0x18 |
                                        (uVar21 >> 8 & 0xff) << 0x10 |
                                        (uVar21 >> 0x10 & 0xff) << 8 |
                                        uVar21 >> 0x18);
                    if ((pBVar3 <= (BIGNUM *)(uVar30 - 0x14)) &&
                        (local_260 = pBVar3,
                         (undefined1 *)((int)&pBVar3[-1].flags + 3U) <
                             (undefined1 *)0xffe7)) {
                        local_25c = (BIGNUM *)(param_5 + 5);
                        x = d2i_X509((X509 **)0x0, (uchar **)&local_25c,
                                     (long)pBVar3);
                        if (x == (X509 *)0x0) {
                            uVar17 = ERR_get_error();
                            pcVar18 = ERR_error_string(uVar17, (char *)0x0);
                            uVar24 = 0x10d;
                            FUN_00075d40(3, "cert_sign: %s", pcVar18);
                        } else {
                            pEVar8 = X509_get_pubkey(x);
                            if (pEVar8 == (EVP_PKEY *)0x0) {
                                uVar17 = ERR_get_error();
                                pcVar18 = ERR_error_string(uVar17, (char *)0x0);
                                uVar24 = 0x104;
                                FUN_00075d40(3, "cert_sign: %s", pcVar18);
                                X509_free(x);
                            } else {
                                x_00 = X509_new();
                                version = X509_get_version(x);
                                X509_set_version(x_00, version);
                                a_00 = ASN1_INTEGER_new();
                                ASN1_INTEGER_set(a_00, uVar5);
                                X509_set_serialNumber(x_00, a_00);
                                pAVar13 =
                                    (ASN1_TIME *)X509_getm_notBefore(x_00);
                                X509_gmtime_adj(pAVar13, 0);
                                pAVar13 = (ASN1_TIME *)X509_getm_notAfter(x_00);
                                X509_gmtime_adj(pAVar13, 0x1e13380);
                                pXVar14 = X509_get_issuer_name(x_00);
                                uVar24 = hostval._12_4_;
                                len = strlen((char *)hostval._12_4_);
                                X509_NAME_add_entry_by_txt(
                                    pXVar14, "commonName", 0x1001,
                                    (uchar *)uVar24, len, -1, 0);
                                pXVar14 = X509_get_subject_name(x);
                                X509_set_subject_name(x_00, pXVar14);
                                X509_set_pubkey(x_00, pEVar8);
                                iVar2 = X509_get_ext_count(x);
                                if (0 < iVar2) {
                                    loc = 0;
                                    do {
                                        ex = X509_get_ext(x, loc);
                                        iVar15 = X509_add_ext(x_00, ex, -1);
                                        if (iVar15 == 0) {
                                            /* WARNING: Subroutine does not
                                             * return */
                                            FUN_0007fc54(
                                                "ntp_crypto.c", 0xc92, 2,
                                                "X509_add_ext(cert, ext, -1)");
                                        }
                                        loc = loc + 1;
                                    } while (loc != iVar2);
                                }
                                X509_free(x);
                                FUN_00077758(local_254, uVar5, 0);
                                piVar28 = cert_host;
                                iVar2 = FUN_00036cd4(local_254, cert_host + 7);
                                if ((iVar2 < 0) ||
                                    (iVar2 = FUN_00036cd4(local_254,
                                                          (int)piVar28 + 0x26),
                                     0 < iVar2)) {
                                    uVar24 = 0x10a;
                                    X509_free(x_00);
                                } else {
                                    X509_sign(x_00, DAT_000ca8e0, DAT_000ca8e8);
                                    iVar2 = X509_verify(x_00, DAT_000ca8e0);
                                    if (0 < iVar2) {
                                        local_260 = (BIGNUM *)i2d_X509(
                                            x_00, (uchar **)0x0);
                                        local_23c = (BIGNUM *)0x0;
                                        local_248 =
                                            uVar5 << 0x18 |
                                            (uVar5 >> 8 & 0xff) << 0x10 |
                                            (uVar5 >> 0x10 & 0xff) << 8 |
                                            uVar5 >> 0x18;
                                        local_238 = 0;
                                        local_234 = (uchar *)0x0;
                                        local_244 = param_5[3];
                                        local_240 =
                                            (int)local_260 << 0x18 |
                                            ((uint)local_260 >> 8 & 0xff)
                                                << 0x10 |
                                            ((uint)local_260 >> 0x10 & 0xff)
                                                << 8 |
                                            (uint)local_260 >> 0x18;
                                        local_258 = (BIGNUM *)FUN_00074b04(
                                            0, local_260, 0, 0);
                                        local_23c = local_258;
                                        i2d_X509(x_00, (uchar **)&local_258);
                                        local_238 = 0;
                                        local_234 = (uchar *)FUN_00074b04(
                                            0, DAT_000ca8e4, 0, 0);
                                        pEVar16 =
                                            (EVP_MD_CTX *)EVP_MD_CTX_new();
                                        EVP_DigestInit(pEVar16, DAT_000ca8e8);
                                        EVP_DigestUpdate(pEVar16, &local_248,
                                                         0xc);
                                        EVP_DigestUpdate(pEVar16, local_23c,
                                                         (size_t)local_260);
                                        iVar23 = EVP_SignFinal(
                                            pEVar16, local_234,
                                            (uint *)&local_260, DAT_000ca8e0);
                                        if (iVar23 != 0) {
                                            if (DAT_000ca8e4 < local_260) {
                                                /* WARNING: Subroutine does not
                                                 * return */
                                                FUN_0007fc54(
                                                    "ntp_crypto.c", 0xcbd, 2,
                                                    "len <= sign_siglen");
                                            }
                                            local_238 =
                                                (int)local_260 << 0x18 |
                                                ((uint)local_260 >> 8 & 0xff)
                                                    << 0x10 |
                                                ((uint)local_260 >> 0x10 & 0xff)
                                                    << 8 |
                                                (uint)local_260 >> 0x18;
                                        }
                                        EVP_MD_CTX_free(pEVar16);
                                        X509_free(x_00);
                                        uVar24 = FUN_00036740(iVar1, &local_248,
                                                              param_4);
                                        FUN_00037f0c(&local_248);
                                        goto LAB_00039c10;
                                    }
                                    uVar17 = ERR_get_error();
                                    pcVar18 =
                                        ERR_error_string(uVar17, (char *)0x0);
                                    uVar24 = 0x109;
                                    FUN_00075d40(3, "cert_sign: %s", pcVar18);
                                    X509_free(x_00);
                                }
                            }
                        }
                        goto LAB_0003a348;
                    }
                }
                goto LAB_0003a344;
            }
            uVar24 = 0x102;
        } else {
        LAB_0003adb8:
            uVar24 = 0x10f;
        }
    } else if (uVar5 == 0x82080000) {
    LAB_0003a050:
        if (gqkey_info != 0) {
            uVar24 = EVP_PKEY_get0_RSA(*(undefined4 *)(gqkey_info + 4));
            RSA_get0_key(uVar24, &local_25c, &local_258, local_254);
            uVar5 = (*param_5 >> 0x10 & 0xff) << 8 | *param_5 >> 0x18;
            if (0x13 < uVar5) {
                uVar30 = param_5[4];
                pBVar3 =
                    (BIGNUM *)(uVar30 << 0x18 | (uVar30 >> 8 & 0xff) << 0x10 |
                               (uVar30 >> 0x10 & 0xff) << 8 | uVar30 >> 0x18);
                if ((pBVar3 <= (BIGNUM *)(uVar5 - 0x14)) &&
                    (local_260 = pBVar3,
                     (undefined1 *)((int)&pBVar3[-1].flags + 3U) <
                         (undefined1 *)0xffe7)) {
                    pBVar3 = BN_bin2bn((uchar *)(param_5 + 5), (int)pBVar3,
                                       (BIGNUM *)0x0);
                    if (pBVar3 == (BIGNUM *)0x0) {
                        uVar17 = ERR_get_error();
                        pcVar18 = ERR_error_string(uVar17, (char *)0x0);
                        uVar24 = 0x10f;
                        FUN_00075d40(3, "crypto_bob2: %s", pcVar18);
                    } else {
                        pBVar4 = BN_CTX_new();
                        pBVar9 = BN_new();
                        pBVar10 = BN_new();
                        pBVar11 = BN_new();
                        pDVar6 = DSA_SIG_new();
                        BN_rand(pBVar9, (int)local_260 << 3, -1, 1);
                        BN_div((BIGNUM *)0x0, pBVar9, pBVar9, local_25c,
                               pBVar4);
                        BN_mod_exp(pBVar11, local_258, pBVar3, local_25c,
                                   pBVar4);
                        BN_mod_mul(pBVar11, pBVar9, pBVar11, local_25c, pBVar4);
                        BN_mod_exp(pBVar10, pBVar9, local_254[0], local_25c,
                                   pBVar4);
                        FUN_00036970(pBVar10, pBVar10);
                        DSA_SIG_set0(pDVar6, pBVar11, pBVar10);
                        BN_CTX_free(pBVar4);
                        BN_free(pBVar3);
                        BN_free(pBVar9);
                        local_260 =
                            (BIGNUM *)i2d_DSA_SIG(pDVar6, (uchar **)0x0);
                        if (0 < (int)local_260) {
                            local_248 = 0;
                            local_244 = 0;
                            local_240 = 0;
                            local_23c = (BIGNUM *)0x0;
                            local_238 = 0;
                            local_234 = (uchar *)0x0;
                            uVar5 = FUN_000368fc();
                            uVar30 = *(uint *)(gqkey_info + 0xc);
                            local_244 =
                                uVar30 << 0x18 | (uVar30 >> 8 & 0xff) << 0x10 |
                                (uVar30 >> 0x10 & 0xff) << 8 | uVar30 >> 0x18;
                            local_248 =
                                uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                                (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
                            local_240 = (int)local_260 << 0x18 |
                                        ((uint)local_260 >> 8 & 0xff) << 0x10 |
                                        ((uint)local_260 >> 0x10 & 0xff) << 8 |
                                        (uint)local_260 >> 0x18;
                            local_264 =
                                (BIGNUM *)FUN_00074b04(0, local_260, 0, 0);
                            local_23c = local_264;
                            i2d_DSA_SIG(pDVar6, (uchar **)&local_264);
                            DSA_SIG_free(pDVar6);
                            if (uVar5 != 0) {
                                local_234 = (uchar *)FUN_00074b04(
                                    0, DAT_000ca8e4, 0, 0);
                                pEVar16 = (EVP_MD_CTX *)EVP_MD_CTX_new();
                                EVP_DigestInit(pEVar16, DAT_000ca8e8);
                                EVP_DigestUpdate(pEVar16, &local_248, 0xc);
                                EVP_DigestUpdate(pEVar16, local_23c,
                                                 (size_t)local_260);
                                iVar23 = EVP_SignFinal(pEVar16, local_234,
                                                       (uint *)&local_260,
                                                       DAT_000ca8e0);
                                if (iVar23 != 0) {
                                    pBVar3 = local_260;
                                    if (DAT_000ca8e4 < local_260) {
                                        /* WARNING: Subroutine does not return
                                         */
                                        FUN_0007fc54("ntp_crypto.c", 0xa63, 2,
                                                     "len <= sign_siglen");
                                    }
                                    goto LAB_0003a03c;
                                }
                                goto LAB_0003a044;
                            }
                            goto LAB_00039d6c;
                        }
                        uVar17 = ERR_get_error();
                        pcVar18 = ERR_error_string(uVar17, (char *)0x0);
                        uVar24 = 0x10f;
                        FUN_00075d40(3, "crypto_bob2: %s", pcVar18);
                        DSA_SIG_free(pDVar6);
                    }
                    goto LAB_0003a348;
                }
            }
            goto LAB_0003a344;
        }
        uVar24 = 0x10e;
        FUN_00075d40(5, "crypto_bob2: scheme unavailable");
    } else {
        if (uVar5 != 0x82090000)
            goto LAB_0003adb8;
    LAB_0003a600:
        if (mvkey_info != 0) {
            uVar24 = EVP_PKEY_get0_DSA(*(undefined4 *)(mvkey_info + 4));
            DSA_get0_pqg(uVar24, &local_264, &local_260, &local_25c);
            DSA_get0_key(uVar24, &local_258, local_254);
            uVar5 = (*param_5 >> 0x10 & 0xff) << 8 | *param_5 >> 0x18;
            if (0x13 < uVar5) {
                uVar30 = param_5[4];
                pBVar3 =
                    (BIGNUM *)(uVar30 << 0x18 | (uVar30 >> 8 & 0xff) << 0x10 |
                               (uVar30 >> 0x10 & 0xff) << 8 | uVar30 >> 0x18);
                if ((pBVar3 <= (BIGNUM *)(uVar5 - 0x14)) &&
                    (local_268 = pBVar3,
                     (undefined1 *)((int)&pBVar3[-1].flags + 3U) <
                         (undefined1 *)0xffe7)) {
                    pBVar3 = BN_bin2bn((uchar *)(param_5 + 5), (int)pBVar3,
                                       (BIGNUM *)0x0);
                    if (pBVar3 == (BIGNUM *)0x0) {
                        uVar17 = ERR_get_error();
                        pcVar18 = ERR_error_string(uVar17, (char *)0x0);
                        uVar24 = 0x10f;
                        FUN_00075d40(3, "crypto_bob3: %s", pcVar18);
                    } else {
                        pBVar4 = BN_CTX_new();
                        pBVar9 = BN_new();
                        pBVar10 = BN_new();
                        a = DSA_new();
                        pBVar11 = BN_new();
                        r = BN_new();
                        r_00 = BN_new();
                        do {
                            iVar2 = BN_num_bits(local_260);
                            BN_rand(pBVar9, iVar2, 0, 0);
                            BN_div((BIGNUM *)0x0, pBVar9, pBVar9, local_260,
                                   pBVar4);
                            BN_gcd(pBVar10, pBVar9, local_260, pBVar4);
                            iVar2 = BN_is_one(pBVar10);
                        } while (iVar2 == 0);
                        BN_mod_exp(pBVar10, local_25c, pBVar9, local_264,
                                   pBVar4);
                        BN_mod_mul(pBVar11, pBVar10, pBVar3, local_264, pBVar4);
                        BN_mod_exp(r, local_254[0], pBVar9, local_264, pBVar4);
                        BN_mod_exp(r_00, local_258, pBVar9, local_264, pBVar4);
                        pBVar12 = BN_dup(local_258);
                        DSA_set0_key(a, pBVar12, 0);
                        DSA_set0_pqg(a, pBVar11, r, r_00);
                        BN_CTX_free(pBVar4);
                        BN_free(pBVar9);
                        BN_free(pBVar3);
                        BN_free(pBVar10);
                        local_248 = 0;
                        local_244 = 0;
                        local_240 = 0;
                        local_23c = (BIGNUM *)0x0;
                        local_238 = 0;
                        local_234 = (uchar *)0x0;
                        uVar5 = FUN_000368fc();
                        uVar30 = *(uint *)(mvkey_info + 0xc);
                        local_244 =
                            uVar30 << 0x18 | (uVar30 >> 8 & 0xff) << 0x10 |
                            (uVar30 >> 0x10 & 0xff) << 8 | uVar30 >> 0x18;
                        local_248 = uVar5 << 0x18 |
                                    (uVar5 >> 8 & 0xff) << 0x10 |
                                    (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
                        local_268 = (BIGNUM *)i2d_DSAparams(a, (uchar **)0x0);
                        if (local_268 != (BIGNUM *)0x0) {
                            local_240 = (int)local_268 << 0x18 |
                                        ((uint)local_268 >> 8 & 0xff) << 0x10 |
                                        ((uint)local_268 >> 0x10 & 0xff) << 8 |
                                        (uint)local_268 >> 0x18;
                            local_26c = (BIGNUM *)FUN_00074b04(0, local_268, 0);
                            local_23c = local_26c;
                            i2d_DSAparams(a, (uchar **)&local_26c);
                            DSA_free(a);
                            if (uVar5 != 0) {
                                local_234 =
                                    (uchar *)FUN_00074b04(0, DAT_000ca8e4, 0);
                                pEVar16 = (EVP_MD_CTX *)EVP_MD_CTX_new();
                                EVP_DigestInit(pEVar16, DAT_000ca8e8);
                                EVP_DigestUpdate(pEVar16, &local_248, 0xc);
                                EVP_DigestUpdate(pEVar16, local_23c,
                                                 (size_t)local_268);
                                iVar23 = EVP_SignFinal(pEVar16, local_234,
                                                       (uint *)&local_268,
                                                       DAT_000ca8e0);
                                if (iVar23 != 0) {
                                    pBVar3 = local_268;
                                    if (DAT_000ca8e4 < local_268) {
                                        /* WARNING: Subroutine does not return
                                         */
                                        FUN_0007fc54("ntp_crypto.c", 0xbc3, 2,
                                                     "len <= sign_siglen");
                                    }
                                    goto LAB_0003a03c;
                                }
                                goto LAB_0003a044;
                            }
                            goto LAB_00039d6c;
                        }
                        uVar17 = ERR_get_error();
                        pcVar18 = ERR_error_string(uVar17, (char *)0x0);
                        uVar24 = 0x10f;
                        FUN_00075d40(3, "crypto_bob3: %s", pcVar18);
                        DSA_free(a);
                    }
                    goto LAB_0003a348;
                }
            }
            goto LAB_0003a344;
        }
        uVar24 = 0x10e;
        FUN_00075d40(5, "crypto_bob3: scheme unavailable");
    }
LAB_0003a348:
    *(uint *)(param_2 + iVar23 * 4) = *(uint *)(param_2 + iVar23 * 4) | 0x40;
    uVar7 = FUN_0007e39c(uVar24);
    FUN_0007d00c(acStack_230, 0x100, "%04x %d %02x %s", uVar29 | 0x40000000,
                 local_290, uVar24, uVar7);
    FUN_000532d0(local_28c, acStack_230);
    if ((int)(uVar29 | 0x40000000) < 0) {
        uVar24 = 8;
    } else {
        uVar24 = 0;
    }
LAB_00039c10:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar24);
    }
    return;
}

void FUN_0003b78c(void)

{
    int iVar1;
    int iVar2;
    FILE *__stream;
    char *pcVar3;
    size_t sVar4;
    ulong e;
    uint uVar5;
    uchar *local_54c;
    undefined4 local_548;
    long local_544;
    char *local_540;
    char *local_53c;
    uchar *local_538;
    undefined1 auStack_534[8];
    char local_52c[256];
    char acStack_42c[256];
    char acStack_32c[256];
    char acStack_22c[2];
    undefined1 auStack_22a[254];
    undefined1 auStack_12c[256];
    int local_2c;

    local_2c = __stack_chk_guard;
    if ((crypto_flags & 1) != 0) {
        FUN_00075d40(5, "crypto_setup: spurious crypto command");
    LAB_0003bda0:
        if (local_2c == __stack_chk_guard) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    FUN_0007d6ec();
    iVar1 = RAND_status();
    if (iVar1 == 0) {
        if (DAT_000ca8f0 == (char *)0x0) {
            pcVar3 = local_52c;
            RAND_file_name(pcVar3, 0x100);
        } else {
            pcVar3 = DAT_000ca8f0;
            if (*DAT_000ca8f0 != '/') {
                pcVar3 = local_52c;
                FUN_0007d00c(pcVar3, 0x100, "%s/%s", keysdir, DAT_000ca8f0);
            }
        }
        iVar1 = RAND_load_file(pcVar3, -1);
        if (iVar1 == 0) {
            FUN_00075d40(3, "crypto_setup: random seed file %s missing",
                         pcVar3);
            /* WARNING: Subroutine does not return */
            exit(-1);
        }
        FUN_0007055c(auStack_534);
        RAND_seed(auStack_534, 8);
        RAND_write_file(pcVar3);
    }
    gethostname(acStack_42c, 0x100);
    if (DAT_000ca8f4 != 0) {
        FUN_0007e4b4(acStack_42c, DAT_000ca8f4, 0x100);
    }
    if (DAT_000ca8f8 == 0) {
        DAT_000ca8f8 = FUN_00074c8c(acStack_42c);
    }
    hostval._0_4_ = 0;
    hostval._4_4_ = 0;
    hostval._8_4_ = 0;
    hostval._12_4_ = 0;
    hostval._16_4_ = 0;
    hostval._20_4_ = 0;
    pubkey._0_4_ = 0;
    pubkey._4_4_ = 0;
    pubkey._8_4_ = 0;
    pubkey._12_4_ = 0;
    pubkey._16_4_ = 0;
    pubkey._20_4_ = 0;
    tai_leap._0_4_ = 0;
    tai_leap._4_4_ = 0;
    tai_leap._8_4_ = 0;
    tai_leap._12_4_ = 0;
    tai_leap._16_4_ = 0;
    tai_leap._20_4_ = 0;
    FUN_0007d00c(local_52c, 0x100, "ntpkey_host_%s", acStack_42c);
    iVar1 = FUN_000371e8(local_52c, DAT_000ca8f8, 0);
    if (iVar1 == 0) {
        FUN_00075d40(3, "crypto_setup: host key file %s not found or corrupt",
                     local_52c);
        /* WARNING: Subroutine does not return */
        exit(-1);
    }
    iVar2 = EVP_PKEY_base_id(*(EVP_PKEY **)(iVar1 + 4));
    if (iVar2 != 6) {
        FUN_00075d40(3, "crypto_setup: host key is not RSA key type");
        /* WARNING: Subroutine does not return */
        exit(-1);
    }
    DAT_000ca8e0 = *(EVP_PKEY **)(iVar1 + 4);
    uVar5 = *(uint *)(iVar1 + 0xc);
    hostval._4_4_ = uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                    (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
    DAT_000ca8ec = DAT_000ca8e0;
    uVar5 = i2d_PublicKey(DAT_000ca8e0, (uchar **)0x0);
    pubkey._12_4_ = FUN_00074b04(0, uVar5, 0, 0);
    i2d_PublicKey(DAT_000ca8ec, &local_54c);
    pubkey._4_4_ = hostval._4_4_;
    pubkey._8_4_ = uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                   (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
    FUN_0007d00c(local_52c, 0x100, "ntpkey_sign_%s", acStack_42c);
    iVar1 = FUN_000371e8(local_52c, DAT_000ca8f8, 0);
    if (iVar1 != 0) {
        DAT_000ca8e0 = *(EVP_PKEY **)(iVar1 + 4);
    }
    FUN_0007d00c(local_52c, 0x100, "ntpkey_cert_%s", acStack_42c);
    if (local_52c[0] == '/') {
        FUN_0007e4b4(acStack_32c, local_52c, 0x100);
    } else {
        FUN_0007d00c(acStack_32c, 0x100, "%s/%s", keysdir, local_52c);
    }
    __stream = fopen64(acStack_32c, "r");
    if (__stream != (FILE *)0x0) {
        pcVar3 = fgets(acStack_22c, 0x100, __stream);
        if (pcVar3 == (char *)0x0) {
            FUN_00075d40(3, "crypto_cert: empty file %s", acStack_32c);
            fclose(__stream);
        } else {
            pcVar3 = strrchr(pcVar3, 0x2e);
            if (pcVar3 == (char *)0x0) {
                FUN_00075d40(3, "crypto_cert: no filestamp %s", acStack_32c);
                fclose(__stream);
            } else {
                iVar1 = sscanf(pcVar3 + 1, "%u", &local_548);
                if (iVar1 == 1) {
                    iVar1 = PEM_read(__stream, &local_540, &local_53c,
                                     &local_538, &local_544);
                    if (iVar1 == 0) {
                        e = ERR_get_error();
                        pcVar3 = ERR_error_string(e, (char *)0x0);
                        FUN_00075d40(3, "crypto_cert: %s", pcVar3);
                        fclose(__stream);
                    } else {
                        fclose(__stream);
                        free(local_53c);
                        pcVar3 = local_540;
                        iVar1 = strcmp(local_540, "CERTIFICATE");
                        if (iVar1 == 0) {
                            free(pcVar3);
                            iVar1 =
                                FUN_0003801c(local_538, local_544, local_548);
                            free(local_538);
                            if (iVar1 != 0) {
                                pcVar3 = strrchr(acStack_22c, 10);
                                if (pcVar3 != (char *)0x0) {
                                    *pcVar3 = '\0';
                                }
                                FUN_0007d00c(auStack_12c, 0x100,
                                             "%s 0x%x len %lu", auStack_22a,
                                             *(undefined4 *)(iVar1 + 4),
                                             local_544);
                                FUN_000532d0(0, auStack_12c);
                                DAT_000ca8e8 = *(undefined4 *)(iVar1 + 0x14);
                                cert_host = iVar1;
                                cinfo = iVar1;
                                DAT_000ca8e4 = EVP_PKEY_size(DAT_000ca8e0);
                                pcVar3 = *(char **)(cinfo + 0x30);
                                if ((*(uint *)(cinfo + 4) & 8) != 0) {
                                    crypto_flags = crypto_flags | 0x10;
                                }
                                iVar1 =
                                    strcmp(pcVar3, *(char **)(cinfo + 0x34));
                                if (iVar1 != 0) {
                                    FUN_00075d40(3,
                                                 "crypto_setup: certificate %s "
                                                 "is not self-signed",
                                                 local_52c);
                                    /* WARNING: Subroutine does not return */
                                    exit(-1);
                                }
                                pcVar3 = (char *)FUN_00074c8c(pcVar3);
                                hostval._12_4_ = pcVar3;
                                sVar4 = strlen(*(char **)(cinfo + 0x30));
                                hostval._8_4_ = sVar4 << 0x18 |
                                                (sVar4 >> 8 & 0xff) << 0x10 |
                                                (sVar4 >> 0x10 & 0xff) << 8 |
                                                sVar4 >> 0x18;
                                sys_hostname = pcVar3;
                                pcVar3 = strchr(pcVar3, 0x40);
                                if (pcVar3 != (char *)0x0) {
                                    sys_groupname = FUN_00074c8c();
                                }
                                if (DAT_000ca8fc != 0) {
                                    FUN_0007e4b4(acStack_42c, DAT_000ca8fc,
                                                 0x100);
                                }
                                FUN_0007d00c(local_52c, 0x100,
                                             "ntpkey_iffkey_%s", acStack_42c);
                                iffkey_info =
                                    FUN_000371e8(local_52c, DAT_000ca8f8, 0);
                                if (iffkey_info != 0) {
                                    crypto_flags = crypto_flags | 0x20;
                                }
                                FUN_0007d00c(local_52c, 0x100,
                                             "ntpkey_gqkey_%s", acStack_42c);
                                gqkey_info =
                                    FUN_000371e8(local_52c, DAT_000ca8f8, 0);
                                if (gqkey_info != 0) {
                                    crypto_flags = crypto_flags | 0x40;
                                }
                                FUN_0007d00c(local_52c, 0x100,
                                             "ntpkey_mvkey_%s", acStack_42c);
                                mvkey_info =
                                    FUN_000371e8(local_52c, DAT_000ca8f8, 0);
                                if (mvkey_info != 0) {
                                    crypto_flags = crypto_flags | 0x80;
                                }
                                uVar5 = crypto_flags |
                                        *(int *)(cinfo + 0x10) << 0x10 | 1;
                                crypto_flags = uVar5;
                                pcVar3 = OBJ_nid2ln(*(int *)(cinfo + 0x10));
                                FUN_0007d00c(auStack_12c, 0x100,
                                             "setup 0x%x host %s %s", uVar5,
                                             acStack_42c, pcVar3);
                                FUN_000532d0(0, auStack_12c);
                                goto LAB_0003bda0;
                            }
                        } else {
                            FUN_00075d40(5, "crypto_cert: wrong PEM type %s",
                                         pcVar3);
                            free(local_540);
                            free(local_538);
                        }
                    }
                } else {
                    FUN_00075d40(3, "crypto_cert: invalid filestamp %s",
                                 acStack_32c);
                    fclose(__stream);
                }
            }
        }
    }
    cinfo = 0;
    FUN_00075d40(3, "crypto_setup: certificate file %s not found or corrupt",
                 local_52c);
    /* WARNING: Subroutine does not return */
    exit(-1);
}

void FUN_0003c018(undefined4 param_1, char *param_2)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = crypto_nid;
    switch (param_1) {
    case 1:
        if (DAT_000ca8f4 != (void *)0x0) {
            free(DAT_000ca8f4);
        }
        DAT_000ca8f4 = (void *)FUN_00074c8c(param_2);
        iVar2 = crypto_nid;
        break;
    case 2:
        if (DAT_000ca8fc != (void *)0x0) {
            free(DAT_000ca8fc);
        }
        DAT_000ca8fc = (void *)FUN_00074c8c(param_2);
        iVar2 = crypto_nid;
        break;
    case 3:
        break;
    case 4:
        if (DAT_000ca8f0 != (void *)0x0) {
            free(DAT_000ca8f0);
        }
        DAT_000ca8f0 = (void *)FUN_00074c8c(param_2);
        iVar2 = crypto_nid;
        break;
    case 5:
        break;
    case 6:
        break;
    case 7:
        break;
    case 8:
        if (DAT_000ca8f8 != (void *)0x0) {
            free(DAT_000ca8f8);
        }
        DAT_000ca8f8 = (void *)FUN_00074c8c(param_2);
        iVar2 = crypto_nid;
        break;
    case 9:
        iVar2 = OBJ_sn2nid(param_2);
        if (iVar2 == 0) {
            if (iVar1 == __stack_chk_guard) {
                FUN_00075d40(3, "crypto_config: invalid digest name %s",
                             param_2);
                return;
            }
            goto LAB_0003c190;
        }
    }
    crypto_nid = iVar2;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_0003c190:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003c1c4(int *param_1, uint param_2)

{
    byte bVar1;
    int iVar2;
    size_t sVar3;
    size_t sVar4;
    char *__filename;
    char *__filename_00;
    int iVar5;
    __pid_t _Var6;
    FILE *pFVar7;
    int *piVar8;
    int iVar9;
    char *pcVar10;
    char cVar11;
    int iVar12;
    time_t local_b0;
    undefined2 local_ac;
    undefined1 local_aa;
    undefined1 local_a9;
    undefined1 local_a8;
    undefined1 local_a7;
    undefined1 local_a6;
    short local_a4[2];
    char local_a0;
    undefined1 local_9f;
    undefined1 local_9e;
    undefined1 local_9d;
    undefined1 local_9c;
    stat64 sStack_98;
    int local_2c;

    local_2c = __stack_chk_guard;
    if (-1 < *(char *)((int)param_1 + 0x15)) {
        if ((FILE *)*param_1 != (FILE *)0x0) {
            fclose((FILE *)*param_1);
            *param_1 = 0;
        }
        goto LAB_0003c20c;
    }
    switch ((char)param_1[5]) {
    case '\x01':
        iVar5 = param_1[3];
        _Var6 = getpid();
        if ((*param_1 == 0) < (iVar5 == _Var6))
            goto LAB_0003c20c;
        goto LAB_0003c26c;
    case '\x02':
        break;
    case '\x03':
        break;
    case '\x04':
        break;
    case '\x05':
        break;
    case '\x06':
        if (((uint)param_1[3] <= current_time) &&
            (current_time < (uint)param_1[4]))
            goto switchD_0003c234_default;
        goto LAB_0003c26c;
    default:
        goto switchD_0003c234_default;
    }
    if (((uint)param_1[3] <= param_2) && (param_2 < (uint)param_1[4])) {
    switchD_0003c234_default:
        if (*param_1 != 0)
            goto LAB_0003c20c;
    }
LAB_0003c26c:
    local_b0 = time((time_t *)0x0);
    sVar3 = strlen((char *)param_1[1]);
    sVar4 = strlen((char *)param_1[2]);
    iVar12 = sVar4 + sVar3 + 0x41;
    iVar9 = sVar4 + sVar3 + 0x40;
    __filename = (char *)FUN_00074b04(0, iVar12, 0, 0);
    __filename_00 = (char *)FUN_00074b04(0, iVar12, 0, 0);
    FUN_0007d00c(__filename, iVar12, "%s%s", param_1[1], param_1[2]);
    iVar5 = FUN_0007e4b4(__filename_00, __filename, iVar12);
    __filename_00[iVar9] = '\0';
    bVar1 = *(byte *)(param_1 + 5);
    pcVar10 = __filename_00 + iVar5;
    iVar5 = iVar12 - iVar5;
    if (bVar1 == 4) {
        FUN_00077758(local_a4, param_2, &local_b0);
        FUN_0007d00c(pcVar10, iVar5, "%c%04d%02d", 0x2e, local_a4[0], local_a0);
        local_9c = 0;
        local_9f = 1;
        local_9d = 0;
        local_9e = 0;
        iVar5 = FUN_00077838(local_a4);
        local_a0 = local_a0 + '\x01';
    LAB_0003c6e8:
        param_1[3] = iVar5;
        iVar5 = FUN_00077838(local_a4);
        param_1[4] = iVar5;
        cVar11 = __filename_00[iVar9];
        goto LAB_0003c374;
    }
    if (bVar1 < 5) {
        if (bVar1 == 2) {
            FUN_00077758(local_a4, param_2, &local_b0);
            FUN_0007d00c(pcVar10, iVar5, "%c%04d%02d%02d", 0x2e, local_a4[0],
                         local_a0, local_9f);
            local_9c = 0;
            local_9d = 0;
            local_9e = 0;
            iVar5 = FUN_00077838(local_a4);
            param_1[3] = iVar5;
            param_1[4] = (int)("mru_initalloc" + iVar5 + 0xd);
            cVar11 = __filename_00[iVar9];
        LAB_0003c374:
            if (cVar11 != '\0')
                goto LAB_0003c5f0;
            cVar11 = (char)param_1[5];
        } else {
            if (2 < bVar1) {
                FUN_00077c7c(&local_ac, param_2, &local_b0);
                FUN_0007d00c(pcVar10, iVar5, "%c%04dw%02d", 0x2e, local_ac,
                             local_aa);
                local_a6 = 0;
                local_a9 = 1;
                local_a7 = 0;
                local_a8 = 0;
                iVar5 = FUN_00077d7c(&local_ac);
                param_1[3] = iVar5;
                param_1[4] = (int)(&UNK_00093a80 + iVar5);
                cVar11 = __filename_00[iVar9];
                goto LAB_0003c374;
            }
            if (bVar1 == 1) {
                _Var6 = getpid();
                param_1[4] = 0;
                param_1[3] = _Var6;
                FUN_0007d00c(pcVar10, iVar5, "%c#%ld", 0x2e, _Var6);
                cVar11 = __filename_00[iVar9];
                goto LAB_0003c374;
            }
        LAB_0003c5c4:
            FUN_00075d40(3,
                         "unsupported file generations type %d for \"%s\" - "
                         "reverting to FILEGEN_NONE",
                         bVar1, __filename);
            *(undefined1 *)(param_1 + 5) = 0xff;
            if (__filename_00[iVar9] == '\0')
                goto LAB_0003c44c;
        LAB_0003c5f0:
            __filename_00[iVar9] = '\0';
            FUN_00075d40(3, "logfile name truncated: \"%s\"", __filename_00);
            cVar11 = (char)param_1[5];
        }
        if (cVar11 != -1) {
            iVar5 = __xstat64(3, __filename, &sStack_98);
            if (iVar5 == 0) {
                if ((sStack_98.st_mode & 0xf000) == 0x8000) {
                    if (sStack_98.st_nlink < 2) {
                        pcVar10 = (char *)FUN_00074b04(0, iVar12, 0, 0);
                        _Var6 = getpid();
                        iVar5 = DAT_000ca924;
                        DAT_000ca924 = DAT_000ca924 + 1;
                        FUN_0007d00c(pcVar10, iVar12, "%s%c%dC%lu", __filename,
                                     0x2e, _Var6, iVar5);
                        iVar5 = rename(__filename, pcVar10);
                        if (iVar5 != 0) {
                            FUN_00075d40(3, "couldn\'t save %s: %m",
                                         __filename);
                        }
                        free(pcVar10);
                    } else {
                        iVar5 = unlink(__filename);
                        if (iVar5 != 0) {
                            FUN_00075d40(3, "couldn\'t unlink %s: %m",
                                         __filename);
                        }
                    }
                } else {
                    FUN_00075d40(
                        3, "expected regular file for %s (found mode 0%lo)",
                        __filename);
                }
            } else {
                piVar8 = __errno_location();
                if (*piVar8 != 2) {
                    FUN_00075d40(3, "stat(%s) failed: %m", __filename);
                }
            }
        }
    } else {
        if (bVar1 == 6) {
            iVar2 = (current_time / 0x15180) * 0x15180;
            param_1[3] = iVar2;
            param_1[4] = (int)("mru_initalloc" + iVar2 + 0xd);
            FUN_0007d00c(pcVar10, iVar5, "%ca%08ld", 0x2e, iVar2);
            cVar11 = __filename_00[iVar9];
            goto LAB_0003c374;
        }
        if (bVar1 < 6) {
            FUN_00077758(local_a4, param_2, &local_b0);
            FUN_0007d00c(pcVar10, iVar5, "%c%04d", 0x2e, local_a4[0]);
            local_9c = 0;
            local_9f = 1;
            local_a0 = '\x01';
            local_9d = 0;
            local_9e = 0;
            iVar5 = FUN_00077838(local_a4);
            local_a4[0] = local_a4[0] + 1;
            goto LAB_0003c6e8;
        }
        if (bVar1 != 0xff)
            goto LAB_0003c5c4;
    }
LAB_0003c44c:
    pFVar7 = fopen64(__filename_00, "a");
    if (pFVar7 == (FILE *)0x0) {
        piVar8 = __errno_location();
        if (*piVar8 != 2) {
            FUN_00075d40(3, "can\'t open %s: %m", __filename_00);
        }
    } else {
        if ((FILE *)*param_1 != (FILE *)0x0) {
            fclose((FILE *)*param_1);
        }
        *param_1 = (int)pFVar7;
        if ((((*(byte *)((int)param_1 + 0x15) & 1) != 0) &&
             (iVar5 = link(__filename_00, __filename), iVar5 != 0)) &&
            (piVar8 = __errno_location(), *piVar8 != 0x11)) {
            FUN_00075d40(3, "can\'t link(%s, %s): %m", __filename_00,
                         __filename);
        }
    }
    free(__filename);
    free(__filename_00);
LAB_0003c20c:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0003c8c8(undefined4 *param_1, char *param_2, char *param_3,
                  uint param_4, uint param_5)

{
    int iVar1;
    char *__s;
    FILE *__stream;
    undefined4 uVar2;
    char *pcVar3;
    undefined4 local_34[2];
    int local_2c;

    pcVar3 = (char *)param_1[1];
    local_2c = __stack_chk_guard;
    iVar1 = strcmp(param_2, pcVar3);
    if (((((iVar1 != 0) ||
           (iVar1 = strcmp(param_3, (char *)param_1[2]), iVar1 != 0)) ||
          (*(byte *)(param_1 + 5) != param_4)) ||
         (*(byte *)((int)param_1 + 0x15) != param_5)) &&
        (param_3 != (char *)0x0 && *param_2 != '\0')) {
        __s = param_3;
        if (*param_3 == '.')
            goto LAB_0003c96c;
        do {
            do {
                __s = strchr(__s, 0x2f);
                if (__s == (char *)0x0) {
                    __stream = (FILE *)*param_1;
                    if (__stream != (FILE *)0x0) {
                        fclose(__stream);
                        pcVar3 = (char *)param_1[1];
                        *param_1 = 0;
                    }
                    iVar1 = strcmp(pcVar3, param_2);
                    if (iVar1 != 0) {
                        free(pcVar3);
                        uVar2 = FUN_00074c8c(param_2);
                        param_1[1] = uVar2;
                    }
                    pcVar3 = (char *)param_1[2];
                    iVar1 = strcmp(pcVar3, param_3);
                    if (iVar1 != 0) {
                        free(pcVar3);
                        uVar2 = FUN_00074c8c(param_3);
                        param_1[2] = uVar2;
                    }
                    *(char *)(param_1 + 5) = (char)param_4;
                    *(char *)((int)param_1 + 0x15) = (char)param_5;
                    if (__stream != (FILE *)0x0) {
                        FUN_0007055c(local_34);
                        FUN_0003c1c4(param_1, local_34[0]);
                    }
                    goto LAB_0003c988;
                }
            } while (*__s != '.');
        LAB_0003c96c:
        } while ((__s[1] != '.') || (__s[2] != '\0' && __s[2] != '/'));
    }
LAB_0003c988:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0003ca74(char *param_1)

{
    int iVar1;
    int iVar2;
    char *__s2;
    undefined4 *puVar3;

    iVar1 = __stack_chk_guard;
    puVar3 = DAT_000ca928;
    if (DAT_000ca928 != (undefined4 *)0x0) {
        __s2 = (char *)*DAT_000ca928;
        while (
            (__s2 != param_1 && (iVar2 = strcmp(param_1, __s2), iVar2 != 0))) {
            puVar3 = (undefined4 *)puVar3[2];
            if (puVar3 == (undefined4 *)0x0)
                goto LAB_0003cae8;
            __s2 = (char *)*puVar3;
        }
        puVar3 = (undefined4 *)puVar3[1];
    }
LAB_0003cae8:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(puVar3);
}

void FUN_0003cb18(undefined4 param_1, char *param_2, undefined4 *param_3)

{
    int iVar1;
    undefined4 uVar2;
    char *__s1;
    int iVar3;
    undefined4 *puVar4;
    int *piVar5;
    undefined4 *puVar6;

    iVar1 = __stack_chk_guard;
    *param_3 = 0;
    uVar2 = FUN_00074c8c();
    param_3[1] = uVar2;
    uVar2 = FUN_00074c8c(param_2);
    param_3[3] = 0;
    param_3[4] = 0;
    puVar6 = DAT_000ca928;
    *(undefined1 *)(param_3 + 5) = 2;
    *(undefined1 *)((int)param_3 + 0x15) = 1;
    param_3[2] = uVar2;
    if (puVar6 == (undefined4 *)0x0) {
        piVar5 = (int *)&DAT_000ca928;
    LAB_0003cbe4:
        iVar3 = FUN_00074b04(0, 0xc, 0);
        *piVar5 = iVar3;
        *(undefined4 *)(iVar3 + 8) = 0;
        puVar6 = (undefined4 *)*piVar5;
        uVar2 = FUN_00074c8c(param_2);
        *puVar6 = uVar2;
        *(undefined4 **)(*piVar5 + 4) = param_3;
    } else {
        __s1 = (char *)*puVar6;
        while (
            (__s1 != param_2 && (iVar3 = strcmp(__s1, param_2), iVar3 != 0))) {
            puVar4 = (undefined4 *)puVar6[2];
            if (puVar4 == (undefined4 *)0x0) {
                piVar5 = puVar6 + 2;
                goto LAB_0003cbe4;
            }
            __s1 = (char *)*puVar4;
            puVar6 = puVar4;
        }
        puVar6[1] = param_3;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003cc3c(void)

{
    int *piVar1;
    int iVar2;
    int iVar3;
    int iVar4;

    iVar2 = __stack_chk_guard;
    iVar3 = DAT_000ca928;
    if (DAT_000ca928 != 0) {
        do {
            iVar4 = *(int *)(iVar3 + 4);
            FUN_0003c8c8(iVar4, statsdir, *(undefined4 *)(iVar4 + 8),
                         *(undefined1 *)(iVar4 + 0x14),
                         *(undefined1 *)(iVar4 + 0x15));
            piVar1 = (int *)(iVar3 + 8);
            iVar3 = *piVar1;
        } while (*piVar1 != 0);
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0003ccd0(int param_1)

{
    undefined8 uVar1;
    int iVar2;
    bool bVar3;

    iVar2 = __stack_chk_guard;
    memset((void *)(param_1 + 0x40), 0xff, 8);
    uVar1 = SIMDExpandImmediate(0, 0xe, 0xff);
    bVar3 = iVar2 == __stack_chk_guard;
    *(undefined8 *)(param_1 + 0x38) = uVar1;
    *(undefined8 *)(param_1 + 0x30) = uVar1;
    *(undefined8 *)(param_1 + 0x28) = uVar1;
    if (bVar3) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003cd38(byte *param_1)

{
    int iVar1;
    ushort **ppuVar2;
    byte *pbVar3;

    iVar1 = __stack_chk_guard;
    ppuVar2 = __ctype_b_loc();
    do {
        pbVar3 = param_1;
        param_1 = pbVar3 + 1;
    } while (((*ppuVar2)[*pbVar3] & 0x2000) != 0);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(pbVar3);
}

void FUN_0003cda4(byte *param_1, byte *param_2)

{
    int iVar1;
    ushort **ppuVar2;
    uint uVar3;

    iVar1 = __stack_chk_guard;
    if (param_2 == param_1) {
        uVar3 = 1;
    } else {
        uVar3 = (uint)*param_2;
        if (uVar3 == 0x23 || uVar3 == 0) {
            uVar3 = 0;
        } else {
            ppuVar2 = __ctype_b_loc();
            uVar3 = (((*ppuVar2)[uVar3] ^ 0x2000) << 0x12) >> 0x1f;
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar3);
    }
    return;
}

void FUN_0003ce2c(int param_1, undefined4 *param_2)

{
    ushort uVar1;
    int iVar2;
    undefined4 uVar3;
    uint uVar4;
    undefined4 uVar5;
    size_t __n;
    short sVar6;
    undefined4 uVar7;
    short sVar8;

    iVar2 = __stack_chk_guard;
    uVar4 = (uint) * (ushort *)(param_1 + 0x20);
    if (uVar4 == 0) {
        uVar1 = *(ushort *)(param_2 + 3);
        sVar8 = 1;
        if ((uVar1 & 0x8000) == 0) {
            sVar6 = uVar1 - 1;
        } else {
            sVar6 = uVar1 + 1;
        }
        *(short *)(param_1 + 0x22) = sVar6;
        __n = 0;
    } else if (uVar4 < 10) {
        sVar8 = *(ushort *)(param_1 + 0x20) + 1;
        __n = uVar4 << 4;
    } else {
        sVar8 = 10;
        __n = 0x90;
        *(undefined2 *)(param_1 + 0x20) = 9;
        *(undefined2 *)(param_1 + 0x22) = *(undefined2 *)(param_1 + 0xec);
    }
    memmove((void *)(param_1 + 0x60), (undefined4 *)(param_1 + 0x50), __n);
    uVar3 = param_2[1];
    uVar5 = param_2[2];
    uVar7 = param_2[3];
    *(undefined4 *)(param_1 + 0x50) = *param_2;
    *(undefined4 *)(param_1 + 0x54) = uVar3;
    *(undefined4 *)(param_1 + 0x58) = uVar5;
    *(undefined4 *)(param_1 + 0x5c) = uVar7;
    *(short *)(param_1 + 0x20) = sVar8;
    FUN_0003ccd0(param_1);
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(1);
    }
    return;
}

void FUN_0003cef0(int param_1, undefined4 param_2)

{
    undefined8 uVar1;
    undefined2 uVar2;
    short sVar3;
    int iVar4;
    undefined4 uVar5;
    int iVar6;
    undefined4 uVar7;
    uint uVar8;
    int iVar9;
    int iVar10;
    undefined4 local_28;
    undefined4 uStack_24;
    int local_1c;

    local_1c = __stack_chk_guard;
    if (*(short *)(param_1 + 0x20) == 0) {
        iVar10 = -1;
    } else {
        iVar10 = param_1 + 0x50;
        uVar8 = 0;
        do {
            iVar4 = FUN_0007eac0(param_2, iVar10);
            if (-1 < iVar4) {
                if ((int)uVar8 < (int)(uint) * (ushort *)(param_1 + 0x20)) {
                    iVar4 = param_1 + uVar8 * 0x10;
                    iVar10 = uVar8 - 1;
                    uVar5 = *(undefined4 *)(iVar4 + 0x54);
                    uVar2 = *(undefined2 *)(iVar4 + 0x5c);
                    *(undefined4 *)(param_1 + 0x40) =
                        *(undefined4 *)(iVar4 + 0x50);
                    *(undefined4 *)(param_1 + 0x44) = uVar5;
                    *(undefined2 *)(param_1 + 0x24) = uVar2;
                    goto joined_r0x0003d02c;
                }
                break;
            }
            uVar8 = uVar8 + 1;
            iVar10 = iVar10 + 0x10;
        } while (*(ushort *)(param_1 + 0x20) != uVar8);
        iVar10 = uVar8 - 1;
    }
    *(undefined1 *)(param_1 + 0x40) = 0;
    *(undefined1 *)(param_1 + 0x41) = 0;
    *(undefined2 *)(param_1 + 0x24) = *(undefined2 *)(param_1 + 0x22);
    *(undefined1 *)(param_1 + 0x42) = 0;
    *(undefined1 *)(param_1 + 0x43) = 0;
    *(undefined1 *)(param_1 + 0x44) = 0;
    *(undefined1 *)(param_1 + 0x45) = 0;
    *(undefined1 *)(param_1 + 0x46) = 0;
    *(undefined1 *)(param_1 + 0x47) = 0;
joined_r0x0003d02c:
    iVar4 = DAT_000ca930;
    if (iVar10 < 0) {
        memset((void *)(param_1 + 0x30), 0xff, 8);
        uVar1 = SIMDExpandImmediate(0, 0xe, 0xff);
        *(undefined1 *)(param_1 + 0x48) = 0;
        *(undefined8 *)(param_1 + 0x38) = uVar1;
        *(undefined2 *)(param_1 + 0x26) = *(undefined2 *)(param_1 + 0x24);
        *(undefined8 *)(param_1 + 0x28) = uVar1;
    } else {
        iVar6 = param_1 + iVar10 * 0x10;
        iVar9 = param_1 + iVar10 * 0x10;
        sVar3 = *(short *)(iVar6 + 0x5c);
        *(short *)(param_1 + 0x26) = sVar3;
        *(undefined1 *)(param_1 + 0x48) = *(undefined1 *)(iVar6 + 0x5e);
        uVar5 = *(undefined4 *)(iVar9 + 0x50);
        uVar7 = *(undefined4 *)(iVar9 + 0x54);
        *(undefined4 *)(param_1 + 0x30) = uVar5;
        *(undefined4 *)(param_1 + 0x34) = uVar7;
        if (iVar4 == 0) {
            FUN_0007ebd8(&local_28, param_1 + 0x30,
                         (int)sVar3 - (int)*(short *)(param_1 + 0x24));
            *(undefined4 *)(param_1 + 0x28) = local_28;
            *(undefined4 *)(param_1 + 0x2c) = uStack_24;
        } else {
            *(undefined4 *)(param_1 + 0x28) = uVar5;
            *(undefined4 *)(param_1 + 0x2c) = uVar7;
        }
        FUN_0007ecec(&local_28, param_1 + 0x30,
                     *(undefined4 *)(param_1 + iVar10 * 0x10 + 0x58));
        *(undefined4 *)(param_1 + 0x38) = local_28;
        *(undefined4 *)(param_1 + 0x3c) = uStack_24;
    }
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0003d0a4(int param_1)

{
    int iVar1;
    uint uVar2;
    undefined1 *__s;
    undefined2 local_28[2];
    undefined1 local_24;
    undefined1 local_23;
    undefined1 local_22;
    undefined1 local_21;
    undefined1 local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    __s = lib_stringbuf + lib_nextbuf * 0x80;
    uVar2 = lib_nextbuf + 1 & 0xf;
    memset(__s, 0, 0x80);
    lib_nextbuf = uVar2;
    if ((*(int *)(param_1 + 4) < 0) ||
        (iVar1 = FUN_000776e0(local_28, param_1), iVar1 < 0)) {
        FUN_0007d00c(__s, 0x80, "%s", "9999-12-31T23:59:59Z");
    } else {
        FUN_0007d00c(__s, 0x80, "%04d-%02d-%02dT%02d:%02d:%02dZ", local_28[0],
                     local_24, local_23, local_22, local_21, local_20);
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

void FUN_0003d1b0(undefined4 param_1, byte *param_2)

{
    ushort **ppuVar1;
    uint uVar2;
    uint uVar3;
    uint uVar4;
    undefined1 local_44[32];
    int local_24;

    local_24 = __stack_chk_guard;
    uVar4 = 0;
    do {
        uVar2 = (uint)*param_2;
        uVar3 = uVar4;
        if (uVar2 == 0 || uVar2 == 0x23) {
        LAB_0003d240:
            if (uVar4 != 0) {
                FUN_00089564(param_1, local_44, uVar4);
            }
            if (local_24 == __stack_chk_guard) {
                return;
            }
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
        while (true) {
            param_2 = param_2 + 1;
            ppuVar1 = __ctype_b_loc();
            uVar4 = uVar3;
            if (((*ppuVar1)[uVar2] & 0x800) == 0)
                break;
            uVar4 = uVar3 + 1 & 0x1f;
            local_44[uVar3] = (char)uVar2;
            if (uVar4 != 0)
                break;
            FUN_00089564(param_1, local_44, 0x20);
            uVar2 = (uint)*param_2;
            uVar3 = uVar4;
            if (uVar2 == 0 || uVar2 == 0x23)
                goto LAB_0003d240;
        }
    } while (true);
}

void FUN_0003d280(undefined4 *param_1, int param_2, undefined4 param_3)

{
    undefined2 uVar1;
    int iVar2;
    int iVar3;
    undefined4 uVar4;
    uint uVar5;
    int iVar6;
    bool bVar7;

    iVar2 = __stack_chk_guard;
    if (*(short *)(param_2 + 0x20) == 0) {
        iVar6 = -1;
    } else {
        iVar6 = param_2 + 0x50;
        uVar5 = 0;
        do {
            iVar3 = FUN_0007eac0(param_3, iVar6);
            if (-1 < iVar3) {
                if ((int)uVar5 < (int)(uint) * (ushort *)(param_2 + 0x20)) {
                    iVar3 = param_2 + uVar5 * 0x10;
                    iVar6 = uVar5 - 1;
                    uVar4 = *(undefined4 *)(iVar3 + 0x54);
                    uVar1 = *(undefined2 *)(iVar3 + 0x5c);
                    *param_1 = *(undefined4 *)(iVar3 + 0x50);
                    param_1[1] = uVar4;
                    *(undefined2 *)(param_1 + 4) = uVar1;
                    goto joined_r0x0003d374;
                }
                break;
            }
            uVar5 = uVar5 + 1;
            iVar6 = iVar6 + 0x10;
        } while (*(ushort *)(param_2 + 0x20) != uVar5);
        iVar6 = uVar5 - 1;
    }
    *(undefined1 *)param_1 = 0;
    *(undefined1 *)((int)param_1 + 1) = 0;
    *(undefined1 *)((int)param_1 + 2) = 0;
    *(undefined1 *)((int)param_1 + 3) = 0;
    *(undefined1 *)(param_1 + 1) = 0;
    *(undefined1 *)((int)param_1 + 5) = 0;
    *(undefined1 *)((int)param_1 + 6) = 0;
    *(undefined1 *)((int)param_1 + 7) = 0;
    *(undefined2 *)(param_1 + 4) = *(undefined2 *)(param_2 + 0x22);
joined_r0x0003d374:
    if (iVar6 < 0) {
        if (iVar2 == __stack_chk_guard) {
            memset(param_1 + 2, 0xff, 8);
            return;
        }
    } else {
        param_2 = param_2 + iVar6 * 0x10;
        uVar4 = *(undefined4 *)(param_2 + 0x54);
        bVar7 = iVar2 == __stack_chk_guard;
        param_1[2] = *(undefined4 *)(param_2 + 0x50);
        param_1[3] = uVar4;
        if (bVar7) {
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003d3b4(code *param_1, undefined4 param_2, undefined1 *param_3)

{
    bool bVar1;
    int iVar2;
    int iVar3;
    ushort **ppuVar4;
    undefined1 *puVar5;
    undefined1 *puVar6;
    undefined1 *puVar7;
    uint uVar8;

    iVar2 = __stack_chk_guard;
    if (param_3 != (undefined1 *)0x0) {
        uVar8 = 0x32;
        puVar6 = param_3;
        while (iVar3 = (*param_1)(param_2), iVar3 != -1) {
            if (iVar3 == 10) {
                if (param_3 != puVar6) {
                    bVar1 = true;
                    goto LAB_0003d420;
                }
                *param_3 = 0;
                goto LAB_0003d474;
            }
            if (1 < uVar8) {
                *puVar6 = (char)iVar3;
                uVar8 = uVar8 - 1;
                puVar6 = puVar6 + 1;
            }
        }
        if (param_3 == puVar6) {
            *param_3 = 0;
            param_3 = (undefined1 *)0x0;
        } else {
            bVar1 = false;
        LAB_0003d420:
            ppuVar4 = __ctype_b_loc();
            do {
                puVar7 = puVar6 + -1;
                puVar5 = puVar6;
                if (((*ppuVar4)[(byte)puVar6[-1]] & 0x2000) == 0)
                    break;
                puVar5 = param_3;
                puVar6 = puVar7;
            } while (param_3 != puVar7);
            if (param_3 != puVar5) {
                bVar1 = true;
            }
            *puVar5 = 0;
            if (!bVar1) {
                param_3 = (undefined1 *)0x0;
            }
        }
    }
LAB_0003d474:
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_3);
}

void FUN_0003d4d0(int param_1)

{
    int iVar1;
    undefined *puVar2;
    undefined *__dest;

    iVar1 = __stack_chk_guard;
    __dest = &DAT_000ca938;
    if (DAT_000cab18 == &DAT_000ca938) {
        __dest = &DAT_000caa28;
    } else if (DAT_000cab18 != &DAT_000caa28) {
        FUN_0003ccd0(&DAT_000ca938);
        FUN_0003ccd0(&DAT_000caa28);
        DAT_000cab18 = &DAT_000ca938;
        __dest = &DAT_000caa28;
    }
    puVar2 = DAT_000cab18;
    if (param_1 != 0) {
        memcpy(__dest, DAT_000cab18, 0xf0);
        puVar2 = __dest;
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(puVar2);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0003d5ec) */

void FUN_0003d580(undefined *param_1)

{
    if (param_1 != &DAT_000caa28 && param_1 != &DAT_000ca938) {
        param_1 = DAT_000cab18;
    }
    DAT_000cab18 = param_1;
    return;
}

void FUN_0003d5fc(int param_1)

{
    uint uVar1;
    int iVar2;
    uint uVar3;
    bool bVar4;

    iVar2 = __stack_chk_guard;
    uVar1 = DAT_000ca930;
    if (((-1 < param_1) &&
         (uVar3 = (uint)(param_1 != 0), bVar4 = DAT_000ca930 != uVar3,
          DAT_000ca930 = uVar3, bVar4)) &&
        (DAT_000cab18 == &DAT_000caa28 || DAT_000cab18 == &DAT_000ca938)) {
        FUN_0003ccd0();
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar1);
    }
    return;
}

void FUN_0003d690(undefined1 *param_1)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    *param_1 = 0;
    param_1[1] = 0;
    param_1[2] = 0;
    param_1[3] = 0;
    param_1[4] = 0;
    param_1[5] = 0;
    param_1[6] = 0;
    param_1[7] = 0;
    param_1[8] = 0;
    param_1[9] = 0;
    param_1[10] = 0;
    param_1[0xb] = 0;
    memset(param_1 + 0x10, 0, 0x40);
    if (iVar1 == __stack_chk_guard) {
        FUN_0003ccd0(param_1);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003d72c(undefined4 *param_1, undefined4 param_2, undefined4 param_3,
                  int param_4)

{
    undefined2 uVar1;
    char cVar2;
    int iVar3;
    ushort **ppuVar4;
    char *pcVar5;
    long lVar6;
    undefined4 uVar7;
    int *piVar8;
    uint uVar9;
    int local_a8;
    undefined4 uStack_a4;
    char *local_9c;
    int local_98;
    undefined4 uStack_94;
    int local_90;
    undefined4 local_8c;
    short local_88[6];
    undefined1 auStack_7c[4];
    char local_78;
    char local_77;
    short local_76;
    char local_74;
    undefined8 local_70;
    int local_68;
    undefined2 local_64;
    char local_62;
    byte local_60;
    char local_5f;
    undefined1 auStack_5e[50];
    int local_2c;

    local_2c = __stack_chk_guard;
    FUN_0003d690(param_1, 0x82c, &__DT_PLTGOT);
    if (param_4 != 0) {
        iVar3 = FUN_000766bc(local_88);
        if (iVar3 != 0) {
            local_88[0] = local_88[0] + -10;
            FUN_000777bc(&local_a8, local_88);
            local_90 = local_a8;
            local_8c = uStack_a4;
            goto LAB_0003d790;
        }
    }
    local_90 = 0;
    local_8c = 0;
LAB_0003d790:
LAB_0003d79c:
    do {
        do {
            while (true) {
                iVar3 = FUN_0003d3b4(param_2, param_3, &local_60);
                if (iVar3 == 0) {
                    uVar7 = 1;
                    goto LAB_0003d908;
                }
                uVar9 = (uint)local_60;
                if (uVar9 != 0x23)
                    break;
                if (local_5f == '@') {
                    uVar7 = FUN_0003cd38(auStack_5e);
                    FUN_0007e828(&local_a8, uVar7, &local_9c, 10);
                    param_1[6] = local_a8;
                    param_1[7] = uStack_a4;
                    iVar3 = FUN_0003cda4(uVar7, local_9c);
                    if (iVar3 != 0)
                        goto LAB_0003d8f0;
                    *param_1 = param_1[6];
                } else if (local_5f == '$') {
                    uVar7 = FUN_0003cd38(auStack_5e);
                    FUN_0007e828(&local_a8, uVar7, &local_9c, 10);
                    param_1[4] = local_a8;
                    param_1[5] = uStack_a4;
                    iVar3 = FUN_0003cda4(uVar7, local_9c);
                    if (iVar3 != 0) {
                    LAB_0003d8f0:
                        piVar8 = __errno_location();
                        *piVar8 = 0x54;
                        FUN_0003d690(param_1);
                        uVar7 = 0;
                    LAB_0003d908:
                        if (local_2c == __stack_chk_guard) {
                            return;
                        }
                        /* WARNING: Subroutine does not return */
                        __stack_chk_fail(uVar7);
                    }
                }
            }
            ppuVar4 = __ctype_b_loc();
        } while (((*ppuVar4)[uVar9] & 0x800) == 0);
        FUN_0007e828(&local_a8, &local_60, &local_9c, 10);
        pcVar5 = local_9c;
        local_98 = local_a8;
        uStack_94 = uStack_a4;
        iVar3 = FUN_0003cda4(&local_60, local_9c);
        if (iVar3 != 0)
            goto LAB_0003d8f0;
        pcVar5 = (char *)FUN_0003cd38(pcVar5);
        lVar6 = strtol(pcVar5, &local_9c, 10);
        iVar3 = FUN_0003cda4(pcVar5, local_9c);
        if ((iVar3 != 0) || (0xffff < lVar6 + 0x8000U))
            goto LAB_0003d8f0;
        iVar3 = FUN_0007eac0(&local_98, &local_90);
        uVar1 = (undefined2)lVar6;
        if (-1 < iVar3) {
            if (*(short *)(param_1 + 8) == 0) {
            LAB_0003d928:
                FUN_000776e0(auStack_7c, &local_98);
                cVar2 = local_74;
                if (((local_77 == '\x01') && (local_76 == 0)) &&
                    (local_74 == '\0')) {
                    local_78 = local_78 + -1;
                    FUN_000777bc(&local_a8, auStack_7c);
                    local_70 = CONCAT44(uStack_94, local_98);
                    local_68 = local_98 - local_a8;
                    local_62 = cVar2;
                    local_64 = uVar1;
                    iVar3 = FUN_0003ce2c(param_1, &local_70);
                    if (iVar3 != 0) {
                        *(undefined2 *)(param_1 + 2) = uVar1;
                        param_1[1] = local_98;
                        goto LAB_0003d79c;
                    }
                } else {
                    piVar8 = __errno_location();
                    *piVar8 = 0x16;
                }
            } else {
                iVar3 = FUN_0007eac0(&local_98, param_1 + 0x14);
                if (iVar3 == 0) {
                    if (lVar6 == *(short *)(param_1 + 0x17)) {
                        *(undefined2 *)(param_1 + 2) = uVar1;
                        param_1[1] = local_98;
                        goto LAB_0003d79c;
                    }
                } else if (-1 < iVar3)
                    goto LAB_0003d928;
                piVar8 = __errno_location();
                *piVar8 = 0x22;
            }
            FUN_0003d690(param_1);
            uVar7 = 0;
            goto LAB_0003d908;
        }
        *(undefined2 *)((int)param_1 + 0x22) = uVar1;
        *(undefined2 *)(param_1 + 2) = uVar1;
        param_1[1] = local_98;
    } while (true);
}

void FUN_0003dbf8(undefined4 *param_1, uint param_2)

{
    short sVar1;
    short sVar2;
    int iVar3;
    int iVar4;
    undefined4 uVar5;
    uint uVar6;
    undefined1 uVar7;
    undefined4 uVar8;
    uint uVar9;
    undefined4 uVar10;
    undefined4 uVar11;
    bool bVar12;
    bool bVar13;
    uint local_50;
    undefined4 uStack_4c;
    uint local_48;
    undefined4 uStack_44;
    uint local_40;
    undefined4 local_3c;
    uint local_38;
    undefined4 uStack_34;
    int local_2c;

    local_2c = __stack_chk_guard;
    FUN_0007694c(&local_50);
    local_48 = local_50;
    uStack_44 = uStack_4c;
    iVar3 = FUN_0003d4d0(0);
    memset(param_1, 0, 0x20);
    iVar4 = FUN_0007eac0(&local_48, iVar3 + 0x40);
    if (-1 < iVar4) {
        iVar4 = FUN_0007eac0(&local_48, iVar3 + 0x28);
        if (iVar4 < 0) {
            bVar12 = false;
            goto LAB_0003dcc8;
        }
        FUN_0007ebd8(&local_50, iVar3 + 0x28, 3);
        local_40 = local_50;
        local_3c = uStack_4c;
        iVar4 = FUN_0007eac0(&local_48, &local_40);
        if (iVar4 < 0) {
            local_40 = *(uint *)(iVar3 + 0x30);
            local_3c = *(undefined4 *)(iVar3 + 0x34);
            sVar1 = (short)local_40 - (short)*(undefined4 *)(iVar3 + 0x28);
            *(short *)(param_1 + 6) = sVar1;
            FUN_0007ebd8(&local_50, &local_48, (int)sVar1);
            local_38 = local_50;
            uStack_34 = uStack_4c;
            FUN_0003cef0(iVar3);
            iVar4 = FUN_0007eac0(iVar3 + 0x40, &local_40);
            bVar12 = iVar4 == 0;
            if (bVar12) {
                local_48 = local_38;
                uStack_44 = uStack_34;
                param_2 = local_38;
            } else {
                *(undefined2 *)(param_1 + 6) = 0;
            }
            goto LAB_0003dcc8;
        }
    }
    FUN_0003cef0(iVar3, &local_48);
    bVar12 = false;
LAB_0003dcc8:
    uVar10 = *(undefined4 *)(iVar3 + 0x40);
    uVar11 = *(undefined4 *)(iVar3 + 0x44);
    uVar5 = *(undefined4 *)(iVar3 + 0x30);
    uVar8 = *(undefined4 *)(iVar3 + 0x34);
    *(undefined2 *)(param_1 + 5) = *(undefined2 *)(iVar3 + 0x24);
    *param_1 = uVar10;
    param_1[1] = uVar11;
    param_1[2] = uVar5;
    param_1[3] = uVar8;
    iVar4 = FUN_0007eac0(&local_48, iVar3 + 0x38);
    if (-1 < iVar4) {
        uVar9 = *(uint *)(iVar3 + 0x28);
        sVar1 = *(short *)(iVar3 + 0x26);
        sVar2 = *(short *)(iVar3 + 0x24);
        uVar6 = uVar9 - 0x15180;
        param_1[4] = uVar9 - param_2;
        *(short *)((int)param_1 + 0x16) = sVar1 - sVar2;
        *(undefined1 *)((int)param_1 + 0x1b) = *(undefined1 *)(iVar3 + 0x48);
        if (uVar9 < uVar6) {
            bVar13 = uVar6 <= param_2;
            if (param_2 < uVar9) {
                bVar13 = true;
            }
        } else {
            bVar13 = uVar6 <= param_2 && param_2 < uVar9;
        }
        if (bVar13) {
            uVar6 = uVar9 - 10;
            if (uVar9 < uVar6) {
                bVar13 = param_2 < uVar9 || uVar6 <= param_2;
            } else {
                bVar13 = param_2 < uVar9;
                if (param_2 < uVar6) {
                    bVar13 = false;
                }
            }
            if (bVar13) {
                uVar7 = 3;
            } else {
                uVar7 = 0;
            }
            *(undefined1 *)((int)param_1 + 0x1a) = uVar7;
        } else {
            *(undefined1 *)((int)param_1 + 0x1a) = 1;
        }
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(bVar12);
}

void FUN_0003ded4(undefined4 *param_1)

{
    short sVar1;
    short sVar2;
    int iVar3;
    int iVar4;
    uint uVar5;
    undefined4 uVar6;
    undefined4 uVar7;
    undefined4 uVar8;
    undefined4 uVar9;

    iVar3 = __stack_chk_guard;
    memset(param_1, 0, 0x20);
    iVar4 = FUN_0003d4d0(0);
    sVar1 = *(short *)(iVar4 + 0x24);
    uVar8 = *(undefined4 *)(iVar4 + 0x40);
    uVar9 = *(undefined4 *)(iVar4 + 0x44);
    uVar6 = *(undefined4 *)(iVar4 + 0x30);
    uVar7 = *(undefined4 *)(iVar4 + 0x34);
    sVar2 = *(short *)(iVar4 + 0x26);
    *(short *)(param_1 + 5) = sVar1;
    *param_1 = uVar8;
    param_1[1] = uVar9;
    *(short *)((int)param_1 + 0x16) = sVar2 - sVar1;
    param_1[2] = uVar6;
    param_1[3] = uVar7;
    *(undefined1 *)((int)param_1 + 0x1b) = *(undefined1 *)(iVar4 + 0x48);
    uVar5 = FUN_0007eac0(iVar4 + 0x30, iVar4 + 0x38);
    if (iVar3 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(~uVar5 >> 0x1f);
}

void FUN_0003df74(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_0003d4d0(0);
    if (iVar1 == __stack_chk_guard) {
        FUN_0003ccd0();
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003dfc4(undefined4 *param_1)

{
    int iVar1;
    int iVar2;
    undefined4 *puVar3;
    undefined4 uVar4;
    undefined4 uVar5;

    iVar1 = __stack_chk_guard;
    puVar3 = (undefined4 *)FUN_0003d4d0(0);
    uVar5 = puVar3[1];
    uVar4 = puVar3[2];
    *param_1 = *puVar3;
    iVar2 = __stack_chk_guard;
    param_1[1] = uVar5;
    param_1[2] = uVar4;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003e02c(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    uint uVar2;
    undefined4 local_30;
    undefined4 uStack_2c;
    undefined4 local_28;
    undefined4 uStack_24;
    int local_1c;

    local_1c = __stack_chk_guard;
    iVar1 = FUN_0003d4d0(0);
    FUN_0007694c(&local_30, param_1, param_2);
    local_28 = local_30;
    uStack_24 = uStack_2c;
    uVar2 = FUN_0007eac0(&local_28, iVar1 + 0x18);
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(~uVar2 >> 0x1f);
}

void FUN_0003e0b0(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    undefined4 local_40;
    undefined4 uStack_3c;
    undefined4 local_38;
    undefined4 uStack_34;
    undefined4 local_2c[2];
    int local_24;

    local_24 = __stack_chk_guard;
    iVar1 = FUN_0003d4d0(0);
    FUN_0007694c(&local_40, param_1, param_2);
    local_38 = local_40;
    uStack_34 = uStack_3c;
    FUN_0007eb80(&local_40, iVar1 + 0x18, &local_38);
    local_38 = local_40;
    uStack_34 = uStack_3c;
    FUN_00076a00(local_2c, &local_38);
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(local_2c[0]);
}

void FUN_0003e14c(int param_1, undefined4 param_2, undefined4 param_3)

{
    short sVar1;
    int iVar2;
    int iVar3;
    int *piVar4;
    int local_58;
    undefined4 local_54;
    int local_50;
    undefined4 uStack_4c;
    undefined1 auStack_44[4];
    char local_40;
    char local_3f;
    char local_3e;
    undefined1 local_3d;
    undefined1 local_3c;
    int local_38;
    undefined4 local_34;
    int local_30;
    short local_2c;
    undefined1 local_2a;
    int local_24;

    local_24 = __stack_chk_guard;
    iVar2 = FUN_0003d4d0(1);
    FUN_0007694c(&local_58, param_2, param_3);
    local_50 = local_58;
    uStack_4c = local_54;
    iVar3 = FUN_0007eac0(&local_50, iVar2 + 0x18);
    if ((iVar3 < 0) ||
        ((*(short *)(iVar2 + 0x20) != 0 &&
          (iVar3 = FUN_0007eac0(&local_50, iVar2 + 0x50), iVar3 < 1)))) {
        piVar4 = __errno_location();
        *piVar4 = 0x22;
    } else {
        FUN_000776e0(auStack_44, &local_50);
        if ((local_3f != '\x01') || (local_3e != '\0')) {
            local_3f = '\x01';
            local_3e = '\0';
            local_3d = 0;
            local_3c = 0;
            FUN_000777bc(&local_58, auStack_44);
            iVar3 = local_58;
            local_40 = local_40 + '\x01';
            FUN_000777bc(&local_58, auStack_44);
            local_30 = local_58 - iVar3;
            if (*(short *)(iVar2 + 0x20) == 0) {
                sVar1 = *(short *)(iVar2 + 0x22);
            } else {
                sVar1 = *(short *)(iVar2 + 0x5c);
            }
            local_38 = local_58;
            local_2c = -1;
            local_34 = local_54;
            if (param_1 != 0) {
                local_2c = 1;
            }
            local_2a = 1;
            local_2c = local_2c + sVar1;
            iVar3 = FUN_0003ce2c(iVar2, &local_38);
            if ((iVar3 != 0) && (iVar3 = FUN_0003d580(iVar2), iVar3 != 0)) {
                iVar3 = 1;
            }
            goto LAB_0003e29c;
        }
        piVar4 = __errno_location();
        *piVar4 = 0x16;
    }
    iVar3 = 0;
LAB_0003e29c:
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar3);
    }
    return;
}

void FUN_0003e2f0(int param_1, undefined4 param_2, undefined4 param_3)

{
    char *pcVar1;
    short sVar2;
    int iVar3;
    int iVar4;
    undefined4 uVar5;
    uint uVar6;
    ushort uVar7;
    uint uVar8;
    undefined4 local_50;
    undefined4 uStack_4c;
    undefined4 local_48;
    undefined4 uStack_44;
    undefined4 local_40;
    undefined4 uStack_3c;
    undefined4 local_38;
    undefined4 uStack_34;
    short local_30;
    int local_24;

    local_24 = __stack_chk_guard;
    iVar3 = FUN_0003d4d0(0);
    uVar7 = *(ushort *)(iVar3 + 0x22);
    if (uVar7 != 0) {
        uVar7 = 1;
    }
    if (param_1 < 10) {
        uVar7 = uVar7 | 1;
    }
    if (uVar7 == 0) {
        if (*(ushort *)(iVar3 + 0x20) == 0) {
        LAB_0003e380:
            FUN_0007694c(&local_50, param_2, param_3);
            local_48 = local_50;
            uStack_44 = uStack_4c;
            FUN_0003d280(&local_40, iVar3, &local_48);
            FUN_0007ebd8(&local_50, &local_40, 0x14);
            local_40 = local_50;
            uStack_3c = uStack_4c;
            iVar4 = FUN_0007eac0(&local_48, &local_40);
            if (-1 < iVar4) {
                FUN_0007ebd8(&local_50, &local_38, 0xffffffec);
                local_38 = local_50;
                uStack_34 = uStack_4c;
                iVar4 = FUN_0007eac0(&local_48, &local_38);
                if (iVar4 < 1) {
                    uVar8 = (uint) * (ushort *)(iVar3 + 0x20);
                    uVar6 = (param_1 - local_30 & 0xffffU) +
                            (uint) * (ushort *)(iVar3 + 0x24);
                    sVar2 = (short)(param_1 - local_30);
                    *(short *)(iVar3 + 0x24) = (short)uVar6;
                    *(short *)(iVar3 + 0x22) = sVar2 + *(short *)(iVar3 + 0x22);
                    if (uVar8 != 0) {
                        uVar6 = 0;
                    }
                    *(short *)(iVar3 + 0x26) = sVar2 + *(short *)(iVar3 + 0x26);
                    if (uVar8 != 0) {
                        do {
                            uVar6 = uVar6 + 1;
                            *(short *)(iVar3 + 0x5c) =
                                sVar2 + *(short *)(iVar3 + 0x5c);
                            iVar3 = iVar3 + 0x10;
                        } while (uVar6 != uVar8);
                    }
                    uVar5 = 1;
                    goto LAB_0003e410;
                }
            }
        } else if (*(char *)(iVar3 + 0x5e) != '\0') {
            uVar8 = 0;
            iVar4 = iVar3;
            do {
                uVar8 = uVar8 + 1;
                if (uVar8 == *(ushort *)(iVar3 + 0x20))
                    goto LAB_0003e380;
                pcVar1 = (char *)(iVar4 + 0x6e);
                iVar4 = iVar4 + 0x10;
            } while (*pcVar1 != '\0');
        }
    }
    uVar5 = 0;
LAB_0003e410:
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar5);
}

/* WARNING: Type propagation algorithm not settling */

void FUN_0003e498(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    ushort **ppuVar2;
    uint *puVar3;
    undefined4 uVar4;
    uint *puVar5;
    uint *puVar6;
    uint uVar7;
    uint *puVar8;
    int local_f8;
    int local_e8[3];
    int local_dc;
    int local_d8;
    int local_d4;
    uint local_d0;
    undefined1 auStack_cc[4];
    undefined1 auStack_c8[4];
    undefined1 auStack_c4[4];
    undefined1 auStack_c0[4];
    undefined1 auStack_bc[92];
    byte local_60[2];
    byte abStack_5e[50];
    int local_2c;

    local_f8 = -1;
    local_2c = __stack_chk_guard;
    FUN_0008945c(auStack_bc);
    while (iVar1 = FUN_0003d3b4(param_1, param_2, local_60), iVar1 != 0) {
        iVar1 = strncmp((char *)local_60, "#h", 2);
        if (iVar1 == 0) {
            local_e8[1] = 0;
            local_e8[2] = iVar1;
            local_dc = iVar1;
            local_d8 = iVar1;
            local_d4 = iVar1;
            iVar1 = sscanf((char *)abStack_5e, " %lx %lx %lx %lx %lx%n",
                           &local_d0, auStack_cc, auStack_c8, auStack_c4,
                           auStack_c0, local_e8);
            if ((iVar1 == 5) &&
                (puVar5 = (uint *)(local_e8 + 1), puVar8 = &local_d0,
                 abStack_5e[local_e8[0]] < 0x21)) {
                do {
                    puVar3 = puVar5 + 1;
                    uVar7 = *puVar8;
                    puVar6 = puVar3;
                    do {
                        puVar6 = (uint *)((int)puVar6 + -1);
                        *(char *)puVar6 = (char)uVar7;
                        uVar7 = uVar7 >> 8;
                    } while (puVar5 != puVar6);
                    *puVar8 = uVar7;
                    puVar5 = puVar3;
                    puVar8 = puVar8 + 1;
                } while (&local_d0 != puVar3);
                local_f8 = 1;
            } else {
                local_f8 = 0;
            }
        } else {
            iVar1 = strncmp((char *)local_60, "#@", 2);
            if ((iVar1 == 0) ||
                (iVar1 = strncmp((char *)local_60, "#$", 2), iVar1 == 0)) {
                FUN_0003d1b0(auStack_bc, abStack_5e);
            } else {
                ppuVar2 = __ctype_b_loc();
                if (((*ppuVar2)[local_60[0]] & 0x800) != 0) {
                    FUN_0003d1b0(auStack_bc, local_60);
                }
            }
        }
    }
    FUN_000896b4(auStack_bc, &local_d0);
    FUN_00089514(auStack_bc);
    if (local_f8 == -1) {
        uVar4 = 0;
    } else if (local_f8 == 0) {
        uVar4 = 0xfffffffe;
    } else {
        iVar1 = memcmp(local_e8 + 1, &local_d0, 0x14);
        if (iVar1 == 0) {
            uVar4 = 1;
        } else {
            uVar4 = 0xffffffff;
        }
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar4);
}

void FUN_0003e6ec(FILE *param_1, char *param_2, int param_3)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int *piVar4;
    undefined4 uVar5;
    undefined4 uVar6;

    iVar1 = __stack_chk_guard;
    if (param_2 == (char *)0x0) {
        param_2 = "<unknown>";
    }
    iVar2 = FUN_0003e498(getc, param_1);
    if (param_3 == 0) {
    LAB_0003e77c:
        if (-1 < iVar2)
            goto LAB_0003e784;
        goto LAB_0003e7e4;
    }
    switch (iVar2) {
    case 0:
        FUN_00075d40(3, "%s (\'%s\'): no hash signature", "leapsecond file",
                     param_2);
        goto LAB_0003e784;
    case 1:
        FUN_00075d40(5, "%s (\'%s\'): good hash signature", "leapsecond file",
                     param_2);
    LAB_0003e784:
        rewind(param_1);
        iVar2 = FUN_0003d4d0(1);
        iVar3 = FUN_0003d72c(iVar2, getc, param_1, 1);
        if (iVar3 != 0) {
            if (*(short *)(iVar2 + 0x20) == 0) {
                uVar5 = FUN_0003d0a4(iVar2 + 0x18);
                uVar5 = FUN_00075d40(5,
                                     "%s (\'%s\'): loaded, expire=%s ofs=%d "
                                     "(no entries after build date)",
                                     "leapsecond file", param_2, uVar5,
                                     (int)*(short *)(iVar2 + 0x22));
            } else {
                uVar5 = FUN_0003d0a4(iVar2 + 0x18);
                uVar6 = FUN_0003d0a4(iVar2 + 0x50);
                uVar5 = FUN_00075d40(
                    5, "%s (\'%s\'): loaded, expire=%s last=%s ofs=%d",
                    "leapsecond file", param_2, uVar5, uVar6,
                    (int)*(short *)(iVar2 + 0x5c));
            }
            if (iVar1 == __stack_chk_guard) {
                FUN_0003d580(iVar2);
                return;
            }
            goto LAB_0003e964;
        }
        piVar4 = __errno_location();
        if (*piVar4 == 0x16) {
            FUN_00075d40(3, "%s (\'%s\'): bad transition time",
                         "leapsecond file", param_2);
        } else if (*piVar4 == 0x22) {
            FUN_00075d40(3, "%s (\'%s\'): times not ascending",
                         "leapsecond file", param_2);
        } else {
            FUN_00075d40(3, "%s (\'%s\'): parsing error", "leapsecond file",
                         param_2);
        }
        break;
    case -2:
        FUN_00075d40(3, "%s (\'%s\'): malformed hash signature",
                     "leapsecond file", param_2);
        break;
    case -1:
        FUN_00075d40(3, "%s (\'%s\'): signature mismatch", "leapsecond file",
                     param_2);
        break;
    default:
        FUN_00075d40(3, "%s (\'%s\'): unknown error code %d", "leapsecond file",
                     param_2, iVar2);
        goto LAB_0003e77c;
    }
LAB_0003e7e4:
    uVar5 = 0;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_0003e964:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar5);
}

void FUN_0003e9c8(char *param_1, void *param_2, int param_3, int param_4)

{
    int iVar1;
    FILE *__stream;
    undefined4 uVar2;
    stat64 sStack_90;
    int local_24;

    local_24 = __stack_chk_guard;
    if ((param_1 != (char *)0x0) && (*param_1 != '\0')) {
        iVar1 = __xstat64(3, param_1, &sStack_90);
        if (iVar1 == 0) {
            if (param_2 != (void *)0x0) {
                if (((param_3 == 0) && (*(int *)((int)param_2 + 0x50) ==
                                        sStack_90.st_mtim.tv_sec)) &&
                    (*(int *)((int)param_2 + 0x58) == sStack_90.st_ctim.tv_sec))
                    goto LAB_0003ea08;
                memcpy(param_2, &sStack_90, 0x68);
            }
            __stream = fopen64(param_1, "r");
            if (__stream != (FILE *)0x0) {
                uVar2 = FUN_0003e6ec(__stream, param_1, param_4);
                fclose(__stream);
                goto LAB_0003ea0c;
            }
            if (param_4 != 0) {
                FUN_00075d40(3, "%s (\'%s\'): open failed: %m",
                             "leapsecond file", param_1);
                uVar2 = 0;
                goto LAB_0003ea0c;
            }
        } else if (param_4 != 0) {
            FUN_00075d40(3, "%s (\'%s\'): stat failed: %m", "leapsecond file",
                         param_1);
        }
    }
LAB_0003ea08:
    uVar2 = 0;
LAB_0003ea0c:
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2);
    }
    return;
}

void FUN_0003eba0(int param_1)

{
    int iVar1;
    undefined8 in_d0;

    iVar1 = __stack_chk_guard;
    if (state != param_1 && param_1 != 2) {
        FUN_00036294(param_1, 0);
    }
    state = param_1;
    last_offset = in_d0;
    DAT_000cab28 = current_time;
    if (iVar1 == __stack_chk_guard) {
        DAT_000cab20 = in_d0;
        return;
    }
    DAT_000cab20 = in_d0;
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003ec54(undefined4 param_1, undefined4 param_2, undefined4 param_3)

{
    undefined1 auStack_61c[256];
    undefined1 auStack_51c[256];
    undefined1 auStack_41c[1024];
    int local_1c;

    local_1c = __stack_chk_guard;
    FUN_0007d00c(auStack_61c, 0x100, &DAT_000a6dd8, param_2);
    FUN_0007d00c(auStack_51c, 0x100, &DAT_000a6dd8, param_3);
    FUN_0007d00c(auStack_41c, 0x400, "%s status: %s -> %s", param_1,
                 auStack_61c, auStack_51c);
    FUN_00036294(0xd, 0, auStack_41c);
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x0003edf4) */

void FUN_0003ed68(void)

{
    if ((pll_control != 0) && (kern_enable != 0)) {
        FUN_00036294(0xd, 0, "kernel time sync disabled");
        return;
    }
    return;
}

void FUN_0003ee0c(void)

{
    int iVar1;
    ushort **ppuVar2;
    byte *pbVar3;
    uint uVar4;

    iVar1 = __stack_chk_guard;
    if (DAT_000cbcbc == (byte *)0x0) {
        pbVar3 = &DAT_000cacb8;
        strncpy((char *)&DAT_000cacb8, "ntp_loopfilter.c", 0x1000);
        uVar4 = (uint)DAT_000cacb8;
        DAT_000cbcbc = &DAT_000cacb8;
        if (uVar4 != 0) {
            ppuVar2 = __ctype_b_loc();
            do {
                DAT_000cbcbc = pbVar3;
                if (((*ppuVar2)[uVar4] & 8) != 0)
                    break;
                pbVar3 = pbVar3 + 1;
                uVar4 = (uint)*pbVar3;
                DAT_000cbcbc = pbVar3;
            } while (uVar4 != 0);
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(DAT_000cbcbc);
    }
    return;
}

void FUN_0003ef04(undefined4 param_1, undefined4 param_2, int param_3,
                  int param_4, int param_5, undefined4 param_6)

{
    int *piVar1;
    undefined4 uVar2;
    undefined *puVar3;
    undefined4 *local_430;
    undefined4 local_42c;
    undefined1 auStack_428[1020];
    int local_2c[2];

    local_2c[0] = __stack_chk_guard;
    local_42c = 0;
    memset(auStack_428, 0, 0x3fc);
    local_430 = &local_42c;
    switch (param_2) {
    case 0:
        break;
    case 1:
        FUN_00075d40(6, "kernel reports leap second insertion scheduled");
        break;
    case 2:
        FUN_00075d40(6, "kernel reports leap second deletion scheduled");
        break;
    case 3:
        FUN_00075d40(6, "kernel reports leap second in progress");
        break;
    case 4:
        FUN_00075d40(6, "kernel reports leap second has occurred");
        break;
    case 5:
        if ((DAT_000cbcd4 & 0x40) != 0) {
            if ((char)local_42c == '\0') {
                puVar3 = &DAT_000a9528;
            } else {
                puVar3 = &DAT_000a6e24;
            }
            FUN_0007fb98(&local_430, local_2c, "%sClock Unsynchronized",
                         puVar3);
        }
        if ((DAT_000cbcd4 & 0x1000) != 0) {
            if ((char)local_42c == '\0') {
                puVar3 = &DAT_000a9528;
            } else {
                puVar3 = &DAT_000a6e24;
            }
            FUN_0007fb98(&local_430, local_2c, "%sClock Error", puVar3);
        }
        if ((DAT_000cbcd4 & 0x102) == 2) {
            if ((char)local_42c == '\0') {
                puVar3 = &DAT_000a9528;
            } else {
                puVar3 = &DAT_000a6e24;
            }
            FUN_0007fb98(&local_430, local_2c,
                         "%sPPS Frequency Sync wanted but no PPS", puVar3);
        }
        if ((DAT_000cbcd4 & 0x104) == 4) {
            if ((char)local_42c == '\0') {
                puVar3 = &DAT_000a9528;
            } else {
                puVar3 = &DAT_000a6e24;
            }
            FUN_0007fb98(&local_430, local_2c,
                         "%sPPS Time Sync wanted but no PPS signal", puVar3);
        }
        if ((DAT_000cbcd4 & 0x204) == 0x204) {
            if ((char)local_42c == '\0') {
                puVar3 = &DAT_000a9528;
            } else {
                puVar3 = &DAT_000a6e24;
            }
            FUN_0007fb98(&local_430, local_2c,
                         "%sPPS Time Sync wanted but PPS Jitter exceeded",
                         puVar3);
        }
        if ((DAT_000cbcd4 & 0x402) == 0x402) {
            if ((char)local_42c == '\0') {
                puVar3 = &DAT_000a9528;
            } else {
                puVar3 = &DAT_000a6e24;
            }
            FUN_0007fb98(&local_430, local_2c,
                         "%sPPS Frequency Sync wanted but PPS Wander exceeded",
                         puVar3);
        }
        if ((DAT_000cbcd4 & 0x802) == 0x802) {
            if ((char)local_42c == '\0') {
                puVar3 = &DAT_000a9528;
            } else {
                puVar3 = &DAT_000a6e24;
            }
            FUN_0007fb98(
                &local_430, local_2c,
                "%sPPS Frequency Sync wanted but Calibration error detected",
                puVar3);
        }
        if ((param_4 != 0) && ((DAT_000cbcd4 & 0x100) == 0)) {
            FUN_00036294(0xd, 0, "no PPS signal");
        }
        FUN_00075d40(6, "kernel reports TIME_ERROR: %#x: %s", DAT_000cbcd4,
                     &local_42c);
        break;
    case 0xffffffff:
        if (param_3 == 0xe) {
            uVar2 = FUN_0003ee0c();
            FUN_00075d40(3,
                         "%s: %s line %d: invalid struct timex pointer: 0x%lx",
                         param_1, uVar2, param_6, &DAT_000cbcc0);
        } else if (param_3 == 0x16) {
            uVar2 = FUN_0003ee0c();
            FUN_00075d40(3,
                         "%s: %s line %d: invalid struct timex \"constant\" "
                         "element value: %ld",
                         param_1, uVar2, param_6, DAT_000cbcd8);
        } else if (param_3 == 1) {
            if (param_5 == 0) {
                piVar1 = __errno_location();
            } else {
                piVar1 = __errno_location();
                *piVar1 = 1;
                FUN_00075d40(3, "%s: ntp_adjtime(TAI) failed: %m", param_1);
            }
            *piVar1 = 1;
            uVar2 = FUN_0003ee0c();
            FUN_00075d40(3, "%s: %s line %d: ntp_adjtime: %m", param_1, uVar2,
                         param_6);
        } else {
            uVar2 = FUN_0003ee0c();
            FUN_00075d40(5,
                         "%s: %s line %d: unhandled errno value %d after "
                         "failed ntp_adjtime call",
                         param_1, uVar2, param_6, param_3);
        }
        break;
    default:
        uVar2 = FUN_0003ee0c();
        FUN_00075d40(5,
                     "%s: %s line %d: unhandled return value %d from "
                     "ntp_adjtime() in %s at line %d",
                     param_1, uVar2, param_6, param_2,
                     "ntp_adjtime_error_handler", 0x1af);
    }
    if (local_2c[0] != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0003f49c(void)

{
    int iVar1;
    int iVar2;
    int *piVar3;

    iVar1 = __stack_chk_guard;
    pll_control = 1;
    memset(&DAT_000cbcc0, 0, 0x80);
    DAT_000cbccc = 16000000;
    DAT_000cbcc0 = 0x3d;
    DAT_000cbcd0 = 16000000;
    DAT_000cbcd4 = 0x41;
    DAT_000cbdc4 = 0;
    DAT_000cbcd8 = (uint)sys_poll;
    DAT_000cbd40 = &DAT_0003ed14;
    iVar2 =
        sigaction(0x1f, (sigaction *)&DAT_000cbd40, (sigaction *)&DAT_000cbdcc);
    if (iVar2 == 0) {
        iVar2 = __sigsetjmp(&DAT_000cab30, 1);
        if ((iVar2 == 0) && (iVar2 = adjtimex(&DAT_000cbcc0), iVar2 != 0)) {
            piVar3 = __errno_location();
            FUN_0003ef04("start_kern_loop", iVar2, *piVar3, 0, 0, 0x467);
        }
        iVar2 = sigaction(0x1f, (sigaction *)&DAT_000cbdcc, (sigaction *)0x0);
        if (iVar2 == 0) {
            pll_status = DAT_000cbcd4;
            if (pll_control != 0) {
                if (DAT_000cbe58 == 0) {
                    DAT_000cbe58 = 1;
                    FUN_0009d6fc(FUN_0003ed68);
                }
                if ((pll_status & 0x8000) != 0) {
                    ext_enable = 1;
                }
                FUN_00036294(0xd, 0, "kernel time sync enabled");
            }
            goto LAB_0003f584;
        }
        FUN_00075d40(3, "sigaction() restore SIGSYS: %m");
    } else {
        FUN_00075d40(3, "sigaction() trap SIGSYS: %m");
    }
    pll_control = 0;
    pll_status = DAT_000cbcd4;
LAB_0003f584:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003f724(void)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    char *pcVar4;
    double in_d0;

    iVar1 = __stack_chk_guard;
    drift_comp = in_d0;
    if (pll_control == 0) {
        pcVar4 = "ntpd";
    } else {
        memset(&DAT_000cbcc0, 0, 0x80);
        DAT_000cbcc0 = 2;
        if (kern_enable == 0) {
            pcVar4 = "ntpd";
        } else {
            pcVar4 = "kernel";
            DAT_000cbcc8 = (undefined4)(longlong)(in_d0 * 65536000000.0);
        }
        iVar2 = adjtimex(&DAT_000cbcc0);
        if (iVar2 != 0) {
            piVar3 = __errno_location();
            FUN_0003ef04("set_freq", iVar2, *piVar3, 0, 0, 0x43e);
        }
    }
    FUN_000366ac(2, 0, "%s %.3f PPM", pcVar4, drift_comp * 1000000.0);
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0003f8b0(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    sys_poll = ntp_minpoll;
    clock_jitter = ldexp(1.0, (int)sys_precision);
    freq_cnt = (undefined4)(longlong)clock_minstep;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x0004068c) */
/* WARNING: Removing unreachable block (ram,0x00040680) */
/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x0003fc94 */
/* WARNING: Restarted to delay deadcode elimination for space: register */

void FUN_0003f960(int param_1)

{
    byte bVar1;
    uint uVar2;
    int iVar3;
    int *piVar4;
    uint uVar5;
    double *pdVar6;
    undefined *puVar7;
    uint uVar8;
    bool bVar9;
    undefined4 uVar10;
    double in_d0;
    double dVar11;
    double dVar12;
    double dVar13;
    double dVar14;
    double dVar15;
    double dVar16;
    undefined4 local_bc;
    undefined1 auStack_ac[80];
    int local_5c;

    local_5c = __stack_chk_guard;
    if (ntp_enable == 0) {
        FUN_00052bd4(sys_poll);
        local_bc = 0;
        goto LAB_0003fd80;
    }
    if (((clock_panic < ABS(in_d0)) && (0.0 < clock_panic)) &&
        (allow_panic == 0)) {
        local_bc = 0xffffffff;
        FUN_0007d00c(auStack_ac, 0x50,
                     "%+.0f s; set clock manually within %.0f s.");
        FUN_00036294(7, 0, auStack_ac);
        goto LAB_0003fd80;
    }
    allow_panic = 0;
    if (mode_ntpdate != 0) {
        if (((clock_max_fwd < in_d0) && (0.0 < clock_max_fwd)) ||
            ((clock_max_back < -in_d0 && (0.0 < clock_max_back)))) {
            FUN_00070d9c();
            FUN_00075d40(5, "ntpd: time set %+.6f s");
            __printf_chk(1, "ntpd: time set %+.6fs\n");
        } else {
            FUN_00070b0c();
            FUN_00075d40(5, "ntpd: time slew %+.6f s");
            __printf_chk(1, "ntpd: time slew %+.6fs\n");
        }
        FUN_00052bd4(sys_poll);
        /* WARNING: Subroutine does not return */
        exit(0);
    }
    if (DAT_000cbe5c != 0) {
        dVar16 = *(double *)(param_1 + 0x268);
        pdVar6 = (double *)(DAT_000cbe5c + DAT_000cbe60 * 8);
        bVar9 = dVar16 < *pdVar6;
        if (bVar9) {
            *pdVar6 = dVar16;
        }
        if (bVar9) {
            dVar16 = *(double *)(param_1 + 0x268);
        }
        if (dVar16 < DAT_000cbe68) {
            DAT_000cbe68 = dVar16;
        }
        if (0.0 < in_d0) {
            dVar16 = -((dVar16 - DAT_000cbe68) * 0.5);
        } else {
            dVar16 = (dVar16 - DAT_000cbe68) * 0.5;
        }
        in_d0 = in_d0 + dVar16;
    }
    dVar15 = drift_comp;
    dVar13 = last_offset;
    dVar16 = clock_jitter;
    iVar3 = DAT_000cab28;
    uVar5 = (uint) * (byte *)(param_1 + 0x41);
    uVar8 = (uint)sys_poll;
    bVar1 = *(byte *)(param_1 + 0x41);
    if (uVar5 <= uVar8) {
        uVar5 = uVar8;
        bVar1 = sys_poll;
    }
    sys_poll = bVar1;
    if (*(byte *)(param_1 + 0x42) < uVar5) {
        sys_poll = *(byte *)(param_1 + 0x42);
    }
    dVar14 = (double)(uint)(current_time - DAT_000cab28);
    uVar10 = SUB84(in_d0, 0);
    local_bc = 0;
    if (((clock_max_fwd < in_d0) && (0.0 < clock_max_fwd)) ||
        ((clock_max_back < -in_d0 && (0.0 < clock_max_back)))) {
        if (force_step_once != 0)
            goto LAB_0003fd30;
    LAB_0003fae8:
        if (state == 4) {
            if (dVar14 < clock_minstep)
                goto LAB_0003fd80;
            FUN_0003f724(
                SUB84(in_d0 / (double)(uint)(current_time - DAT_000cab28), 0));
            dVar15 = drift_comp;
        LAB_0003fe34:
            if (dVar14 < clock_minstep)
                goto LAB_0003fd80;
        } else {
            if (state == 5) {
                FUN_0007d00c(auStack_ac, 0x50, "%+.6f s");
                FUN_00036294(3, 0, auStack_ac);
                state = 3;
                goto LAB_0003fd80;
            }
            if (state == 3)
                goto LAB_0003fe34;
        }
        FUN_0007d00c(auStack_ac, 0x50, "%+.6f s");
        FUN_00036294(0xc, 0, auStack_ac);
        FUN_00070d9c(uVar10);
        FUN_000519b8();
        tc_counter = 0;
        clock_jitter = ldexp(1.0, (int)sys_precision);
        if (state == 1) {
            local_bc = 2;
            FUN_0003eba0(0, 4);
            goto LAB_0003fd80;
        }
        FUN_0003eba0(0, 5);
        local_bc = 2;
    } else {
        if (force_step_once != 0) {
        LAB_0003fd30:
            force_step_once = 0;
            FUN_00075d40(5, "Doing intital time step");
            goto LAB_0003fae8;
        }
        dVar11 = ldexp(1.0, (int)sys_precision);
        dVar16 = dVar16 * dVar16;
        if (ABS(in_d0 - dVar13) <= dVar11) {
            dVar13 = ldexp(1.0, (int)sys_precision);
            dVar11 = ABS(in_d0 - last_offset);
        } else {
            dVar11 = ABS(in_d0 - last_offset);
            dVar13 = dVar11;
        }
        dVar12 = ldexp(1.0, (int)sys_precision);
        if (dVar11 <= dVar12) {
            dVar11 = ldexp(1.0, (int)sys_precision);
        } else {
            dVar11 = ABS(in_d0 - last_offset);
        }
        clock_jitter = SQRT(dVar16 + (dVar13 * dVar11 - dVar16) * 0.125);
        if (state == 1) {
            FUN_00070b0c(uVar10);
            FUN_0003eba0(uVar10, 4);
            local_bc = 1;
        } else {
            if (state == 4) {
                if (dVar14 < clock_minstep)
                    goto LAB_0003fd80;
                FUN_0003f724(
                    SUB84(in_d0 / (double)(uint)(current_time - iVar3), 0));
                dVar15 = drift_comp;
            }
            dVar16 = DAT_000cab20;
            if (freq_cnt == 0) {
                uVar5 = (uint)allan_xpt;
                if (uVar5 <= sys_poll) {
                    dVar11 = ldexp(1.0, (uint)sys_poll);
                    dVar13 = dVar14;
                    if (dVar14 < dVar11) {
                        dVar13 = ldexp(1.0, (uint)sys_poll);
                    }
                    uVar5 = (uint)allan_xpt;
                    dVar15 = dVar15 + (in_d0 - dVar16) / (dVar13 * 0.25);
                }
                dVar16 = ldexp(1.0, uVar5);
                if (dVar16 < dVar14) {
                    dVar14 = ldexp(1.0, (uint)allan_xpt);
                }
                dVar16 = ldexp(1.0, (uint)sys_poll);
                dVar15 =
                    dVar15 + (in_d0 * dVar14) / (dVar16 * 64.0 * dVar16 * 64.0);
            }
            FUN_0003eba0(uVar10, 5);
            if (ABS(in_d0) < 0.0005) {
                freq_cnt = 0;
            }
            local_bc = 1;
        }
    }
    if (((pll_control != 0) && (kern_enable != 0)) && (freq_cnt == 0)) {
        memset(&DAT_000cbcc0, 0, 0x80);
        if (ext_enable == 0) {
            DAT_000cbcd8 = (uint)sys_poll;
            DAT_000cbcc0 = 0x203d;
            dVar16 = -0.5;
            if (0.0 <= DAT_000cab20) {
                dVar16 = 0.5;
            }
            DAT_000cbcc4 =
                (int)(longlong)(dVar16 + DAT_000cab20 * 1000000000.0);
            DAT_000cbcd0 = (uint)(0.0 < clock_jitter * 1000000.0) *
                           (int)(longlong)(clock_jitter * 1000000.0);
            DAT_000cbcd4 = 1;
            dVar16 = (sys_rootdisp + sys_rootdelay * 0.5) * 1000000.0;
            DAT_000cbccc = (uint)(0.0 < dVar16) * (int)(longlong)dVar16;
            if (hardpps_enable == 0) {
                if ((pll_status & 4) != 0) {
                    FUN_0003ec54("PPS disabled");
                }
            } else {
                DAT_000cbcd4 = 7;
                if ((pll_status & 4) == 0) {
                    FUN_0003ec54("PPS enabled");
                }
            }
            if (sys_leap == '\x01') {
                DAT_000cbcd4 = DAT_000cbcd4 | 0x10;
            } else if (sys_leap == '\x02') {
                DAT_000cbcd4 = DAT_000cbcd4 | 0x20;
            }
        } else {
            DAT_000cbcc0 = 0x10;
        }
        iVar3 = adjtimex(&DAT_000cbcc0);
        if ((iVar3 < 0) || (iVar3 != kernel_status)) {
            kernel_status = iVar3;
            piVar4 = __errno_location();
            FUN_0003ef04("local_clock", iVar3, *piVar4, hardpps_enable);
        }
        bVar9 = (DAT_000cbcd4 & 4) != 0;
        pll_status = DAT_000cbcd4;
        puVar7 = &DAT_000ccb18;
        if (bVar9) {
            puVar7 = DAT_000cbcf4;
        }
        DAT_000cab20 = (double)(longlong)DAT_000cbcc4 / 1000000000.0;
        if (bVar9) {
            clock_jitter = (double)(longlong)(int)puVar7 / 1000000000.0;
        }
        dVar15 = (double)(longlong)DAT_000cbcc8 / 65536000000.0;
        if (DAT_000cbe70 != sys_tai) {
            DAT_000cbcc0 = 0x80;
            DAT_000cbcd8 = sys_tai;
            DAT_000cbe70 = sys_tai;
            iVar3 = adjtimex(&DAT_000cbcc0);
            if (iVar3 != 0) {
                piVar4 = __errno_location();
                FUN_0003ef04("local_clock", iVar3, *piVar4, 0);
            }
        }
    }
    if (0.0005 < ABS(dVar15)) {
        FUN_00075d40(5, "frequency error %.0f PPM exceeds tolerance %.0f PPM",
                     SUB84(dVar15 * 1000000.0, 0),
                     (int)((ulonglong)(dVar15 * 1000000.0) >> 0x20));
    }
    dVar16 = dVar15 - drift_comp;
    if (0.0005 < dVar15) {
        drift_comp = 0.0005;
    } else {
        drift_comp = dVar15;
        if (dVar15 < -0.0005) {
            drift_comp = -0.0005;
        }
    }
    clock_stability =
        SQRT(clock_stability * clock_stability +
             (dVar16 * dVar16 - clock_stability * clock_stability) * 0.125);
    if (freq_cnt < 1) {
        uVar5 = (uint)sys_poll;
        if (clock_jitter * 4.0 <= ABS(DAT_000cab20)) {
            tc_counter = tc_counter + uVar5 * -2;
            if ((tc_counter + 0x1e < 0 != SCARRY4(tc_counter, 0x1e)) &&
                (tc_counter = -0x1e, *(byte *)(param_1 + 0x41) < uVar5)) {
                uVar2 = uVar5 - 1;
                tc_counter = 0;
                uVar5 = uVar2 & 0xff;
                sys_poll = (byte)uVar2;
            }
        } else {
            tc_counter = uVar5 + tc_counter;
            if ((0x1e < tc_counter) &&
                (tc_counter = 0x1e, uVar5 < *(byte *)(param_1 + 0x42))) {
                uVar2 = uVar5 + 1;
                tc_counter = 0;
                uVar5 = uVar2 & 0xff;
                sys_poll = (byte)uVar2;
            }
        }
    } else {
        uVar5 = (uint)sys_poll;
        tc_counter = 0;
    }
    if (uVar8 != uVar5) {
        FUN_000448c4(param_1, uVar5);
        uVar5 = (uint)sys_poll;
    }
    FUN_00052bd4(SUB84(DAT_000cab20, 0), (int)((ulonglong)DAT_000cab20 >> 0x20),
                 SUB84(drift_comp, 0), (int)((ulonglong)drift_comp >> 0x20),
                 SUB84(clock_jitter, 0), (int)((ulonglong)clock_jitter >> 0x20),
                 SUB84(clock_stability, 0), uVar5);
LAB_0003fd80:
    if (local_5c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(local_bc);
}

void FUN_000406f8(void)

{
    double dVar1;
    int iVar2;
    double dVar3;
    double dVar4;
    double dVar5;
    double dVar6;

    iVar2 = __stack_chk_guard;
    dVar1 = DAT_000cab20;
    sys_rootdisp = sys_rootdisp + clock_phi;
    if ((ntp_enable == 0) || (mode_ntpdate != 0))
        goto LAB_000407f0;
    if (state == 5) {
        if (0 < freq_cnt) {
            freq_cnt = freq_cnt + -1;
            dVar4 = DAT_000cab20 * 0.03125;
            goto LAB_00040790;
        }
        if ((pll_control == 0) || (kern_enable == 0)) {
            dVar4 = ldexp(1.0, (uint)sys_poll);
            dVar4 = dVar1 / (dVar4 * 16.0);
            goto LAB_00040790;
        }
        dVar4 = 0.0;
        dVar5 = dVar4;
    } else {
        dVar4 = 0.0;
    LAB_00040790:
        dVar5 = drift_comp;
        if ((pll_control != 0) && (kern_enable != 0)) {
            dVar5 = 0.0;
        }
    }
    dVar3 = dVar4 + dVar5;
    dVar6 = 0.0005;
    if ((0.0005 < dVar3) || (dVar6 = -0.0005, dVar3 < -0.0005)) {
        dVar4 = dVar6 - dVar5;
        dVar3 = dVar5 + dVar4;
    }
    DAT_000cab20 = dVar1 - dVar4;
    enable_panic_check = 0;
    FUN_00070b0c(SUB84(dVar3, 0));
    enable_panic_check = 1;
LAB_000407f0:
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00040a6c(void)

{
    int iVar1;
    int iVar2;
    int extraout_r1;
    double *pdVar3;
    double *pdVar4;
    double dVar5;
    double dVar6;

    iVar2 = __stack_chk_guard;
    iVar1 = DAT_000cbe78;
    pdVar4 = DAT_000cbe5c;
    if (DAT_000cbe5c != (double *)0x0) {
        FUN_0009d0ec(DAT_000cbe60 + 1, DAT_000cbe78);
        dVar5 = 1000000000.0;
        DAT_000cbe68 = 1000000000.0;
        DAT_000cbe60 = extraout_r1;
        pdVar4[extraout_r1] = 1000000000.0;
        if (0 < iVar1) {
            pdVar3 = pdVar4 + iVar1;
            do {
                dVar6 = *pdVar4;
                pdVar4 = pdVar4 + 1;
                if (dVar6 < dVar5) {
                    dVar5 = dVar6;
                }
                DAT_000cbe68 = dVar5;
            } while (pdVar4 != pdVar3);
        }
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x000409a4) */
/* WARNING: Removing unreachable block (ram,0x000409bc) */
/* WARNING: Removing unreachable block (ram,0x00040a44) */

void FUN_00040b38(undefined4 param_1)

{
    int iVar1;
    undefined4 uVar2;
    undefined4 *puVar3;
    uint uVar5;
    undefined4 *puVar6;
    double in_d0;
    double dVar7;
    double dVar8;
    undefined4 *puVar4;

    iVar1 = __stack_chk_guard;
    switch (param_1) {
    case 1:
        if (mode_ntpdate == 0) {
            FUN_0003f49c();
            dVar8 = 0.0005;
            dVar7 = DAT_000cbe80 / 1000000.0;
            if ((dVar7 <= 0.0005) && (dVar8 = dVar7, dVar7 < -0.0005)) {
                dVar8 = -0.0005;
            }
            FUN_0003f724(SUB84(dVar8, 0));
            if (freq_set == 0) {
                uVar2 = 1;
            } else {
                uVar2 = 2;
            }
            FUN_0003eba0(0, uVar2);
            DAT_000cbe74 = 1;
        }
        break;
    case 2:
        break;
    case 3:
        clock_max_back = in_d0;
    joined_r0x00040d40:
        clock_max_fwd = in_d0;
        if ((in_d0 != 0.0) && (in_d0 <= 0.5))
            break;
        goto LAB_00040c94;
    case 4:
        clock_max_back = in_d0;
        if ((in_d0 != 0.0) && (((in_d0 <= 0.5 && (clock_max_fwd != 0.0)) &&
                                (clock_max_fwd <= 0.5))))
            break;
        goto LAB_00040c94;
    case 5:
        clock_max_fwd = in_d0;
        if ((clock_max_back != 0.0) && (clock_max_back <= 0.5))
            goto joined_r0x00040d40;
    LAB_00040c94:
        if (kern_enable != 0) {
            uVar5 = pll_control;
            if (pll_control != 0) {
                uVar5 = 1;
            }
            if ((uVar5 & 1) != 0) {
                FUN_0003ed68();
            }
            kern_enable = 0;
            if ((pll_control != 0) && (DAT_000cbe74 != 0)) {
                if (iVar1 == __stack_chk_guard) {
                    FUN_0003f724((int)drift_comp);
                    return;
                }
                goto LAB_00040a50;
            }
        }
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    LAB_00040a50:
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    case 6:
        clock_panic = in_d0;
        break;
    case 7:
        clock_phi = in_d0 / 1000000.0;
        break;
    case 8:
        clock_minstep = in_d0;
        if (in_d0 < 300.0) {
            clock_minstep = 300.0;
        }
        break;
    case 9:
    default:
    code_r0x00040e90:
        FUN_00075d40(5, "loop_config: unsupported option %d", param_1);
        return;
    case 10:
        allan_xpt = (0.0 < in_d0) * (char)(longlong)in_d0;
        break;
    case 0xb:
        if (900.0 <= in_d0) {
            DAT_000cbe78 = (int)(longlong)(in_d0 / 900.0);
        } else {
            DAT_000cbe78 = 1;
        }
        DAT_000cbe5c = (undefined4 *)FUN_00074bcc(0, DAT_000cbe78, 8);
        if (0 < DAT_000cbe78) {
            puVar6 = DAT_000cbe5c + DAT_000cbe78 * 2;
            puVar3 = DAT_000cbe5c;
            do {
                puVar4 = puVar3 + 2;
                *puVar3 = 0;
                puVar3[1] = 0x41cdcd65;
                puVar3 = puVar4;
            } while (puVar4 != puVar6);
        }
        DAT_000cbe68._0_4_ = 0;
        DAT_000cbe68._4_4_ = 0x41cdcd65;
        break;
    case 0xc:
        freq_set = freq_set + 1;
        DAT_000cbe80 = in_d0;
        break;
    case 0xd:
        clock_codec = in_d0 / 1000000.0;
        break;
    case 0xe:
        goto code_r0x00040e90;
    case 0xf:
        FUN_00048e94();
        return;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00040f28(int *param_1)

{
    int iVar1;
    uint uVar2;
    int *piVar3;
    int *piVar4;
    int *piVar5;

    iVar1 = __stack_chk_guard;
    mru_entries = mru_entries + -1;
    uVar2 = FUN_0007d544(param_1 + 0xb);
    uVar2 = uVar2 & ~(-1 << mon_hash_bits);
    piVar4 = *(int **)(mon_hash + uVar2 * 4);
    piVar3 = (int *)(mon_hash + uVar2 * 4);
    if (piVar4 == param_1) {
    LAB_00040fd8:
        *piVar3 = *param_1;
        piVar4 = param_1;
    } else if (piVar4 == (int *)0x0) {
        piVar4 = (int *)0x0;
    } else {
        piVar3 = piVar4;
        piVar5 = (int *)*piVar4;
        if ((int *)*piVar4 == (int *)0x0) {
            piVar4 = (int *)0x0;
        } else {
            do {
                if (param_1 == piVar5)
                    goto LAB_00040fd8;
                piVar4 = (int *)*piVar5;
                piVar3 = piVar5;
                piVar5 = piVar4;
            } while (piVar4 != (int *)0x0);
        }
    }
    if (piVar4 != param_1) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_monitor.c", 0x88, 1, "punlinked == mon");
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0004104c(void)

{
    undefined4 *puVar1;
    int iVar2;
    int iVar3;
    undefined4 *__s;
    int iVar4;

    iVar2 = __stack_chk_guard;
    iVar4 = mru_incalloc;
    if (DAT_000cbe98 == 0) {
        iVar4 = mru_initalloc;
    }
    if (iVar4 != 0) {
        iVar3 = FUN_00074bcc(0, iVar4, 0x48);
        mru_alloc = iVar4 + mru_alloc;
        __s = (undefined4 *)(iVar3 + iVar4 * 0x48);
        do {
            puVar1 = DAT_000cbe9c;
            __s = __s + -0x12;
            memset(__s, 0, 0x48);
            iVar4 = iVar4 + -1;
            *__s = puVar1;
            DAT_000cbe9c = __s;
        } while (iVar4 != 0);
        DAT_000cbe98 = DAT_000cbe98 + 1;
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x000411b0) */

void FUN_00041158(void)

{
    mon_enabled = 0;
    mon_mru_list._8_4_ = mon_mru_list;
    mon_mru_list._4_4_ = mon_mru_list;
    return;
}

void FUN_000411c4(uint param_1)

{
    int iVar1;
    uint uVar2;
    uint uVar3;
    int iVar4;
    uint uVar5;

    iVar1 = __stack_chk_guard;
    if (param_1 != 0) {
        if (mon_enabled == 0) {
            if (DAT_000cbe98 == 0) {
                FUN_0004104c();
            }
            uVar5 = (mru_maxdepth >> 3) + 1 >> 1;
            if (uVar5 == 0) {
                iVar4 = 0x40;
                mon_hash_bits = 4;
            } else {
                uVar2 = 1;
                do {
                    uVar3 = uVar2;
                    uVar5 = uVar5 >> 1;
                    uVar2 = uVar3 + 1 & 0xff;
                } while (uVar5 != 0);
                if (uVar3 < 4) {
                    uVar3 = 4;
                }
                if (0xf < uVar3) {
                    uVar3 = 0x10;
                }
                mon_hash_bits = (undefined1)uVar3;
                iVar4 = 4 << uVar3;
            }
            mon_hash = FUN_00074b04(mon_hash, iVar4, 0, 1);
            mon_enabled = param_1;
        } else {
            mon_enabled = param_1 | mon_enabled;
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000412e8(uint param_1)

{
    undefined4 *puVar1;
    int iVar2;
    undefined4 *__s;
    undefined4 *puVar3;

    iVar2 = __stack_chk_guard;
    if (((mon_enabled == 0) || ((param_1 & mon_enabled) == 0)) ||
        (mon_enabled = mon_enabled & ~param_1, mon_enabled != 0)) {
        return;
    }
    mon_enabled = 0;
    puVar3 = (undefined4 *)mon_mru_list._8_4_;
    if ((undefined1 *)mon_mru_list._8_4_ != mon_mru_list) {
        do {
            __s = puVar3;
            puVar1 = DAT_000cbe9c;
            puVar3 = (undefined4 *)__s[2];
            memset(__s, 0, 0x48);
            *__s = puVar1;
            DAT_000cbe9c = __s;
        } while (puVar3 != (undefined4 *)mon_mru_list);
    }
    mon_mru_list._8_4_ = mon_mru_list;
    mon_mru_list._4_4_ = mon_mru_list;
    mru_entries = 0;
    if (iVar2 == __stack_chk_guard) {
        memset(mon_hash, 0, 4 << mon_hash_bits);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00041414(int param_1)

{
    int iVar1;
    int iVar2;
    undefined4 *__s;
    undefined4 *puVar3;

    iVar1 = __stack_chk_guard;
    __s = (undefined4 *)mon_mru_list._8_4_;
    if ((undefined1 *)mon_mru_list._8_4_ != mon_mru_list) {
        do {
            puVar3 = (undefined4 *)__s[2];
            if (__s[3] == param_1) {
                iVar2 = __s[1];
                *(undefined4 **)(iVar2 + 8) = puVar3;
                *(int *)(__s[2] + 4) = iVar2;
                FUN_00040f28(__s);
                memset(__s, 0, 0x48);
                *__s = DAT_000cbe9c;
                DAT_000cbe9c = __s;
            }
            __s = puVar3;
        } while (puVar3 != (undefined4 *)mon_mru_list);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_000414d4(int param_1, uint param_2)

{
    short sVar1;
    undefined2 uVar2;
    bool bVar3;
    byte bVar4;
    ushort uVar5;
    undefined4 uVar6;
    int iVar7;
    uint uVar8;
    int iVar9;
    uint uVar10;
    int iVar11;
    undefined1 uVar12;
    uint uVar13;
    int *piVar14;
    int *piVar15;
    int iVar16;
    int iVar17;

    iVar7 = __stack_chk_guard;
    if (param_1 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_monitor.c", 0x148, 0, "rbufp != ((void *)0)");
    }
    if (mon_enabled == 0) {
    LAB_00041518:
        param_2 = param_2 & 0xf7bf;
        goto LAB_00041520;
    }
    uVar8 = FUN_0007d544((int *)(param_1 + 4));
    bVar4 = *(byte *)(param_1 + 0x58) & 7;
    uVar10 = ((uint) * (byte *)(param_1 + 0x58) << 0x1a) >> 0x1d;
    uVar8 = uVar8 & ~(-1 << mon_hash_bits);
    piVar14 = *(int **)(mon_hash + uVar8 * 4);
    iVar11 = uVar8 * 4;
    piVar15 = (int *)(mon_hash + iVar11);
    if (piVar14 != (int *)0x0) {
        sVar1 = *(short *)(param_1 + 4);
        do {
            if ((short)piVar14[0xb] == sVar1) {
                if (sVar1 == 2) {
                    bVar3 = piVar14[0xc] == *(int *)(param_1 + 8);
                } else {
                    iVar9 =
                        memcmp(piVar14 + 0xd, (void *)(param_1 + 0xc), 0x10);
                    if (iVar9 != 0)
                        goto LAB_000415a8;
                    bVar3 = piVar14[0x11] == *(int *)(param_1 + 0x1c);
                }
                if (bVar3) {
                    iVar9 = *(int *)(param_1 + 0x48);
                    iVar16 = piVar14[6];
                    iVar11 = *(int *)(param_1 + 0x4c);
                    iVar17 = piVar14[7];
                    uVar13 = *(uint *)(param_1 + 0x4c);
                    piVar14[6] = *(int *)(param_1 + 0x48);
                    piVar14[7] = iVar11;
                    uVar8 = uVar13 - iVar17;
                    uVar2 = *(undefined2 *)(param_1 + 6);
                    iVar11 = piVar14[1];
                    *(byte *)((int)piVar14 + 0x2a) =
                        bVar4 | (byte)(uVar10 << 3);
                    uVar10 = (uint)(uVar13 < uVar8);
                    if (uVar8 < 0x80000000) {
                        iVar17 = -uVar10;
                    } else {
                        iVar17 = 1 - uVar10;
                    }
                    iVar17 = iVar17 + (iVar9 - iVar16);
                    *(undefined2 *)((int)piVar14 + 0x2e) = uVar2;
                    piVar14[9] = piVar14[9] + 1;
                    *(int *)(iVar11 + 8) = piVar14[2];
                    iVar9 = piVar14[8];
                    *(int *)(piVar14[2] + 4) = iVar11;
                    uVar6 = mon_mru_list._8_4_;
                    uVar8 = iVar9 - iVar17;
                    uVar8 = uVar8 & ~((int)uVar8 >> 0x1f);
                    piVar14[1] = (int)mon_mru_list;
                    piVar14[2] = uVar6;
                    *(int **)(mon_mru_list._8_4_ + 4) = piVar14;
                    mon_mru_list._8_4_ = piVar14;
                    piVar14[8] = uVar8;
                    iVar11 = 1 << ntp_minpoll;
                    iVar9 = uVar8 + iVar11;
                    if (iVar17 + 1 < ntp_minpkt ||
                        iVar9 + iVar11 * -8 < 0 ==
                            SBORROW4(iVar9, iVar11 * 8)) {
                        if ((int)(uVar8 + iVar11 * -8) < 0 ==
                            SBORROW4(uVar8, iVar11 * 8)) {
                            param_2 = param_2 & 0xf7ff;
                        } else {
                            piVar14[8] = iVar11 * 9;
                        }
                    } else {
                        piVar14[8] = iVar9 + -2;
                        param_2 = param_2 & 0xf7bf;
                    }
                    *(short *)(piVar14 + 10) = (short)param_2;
                    goto LAB_00041520;
                }
            }
        LAB_000415a8:
            piVar14 = (int *)*piVar14;
        } while (piVar14 != (int *)0x0);
    }
    piVar14 = (int *)mon_mru_list._4_4_;
    if (mru_entries < mru_mindepth) {
        piVar14 = DAT_000cbe9c;
        if (DAT_000cbe9c == (int *)0x0) {
            FUN_0004104c();
            if (DAT_000cbe9c == (int *)0x0)
                goto LAB_00041890;
            piVar15 = (int *)(mon_hash + iVar11);
            piVar14 = DAT_000cbe9c;
        }
        DAT_000cbe9c = (int *)*piVar14;
    } else {
        if ((undefined1 *)mon_mru_list._4_4_ == mon_mru_list) {
            piVar14 = (int *)0x0;
            iVar9 = 0;
        } else if (mon_mru_list._4_4_ == 0) {
            iVar9 = 0;
        } else {
            uVar13 =
                *(uint *)(param_1 + 0x4c) - *(int *)(mon_mru_list._4_4_ + 0x1c);
            uVar8 = (uint)(*(uint *)(param_1 + 0x4c) < uVar13);
            if (uVar13 < 0x80000000) {
                iVar9 = -uVar8;
            } else {
                iVar9 = 1 - uVar8;
            }
            iVar9 = iVar9 + (*(int *)(param_1 + 0x48) -
                             *(int *)(mon_mru_list._4_4_ + 0x18));
            if (mru_maxage < iVar9) {
                iVar9 = *(int *)(mon_mru_list._4_4_ + 4);
                *(undefined4 *)(iVar9 + 8) =
                    *(undefined4 *)(mon_mru_list._4_4_ + 8);
                *(int *)(*(int *)((int)piVar14 + 8) + 4) = iVar9;
                FUN_00040f28(piVar14);
                memset(piVar14, 0, 0x48);
                piVar15 = (int *)(mon_hash + iVar11);
                goto LAB_00041780;
            }
        }
        if (DAT_000cbe9c == (int *)0x0) {
            if (mru_maxdepth <= mru_alloc) {
                iVar16 = FUN_00079a2c();
                if ((double)(longlong)iVar9 / (double)(longlong)mon_age <
                    (double)(longlong)iVar16 * 1.1641532182693481e-10)
                    goto LAB_00041518;
                iVar9 = piVar14[1];
                *(int *)(iVar9 + 8) = piVar14[2];
                *(int *)(piVar14[2] + 4) = iVar9;
                FUN_00040f28(piVar14);
                memset(piVar14, 0, 0x48);
                piVar15 = (int *)(mon_hash + iVar11);
                goto LAB_00041780;
            }
            FUN_0004104c();
            if (DAT_000cbe9c == (int *)0x0) {
            LAB_00041890:
                /* WARNING: Subroutine does not return */
                FUN_0007fc54("ntp_monitor.c", 0x1d7, 2, "mon != ((void *)0)");
            }
            piVar15 = (int *)(mon_hash + iVar11);
        }
        piVar14 = DAT_000cbe9c;
        DAT_000cbe9c = (int *)*piVar14;
    }
LAB_00041780:
    uVar8 = mru_entries + 1;
    uVar5 = (ushort)param_2;
    param_2 = param_2 & 0xf7bf;
    iVar11 = *(int *)(param_1 + 0x48);
    iVar9 = *(int *)(param_1 + 0x4c);
    mru_entries = uVar8;
    piVar14[6] = iVar11;
    piVar14[7] = iVar9;
    if (uVar8 < mru_peakentries) {
        uVar8 = mru_peakentries;
    }
    piVar14[4] = iVar11;
    piVar14[5] = iVar9;
    mru_peakentries = uVar8;
    *(ushort *)(piVar14 + 10) = uVar5 & 0xf7bf;
    piVar14[8] = 0;
    piVar14[9] = 1;
    iVar11 = *(int *)(param_1 + 8);
    iVar9 = *(int *)(param_1 + 0xc);
    iVar16 = *(int *)(param_1 + 0x10);
    piVar14[0xb] = *(int *)(param_1 + 4);
    piVar14[0xc] = iVar11;
    piVar14[0xd] = iVar9;
    piVar14[0xe] = iVar16;
    iVar11 = *(int *)(param_1 + 0x18);
    iVar9 = *(int *)(param_1 + 0x1c);
    piVar14[0xf] = *(int *)(param_1 + 0x14);
    piVar14[0x10] = iVar11;
    piVar14[0x11] = iVar9;
    *(byte *)((int)piVar14 + 0x2a) = bVar4 | (byte)(uVar10 << 3);
    iVar11 = *(int *)(param_1 + 0x3c);
    piVar14[3] = iVar11;
    if (((*(uint *)(iVar11 + 0x90) & 0x40) == 0) ||
        (*(int *)(param_1 + 0x40) != *(int *)(iVar11 + 0xc))) {
        if (*(int *)(iVar11 + 0x10) == *(int *)(param_1 + 0x40)) {
            uVar12 = 4;
        } else {
            uVar12 = 1;
        }
    } else {
        uVar12 = 2;
    }
    *(undefined1 *)((int)piVar14 + 0x2b) = uVar12;
    *piVar14 = *piVar15;
    *piVar15 = (int)piVar14;
    uVar6 = mon_mru_list._8_4_;
    piVar14[1] = (int)mon_mru_list;
    piVar14[2] = uVar6;
    *(int **)(mon_mru_list._8_4_ + 4) = piVar14;
    mon_mru_list._8_4_ = piVar14;
LAB_00041520:
    if (iVar7 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(param_2);
    }
    return;
}

void FUN_00041b38(undefined4 *param_1, int param_2)

{
    undefined4 *puVar1;
    int iVar2;
    uint uVar3;
    undefined4 uVar4;
    undefined4 *puVar5;
    undefined4 *puVar6;
    int *piVar7;
    undefined4 *puVar8;
    int iVar9;
    bool bVar10;

    iVar2 = __stack_chk_guard;
    if (param_2 != 0) {
        puVar8 = param_1 + 4;
        uVar3 = FUN_0007d544(puVar8);
        uVar3 = uVar3 & 0x7f;
        iVar9 = *(int *)(peer_hash_count + uVar3 * 4);
        *(int *)(peer_hash_count + uVar3 * 4) = iVar9 + -1;
        puVar5 = *(undefined4 **)(peer_hash + uVar3 * 4);
        if (param_1 == puVar5) {
            piVar7 = (int *)(peer_hash + uVar3 * 4);
        LAB_00041c54:
            *piVar7 = *(int *)(*piVar7 + 4);
        } else {
            if (puVar5 != (undefined4 *)0x0) {
                for (puVar6 = (undefined4 *)puVar5[1];
                     puVar6 != (undefined4 *)0x0;
                     puVar6 = (undefined4 *)puVar6[1]) {
                    if (puVar6 == param_1) {
                        piVar7 = puVar5 + 1;
                        goto LAB_00041c54;
                    }
                    puVar5 = puVar6;
                }
            }
            *(int *)(peer_hash_count + uVar3 * 4) = iVar9;
            uVar4 = FUN_0007d2c0(puVar8);
            FUN_00075d40(3, "peer %s not in address table!", uVar4);
        }
        uVar3 = *(ushort *)(param_1 + 0xf) & 0x7f;
        iVar9 = *(int *)(assoc_hash_count + uVar3 * 4);
        *(int *)(assoc_hash_count + uVar3 * 4) = iVar9 + -1;
        puVar5 = *(undefined4 **)(assoc_hash + uVar3 * 4);
        if (param_1 == puVar5) {
            piVar7 = (int *)(assoc_hash + uVar3 * 4);
        LAB_00041cc8:
            *piVar7 = *(int *)(*piVar7 + 8);
        } else {
            if (puVar5 != (undefined4 *)0x0) {
                for (puVar6 = (undefined4 *)puVar5[2];
                     puVar6 != (undefined4 *)0x0;
                     puVar6 = (undefined4 *)puVar6[2]) {
                    if (param_1 == puVar6) {
                        piVar7 = puVar5 + 2;
                        goto LAB_00041cc8;
                    }
                    puVar5 = puVar6;
                }
            }
            *(int *)(assoc_hash_count + uVar3 * 4) = iVar9;
            uVar4 = FUN_0007d2c0(puVar8);
            FUN_00075d40(3, "peer %s not in association ID table!", uVar4);
        }
        puVar5 = &peer_list;
        puVar6 = peer_list;
        if (param_1 == peer_list) {
        LAB_00041d24:
            *puVar5 = *puVar6;
        } else {
            if (peer_list != (undefined4 *)0x0) {
                puVar6 = (undefined4 *)*peer_list;
                puVar5 = peer_list;
                while (puVar1 = puVar6, puVar1 != (undefined4 *)0x0) {
                    if (param_1 == puVar1) {
                        puVar6 = (undefined4 *)*puVar5;
                        goto LAB_00041d24;
                    }
                    puVar5 = puVar1;
                    puVar6 = (undefined4 *)*puVar1;
                }
            }
            uVar4 = FUN_0007d2c0(puVar8);
            FUN_00075d40(3, "%s not in peer list!", uVar4);
        }
    }
    if ((void *)param_1[0xb] != (void *)0x0) {
        free((void *)param_1[0xb]);
    }
    if ((void *)param_1[0x14] != (void *)0x0) {
        free((void *)param_1[0x14]);
    }
    if ((void *)param_1[0xc] != (void *)0x0) {
        free((void *)param_1[0xc]);
    }
    memset(param_1, 0, 0x308);
    bVar10 = iVar2 == __stack_chk_guard;
    puVar5 = param_1;
    *param_1 = DAT_000cbea0;
    DAT_000cbea0 = puVar5;
    peer_free_count = peer_free_count + 1;
    if (bVar10) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00041e54) */

void FUN_00041ddc(void)

{
    return;
}

void FUN_00041e60(void)

{
    int iVar1;
    undefined4 *puVar2;
    undefined4 *puVar3;

    iVar1 = __stack_chk_guard;
    puVar2 = &DAT_000cd3e0;
    do {
        puVar3 = puVar2 + -0xc2;
        *puVar2 = DAT_000cbea0;
        DAT_000cbea0 = puVar2;
        puVar2 = puVar3;
    } while (puVar3 != (undefined4 *)0xcbba0);
    DAT_000cbea0 = (undefined4 *)&DAT_000cbea8;
    total_peer_structs = 8;
    peer_free_count = 8;
    do {
        DAT_000cd6e8 = FUN_00079a2c();
    } while (DAT_000cd6e8 == 0);
    DAT_000cd6ea = DAT_000cd6e8;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00041f34(short *param_1, char *param_2, undefined4 *param_3,
                  uint param_4, byte param_5, int *param_6)

{
    short sVar1;
    bool bVar2;
    int iVar3;
    int iVar4;
    uint uVar5;
    undefined4 *puVar6;

    iVar3 = __stack_chk_guard;
    if (param_2 == (char *)0x0) {
        if (param_3 == (undefined4 *)0x0) {
            uVar5 = FUN_0007d544();
            puVar6 = *(undefined4 **)(peer_hash + (uVar5 & 0x7f) * 4);
        } else {
            puVar6 = (undefined4 *)param_3[1];
        }
        if (puVar6 != (undefined4 *)0x0) {
            do {
                if ((param_6 != (int *)0x0) &&
                    (*(short *)(puVar6 + 4) == *param_1)) {
                    if (*(short *)(puVar6 + 4) == 2) {
                        bVar2 = *(int *)(param_1 + 2) == puVar6[5];
                    } else {
                        iVar4 = memcmp(param_1 + 4, puVar6 + 6, 0x10);
                        if (iVar4 != 0)
                            goto LAB_00042014;
                        bVar2 = *(int *)(param_1 + 0xc) == puVar6[10];
                    }
                    if (bVar2) {
                        *param_6 = *param_6 + 1;
                    }
                }
            LAB_00042014:
                if ((((param_4 == 0xffffffff) ||
                      (param_4 == *(byte *)((int)puVar6 + 0x3f))) ||
                     (((*(byte *)(puVar6 + 0x12) & 0x20) != 0 &&
                       ((param_5 & 0x20) != 0)))) &&
                    ((param_1[1] == *(short *)((int)puVar6 + 0x12) &&
                      (*(short *)(puVar6 + 4) == *param_1)))) {
                    if (*(short *)(puVar6 + 4) == 2) {
                        bVar2 = *(int *)(param_1 + 2) == puVar6[5];
                    } else {
                        iVar4 = memcmp(param_1 + 4, puVar6 + 6, 0x10);
                        if (iVar4 != 0)
                            goto LAB_0004204c;
                        bVar2 = *(int *)(param_1 + 0xc) == puVar6[10];
                    }
                    if (bVar2)
                        goto LAB_00041fd4;
                }
            LAB_0004204c:
                puVar6 = (undefined4 *)puVar6[1];
            } while (puVar6 != (undefined4 *)0x0);
        }
        puVar6 = (undefined4 *)0x0;
    } else {
        sVar1 = *param_1;
        puVar6 = peer_list;
        if (param_3 != (undefined4 *)0x0) {
            puVar6 = (undefined4 *)*param_3;
        }
        while ((puVar6 != (undefined4 *)0x0 &&
                (((((char *)puVar6[0xb] == (char *)0x0 ||
                    ((param_4 != 0xffffffff &&
                      (param_4 != *(byte *)((int)puVar6 + 0x3f))))) ||
                   ((sVar1 != 0 && (sVar1 != *(short *)(puVar6 + 4) &&
                                    *(short *)(puVar6 + 4) != 0)))) ||
                  (iVar4 = strcasecmp((char *)puVar6[0xb], param_2),
                   iVar4 != 0))))) {
            puVar6 = (undefined4 *)*puVar6;
        }
    }
LAB_00041fd4:
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(puVar6);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00042200) */

void FUN_0004217c(uint param_1)

{
    int iVar1;

    assocpeer_calls = assocpeer_calls + 1;
    for (iVar1 = *(int *)(assoc_hash + (param_1 & 0x7f) * 4);
         (iVar1 != 0 && (*(ushort *)(iVar1 + 0x3c) != param_1));
         iVar1 = *(int *)(iVar1 + 8)) {
    }
    return;
}

void FUN_00042214(void)

{
    int iVar1;
    int *piVar2;

    iVar1 = __stack_chk_guard;
    piVar2 = peer_list;
    if (peer_list != (int *)0x0) {
        do {
            while ((*(byte *)(piVar2 + 0x12) & 0x1e) != 0) {
                piVar2 = (int *)*piVar2;
                if (piVar2 == (int *)0x0)
                    goto LAB_00042284;
            }
            FUN_000467d8(piVar2, &DAT_000a73ac);
            piVar2 = (int *)*piVar2;
        } while (piVar2 != (int *)0x0);
    }
LAB_00042284:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_000422b0(int param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int *piVar4;
    int iVar5;

    iVar1 = __stack_chk_guard;
    iVar5 = 100;
    iVar2 = FUN_00041ddc(*(undefined1 *)(param_1 + 0x128),
                         *(undefined4 *)(param_1 + 300));
    for (piVar4 = (int *)peer_list; piVar4 != (int *)0x0;
         piVar4 = (int *)*piVar4) {
        if (((piVar4[0x11] & 2U) != 0) &&
            (iVar3 = FUN_00041ddc(*(undefined1 *)(piVar4 + 0x4a), piVar4[0x4b]),
             iVar3 <= iVar5)) {
            iVar5 = iVar3;
        }
    }
    if (iVar2 != iVar5) {
        iVar5 = 0;
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar5);
    }
    return;
}

void FUN_00042358(int param_1, int param_2)

{
    int iVar1;
    undefined4 uVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    int iVar5;
    int iVar6;
    undefined4 *puVar7;

    iVar1 = __stack_chk_guard;
    if ((param_1 == 0) || (iVar6 = *(int *)(param_1 + 0x38), iVar6 == param_2))
        goto LAB_00042468;
    if (param_2 == 0) {
        if (iVar6 == 0)
            goto LAB_00042468;
    LAB_000423ac:
        iVar5 = *(int *)(iVar6 + 0xb8);
        *(int *)(iVar6 + 0xbc) = *(int *)(iVar6 + 0xbc) + -1;
        if (param_1 == iVar5) {
            puVar7 = (undefined4 *)(iVar6 + 0xb8);
            iVar6 = param_1;
        LAB_00042400:
            *puVar7 = *(undefined4 *)(iVar6 + 0xc);
        } else if (iVar5 != 0) {
            for (iVar6 = *(int *)(iVar5 + 0xc); iVar6 != 0;
                 iVar6 = *(int *)(iVar6 + 0xc)) {
                if (param_1 == iVar6) {
                    puVar7 = (undefined4 *)(iVar5 + 0xc);
                    iVar6 = *(int *)(iVar5 + 0xc);
                    goto LAB_00042400;
                }
                iVar5 = iVar6;
            }
        }
        uVar2 = FUN_0007d2c0(param_1 + 0x10);
        uVar3 = FUN_0002924c(*(undefined4 *)(param_1 + 0x38));
        uVar4 = FUN_0002924c(param_2);
        FUN_00075d40(6, "%s local addr %s -> %s", uVar2, uVar3, uVar4);
        *(int *)(param_1 + 0x38) = param_2;
        if (param_2 == 0)
            goto LAB_00042468;
    } else {
        if ((((*(uint *)(param_1 + 0x44) & 0x10) != 0) &&
             ((*(uint *)(param_2 + 0x90) & 0x100) != 0)) &&
            (*(char *)(param_1 + 0x3f) == '\x03'))
            goto LAB_00042468;
        if (iVar6 != 0)
            goto LAB_000423ac;
        *(int *)(param_1 + 0x38) = param_2;
    }
    iVar6 = *(int *)(param_2 + 0xbc);
    *(undefined4 *)(param_1 + 0xc) = *(undefined4 *)(param_2 + 0xb8);
    *(int *)(param_2 + 0xb8) = param_1;
    *(int *)(param_2 + 0xbc) = iVar6 + 1;
LAB_00042468:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000424cc(int param_1)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_000366ac(0x82, param_1, "assoc %u", *(undefined2 *)(param_1 + 0x3c));
    FUN_00051594(param_1 + 0x10, 1, 0);
    FUN_00042358(param_1, 0);
    peer_demobilizations = peer_demobilizations + 1;
    peer_associations = peer_associations + -1;
    if ((*(uint *)(param_1 + 0x44) & 2) != 0) {
        peer_preempt = peer_preempt + -1;
    }
    if ((*(uint *)(param_1 + 0x44) & 8) != 0) {
        FUN_00049e24(param_1);
    }
    if (iVar1 == __stack_chk_guard) {
        FUN_00041b38(param_1, 1);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000425bc(void)

{
    int iVar1;
    undefined4 uVar2;
    byte bVar3;
    int *piVar4;
    int *piVar5;
    int iVar6;

    iVar1 = __stack_chk_guard;
    piVar4 = peer_list;
    if (peer_list != (int *)0x0) {
        do {
            if ((piVar4[0xe] == 0) ||
                ((*(byte *)((int)piVar4 + 0x12a) & 3) == 0)) {
                piVar5 = piVar4 + 4;
                uVar2 = FUN_00028eb8(piVar4, piVar5, 0);
                iVar6 = piVar4[0xe];
                FUN_00042358(piVar4, uVar2);
                if (piVar4[0xe] != 0) {
                    bVar3 = *(byte *)(piVar4 + 0x12);
                    if (((iVar6 != piVar4[0xe]) && ((bVar3 & 0x10) == 0)) &&
                        ((char)piVar4[0x17] != '\x05')) {
                        FUN_000467d8(piVar4, &DAT_000a73d8);
                        bVar3 = *(byte *)(piVar4 + 0x12);
                    }
                    if ((bVar3 & 4) != 0) {
                        FUN_00026274(piVar4[0xe], piVar5);
                        bVar3 = *(byte *)(piVar4 + 0x12);
                    }
                    if ((bVar3 & 2) != 0) {
                        FUN_00026318(piVar4[0xe], piVar5);
                    }
                }
            }
            piVar4 = (int *)*piVar4;
        } while (piVar4 != (int *)0x0);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_000426dc(int *param_1, int param_2, int param_3, int param_4,
                  undefined1 param_5, undefined1 param_6, byte param_7,
                  byte param_8, uint param_9, byte param_10, int param_11,
                  uint param_12, int param_13)

{
    short sVar1;
    int iVar2;
    int iVar3;
    undefined4 uVar4;
    byte bVar5;
    int iVar6;
    uint uVar7;
    uint uVar8;
    int *piVar9;
    int *piVar10;
    int local_30;
    int local_2c;

    local_2c = __stack_chk_guard;
    local_30 = 0;
    if (crypto_flags == 0) {
        if (param_12 < 0x10000) {
            if ((param_9 & 0x800) != 0) {
                FUN_00075d40(3, "Autokey not configured");
                piVar9 = (int *)0x0;
                goto LAB_00042870;
            }
            goto LAB_00042784;
        }
    } else {
    LAB_00042784:
        if ((param_2 != 0) && ((param_10 & 8) == 0)) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_peer.c", 0x321, 2,
                         "((void *)0) == hostname || (0x08 & cast_flags)");
        }
        if (param_3 == 0) {
            iVar2 =
                FUN_00041f34(param_1, param_2, 0, param_5, param_10, &local_30);
            if (iVar2 == 0)
                goto LAB_000428b4;
        } else {
            iVar2 =
                FUN_00041f34(param_1, param_2, 0, param_5, param_10, &local_30);
            if (iVar2 == 0) {
            LAB_000428b4:
                if ((param_4 < 0) || (local_30 < param_4)) {
                    if (peer_free_count == 0) {
                        piVar9 = (int *)FUN_00074bcc(0, 4, 0x308);
                        piVar9[0x246] = (int)DAT_000cbea0;
                        piVar9[0x184] = (int)(piVar9 + 0x246);
                        piVar9[0xc2] = (int)(piVar9 + 0x184);
                        *piVar9 = (int)(piVar9 + 0xc2);
                        peer_free_count = peer_free_count + 4;
                        total_peer_structs = total_peer_structs + 4;
                    } else {
                        piVar9 = DAT_000cbea0;
                        if (DAT_000cbea0 == (int *)0x0) {
                            /* WARNING: Subroutine does not return */
                            FUN_0007fc54("ntp_peer.c", 0x36e, 2,
                                         "peer != ((void *)0)");
                        }
                    }
                    DAT_000cbea0 = (int *)*piVar9;
                    peer_free_count = peer_free_count + -1;
                    peer_associations = peer_associations + 1;
                    if ((param_9 & 2) != 0) {
                        peer_preempt = peer_preempt + 1;
                    }
                    piVar10 = piVar9 + 4;
                    *(short *)(piVar9 + 0xf) = DAT_000cd6e8;
                    sVar1 = DAT_000cd6e8 + 1;
                    if ((short)(DAT_000cd6e8 + 1) == 0) {
                        sVar1 = DAT_000cd6e8 + 2;
                    }
                    DAT_000cd6e8 = sVar1;
                    iVar2 = param_1[1];
                    iVar6 = param_1[2];
                    iVar3 = param_1[3];
                    *piVar10 = *param_1;
                    piVar9[5] = iVar2;
                    piVar9[6] = iVar6;
                    piVar9[7] = iVar3;
                    iVar2 = param_1[5];
                    iVar6 = param_1[6];
                    piVar9[8] = param_1[4];
                    piVar9[9] = iVar2;
                    piVar9[10] = iVar6;
                    if (param_2 != 0) {
                        iVar2 = FUN_00074c8c(param_2);
                        piVar9[0xb] = iVar2;
                    }
                    *(undefined1 *)((int)piVar9 + 0x3f) = param_5;
                    *(byte *)(piVar9 + 0x12) = param_10;
                    *(undefined1 *)((int)piVar9 + 0x3e) = param_6;
                    piVar9[0x11] = param_9;
                    uVar4 = FUN_00028eb8(piVar9, param_1, param_3);
                    FUN_00042358(piVar9, uVar4);
                    if (param_7 == 0) {
                        param_7 = 6;
                        *(undefined1 *)((int)piVar9 + 0x41) = 6;
                    } else {
                        if (0x10 < param_7) {
                            param_7 = 0x11;
                        }
                        *(byte *)((int)piVar9 + 0x41) = param_7;
                    }
                    if (param_8 == 0) {
                        bVar5 = 10;
                        *(undefined1 *)((int)piVar9 + 0x42) = 10;
                    } else {
                        bVar5 = param_8;
                        if (param_8 < 3) {
                            bVar5 = 3;
                        }
                        *(byte *)((int)piVar9 + 0x42) = bVar5;
                    }
                    if (bVar5 < param_7) {
                        *(byte *)((int)piVar9 + 0x41) = bVar5;
                    }
                    if ((param_10 & 4) == 0) {
                    LAB_00042a44:
                        if (((param_10 & 2) != 0) && (piVar9[0xe] != 0)) {
                            FUN_00026318(piVar9[0xe], param_1);
                        }
                    } else if (piVar9[0xe] != 0) {
                        FUN_00026274(piVar9[0xe], param_1);
                        goto LAB_00042a44;
                    }
                    uVar7 = param_12;
                    if (0xffff < param_12) {
                        uVar7 = piVar9[0x11];
                    }
                    piVar9[0x13] = param_11;
                    if (0xffff < param_12) {
                        piVar9[0x11] = uVar7 | 0x800;
                    }
                    piVar9[0x1f] = param_12;
                    if (param_13 != 0) {
                        iVar2 = FUN_00074c8c(param_13);
                        piVar9[0x14] = iVar2;
                    }
                    *(undefined1 *)(piVar9 + 0x10) =
                        *(undefined1 *)((int)piVar9 + 0x41);
                    *(undefined1 *)((int)piVar9 + 0x5f) = sys_precision;
                    if ((param_10 & 0x10) == 0) {
                        if ((param_10 & 8) == 0) {
                            if ((param_10 & 2) == 0) {
                                if ((param_10 & 4) == 0) {
                                    FUN_000467d8(piVar9, &DAT_000a7454);
                                } else {
                                    FUN_000467d8(piVar9, &DAT_000a744c);
                                }
                            } else {
                                FUN_000467d8(piVar9, &DAT_000a7444);
                            }
                        } else {
                            FUN_000467d8(piVar9, &DAT_000a743c);
                        }
                    } else {
                        FUN_000467d8(piVar9, &DAT_000a7434);
                    }
                    iVar2 = current_time;
                    if (mode_ntpdate != 0) {
                        peer_ntpdate = peer_ntpdate + 1;
                    }
                    piVar9[0xb5] = current_time;
                    piVar9[0xb8] = iVar2;
                    piVar9[0xb7] = iVar2;
                    if (((short)piVar9[4] == 2) &&
                        ((short)piVar9[5] == 0x7f7f)) {
                        if (param_8 == 0) {
                            *(undefined1 *)((int)piVar9 + 0x42) =
                                *(undefined1 *)((int)piVar9 + 0x41);
                        }
                        iVar2 = FUN_00049eb8(piVar9);
                        if (iVar2 == 0) {
                            FUN_00042358(piVar9, 0);
                            FUN_00041b38(piVar9, 0);
                            piVar9 = (int *)0x0;
                            goto LAB_00042870;
                        }
                    }
                    uVar7 = FUN_0007d544(piVar10);
                    uVar8 = *(ushort *)(piVar9 + 0xf) & 0x7f;
                    uVar7 = uVar7 & 0x7f;
                    piVar9[1] = *(int *)(peer_hash + uVar7 * 4);
                    *(int **)(peer_hash + uVar7 * 4) = piVar9;
                    *(int *)(peer_hash_count + uVar7 * 4) =
                        *(int *)(peer_hash_count + uVar7 * 4) + 1;
                    piVar9[2] = *(int *)(assoc_hash + uVar8 * 4);
                    *(int **)(assoc_hash + uVar8 * 4) = piVar9;
                    *(int *)(assoc_hash_count + uVar8 * 4) =
                        *(int *)(assoc_hash_count + uVar8 * 4) + 1;
                    *piVar9 = (int)peer_list;
                    peer_list = piVar9;
                    FUN_00051594(piVar10, 0);
                    FUN_000366ac(0x81, piVar9, "assoc %d", (short)piVar9[0xf]);
                    goto LAB_00042870;
                }
            } else {
                iVar6 = *(int *)(iVar2 + 0x38);
                if (iVar6 != param_3) {
                    do {
                        if (((param_10 & 0x20) != 0) &&
                            ((*(byte *)(iVar2 + 0x48) & 0x20) != 0))
                            break;
                        iVar3 = any6_interface;
                        if ((short)*param_1 == 2) {
                            iVar3 = any_interface;
                        }
                        if ((iVar3 == param_3) &&
                            (iVar3 = FUN_00027b78(param_1), iVar6 == iVar3))
                            break;
                        iVar2 = FUN_00041f34(param_1, param_2, iVar2, param_5,
                                             param_10, &local_30);
                        if (iVar2 == 0)
                            goto LAB_000428b4;
                        iVar6 = *(int *)(iVar2 + 0x38);
                    } while (iVar6 != param_3);
                }
            }
        }
    }
    piVar9 = (int *)0x0;
LAB_00042870:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(piVar9);
    }
    return;
}

void FUN_00042db8(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_000426dc();
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00043028) */

void FUN_00042fa4(void)

{
    findpeer_calls = 0;
    assocpeer_calls = 0;
    peer_allocations = 0;
    peer_demobilizations = 0;
    peer_timereset = current_time;
    return;
}

void FUN_0004304c(int param_1)

{
    undefined4 uVar1;
    int iVar2;

    iVar2 = __stack_chk_guard;
    if (param_1 != 0) {
        *(undefined4 *)(param_1 + 0x2e4) = 0;
        *(undefined4 *)(param_1 + 0x2e8) = 0;
        uVar1 = current_time;
        *(undefined4 *)(param_1 + 0x2ec) = 0;
        *(undefined4 *)(param_1 + 0x2f0) = 0;
        *(undefined4 *)(param_1 + 0x2d4) = uVar1;
        *(undefined4 *)(param_1 + 0x2f8) = 0;
        *(undefined4 *)(param_1 + 0x2fc) = 0;
        *(undefined4 *)(param_1 + 0x300) = 0;
        *(undefined4 *)(param_1 + 0x304) = 0;
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000430d0(void)

{
    int iVar1;
    int *piVar2;

    iVar1 = __stack_chk_guard;
    for (piVar2 = (int *)peer_list; piVar2 != (int *)0x0;
         piVar2 = (int *)*piVar2) {
        FUN_0004304c(piVar2);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x000431c4) */

void FUN_00043140(int param_1)

{
    uint uVar1;
    uint uVar2;
    undefined4 *puVar3;

    puVar3 = &peer_list;
    do {
        do {
            puVar3 = (undefined4 *)*puVar3;
            if (puVar3 == (undefined4 *)0x0) {
                return;
            }
        } while ((*(byte *)(puVar3 + 0x12) & 0x18) == 0);
        uVar2 = *(uint *)(param_1 + 0x70);
        uVar1 = *(uint *)(param_1 + 0x74);
    } while ((puVar3[0x92] != (uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 |
                               (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18)) ||
             (puVar3[0x93] != (uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                               (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18)));
    return;
}

void FUN_000431d4(int param_1, int param_2, int *param_3)

{
    byte bVar1;
    int iVar2;
    uint uVar3;
    int iVar4;
    uint uVar5;
    int iVar6;

    iVar2 = __stack_chk_guard;
    findpeer_calls = findpeer_calls + 1;
    uVar3 = FUN_0007d544(param_1 + 4);
    iVar6 = *(int *)(peer_hash + (uVar3 & 0x7f) * 4);
    if (iVar6 != 0) {
        do {
            while ((((bVar1 = *(byte *)(iVar6 + 0x3f),
                      bVar1 != 6 && (*(int *)(iVar6 + 0x38) !=
                                     *(int *)(param_1 + 0x3c))) ||
                     (*(short *)(param_1 + 6) != *(short *)(iVar6 + 0x12))) ||
                    (*(short *)(iVar6 + 0x10) != *(short *)(param_1 + 4)))) {
            LAB_00043258:
                iVar6 = *(int *)(iVar6 + 4);
                if (iVar6 == 0)
                    goto LAB_00043300;
            }
            if (*(short *)(iVar6 + 0x10) == 2) {
                iVar4 = *(int *)(param_1 + 8) - *(int *)(iVar6 + 0x14);
                if (iVar4 != 0) {
                    iVar4 = 1;
                }
            } else {
                iVar4 = memcmp((void *)(param_1 + 0xc), (void *)(iVar6 + 0x18),
                               0x10);
                if (iVar4 != 0)
                    goto LAB_00043258;
                iVar4 = *(int *)(param_1 + 0x1c) - *(int *)(iVar6 + 0x28);
                if (iVar4 != 0) {
                    iVar4 = 1;
                }
            }
            if (iVar4 != 0)
                goto LAB_00043258;
            iVar4 = *(int *)(AM + ((uint)bVar1 * 7 + param_2) * 4);
            *param_3 = iVar4;
            if (iVar4 == 1 && param_2 == 4) {
                uVar5 = *(uint *)(param_1 + 0x70);
                uVar3 = *(uint *)(param_1 + 0x74);
                if ((*(uint *)(iVar6 + 0x248) ==
                     (uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                      (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18)) &&
                    (*(uint *)(iVar6 + 0x24c) ==
                     (uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                      (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18)))
                    goto LAB_00043310;
                iVar4 = FUN_00043140(param_1);
                if (iVar4 != 0) {
                    iVar6 = 0;
                    *param_3 = -1;
                    goto LAB_00043310;
                }
                iVar4 = *param_3;
            }
            if (iVar4 == -1) {
                iVar6 = 0;
                goto LAB_00043310;
            }
            if (iVar4 != 0)
                goto LAB_00043310;
            iVar6 = *(int *)(iVar6 + 4);
        } while (iVar6 != 0);
    }
LAB_00043300:
    iVar6 = 0;
    *param_3 = *(int *)(AM + param_2 * 4);
LAB_00043310:
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar6);
    }
    return;
}

void FUN_000433b0(void)

{
    int iVar1;
    int iVar2;
    short sVar3;

    iVar1 = __stack_chk_guard;
    sVar3 = DAT_000cd6ea;
    if (DAT_000cd6ea != DAT_000cd6e8) {
        do {
            if ((sVar3 != 0) && (iVar2 = FUN_0004217c(sVar3), iVar2 != 0)) {
                FUN_000424cc();
            }
            sVar3 = sVar3 + 1;
        } while (DAT_000cd6e8 != sVar3);
    }
    iVar2 = FUN_0004217c();
    if (iVar2 == 0) {
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        FUN_000424cc();
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x0004351c) */

undefined4 FUN_00043478(int param_1)

{
    double dVar1;
    double dVar2;

    dVar2 =
        *(double *)(param_1 + 0x278) +
        (*(double *)(param_1 + 0x268) + *(double *)(param_1 + 0x60)) * 0.5 +
        (double)(uint)(current_time - *(int *)(param_1 + 0x2c0)) * clock_phi +
        *(double *)(param_1 + 0x68) + *(double *)(param_1 + 0x270);
    dVar1 = sys_mindisp;
    if (sys_mindisp <= dVar2) {
        dVar1 = dVar2;
    }
    return SUB84(dVar1, 0);
}

void FUN_00043534(int param_1)

{
    int iVar1;
    int iVar2;
    uint uVar3;
    uint uVar4;
    bool bVar5;
    undefined4 uVar6;
    undefined4 extraout_s1;
    double dVar7;

    iVar1 = __stack_chk_guard;
    if ((*(char *)(param_1 + 0x5b) == '\x03') ||
        ((int)(uint) * (byte *)(param_1 + 0x5d) < sys_floor)) {
        uVar3 = *(uint *)(param_1 + 0x44);
        uVar4 = 0x200;
    } else {
        uVar3 = *(uint *)(param_1 + 0x44);
        if ((int)(uint) * (byte *)(param_1 + 0x5d) < sys_ceiling) {
            uVar4 = 0;
        } else {
            uVar4 = 0x200;
        }
    }
    if ((uVar3 & 8) == 0) {
        uVar6 = FUN_00043478(param_1);
        dVar7 = ldexp(1.0, (uint) * (byte *)(param_1 + 0x40));
        if (sys_maxdist + dVar7 * clock_phi <=
            (double)CONCAT44(extraout_s1, uVar6)) {
            uVar4 = uVar4 | 0x400;
        }
    }
    if (((1 < *(byte *)(param_1 + 0x5d)) &&
         (((iVar2 = *(int *)(param_1 + 0x38),
            iVar2 != 0 && ((*(uint *)(iVar2 + 0x90) & 0x100) == 0)) ||
           (iVar2 = FUN_00027b78(param_1 + 0x10), iVar2 != 0)))) &&
        (*(int *)(param_1 + 0x70) == *(int *)(iVar2 + 0x98))) {
        uVar4 = uVar4 | 0x800;
    }
    if ((*(char *)(param_1 + 0x12a) == '\0') ||
        ((*(uint *)(param_1 + 0x44) & 0x200) != 0)) {
        uVar4 = uVar4 | 0x1000;
    }
    bVar5 = iVar1 != __stack_chk_guard;
    *(uint *)(param_1 + 300) = uVar4 | *(uint *)(param_1 + 300) & 0xffffe1ff;
    if (bVar5) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar4);
    }
    return;
}

void pool_name_resolved(int param_1, undefined4 param_2, undefined2 param_3,
                        undefined4 param_4, undefined4 param_5,
                        undefined4 param_6, undefined4 param_7)

{
    undefined4 uVar1;
    int iVar2;
    undefined4 uVar3;
    char *pcVar4;
    int iVar5;
    undefined4 unaff_r6;
    bool bVar6;
    uint uVar7;
    ushort auStack_890[2];
    uint uStack_88c;
    uint uStack_888;
    undefined4 uStack_884;
    undefined4 uStack_880;
    undefined4 uStack_87c;
    undefined4 uStack_878;
    undefined4 uStack_874;
    undefined4 uStack_870;
    byte bStack_86c;
    char cStack_86b;
    undefined1 uStack_86a;
    undefined1 uStack_869;
    uint uStack_868;
    uint uStack_864;
    undefined4 uStack_860;
    uint uStack_85c;
    uint uStack_858;
    uint uStack_844;
    uint uStack_840;
    int iStack_24;
    int local_1c;

    local_1c = __stack_chk_guard;
    if (param_1 == 0) {
        iVar2 = FUN_0004217c(param_3);
        if (iVar2 == 0) {
            if (local_1c == __stack_chk_guard) {
                FUN_00075d40(3, "Could not find assoc %u for pool DNS %s",
                             param_3, param_4);
                return;
            }
        } else {
            uVar3 = FUN_00079e20(param_7);
            bVar6 = local_1c == __stack_chk_guard;
            *(undefined4 *)(iVar2 + 0x30) = uVar3;
            *(undefined4 *)(iVar2 + 0x34) = uVar3;
            if (bVar6) {
                iVar5 = *(int *)(iVar2 + 0x34);
                if (iVar5 != 0) {
                    unaff_r6 = 0;
                }
                iStack_24 = __stack_chk_guard;
                if (iVar5 != 0) {
                    do {
                        uVar3 = *(undefined4 *)(iVar5 + 0x14);
                        *(undefined4 *)(iVar2 + 0x34) =
                            *(undefined4 *)(iVar5 + 0x1c);
                        iVar5 =
                            FUN_00041f34(uVar3, 0, 0, 3, unaff_r6, unaff_r6);
                        if (iVar5 == 0) {
                            FUN_00050e20(uVar3, auStack_890);
                            if ((auStack_890[0] & 0x7f) != 0) {
                                FUN_00051594(uVar3, 0, current_time + 9);
                            }
                            uVar1 = FUN_00027b78(uVar3);
                            memset(&bStack_86c, 0, 0x848);
                            bStack_86c = sys_leap << 6 | 3U |
                                         (*(byte *)(iVar2 + 0x3e) & 7) << 3;
                            uStack_86a = *(undefined1 *)(iVar2 + 0x40);
                            cStack_86b = sys_stratum;
                            if (sys_stratum == '\x10') {
                                cStack_86b = '\0';
                            }
                            uStack_869 = sys_precision;
                            uStack_860 = sys_refid;
                            uVar7 = (uint)(longlong)(sys_rootdelay * 65536.0);
                            uStack_868 =
                                uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 |
                                (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18;
                            uVar7 = (uint)(0.0 < sys_rootdisp * 65536.0) *
                                    (int)(longlong)(sys_rootdisp * 65536.0);
                            uStack_864 = uVar7 * 0x1000000 |
                                         (uVar7 >> 8 & 0xff) << 0x10 |
                                         (uVar7 >> 0x10 & 0xff) << 8 |
                                         uVar7 >> 0x18;
                            uStack_85c =
                                (uint)sys_reftime << 0x18 |
                                ((uint)sys_reftime >> 8 & 0xff) << 0x10 |
                                ((uint)sys_reftime >> 0x10 & 0xff) << 8 |
                                (uint)sys_reftime >> 0x18;
                            uStack_858 =
                                sys_reftime._4_4_ << 0x18 |
                                (sys_reftime._4_4_ >> 8 & 0xff) << 0x10 |
                                (sys_reftime._4_4_ >> 0x10 & 0xff) << 8 |
                                sys_reftime._4_4_ >> 0x18;
                            FUN_0007055c(&uStack_88c);
                            *(uint *)(iVar2 + 0x248) = uStack_88c;
                            *(uint *)(iVar2 + 0x24c) = uStack_888;
                            uStack_844 = uStack_88c << 0x18 |
                                         (uStack_88c >> 8 & 0xff) << 0x10 |
                                         (uStack_88c >> 0x10 & 0xff) << 8 |
                                         uStack_88c >> 0x18;
                            uStack_840 = uStack_888 << 0x18 |
                                         (uStack_888 >> 8 & 0xff) << 0x10 |
                                         (uStack_888 >> 0x10 & 0xff) << 8 |
                                         uStack_888 >> 0x18;
                            uVar7 = sys_ttlmax;
                            if (*(uint *)(iVar2 + 0x4c) <= sys_ttlmax) {
                                uVar7 = *(uint *)(iVar2 + 0x4c);
                            }
                            FUN_00026cc0(uVar3, uVar1,
                                         *(undefined1 *)((int)&sys_ttl + uVar7),
                                         &bStack_86c, 0x30);
                            *(int *)(iVar2 + 0x2c8) =
                                *(int *)(iVar2 + 0x2c8) +
                                (1 << *(sbyte *)(iVar2 + 0x41)) + -2;
                            *(int *)(iVar2 + 0x2e4) =
                                *(int *)(iVar2 + 0x2e4) + 1;
                            uVar3 = FUN_0007d2c0(uVar3);
                            FUN_00075d40(6, "Soliciting pool server %s", uVar3);
                            break;
                        }
                        iVar5 = *(int *)(iVar2 + 0x34);
                    } while (iVar5 != 0);
                } else {
                    if (*(void **)(iVar2 + 0x30) != (void *)0x0) {
                        free(*(void **)(iVar2 + 0x30));
                        *(undefined4 *)(iVar2 + 0x30) = 0;
                    }
                    uStack_888 = (uint) * (ushort *)(iVar2 + 0x10);
                    uStack_88c = 0;
                    uStack_87c = 0;
                    uStack_878 = 0;
                    uStack_874 = 0;
                    uStack_870 = 0;
                    uStack_884 = 2;
                    uStack_880 = 0x11;
                    iVar5 = FUN_00079464(*(undefined4 *)(iVar2 + 0x2c),
                                         &DAT_0009e38c, &uStack_88c, 0,
                                         pool_name_resolved,
                                         *(undefined2 *)(iVar2 + 0x3c));
                    if (iVar5 != 0) {
                        FUN_00075d40(3, "unable to start pool DNS %s: %m",
                                     *(undefined4 *)(iVar2 + 0x2c));
                    }
                }
                if (iStack_24 == __stack_chk_guard) {
                    return;
                }
                /* WARNING: Subroutine does not return */
                __stack_chk_fail();
            }
        }
    } else {
        pcVar4 = gai_strerror(param_1);
        if (local_1c == __stack_chk_guard) {
            FUN_00075d40(3, "error resolving pool %s: %s (%d)", param_4,
                         pcVar4);
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00043b4c) */

void FUN_00043adc(int param_1)

{
    xmt_leap = (undefined1)param_1;
    sys_leap = xmt_leap;
    if ((param_1 != 3) && (leap_sec_in_progress != 0)) {
        xmt_leap = 3;
    }
    return;
}

void FUN_00043b64(int param_1, int param_2, int param_3, undefined4 param_4)

{
    bool bVar1;
    undefined1 uVar2;
    int iVar3;
    undefined4 local_1c[2];
    int local_14;

    bVar1 = param_1 == 3 && param_2 == 0x10;
    uVar2 = (param_3 == 4 && (param_1 == 3 && param_2 == 0x10)) && bVar1;
    local_14 = __stack_chk_guard;
    local_1c[0] = param_4;
    if (param_3 == 4 && bVar1) {
        iVar3 = memcmp(local_1c, &DAT_000a747c, 4);
        if (iVar3 == 0) {
            uVar2 = 1;
        } else {
            iVar3 = memcmp(local_1c, &DAT_000a750c, 4);
            if (iVar3 == 0) {
                uVar2 = 2;
            } else {
                iVar3 = memcmp(local_1c, &DAT_000a7514, 4);
                if (iVar3 == 0) {
                    uVar2 = 3;
                } else if ((char)local_1c[0] == 'X') {
                    uVar2 = 4;
                } else {
                    uVar2 = 0;
                }
            }
        }
    }
    if (local_14 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00043d48) */

void FUN_00043c5c(void)

{
    return;
}

void FUN_00043d54(undefined4 param_1)

{
    int iVar1;
    char *__s;
    uint uVar2;

    iVar1 = __stack_chk_guard;
    switch (param_1) {
    case 0:
        __s = "AM_NOMATCH";
        break;
    case 1:
        __s = "AM_PROCPKT";
        break;
    case 2:
        __s = "AM_BCST";
        break;
    case 3:
        __s = "AM_FXMIT";
        break;
    case 4:
        __s = "AM_MANYCAST";
        break;
    case 5:
        __s = "AM_NEWPASS";
        break;
    case 6:
        __s = "AM_NEWBCL";
        break;
    case 7:
        __s = "AM_POSSBCL";
        break;
    case 0xffffffff:
        __s = "AM_ERR";
        break;
    default:
        __s = lib_stringbuf + lib_nextbuf * 0x80;
        uVar2 = lib_nextbuf + 1;
        memset(__s, 0, 0x80);
        lib_nextbuf = uVar2 & 0xf;
        FUN_0007d00c(__s, 0x80, "AM_#%d", param_1);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__s);
    }
    return;
}

void FUN_00043ebc(int param_1)

{
    int iVar1;
    void *__ptr;
    int iVar2;
    bool bVar3;

    iVar1 = __stack_chk_guard;
    __ptr = *(void **)(param_1 + 0xf0);
    if (__ptr != (void *)0x0) {
        if (-1 < *(int *)(param_1 + 0xf4)) {
            iVar2 = 0;
            do {
                FUN_000730c4(*(undefined4 *)((int)__ptr + iVar2 * 4), 0);
                iVar2 = iVar2 + 1;
                __ptr = *(void **)(param_1 + 0xf0);
            } while (iVar2 <= *(int *)(param_1 + 0xf4));
        }
        free(__ptr);
        *(undefined4 *)(param_1 + 0xf0) = 0;
    }
    FUN_00037f0c(param_1 + 0x110);
    bVar3 = iVar1 == __stack_chk_guard;
    *(undefined4 *)(param_1 + 0xf4) = 0;
    *(uint *)(param_1 + 0x44) = *(uint *)(param_1 + 0x44) & 0xffff7fff;
    if (bVar3) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00043f68(int param_1)

{
    uint uVar1;
    int *__ptr;
    int iVar2;
    undefined4 uVar3;
    uint *puVar4;
    int iVar5;
    uint uVar6;
    undefined4 uVar7;
    uint uVar8;
    double dVar9;
    uint local_884;
    uint local_880;
    uint local_87c;
    uint local_878;
    byte local_874;
    char local_873;
    undefined1 local_872;
    undefined1 local_871;
    uint local_870;
    uint local_86c;
    undefined4 local_868;
    uint local_864;
    uint local_860;
    uint local_85c;
    uint local_858;
    uint local_854;
    uint local_850;
    uint local_84c;
    uint local_848;
    int local_2c;

    local_2c = __stack_chk_guard;
    if (*(int *)(param_1 + 0x38) == 0)
        goto LAB_0004422c;
    local_872 = *(undefined1 *)(param_1 + 0x40);
    local_874 = *(byte *)(param_1 + 0x3f) & 7 | sys_leap << 6 |
                (*(byte *)(param_1 + 0x3e) & 7) << 3;
    local_873 = sys_stratum;
    if (sys_stratum == '\x10') {
        local_873 = '\0';
    }
    uVar1 = *(uint *)(param_1 + 0x230);
    local_871 = sys_precision;
    local_85c = uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
    uVar1 = *(uint *)(param_1 + 0x234);
    local_868 = sys_refid;
    local_858 = uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
    uVar1 = *(uint *)(param_1 + 0x240);
    local_854 = uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
    uVar1 = (uint)(longlong)(sys_rootdelay * 65536.0);
    local_870 = uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
    uVar1 = (uint)(0.0 < sys_rootdisp * 65536.0) *
            (int)(longlong)(sys_rootdisp * 65536.0);
    local_86c = uVar1 * 0x1000000 | (uVar1 >> 8 & 0xff) << 0x10 |
                (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
    local_860 =
        sys_reftime._4_4_ << 0x18 | (sys_reftime._4_4_ >> 8 & 0xff) << 0x10 |
        (sys_reftime._4_4_ >> 0x10 & 0xff) << 8 | sys_reftime._4_4_ >> 0x18;
    local_864 =
        (uint)sys_reftime << 0x18 | ((uint)sys_reftime >> 8 & 0xff) << 0x10 |
        ((uint)sys_reftime >> 0x10 & 0xff) << 8 | (uint)sys_reftime >> 0x18;
    uVar1 = *(uint *)(param_1 + 0x244);
    local_850 = uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
    if ((*(uint *)(param_1 + 0x44) & 0x800) == 0) {
        if (*(int *)(param_1 + 0x7c) != 0) {
        LAB_000440ac:
            uVar1 = 0x30;
            goto LAB_000440b4;
        }
        FUN_0007055c(&local_884);
        iVar5 = *(int *)(param_1 + 0x13c);
        if (iVar5 == 0) {
            local_84c = local_884 << 0x18 | (local_884 >> 8 & 0xff) << 0x10 |
                        (local_884 >> 0x10 & 0xff) << 8 | local_884 >> 0x18;
            *(uint *)(param_1 + 0x248) = local_884;
            *(uint *)(param_1 + 0x24c) = local_880;
            local_848 = local_880 << 0x18 | (local_880 >> 8 & 0xff) << 0x10 |
                        (local_880 >> 0x10 & 0xff) << 8 | local_880 >> 0x18;
        } else if (*(char *)(param_1 + 0x3f) == '\x05') {
            local_84c = local_884 << 0x18 | (local_884 >> 8 & 0xff) << 0x10 |
                        (local_884 >> 0x10 & 0xff) << 8 | local_884 >> 0x18;
            local_848 = local_880 << 0x18 | (local_880 >> 8 & 0xff) << 0x10 |
                        (local_880 >> 0x10 & 0xff) << 8 | local_880 >> 0x18;
            if (iVar5 < 1) {
                uVar1 = *(uint *)(param_1 + 0x248);
                uVar8 = *(uint *)(param_1 + 0x24c);
            } else {
                uVar1 = *(uint *)(param_1 + 0x250);
                uVar8 = *(uint *)(param_1 + 0x254);
            }
            local_85c = uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                        (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
            local_858 = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 |
                        (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
        } else {
            if (iVar5 < 1) {
                uVar1 = *(uint *)(param_1 + 0x248);
                uVar8 = *(uint *)(param_1 + 0x24c);
            } else {
                uVar1 = *(uint *)(param_1 + 0x250);
                uVar8 = *(uint *)(param_1 + 0x254);
            }
            local_84c = uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                        (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
            local_848 = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 |
                        (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
        }
        *(undefined4 *)(param_1 + 0x298) = 0x30;
        uVar1 = sys_ttlmax;
        if (*(uint *)(param_1 + 0x4c) <= sys_ttlmax) {
            uVar1 = *(uint *)(param_1 + 0x4c);
        }
        FUN_00026cc0(param_1 + 0x10, *(undefined4 *)(param_1 + 0x38),
                     *(undefined1 *)((int)&sys_ttl + uVar1), &local_874, 0x30);
        *(int *)(param_1 + 0x2c8) =
            *(int *)(param_1 + 0x2c8) + (1 << *(sbyte *)(param_1 + 0x41)) + -2;
        *(int *)(param_1 + 0x2e4) = *(int *)(param_1 + 0x2e4) + 1;
        FUN_0007055c(&local_87c);
        iVar5 = *(int *)(param_1 + 0x13c);
        if (iVar5 != 0) {
            if (iVar5 < 1) {
                puVar4 = (uint *)(param_1 + 0x250);
            } else {
                puVar4 = (uint *)(param_1 + 0x248);
            }
            *puVar4 = local_87c;
            puVar4[1] = local_878;
            *(int *)(param_1 + 0x13c) = -iVar5;
        }
        local_880 = local_878 - local_880;
        local_87c = local_87c - local_884;
        if (local_878 < local_880) {
            local_87c = local_87c - 1;
        }
        uVar1 = -((int)local_87c >> 0x1f);
        uVar8 = (int)local_87c >> 0x1f ^ local_880;
        iVar5 = uVar1 + uVar8;
        iVar2 = (-(uint)(uVar1 != 0) ^ local_87c) + (uint)CARRY4(uVar1, uVar8);
        local_878 = local_880;
    } else {
        while (true) {
            if (*(int *)(param_1 + 0xf4) == 0) {
                FUN_0003789c(param_1, *(undefined4 *)(param_1 + 0x38));
                iVar5 = *(int *)(param_1 + 0xf4);
            } else {
                iVar5 = *(int *)(param_1 + 0xf4) + -1;
                *(int *)(param_1 + 0xf4) = iVar5;
            }
            uVar7 = *(undefined4 *)(*(int *)(param_1 + 0xf0) + iVar5 * 4);
            iVar5 = FUN_000731e8(uVar7);
            if (iVar5 != 0)
                break;
            FUN_00043ebc(param_1);
        }
        *(undefined4 *)(param_1 + 0x7c) = uVar7;
        switch (*(undefined1 *)(param_1 + 0x3f)) {
        case 1:
            break;
        case 2:
            break;
        case 3:
            uVar1 = *(uint *)(param_1 + 0x88);
            if (uVar1 == 0)
                goto LAB_0004474c;
            if ((uVar1 & 0x100) == 0)
                goto LAB_00044774;
            if ((uVar1 & 0x200) == 0)
                goto LAB_000447d4;
            if ((uVar1 & 0x800) == 0)
                goto LAB_00044804;
            if ((uVar1 & 0x1000) == 0) {
                __ptr = (int *)FUN_00037c90(param_1, 0x2040000,
                                            *(undefined2 *)(param_1 + 0x84));
                goto LAB_00044318;
            }
            goto joined_r0x00044424;
        case 4:
        default:
            puVar4 = *(uint **)(param_1 + 0xe8);
            goto joined_r0x00044504;
        case 5:
            if ((*(uint *)(param_1 + 0x44) & 0x8000) == 0) {
                uVar3 = 0x82010000;
            } else {
                uVar3 = 0x82040000;
            }
            __ptr = (int *)FUN_00037c90(param_1, uVar3,
                                        *(undefined2 *)(param_1 + 0x3c), 0);
            goto LAB_00044318;
        }
        uVar1 = *(uint *)(param_1 + 0x88);
        if (uVar1 == 0) {
        LAB_0004474c:
            uVar3 = 0x2010000;
        LAB_00044758:
            __ptr = (int *)FUN_00037c90(param_1, uVar3,
                                        *(undefined2 *)(param_1 + 0x3c),
                                        hostval._12_4_);
        LAB_00044318:
            puVar4 = *(uint **)(param_1 + 0xe8);
            if (puVar4 == (uint *)0x0) {
                if (__ptr == (int *)0x0)
                    goto LAB_000440ac;
                uVar1 = 0x30;
            } else {
                *puVar4 = *puVar4 | 0x80;
                iVar5 = FUN_00039b24(param_1, &local_874, 0, 0x30, puVar4, 0);
                uVar1 = iVar5 + 0x30;
                free(*(void **)(param_1 + 0xe8));
                *(undefined4 *)(param_1 + 0xe8) = 0;
                if (__ptr == (int *)0x0)
                    goto LAB_00044380;
            }
            if (*__ptr != 0) {
                iVar5 = FUN_00039b24(param_1, &local_874, 0, uVar1, __ptr, 0);
                uVar1 = uVar1 + iVar5;
            }
            free(__ptr);
        } else {
            if ((uVar1 & 0x100) == 0) {
            LAB_00044774:
                __ptr = (int *)FUN_00037c90(param_1, 0x2020000,
                                            *(undefined2 *)(param_1 + 0x3c),
                                            *(undefined4 *)(param_1 + 0x98));
                goto LAB_00044318;
            }
            if ((uVar1 & 0x200) == 0) {
            LAB_000447d4:
                uVar3 = FUN_00037b88(param_1);
                __ptr = (int *)FUN_00037c90(param_1, uVar3,
                                            *(undefined2 *)(param_1 + 0x3c), 0);
                goto LAB_00044318;
            }
            if (((sys_leap != '\x03') &&
                 (*(char *)(param_1 + 0x5b) != '\x03')) &&
                ((uVar1 & 0x800) == 0)) {
            LAB_00044804:
                __ptr = (int *)FUN_00037c90(param_1, 0x2030000,
                                            *(undefined2 *)(param_1 + 0x3c), 0);
                goto LAB_00044318;
            }
            if ((uVar1 & 0x1000) == 0) {
                __ptr = (int *)FUN_00037c90(param_1, 0x2040000,
                                            *(undefined2 *)(param_1 + 0x3c));
                goto LAB_00044318;
            }
            if ((*(uint *)(param_1 + 0x44) & 0x8000) == 0) {
            joined_r0x00044424:
                if (sys_leap != '\x03') {
                    if ((uVar1 & 0x2000) == 0)
                        goto LAB_000444e8;
                    if ((uVar1 & 0x4000) == 0) {
                        __ptr = (int *)FUN_00037c90(
                            param_1, 0x2050000, *(undefined2 *)(param_1 + 0x3c),
                            0);
                        goto LAB_00044318;
                    }
                }
                puVar4 = *(uint **)(param_1 + 0xe8);
                if (puVar4 == (uint *)0x0)
                    goto LAB_000440ac;
                *puVar4 = *puVar4 | 0x80;
            } else {
                if ((uVar1 & 0x2000) != 0) {
                    __ptr =
                        (int *)FUN_00037c90(param_1, 0x82040000,
                                            *(undefined2 *)(param_1 + 0x84), 0);
                    goto LAB_00044318;
                }
                if (sys_leap != '\x03') {
                LAB_000444e8:
                    uVar3 = 0x2060000;
                    goto LAB_00044758;
                }
                puVar4 = *(uint **)(param_1 + 0xe8);
            joined_r0x00044504:
                if (puVar4 == (uint *)0x0)
                    goto LAB_000440ac;
                *puVar4 = *puVar4 | 0x80;
            }
            iVar5 = FUN_00039b24(param_1, &local_874, 0, 0x30, puVar4, 0);
            uVar1 = iVar5 + 0x30;
            free(*(void **)(param_1 + 0xe8));
            *(undefined4 *)(param_1 + 0xe8) = 0;
        }
    LAB_00044380:
        if (0x30 < uVar1) {
            FUN_00037700(*(int *)(param_1 + 0x38) + 0x18, param_1 + 0x10, uVar7,
                         0, 2);
        }
    LAB_000440b4:
        FUN_0007055c(&local_884);
        iVar5 = *(int *)(param_1 + 0x13c);
        if (iVar5 == 0) {
            local_84c = local_884 << 0x18 | (local_884 >> 8 & 0xff) << 0x10 |
                        (local_884 >> 0x10 & 0xff) << 8 | local_884 >> 0x18;
            *(uint *)(param_1 + 0x248) = local_884;
            *(uint *)(param_1 + 0x24c) = local_880;
            local_848 = local_880 << 0x18 | (local_880 >> 8 & 0xff) << 0x10 |
                        (local_880 >> 0x10 & 0xff) << 8 | local_880 >> 0x18;
        } else if (*(char *)(param_1 + 0x3f) == '\x05') {
            local_84c = local_884 << 0x18 | (local_884 >> 8 & 0xff) << 0x10 |
                        (local_884 >> 0x10 & 0xff) << 8 | local_884 >> 0x18;
            local_848 = local_880 << 0x18 | (local_880 >> 8 & 0xff) << 0x10 |
                        (local_880 >> 0x10 & 0xff) << 8 | local_880 >> 0x18;
            if (iVar5 < 1) {
                uVar8 = *(uint *)(param_1 + 0x248);
                uVar6 = *(uint *)(param_1 + 0x24c);
            } else {
                uVar8 = *(uint *)(param_1 + 0x250);
                uVar6 = *(uint *)(param_1 + 0x254);
            }
            local_85c = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 |
                        (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
            local_858 = uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10 |
                        (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18;
        } else {
            if (iVar5 < 1) {
                uVar8 = *(uint *)(param_1 + 0x248);
                uVar6 = *(uint *)(param_1 + 0x24c);
            } else {
                uVar8 = *(uint *)(param_1 + 0x250);
                uVar6 = *(uint *)(param_1 + 0x254);
            }
            local_84c = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 |
                        (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
            local_848 = uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10 |
                        (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18;
        }
        uVar8 = *(uint *)(param_1 + 0x7c);
        iVar5 = FUN_000736a4(uVar8, &local_874, uVar1);
        if (iVar5 == 0) {
            FUN_00036294(0x8c, param_1, "no key");
            *(uint *)(param_1 + 300) = *(uint *)(param_1 + 300) | 0x10;
            *(int *)(param_1 + 0x2f0) = *(int *)(param_1 + 0x2f0) + 1;
            goto LAB_0004422c;
        }
        uVar1 = iVar5 + uVar1;
        if (0xffff < uVar8) {
            FUN_000730c4(uVar8, 0);
        }
        if (0x848 < uVar1) {
            FUN_00075d40(3, "peer_xmit: buffer overflow %zu", uVar1);
            /* WARNING: Subroutine does not return */
            exit(-1);
        }
        *(uint *)(param_1 + 0x298) = uVar1;
        uVar8 = sys_ttlmax;
        if (*(uint *)(param_1 + 0x4c) <= sys_ttlmax) {
            uVar8 = *(uint *)(param_1 + 0x4c);
        }
        FUN_00026cc0(param_1 + 0x10, *(undefined4 *)(param_1 + 0x38),
                     *(undefined1 *)((int)&sys_ttl + uVar8), &local_874, uVar1);
        *(int *)(param_1 + 0x2c8) =
            *(int *)(param_1 + 0x2c8) + (1 << *(sbyte *)(param_1 + 0x41)) + -2;
        *(int *)(param_1 + 0x2e4) = *(int *)(param_1 + 0x2e4) + 1;
        FUN_0007055c(&local_87c);
        iVar5 = *(int *)(param_1 + 0x13c);
        if (iVar5 != 0) {
            if (iVar5 < 1) {
                puVar4 = (uint *)(param_1 + 0x250);
            } else {
                puVar4 = (uint *)(param_1 + 0x248);
            }
            *puVar4 = local_87c;
            puVar4[1] = local_878;
            *(int *)(param_1 + 0x13c) = -iVar5;
        }
        local_880 = local_878 - local_880;
        local_87c = local_87c - local_884;
        if (local_878 < local_880) {
            local_87c = local_87c - 1;
        }
        uVar1 = -((int)local_87c >> 0x1f);
        uVar8 = (int)local_87c >> 0x1f ^ local_880;
        iVar5 = uVar8 + uVar1;
        iVar2 = (-(uint)(uVar1 != 0) ^ local_87c) + (uint)CARRY4(uVar8, uVar1);
        local_878 = local_880;
    }
    dVar9 = (double)FUN_0009d40c(iVar5, iVar2);
    dVar9 = ldexp(dVar9, -0x20);
    if (uVar1 != 0) {
        dVar9 = -dVar9;
    }
    *(double *)(param_1 + 0x280) = dVar9;
LAB_0004422c:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000448c4(int param_1, uint param_2)

{
    int iVar1;
    uint uVar2;
    int iVar3;
    uint uVar4;
    uint uVar5;
    uint uVar6;
    int iVar7;

    iVar1 = __stack_chk_guard;
    uVar4 = (uint) * (byte *)(param_1 + 0x41);
    if (*(byte *)(param_1 + 0x42) <= param_2) {
        param_2 = (uint) * (byte *)(param_1 + 0x42);
    }
    if (param_2 < uVar4) {
        param_2 = uVar4;
    }
    if (((*(uint *)(param_1 + 0x44) & 0x800) != 0) &&
        (*(byte *)(param_1 + 0x40) != param_2)) {
        FUN_00043ebc();
        uVar4 = (uint) * (byte *)(param_1 + 0x41);
    }
    *(char *)(param_1 + 0x40) = (char)param_2;
    iVar7 = *(int *)(param_1 + 0x2c8);
    iVar3 = iVar7 - (7 << uVar4);
    if (iVar3 < ntp_minpkt) {
        iVar3 = ntp_minpkt;
    }
    uVar6 = current_time + iVar3;
    if (*(int *)(param_1 + 0x134) < 1) {
        if (*(int *)(param_1 + 0xe8) == 0) {
            uVar5 = uVar4;
            if ((*(int *)(param_1 + 0x138) < 1) &&
                (uVar5 = param_2, *(byte *)(param_1 + 0x5e) <= param_2)) {
                uVar5 = (uint) * (byte *)(param_1 + 0x5e);
            }
            if ((*(uint *)(param_1 + 0x44) & 8) == 0) {
                uVar2 = FUN_00079a2c();
                iVar7 = *(int *)(param_1 + 0x2c8);
                uVar4 = (uint) * (byte *)(param_1 + 0x41);
                uVar5 = ((uVar2 & 0xff | 0x1000) << (uVar5 & 0xff)) >> 0xc;
            } else {
                uVar5 = 1 << (uVar5 & 0xff);
            }
            uVar5 = uVar5 + *(int *)(param_1 + 0x2cc);
            if (uVar5 < uVar6) {
                uVar5 = uVar6;
            }
            *(uint *)(param_1 + 0x2d0) = uVar5;
            if (1 << uVar4 < iVar7) {
                *(uint *)(param_1 + 0x2d0) = uVar5 + ntp_minpkt;
            }
            goto LAB_00044988;
        }
        if ((current_time < *(uint *)(param_1 + 0x2d0)) &&
            (ntp_minpkt + *(uint *)(param_1 + 0x2d0) == uVar6))
            goto LAB_00044988;
    } else {
        if (current_time < *(uint *)(param_1 + 0x2d0))
            goto LAB_00044988;
        if ((*(uint *)(param_1 + 0x44) & 8) != 0) {
            *(uint *)(param_1 + 0x2d0) = current_time + 1;
            goto LAB_00044988;
        }
    }
    *(uint *)(param_1 + 0x2d0) = uVar6;
LAB_00044988:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00045a54) */
/* WARNING: Removing unreachable block (ram,0x00045a40) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same
 * address */

void FUN_00044a5c(void)

{
    byte bVar1;
    int *piVar2;
    int iVar3;
    int iVar4;
    double *pdVar5;
    int iVar6;
    undefined4 *puVar7;
    int iVar8;
    uint uVar9;
    double *pdVar10;
    int iVar11;
    undefined4 uVar12;
    int *piVar13;
    uint uVar14;
    undefined4 uVar15;
    int iVar16;
    int iVar17;
    int iVar18;
    int *piVar19;
    undefined4 *puVar20;
    undefined4 *puVar21;
    int iVar22;
    bool bVar23;
    undefined4 uVar24;
    undefined4 extraout_s1;
    double dVar25;
    double dVar26;
    double dVar27;
    double dVar28;
    undefined8 uVar29;
    double dVar30;
    int *local_88;
    int *local_84;
    int *local_78;
    undefined4 local_5c[2];
    int local_54;

    iVar4 = sys_peer;
    local_54 = __stack_chk_guard;
    sys_survivors = 0;
    if (peer_list == (int *)0x0) {
        iVar8 = 0x48;
        DAT_000cd6f8 = 8;
        DAT_000cd6f0 = 0x20;
    } else {
        iVar8 = 1;
        piVar13 = peer_list;
        do {
            piVar13 = (int *)*piVar13;
            iVar8 = iVar8 + 1;
        } while (piVar13 != (int *)0x0);
        DAT_000cd6f8 = iVar8 * 8;
        uVar14 = (uint)(iVar8 * 0x20) >> 3;
        DAT_000cd6f0 = uVar14 << 3;
        iVar8 = DAT_000cd6f8 + uVar14 * 0x10;
    }
    DAT_000cd6f4 = DAT_000cd6f0;
    DAT_000cd6fc = FUN_00074b04(DAT_000cd6fc, iVar8, 0);
    if (DAT_000cd6f0 == 0) {
        uVar14 = 8;
    } else {
        uVar14 = DAT_000cd6f0 + 7U & 0xfffffff8;
    }
    if (DAT_000cd6f4 == 0) {
        uVar9 = 8;
    } else {
        uVar9 = DAT_000cd6f4 + 7U & 0xfffffff8;
    }
    DAT_000cd700 = (undefined4 *)(DAT_000cd6fc + uVar14);
    DAT_000cd704 = (int *)((int)DAT_000cd700 + uVar9);
    local_88 = peer_list;
    if (peer_list == (int *)0x0) {
        iVar8 = 0;
        local_84 = local_88;
        local_78 = local_88;
    LAB_00045600:
        puVar7 = DAT_000cd700;
        DAT_000cd700[4] = 0;
        puVar7[5] = 0;
        uVar24 = sys_mindisp._4_4_;
        puVar7[2] = (undefined4)sys_mindisp;
        puVar7[3] = uVar24;
        if (local_84 == (int *)0x0) {
            if ((local_88 == (int *)0x0) &&
                (local_88 = local_78, local_78 == (int *)0x0)) {
                iVar3 = 0;
                goto LAB_00044f90;
            }
            *puVar7 = local_88;
        } else {
            *puVar7 = local_84;
        }
        iVar3 = 1;
    } else {
        dVar25 = 8589934590.0;
        iVar8 = 0;
        iVar17 = 0;
        local_88 = (int *)0x0;
        local_84 = (int *)0x0;
        local_78 = (int *)0x0;
        piVar13 = peer_list;
        do {
            *(undefined1 *)((int)piVar13 + 0x129) = 0;
            iVar3 = FUN_00043534(piVar13);
            if (iVar3 == 0) {
                if (*(byte *)((int)piVar13 + 0x5d) == sys_orphan) {
                    if (piVar13[0xe] == 0) {
                        uVar14 = 0xffffffff;
                    } else {
                        uVar14 = *(uint *)(piVar13[0xe] + 0x98);
                        uVar14 = uVar14 << 0x18 | (uVar14 >> 8 & 0xff) << 0x10 |
                                 (uVar14 >> 0x10 & 0xff) << 8 | uVar14 >> 0x18;
                    }
                    uVar9 = FUN_00071720(piVar13 + 4);
                    uVar9 = uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10 |
                            (uVar9 >> 0x10 & 0xff) << 8 | uVar9 >> 0x18;
                    if ((uVar9 < uVar14) &&
                        (dVar27 = (double)uVar9, dVar27 < dVar25)) {
                        dVar25 = dVar27;
                        local_78 = piVar13;
                    }
                } else if ((int)(uint) * (byte *)((int)piVar13 + 0x5d) <=
                           (int)sys_orphan) {
                    if ((piVar13[0x11] & 0x20U) == 0) {
                        if ((char)piVar13[0x16] == '\x01') {
                            if (orphwait < current_time &&
                                local_88 == (int *)0x0) {
                                local_88 = piVar13;
                            }
                        } else {
                            if ((char)piVar13[0x16] != '\x12')
                                goto LAB_00044bec;
                            if (orphwait < current_time &&
                                local_84 == (int *)0x0) {
                                local_84 = piVar13;
                            }
                        }
                    } else {
                    LAB_00044bec:
                        *(undefined1 *)((int)piVar13 + 0x129) = 1;
                        uVar24 = FUN_00043478(piVar13);
                        puVar7 = DAT_000cd700;
                        iVar3 = DAT_000cd6fc;
                        dVar27 = (double)CONCAT44(extraout_s1, uVar24);
                        dVar26 = *(double *)(piVar13 + 0x98);
                        uVar29 = *(undefined8 *)(piVar13 + 0x9c);
                        DAT_000cd700[iVar17 * 8] = piVar13;
                        pdVar10 = (double *)(iVar3 + iVar8 * 0x10);
                        pdVar5 = (double *)(iVar3 + iVar8 * 0x10 + 0x10);
                        iVar8 = iVar8 + 2;
                        *(undefined8 *)(puVar7 + iVar17 * 8 + 4) = uVar29;
                        *(double *)(puVar7 + iVar17 * 8 + 2) = dVar27;
                        *(undefined4 *)(pdVar10 + 1) = 0xffffffff;
                        *pdVar10 = dVar26 - dVar27;
                        *(undefined4 *)(pdVar5 + 1) = 1;
                        *pdVar5 = dVar26 + dVar27;
                        iVar17 = iVar17 + 1;
                    }
                }
            }
            piVar2 = DAT_000cd704;
            piVar13 = (int *)*piVar13;
        } while (piVar13 != (int *)0x0);
        if (iVar8 != 0) {
            piVar19 = DAT_000cd704 + -1;
            iVar3 = 0;
            piVar13 = piVar19;
            do {
                piVar13 = piVar13 + 1;
                *piVar13 = iVar3;
                iVar18 = DAT_000cd6fc;
                iVar3 = iVar3 + 1;
            } while (iVar3 != iVar8);
            iVar3 = 0;
            do {
                do {
                    piVar19 = piVar19 + 1;
                    iVar22 = iVar3 + 1;
                    dVar25 = *(double *)(iVar18 + *piVar19 * 0x10);
                    piVar13 = piVar19;
                    iVar11 = iVar22;
                    iVar6 = iVar3;
                    if (iVar8 <= iVar22)
                        goto LAB_00044d4c;
                    do {
                        dVar27 = *(double *)(iVar18 + piVar13[1] * 0x10);
                        if (dVar27 < dVar25) {
                            iVar6 = iVar11;
                        }
                        iVar11 = iVar11 + 1;
                        if (dVar27 < dVar25) {
                            dVar25 = dVar27;
                        }
                        piVar13 = piVar13 + 1;
                    } while (iVar11 != iVar8);
                    bVar23 = iVar3 == iVar6;
                    iVar3 = iVar22;
                } while (bVar23);
                iVar11 = piVar2[iVar6];
                piVar2[iVar6] = *piVar19;
                *piVar19 = iVar11;
            } while (iVar22 < iVar8);
        }
    LAB_00044d4c:
        puVar7 = DAT_000cd700;
        if (iVar17 == 0) {
            iVar8 = 0;
            goto LAB_00045600;
        }
        iVar18 = iVar8 + -1;
        dVar25 = -1000000000.0;
        dVar27 = 1000000000.0;
        iVar3 = iVar17;
        do {
            if (iVar8 != 0) {
                pdVar5 = (double *)(DAT_000cd6fc + *DAT_000cd704 * 0x10);
                dVar27 = *pdVar5;
                iVar11 = -*(int *)(pdVar5 + 1);
                if (iVar11 < iVar3) {
                    iVar6 = 0;
                    piVar13 = DAT_000cd704;
                    do {
                        iVar6 = iVar6 + 1;
                        if (iVar6 == iVar8)
                            break;
                        piVar13 = piVar13 + 1;
                        pdVar5 = (double *)(DAT_000cd6fc + *piVar13 * 0x10);
                        dVar27 = *pdVar5;
                        iVar11 = iVar11 - *(int *)(pdVar5 + 1);
                    } while (iVar11 < iVar3);
                }
            }
            if (iVar18 != -1) {
                pdVar5 = (double *)(DAT_000cd6fc + DAT_000cd704[iVar18] * 0x10);
                iVar6 = *(int *)(pdVar5 + 1);
                dVar25 = *pdVar5;
                iVar11 = iVar18;
                piVar13 = DAT_000cd704 + iVar18;
                while ((iVar6 < iVar3 &&
                        (bVar23 = iVar11 != 0, iVar11 = iVar11 + -1, bVar23))) {
                    piVar13 = piVar13 + -1;
                    pdVar5 = (double *)(DAT_000cd6fc + *piVar13 * 0x10);
                    dVar25 = *pdVar5;
                    iVar6 = iVar6 + *(int *)(pdVar5 + 1);
                }
            }
        } while (
            (dVar25 <= dVar27) &&
            (iVar3 = iVar3 + -1, iVar3 != (iVar17 - 1U) - (iVar17 - 1U >> 1)));
        iVar8 = 0;
        iVar3 = 0;
        iVar18 = 0;
        pdVar5 = (double *)(DAT_000cd700 + 2);
        do {
            while (true) {
                iVar11 = *(int *)(pdVar5 + -1);
                if (((dVar25 <= dVar27) ||
                     (*(double *)(iVar11 + 0x260) + *pdVar5 < dVar27)) ||
                    (dVar25 < *(double *)(iVar11 + 0x260) - *pdVar5))
                    break;
                uVar14 = *(uint *)(iVar11 + 0x44);
            LAB_00044ee4:
                if ((uVar14 & 0x80) == 0) {
                LAB_00044efc:
                    if (iVar3 != iVar18) {
                        puVar20 = puVar7 + iVar3 * 8;
                        uVar24 = *(undefined4 *)((int)pdVar5 + -4);
                        uVar12 = *(undefined4 *)pdVar5;
                        uVar15 = *(undefined4 *)((int)pdVar5 + 4);
                        *puVar20 = *(undefined4 *)(pdVar5 + -1);
                        puVar20[1] = uVar24;
                        puVar20[2] = uVar12;
                        puVar20[3] = uVar15;
                        uVar24 = *(undefined4 *)((int)pdVar5 + 0xc);
                        uVar12 = *(undefined4 *)(pdVar5 + 2);
                        uVar15 = *(undefined4 *)((int)pdVar5 + 0x14);
                        puVar20[4] = *(undefined4 *)(pdVar5 + 1);
                        puVar20[5] = uVar24;
                        puVar20[6] = uVar12;
                        puVar20[7] = uVar15;
                    }
                    iVar3 = iVar3 + 1;
                } else {
                    if (iVar8 == 0) {
                        iVar8 = iVar11;
                    }
                    if ((uVar14 & 0x10000) != 0)
                        goto LAB_00044efc;
                }
                iVar18 = iVar18 + 1;
                pdVar5 = pdVar5 + 4;
                if (iVar18 == iVar17)
                    goto LAB_00044f60;
            }
            uVar14 = *(uint *)(iVar11 + 0x44);
            if ((uVar14 & 0x400) != 0)
                goto LAB_00044ee4;
            iVar18 = iVar18 + 1;
            pdVar5 = pdVar5 + 4;
        } while (iVar18 != iVar17);
    LAB_00044f60:
        puVar7 = DAT_000cd700;
        if (iVar3 == 0)
            goto LAB_00045600;
    }
    iVar17 = 0;
    do {
        iVar18 = iVar17 * 8;
        iVar17 = iVar17 + 1;
        *(undefined1 *)(puVar7[iVar18] + 0x129) = 3;
    } while (iVar17 < iVar3);
LAB_00044f90:
    iVar17 = iVar3 << 5;
    if (iVar3 == 0)
        goto LAB_00045144;
LAB_00044fd4:
    puVar7 = DAT_000cd700;
    iVar18 = 0;
    dVar25 = 0.0;
    iVar11 = 0;
    dVar26 = -1000000000.0;
    dVar27 = 1000000000.0;
    pdVar5 = (double *)(DAT_000cd700 + 6);
    do {
        *pdVar5 = 0.0;
        if (pdVar5[-1] < dVar27) {
            dVar27 = pdVar5[-1];
        }
        if (iVar3 == 1) {
            dVar30 = 0.0;
        } else {
            iVar6 = 0;
            dVar30 = 0.0;
            do {
                iVar22 = iVar6 * 8;
                iVar6 = iVar6 + 1;
                dVar28 = *(double *)(puVar7[iVar22] + 0x260) -
                         *(double *)(*(int *)(pdVar5 + -3) + 0x260);
                dVar30 = dVar30 + dVar28 * dVar28;
            } while (iVar6 != iVar3);
            dVar30 = SQRT(dVar30 / (double)(longlong)(iVar3 + -1));
            *pdVar5 = dVar30;
        }
        dVar28 = dVar30 * pdVar5[-2];
        if (dVar26 < dVar28) {
            iVar18 = iVar11;
        }
        iVar11 = iVar11 + 1;
        if (dVar26 < dVar28) {
            dVar26 = dVar28;
            dVar25 = dVar30;
        }
        pdVar5 = pdVar5 + 4;
    } while (iVar11 != iVar3);
    do {
        dVar26 = ldexp(1.0, (int)sys_precision);
        if (dVar25 <= dVar26) {
            dVar25 = ldexp(1.0, (int)sys_precision);
        }
        puVar7 = DAT_000cd700;
        iVar11 = sys_minclock;
        if (sys_minclock < 1) {
            iVar11 = 1;
        }
        if (iVar3 <= iVar11) {
            DAT_000cd708 = 0;
            DAT_000cd70c = 0;
            if (iVar3 != 0) {
            LAB_00045184:
                iVar17 = 0;
                dVar27 = 1000000000.0;
                iVar11 = 0;
                iVar22 = 0;
                dVar25 = (double)CONCAT44(sys_mindisp._4_4_,
                                          (undefined4)sys_mindisp);
                pdVar5 = (double *)(DAT_000cd700 + 6);
                iVar18 = 0;
                iVar6 = 0;
                do {
                    iVar16 = *(int *)(pdVar5 + -3);
                    *(undefined4 *)(iVar16 + 0x2c4) = 0;
                    *(undefined1 *)(iVar16 + 0x129) = 4;
                    DAT_000cd70c = iVar18;
                    DAT_000cd708 = iVar6;
                    if (*(char *)(iVar16 + 0x5b) == '\x01') {
                        uVar14 = *(uint *)(iVar16 + 0x44);
                        DAT_000cd708 = iVar3;
                        if (((uVar14 & 8) == 0) &&
                            (DAT_000cd708 = iVar6, iVar6 < iVar3)) {
                            DAT_000cd708 = iVar6 + 1;
                        }
                    } else {
                        uVar14 = *(uint *)(iVar16 + 0x44);
                        if (((*(char *)(iVar16 + 0x5b) == '\x02') &&
                             (DAT_000cd70c = iVar3, (uVar14 & 8) == 0)) &&
                            (DAT_000cd70c = iVar18, iVar18 < iVar3)) {
                            DAT_000cd70c = iVar18 + 1;
                        }
                    }
                    if ((uVar14 & 0x20) != 0) {
                        iVar17 = iVar16;
                    }
                    dVar26 = (double)*(byte *)(iVar16 + 0x5d) * dVar25 +
                             *pdVar5 * pdVar5[-2];
                    if (dVar26 < dVar27) {
                        iVar11 = iVar22;
                    }
                    iVar22 = iVar22 + 1;
                    if (dVar26 < dVar27) {
                        dVar27 = dVar26;
                    }
                    pdVar5 = pdVar5 + 4;
                    iVar18 = DAT_000cd70c;
                    iVar6 = DAT_000cd708;
                } while (iVar22 != iVar3);
                sys_survivors = iVar22 + sys_survivors;
                if (iVar22 < sys_minsane) {
                LAB_000455ac:
                    if (((iVar8 == 0) || (0.4 <= ABS(sys_offset))) ||
                        ((*(char *)(iVar8 + 0x58) == '\x16' && iVar17 == 0 &&
                          (sys_minsane != 0)))) {
                        if (iVar4 != 0) {
                            if (0 < sys_orphwait) {
                                orphwait = sys_orphwait + current_time;
                            }
                            FUN_00036294(8, 0);
                        }
                        sys_peer = 0;
                        for (piVar13 = peer_list; piVar13 != (int *)0x0;
                             piVar13 = (int *)*piVar13) {
                            *(undefined1 *)(piVar13 + 0x4a) =
                                *(undefined1 *)((int)piVar13 + 0x129);
                        }
                        goto LAB_00045568;
                    }
                LAB_000453a4:
                    *(undefined1 *)(iVar8 + 0x129) = 7;
                    sys_offset = *(double *)(iVar8 + 0x260);
                    _DAT_000cd710 = 0.0;
                    sys_jitter = *(double *)(iVar8 + 0x270);
                    iVar3 = iVar8;
                } else {
                    iVar3 = DAT_000cd700[iVar11 * 8];
                    if (iVar4 == 0 || iVar4 == iVar3) {
                        _DAT_000cd710 = 0.0;
                        iVar18 = iVar3;
                        if (iVar3 == 0)
                            goto LAB_000455ac;
                    LAB_00045320:
                        iVar3 = iVar18;
                        if (iVar17 == 0)
                            goto LAB_00045840;
                    LAB_00045328:
                        *(undefined1 *)(iVar17 + 0x129) = 6;
                        _DAT_000cd710 = 0.0;
                        sys_offset = *(double *)(iVar17 + 0x260);
                        sys_jitter = *(double *)(iVar17 + 0x270);
                        iVar3 = iVar17;
                    } else {
                        dVar25 = (double)CONCAT44(sys_mindisp._4_4_,
                                                  (undefined4)sys_mindisp);
                        dVar27 = ABS(*(double *)(iVar3 + 0x260) -
                                     *(double *)(iVar4 + 0x260));
                        if (dVar27 < dVar25) {
                            if (_DAT_000cd710 != 0.0) {
                                dVar25 = _DAT_000cd710 * 0.5;
                            }
                            iVar18 = iVar4;
                            _DAT_000cd710 = dVar25;
                            if (dVar25 <= ABS(dVar27)) {
                                _DAT_000cd710 = 0.0;
                                iVar18 = iVar3;
                            }
                            goto LAB_00045320;
                        }
                        _DAT_000cd710 = 0.0;
                        if (iVar17 != 0)
                            goto LAB_00045328;
                    LAB_00045840:
                        *(undefined1 *)(iVar3 + 0x129) = 6;
                        if (sys_survivors < 1) {
                            dVar26 = 0.0;
                            dVar25 = dVar26;
                            dVar27 = dVar26;
                        } else {
                            dVar26 = 0.0;
                            pdVar5 = (double *)(DAT_000cd700 + 2);
                            dVar25 = dVar26;
                            dVar27 = dVar26;
                            do {
                                pdVar10 = pdVar5 + 4;
                                dVar30 = 1.0 / *pdVar5;
                                dVar28 =
                                    *(double *)(*(int *)(pdVar5 + -1) + 0x260) -
                                    *(double *)(DAT_000cd700[iVar11 * 8] +
                                                0x260);
                                dVar27 = dVar27 + dVar30;
                                dVar26 = dVar26 + dVar30 * dVar28 * dVar28;
                                dVar25 =
                                    dVar25 +
                                    dVar30 * *(double *)(*(int *)(pdVar5 + -1) +
                                                         0x260);
                                pdVar5 = pdVar10;
                            } while (pdVar10 !=
                                     (double *)(DAT_000cd700 +
                                                sys_survivors * 8 + 2));
                        }
                        sys_jitter = SQRT(
                            dVar26 / dVar27 +
                            *(double *)(DAT_000cd700 + iVar11 * 8 + 6) *
                                *(double *)(DAT_000cd700 + iVar11 * 8 + 6));
                        sys_offset = dVar25 / dVar27;
                    }
                    if (((iVar8 != 0) && (ABS(sys_offset) < 0.4)) &&
                        (*(char *)(iVar8 + 0x58) != '\x16' || iVar17 != 0))
                        goto LAB_000453a4;
                }
                if (sys_epoch < *(uint *)(iVar3 + 0x130)) {
                    piVar13 = peer_list;
                    uVar14 = *(uint *)(iVar3 + 0x130);
                    if (iVar4 != iVar3) {
                        FUN_00036294(0x8a, iVar3, 0);
                        piVar13 = peer_list;
                        uVar14 = *(uint *)(iVar3 + 0x130);
                    }
                    for (; sys_epoch = uVar14, piVar13 != (int *)0x0;
                         piVar13 = (int *)*piVar13) {
                        *(undefined1 *)(piVar13 + 0x4a) =
                            *(undefined1 *)((int)piVar13 + 0x129);
                        uVar14 = sys_epoch;
                    }
                    if (sys_poll < *(byte *)(iVar3 + 0x41)) {
                        sys_poll = *(byte *)(iVar3 + 0x41);
                    }
                    if (*(byte *)(iVar3 + 0x42) < sys_poll) {
                        sys_poll = *(byte *)(iVar3 + 0x42);
                    }
                    sys_peer = iVar3;
                    FUN_000448c4(iVar3, sys_poll);
                    bVar1 = *(byte *)(iVar3 + 0x5d);
                    if (bVar1 < 0xf) {
                        sys_stratum = bVar1 + 1;
                    } else {
                        sys_stratum = '\x10';
                    }
                    if ((bVar1 & 0xef) == 0) {
                        sys_refid = *(undefined4 *)(iVar3 + 0x70);
                    } else {
                        sys_refid = FUN_00071720(iVar3 + 0x10);
                    }
                    dVar25 = (double)CONCAT44(sys_mindisp._4_4_,
                                              (undefined4)sys_mindisp);
                    dVar27 = *(double *)(iVar3 + 0x68) +
                             *(double *)(iVar3 + 0x278) + sys_jitter +
                             (double)(current_time - *(int *)(iVar3 + 0x2c0)) *
                                 clock_phi +
                             ABS(sys_offset);
                    if (dVar25 < dVar27) {
                        sys_rootdisp = dVar27;
                    }
                    if (dVar27 <= dVar25) {
                        sys_rootdisp = dVar25;
                    }
                    sys_rootdelay =
                        *(double *)(iVar3 + 0x268) + *(double *)(iVar3 + 0x60);
                    sys_reftime._0_4_ = *(undefined4 *)(iVar3 + 0x240);
                    sys_reftime._4_4_ = *(undefined4 *)(iVar3 + 0x244);
                    iVar4 = FUN_0003f960(iVar3);
                    if (iVar4 == 1) {
                        if (sys_leap == '\x03') {
                            FUN_00043adc(0);
                            if (crypto_flags != 0) {
                                FUN_00037dec();
                            }
                            if (waitsync_fd_to_close != -1) {
                                close(waitsync_fd_to_close);
                                waitsync_fd_to_close = -1;
                            }
                        }
                        if (leapsec == 0) {
                            if (DAT_000cd70c < DAT_000cd708) {
                                if (DAT_000cd708 <= sys_survivors / 2)
                                    goto LAB_00045568;
                                FUN_0007055c(local_5c);
                                FUN_0003e14c(1, local_5c[0], 0);
                            }
                            if ((DAT_000cd708 < DAT_000cd70c) &&
                                (sys_survivors / 2 < DAT_000cd70c)) {
                                FUN_0007055c(local_5c);
                                FUN_0003e14c(0, local_5c[0]);
                            }
                        }
                    } else if (iVar4 == 2) {
                        FUN_00042214();
                        FUN_00043adc(3);
                        sys_rootdelay = 0.0;
                        sys_rootdisp = 0.0;
                        sys_refid = 0x50455453;
                        sys_stratum = '\x10';
                        sys_reftime._4_4_ = 0;
                        sys_reftime._0_4_ = 0;
                        sys_jitter = ldexp(1.0, (int)sys_precision);
                        FUN_0003df74();
                    } else if (iVar4 == -1) {
                        /* WARNING: Subroutine does not return */
                        exit(-1);
                    }
                }
            LAB_00045568:
                if (local_54 != __stack_chk_guard) {
                    /* WARNING: Subroutine does not return */
                    __stack_chk_fail();
                }
                return;
            }
            iVar17 = 0;
            goto LAB_000455ac;
        }
        if ((dVar25 <= dVar27) ||
            ((*(uint *)(DAT_000cd700[iVar18 * 8] + 0x44) & 0x420) != 0))
            goto LAB_00045184;
        if (sys_maxclock < iVar3) {
            *(undefined1 *)(DAT_000cd700[iVar18 * 8] + 0x129) = 5;
        }
        if (iVar18 + 1 < iVar3) {
            puVar20 = puVar7 + iVar18 * 8 + 8;
            do {
                puVar21 = puVar20 + 8;
                puVar20[-8] = *puVar20;
                puVar20[-7] = puVar20[1];
                puVar20[-6] = puVar20[2];
                puVar20[-5] = puVar20[3];
                puVar20[-4] = puVar20[4];
                puVar20[-3] = puVar20[5];
                puVar20[-2] = puVar20[6];
                puVar20[-1] = puVar20[7];
                puVar20 = puVar21;
            } while (puVar21 != (undefined4 *)((int)puVar7 + iVar17));
        }
        iVar3 = iVar3 + -1;
        iVar17 = iVar17 + -0x20;
        if (iVar3 != 0)
            goto LAB_00044fd4;
    LAB_00045144:
        dVar25 = 0.0;
        dVar27 = 1000000000.0;
        iVar18 = iVar3;
    } while (true);
}

/* WARNING: Removing unreachable block (ram,0x00045f60) */
/* WARNING: Removing unreachable block (ram,0x00045e80) */
/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x00045eb0 */
/* WARNING: Restarted to delay deadcode elimination for space: register */

void FUN_00045af4(int param_1)

{
    double dVar1;
    undefined4 extraout_r0;
    undefined4 uVar2;
    int *piVar3;
    undefined4 extraout_r1;
    undefined4 uVar4;
    int iVar5;
    int *piVar6;
    uint uVar7;
    uint uVar8;
    double *pdVar9;
    undefined1 *puVar10;
    int iVar11;
    double *pdVar12;
    double *pdVar13;
    int iVar14;
    double *pdVar15;
    int iVar16;
    bool bVar17;
    uint uVar18;
    double in_d0;
    double dVar19;
    undefined8 in_d1;
    undefined8 in_d2;
    uint extraout_s15;
    double dVar20;
    double dVar21;
    int local_f8[7];
    undefined4 local_dc;
    double local_d8[7];
    undefined8 local_a0;
    undefined8 uStack_98;
    int local_44;

    iVar5 = *(int *)(param_1 + 0x140);
    iVar16 = param_1 + iVar5 * 8;
    *(double *)(iVar16 + 0x188) = in_d0;
    local_44 = __stack_chk_guard;
    iVar11 = (iVar5 + 1) % 8;
    *(undefined8 *)(iVar16 + 0x148) = in_d1;
    pdVar13 = local_d8;
    pdVar15 = (double *)&local_a0;
    *(undefined8 *)(iVar16 + 0x1c8) = in_d2;
    iVar16 = current_time;
    iVar14 = 7;
    uVar7 = current_time - *(int *)(param_1 + 0x2c0);
    *(int *)(param_1 + (iVar5 + 0x82) * 4) = current_time;
    *(int *)(param_1 + 0x140) = iVar11;
    *(int *)(param_1 + 0x2c0) = iVar16;
    dVar20 = (double)uVar7 * clock_phi;
    pdVar12 = pdVar13;
    do {
        iVar16 = param_1 + iVar11 * 8;
        dVar21 = *(double *)(iVar16 + 0x1c8);
        if (iVar14 != 0) {
            dVar21 = dVar20 + dVar21;
        }
        if (iVar14 != 0) {
            *(double *)(iVar16 + 0x1c8) = dVar21;
        }
        if (16.0 <= dVar21) {
            *pdVar15 = 16.0;
            *(undefined8 *)(param_1 + iVar11 * 8 + 0x1c8) = 0x4030000000000000;
        } else {
            uVar8 = *(int *)(param_1 + 0x2c0) -
                    *(int *)(param_1 + (iVar11 + 0x82) * 4);
            dVar19 = ldexp(1.0, (uint)allan_xpt);
            uVar18 = (uint)(0.0 < dVar19) * (int)(longlong)dVar19;
            in_d0 = (double)CONCAT44((int)((ulonglong)dVar19 >> 0x20), uVar18);
            iVar16 = param_1 + iVar11 * 8;
            if (uVar18 < uVar8) {
                dVar21 = *(double *)(iVar16 + 0x148);
                uVar2 = extraout_r0;
                uVar4 = extraout_r1;
            } else {
                uVar2 = *(undefined4 *)(iVar16 + 0x148);
                uVar4 = *(undefined4 *)(iVar16 + 0x14c);
            }
            uVar7 = extraout_s15;
            if (uVar18 < uVar8) {
                *pdVar15 = dVar21 + *(double *)(iVar16 + 0x1c8);
            } else {
                *(undefined4 *)pdVar15 = uVar2;
                *(undefined4 *)((int)pdVar15 + 4) = uVar4;
            }
        }
        dVar21 = sys_maxdist;
        pdVar12 = (double *)((int)pdVar12 + -4);
        *(int *)pdVar12 = iVar11;
        iVar14 = iVar14 + -1;
        pdVar15 = pdVar15 + -1;
        iVar11 = (iVar11 + 1) % 8;
    } while (iVar14 != -1);
    if (freq_cnt == 0) {
        pdVar15 = local_d8 + 1;
        piVar6 = local_f8;
        pdVar12 = pdVar13;
        piVar3 = local_f8;
        do {
            do {
                dVar20 = *pdVar12;
                pdVar9 = pdVar12 + 1;
                if (*pdVar15 < dVar20) {
                    *pdVar12 = *pdVar15;
                    iVar16 = *piVar6;
                    iVar5 = piVar3[1];
                    *pdVar15 = dVar20;
                    *piVar6 = iVar5;
                    piVar3[1] = iVar16;
                }
                piVar6 = piVar6 + 1;
                pdVar12 = pdVar9;
            } while (pdVar15 != pdVar9);
            pdVar15 = pdVar15 + 1;
            piVar3 = piVar3 + 1;
            piVar6 = local_f8;
            pdVar12 = pdVar13;
        } while (pdVar15 != (double *)&uStack_98);
    }
    puVar10 = (undefined1 *)(param_1 + 0x227);
    uVar8 = 0;
    piVar6 = local_f8;
    pdVar12 = pdVar13;
    do {
        dVar20 = *pdVar12;
        pdVar12 = pdVar12 + 1;
        puVar10 = puVar10 + 1;
        *puVar10 = (char)*piVar6;
        if ((dVar20 < 16.0) && (((int)uVar8 < 2 || (dVar20 < dVar21)))) {
            uVar8 = uVar8 + 1;
        }
        piVar6 = piVar6 + 1;
    } while (puVar10 != (undefined1 *)(param_1 + 0x22f));
    dVar20 = 0.0;
    iVar16 = 7;
    *(undefined8 *)(param_1 + 0x270) = 0;
    *(undefined8 *)(param_1 + 0x278) = 0;
    do {
        pdVar13 = (double *)((int)pdVar13 + -4);
        iVar5 = param_1 + *(int *)pdVar13 * 8;
        dVar20 = (dVar20 + *(double *)(iVar5 + 0x1c8)) * 0.5;
        if (iVar16 < (int)uVar8) {
            dVar21 = *(double *)(iVar5 + 0x188) -
                     *(double *)(param_1 + (local_f8[0] + 0x31) * 8);
            *(double *)(param_1 + 0x270) =
                *(double *)(param_1 + 0x270) + dVar21 * dVar21;
        }
        bVar17 = iVar16 != 0;
        iVar16 = iVar16 + -1;
    } while (bVar17);
    *(double *)(param_1 + 0x278) = dVar20;
    if (uVar8 != 0) {
        bVar17 = uVar8 == 1;
        iVar16 = param_1 + local_f8[0] * 8;
        if (!bVar17) {
            uVar8 = uVar8 - 1;
        }
        dVar21 = *(double *)(param_1 + 0x260);
        if (!bVar17) {
            uVar7 = uVar8;
        }
        if (!bVar17) {
            in_d0 = *(double *)(param_1 + 0x270);
            dVar20 = (double)(longlong)(int)uVar7;
        }
        if (bVar17) {
            in_d0 = *(double *)(param_1 + 0x270);
        }
        dVar19 = *(double *)(iVar16 + 0x188);
        if (!bVar17) {
            in_d0 = in_d0 / dVar20;
        }
        *(double *)(param_1 + 0x260) = dVar19;
        uVar2 = *(undefined4 *)(iVar16 + 0x14c);
        *(undefined4 *)(param_1 + 0x268) = *(undefined4 *)(iVar16 + 0x148);
        *(undefined4 *)(param_1 + 0x26c) = uVar2;
        if (!bVar17) {
            *(double *)(param_1 + 0x270) = in_d0;
        }
        dVar20 = ldexp(1.0, (int)sys_precision);
        if (dVar20 < SQRT(in_d0)) {
            dVar20 = SQRT(*(double *)(param_1 + 0x270));
        } else {
            dVar20 = ldexp(1.0, (int)sys_precision);
        }
        dVar1 = sys_maxdist;
        *(double *)(param_1 + 0x270) = dVar20;
        if ((((*(double *)(param_1 + 0x278) < dVar1) &&
              (*(double *)(iVar16 + 0x1c8) < dVar1)) &&
             (dVar20 * 3.0 < ABS(dVar21 - dVar19))) &&
            (iVar16 = *(int *)(param_1 + 0x130),
             iVar5 = *(int *)(param_1 + (local_f8[0] + 0x82) * 4),
             dVar20 = ldexp(1.0, (uint) * (byte *)(param_1 + 0x40)),
             (double)(uint)(iVar5 - iVar16) < dVar20 + dVar20)) {
            FUN_0007d00c((int)&uStack_98 + 4, 0x50, "%.6f s");
            FUN_00036294(0x8d, param_1, (int)&uStack_98 + 4);
            goto LAB_00045e4c;
        }
        uVar7 = *(uint *)(param_1 + (local_f8[0] + 0x82) * 4);
        if (uVar7 <= *(uint *)(param_1 + 0x130))
            goto LAB_00045e4c;
        *(uint *)(param_1 + 0x130) = uVar7;
        uVar2 = FUN_000337f8(param_1);
        FUN_00052a9c(
            (int)*(undefined8 *)(param_1 + 0x260),
            (int)((ulonglong) * (undefined8 *)(param_1 + 0x260) >> 0x20),
            (int)*(undefined8 *)(param_1 + 0x268),
            (int)((ulonglong) * (undefined8 *)(param_1 + 0x268) >> 0x20),
            (int)*(undefined8 *)(param_1 + 0x278),
            (int)((ulonglong) * (undefined8 *)(param_1 + 0x278) >> 0x20),
            (int)*(undefined8 *)(param_1 + 0x270), param_1 + 0x10, uVar2);
        if ((*(int *)(param_1 + 0x134) != 0) && (sys_leap != '\x03'))
            goto LAB_00045e4c;
    }
    FUN_00044a5c();
LAB_00045e4c:
    if (local_44 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x00046150 */
/* WARNING: Restarted to delay deadcode elimination for space: register */

void FUN_00045fa0(int param_1, byte *param_2)

{
    byte bVar1;
    byte bVar2;
    uint uVar3;
    int iVar4;
    uint extraout_r1;
    int iVar5;
    char *pcVar6;
    uint uVar7;
    undefined4 uVar8;
    uint uVar9;
    uint uVar10;
    uint uVar11;
    undefined8 in_d0;
    double dVar12;
    double dVar13;
    undefined4 in_s3;
    double dVar14;
    double dVar15;
    uint local_15c;
    uint local_158;
    uint local_154;
    uint local_150;
    uint local_14c;
    uint local_148;
    undefined1 auStack_144[256];
    int local_44;

    uVar3 = *(uint *)(param_2 + 4);
    uVar7 = *(uint *)(param_2 + 8);
    uVar9 = (uint)param_2[1];
    uVar10 = *(uint *)(param_2 + 0x18);
    bVar1 = *param_2;
    local_14c = uVar10 << 0x18 | (uVar10 >> 8 & 0xff) << 0x10 |
                (uVar10 >> 0x10 & 0xff) << 8 | uVar10 >> 0x18;
    local_44 = __stack_chk_guard;
    if (uVar9 == 0) {
        uVar9 = 0x10;
    }
    uVar10 = *(uint *)(param_2 + 0x1c);
    bVar2 = bVar1 >> 6;
    local_148 = uVar10 << 0x18 | (uVar10 >> 8 & 0xff) << 0x10 |
                (uVar10 >> 0x10 & 0xff) << 8 | uVar10 >> 0x18;
    uVar10 = *(uint *)(param_2 + 0x20);
    uVar11 = *(uint *)(param_2 + 0x24);
    local_15c = uVar10 << 0x18 | (uVar10 >> 8 & 0xff) << 0x10 |
                (uVar10 >> 0x10 & 0xff) << 8 | uVar10 >> 0x18;
    uVar10 = *(uint *)(param_2 + 0x28);
    local_158 = uVar11 << 0x18 | (uVar11 >> 8 & 0xff) << 0x10 |
                (uVar11 >> 0x10 & 0xff) << 8 | uVar11 >> 0x18;
    local_154 = uVar10 << 0x18 | (uVar10 >> 8 & 0xff) << 0x10 |
                (uVar10 >> 0x10 & 0xff) << 8 | uVar10 >> 0x18;
    uVar10 = *(uint *)(param_2 + 0x2c);
    local_150 = uVar10 << 0x18 | (uVar10 >> 8 & 0xff) << 0x10 |
                (uVar10 >> 0x10 & 0xff) << 8 | uVar10 >> 0x18;
    uVar10 = *(uint *)(param_2 + 0x10);
    dVar15 = (double)(uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                      (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18) *
             1.52587890625e-05;
    uVar3 = *(uint *)(param_2 + 0x14);
    dVar14 = (double)(uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 |
                      (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18) *
             1.52587890625e-05;
    if (((bVar2 == 3) || ((int)uVar9 < sys_floor)) ||
        (sys_ceiling <= (int)uVar9)) {
        uVar7 = *(uint *)(param_1 + 300) | 0x20;
        *(uint *)(param_1 + 300) = uVar7;
    } else {
        uVar7 = *(uint *)(param_1 + 300);
    }
    if (16.0 <= dVar14 + dVar15 * 0.5) {
        uVar7 = uVar7 | 0x40;
        *(uint *)(param_1 + 300) = uVar7;
    }
    if ((uVar7 & 0x1ff) != 0) {
        *(int *)(param_1 + 0x300) = *(int *)(param_1 + 0x300) + 1;
        FUN_000448c4(param_1, *(undefined1 *)(param_1 + 0x40));
        goto LAB_00046324;
    }
    iVar4 = *(int *)(param_1 + 0x38);
    if (iVar4 != 0) {
        iVar4 = iVar4 + 0x18;
    }
    *(int *)(param_1 + 0x2ec) = *(int *)(param_1 + 0x2ec) + 1;
    sys_processed = sys_processed + 1;
    FUN_00052ebc(SUB84(dVar15, 0), (int)((ulonglong)in_d0 >> 0x20),
                 SUB84(dVar14, 0), param_1 + 0x10, iVar4, &local_14c,
                 &local_15c);
    *(byte *)(param_1 + 0x5c) = bVar1 & 7;
    *(byte *)(param_1 + 0x5b) = bVar2;
    if (0xf < uVar9) {
        uVar9 = 0x10;
    }
    *(char *)(param_1 + 0x5d) = (char)uVar9;
    bVar1 = param_2[3];
    *(double *)(param_1 + 0x60) = dVar15;
    *(byte *)(param_1 + 0x5f) = bVar1;
    uVar8 = *(undefined4 *)(param_2 + 0xc);
    uVar7 = extraout_r1;
    if (*(int *)(param_1 + 0x138) < 1) {
        uVar7 = (uint) * (byte *)(param_1 + 0x40);
    }
    *(double *)(param_1 + 0x68) = dVar14;
    *(uint *)(param_1 + 0x74) = uVar10 << 0x18 | (uVar10 >> 8 & 0xff) << 0x10 |
                                (uVar10 >> 0x10 & 0xff) << 8 | uVar10 >> 0x18;
    *(undefined4 *)(param_1 + 0x70) = uVar8;
    *(uint *)(param_1 + 0x78) = uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                                (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18;
    if (0 < *(int *)(param_1 + 0x138)) {
        uVar7 = (uint) * (byte *)(param_1 + 0x40);
        *(undefined4 *)(param_1 + 0x138) = 0;
        if (*(char *)(param_1 + 0x12a) == '\0') {
            *(undefined4 *)(param_1 + 0x134) = 5;
        } else {
            iVar4 = 1 << (uVar7 - *(byte *)(param_1 + 0x41) & 0xff);
            if (7 < iVar4) {
                iVar4 = 8;
            }
            *(int *)(param_1 + 0x134) = iVar4 + -1;
            if (iVar4 + -1 < 1)
                goto LAB_000461cc;
        }
        *(int *)(param_1 + 0x2d0) = current_time;
    }
LAB_000461cc:
    FUN_000448c4(param_1, uVar7);
    bVar1 = *(byte *)(param_1 + 0x12a);
    if (bVar1 == 0) {
        FUN_00036294(0x84, param_1);
        bVar1 = *(byte *)(param_1 + 0x12a);
        *(int *)(param_1 + 0x2e0) = current_time;
    }
    *(byte *)(param_1 + 0x12a) = bVar1 | 1;
    if (*(int *)(param_1 + 0x13c) == 0) {
        if (*(char *)(param_1 + 0x5c) == '\x05') {
            if ((*(uint *)(param_1 + 0x44) & 0x2000) != 0) {
                uVar7 = local_148 - *(int *)(param_1 + 0x24c);
                uVar3 = local_14c - *(int *)(param_1 + 0x248);
                if (local_148 < uVar7) {
                    uVar3 = uVar3 - 1;
                }
                uVar9 = -((int)uVar3 >> 0x1f);
                uVar7 = (int)uVar3 >> 0x1f ^ uVar7;
                dVar14 = (double)FUN_0009d40c(uVar9 + uVar7,
                                              (-(uint)(uVar9 != 0) ^ uVar3) +
                                                  (uint)CARRY4(uVar9, uVar7));
                dVar14 = ldexp(dVar14, -0x20);
                uVar3 = local_148 - *(int *)(param_1 + 0x254);
                uVar7 = local_14c - *(int *)(param_1 + 0x250);
                if (uVar9 != 0) {
                    dVar14 = -dVar14;
                }
                if (local_148 < uVar3) {
                    uVar7 = uVar7 - 1;
                }
                uVar9 = -((int)uVar7 >> 0x1f);
                uVar3 = (int)uVar7 >> 0x1f ^ uVar3;
                dVar15 = (double)FUN_0009d40c(uVar9 + uVar3,
                                              (-(uint)(uVar9 != 0) ^ uVar7) +
                                                  (uint)CARRY4(uVar9, uVar3));
                dVar15 = ldexp(dVar15, -0x20);
                *(uint *)(param_1 + 0x248) = local_154;
                *(uint *)(param_1 + 0x24c) = local_150;
                *(undefined4 *)(param_1 + 0x250) =
                    *(undefined4 *)(param_1 + 0x240);
                *(undefined4 *)(param_1 + 0x254) =
                    *(undefined4 *)(param_1 + 0x244);
                if (uVar9 != 0) {
                    dVar15 = -dVar15;
                }
                if ((0.0 <= dVar14) && (dVar14 <= 1.0)) {
                    *(double *)(param_1 + 0x280) = dVar14;
                    goto LAB_00046748;
                }
                if ((*(uint *)(param_1 + 0x44) & 0x10) == 0) {
                    pcVar6 = "offset %.6f delay %.6f";
                    goto LAB_00046300;
                }
            LAB_0004678c:
                FUN_000424cc(param_1);
                goto LAB_00046324;
            }
            uVar7 = local_150 - *(int *)(param_1 + 0x244);
            uVar3 = local_154 - *(int *)(param_1 + 0x240);
            if (local_150 < uVar7) {
                uVar3 = uVar3 - 1;
            }
            uVar9 = -((int)uVar3 >> 0x1f);
            uVar7 = (int)uVar3 >> 0x1f ^ uVar7;
            dVar14 = (double)FUN_0009d40c(uVar9 + uVar7,
                                          (-(uint)(uVar9 != 0) ^ uVar3) +
                                              (uint)CARRY4(uVar9, uVar7));
            dVar15 = ldexp(dVar14, -0x20);
            if (uVar9 != 0) {
                dVar15 = -dVar15;
            }
        LAB_00046748:
            if ((*(uint *)(param_1 + 0x44) & 0x10) == 0) {
                dVar14 = *(double *)(param_1 + 0x268);
            } else {
                *(uint *)(param_1 + 0x44) =
                    *(uint *)(param_1 + 0x44) & 0xffffffef;
                dVar14 = ABS(*(double *)(param_1 + 0x260) - dVar15);
                dVar14 = dVar14 + dVar14;
                *(double *)(param_1 + 0x268) = dVar14;
                if (ABS(sys_bdelay) < dVar14)
                    goto LAB_0004678c;
            }
            *(int *)(param_1 + 0x2d0) =
                current_time + -2 + (1 << (uint) * (byte *)(param_1 + 0x5e));
            dVar15 = dVar15 + dVar14 * 0.5;
        } else {
            uVar3 = local_150 - *(int *)(param_1 + 0x244);
            uVar7 = local_154 - *(int *)(param_1 + 0x240);
            if (local_150 < uVar3) {
                uVar7 = uVar7 - 1;
            }
            uVar9 = -((int)uVar7 >> 0x1f);
            uVar3 = (int)uVar7 >> 0x1f ^ uVar3;
            dVar14 = (double)FUN_0009d40c(uVar3 + uVar9,
                                          (-(uint)(uVar9 != 0) ^ uVar7) +
                                              (uint)CARRY4(uVar3, uVar9));
            dVar14 = ldexp(dVar14, -0x20);
            uVar3 = local_15c - local_14c;
            if (uVar9 != 0) {
                dVar14 = -dVar14;
            }
            if (local_158 < local_158 - local_148) {
                uVar3 = uVar3 - 1;
            }
            uVar7 = -((int)uVar3 >> 0x1f);
            uVar9 = (int)uVar3 >> 0x1f ^ local_158 - local_148;
            dVar15 = (double)FUN_0009d40c(uVar9 + uVar7,
                                          (-(uint)(uVar7 != 0) ^ uVar3) +
                                              (uint)CARRY4(uVar9, uVar7));
            dVar12 = ldexp(dVar15, -0x20);
            if (uVar7 != 0) {
                dVar12 = -dVar12;
            }
            dVar15 = (dVar14 + dVar12) * 0.5;
            dVar14 = ABS(dVar12 - dVar14);
        }
    } else {
        uVar3 = local_150 - *(int *)(param_1 + 0x244);
        uVar7 = local_154 - *(int *)(param_1 + 0x240);
        if (local_150 < uVar3) {
            uVar7 = uVar7 - 1;
        }
        uVar9 = -((int)uVar7 >> 0x1f);
        uVar3 = (int)uVar7 >> 0x1f ^ uVar3;
        dVar14 =
            (double)FUN_0009d40c(uVar3 + uVar9, (-(uint)(uVar9 != 0) ^ uVar7) +
                                                    (uint)CARRY4(uVar3, uVar9));
        dVar15 = ldexp(dVar14, -0x20);
        if (uVar9 != 0) {
            dVar15 = -dVar15;
        }
        if (*(int *)(param_1 + 0x13c) < 1) {
            iVar4 = *(int *)(param_1 + 0x24c);
            iVar5 = *(int *)(param_1 + 0x248);
        } else {
            iVar4 = *(int *)(param_1 + 0x254);
            iVar5 = *(int *)(param_1 + 0x250);
        }
        uVar3 = local_15c - iVar5;
        if (local_158 < local_158 - iVar4) {
            uVar3 = uVar3 - 1;
        }
        uVar7 = -((int)uVar3 >> 0x1f);
        uVar9 = (int)uVar3 >> 0x1f ^ local_158 - iVar4;
        dVar14 =
            (double)FUN_0009d40c(uVar9 + uVar7, (-(uint)(uVar7 != 0) ^ uVar3) +
                                                    (uint)CARRY4(uVar9, uVar7));
        dVar12 = ldexp(dVar14, -0x20);
        if (uVar7 != 0) {
            dVar12 = -dVar12;
        }
        dVar14 = dVar12 - dVar15;
        if ((dVar14 < 0.0) || (1.0 < dVar14)) {
            pcVar6 = "t21 %.6f t34 %.6f";
        LAB_00046300:
            FUN_0007d00c(auStack_144, 0x100, pcVar6);
            FUN_00036294(0x8f, param_1, auStack_144);
            goto LAB_00046324;
        }
        dVar15 = (dVar15 + dVar12) * 0.5;
    }
    dVar12 = ldexp(1.0, (int)sys_precision);
    if (dVar14 <= dVar12) {
        dVar14 = ldexp(1.0, (int)sys_precision);
    }
    dVar12 = ldexp(1.0, (int)sys_precision);
    dVar13 = ldexp(1.0, (int)*(char *)(param_1 + 0x5f));
    dVar15 = dVar15 + *(double *)(param_1 + 0x288);
    FUN_00045af4(SUB84(dVar15, 0), (int)((ulonglong)dVar15 >> 0x20),
                 SUB84(dVar14, 0), in_s3,
                 SUB84(dVar12 + dVar13 + dVar14 * clock_phi, 0), param_1);
    if (((((*(uint *)(param_1 + 0x44) & 0x10) != 0) &&
          (*(char *)(param_1 + 0x3f) == '\x03')) &&
         (uVar3 = FUN_00043534(param_1), (uVar3 & 0x400) == 0)) &&
        (((*(uint *)(param_1 + 0x44) & 0x800) == 0 ||
          ((~*(uint *)(param_1 + 0x88) & 0x7f00) == 0)))) {
        *(undefined1 *)(param_1 + 0x3f) = 6;
    }
LAB_00046324:
    if (local_44 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000467d8(int param_1, undefined4 *param_2)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    undefined4 extraout_r0;
    uint uVar5;
    undefined4 uVar6;
    undefined4 extraout_r1;
    undefined4 uVar7;
    undefined4 *puVar8;
    int extraout_r1_00;
    undefined1 *puVar9;
    int iVar10;
    bool bVar11;
    double dVar12;

    iVar1 = __stack_chk_guard;
    uVar3 = *(undefined4 *)(param_1 + 600);
    uVar6 = *(undefined4 *)(param_1 + 0x25c);
    FUN_00043ebc(param_1);
    if (*(BIGNUM **)(param_1 + 0xb0) != (BIGNUM *)0x0) {
        BN_free(*(BIGNUM **)(param_1 + 0xb0));
    }
    FUN_00037f0c(param_1 + 0xb8);
    FUN_00037f0c(param_1 + 0xd0);
    FUN_00037f0c(param_1 + 0xf8);
    FUN_00037f0c(param_1 + 0x110);
    if (*(void **)(param_1 + 0xe8) != (void *)0x0) {
        free(*(void **)(param_1 + 0xe8));
    }
    if (*(void **)(param_1 + 0x94) != (void *)0x0) {
        free(*(void **)(param_1 + 0x94));
    }
    if (*(void **)(param_1 + 0x98) != (void *)0x0) {
        free(*(void **)(param_1 + 0x98));
    }
    memset((void *)(param_1 + 0x80), 0, 0x240);
    *(undefined1 *)(param_1 + 0x40) = *(undefined1 *)(param_1 + 0x41);
    *(undefined4 *)(param_1 + 0x278) = 0;
    *(undefined4 *)(param_1 + 0x27c) = 0x40300000;
    *(undefined1 *)(param_1 + 0x5e) = *(undefined1 *)(param_1 + 0x42);
    uVar4 = FUN_00043534(param_1);
    *(undefined4 *)(param_1 + 300) = uVar4;
    dVar12 = ldexp(1.0, (int)sys_precision);
    bVar11 = *(char *)(param_1 + 0x3f) == '\x06';
    puVar9 = (undefined1 *)(param_1 + 0x227);
    uVar4 = extraout_r0;
    uVar7 = extraout_r1;
    if (bVar11) {
        uVar4 = uVar3;
        uVar7 = uVar6;
    }
    *(double *)(param_1 + 0x270) = dVar12;
    if (bVar11) {
        *(undefined4 *)(param_1 + 600) = uVar4;
        *(undefined4 *)(param_1 + 0x25c) = uVar7;
    }
    uVar5 = *(uint *)(param_1 + 0x44);
    if ((uVar5 & 0x1000) != 0) {
        *(undefined4 *)(param_1 + 0x13c) = 1;
    }
    iVar10 = 0;
    puVar8 = (undefined4 *)(param_1 + 0x1c8);
    do {
        puVar9 = puVar9 + 1;
        *puVar9 = (char)iVar10;
        iVar10 = iVar10 + 1;
        *puVar8 = 0;
        puVar8[1] = 0x40300000;
        puVar8 = puVar8 + 2;
    } while (iVar10 != 8);
    if ((uVar5 & 8) == 0) {
        *(undefined1 *)(param_1 + 0x5d) = 0x10;
        *(undefined1 *)(param_1 + 0x5b) = 3;
        *(undefined4 *)(param_1 + 0x70) = *param_2;
    } else {
        iVar10 = *(int *)(param_1 + 0x54);
        *(undefined4 *)(iVar10 + 0xdc) = 0;
        *(undefined4 *)(iVar10 + 0xd8) = 0;
    }
    iVar10 = current_time;
    *(int *)(param_1 + 0x2cc) = current_time;
    *(int *)(param_1 + 0x2c0) = iVar10;
    *(int *)(param_1 + 0x2d0) = iVar10;
    if (initializing == 0) {
        if (*(char *)(param_1 + 0x3f) == '\x02') {
            *(int *)(param_1 + 0x2d0) = ntp_minpkt + iVar10;
        } else {
            uVar3 = FUN_00079a2c();
            FUN_0009d0ec(uVar3, *(undefined1 *)(param_1 + 0x41));
            iVar10 = current_time;
            *(int *)(param_1 + 0x2d0) =
                *(int *)(param_1 + 0x2d0) + extraout_r1_00;
        }
    } else {
        *(int *)(param_1 + 0x2d0) = peer_associations + iVar10;
    }
    iVar2 = __stack_chk_guard;
    *(int *)(param_1 + 0xec) = iVar10 + 0x80000;
    if (iVar1 != iVar2) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00046a10(int param_1)

{
    char cVar1;
    byte bVar2;
    char cVar3;
    char cVar4;
    undefined4 uVar5;
    int iVar6;
    uint uVar7;
    int iVar8;
    undefined4 unaff_r6;
    char cVar9;
    undefined4 uVar10;
    ushort local_890[2];
    uint local_88c;
    uint local_888;
    undefined4 local_884;
    undefined4 local_880;
    undefined4 local_87c;
    undefined4 uStack_878;
    undefined4 uStack_874;
    undefined4 local_870;
    byte local_86c;
    char local_86b;
    undefined1 local_86a;
    undefined1 local_869;
    uint local_868;
    uint local_864;
    undefined4 local_860;
    uint local_85c;
    uint local_858;
    uint local_844;
    uint local_840;
    int local_24;

    cVar9 = *(char *)(param_1 + 0x40);
    local_24 = __stack_chk_guard;
    if ((*(uint *)(param_1 + 0x2d8) < *(uint *)(param_1 + 0x2cc)) &&
        (*(char *)(param_1 + 0x12a) == '\0')) {
        *(undefined1 *)(param_1 + 0x5e) = *(undefined1 *)(param_1 + 0x42);
    }
    bVar2 = *(byte *)(param_1 + 0x48);
    if ((bVar2 & 6) == 0) {
        if ((bVar2 & 0x10) == 0) {
            if ((bVar2 & 8) == 0) {
                if (*(int *)(param_1 + 0x134) == 0) {
                    cVar3 = *(char *)(param_1 + 0x12a);
                    cVar1 = cVar3 << 1;
                    iVar8 = *(int *)(param_1 + 0x2c4) + 1;
                    *(int *)(param_1 + 0x2c4) = iVar8;
                    iVar6 = current_time;
                    *(char *)(param_1 + 0x12a) = cVar1;
                    *(int *)(param_1 + 0x2cc) = iVar6;
                    cVar4 = sys_poll;
                    if (cVar1 != '\0') {
                        uVar7 = *(uint *)(param_1 + 0x44);
                        cVar9 = cVar4;
                        if ((uVar7 & 2) == 0) {
                            *(undefined4 *)(param_1 + 0x2c4) = 0;
                            if ((uVar7 & 0x40) == 0)
                                goto LAB_00046da0;
                        LAB_00046ad8:
                            if (*(int *)(param_1 + 0x138) == 0) {
                                iVar6 = FUN_00043534(param_1);
                                goto joined_r0x00046e0c;
                            }
                            goto LAB_00046ae4;
                        }
                        if ((uVar7 & 0x40) != 0)
                            goto LAB_00046ad8;
                    LAB_00046ae8:
                        if (9 < iVar8) {
                        LAB_00046af0:
                            cVar9 = cVar9 + '\x01';
                            if (((*(uint *)(param_1 + 0x44) & 3) == 0) ||
                                ((((*(uint *)(param_1 + 0x44) & 2) != 0 &&
                                   (sys_maxclock < peer_associations)) &&
                                  (iVar6 = FUN_000422b0(param_1),
                                   iVar6 != 0)))) {
                                FUN_00036294(0x85, param_1, "timeout");
                                FUN_000467d8(param_1, "TIME");
                                if (local_24 == __stack_chk_guard) {
                                    FUN_000424cc(param_1);
                                    return;
                                }
                                goto LAB_00046e5c;
                            }
                        }
                        goto LAB_00046da0;
                    }
                    FUN_00045af4(0, param_1);
                    if (cVar3 != '\0') {
                        FUN_00043534(param_1);
                        FUN_00036294(0x83, param_1, 0);
                    }
                    if ((*(uint *)(param_1 + 0x44) & 0x100) == 0) {
                    LAB_00046ae4:
                        iVar8 = *(int *)(param_1 + 0x2c4);
                        goto LAB_00046ae8;
                    }
                    iVar6 = *(int *)(param_1 + 0x138);
                joined_r0x00046e0c:
                    if (iVar6 != 0)
                        goto LAB_00046ae4;
                    *(undefined4 *)(param_1 + 0x138) = 3;
                    if (9 < *(int *)(param_1 + 0x2c4))
                        goto LAB_00046af0;
                    iVar6 = *(int *)(param_1 + 0x138);
                LAB_00046dac:
                    *(int *)(param_1 + 0x138) = iVar6 + -1;
                } else {
                    iVar6 = *(int *)(param_1 + 0x134) + -1;
                    *(int *)(param_1 + 0x134) = iVar6;
                    if (((iVar6 == 0) && (mode_ntpdate != 0)) &&
                        (peer_ntpdate = peer_ntpdate + -1, peer_ntpdate == 0)) {
                        FUN_00075d40(5, "ntpd: no servers found");
                        if (msyslog_term == 0) {
                            puts("ntpd: no servers found");
                        }
                        /* WARNING: Subroutine does not return */
                        exit(0);
                    }
                LAB_00046da0:
                    iVar6 = *(int *)(param_1 + 0x138);
                    if (0 < iVar6)
                        goto LAB_00046dac;
                }
                FUN_000448c4(param_1, cVar9);
                if (*(char *)(param_1 + 0x3f) != '\x06')
                    goto LAB_00046bb0;
            } else {
                *(int *)(param_1 + 0x2cc) = current_time;
                FUN_000448c4(param_1, cVar9);
                if ((peer_associations == sys_maxclock * 2 ||
                     peer_associations + sys_maxclock * -2 < 0 !=
                         SBORROW4(peer_associations, sys_maxclock * 2)) &&
                    ((peer_associations < sys_maxclock ||
                      (sys_survivors < sys_minclock)))) {
                    if (local_24 == __stack_chk_guard) {
                        iVar6 = *(int *)(param_1 + 0x34);
                        if (iVar6 != 0) {
                            unaff_r6 = 0;
                        }
                        local_24 = __stack_chk_guard;
                        if (iVar6 != 0) {
                            do {
                                uVar10 = *(undefined4 *)(iVar6 + 0x14);
                                *(undefined4 *)(param_1 + 0x34) =
                                    *(undefined4 *)(iVar6 + 0x1c);
                                iVar6 = FUN_00041f34(uVar10, 0, 0, 3, unaff_r6,
                                                     unaff_r6);
                                if (iVar6 == 0) {
                                    FUN_00050e20(uVar10, local_890);
                                    if ((local_890[0] & 0x7f) != 0) {
                                        FUN_00051594(uVar10, 0,
                                                     current_time + 9);
                                    }
                                    uVar5 = FUN_00027b78(uVar10);
                                    memset(&local_86c, 0, 0x848);
                                    local_86c = sys_leap << 6 | 3U |
                                                (*(byte *)(param_1 + 0x3e) & 7)
                                                    << 3;
                                    local_86a = *(undefined1 *)(param_1 + 0x40);
                                    local_86b = sys_stratum;
                                    if (sys_stratum == '\x10') {
                                        local_86b = '\0';
                                    }
                                    local_869 = sys_precision;
                                    local_860 = sys_refid;
                                    uVar7 = (uint)(longlong)(sys_rootdelay *
                                                             65536.0);
                                    local_868 = uVar7 << 0x18 |
                                                (uVar7 >> 8 & 0xff) << 0x10 |
                                                (uVar7 >> 0x10 & 0xff) << 8 |
                                                uVar7 >> 0x18;
                                    uVar7 =
                                        (uint)(0.0 < sys_rootdisp * 65536.0) *
                                        (int)(longlong)(sys_rootdisp * 65536.0);
                                    local_864 = uVar7 * 0x1000000 |
                                                (uVar7 >> 8 & 0xff) << 0x10 |
                                                (uVar7 >> 0x10 & 0xff) << 8 |
                                                uVar7 >> 0x18;
                                    local_85c =
                                        (uint)sys_reftime << 0x18 |
                                        ((uint)sys_reftime >> 8 & 0xff)
                                            << 0x10 |
                                        ((uint)sys_reftime >> 0x10 & 0xff)
                                            << 8 |
                                        (uint)sys_reftime >> 0x18;
                                    local_858 =
                                        sys_reftime._4_4_ << 0x18 |
                                        (sys_reftime._4_4_ >> 8 & 0xff)
                                            << 0x10 |
                                        (sys_reftime._4_4_ >> 0x10 & 0xff)
                                            << 8 |
                                        sys_reftime._4_4_ >> 0x18;
                                    FUN_0007055c(&local_88c);
                                    *(uint *)(param_1 + 0x248) = local_88c;
                                    *(uint *)(param_1 + 0x24c) = local_888;
                                    local_844 =
                                        local_88c << 0x18 |
                                        (local_88c >> 8 & 0xff) << 0x10 |
                                        (local_88c >> 0x10 & 0xff) << 8 |
                                        local_88c >> 0x18;
                                    local_840 =
                                        local_888 << 0x18 |
                                        (local_888 >> 8 & 0xff) << 0x10 |
                                        (local_888 >> 0x10 & 0xff) << 8 |
                                        local_888 >> 0x18;
                                    uVar7 = sys_ttlmax;
                                    if (*(uint *)(param_1 + 0x4c) <=
                                        sys_ttlmax) {
                                        uVar7 = *(uint *)(param_1 + 0x4c);
                                    }
                                    FUN_00026cc0(
                                        uVar10, uVar5,
                                        *(undefined1 *)((int)&sys_ttl + uVar7),
                                        &local_86c, 0x30);
                                    *(int *)(param_1 + 0x2c8) =
                                        *(int *)(param_1 + 0x2c8) +
                                        (1 << *(sbyte *)(param_1 + 0x41)) + -2;
                                    *(int *)(param_1 + 0x2e4) =
                                        *(int *)(param_1 + 0x2e4) + 1;
                                    uVar10 = FUN_0007d2c0(uVar10);
                                    FUN_00075d40(6, "Soliciting pool server %s",
                                                 uVar10);
                                    break;
                                }
                                iVar6 = *(int *)(param_1 + 0x34);
                            } while (iVar6 != 0);
                        } else {
                            if (*(void **)(param_1 + 0x30) != (void *)0x0) {
                                free(*(void **)(param_1 + 0x30));
                                *(undefined4 *)(param_1 + 0x30) = 0;
                            }
                            local_888 = (uint) * (ushort *)(param_1 + 0x10);
                            local_88c = 0;
                            local_87c = 0;
                            uStack_878 = 0;
                            uStack_874 = 0;
                            local_870 = 0;
                            local_884 = 2;
                            local_880 = 0x11;
                            iVar6 = FUN_00079464(
                                *(undefined4 *)(param_1 + 0x2c), &DAT_0009e38c,
                                &local_88c, 0, pool_name_resolved,
                                *(undefined2 *)(param_1 + 0x3c));
                            if (iVar6 != 0) {
                                FUN_00075d40(3,
                                             "unable to start pool DNS %s: %m",
                                             *(undefined4 *)(param_1 + 0x2c));
                            }
                        }
                        if (local_24 != __stack_chk_guard) {
                            /* WARNING: Subroutine does not return */
                            __stack_chk_fail();
                        }
                        return;
                    }
                    goto LAB_00046e5c;
                }
            }
        } else {
            *(int *)(param_1 + 0x2cc) = current_time;
            FUN_000448c4(param_1, cVar9);
            iVar6 = *(int *)(param_1 + 0x2c4);
            if (sys_beacon < iVar6) {
                *(uint *)(param_1 + 0x2c4) = bVar2 & 6;
                *(uint *)(param_1 + 0x4c) = bVar2 & 6;
                FUN_00043f68(param_1);
                iVar6 = *(int *)(param_1 + 0x2c4);
            } else if ((sys_survivors < sys_minclock) ||
                       (peer_associations < sys_maxclock)) {
                if (*(uint *)(param_1 + 0x4c) < sys_ttlmax) {
                    *(uint *)(param_1 + 0x4c) = *(uint *)(param_1 + 0x4c) + 1;
                }
                FUN_00043f68(param_1);
                iVar6 = *(int *)(param_1 + 0x2c4);
            }
            *(int *)(param_1 + 0x2c4) = iVar6 + 1;
        }
    LAB_00046c20:
        if (local_24 == __stack_chk_guard) {
            return;
        }
    } else {
        *(int *)(param_1 + 0x2cc) = current_time;
        FUN_000448c4(param_1, cVar9);
        if (sys_leap == '\x03')
            goto LAB_00046c20;
    LAB_00046bb0:
        if (local_24 == __stack_chk_guard) {
            FUN_00043f68(param_1);
            return;
        }
    }
LAB_00046e5c:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x00047864 */
/* WARNING: Restarted to delay deadcode elimination for space: register */

void receive(int param_1)

{
    undefined4 uVar1;
    undefined4 uVar2;
    int iVar3;
    int iVar4;
    int iVar5;
    byte bVar6;
    uint uVar7;
    uint uVar8;
    int iVar9;
    uint uVar10;
    uint uVar11;
    uint uVar12;
    int *piVar13;
    int iVar14;
    uint uVar15;
    bool bVar16;
    double dVar17;
    uint local_190;
    uint local_18c;
    uint local_184;
    uint local_180;
    uint local_178;
    int local_174;
    int local_170;
    int local_16c;
    int local_168;
    char *local_160;
    uint local_15c;
    ushort local_150;
    short local_14e;
    undefined4 local_14c;
    uint local_148;
    uint local_144;
    uint local_140;
    uint local_13c;
    uint local_138;
    uint local_134;
    char acStack_130[260];
    int local_2c;

    local_14c = 0;
    local_2c = __stack_chk_guard;
    sys_received = sys_received + 1;
    if (*(ushort *)(param_1 + 6) >> 8 == 0 &&
        (*(ushort *)(param_1 + 6) & 0xff) == 0)
        goto LAB_00046f04;
    iVar14 = param_1 + 4;
    FUN_00050e20(iVar14, &local_150);
    uVar15 = (uint) * (byte *)(param_1 + 0x59);
    uVar12 = (uint)local_150;
    bVar6 = *(byte *)(param_1 + 0x58);
    if (uVar15 == 0) {
        uVar15 = 0x10;
    }
    if ((local_150 & 1) == 0) {
        local_190 = bVar6 & 7;
        if (local_190 == 7) {
            if ((ntp_mode7 != 0) && ((local_150 & 0x80) == 0)) {
                FUN_00050174(param_1, ((uVar12 ^ 0x100) << 0x17) >> 0x1f);
                goto LAB_00046f18;
            }
        } else if (local_190 == 6) {
            if ((local_150 & 0x80) == 0) {
                FUN_000333f0(param_1, uVar12);
                goto LAB_00046f18;
            }
        } else if (((local_150 & 2) == 0) &&
                   (((local_150 & 0x2000) == 0 ||
                     (iVar4 = FUN_00079a2c(),
                      0.1 <= (double)(longlong)iVar4 / 2147483647.0)))) {
            uVar7 = ((uint)bVar6 << 0x1a) >> 0x1d;
            if (uVar7 == 4) {
                sys_newversion = sys_newversion + 1;
                if ((bVar6 & 7) != 0)
                    goto LAB_00046ffc;
            } else {
                uVar8 = ((uVar12 ^ 8) << 0x1c) >> 0x1f;
                if (uVar7 == 0) {
                    uVar8 = 0;
                }
                if (uVar8 != 0) {
                    sys_oldversion = sys_oldversion + 1;
                    if ((bVar6 & 7) == 0) {
                        if (uVar7 != 1)
                            goto LAB_00046f04;
                        local_190 = 3;
                    }
                LAB_00046ffc:
                    iVar9 = *(int *)(param_1 + 0x54);
                    iVar4 = param_1 + 0x58;
                    local_178 = iVar9 - 0x30;
                    if ((int)local_178 < 1) {
                        local_160 = (char *)0x0;
                        local_16c = 0x30;
                        local_15c = 0;
                    LAB_000473bc:
                        if (local_178 != 0)
                            goto LAB_00046f04;
                        bVar16 = true;
                        local_184 = local_178;
                        if ((local_150 & 4) != 0) {
                            sys_restricted = sys_restricted + 1;
                            goto LAB_00046f18;
                        }
                    } else {
                        uVar7 = local_178 & 3;
                        if (uVar7 != 0) {
                            uVar7 = 1;
                        }
                        if ((int)local_178 < 4) {
                            uVar7 = uVar7 | 1;
                        }
                        if (uVar7 != 0)
                            goto LAB_00046f04;
                        local_160 = (char *)0x0;
                        if ((int)local_178 < 0x19) {
                            local_16c = 0x30;
                            local_15c = 0;
                        } else {
                            local_16c = 0x30;
                            do {
                                iVar3 = local_16c + 3;
                                if (-1 < local_16c) {
                                    iVar3 = local_16c;
                                }
                                uVar11 = *(uint *)(iVar4 + (iVar3 >> 2) * 4);
                                iVar3 = iVar4 + (iVar3 >> 2) * 4;
                                uVar7 = (uVar11 >> 8 & 0xff) << 0x10;
                                local_15c = uVar11 << 0x18 | uVar7;
                                uVar8 = uVar11 >> 0x18 & 3;
                                uVar10 = (uVar11 >> 0x10 & 0xff) << 8 |
                                         uVar11 >> 0x18;
                                if (uVar8 != 0) {
                                    uVar8 = 1;
                                }
                                if (uVar10 < 4) {
                                    uVar8 = uVar8 | 1;
                                }
                                if ((uVar8 != 0) ||
                                    (local_16c = uVar10 + local_16c,
                                     iVar9 < local_16c))
                                    goto LAB_00046f04;
                                if (((uVar11 << 0x18 & 0x3fff0000 | uVar7) ==
                                     0x2010000) &&
                                    (sys_groupname != 0)) {
                                    uVar7 = *(uint *)(iVar3 + 0x10);
                                    uVar7 = uVar7 << 0x18 |
                                            (uVar7 >> 8 & 0xff) << 0x10 |
                                            (uVar7 >> 0x10 & 0xff) << 8 |
                                            uVar7 >> 0x18;
                                    if ((0x100 < uVar7) ||
                                        (uVar10 - 0x14 < uVar7))
                                        goto LAB_00046f04;
                                    __memcpy_chk(acStack_130, iVar3 + 0x14,
                                                 uVar7, 0x101);
                                    acStack_130[uVar7] = '\0';
                                    local_160 = strchr(acStack_130, 0x40);
                                    if (local_160 == (char *)0x0)
                                        goto switchD_00047520_default;
                                    local_160 = local_160 + 1;
                                }
                                local_178 = local_178 - uVar10;
                                if ((int)local_178 < 1)
                                    goto LAB_000473bc;
                                uVar7 = local_178 & 3;
                                if (uVar7 != 0) {
                                    uVar7 = 1;
                                }
                                if ((int)local_178 < 4) {
                                    uVar7 = uVar7 | 1;
                                }
                                if (uVar7 != 0)
                                    goto LAB_00046f04;
                            } while (0x18 < (int)local_178);
                        }
                        iVar9 = local_16c + 3;
                        if (-1 < local_16c) {
                            iVar9 = local_16c;
                        }
                        bVar16 = local_178 == 0;
                        uVar7 = *(uint *)(iVar4 + (iVar9 >> 2) * 4);
                        local_184 = uVar7 << 0x18 |
                                    (uVar7 >> 8 & 0xff) << 0x10 |
                                    (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18;
                    }
                    uVar12 = FUN_000414d4(param_1, uVar12);
                    if ((uVar12 & 0x40) != 0) {
                        sys_limitrejected = sys_limitrejected + 1;
                        if (((uVar12 & 0x800) == 0) || (local_190 - 4 < 2))
                            goto LAB_00046f18;
                        local_180 = uVar12;
                        if (local_190 != 3) {
                            FUN_0001c270(param_1, 1, local_184, uVar12);
                            goto LAB_00046f18;
                        }
                        goto LAB_00047874;
                    }
                    local_18c = FUN_000431d4(param_1, local_190, &local_14c);
                    uVar11 = *(uint *)(param_1 + 0x80);
                    uVar7 = *(uint *)(param_1 + 0x70);
                    uVar8 = *(uint *)(param_1 + 0x74);
                    uVar10 = *(uint *)(param_1 + 0x78);
                    local_148 = uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 |
                                (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18;
                    uVar7 = *(uint *)(param_1 + 0x7c);
                    local_144 = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 |
                                (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
                    local_138 = uVar11 << 0x18 | (uVar11 >> 8 & 0xff) << 0x10 |
                                (uVar11 >> 0x10 & 0xff) << 8 | uVar11 >> 0x18;
                    local_140 = uVar10 << 0x18 | (uVar10 >> 8 & 0xff) << 0x10 |
                                (uVar10 >> 0x10 & 0xff) << 8 | uVar10 >> 0x18;
                    local_13c = uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 |
                                (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18;
                    uVar7 = *(uint *)(param_1 + 0x84);
                    local_134 = uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 |
                                (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18;
                    local_170 = *(int *)(param_1 + 0x3c) + 0x18;
                    uVar1 = FUN_0007557c(local_190);
                    FUN_00043d54(local_14c);
                    iVar9 = FUN_00043c5c(local_18c, param_1, local_190);
                    if (iVar9 == 1) {
                        FUN_00036294(0x8c, local_18c, "Invalid_NAK");
                        if (local_18c != 0) {
                            *(int *)(local_18c + 0x2f4) =
                                *(int *)(local_18c + 0x2f4) + 1;
                        }
                        uVar12 = current_time;
                        uVar1 = FUN_0007d2c0(local_170);
                        FUN_0007d2c0(iVar14);
                        FUN_00075d40(3, "Invalid-NAK error at %ld %s<-%s",
                                     uVar12, uVar1);
                        goto LAB_00046f18;
                    }
                    if (!bVar16) {
                        local_174 = 0;
                        local_168 = local_174;
                        if (iVar9 == 2) {
                            uVar7 = 3;
                            goto LAB_000474d4;
                        }
                        if (crypto_flags == 0 || 0xffff >= local_184) {
                        LAB_000476a0:
                            iVar3 = FUN_00073770(local_184, iVar4, local_16c,
                                                 local_178);
                            if (iVar3 == 0) {
                                uVar7 = 2;
                            } else {
                                uVar7 = 1;
                            }
                            if (crypto_flags != 0 && 0xffff < local_184) {
                                FUN_000730c4(local_184, 0);
                            }
                            goto LAB_000474d4;
                        }
                        if (0x13 < (int)local_178) {
                            if (local_190 == 5) {
                                iVar5 = *(int *)(param_1 + 0x3c);
                                iVar3 = any_interface;
                                if (*(short *)(param_1 + 4) != 2) {
                                    iVar3 = any6_interface;
                                }
                                if (iVar5 == iVar3)
                                    goto LAB_0004720c;
                                if (*(short *)(iVar5 + 0x50) == 2) {
                                    uVar7 = *(uint *)(iVar5 + 0x54);
                                    if (uVar7 != 0) {
                                        uVar7 = 1;
                                    }
                                } else {
                                    if (*(int *)(iVar5 + 0x58) == 0) {
                                        if (*(int *)(iVar5 + 0x5c) == 0) {
                                            uVar7 = 0;
                                            if (*(int *)(iVar5 + 0x60) == 0) {
                                                uVar7 =
                                                    (uint)(*(int *)(iVar5 +
                                                                    100) == 0);
                                            }
                                        } else {
                                            uVar7 = 0;
                                        }
                                    } else {
                                        uVar7 = 0;
                                    }
                                    uVar7 = uVar7 ^ 1;
                                }
                                if (uVar7 != 0) {
                                    local_170 = iVar5 + 0x50;
                                }
                                local_174 = 0;
                            } else {
                                if (local_18c == 0) {
                                    local_174 = FUN_00037700(iVar14, local_170,
                                                             0, sys_private);
                                } else {
                                    local_174 = *(int *)(local_18c + 0xa8);
                                }
                                bVar16 = local_174 != 0;
                                iVar3 = local_174;
                                if (bVar16) {
                                    iVar3 = local_16c + -0x30;
                                }
                                if ((bVar16 && local_16c != 0x30) &&
                                    iVar3 < 0 ==
                                        (bVar16 && SBORROW4(local_16c, 0x30))) {
                                    FUN_00037700(iVar14, local_170, local_184,
                                                 0);
                                    local_168 =
                                        FUN_00037700(iVar14, local_170,
                                                     local_184, local_174);
                                    goto LAB_000476a0;
                                }
                            }
                            local_168 = FUN_00037700(iVar14, local_170,
                                                     local_184, local_174);
                            goto LAB_000476a0;
                        }
                        goto LAB_0004798c;
                    }
                    uVar7 = 0;
                    local_174 = 0;
                    local_168 = 0;
                LAB_000474d4:
                    local_180 = uVar12 & 0xe7ff;
                    if (((local_18c == 0) ||
                         (*(uint *)(local_18c + 0x7c) == 0)) ||
                        ((local_184 == *(uint *)(local_18c + 0x7c) &&
                          (uVar7 == 1 || local_178 == 0)))) {
                        bVar6 = bVar6 >> 6;
                        switch (local_14c) {
                        case 0:
                            break;
                        case 1:
                            iVar3 = FUN_0001c658(
                                local_160, *(undefined4 *)(local_18c + 0x50));
                            if (iVar3 == 0) {
                                if (local_190 == 5) {
                                    uVar8 = (uint) * (byte *)(param_1 + 0x5a);
                                    if (uVar8 != *(byte *)(local_18c + 0x5e)) {
                                        uVar2 = FUN_0007d2c0(iVar14);
                                        FUN_00075d40(
                                            6,
                                            "receive: broadcast poll from %s "
                                            "changed from %u to %u",
                                            uVar2,
                                            *(undefined1 *)(local_18c + 0x5e));
                                        uVar8 =
                                            (uint) * (byte *)(param_1 + 0x5a);
                                    }
                                    if ((uVar8 < *(byte *)(local_18c + 0x41)) ||
                                        (*(byte *)(local_18c + 0x42) < uVar8)) {
                                        iVar3 = 1;
                                        uVar2 = FUN_0007d2c0(iVar14);
                                        FUN_00075d40(6,
                                                     "receive: broadcast poll "
                                                     "of %u from %s is "
                                                     "out-of-range (%d to %d)!",
                                                     uVar8, uVar2);
                                        uVar8 =
                                            (uint) * (byte *)(param_1 + 0x5a);
                                    } else {
                                        iVar3 = 0;
                                    }
                                    uVar8 = 1 << uVar8;
                                    if ((*(uint *)(local_18c + 0x44) & 0x10) !=
                                        0) {
                                        uVar8 = uVar8 - 3;
                                    }
                                    if (current_time -
                                            *(int *)(local_18c + 0x2dc) <
                                        uVar8) {
                                        uVar2 = FUN_0007d2c0(iVar14);
                                        iVar3 = iVar3 + 1;
                                        FUN_00075d40(
                                            6,
                                            "receive: broadcast packet from %s "
                                            "arrived after %lu, not %lu "
                                            "seconds!",
                                            uVar2,
                                            current_time -
                                                *(int *)(local_18c + 0x2dc));
                                    }
                                    if (sys_bcpollbstep == 0) {
                                        uVar8 = 0;
                                    } else {
                                        uVar8 = ((uint)sys_bcpollbstep << *(
                                                     sbyte *)(param_1 + 0x5a)) +
                                                2;
                                    }
                                    if (*(int *)(local_18c + 0x25c) == 0 &&
                                        *(int *)(local_18c + 600) == 0) {
                                    LAB_00048a48:
                                        if (iVar3 == 0)
                                            goto LAB_00047d88;
                                    } else {
                                        iVar5 = local_138 -
                                                *(int *)(local_18c + 600);
                                        if (local_134 <
                                            local_134 -
                                                *(int *)(local_18c + 0x25c)) {
                                            iVar5 = iVar5 + -1;
                                        }
                                        if ((-1 < iVar5) ||
                                            (uVar8 <=
                                             current_time -
                                                 *(int *)(local_18c + 0x2dc)))
                                            goto LAB_00048a48;
                                        uVar1 = FUN_0007d2c0(iVar14);
                                        FUN_00075d40(
                                            6,
                                            "receive: broadcast packet from %s "
                                            "contains non-monotonic timestamp: "
                                            "%#010x.%08x -> %#010x.%08x",
                                            uVar1,
                                            *(undefined4 *)(local_18c + 600));
                                    }
                                    *(uint *)(local_18c + 0x2d8) = current_time;
                                    sys_declined = sys_declined + 1;
                                    goto LAB_00046f18;
                                }
                            LAB_00047d88:
                                uVar8 = *(uint *)(local_18c + 0x44);
                                if (uVar7 != 3) {
                                    if ((uVar8 & 0x800) == 0) {
                                        if (0xffff < local_184)
                                            goto LAB_0004798c;
                                    } else if (local_184 < 0x10000) {
                                    LAB_0004798c:
                                        sys_badauth = sys_badauth + 1;
                                        goto LAB_00046f18;
                                    }
                                }
                                bVar16 = (uVar8 & 0x4000) != 0;
                                if (bVar16) {
                                    uVar8 = uVar8 & 0xffffbfff;
                                }
                                uVar10 = *(int *)(local_18c + 0x2e8) + 1;
                                uVar11 =
                                    *(uint *)(local_18c + 300) & 0xfffffe00;
                                *(uint *)(local_18c + 0x2e8) = uVar10;
                                if (bVar16) {
                                    uVar10 = local_18c;
                                }
                                *(uint *)(local_18c + 300) = uVar11;
                                if (bVar16) {
                                    *(uint *)(uVar10 + 0x44) = uVar8;
                                    *(uint *)(uVar10 + 300) = uVar11 | 4;
                                }
                                iVar3 = FUN_00043b64(
                                    bVar6, uVar15, local_190,
                                    *(undefined4 *)(param_1 + 100));
                                uVar10 = local_144;
                                uVar8 = local_148;
                                if (local_134 == 0 && local_138 == 0) {
                                    *(uint *)(local_18c + 300) =
                                        *(uint *)(local_18c + 300) | 4;
                                    if (iVar3 != 0) {
                                        *(int *)(local_18c + 0x2f8) =
                                            *(int *)(local_18c + 0x2f8) + 1;
                                        uVar1 = FUN_0007d2c0(local_18c + 0x10);
                                        FUN_00075d40(
                                            6,
                                            "receive: Unexpected zero transmit "
                                            "timestamp in KoD from %s",
                                            uVar1);
                                        goto LAB_00046f18;
                                    }
                                } else {
                                    if ((local_138 ==
                                         *(uint *)(local_18c + 0x238)) &&
                                        (local_134 ==
                                         *(uint *)(local_18c + 0x23c))) {
                                        *(uint *)(local_18c + 300) =
                                            *(uint *)(local_18c + 300) | 1;
                                        *(int *)(local_18c + 0x2fc) =
                                            *(int *)(local_18c + 0x2fc) + 1;
                                        goto LAB_00046f18;
                                    }
                                    if (local_190 == 5) {
                                        if (0xf < uVar15) {
                                            uVar1 =
                                                FUN_0007d2c0(local_18c + 0x10);
                                            FUN_00075d40(
                                                6,
                                                "receive: Unexpected stratum "
                                                "(%d) in broadcast from %s",
                                                uVar15, uVar1);
                                            goto LAB_00046f18;
                                        }
                                    } else if (iVar3 == 0) {
                                        if (*(int *)(local_18c + 0x13c) == 0) {
                                            if (local_144 == 0 &&
                                                local_148 == 0) {
                                                *(int *)(local_18c + 0x2f8) =
                                                    *(int *)(local_18c +
                                                             0x2f8) +
                                                    1;
                                                *(uint *)(local_18c + 300) =
                                                    *(uint *)(local_18c + 300) |
                                                    2;
                                                FUN_0007d2c0(local_18c + 0x10);
                                                FUN_00075d40(
                                                    6,
                                                    "receive: %s 0 origin "
                                                    "timestamp from %s@%s xmt "
                                                    "%#010x.%08x",
                                                    &DAT_000a792c, uVar1);
                                            } else if ((local_148 ==
                                                        *(uint *)(local_18c +
                                                                  0x248)) &&
                                                       (local_144 ==
                                                        *(uint *)(local_18c +
                                                                  0x24c))) {
                                                *(undefined4 *)(local_18c +
                                                                0x24c) = 0;
                                                *(undefined4 *)(local_18c +
                                                                0x248) = 0;
                                            } else {
                                                uVar15 =
                                                    *(uint *)(param_1 + 0x74);
                                                *(int *)(local_18c + 0x2f8) =
                                                    *(int *)(local_18c +
                                                             0x2f8) +
                                                    1;
                                                *(uint *)(local_18c + 300) =
                                                    *(uint *)(local_18c + 300) |
                                                    2;
                                                uVar8 =
                                                    *(uint *)(param_1 + 0x70);
                                                FUN_0007d2c0(local_18c + 0x10);
                                                FUN_00075d40(
                                                    6,
                                                    "receive: Unexpected "
                                                    "origin timestamp "
                                                    "%#010x.%08x does not "
                                                    "match aorg %#010x.%08x "
                                                    "from %s@%s xmt "
                                                    "%#010x.%08x",
                                                    uVar8 << 0x18 |
                                                        (uVar8 >> 8 & 0xff)
                                                            << 0x10 |
                                                        (uVar8 >> 0x10 & 0xff)
                                                            << 8 |
                                                        uVar8 >> 0x18,
                                                    uVar15 << 0x18 |
                                                        (uVar15 >> 8 & 0xff)
                                                            << 0x10 |
                                                        (uVar15 >> 0x10 & 0xff)
                                                            << 8 |
                                                        uVar15 >> 0x18);
                                                if ((*(uint *)(local_18c +
                                                               0x244) != 0 ||
                                                     *(uint *)(local_18c +
                                                               0x240) != 0) &&
                                                    ((*(uint *)(local_18c +
                                                                0x240) ==
                                                          local_148 &&
                                                      (*(uint *)(local_18c +
                                                                 0x244) ==
                                                       local_144)))) {
                                                    if (dynamic_interleave ==
                                                        0) {
                                                        uVar2 = FUN_0007d2c0(
                                                            local_18c + 0x10);
                                                        FUN_00075d40(
                                                            6,
                                                            "receive: Dynamic "
                                                            "interleave from "
                                                            "%s@%s denied",
                                                            uVar1, uVar2);
                                                    } else {
                                                        *(undefined4
                                                              *)(local_18c +
                                                                 0x13c) = 1;
                                                        FUN_00036294(
                                                            0x8e, local_18c, 0);
                                                    }
                                                }
                                            }
                                        } else {
                                            if ((local_144 != 0 ||
                                                 local_148 != 0) &&
                                                (local_13c != 0 ||
                                                 local_140 != 0)) {
                                                if (*(uint *)(local_18c +
                                                              0x244) != 0 ||
                                                    *(uint *)(local_18c +
                                                              0x240) != 0) {
                                                    if (local_144 !=
                                                            *(uint
                                                                  *)(local_18c +
                                                                     0x244) ||
                                                        local_148 !=
                                                            *(uint
                                                                  *)(local_18c +
                                                                     0x240)) {
                                                        *(int *)(local_18c +
                                                                 0x2f8) =
                                                            *(int *)(local_18c +
                                                                     0x2f8) +
                                                            1;
                                                        *(uint *)(local_18c +
                                                                  0x44) =
                                                            *(uint
                                                                  *)(local_18c +
                                                                     0x44) |
                                                            0x4000;
                                                        *(uint *)(local_18c +
                                                                  300) =
                                                            *(uint
                                                                  *)(local_18c +
                                                                     300) |
                                                            2;
                                                    }
                                                    goto LAB_00047e24;
                                                }
                                            }
                                            *(uint *)(local_18c + 300) =
                                                *(uint *)(local_18c + 300) | 4;
                                        }
                                    } else {
                                        if ((local_144 == 0 &&
                                             local_148 == 0) ||
                                            (local_13c == 0 &&
                                             local_140 == 0)) {
                                            *(int *)(local_18c + 0x2f8) =
                                                *(int *)(local_18c + 0x2f8) + 1;
                                            uVar1 =
                                                FUN_0007d2c0(local_18c + 0x10);
                                            FUN_00075d40(
                                                6,
                                                "receive: KoD packet from %s "
                                                "has a zero org or rec "
                                                "timestamp.  Ignoring.",
                                                uVar1);
                                            goto LAB_00046f18;
                                        }
                                        if (local_134 != local_13c ||
                                            (local_138 != local_140 ||
                                             (local_134 != local_144 ||
                                              local_138 != local_148))) {
                                            *(int *)(local_18c + 0x2f8) =
                                                *(int *)(local_18c + 0x2f8) + 1;
                                            uVar1 =
                                                FUN_0007d2c0(local_18c + 0x10);
                                            FUN_00075d40(
                                                6,
                                                "receive: KoD packet from %s "
                                                "has inconsistent xmt/org/rec "
                                                "timestamps.  Ignoring.",
                                                uVar1);
                                            goto LAB_00046f18;
                                        }
                                        if (*(int *)(local_18c + 0x13c) == 0) {
                                            if ((local_148 !=
                                                 *(uint *)(local_18c +
                                                           0x248)) ||
                                                (local_144 !=
                                                 *(uint *)(local_18c +
                                                           0x24c))) {
                                                *(int *)(local_18c + 0x2f8) =
                                                    *(int *)(local_18c +
                                                             0x2f8) +
                                                    1;
                                                FUN_0007d2c0(local_18c + 0x10);
                                                FUN_00075d40(
                                                    6,
                                                    "receive: flip 0 KoD "
                                                    "origin timestamp "
                                                    "%#010x.%08x from %s does "
                                                    "not match %#010x.%08x - "
                                                    "ignoring.",
                                                    uVar8, uVar10);
                                                goto LAB_00046f18;
                                            }
                                        } else if ((*(int *)(local_18c +
                                                             0x13c) == 1) &&
                                                   ((local_148 !=
                                                         *(uint *)(local_18c +
                                                                   0x250) ||
                                                     (local_144 !=
                                                      *(uint *)(local_18c +
                                                                0x254))))) {
                                            *(int *)(local_18c + 0x2f8) =
                                                *(int *)(local_18c + 0x2f8) + 1;
                                            FUN_0007d2c0(local_18c + 0x10);
                                            FUN_00075d40(
                                                6,
                                                "receive: flip 1 KoD origin "
                                                "timestamp %#010x.%08x from %s "
                                                "does not match interleave "
                                                "%#010x.%08x - ignoring.",
                                                uVar8, uVar10);
                                            goto LAB_00046f18;
                                        }
                                    }
                                }
                            LAB_00047e24:
                                if (iVar9 == 2) {
                                    FUN_00036294(0x8c, local_18c, "crypto_NAK");
                                    *(uint *)(local_18c + 300) =
                                        *(uint *)(local_18c + 300) | 0x10;
                                    *(int *)(local_18c + 0x2f0) =
                                        *(int *)(local_18c + 0x2f0) + 1;
                                    iVar14 = unpeer_crypto_nak_early;
                                    if ((*(uint *)(local_18c + 0x44) & 2) ==
                                        0) {
                                        if (*(int *)(local_18c + 0x88) != 0) {
                                            FUN_000467d8(local_18c,
                                                         &DAT_000a7a18);
                                        }
                                        goto LAB_00046f18;
                                    }
                                } else {
                                    uVar15 = local_178;
                                    if (local_178 != 0) {
                                        uVar15 = 1;
                                    }
                                    if ((local_178 == 0 &&
                                         *(int *)(local_18c + 0x7c) == 0) &&
                                        ((uVar12 & 4) == 0)) {
                                        uVar12 = (uint)(1 < uVar7);
                                    } else {
                                        uVar12 = uVar7 - 1;
                                        if (uVar12 != 0) {
                                            uVar12 = 1;
                                        }
                                    }
                                    if (uVar12 == 0) {
                                        if (local_190 == 5) {
                                            if (uVar7 < 2) {
                                                if (local_144 == 0 &&
                                                    local_148 == 0) {
                                                    if ((*(uint *)(local_18c +
                                                                   0x44) &
                                                         0x2000) != 0) {
                                                        uVar1 = FUN_0007d2c0(
                                                            local_18c + 0x10);
                                                        FUN_00075d40(
                                                            6,
                                                            "receive: "
                                                            "Broadcast server "
                                                            "at %s is no "
                                                            "longer in "
                                                            "interleave mode",
                                                            uVar1);
                                                        *(uint *)(local_18c +
                                                                  0x44) =
                                                            *(uint
                                                                  *)(local_18c +
                                                                     0x44) &
                                                            0xffffdfff;
                                                    }
                                                } else if ((*(uint
                                                                  *)(local_18c +
                                                                     0x44) &
                                                            0x2000) == 0) {
                                                    uVar1 = FUN_0007d2c0(
                                                        local_18c + 0x10);
                                                    FUN_00075d40(
                                                        6,
                                                        "receive: Broadcast "
                                                        "server at %s is in "
                                                        "interleave mode",
                                                        uVar1);
                                                    *(uint *)(local_18c +
                                                              0x44) =
                                                        *(uint *)(local_18c +
                                                                  0x44) |
                                                        0x2000;
                                                    *(uint *)(local_18c +
                                                              0x248) =
                                                        local_138;
                                                    *(uint *)(local_18c +
                                                              0x24c) =
                                                        local_134;
                                                    uVar1 = *(
                                                        undefined4 *)(param_1 +
                                                                      0x4c);
                                                    *(undefined4 *)(local_18c +
                                                                    0x250) =
                                                        *(undefined4
                                                              *)(param_1 +
                                                                 0x48);
                                                    *(undefined4 *)(local_18c +
                                                                    0x254) =
                                                        uVar1;
                                                    FUN_00036294(0x8e,
                                                                 local_18c, 0);
                                                    goto LAB_00046f18;
                                                }
                                            } else {
                                                uVar1 = FUN_0007d2c0(local_18c +
                                                                     0x10);
                                                FUN_00075d40(
                                                    6,
                                                    "receive: Bad broadcast "
                                                    "auth (%d) from %s",
                                                    uVar7, uVar1);
                                            }
                                            *(uint *)(local_18c + 600) =
                                                local_138;
                                            *(uint *)(local_18c + 0x25c) =
                                                local_134;
                                            if (*(int *)(local_18c + 0x13c) ==
                                                0)
                                                goto LAB_00048000;
                                        } else if (*(int *)(local_18c +
                                                            0x13c) == 0) {
                                            *(uint *)(local_18c + 0x230) =
                                                local_138;
                                            *(uint *)(local_18c + 0x234) =
                                                local_134;
                                        LAB_00048000:
                                            uVar1 =
                                                *(undefined4 *)(param_1 + 0x4c);
                                            *(undefined4 *)(local_18c + 0x240) =
                                                *(undefined4 *)(param_1 + 0x48);
                                            *(undefined4 *)(local_18c + 0x244) =
                                                uVar1;
                                        }
                                        *(uint *)(local_18c + 0x238) =
                                            local_138;
                                        *(uint *)(local_18c + 0x23c) =
                                            local_134;
                                        bVar6 = *(byte *)(local_18c + 0x41);
                                        if (*(byte *)(local_18c + 0x41) <
                                            *(byte *)(param_1 + 0x5a)) {
                                            bVar6 = *(byte *)(param_1 + 0x5a);
                                        }
                                        *(byte *)(local_18c + 0x5e) = bVar6;
                                        if (iVar3 == 1) {
                                            *(int *)(local_18c + 0x304) =
                                                *(int *)(local_18c + 0x304) + 1;
                                            FUN_00036294(0x87, local_18c, 0);
                                            bVar6 = *(byte *)(local_18c + 0x41);
                                            if (bVar6 <
                                                *(byte *)(param_1 + 0x5a)) {
                                                bVar6 =
                                                    *(byte *)(local_18c + 0x5e);
                                                *(byte *)(local_18c + 0x41) =
                                                    bVar6;
                                            }
                                            *(undefined4 *)(local_18c + 0x138) =
                                                0;
                                            *(int *)(local_18c + 0x2c8) =
                                                9 << (uint)bVar6;
                                            *(undefined4 *)(local_18c + 0x134) =
                                                0;
                                            FUN_000448c4(
                                                local_18c,
                                                *(undefined1 *)(param_1 +
                                                                0x5a));
                                            goto LAB_00046f18;
                                        }
                                        if (iVar3 != 0) {
                                            *(int *)(local_18c + 0x304) =
                                                *(int *)(local_18c + 0x304) + 1;
                                            goto LAB_00046f18;
                                        }
                                        uVar12 = 1 << (local_190 - 1 & 0xff);
                                        if ((uVar12 & 100) == 0) {
                                            if ((uVar12 & 0x1b) == 0) {
                                                uVar1 = FUN_0007d2c0(local_18c +
                                                                     0x10);
                                                FUN_00075d40(
                                                    6,
                                                    "receive: Unexpected mode "
                                                    "(%d) in packet from %s",
                                                    local_190, uVar1);
                                                goto LAB_00048404;
                                            }
                                            if (local_184 == 0 || uVar7 != 1)
                                                goto LAB_00048404;
                                            if ((local_184 < 0x10000) &&
                                                (iVar9 = FUN_000732ac(
                                                     local_184,
                                                     local_18c + 0x10),
                                                 iVar9 == 0)) {
                                                FUN_00036294(0x8c, local_18c,
                                                             "authIP");
                                                *(int *)(local_18c + 0x2f0) =
                                                    *(int *)(local_18c +
                                                             0x2f0) +
                                                    1;
                                                goto LAB_00046f18;
                                            }
                                            uVar12 = current_time;
                                            *(uint *)(local_18c + 0x2dc) =
                                                current_time;
                                            *(uint *)(local_18c + 0x2d8) =
                                                uVar12;
                                        LAB_000481c8:
                                            uVar12 =
                                                *(uint *)(local_18c + 0x44) | 4;
                                            *(uint *)(local_18c + 0x44) =
                                                uVar12;
                                        } else {
                                        LAB_00048404:
                                            uVar12 = current_time;
                                            *(uint *)(local_18c + 0x2dc) =
                                                current_time;
                                            *(uint *)(local_18c + 0x2d8) =
                                                uVar12;
                                            if (uVar7 == 1)
                                                goto LAB_000481c8;
                                            uVar12 =
                                                *(uint *)(local_18c + 0x44) &
                                                0xfffffffb;
                                            *(uint *)(local_18c + 0x44) =
                                                uVar12;
                                        }
                                        if ((uVar12 & 0x800) != 0) {
                                            piVar13 =
                                                *(int **)(local_18c + 0xdc);
                                            if ((piVar13 != (int *)0x0) &&
                                                (0 < piVar13[1])) {
                                                piVar13[1] = piVar13[1] + -1;
                                            }
                                            *(uint *)(local_18c + 300) =
                                                *(uint *)(local_18c + 300) |
                                                0x80;
                                            iVar9 = FUN_00038650(local_18c,
                                                                 param_1);
                                            if (iVar9 != 0x100) {
                                                if (iVar9 != 0x10f)
                                                    goto LAB_00046f18;
                                                FUN_00036294(0x85, local_18c,
                                                             "crypto error");
                                                FUN_000467d8(local_18c,
                                                             &DAT_000a7b54);
                                                *(uint *)(local_18c + 300) =
                                                    *(uint *)(local_18c + 300) |
                                                    0x100;
                                                iVar14 = unpeer_crypto_early;
                                                if ((*(uint *)(local_18c +
                                                               0x44) &
                                                     2) == 0)
                                                    goto LAB_00046f18;
                                                goto joined_r0x00047eec;
                                            }
                                            iVar9 = 0;
                                            *(undefined4 *)(local_18c + 0x2c4) =
                                                0;
                                            if (local_190 == 4) {
                                                if (*(uint *)(local_18c +
                                                              0x7c) ==
                                                    local_184) {
                                                    *(uint *)(local_18c + 300) =
                                                        *(uint *)(local_18c +
                                                                  300) &
                                                        0xffffff7f;
                                                }
                                            } else if ((*(uint *)(local_18c +
                                                                  300) &
                                                        0x80) == 0) {
                                                *(uint *)(local_18c + 0xa0) =
                                                    local_184;
                                            } else if (piVar13 != (int *)0x0) {
                                                for (;
                                                     (*(int *)(local_18c +
                                                               0xa0) !=
                                                          local_168 &&
                                                      (*piVar13 != local_168));
                                                     local_168 = FUN_00037700(
                                                         iVar14, local_170,
                                                         local_168,
                                                         local_174)) {
                                                    if (piVar13[1] < iVar9) {
                                                        uVar12 = *(
                                                            uint *)(local_18c +
                                                                    300);
                                                        *(uint *)(local_18c +
                                                                  0x88) =
                                                            *(uint
                                                                  *)(local_18c +
                                                                     0x88) &
                                                            0xffffefff;
                                                        goto LAB_0004856c;
                                                    }
                                                    iVar9 = iVar9 + 1;
                                                }
                                                iVar14 = piVar13[1];
                                                *(uint *)(local_18c + 0xa0) =
                                                    local_184;
                                                uVar12 =
                                                    *(uint *)(local_18c + 300) &
                                                    0xffffff7f;
                                                *(uint *)(local_18c + 300) =
                                                    uVar12;
                                                piVar13[1] = iVar14 - iVar9;
                                            LAB_0004856c:
                                                if ((uVar12 & 0x80) != 0) {
                                                    FUN_00036294(0x8c,
                                                                 local_18c,
                                                                 "keylist");
                                                }
                                            }
                                            if ((*(uint *)(local_18c + 0x88) &
                                                 0x400) == 0) {
                                                *(uint *)(local_18c + 300) =
                                                    *(uint *)(local_18c + 300) |
                                                    0x80;
                                            }
                                            if (*(uint *)(local_18c + 0xec) <
                                                current_time) {
                                                FUN_00036294(0x85, local_18c,
                                                             "crypto refresh");
                                                FUN_000467d8(local_18c, "TIME");
                                                goto LAB_00046f18;
                                            }
                                        }
                                        FUN_00045fa0(
                                            local_18c, iVar4,
                                            *(undefined4 *)(param_1 + 0x54));
                                        uVar12 = current_time;
                                        if (*(int *)(local_18c + 0x13c) != 0) {
                                            uVar7 = (uint) *
                                                    (byte *)(local_18c + 0x5e);
                                            uVar8 = (uint) *
                                                    (byte *)(local_18c + 0x40);
                                            uVar15 = local_18c;
                                            if (uVar8 <= uVar7) {
                                                uVar15 = uVar8;
                                            }
                                            *(uint *)(local_18c + 0x230) =
                                                local_140;
                                            *(uint *)(local_18c + 0x234) =
                                                local_13c;
                                            uVar1 =
                                                *(undefined4 *)(param_1 + 0x4c);
                                            if (uVar8 > uVar7) {
                                                uVar15 = uVar7;
                                            }
                                            iVar14 =
                                                *(int *)(local_18c + 0x2d0);
                                            *(undefined4 *)(local_18c + 0x240) =
                                                *(undefined4 *)(param_1 + 0x48);
                                            *(undefined4 *)(local_18c + 0x244) =
                                                uVar1;
                                            if (iVar14 - uVar12 <
                                                (uint)(1 << (uVar15 & 0xff)) >>
                                                1) {
                                                iVar14 = iVar14 + 1;
                                            } else {
                                                iVar14 = iVar14 + -1;
                                            }
                                            *(int *)(local_18c + 0x2d0) =
                                                iVar14;
                                        }
                                        goto LAB_00046f18;
                                    }
                                    if ((*(uint *)(local_18c + 300) & 0x1ff) !=
                                        0) {
                                        uVar1 = FUN_0007d2c0(local_18c + 0x10);
                                        FUN_00075d40(
                                            6,
                                            "receive: Bad auth in packet with "
                                            "bad timestamps from %s denied - "
                                            "spoof?",
                                            uVar1);
                                        goto LAB_00046f18;
                                    }
                                    FUN_00036294(0x8c, local_18c, "digest");
                                    *(uint *)(local_18c + 300) =
                                        *(uint *)(local_18c + 300) | 0x10;
                                    *(int *)(local_18c + 0x2f0) =
                                        *(int *)(local_18c + 0x2f0) + 1;
                                    if ((uVar15 != 0) && (local_190 - 1 < 2)) {
                                        FUN_0001c270(param_1, 1, 0, local_180);
                                    }
                                    iVar14 = unpeer_digest_early;
                                    if ((*(uint *)(local_18c + 0x44) & 2) ==
                                        0) {
                                        if ((peer_clear_digest_early != 0) &&
                                            (*(int *)(local_18c + 0x88) != 0)) {
                                            FUN_000467d8(local_18c,
                                                         &DAT_000a7a18);
                                        }
                                        goto LAB_00046f18;
                                    }
                                }
                            joined_r0x00047eec:
                                if (iVar14 != 0) {
                                    FUN_000424cc(local_18c);
                                }
                                goto LAB_00046f18;
                            }
                            break;
                        case 2:
                            break;
                        case 3:
                            iVar4 = *(int *)(param_1 + 0x3c);
                            if ((*(uint *)(iVar4 + 0x90) & 0x40) == 0) {
                                uVar15 = *(uint *)(param_1 + 0x5c);
                                uVar8 = *(uint *)(param_1 + 0x60);
                                dVar17 = (double)(uVar15 << 0x18 |
                                                  (uVar15 >> 8 & 0xff) << 0x10 |
                                                  (uVar15 >> 0x10 & 0xff) << 8 |
                                                  uVar15 >> 0x18) *
                                         1.52587890625e-05;
                                FUN_00052ebc(
                                    SUB84(dVar17, 0),
                                    (int)((ulonglong)dVar17 >> 0x20),
                                    SUB84((double)(uVar8 << 0x18 |
                                                   (uVar8 >> 8 & 0xff) << 0x10 |
                                                   (uVar8 >> 0x10 & 0xff) << 8 |
                                                   uVar8 >> 0x18) *
                                              1.52587890625e-05,
                                          0),
                                    iVar14, iVar4 + 0x18, &local_148,
                                    &local_140);
                                if ((uVar12 & 4) == 0) {
                                    bVar16 = uVar7 < 2;
                                } else {
                                    bVar16 = uVar7 == 1;
                                }
                                if (bVar16) {
                                LAB_00047874:
                                    FUN_0001c270(param_1, 4, local_184,
                                                 local_180);
                                    goto LAB_00046f18;
                                }
                                if (uVar7 == 2) {
                                    FUN_0001c270(param_1, 4, 0, local_180);
                                    goto LAB_0004798c;
                                }
                            } else if (sys_manycastserver != 0) {
                                iVar9 = FUN_0001c658(local_160, 0);
                                if (((iVar9 == 0) && (sys_leap != '\x03')) &&
                                    ((sys_stratum < uVar15 &&
                                      (((sys_cohort != 0 ||
                                         ((uint)sys_stratum != uVar15 + 1)) &&
                                        (*(int *)(iVar4 + 0x98) !=
                                         *(int *)(param_1 + 100))))))) {
                                    if ((uVar12 & 4) == 0) {
                                        bVar16 = uVar7 < 2;
                                    } else {
                                        bVar16 = uVar7 == 1;
                                    }
                                    if (!bVar16)
                                        goto LAB_00046f18;
                                    uVar12 = *(uint *)(param_1 + 0x5c);
                                    uVar15 = *(uint *)(param_1 + 0x60);
                                    dVar17 =
                                        (double)(uVar12 << 0x18 |
                                                 (uVar12 >> 8 & 0xff) << 0x10 |
                                                 (uVar12 >> 0x10 & 0xff) << 8 |
                                                 uVar12 >> 0x18) *
                                        1.52587890625e-05;
                                    FUN_00052ebc(
                                        SUB84(dVar17, 0),
                                        (int)((ulonglong)dVar17 >> 0x20),
                                        SUB84((double)(uVar15 << 0x18 |
                                                       (uVar15 >> 8 & 0xff)
                                                           << 0x10 |
                                                       (uVar15 >> 0x10 & 0xff)
                                                           << 8 |
                                                       uVar15 >> 0x18) *
                                                  1.52587890625e-05,
                                              0),
                                        iVar14, iVar4 + 0x18, &local_148,
                                        &local_140);
                                    goto LAB_00047874;
                                }
                                break;
                            }
                            goto LAB_0004720c;
                        case 4:
                            iVar4 = FUN_0001c658(local_160, 0);
                            if (iVar4 == 0) {
                                iVar4 = FUN_00043140(param_1);
                                if (iVar4 != 0) {
                                    if ((((*(byte *)(iVar4 + 0x48) & 8) == 0) &&
                                         (sys_authenticate != 0)) ||
                                        ((uVar12 & 0x14) != 0)) {
                                        uVar7 = uVar7 - 1;
                                        if (uVar7 != 0) {
                                            uVar7 = 1;
                                        }
                                    } else {
                                        uVar7 = (uint)(1 < uVar7);
                                    }
                                    if (uVar7 == 0) {
                                        if (((bVar6 != 3) &&
                                             (sys_floor <= (int)uVar15)) &&
                                            (((int)uVar15 < sys_ceiling &&
                                              (iVar14 = FUN_000426dc(
                                                   iVar14, 0,
                                                   *(undefined4 *)(param_1 +
                                                                   0x3c),
                                                   (int)local_14e),
                                               iVar14 != 0)))) {
                                            if ((*(byte *)(iVar4 + 0x48) & 8) !=
                                                0) {
                                                *(uint *)(iVar4 + 0x2d0) =
                                                    current_time + 1;
                                            }
                                            goto LAB_00046f18;
                                        }
                                        break;
                                    }
                                }
                                goto LAB_0004720c;
                            }
                            break;
                        case 5:
                            iVar3 = FUN_0001c658(local_160, sys_ident);
                            if (iVar3 == 0) {
                                if ((uVar12 & 0x14) == 0 &&
                                    sys_authenticate == 0) {
                                    uVar8 = (uint)(1 < uVar7);
                                } else {
                                    uVar8 = uVar7 - 1;
                                    if (uVar8 != 0) {
                                        uVar8 = 1;
                                    }
                                }
                                if (uVar8 == 0) {
                                    if (((uVar12 & 0x20) == 0) &&
                                        (((bVar6 == 3 ||
                                           ((sys_floor <= (int)uVar15 &&
                                             ((int)uVar15 < sys_ceiling)))) &&
                                          (local_18c = FUN_000426dc(
                                               iVar14, 0,
                                               *(undefined4 *)(param_1 + 0x3c),
                                               (int)local_14e),
                                           local_18c != 0))))
                                        goto LAB_00047d88;
                                } else {
                                    if ((uVar12 & 4) == 0) {
                                        bVar16 = uVar7 < 2;
                                    } else {
                                        bVar16 = uVar7 == 1;
                                    }
                                    if (bVar16) {
                                        FUN_0001c270(param_1, 2, local_184,
                                                     local_180);
                                        goto LAB_00046f18;
                                    }
                                    if (uVar7 == 2) {
                                        FUN_0001c270(param_1, 2, 0, local_180);
                                        goto LAB_0004720c;
                                    }
                                }
                            }
                            break;
                        case 6:
                            iVar3 = FUN_0001c658(local_160, sys_ident);
                            if (iVar3 == 0) {
                                if (sys_bclient != 0) {
                                    if ((uVar12 & 0x14) == 0 &&
                                        sys_authenticate == 0) {
                                        uVar8 = (uint)(1 < uVar7);
                                    } else {
                                        uVar8 = uVar7 - 1;
                                        if (uVar8 != 0) {
                                            uVar8 = 1;
                                        }
                                    }
                                    if (uVar8 == 0) {
                                        if (((bVar6 != 3) &&
                                             (sys_floor <= (int)uVar15)) &&
                                            ((int)uVar15 < sys_ceiling)) {
                                            bVar16 = 0xffff < local_184;
                                            if ((crypto_flags == 0 ||
                                                 !bVar16) ||
                                                (local_15c == 0x82010000)) {
                                                iVar3 =
                                                    *(int *)(param_1 + 0x3c);
                                                if ((*(uint *)(iVar3 + 0x90) &
                                                     0x40) != 0) {
                                                    iVar3 = 0;
                                                }
                                                if (sys_bdelay <= 0.0) {
                                                    iVar14 = FUN_000426dc(
                                                        iVar14, 0, iVar3,
                                                        (int)local_14e);
                                                    if (iVar14 != 0) {
                                                        *(uint *)(iVar14 +
                                                                  600) =
                                                            local_138;
                                                        *(uint *)(iVar14 +
                                                                  0x25c) =
                                                            local_134;
                                                        if (bVar16) {
                                                            FUN_00038650(
                                                                iVar14,
                                                                param_1);
                                                        }
                                                        goto LAB_00046f18;
                                                    }
                                                } else if (
                                                    (crypto_flags == 0 ||
                                                     !bVar16) &&
                                                    (local_18c = FUN_000426dc(
                                                         iVar14, 0, iVar3,
                                                         (int)local_14e),
                                                     local_18c != 0)) {
                                                    *(double *)(local_18c +
                                                                0x268) =
                                                        sys_bdelay;
                                                    *(uint *)(local_18c + 600) =
                                                        local_138;
                                                    *(uint *)(local_18c +
                                                              0x25c) =
                                                        local_134;
                                                    goto LAB_00047d88;
                                                }
                                                goto LAB_0004720c;
                                            }
                                        }
                                        break;
                                    }
                                }
                                goto LAB_0004720c;
                            }
                            break;
                        case 0xffffffff:
                        }
                    switchD_00047520_default:
                        sys_declined = sys_declined + 1;
                        goto LAB_00046f18;
                    }
                    goto LAB_0004720c;
                }
            }
        LAB_00046f04:
            sys_badlength = sys_badlength + 1;
            goto LAB_00046f18;
        }
    }
LAB_0004720c:
    sys_restricted = sys_restricted + 1;
LAB_00046f18:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00048e94(undefined4 param_1, undefined4 param_2)

{
    bool bVar1;
    double dVar2;
    int iVar3;
    double dVar4;

    iVar3 = __stack_chk_guard;
    dVar2 = (double)CONCAT44(param_2, param_1);
    if ((double)CONCAT44(param_2, param_1) != 1.0 &&
        1.0 <= (double)CONCAT44(param_2, param_1)) {
        FUN_00075d40(3, "unsupported tick %.3f > 1s ignored", param_1, param_2);
        return;
    }
    bVar1 = (double)CONCAT44(param_2, param_1) < measured_tick;
    if (bVar1) {
        FUN_00075d40(3,
                     "proto: tick %.3f less than measured tick %.3f, ignored",
                     param_1, param_2, measured_tick);
    } else {
        if ((double)CONCAT44(param_2, param_1) != measured_tick && !bVar1) {
            trunc_os_clock = 1;
            FUN_00075d40(5,
                         "proto: truncating system clock to multiples of %.9f",
                         param_1, param_2);
        }
        sys_precision = '\0';
        for (dVar4 = dVar2; dVar4 <= 1.0; dVar4 = dVar4 + dVar4) {
            sys_precision = sys_precision + -1;
        }
        sys_tick = dVar2;
        if (1.0 - dVar4 * 0.5 < dVar4 - 1.0) {
            sys_precision = sys_precision + '\x01';
        }
    }
    if (iVar3 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00049000(undefined4 param_1, int param_2, short *param_3)

{
    undefined4 *puVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    uint uVar5;
    int iVar6;
    uint uVar7;
    int *piVar8;
    undefined4 *__ptr;
    undefined4 uVar9;
    short sVar10;
    undefined4 uVar11;
    undefined4 *puVar12;
    double in_d0;
    undefined4 local_48;
    undefined4 local_44;
    undefined4 local_40;
    undefined4 uStack_3c;
    undefined4 uStack_38;
    undefined4 uStack_34;
    undefined4 local_30;
    int local_2c;
    int *local_28;
    int iStack_24;

    iVar6 = __stack_chk_guard;
    switch (param_1) {
    case 1:
        if (param_2 != 0) {
            sys_bclient = param_2;
            FUN_00026470();
            return;
        }
        sys_bclient = 0;
        piVar8 = ep_list;
        if (ep_list != (int *)0x0) {
            do {
                uVar7 = piVar8[0x24];
                if (((uVar7 & 0x80) == 0) && ((uVar7 & 0x20) != 0)) {
                    if (piVar8[4] != -1) {
                        uVar3 = FUN_0007d2c0(piVar8 + 0x14);
                        local_28 = piVar8 + 0x1b;
                        FUN_00075d40(6,
                                     "stop listening for broadcasts to %s on "
                                     "interface #%d %s",
                                     uVar3, piVar8[5]);
                        FUN_00025be0(piVar8[4]);
                        uVar7 = piVar8[0x24];
                        piVar8[4] = -1;
                    }
                    piVar8[0x24] = uVar7 & 0xffffffdf;
                }
                piVar8 = (int *)*piVar8;
            } while (piVar8 != (int *)0x0);
        }
        broadcast_client_enabled = 0;
        if (iVar6 != __stack_chk_guard) {
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
        return;
    case 2:
    default:
    code_r0x0004938c:
        FUN_00075d40(5, "proto: unsupported option %d", param_1);
        return;
    case 3:
        sys_authenticate = param_2;
        break;
    case 4:
        sys_bdelay = in_d0;
        if (in_d0 == 0.0) {
            sys_bdelay = -0.05;
        }
        break;
    case 5:
        goto code_r0x0004938c;
    case 6:
        if (param_3 != (short *)0x0) {
            FUN_00026740(param_3);
        }
        sys_bclient = 1;
        break;
    case 7:
        if (param_3 != (short *)0x0) {
            sVar10 = *param_3;
            local_2c = __stack_chk_guard;
            if (sVar10 == 2) {
                iVar6 = (*(uint *)(param_3 + 2) & 0xf0) - 0xe0;
            } else {
                iVar6 = *(byte *)(param_3 + 4) - 0xff;
            }
            if (iVar6 == 0) {
            LAB_00026a64:
                iVar6 = FUN_00025414(param_3);
                if (iVar6 != 0) {
                    while (true) {
                        local_48 = 0;
                        local_44 = 0;
                        iVar2 = FUN_00023ff0(param_3);
                        if (iVar2 == 0)
                            break;
                        if (sVar10 == 2) {
                            local_48 = *(undefined4 *)(param_3 + 2);
                            local_44 = *(undefined4 *)(iVar6 + 0x1c);
                            iVar2 = setsockopt(*(int *)(iVar6 + 0xc), 0, 0x24,
                                               &local_48, 8);
                            if (iVar2 != 0) {
                                uVar9 = *(undefined4 *)(iVar6 + 0xc);
                                uVar3 = FUN_0007d2c0(iVar6 + 0x18);
                                uVar7 = *(uint *)(iVar6 + 0x1c);
                                uVar5 = *(uint *)(param_3 + 2);
                                uVar4 = FUN_0007d2c0(param_3);
                                FUN_00075d40(
                                    3,
                                    "setsockopt IP_DROP_MEMBERSHIP failed: %m "
                                    "on socket %d, addr %s for %x / %x (%s)",
                                    uVar9, uVar3,
                                    uVar5 << 0x18 |
                                        (uVar5 >> 8 & 0xff) << 0x10 |
                                        (uVar5 >> 0x10 & 0xff) << 8 |
                                        uVar5 >> 0x18,
                                    uVar7 << 0x18 |
                                        (uVar7 >> 8 & 0xff) << 0x10 |
                                        (uVar7 >> 0x10 & 0xff) << 8 |
                                        uVar7 >> 0x18,
                                    uVar4);
                                sVar10 = *param_3;
                                break;
                            }
                        } else if (sVar10 == 10) {
                            local_30 = *(undefined4 *)(iVar6 + 0xb0);
                            local_40 = *(undefined4 *)(param_3 + 4);
                            uStack_3c = *(undefined4 *)(param_3 + 6);
                            uStack_38 = *(undefined4 *)(param_3 + 8);
                            uStack_34 = *(undefined4 *)(param_3 + 10);
                            iVar2 = setsockopt(*(int *)(iVar6 + 0xc), 0x29,
                                               0x15, &local_40, 0x14);
                            if (iVar2 != 0) {
                                uVar11 = *(undefined4 *)(iVar6 + 0xc);
                                uVar3 = FUN_0007d2c0(iVar6 + 0x18);
                                uVar9 = *(undefined4 *)(iVar6 + 0xb0);
                                uVar4 = FUN_0007d2c0(param_3);
                                FUN_00075d40(
                                    3,
                                    "setsockopt IPV6_LEAVE_GROUP failure: %m "
                                    "on socket %d, addr %s for %d (%s)",
                                    uVar11, uVar3, uVar9, uVar4);
                                sVar10 = *param_3;
                                break;
                            }
                        }
                        iVar2 = *(int *)(iVar6 + 0x9c) + -1;
                        *(int *)(iVar6 + 0x9c) = iVar2;
                        if (iVar2 == 0) {
                            *(uint *)(iVar6 + 0x90) =
                                *(uint *)(iVar6 + 0x90) & 0xffffffbf;
                        }
                        iVar6 = FUN_00025414(param_3);
                        sVar10 = *param_3;
                        if (iVar6 == 0)
                            goto LAB_00026b10;
                    }
                    goto LAB_00026a64;
                }
            LAB_00026b10:
                puVar1 = remoteaddr_list;
                puVar12 = &remoteaddr_list;
                do {
                    __ptr = puVar1;
                    if (*(short *)(__ptr + 1) == sVar10) {
                        if (sVar10 == 2) {
                            iVar6 = *(int *)(param_3 + 2) - __ptr[2];
                            if (iVar6 != 0) {
                                iVar6 = 1;
                            }
                        } else {
                            iVar6 = memcmp(param_3 + 4, __ptr + 3, 0x10);
                            if (iVar6 != 0)
                                goto LAB_00026b24;
                            iVar6 = *(int *)(param_3 + 0xc) - __ptr[7];
                            if (iVar6 != 0) {
                                iVar6 = 1;
                            }
                        }
                        if (iVar6 == 0) {
                            *puVar12 = *__ptr;
                            free(__ptr);
                            break;
                        }
                    }
                LAB_00026b24:
                    puVar1 = (undefined4 *)*__ptr;
                    puVar12 = __ptr;
                } while ((undefined4 *)*__ptr != (undefined4 *)0x0);
            } else {
                uVar3 = FUN_0007d2c0();
                FUN_00075d40(3, "invalid multicast address %s", uVar3);
            }
            if (local_2c != __stack_chk_guard) {
                /* WARNING: Subroutine does not return */
                __stack_chk_fail();
            }
            return;
        }
        break;
    case 8:
        ntp_enable = param_2;
        break;
    case 9:
        if (kern_enable != param_2) {
            uVar7 = pll_control;
            if (pll_control != 0) {
                uVar7 = 1;
            }
            if (param_2 == 0) {
                uVar5 = uVar7 & 1;
            } else {
                uVar5 = 0;
            }
            if ((uVar5 != 0) &&
                (iStack_24 = param_2, FUN_0003ed68(), param_2 = iStack_24,
                 uVar7 = pll_control, pll_control != 0)) {
                uVar7 = 1;
            }
            if (param_2 == 0) {
                uVar7 = 0;
            } else {
                uVar7 = uVar7 & 1;
            }
            kern_enable = param_2;
            if (uVar7 != 0) {
                FUN_0003f49c();
            }
            if ((pll_control != 0) && (DAT_000cbe74 != 0)) {
                if (iVar6 == __stack_chk_guard) {
                    FUN_0003f724((int)drift_comp);
                    return;
                }
                goto LAB_00040a50;
            }
        }
        if (iVar6 == __stack_chk_guard) {
            return;
        }
    LAB_00040a50:
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    case 10:
        if (param_2 != 0) {
            FUN_000411c4(1);
            return;
        }
        FUN_000412e8(1);
        if (mon_enabled != 0) {
            if (iVar6 == __stack_chk_guard) {
                FUN_00075d40(4, "restrict: \'monitor\' cannot be disabled "
                                "while \'limited\' is enabled");
                return;
            }
            goto LAB_000493dc;
        }
        break;
    case 0xb:
        stats_control = param_2;
        break;
    case 0xc:
        hardpps_enable = param_2;
        break;
    case 0xd:
        cal_enable = param_2;
        break;
    case 0xe:
        sys_minclock = (undefined4)(longlong)in_d0;
        break;
    case 0xf:
        sys_maxclock = (undefined4)(longlong)in_d0;
        break;
    case 0x10:
        sys_minsane = (undefined4)(longlong)in_d0;
        break;
    case 0x11:
        sys_floor = (undefined4)(longlong)in_d0;
        break;
    case 0x12:
        sys_ceiling = (undefined4)(longlong)in_d0;
        break;
    case 0x13:
        sys_cohort = (undefined4)(longlong)in_d0;
        break;
    case 0x14:
        break;
    case 0x15:
        sys_mindisp = in_d0;
        break;
    case 0x16:
        sys_maxdist = in_d0;
        break;
    case 0x17:
        goto code_r0x0004938c;
    case 0x18:
        goto code_r0x0004938c;
    case 0x19:
        sys_beacon = (undefined4)(longlong)in_d0;
        break;
    case 0x1a:
        sys_orphan = (undefined4)(longlong)in_d0;
        break;
    case 0x1b:
        orphwait = (orphwait - sys_orphwait) + (int)(longlong)in_d0;
        sys_orphwait = (int)(longlong)in_d0;
        break;
    case 0x1c:
        ntp_mode7 = param_2;
        break;
    case 0x1d:
        unpeer_crypto_early = param_2;
        break;
    case 0x1e:
        unpeer_crypto_nak_early = param_2;
        break;
    case 0x1f:
        unpeer_digest_early = param_2;
        break;
    case 0x20:
        peer_clear_digest_early = param_2;
        break;
    case 0x21:
        sys_bcpollbstep = (0.0 < in_d0) * (char)(longlong)in_d0;
    }
    if (iVar6 == __stack_chk_guard) {
        return;
    }
LAB_000493dc:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00049544) */

void FUN_00049460(void)

{
    sys_stattime = current_time;
    sys_received = 0;
    sys_processed = 0;
    sys_newversion = 0;
    sys_oldversion = 0;
    sys_declined = 0;
    sys_restricted = 0;
    sys_badlength = 0;
    sys_badauth = 0;
    sys_limitrejected = 0;
    sys_kodsent = 0;
    sys_lamport = 0;
    sys_tsrounding = 0;
    return;
}

void FUN_00049588(void)

{
    uint uVar1;
    int iVar2;
    uint uVar3;
    int iVar4;
    int iVar5;
    int iVar6;
    int iVar7;
    int iVar8;
    uint uVar9;
    bool bVar10;
    bool bVar11;
    double dVar12;
    double dVar13;
    int local_4c;
    uint local_48;
    int local_44;
    uint local_40;
    int local_3c;

    iVar7 = 0;
    dVar13 = 1.0;
    iVar5 = 0;
    iVar8 = 0;
    local_3c = __stack_chk_guard;
    FUN_00043adc(3);
    sys_stratum = 0x10;
    sys_refid = 0x54494e49;
    sys_peer = 0;
    sys_rootdelay = 0;
    sys_rootdisp = 0;
    sys_reftime._4_4_ = 0;
    sys_reftime._0_4_ = 0;
    sys_jitter = 0;
    FUN_00070434(0);
    trunc_os_clock = 0;
    FUN_0007055c(&local_44);
    iVar4 = 0;
    do {
        FUN_0007055c(&local_4c);
        uVar9 = local_48 - local_40;
        uVar3 = local_4c - local_44;
        if (local_48 < uVar9) {
            uVar3 = uVar3 - 1;
        }
        local_44 = local_4c;
        local_40 = local_48;
        if ((uVar3 + 0x80000000 < 0x80000001) && (uVar9 < 0x56 || uVar3 != 0)) {
            iVar5 = iVar5 + 1;
        } else {
            uVar1 = -((int)uVar3 >> 0x1f);
            if (iVar8 < iVar5) {
                iVar8 = iVar5;
            }
            iVar7 = iVar7 + 1;
            uVar9 = (int)uVar3 >> 0x1f ^ uVar9;
            iVar5 = 0;
            dVar12 = (double)FUN_0009d40c(uVar9 + uVar1,
                                          (-(uint)(uVar1 != 0) ^ uVar3) +
                                              (uint)CARRY4(uVar9, uVar1));
            dVar12 = ldexp(dVar12, -0x20);
            if (uVar1 != 0) {
                dVar12 = -dVar12;
            }
            if (dVar12 < dVar13) {
                dVar13 = dVar12;
            }
        }
        iVar6 = iVar4 + 1;
        bVar11 = SBORROW4(iVar7, 0xb);
        iVar2 = iVar7 + -0xb;
        bVar10 = iVar7 == 0xb;
        if (iVar7 < 0xc) {
            bVar11 = SBORROW4(iVar6, 49999999);
            iVar2 = iVar4 + -0x2faf07e;
            bVar10 = iVar6 == 49999999;
        }
        iVar4 = iVar6;
    } while (bVar10 || iVar2 < 0 != bVar11);
    if (0xb < iVar7) {
        dVar12 = dVar13;
        if (iVar8 != 0) {
            dVar12 = dVar13 / (double)(longlong)iVar8;
        }
        FUN_00070434(SUB84(dVar12, 0));
        measured_tick = dVar13;
        FUN_00048e94(SUB84(dVar13, 0));
        iVar4 = (int)sys_precision;
        FUN_00075d40(6, "proto: precision = %.3f usec (%d)",
                     SUB84(sys_tick * 1000000.0, 0),
                     (int)((ulonglong)(sys_tick * 1000000.0) >> 0x20), iVar4);
        if (sys_fuzz < sys_tick) {
            FUN_00075d40(5, "proto: fuzz beneath %.3f usec",
                         SUB84(sys_fuzz * 1000000.0, 0),
                         (int)((ulonglong)(sys_fuzz * 1000000.0) >> 0x20),
                         iVar4);
        }
        FUN_0007055c(&local_44);
        sys_survivors = 0;
        sys_manycastserver = 0;
        sys_bclient = 0;
        sys_bdelay._0_4_ = 0x9999999a;
        sys_bdelay._4_4_ = 0xbfa99999;
        sys_authenticate = 1;
        sys_stattime = current_time;
        orphwait = sys_orphwait + current_time;
        FUN_00049460();
        sys_ttl._3_1_ = 0x60;
        sys_ttl._0_1_ = 0;
        sys_ttl._1_1_ = 0x20;
        sys_ttl._2_1_ = 0x40;
        sys_ttl._4_1_ = 0x80;
        sys_ttl._5_1_ = 0xa0;
        sys_ttl._6_1_ = 0xc0;
        sys_ttl._7_1_ = 0xe0;
        sys_ttlmax = 7;
        hardpps_enable = 0;
        stats_control = 1;
        if (local_3c != __stack_chk_guard) {
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
        return;
    }
    FUN_00075d40(
        3, "Fatal error: precision could not be measured (MINSTEP too large?)");
    /* WARNING: Subroutine does not return */
    exit(1);
}

/* WARNING: Removing unreachable block (ram,0x00049c5c) */
/* WARNING: Removing unreachable block (ram,0x00049c48) */

void FUN_00049a28(int param_1)

{
    double *pdVar1;
    undefined4 uVar2;
    uint uVar3;
    int iVar4;
    uint uVar5;
    int iVar6;
    uint uVar7;
    size_t __nmemb;
    size_t sVar8;
    double *pdVar9;
    int iVar10;
    undefined8 *puVar11;
    size_t sVar12;
    bool bVar13;
    double dVar14;
    double dVar15;
    double dVar16;
    double in_d19;
    undefined8 local_218;
    int local_34;

    iVar6 = *(int *)(param_1 + 0xdc);
    iVar10 = *(int *)(param_1 + 0xd8);
    pdVar9 = (double *)&local_218;
    local_34 = __stack_chk_guard;
    if (iVar6 == iVar10) {
        __nmemb = 0;
    } else {
        __nmemb = 0;
        puVar11 = &local_218;
        do {
            __nmemb = __nmemb + 1;
            iVar6 = (iVar6 + 1) % 0x3c;
            iVar4 = param_1 + iVar6 * 8;
            uVar2 = *(undefined4 *)(iVar4 + 0x10c);
            *(undefined4 *)puVar11 = *(undefined4 *)(iVar4 + 0x108);
            *(undefined4 *)((int)puVar11 + 4) = uVar2;
            puVar11 = (undefined8 *)((int)puVar11 + 8);
        } while (iVar6 != iVar10);
        *(int *)(param_1 + 0xdc) = iVar6;
        if (__nmemb != 1) {
            qsort(&local_218, __nmemb, 8, (__compar_fn_t)&DAT_000499c0);
        }
        uVar3 = __nmemb - (__nmemb * 4) / 10;
        sVar12 = __nmemb;
        for (uVar5 = 0; pdVar1 = (double *)(&local_218 + sVar12),
            sVar8 = sVar12, uVar3 < sVar12 - uVar5;
             uVar5 = uVar5 + 1) {
            while (true) {
                pdVar1 = pdVar1 + -1;
                sVar12 = sVar8 - 1;
                if (*pdVar1 - (double)(&local_218)[sVar8 + uVar5 >> 1] <
                    (double)(&local_218)[sVar8 + uVar5 >> 1] - *pdVar9)
                    break;
                sVar8 = sVar12;
                if (sVar12 - uVar5 <= uVar3)
                    goto LAB_00049b54;
            }
            pdVar9 = pdVar9 + 1;
            sVar12 = sVar8;
        }
    LAB_00049b54:
        dVar15 = 0.0;
        *(undefined8 *)(param_1 + 0xf0) = 0;
        *(undefined8 *)(param_1 + 0x100) = 0;
        dVar16 = dVar15;
        if (uVar5 < sVar12) {
            dVar16 = (double)(&local_218)[uVar5] + 0.0;
            *(double *)(param_1 + 0xf0) = dVar16;
            uVar7 = uVar5;
            pdVar9 = (double *)(&local_218 + uVar5 + 1);
            while (uVar7 = uVar7 + 1, uVar7 != sVar12) {
                dVar14 = *pdVar9;
                pdVar1 = pdVar9 + 1;
                bVar13 = uVar5 < uVar7;
                if (bVar13) {
                    in_d19 = pdVar9[-1];
                }
                dVar16 = dVar16 + dVar14;
                if (bVar13) {
                    dVar14 = dVar14 - in_d19;
                }
                *(double *)(param_1 + 0xf0) = dVar16;
                if (bVar13) {
                    dVar15 = dVar15 + dVar14 * dVar14;
                }
                pdVar9 = pdVar1;
                if (bVar13) {
                    *(double *)(param_1 + 0x100) = dVar15;
                }
            }
        }
        dVar14 = (double)uVar3;
        *(double *)(param_1 + 0xf0) = dVar16 / dVar14;
        dVar16 = ldexp(1.0, (int)sys_precision);
        if (dVar16 < SQRT(dVar15 / dVar14)) {
            dVar16 = SQRT(*(double *)(param_1 + 0x100) / dVar14);
        } else {
            dVar16 = ldexp(1.0, (int)sys_precision);
        }
        *(double *)(param_1 + 0x100) = dVar16;
    }
    if (local_34 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__nmemb);
    }
    return;
}

void FUN_00049c88(int param_1, uint param_2)

{
    int iVar1;
    undefined4 uVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = *(int *)(param_1 + 0x54);
    if (iVar3 == 0)
        goto LAB_00049d50;
    switch (param_2) {
    case 1:
        *(int *)(iVar3 + 0x30c) = *(int *)(iVar3 + 0x30c) + 1;
        break;
    case 2:
        *(int *)(iVar3 + 0x310) = *(int *)(iVar3 + 0x310) + 1;
        break;
    case 3:
    default:
    switchD_00049cc0_default:
        if (param_2 != 0)
            break;
        if (*(char *)(iVar3 + 0x29) != '\0')
            goto LAB_00049cf4;
        goto LAB_00049d50;
    case 4:
        goto switchD_00049cc0_default;
    case 5:
        goto LAB_00049d78;
    case 6:
    LAB_00049d78:
        *(int *)(iVar3 + 0x314) = *(int *)(iVar3 + 0x314) + 1;
    }
    if (*(byte *)(iVar3 + 0x2a) < 0xf) {
        *(byte *)(iVar3 + 0x2a) = *(byte *)(iVar3 + 0x2a) + 1;
    }
    if (*(byte *)(iVar3 + 0x29) == param_2) {
    LAB_00049d50:
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else {
    LAB_00049cf4:
        *(char *)(iVar3 + 0x29) = (char)param_2;
        uVar2 = FUN_0007e458(param_2);
        if (iVar1 == __stack_chk_guard) {
            FUN_00036294(0x8b, param_1, uVar2);
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00049d94(void)

{
    int iVar1;
    int iVar2;
    int *piVar3;

    iVar1 = __stack_chk_guard;
    if (num_refclock_conf != 0) {
        iVar2 = 0;
        piVar3 = (int *)refclock_conf;
        do {
            if (*(code **)(*piVar3 + 0x10) != (code *)0x0) {
                (**(code **)(*piVar3 + 0x10))();
            }
            iVar2 = iVar2 + 1;
            piVar3 = piVar3 + 1;
        } while (iVar2 < (int)(uint)num_refclock_conf);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00049e24(int param_1)

{
    int iVar1;
    void *__ptr;

    iVar1 = __stack_chk_guard;
    __ptr = *(void **)(param_1 + 0x54);
    if (__ptr != (void *)0x0) {
        if (*(code **)(*(int *)(refclock_conf +
                                (uint) * (byte *)(param_1 + 0x58) * 4) +
                       4) != (code *)0x0) {
            (**(code **)(*(int *)(refclock_conf +
                                  (uint) * (byte *)(param_1 + 0x58) * 4) +
                         4))(*(undefined1 *)(param_1 + 0x59), param_1);
            __ptr = *(void **)(param_1 + 0x54);
        }
        free(__ptr);
        *(undefined4 *)(param_1 + 0x54) = 0;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00049eb8(int param_1)

{
    uint uVar1;
    undefined1 uVar2;
    int iVar3;
    undefined4 uVar4;
    int iVar5;
    int iVar6;
    undefined4 uVar7;
    int *piVar8;
    uint uVar9;

    iVar3 = __stack_chk_guard;
    if (*(short *)(param_1 + 0x10) == 2) {
        uVar9 = *(uint *)(param_1 + 0x14);
        uVar1 = uVar9 >> 0x10 & 0xff;
        if ((uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10) == 0x7f7f0000) {
            if ((uVar1 < num_refclock_conf) &&
                (piVar8 = *(int **)(refclock_conf + uVar1 * 4), *piVar8 != 0)) {
                iVar5 = FUN_00074b04(0, 0x318, 0, 1);
                *(undefined1 *)(param_1 + 0x5e) =
                    *(undefined1 *)(param_1 + 0x42);
                *(char *)(param_1 + 0x59) = (char)(uVar9 >> 0x18);
                *(undefined1 *)(param_1 + 0x5d) = 0;
                uVar2 = (undefined1)(uVar9 >> 0x10);
                *(undefined1 *)(param_1 + 0x58) = uVar2;
                *(uint *)(param_1 + 0x44) = *(uint *)(param_1 + 0x44) | 8;
                *(int *)(param_1 + 0x54) = iVar5;
                *(undefined1 *)(param_1 + 0x5b) = 3;
                *(undefined1 *)(iVar5 + 0x2b) = uVar2;
                *(int **)(iVar5 + 4) = piVar8;
                *(undefined4 *)(iVar5 + 0x1c) = 0xffffffff;
                *(undefined4 *)(iVar5 + 0x304) = current_time;
                if (*(char *)(param_1 + 0x3f) == '\x01') {
                    *(undefined1 *)(param_1 + 0x5c) = 2;
                } else {
                    *(undefined1 *)(param_1 + 0x5c) = 4;
                }
                iVar6 = (*(code *)*piVar8)(uVar9 >> 0x18, param_1);
                if (iVar6 == 0) {
                    FUN_00049e24(param_1);
                    uVar7 = 0;
                } else {
                    uVar7 = 1;
                    *(undefined4 *)(param_1 + 0x70) =
                        *(undefined4 *)(iVar5 + 0x2fc);
                }
            } else {
                uVar7 = 0;
                FUN_00075d40(3, "refclock_newpeer: clock type %d invalid\n",
                             uVar1);
            }
            goto LAB_00049f28;
        }
    }
    uVar7 = 0;
    uVar4 = FUN_0007d2c0(param_1 + 0x10);
    FUN_00075d40(3, "refclock_newpeer: clock address %s invalid", uVar4);
LAB_00049f28:
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar7);
    }
    return;
}

void FUN_0004a064(int param_1)

{
    int iVar1;
    code *pcVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = *(int *)(param_1 + 0x54);
    pcVar2 = *(code **)(*(int *)(iVar3 + 4) + 0x18);
    if (pcVar2 != (code *)0x0) {
        (*pcVar2)(*(undefined1 *)(param_1 + 0x59), param_1);
    }
    if ((*(code **)(iVar3 + 0x34) == (code *)0x0) ||
        (current_time < *(uint *)(iVar3 + 0x30))) {
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        /* WARNING: Could not recover jumptable at 0x0004a100. Too many branches
         */
        /* WARNING: Treating indirect jump as call */
        (**(code **)(iVar3 + 0x34))(param_1);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0004a114(int param_1)

{
    byte bVar1;
    byte bVar2;
    undefined1 uVar3;
    byte bVar4;
    int iVar5;

    bVar2 = *(byte *)(param_1 + 0x58);
    *(int *)(param_1 + 0x2e4) = *(int *)(param_1 + 0x2e4) + 1;
    iVar5 = __stack_chk_guard;
    uVar3 = *(undefined1 *)(param_1 + 0x59);
    FUN_0007055c(param_1 + 0x238);
    if (*(int *)(param_1 + 0x134) == 0) {
        bVar4 = *(byte *)(param_1 + 0x12a);
        bVar1 = bVar4 << 1;
        *(byte *)(param_1 + 0x12a) = bVar1;
        if ((bVar1 & 0xe) == 0) {
            FUN_00045af4(0, param_1);
            *(undefined4 *)(param_1 + 0x2cc) = current_time;
            if (*(char *)(param_1 + 0x12a) == '\0') {
                if ((bVar4 & 0xfe) != 0) {
                    FUN_00036294(0x83, param_1);
                    *(undefined4 *)(param_1 + 0x2e0) = current_time;
                }
                goto LAB_0004a1a0;
            }
        } else {
            *(undefined4 *)(param_1 + 0x2cc) = current_time;
        }
        if ((*(uint *)(param_1 + 0x44) & 0x40) != 0) {
            *(undefined4 *)(param_1 + 0x134) = 5;
        }
    } else {
        *(int *)(param_1 + 0x134) = *(int *)(param_1 + 0x134) + -1;
    }
LAB_0004a1a0:
    if (*(code **)(*(int *)(refclock_conf + (uint)bVar2 * 4) + 8) !=
        (code *)0x0) {
        (**(code **)(*(int *)(refclock_conf + (uint)bVar2 * 4) + 8))(uVar3,
                                                                     param_1);
    }
    if (iVar5 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    FUN_000448c4(param_1, *(undefined1 *)(param_1 + 0x40));
    return;
}

void FUN_0004a258(int param_1, int param_2, uint param_3, int param_4,
                  int param_5)

{
    uint uVar1;
    int iVar2;
    int iVar3;
    uint uVar4;
    int iVar5;
    int iVar6;
    uint uVar7;
    double in_d0;
    double dVar8;

    iVar2 = __stack_chk_guard;
    uVar4 = param_2 - param_4;
    if (param_3 < param_3 - param_5) {
        uVar4 = uVar4 - 1;
    }
    uVar1 = -((int)uVar4 >> 0x1f);
    uVar7 = (int)uVar4 >> 0x1f ^ param_3 - param_5;
    *(int *)(param_1 + 0xe8) = param_4;
    *(int *)(param_1 + 0xec) = param_5;
    dVar8 = (double)FUN_0009d40c(uVar7 + uVar1, (-(uint)(uVar1 != 0) ^ uVar4) +
                                                    (uint)CARRY4(uVar7, uVar1));
    dVar8 = ldexp(dVar8, -0x20);
    iVar3 = -0x77777777;
    iVar5 = *(int *)(param_1 + 0xdc);
    iVar6 = (*(int *)(param_1 + 0xd8) + 1) % 0x3c;
    *(int *)(param_1 + 0xd8) = iVar6;
    if (uVar1 != 0) {
        dVar8 = -dVar8;
    }
    *(double *)(param_1 + iVar6 * 8 + 0x108) = dVar8 + in_d0;
    if (iVar6 == iVar5) {
        iVar3 = (iVar6 + 1) * -0x77777777;
        *(int *)(param_1 + 0xdc) = (iVar6 + 1) % 0x3c;
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar3);
}

void FUN_0004a3b0(int param_1)

{
    bool bVar1;
    int iVar2;
    uint uVar3;
    uint uVar4;
    uint uVar5;
    double dVar6;
    undefined8 uVar7;
    int local_3c;
    uint local_38;
    int local_34;

    local_34 = __stack_chk_guard;
    iVar2 = FUN_00074318(
        *(undefined4 *)(param_1 + 0xc0), *(undefined4 *)(param_1 + 0xc4),
        *(undefined4 *)(param_1 + 200), *(undefined4 *)(param_1 + 0xcc), 0,
        *(undefined4 *)(param_1 + 0xe8), param_1 + 0xd4, &local_3c);
    if (iVar2 != 0) {
        local_38 = 0;
        dVar6 = (double)(longlong) * (int *)(param_1 + 0xd0) / 1000000000.0;
        bVar1 = dVar6 < 0.0;
        if (bVar1) {
            dVar6 = -dVar6;
        }
        uVar5 = (uint)bVar1;
        dVar6 = ldexp(dVar6, 0x20);
        uVar7 = FUN_0009d558(SUB84(dVar6, 0), (int)((ulonglong)dVar6 >> 0x20));
        uVar4 = (uint)uVar7 ^ -uVar5;
        uVar3 = local_38 + uVar4 + uVar5;
        local_3c = local_3c +
                   ((uint)((ulonglong)uVar7 >> 0x20) ^ -(uint)(uVar5 != 0)) +
                   (uint)CARRY4(uVar4, uVar5);
        if (uVar3 < local_38) {
            local_3c = local_3c + 1;
        }
        local_38 = uVar3;
        FUN_0004a258(param_1, local_3c, uVar3, *(undefined4 *)(param_1 + 0xe8),
                     *(undefined4 *)(param_1 + 0xec));
        iVar2 = 1;
    }
    if (local_34 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2);
}

/* WARNING: Removing unreachable block (ram,0x0004a528) */

void FUN_0004a4e8(int param_1)

{
    FUN_0004a3b0((int)*(undefined8 *)(param_1 + 0x2e8));
    return;
}

/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x0004a604 */
/* WARNING: Restarted to delay deadcode elimination for space: register */

void FUN_0004a534(int param_1)

{
    char cVar1;
    byte bVar2;
    int iVar3;
    int iVar4;
    undefined4 uVar5;
    int iVar6;
    undefined4 uVar7;
    undefined4 uVar8;
    bool bVar9;
    undefined4 in_s3;
    double dVar10;

    iVar3 = __stack_chk_guard;
    iVar6 = *(int *)(param_1 + 0x54);
    cVar1 = *(char *)(iVar6 + 0x28);
    *(char *)(param_1 + 0x5b) = cVar1;
    if (cVar1 != '\x03') {
        bVar2 = *(byte *)(param_1 + 0x12a);
        *(int *)(param_1 + 0x2e8) = *(int *)(param_1 + 0x2e8) + 1;
        *(undefined4 *)(param_1 + 0x2dc) = current_time;
        if (bVar2 == 0) {
            FUN_00036294(0x84, param_1);
            bVar2 = *(byte *)(param_1 + 0x12a);
            *(undefined4 *)(param_1 + 0x2e0) = current_time;
        }
        *(byte *)(param_1 + 0x12a) = bVar2 | 1;
        uVar5 = *(undefined4 *)(iVar6 + 0xe4);
        uVar7 = *(undefined4 *)(iVar6 + 0xf8);
        uVar8 = *(undefined4 *)(iVar6 + 0xfc);
        *(undefined4 *)(param_1 + 0x74) = *(undefined4 *)(iVar6 + 0xe0);
        *(undefined4 *)(param_1 + 0x78) = uVar5;
        uVar5 = *(undefined4 *)(iVar6 + 0xec);
        *(undefined4 *)(param_1 + 0x248) = *(undefined4 *)(iVar6 + 0xe8);
        *(undefined4 *)(param_1 + 0x24c) = uVar5;
        *(undefined4 *)(param_1 + 0x68) = uVar7;
        *(undefined4 *)(param_1 + 0x6c) = uVar8;
        FUN_0007055c(param_1 + 0x240);
        iVar4 = FUN_00049a28(iVar6);
        if ((((iVar4 != 0) &&
              (FUN_00045af4(
                   (int)*(undefined8 *)(iVar6 + 0xf0),
                   (int)((ulonglong) * (undefined8 *)(iVar6 + 0xf0) >> 0x20), 0,
                   in_s3, (int)*(undefined8 *)(iVar6 + 0x100), param_1),
               cal_enable != 0)) &&
             (dVar10 = ABS(last_offset), dVar10 < sys_mindisp)) &&
            ((sys_peer != 0 && (*(char *)(sys_peer + 0x58) == '\x16')))) {
            bVar9 = *(char *)(param_1 + 0x58) != '\x16';
            if (bVar9) {
                dVar10 = *(double *)(iVar6 + 0x2e8);
            }
            if (bVar9) {
                dVar10 = dVar10 - *(double *)(iVar6 + 0xf0) * 0.1;
            }
            if (bVar9) {
                *(double *)(iVar6 + 0x2e8) = dVar10;
            }
        }
    }
    if (iVar3 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0004a6d4(int param_1, undefined1 *param_2, int param_3,
                  undefined4 *param_4)

{
    byte bVar1;
    int iVar2;
    undefined4 uVar3;
    int iVar4;
    undefined1 *puVar5;
    byte *pbVar6;
    byte *pbVar7;

    iVar2 = __stack_chk_guard;
    if (param_3 < 1) {
        iVar4 = 0;
    } else {
        iVar4 = *(int *)(param_1 + 0x54);
        puVar5 = param_2;
        pbVar7 = (byte *)(param_1 + 0x58);
        while (puVar5 != param_2 + param_3 + -1 &&
               pbVar7 != (byte *)(param_1 + 0x58) + iVar4) {
            pbVar6 = pbVar7 + 1;
            bVar1 = *pbVar7;
            pbVar7 = pbVar6;
            if ((bVar1 & 0x7f) - 0x20 < 0x5f) {
                *puVar5 = (char)(bVar1 & 0x7f);
                puVar5 = puVar5 + 1;
            }
        }
        iVar4 = (int)puVar5 - (int)param_2;
        if (iVar4 != 0) {
            *puVar5 = 0;
        }
        uVar3 = *(undefined4 *)(param_1 + 0x4c);
        *param_4 = *(undefined4 *)(param_1 + 0x48);
        param_4[1] = uVar3;
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar4);
}

void FUN_0004a784(int param_1, void *param_2, int param_3, undefined4 *param_4)

{
    int iVar1;
    undefined4 uVar2;
    size_t __n;

    iVar1 = __stack_chk_guard;
    if (param_3 < 1) {
        __n = 0;
    } else {
        __n = param_3 - 1U;
        if ((int)*(size_t *)(param_1 + 0x54) <= (int)(param_3 - 1U)) {
            __n = *(size_t *)(param_1 + 0x54);
        }
        memcpy(param_2, (void *)(param_1 + 0x58), __n);
        *(undefined1 *)((int)param_2 + __n) = 0;
        uVar2 = *(undefined4 *)(param_1 + 0x4c);
        *param_4 = *(undefined4 *)(param_1 + 0x48);
        param_4[1] = uVar2;
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__n);
    }
    return;
}

void FUN_0004a81c(int param_1, undefined4 param_2)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;

    iVar1 = __stack_chk_guard;
    if ((*(code **)(param_1 + 8) == (code *)0x0) ||
        (iVar2 = (**(code **)(param_1 + 8))(param_2), iVar2 != 0)) {
        FUN_0007afc4(param_2);
        uVar3 = 0;
    } else {
        FUN_0007af28(param_2);
        uVar3 = 1;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_0004a89c(int param_1, speed_t param_2, uint param_3)

{
    int iVar1;
    undefined4 uVar2;
    int *piVar3;
    cc_t *pcVar4;
    uint local_5c;
    termios local_58;
    int local_1c;

    local_1c = __stack_chk_guard;
    iVar1 = tcgetattr(param_1, &local_58);
    if (iVar1 < 0) {
        piVar3 = __errno_location();
        iVar1 = *piVar3;
        FUN_00075d40(3, "refclock_setup fd %d tcgetattr: %m", param_1);
        uVar2 = 0;
        *piVar3 = iVar1;
    } else {
        if (param_2 != 0) {
            local_5c = 0;
            local_58.c_oflag = 0;
            if ((param_3 & 0x100) == 0) {
                local_58.c_cflag = 0x8b0;
            } else {
                local_58.c_cflag = 0xba0;
            }
            local_58.c_iflag = 0x105;
            cfsetispeed(&local_58, param_2);
            cfsetospeed(&local_58, param_2);
            pcVar4 = &local_58.c_line;
            do {
                pcVar4 = pcVar4 + 1;
                *pcVar4 = '\0';
            } while (pcVar4 != local_58.c_cc + 0x1f);
            iVar1 = ioctl(param_1, 0x5415, &local_5c);
            if (iVar1 < 0) {
                FUN_00075d40(3, "refclock_setup fd %d TIOCMGET: %m", param_1);
            }
            if (((local_5c & 0x100) != 0) && ((param_3 & 0x80) != 0)) {
                local_58.c_cflag = local_58.c_cflag & 0xfffff7ff;
            }
        }
        if ((param_3 & 0x20) == 0) {
            local_58.c_lflag = 2;
        } else {
            local_58.c_lflag = 0;
            local_58.c_iflag = 0;
            local_58.c_cc[6] = '\x01';
        }
        if ((param_3 & 0x40) != 0) {
            local_58.c_lflag = local_58.c_lflag | 8;
        }
        iVar1 = tcsetattr(param_1, 0, &local_58);
        if (iVar1 < 0) {
            piVar3 = __errno_location();
            iVar1 = *piVar3;
            FUN_00075d40(3, "refclock_setup fd %d TCSANOW: %m", param_1);
            uVar2 = 0;
            *piVar3 = iVar1;
        } else {
            iVar1 = tcflush(param_1, 2);
            if (iVar1 < 0) {
                FUN_00075d40(3, "refclock_setup fd %d tcflush(): %m", param_1);
                uVar2 = 1;
            } else {
                uVar2 = 1;
            }
        }
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar2);
}

void FUN_0004aa90(char *param_1, undefined4 param_2, undefined4 param_3)

{
    int __fd;
    int iVar1;
    int *piVar2;
    ssize_t sVar3;
    undefined1 auStack_a4[128];
    int local_24;

    local_24 = __stack_chk_guard;
    __fd = open64(param_1, 0x902, 0x1ff);
    if (__fd == 0) {
        __fd = dup(0);
        piVar2 = __errno_location();
        iVar1 = *piVar2;
        close(0);
        *piVar2 = iVar1;
    }
    if (__fd < 0) {
        piVar2 = __errno_location();
        iVar1 = *piVar2;
        FUN_00075d40(3, "refclock_open %s: %m", param_1);
        __fd = -1;
        *piVar2 = iVar1;
    } else {
        iVar1 = FUN_0004a89c(__fd, param_2, param_3);
        if (iVar1 == 0) {
            close(__fd);
            __fd = -1;
        } else {
            piVar2 = __errno_location();
            do {
                do {
                    sVar3 = read(__fd, auStack_a4, 0x80);
                } while (0 < sVar3);
            } while (*piVar2 == 4);
        }
    }
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__fd);
    }
    return;
}

void FUN_0004abac(short *param_1, int param_2, undefined1 *param_3)

{
    undefined1 uVar1;
    int iVar2;
    int iVar3;
    byte bVar4;
    undefined4 uVar5;
    undefined4 uVar6;
    int iVar7;
    undefined4 uVar8;
    uint uVar9;
    bool bVar10;
    double dVar11;

    iVar2 = __stack_chk_guard;
    if (*param_1 == 2) {
        uVar9 = *(uint *)(param_1 + 2);
        if (((uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10) == 0x7f7f0000) &&
            (iVar3 = FUN_00041f34(param_1, 0, 0, 0xffffffff, 0, 0),
             iVar3 != 0)) {
            iVar7 = *(int *)(iVar3 + 0x54);
            if (iVar7 == 0) {
                /* WARNING: Subroutine does not return */
                FUN_0007fc54("ntp_refclock.c", 0x41c, 2,
                             "peer->procptr != ((void *)0)");
            }
            if (param_2 != 0) {
                bVar4 = *(byte *)(param_2 + 2);
                if ((bVar4 & 1) != 0) {
                    uVar5 = *(undefined4 *)(param_2 + 0x2c);
                    *(undefined4 *)(iVar7 + 0x2e8) =
                        *(undefined4 *)(param_2 + 0x28);
                    *(undefined4 *)(iVar7 + 0x2ec) = uVar5;
                    bVar4 = *(byte *)(param_2 + 2);
                }
                if ((bVar4 & 2) != 0) {
                    uVar5 = *(undefined4 *)(param_2 + 0x34);
                    *(undefined4 *)(iVar7 + 0x2f0) =
                        *(undefined4 *)(param_2 + 0x30);
                    *(undefined4 *)(iVar7 + 0x2f4) = uVar5;
                    bVar4 = *(byte *)(param_2 + 2);
                }
                if ((bVar4 & 4) != 0) {
                    uVar1 = *(undefined1 *)(param_2 + 0x38);
                    *(undefined1 *)(iVar7 + 0x2f8) = uVar1;
                    *(undefined1 *)(iVar3 + 0x5d) = uVar1;
                    bVar4 = *(byte *)(param_2 + 2);
                }
                if ((bVar4 & 8) != 0) {
                    uVar5 = *(undefined4 *)(param_2 + 0x3c);
                    *(undefined4 *)(iVar7 + 0x2fc) = uVar5;
                    *(undefined4 *)(iVar3 + 0x70) = uVar5;
                    bVar4 = *(byte *)(param_2 + 2);
                }
                if ((bVar4 & 0x10) != 0) {
                    bVar4 = *(byte *)(iVar7 + 0x300) & 0xfe;
                    *(byte *)(iVar7 + 0x300) = bVar4;
                    *(byte *)(iVar7 + 0x300) =
                        bVar4 | *(byte *)(param_2 + 1) & 1;
                    bVar4 = *(byte *)(param_2 + 2);
                }
                if ((bVar4 & 0x20) != 0) {
                    bVar4 = *(byte *)(iVar7 + 0x300) & 0xfd;
                    *(byte *)(iVar7 + 0x300) = bVar4;
                    *(byte *)(iVar7 + 0x300) =
                        bVar4 | *(byte *)(param_2 + 1) & 2;
                    bVar4 = *(byte *)(param_2 + 2);
                }
                if ((bVar4 & 0x40) != 0) {
                    bVar4 = *(byte *)(iVar7 + 0x300) & 0xfb;
                    *(byte *)(iVar7 + 0x300) = bVar4;
                    *(byte *)(iVar7 + 0x300) =
                        bVar4 | *(byte *)(param_2 + 1) & 4;
                    bVar4 = *(byte *)(param_2 + 2);
                }
                if ((bVar4 & 0x80) != 0) {
                    bVar4 = *(byte *)(iVar7 + 0x300) & 0xf7;
                    *(byte *)(iVar7 + 0x300) = bVar4;
                    *(byte *)(iVar7 + 0x300) =
                        bVar4 | *(byte *)(param_2 + 1) & 8;
                }
            }
            if (param_3 != (undefined1 *)0x0) {
                bVar4 = *(byte *)(iVar7 + 0x2f8);
                uVar5 = *(undefined4 *)(iVar7 + 0x2fc);
                param_3[2] = 0xc;
                dVar11 = *(double *)(iVar7 + 0x2e8);
                *(undefined4 *)(param_3 + 0x3c) = uVar5;
                *(uint *)(param_3 + 0x38) = (uint)bVar4;
                *(double *)(param_3 + 0x28) = dVar11;
                if (dVar11 != 0.0) {
                    uVar5 = 0xd;
                }
                if (dVar11 != 0.0) {
                    param_3[2] = (char)uVar5;
                }
                dVar11 = *(double *)(iVar7 + 0x2f0);
                *(double *)(param_3 + 0x30) = dVar11;
                if (dVar11 != 0.0) {
                    param_3[2] = param_3[2] | 2;
                }
                bVar4 = *(byte *)(iVar7 + 0x300);
                param_3[1] = bVar4;
                if ((bVar4 & 1) != 0) {
                    param_3[2] = param_3[2] | 0x10;
                }
                if ((bVar4 & 2) != 0) {
                    param_3[2] = param_3[2] | 0x20;
                }
                if ((bVar4 & 4) != 0) {
                    param_3[2] = param_3[2] | 0x40;
                }
                bVar10 = (bVar4 & 8) != 0;
                if (bVar10) {
                    bVar4 = param_3[2];
                }
                if (bVar10) {
                    param_3[2] =
                        ~((byte) ~(byte)(((uint)bVar4 << 0x19) >> 0x18) >> 1);
                }
                uVar8 = *(undefined4 *)(iVar7 + 0x30c);
                iVar3 = current_time - *(int *)(iVar7 + 0x304);
                *(undefined4 *)(param_3 + 0xc) = *(undefined4 *)(iVar7 + 0x308);
                uVar5 = *(undefined4 *)(iVar7 + 0x310);
                *(int *)(param_3 + 0x1c) = iVar3;
                uVar6 = *(undefined4 *)(iVar7 + 0x314);
                *(undefined4 *)(param_3 + 0x10) = uVar8;
                *(undefined4 *)(param_3 + 0x14) = uVar5;
                *(undefined4 *)(param_3 + 0x18) = uVar6;
                param_3[0x41] = *(undefined1 *)(iVar7 + 0x2a);
                param_3[0x40] = *(undefined1 *)(iVar7 + 0x29);
                *param_3 = *(undefined1 *)(iVar7 + 0x2b);
                uVar5 = *(undefined4 *)(iVar7 + 0x2c);
                uVar6 = *(undefined4 *)(iVar7 + 0xb8);
                *(int *)(param_3 + 8) = iVar7 + 0x38;
                *(undefined4 *)(param_3 + 0x20) = uVar5;
                *(short *)(param_3 + 4) = (short)uVar6;
            }
            if (*(code **)(*(int *)(refclock_conf +
                                    (uVar9 >> 0x10 & 0xff) * 4) +
                           0xc) != (code *)0x0) {
                if (iVar2 == __stack_chk_guard) {
                    /* WARNING: Could not emulate address calculation at
                     * 0x0004ae3c */
                    /* WARNING: Treating indirect jump as call */
                    (**(code **)(*(int *)(refclock_conf +
                                          (uVar9 >> 0x10 & 0xff) * 4) +
                                 0xc))(uVar9 >> 0x18, param_2, param_3);
                    return;
                }
                goto LAB_0004ae90;
            }
        }
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
LAB_0004ae90:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0004aec8(short *param_1, undefined1 *param_2)

{
    bool bVar1;
    int iVar2;
    int iVar3;
    undefined4 uVar4;
    uint uVar5;
    uint uVar6;
    double *pdVar7;
    undefined4 uVar8;
    uint uVar9;
    uint uVar10;
    undefined1 *puVar11;
    double *pdVar12;
    undefined4 uVar13;
    undefined4 uVar14;
    undefined4 uVar15;
    double dVar16;
    undefined8 uVar17;

    iVar2 = __stack_chk_guard;
    if (*param_1 == 2) {
        uVar6 = *(uint *)(param_1 + 2);
        if ((((uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10) == 0x7f7f0000) &&
             (iVar3 = FUN_00041f34(param_1, 0, 0, 0xffffffff, 0, 0),
              iVar3 != 0)) &&
            (pdVar12 = *(double **)(iVar3 + 0x54), pdVar12 != (double *)0x0)) {
            *param_2 = 8;
            uVar13 = *(undefined4 *)((int)pdVar12 + 0xbc);
            uVar8 = *(undefined4 *)((int)pdVar12 + 0xcc);
            *(undefined4 *)(param_2 + 0xc) = *(undefined4 *)(pdVar12 + 0x18);
            pdVar7 = pdVar12 + 0x1d;
            uVar4 = *(undefined4 *)(pdVar12 + 0x19);
            *(undefined2 *)(param_2 + 2) = 0x3f;
            uVar14 = *(undefined4 *)((int)pdVar12 + 0xc4);
            *(undefined4 *)(param_2 + 0x14) = uVar4;
            uVar4 = *(undefined4 *)((int)pdVar12 + 0xd4);
            *(undefined4 *)(param_2 + 0x10) = uVar14;
            *(undefined4 *)(param_2 + 0x18) = uVar8;
            uVar15 = *(undefined4 *)(pdVar12 + 0x1a);
            uVar14 = *(undefined4 *)(pdVar12 + 0x1b);
            *(undefined4 *)(param_2 + 0x20) = uVar4;
            uVar4 = *(undefined4 *)(pdVar12 + 0x1c);
            uVar8 = *(undefined4 *)((int)pdVar12 + 0xe4);
            *(undefined4 *)(param_2 + 8) = uVar13;
            *(undefined4 *)(param_2 + 0x1c) = uVar15;
            *(undefined4 *)(param_2 + 4) = 0xfffffffc;
            *(undefined4 *)(param_2 + 0x24) = uVar14;
            *(undefined4 *)(param_2 + 0x48) = uVar4;
            *(undefined4 *)(param_2 + 0x4c) = uVar8;
            uVar4 = *(undefined4 *)((int)pdVar12 + 0xec);
            if (2 < (byte)param_2[1]) {
                pdVar12 = pdVar12 + 0x21;
            }
            *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)pdVar7;
            *(undefined4 *)(param_2 + 0x54) = uVar4;
            if (2 < (byte)param_2[1]) {
                uVar10 = 2;
                puVar11 = param_2;
                do {
                    dVar16 = *pdVar12;
                    pdVar12 = pdVar12 + 1;
                    uVar10 = uVar10 + 1;
                    bVar1 = dVar16 < 0.0;
                    if (bVar1) {
                        dVar16 = -dVar16;
                    }
                    uVar9 = (uint)bVar1;
                    dVar16 = ldexp(dVar16, 0x20);
                    uVar17 = FUN_0009d558(SUB84(dVar16, 0),
                                          (int)((ulonglong)dVar16 >> 0x20));
                    uVar5 = (uint)uVar17 ^ -uVar9;
                    *(uint *)(puVar11 + 0x5c) = uVar9 + uVar5;
                    *(uint *)(puVar11 + 0x58) =
                        ((uint)((ulonglong)uVar17 >> 0x20) ^
                         -(uint)(uVar9 != 0)) +
                        (uint)CARRY4(uVar9, uVar5);
                    puVar11 = puVar11 + 8;
                } while (uVar10 < (byte)param_2[1]);
            }
            if (*(code **)(*(int *)(refclock_conf +
                                    (uVar6 >> 0x10 & 0xff) * 4) +
                           0x14) != (code *)0x0) {
                if (iVar2 == __stack_chk_guard) {
                    /* WARNING: Could not emulate address calculation at
                     * 0x0004b06c */
                    /* WARNING: Treating indirect jump as call */
                    (**(code **)(*(int *)(refclock_conf +
                                          (uVar6 >> 0x10 & 0xff) * 4) +
                                 0x14))(uVar6 >> 0x18, param_2, iVar3);
                    return;
                }
                goto LAB_0004b0a0;
            }
        }
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
LAB_0004b0a0:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x0004b140) */

void FUN_0004b0b0(void)

{
    authkeylookups = 0;
    authkeynotfound = 0;
    authencryptions = 0;
    authdecryptions = 0;
    authkeyuncached = 0;
    auth_timereset = current_time;
    return;
}

void FUN_0004b168(void)

{
    int iVar1;
    undefined *puVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    if (DAT_000cd924 == 0) {
        DAT_000cd930 = DAT_000cd930 + 1;
        iVar3 = DAT_000cd92c;
    } else {
        iVar3 = DAT_000cd934;
        if (DAT_000cd934 != 0) {
            iVar3 = DAT_000cd934 << 3;
        }
        if (DAT_000cd934 == 0) {
            DAT_000cd938 = 0xd7;
        } else {
            DAT_000cd938 = ~(~(byte)iVar3 & 0x38);
        }
        DAT_000cd93c = (ushort)(byte)((uint)DAT_000cd930 >> 8) |
                       (ushort)(DAT_000cd930 << 8);
        DAT_000cd939 = (byte)DAT_000cdb34 & 0x7f;
        FUN_00026cc0(DAT_000cdb3c, DAT_000cdb38, 0xffffffff, &DAT_000cd938,
                     DAT_000cd928 + 8);
        iVar3 = DAT_000cd92c;
        numresppkts = numresppkts + 1;
        __memcpy_chk(&DAT_000cd940, &DAT_000cd730, DAT_000cd92c, 500);
        DAT_000cd928 = 0;
        DAT_000cd930 = 1;
        DAT_000cdb34 = DAT_000cdb34 + 1;
        DAT_000cd924 = 0;
    }
    DAT_000cd928 = DAT_000cd928 + iVar3;
    puVar2 = &DAT_000cd730;
    if (DAT_000cd928 + iVar3 < 0x1f5) {
        puVar2 = &DAT_000cd940 + DAT_000cd928;
    } else if (DAT_000cdb34 == 0x7f) {
        puVar2 = (undefined *)0x0;
    } else {
        DAT_000cd924 = 1;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(puVar2);
}

void FUN_0004b5d8(undefined4 param_1, undefined4 param_2, undefined1 param_3,
                  undefined1 param_4, uint param_5)

{
    int iVar1;
    bool bVar2;

    iVar1 = __stack_chk_guard;
    if (DAT_000cd934 == 0) {
        DAT_000cd938 = 0x97;
    } else {
        DAT_000cd938 = ~(~(byte)(DAT_000cd934 << 3) & 0x78);
    }
    DAT_000cd93c = (undefined2)(((param_5 & 0xf) << 0xc) >> 8);
    DAT_000cd939 = 0;
    DAT_000cd93e = 0;
    DAT_000cd93a = param_3;
    DAT_000cd93b = param_4;
    FUN_00026cc0(param_1, param_2, 0xffffffff, &DAT_000cd938, 8);
    bVar2 = iVar1 == __stack_chk_guard;
    *(int *)(errorcounter + param_5 * 4) =
        *(int *)(errorcounter + param_5 * 4) + 1;
    if (bVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00050080(void)

{
    int iVar1;
    undefined4 *puVar2;
    undefined4 *puVar3;

    iVar1 = __stack_chk_guard;
    numrequests = 0;
    numresppkts = 0;
    auth_timereset = 0;
    info_auth_keyid = 0;
    puVar2 = (undefined4 *)errorcounter;
    do {
        puVar3 = puVar2 + 1;
        *puVar2 = 0;
        puVar2 = puVar3;
    } while (puVar3 != &numresppkts);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00050174(int param_1, int param_2)

{
    ushort uVar1;
    ushort uVar2;
    byte bVar3;
    short sVar4;
    ushort uVar5;
    int iVar6;
    uint uVar7;
    undefined4 uVar8;
    int iVar9;
    int iVar10;
    uint uVar11;
    uint uVar12;
    int iVar13;
    int iVar14;
    int iVar15;
    undefined4 uVar16;
    uint uVar17;
    int iVar18;
    uint uVar19;
    uint uVar20;
    double dVar21;
    undefined8 uVar22;
    short *local_40;

    iVar6 = __stack_chk_guard;
    bVar3 = *(byte *)(param_1 + 0x58);
    iVar15 = param_1 + 4;
    uVar11 = *(uint *)(param_1 + 0x54);
    uVar16 = *(undefined4 *)(param_1 + 0x3c);
    if ((bVar3 & 0x80) == 0) {
        if ((bVar3 & 0x40) == 0) {
            uVar12 = ((uint)bVar3 << 0x1a) >> 0x1d;
            if (uVar12 < 5) {
                if (uVar12 == 0) {
                    uVar16 = 4;
                } else if ((*(byte *)(param_1 + 0x59) & 0x7f) == 0) {
                    uVar17 = (*(ushort *)(param_1 + 0x5c) & 0xff) << 8;
                    uVar7 = *(ushort *)(param_1 + 0x5c) >> 8 | uVar17;
                    if (uVar17 >> 0xc == 0) {
                        uVar5 = *(ushort *)(param_1 + 0x5e) >> 8;
                        uVar1 = *(ushort *)(param_1 + 0x5e) << 8;
                        uVar2 = uVar5 | uVar1;
                        uVar17 = (uint)(uVar5 | uVar1);
                        if (uVar1 >> 0xc == 0) {
                            if (7 < (int)uVar11) {
                                uVar20 = (uint) * (byte *)(param_1 + 0x5a);
                                DAT_000cd934 = uVar12;
                                if (uVar20 == 0) {
                                    local_40 = &DAT_000a7e20;
                                } else {
                                    if (1 < uVar20 - 2) {
                                        FUN_0004b5d8(
                                            iVar15, uVar16, uVar20,
                                            *(undefined1 *)(param_1 + 0x5b), 1);
                                        goto LAB_000501f0;
                                    }
                                    local_40 = &DAT_000c54f0;
                                }
                                uVar12 = (uint) * (byte *)(param_1 + 0x5b);
                                sVar4 = *local_40;
                                while ((int)sVar4 != 0xffffffff) {
                                    if ((int)sVar4 == uVar12) {
                                        if (((((ushort)local_40[2] == uVar17) ||
                                              (local_40[3] == uVar2)) ||
                                             (*(short *)(param_1 + 0x5a) ==
                                                  0xa03 &&
                                              uVar2 == 0x10)) &&
                                            (((ushort)local_40[2] == 0 ||
                                              (uVar19 = uVar7 * uVar17,
                                               uVar19 < uVar11 - 8 ||
                                                   uVar19 - (uVar11 - 8) ==
                                                       0)))) {
                                            if (uVar20 == 2) {
                                                DAT_000cdb40 = 0;
                                            } else {
                                                if (uVar20 != 3)
                                                    goto LAB_000503d0;
                                                DAT_000cdb40 = 1;
                                            }
                                            iVar13 = param_1 + 0x58;
                                            if ((local_40[1] == 0) ||
                                                (sys_authenticate == 0)) {
                                            LAB_000505b4:
                                                if (iVar6 ==
                                                    __stack_chk_guard) {
                                                    /* WARNING: Could not
                                                     * recover jumptable at
                                                     * 0x000505e0. Too many
                                                     * branches */
                                                    /* WARNING: Treating
                                                     * indirect jump as call */
                                                    (**(code **)(local_40 + 4))(
                                                        iVar15, uVar16, iVar13);
                                                    return;
                                                }
                                                goto LAB_000505f8;
                                            }
                                            iVar9 = uVar7 * uVar17;
                                            if (iVar9 + 0x24U <= uVar11) {
                                                uVar17 =
                                                    iVar9 + 0x13U & 0xfffffffc;
                                                if (uVar17 + 0x18 < uVar11) {
                                                    iVar9 = 0x14;
                                                } else {
                                                    iVar9 = uVar11 - uVar17;
                                                }
                                                if (((*(byte *)(param_1 +
                                                                0x59) &
                                                      0x80) != 0) &&
                                                    (info_auth_keyid != 0)) {
                                                    iVar14 =
                                                        (uVar11 - iVar9) + -8;
                                                    iVar18 = iVar13 + iVar14;
                                                    uVar17 =
                                                        *(uint *)(iVar18 + 8);
                                                    if (info_auth_keyid ==
                                                        (uVar17 << 0x18 |
                                                         (uVar17 >> 8 & 0xff)
                                                             << 0x10 |
                                                         (uVar17 >> 0x10 & 0xff)
                                                             << 8 |
                                                         uVar17 >> 0x18)) {
                                                        if (0xd8 < uVar11) {
                                                            FUN_00075d40(
                                                                3,
                                                                "process_"
                                                                "private: bad "
                                                                "pkt length "
                                                                "%zu");
                                                            uVar12 =
                                                                (uint) *
                                                                (byte
                                                                     *)(param_1 +
                                                                        0x5b);
                                                            uVar20 =
                                                                (uint) *
                                                                (byte
                                                                     *)(param_1 +
                                                                        0x5a);
                                                            goto LAB_000503d0;
                                                        }
                                                        if (param_2 == 0) {
                                                            sys_restricted =
                                                                sys_restricted +
                                                                1;
                                                        } else {
                                                            iVar10 =
                                                                FUN_00072f54();
                                                            if (iVar10 != 0) {
                                                                uVar12 = *(
                                                                    uint
                                                                        *)(iVar18 +
                                                                           4);
                                                                uVar17 = *(
                                                                    uint
                                                                        *)(iVar13 +
                                                                           iVar14);
                                                                uVar12 =
                                                                    uVar12
                                                                        << 0x18 |
                                                                    (uVar12 >>
                                                                         8 &
                                                                     0xff)
                                                                        << 0x10 |
                                                                    (uVar12 >>
                                                                         0x10 &
                                                                     0xff)
                                                                        << 8 |
                                                                    uVar12 >>
                                                                        0x18;
                                                                uVar7 =
                                                                    (uVar17
                                                                         << 0x18 |
                                                                     (uVar17 >>
                                                                          8 &
                                                                      0xff)
                                                                         << 0x10 |
                                                                     (uVar17 >>
                                                                          0x10 &
                                                                      0xff)
                                                                         << 8 |
                                                                     uVar17 >>
                                                                         0x18) -
                                                                    *(int *)(param_1 +
                                                                             0x48);
                                                                uVar17 =
                                                                    uVar12 -
                                                                    *(int *)(param_1 +
                                                                             0x4c);
                                                                if (uVar12 <
                                                                    uVar17) {
                                                                    uVar7 =
                                                                        uVar7 -
                                                                        1;
                                                                }
                                                                iVar14 = -(
                                                                    (int)
                                                                        uVar7 >>
                                                                    0x1f);
                                                                uVar22 = VectorShiftRight(
                                                                    CONCAT44(
                                                                        iVar14,
                                                                        iVar14),
                                                                    0x20);
                                                                iVar18 =
                                                                    (int)((ulonglong)
                                                                              uVar22 >>
                                                                          0x20);
                                                                uVar12 = (uint)
                                                                    uVar22;
                                                                uVar17 =
                                                                    -uVar12 ^
                                                                    uVar17;
                                                                dVar21 = (double)FUN_0009d40c(
                                                                    uVar12 +
                                                                        uVar17,
                                                                    iVar18 +
                                                                        (-(iVar18 +
                                                                           (uint)(uVar12 !=
                                                                                  0)) ^
                                                                         uVar7) +
                                                                        (uint)CARRY4(
                                                                            uVar12,
                                                                            uVar17));
                                                                dVar21 = ldexp(
                                                                    dVar21,
                                                                    -0x20);
                                                                if (iVar14 !=
                                                                    0) {
                                                                    dVar21 =
                                                                        -dVar21;
                                                                }
                                                                if ((ABS(dVar21) <=
                                                                     10.0) &&
                                                                    (iVar9 = FUN_00073770(
                                                                         info_auth_keyid,
                                                                         iVar13,
                                                                         uVar11 -
                                                                             iVar9,
                                                                         iVar9),
                                                                     iVar9 !=
                                                                         0))
                                                                    goto LAB_000505b4;
                                                            }
                                                        }
                                                        FUN_0004b5d8(
                                                            iVar15, uVar16,
                                                            *(undefined1
                                                                  *)(param_1 +
                                                                     0x5a),
                                                            *(undefined1
                                                                  *)(param_1 +
                                                                     0x5b),
                                                            7);
                                                        goto LAB_000501f0;
                                                    }
                                                }
                                                FUN_0004b5d8(iVar15, uVar16,
                                                             uVar20, uVar12, 7);
                                                goto LAB_000501f0;
                                            }
                                        }
                                    LAB_000503d0:
                                        FUN_0004b5d8(iVar15, uVar16, uVar20,
                                                     uVar12, 3);
                                        goto LAB_000501f0;
                                    }
                                    local_40 = local_40 + 6;
                                    sVar4 = *local_40;
                                }
                                FUN_0004b5d8(iVar15, uVar16, uVar20, uVar12, 2);
                                goto LAB_000501f0;
                            }
                            uVar16 = 8;
                        } else {
                            uVar16 = 7;
                        }
                    } else {
                        uVar16 = 6;
                    }
                } else {
                    uVar16 = 5;
                }
            } else {
                uVar16 = 3;
            }
        } else {
            uVar16 = 2;
        }
    } else {
        uVar16 = 1;
    }
    if (((ntp_syslogmask & 2) != 0) && (DAT_000cdb44 <= current_time)) {
        uVar8 = FUN_0007d2c0(iVar15);
        FUN_00075d40(3, "process_private: drop test %d failed, pkt from %s",
                     uVar16, uVar8);
        DAT_000cdb44 = current_time + 0x3c;
    }
LAB_000501f0:
    if (iVar6 == __stack_chk_guard) {
        return;
    }
LAB_000505f8:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00050698(undefined4 *param_1, int param_2)

{
    uint uVar1;
    uint uVar2;
    uint local_84;
    uint local_80;
    char acStack_7c[48];
    char acStack_4c[48];
    int local_1c;

    local_1c = __stack_chk_guard;
    if (param_2 == 0) {
        uVar1 = param_1[5];
        uVar2 = param_1[6];
        local_84 = uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                   (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
        local_80 = uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 |
                   (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18;
        inet_ntop(2, &local_84, acStack_7c, 0x2e);
        inet_ntop(2, &local_80, acStack_4c, 0x2e);
    } else {
        inet_ntop(10, param_1 + 5, acStack_7c, 0x2e);
        inet_ntop(10, param_1 + 9, acStack_4c, 0x2e);
    }
    FUN_00075c68("restrict node at %p: %s/%s count %d, rflags %05x, mflags "
                 "%05x, ippeerlimit %d, expire %lu, next %p\n",
                 param_1, acStack_7c, acStack_4c, param_1[1],
                 *(undefined2 *)(param_1 + 2),
                 *(undefined2 *)((int)param_1 + 10),
                 (int)*(short *)(param_1 + 3), param_1[4], *param_1);
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00050810) */

void FUN_000507a4(void)

{
    DAT_000cdb48 = DAT_000cdb48 + -1;
    if (DAT_000cdb48 != 0) {
        return;
    }
    FUN_000412e8(2);
    return;
}

void FUN_00050820(undefined4 *param_1, int param_2)

{
    int iVar1;
    undefined4 *puVar2;
    undefined4 *puVar3;
    undefined4 *__s;
    bool bVar4;

    iVar1 = __stack_chk_guard;
    DAT_000cdb54 = DAT_000cdb54 + -1;
    if ((*(ushort *)(param_1 + 2) & 0x40) != 0) {
        FUN_000507a4();
    }
    if (param_2 == 0) {
        puVar3 = &restrictlist4;
    } else {
        puVar3 = &restrictlist6;
    }
    puVar2 = (undefined4 *)*puVar3;
    __s = param_1;
    if (puVar2 == param_1) {
    LAB_000508b8:
        *puVar3 = *__s;
        if (__s == param_1) {
            if (param_2 == 0) {
                memset(__s, 0, 0x1c);
                puVar3 = &DAT_000cdb50;
            } else {
                memset(__s, 0, 0x34);
                puVar3 = &DAT_000cdb4c;
            }
            bVar4 = iVar1 == __stack_chk_guard;
            *__s = *puVar3;
            *puVar3 = __s;
            if (bVar4) {
                return;
            }
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
    } else if (puVar2 != (undefined4 *)0x0) {
        puVar3 = puVar2;
        for (__s = (undefined4 *)*puVar2; __s != (undefined4 *)0x0;
             __s = (undefined4 *)*__s) {
            if (param_1 == __s)
                goto LAB_000508b8;
            puVar3 = __s;
        }
    }
    /* WARNING: Subroutine does not return */
    FUN_0007fc54("ntp_restrict.c", 0x132, 2, "unlinked == res");
}

void FUN_00050994(uint param_1, int param_2)

{
    int iVar1;
    uint uVar2;
    int *piVar3;
    int *piVar4;

    iVar1 = __stack_chk_guard;
    piVar3 = restrictlist4;
    if (restrictlist4 != (int *)0x0) {
        do {
            piVar4 = (int *)*piVar3;
            if ((piVar3[4] != 0) && ((uint)piVar3[4] <= current_time)) {
                FUN_00050820(piVar3, 0);
            }
            if (piVar3[5] == (piVar3[6] & param_1)) {
                uVar2 =
                    ((*(ushort *)((int)piVar3 + 10) ^ 0x2000) << 0x12) >> 0x1f;
                if (param_2 == 0x7b) {
                    uVar2 = 1;
                }
                if (uVar2 != 0)
                    goto LAB_00050a30;
            }
            piVar3 = piVar4;
        } while (piVar4 != (int *)0x0);
    }
    piVar3 = (int *)0x0;
LAB_00050a30:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(piVar3);
    }
    return;
}

void FUN_00050a78(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if (DAT_000cdb48 == 0) {
        FUN_000411c4(2);
    }
    DAT_000cdb48 = DAT_000cdb48 + 1;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00050af4(int param_1, int param_2)

{
    byte *pbVar1;
    int iVar2;
    byte *pbVar3;
    byte *pbVar4;
    uint uVar5;
    int *piVar6;
    int *piVar7;
    bool bVar8;
    byte abStack_3c[16];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (restrictlist6 != (int *)0x0) {
        if (restrictlist6 != (int *)*restrictlist6) {
            piVar6 = restrictlist6;
            piVar7 = (int *)*restrictlist6;
            do {
                if ((piVar6[4] != 0) && ((uint)piVar6[4] <= current_time)) {
                    FUN_00050820(piVar6, 1);
                }
                pbVar1 = (byte *)((int)piVar6 + 0x23);
                pbVar3 = abStack_3c;
                pbVar4 = (byte *)(param_1 + -1);
                do {
                    pbVar4 = pbVar4 + 1;
                    pbVar1 = pbVar1 + 1;
                    *pbVar3 = *pbVar4 & *pbVar1;
                    pbVar3 = pbVar3 + 1;
                } while (pbVar4 != (byte *)(param_1 + 0xf));
                iVar2 = memcmp(abStack_3c, piVar6 + 5, 0x10);
                if (iVar2 == 0) {
                    uVar5 =
                        ((*(ushort *)((int)piVar6 + 10) ^ 0x2000) << 0x12) >>
                        0x1f;
                    if (param_2 == 0x7b) {
                        uVar5 = 1;
                    }
                    if (uVar5 != 0)
                        goto LAB_00050bf0;
                }
                if (piVar7 == (int *)0x0)
                    goto LAB_00050bec;
                bVar8 = (int *)*piVar7 != piVar7;
                piVar6 = piVar7;
                piVar7 = (int *)*piVar7;
            } while (bVar8);
        }
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_restrict.c", 0x17d, 2, "next != res");
    }
LAB_00050bec:
    piVar6 = (int *)0x0;
LAB_00050bf0:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(piVar6);
}

void FUN_00050c44(void)

{
    int iVar1;
    undefined4 *puVar2;
    int *piVar3;

    iVar1 = __stack_chk_guard;
    puVar2 = &DAT_000cdb58;
    FUN_00075c68("dump_restrict: restrict_def4: %p\n");
    do {
        FUN_00050698(puVar2, 0);
        puVar2 = (undefined4 *)*puVar2;
    } while (puVar2 != (undefined4 *)0x0);
    puVar2 = &DAT_000cdb8c;
    FUN_00075c68("dump_restrict: restrict_def6: %p\n");
    do {
        FUN_00050698(puVar2, 1);
        puVar2 = (undefined4 *)*puVar2;
    } while (puVar2 != (undefined4 *)0x0);
    FUN_00075c68("dump_restrict: restrictlist4: %p\n", &restrictlist4);
    for (piVar3 = (int *)restrictlist4; piVar3 != (int *)0x0;
         piVar3 = (int *)*piVar3) {
        FUN_00050698(piVar3, 0);
    }
    FUN_00075c68("dump_restrict: restrictlist6: %p\n", &restrictlist6);
    for (piVar3 = (int *)restrictlist6; piVar3 != (int *)0x0;
         piVar3 = (int *)*piVar3) {
        FUN_00050698(piVar3, 1);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00050e08) */

void FUN_00050d88(void)

{
    DAT_000cdb64 = 0xffff;
    DAT_000cdb98 = 0xffff;
    DAT_000cdb58 = restrictlist4;
    restrictlist4 = &DAT_000cdb58;
    DAT_000cdb8c = restrictlist6;
    DAT_000cdb54 = 2;
    restrictlist6 = &DAT_000cdb8c;
    return;
}

void FUN_00050e20(short *param_1, undefined2 *param_2)

{
    undefined2 uVar1;
    int iVar2;
    undefined4 *puVar3;
    uint uVar4;
    short sVar5;

    iVar2 = __stack_chk_guard;
    if (param_2 == (undefined2 *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_restrict.c", 0x1ff, 0, "((void *)0) != r4a");
    }
    *param_2 = 1;
    param_2[1] = 0;
    sVar5 = *param_1;
    DAT_000cdbc0 = DAT_000cdbc0 + 1;
    if (sVar5 == 2) {
        uVar4 = *(uint *)(param_1 + 2);
        if ((uVar4 << 0x18 & 0xf0000000) == 0xe0000000) {
            param_2[1] = 2;
            goto LAB_00050e84;
        }
        puVar3 = (undefined4 *)FUN_00050994(
            uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 |
                (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18,
            (ushort)param_1[1] >> 8 | param_1[1] << 8);
        if (puVar3 == (undefined4 *)0x0) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_restrict.c", 0x217, 2, "match != ((void *)0)");
        }
        puVar3[1] = puVar3[1] + 1;
        if (puVar3 == &DAT_000cdb58) {
            DAT_000cdbc4 = DAT_000cdbc4 + 1;
        } else {
            DAT_000cdbc8 = DAT_000cdbc8 + 1;
        }
        uVar1 = *(undefined2 *)(puVar3 + 3);
        *param_2 = *(undefined2 *)(puVar3 + 2);
        param_2[1] = uVar1;
        sVar5 = *param_1;
    }
    if ((sVar5 == 10) && ((char)param_1[4] != -1)) {
        puVar3 = (undefined4 *)FUN_00050af4(
            param_1 + 4, (ushort)param_1[1] >> 8 | param_1[1] << 8);
        if (puVar3 == (undefined4 *)0x0) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_restrict.c", 0x234, 2, "match != ((void *)0)");
        }
        puVar3[1] = puVar3[1] + 1;
        if (puVar3 == &DAT_000cdb8c) {
            DAT_000cdbc4 = DAT_000cdbc4 + 1;
        } else {
            DAT_000cdbc8 = DAT_000cdbc8 + 1;
        }
        uVar1 = *(undefined2 *)(puVar3 + 3);
        *param_2 = *(undefined2 *)(puVar3 + 2);
        param_2[1] = uVar1;
    }
LAB_00050e84:
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00051008(uint param_1, short *param_2, int param_3, ushort param_4,
                  short param_5, ushort param_6, undefined4 param_7)

{
    int iVar1;
    uint uVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    uint uVar5;
    undefined4 uVar6;
    ushort uVar7;
    undefined4 uVar8;
    undefined4 *puVar9;
    int iVar10;
    undefined4 *puVar11;
    undefined4 *puVar12;
    size_t __n;
    byte *pbVar13;
    undefined4 *puVar15;
    byte *pbVar16;
    undefined4 *puVar17;
    undefined4 local_60[2];
    undefined4 local_58;
    uint local_54[2];
    uint local_4c;
    uint local_48;
    undefined4 local_44;
    undefined4 local_40;
    undefined4 local_3c;
    undefined4 local_38;
    undefined4 local_34;
    undefined4 local_30;
    int local_2c;
    byte *pbVar14;

    local_2c = __stack_chk_guard;
    if (param_2 == (short *)0x0) {
        if (param_3 != 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_restrict.c", 0x26b, 0, "((void *)0) == resmask");
        }
        if (param_1 != 1) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_restrict.c", 0x26c, 0, "RESTRICT_FLAGS == op");
        }
        DAT_000cdbcc = param_6;
        DAT_000cdbce = param_5;
        DAT_000cdbd4 = 1;
        DAT_000cdbd0 = param_4;
    } else {
        iVar10 = 0;
        local_60[0] = 0;
        local_60[1] = 0;
        local_58 = 0;
        local_54[0] = 0;
        local_54[1] = 0;
        local_4c = 0;
        local_48 = 0;
        local_44 = 0;
        local_40 = 0;
        local_3c = 0;
        local_38 = 0;
        local_34 = 0;
        local_30 = 0;
        if (*param_2 == 2) {
            uVar5 = *(uint *)(param_2 + 2);
            __n = 8;
            uVar2 = *(uint *)(param_3 + 4);
            local_48 = uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 |
                       (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18;
            local_54[1] = param_7;
            local_4c = (uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                        (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18) &
                       local_48;
            puVar12 = restrictlist4;
        } else {
            if (*param_2 != 10) {
                /* WARNING: Subroutine does not return */
                FUN_0007fc54("ntp_restrict.c", 0x292, 0, "0");
            }
            pbVar16 = (byte *)((int)param_2 + 7);
            local_3c = *(undefined4 *)(param_3 + 8);
            local_38 = *(undefined4 *)(param_3 + 0xc);
            local_34 = *(undefined4 *)(param_3 + 0x10);
            local_30 = *(undefined4 *)(param_3 + 0x14);
            pbVar14 = (byte *)((int)&local_40 + 3);
            do {
                pbVar13 = pbVar14 + 1;
                pbVar16 = pbVar16 + 1;
                pbVar14[-0xf] = *pbVar16 & *pbVar13;
                pbVar14 = pbVar13;
            } while (pbVar13 != (byte *)((int)&local_30 + 3));
            iVar10 = 1;
            local_54[1] = param_7;
            __n = 0x20;
            puVar12 = restrictlist6;
        }
        local_58 = CONCAT22(param_5, param_6);
        local_54[1] = param_7;
        local_54[0] = (uint)param_4;
        if (puVar12 != (undefined4 *)0x0) {
            do {
                if ((*(short *)((int)puVar12 + 10) == param_5) &&
                    (iVar1 = memcmp(puVar12 + 5, &local_4c, __n), iVar1 == 0)) {
                    switch (param_1) {
                    case 1:
                        uVar7 = *(ushort *)(puVar12 + 2);
                        if (((param_6 & 0x40) != 0) && ((uVar7 & 0x40) == 0)) {
                            FUN_00050a78();
                            uVar7 = *(ushort *)(puVar12 + 2);
                        }
                        *(ushort *)(puVar12 + 2) = uVar7 | param_6;
                        goto LAB_00051244;
                    case 2:
                        uVar7 = *(ushort *)(puVar12 + 2);
                        if (((uVar7 & 0x40) != 0) && ((param_6 & 0x40) != 0)) {
                            FUN_000507a4();
                            uVar7 = *(ushort *)(puVar12 + 2);
                        }
                        *(ushort *)(puVar12 + 2) = uVar7 & ~param_6;
                        goto LAB_00051168;
                    case 3:
                        break;
                    case 4:
                        break;
                    default:
                        goto switchD_0005113c_default;
                    }
                    if (((param_1 != 4) &&
                         ((*(ushort *)((int)puVar12 + 10) & 0x1000) != 0)) ||
                        (puVar12 == &DAT_000cdb58 || puVar12 == &DAT_000cdb8c))
                        goto LAB_00051168;
                    if (local_2c == __stack_chk_guard) {
                        FUN_00050820(puVar12, iVar10);
                        return;
                    }
                    goto LAB_00051544;
                }
                puVar12 = (undefined4 *)*puVar12;
            } while (puVar12 != (undefined4 *)0x0);
        }
        if (param_1 == 1) {
            if (iVar10 == 0) {
                if (DAT_000cdb50 == (undefined4 *)0x0) {
                    puVar12 = (undefined4 *)FUN_00074bcc(0, 0x24, 0x1c, 0);
                    puVar11 = DAT_000cdb50;
                    puVar9 = puVar12 + 0xf5;
                    do {
                        DAT_000cdb50 = puVar9;
                        *DAT_000cdb50 = puVar11;
                        puVar11 = DAT_000cdb50;
                        puVar9 = DAT_000cdb50 + -7;
                    } while (DAT_000cdb50 + -7 != puVar12);
                } else {
                    puVar12 = DAT_000cdb50;
                    DAT_000cdb50 = (undefined4 *)*DAT_000cdb50;
                }
                *puVar12 = local_60[0];
                puVar12[1] = local_60[1];
                puVar12[2] = local_58;
                puVar12[3] = local_54[0];
                puVar12[4] = local_54[1];
                puVar12[5] = local_4c;
                puVar12[6] = local_48;
                puVar11 = &restrictlist4;
            } else {
                if (DAT_000cdb4c == (undefined4 *)0x0) {
                    puVar12 = (undefined4 *)FUN_00074bcc(0, 0x13, 0x34, 0);
                    puVar11 = DAT_000cdb4c;
                    puVar9 = puVar12 + 0xea;
                    do {
                        DAT_000cdb4c = puVar9;
                        *DAT_000cdb4c = puVar11;
                        puVar11 = DAT_000cdb4c;
                        puVar9 = DAT_000cdb4c + -0xd;
                    } while (DAT_000cdb4c + -0xd != puVar12);
                } else {
                    puVar12 = DAT_000cdb4c;
                    DAT_000cdb4c = (undefined4 *)*DAT_000cdb4c;
                }
                puVar9 = local_60;
                puVar11 = puVar12;
                do {
                    puVar15 = puVar11 + 4;
                    uVar3 = *puVar9;
                    uVar4 = puVar9[1];
                    uVar6 = puVar9[2];
                    uVar8 = puVar9[3];
                    puVar17 = puVar9 + 4;
                    puVar9 = puVar9 + 4;
                    *puVar11 = uVar3;
                    puVar11[1] = uVar4;
                    puVar11[2] = uVar6;
                    puVar11[3] = uVar8;
                    puVar11 = puVar15;
                } while (puVar17 != &local_30);
                *puVar15 = *puVar9;
                puVar11 = &restrictlist6;
            }
            puVar9 = (undefined4 *)*puVar11;
            do {
                puVar15 = puVar9;
                if (puVar15 == (undefined4 *)0x0) {
                LAB_00051348:
                    *puVar12 = puVar15;
                    *puVar11 = puVar12;
                    goto LAB_00051350;
                }
                if (iVar10 == 0) {
                    if ((uint)puVar12[5] <= (uint)puVar15[5]) {
                        if ((uint)puVar15[5] <= (uint)puVar12[5]) {
                            if ((uint)puVar15[6] < (uint)puVar12[6])
                                goto LAB_00051348;
                            if ((uint)puVar15[6] <= (uint)puVar12[6])
                                goto LAB_0005139c;
                        }
                        goto LAB_000513ac;
                    }
                    goto LAB_00051348;
                }
                iVar1 = memcmp(puVar12 + 5, puVar15 + 5, 0x10);
                if (0 < iVar1)
                    goto LAB_00051348;
                if (iVar1 == 0) {
                    iVar1 = memcmp(puVar12 + 9, puVar15 + 9, 0x10);
                    if (0 < iVar1)
                        goto LAB_00051348;
                    if (iVar1 == 0) {
                    LAB_0005139c:
                        if (*(ushort *)((int)puVar15 + 10) <
                            *(ushort *)((int)puVar12 + 10))
                            goto LAB_00051348;
                    }
                }
            LAB_000513ac:
                puVar9 = (undefined4 *)*puVar15;
                puVar11 = puVar15;
            } while ((undefined4 *)*puVar15 != (undefined4 *)0x0);
            *puVar12 = 0;
            *puVar15 = puVar12;
        LAB_00051350:
            DAT_000cdb54 = DAT_000cdb54 + 1;
            if ((param_6 & 0x40) != 0) {
                FUN_00050a78();
            }
        LAB_00051244:
            *(undefined2 *)(puVar12 + 3) = (undefined2)local_54[0];
        } else if ((param_1 == 0) || (4 < param_1)) {
        switchD_0005113c_default:
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_restrict.c", 0x2de, 2, "0");
        }
    }
LAB_00051168:
    if (local_2c == __stack_chk_guard) {
        return;
    }
LAB_00051544:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00051594(ushort *param_1, int param_2, int param_3)

{
    ushort uVar1;
    bool bVar2;
    int iVar3;
    int iVar4;
    uint uVar5;
    bool bVar6;
    uint local_38;
    uint local_34;
    undefined4 local_30;
    undefined4 local_2c;
    undefined4 local_28;
    undefined4 local_24;
    undefined4 local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    if (DAT_000cdbd4 == 0)
        goto LAB_000516b8;
    uVar1 = *param_1;
    if (uVar1 == 2) {
        uVar5 = *(uint *)(param_1 + 2);
        if (((uVar5 == 0) || ((uVar5 << 0x18 & 0xf0000000) == 0xe0000000)) ||
            ((uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10) == 0x7f7f0000))
            goto LAB_000516b8;
        bVar6 = true;
    LAB_00051648:
        local_38 = (uint)uVar1;
        local_20 = 0;
        local_24 = 0;
        local_28 = 0;
        local_2c = 0;
        local_30 = 0;
        local_34 = 0xffffffff;
        if (param_2 == 0) {
            if (bVar6) {
                uVar5 = *(uint *)(param_1 + 2);
                iVar3 = FUN_00050994(
                    uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                        (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18,
                    param_1[1] >> 8 | param_1[1] << 8);
                if (iVar3 == 0) {
                    /* WARNING: Subroutine does not return */
                    FUN_0007fc54("ntp_restrict.c", 0x30d, 2,
                                 "res != ((void *)0)");
                }
                bVar6 = *(uint *)(iVar3 + 0x18) ==
                        (local_34 << 0x18 | (local_34 >> 8 & 0xff) << 0x10 |
                         (local_34 >> 0x10 & 0xff) << 8 | local_34 >> 0x18);
            } else {
            LAB_00051660:
                iVar3 = FUN_00050af4(param_1 + 4,
                                     param_1[1] >> 8 | param_1[1] << 8);
                if (iVar3 == 0) {
                    /* WARNING: Subroutine does not return */
                    FUN_0007fc54("ntp_restrict.c", 0x312, 2,
                                 "res != ((void *)0)");
                }
                iVar4 = memcmp((void *)(iVar3 + 0x24), &local_30, 0x10);
                bVar6 = iVar4 == 0;
            }
            bVar2 = bVar6;
            if (param_3 != 0) {
                bVar2 = false;
            }
            if (bVar2) {
                if (*(int *)(iVar3 + 0x10) == 0)
                    goto LAB_000516b8;
                FUN_00050820(iVar3, *param_1 == 10);
            } else if (bVar6)
                goto LAB_000516b8;
            FUN_00051008(1, param_1, &local_38, (int)DAT_000cdbd0, DAT_000cdbce,
                         DAT_000cdbcc, param_3);
            goto LAB_000516b8;
        }
    } else {
        if ((((*(int *)(param_1 + 4) == 0) && (*(int *)(param_1 + 6) == 0)) &&
             ((*(int *)(param_1 + 8) == 0 && (*(int *)(param_1 + 10) == 0)))) ||
            ((char)param_1[4] == -1))
            goto LAB_000516b8;
        if ((uVar1 & 0xfff7) != 2) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54(
                "ntp_restrict.c", 0x2f8, 0,
                "2 == ((addr)->sa.sa_family) || 10 == ((addr)->sa.sa_family)");
        }
        bVar6 = false;
        local_34 = 0;
        local_30 = 0;
        local_2c = 0;
        local_28 = 0;
        local_24 = 0;
        local_20 = 0;
        local_38 = (uint)uVar1;
        if (uVar1 != 10)
            goto LAB_00051648;
        memset(&local_30, 0xff, 0x10);
        if (param_2 == 0)
            goto LAB_00051660;
    }
    FUN_00051008(3, param_1, &local_38, 0xfffffffe, 0, 0, 0);
LAB_000516b8:
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000519b8(void)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar3 = __stack_chk_guard;
    itimer._0_4_ = 0;
    itimer._4_4_ = 0;
    itimer._8_4_ = 0;
    itimer._12_4_ = 0;
    getitimer(ITIMER_REAL, (itimerval *)itimer);
    iVar2 = __stack_chk_guard;
    if ((uint)itimer._8_4_ < 2) {
        if ((int)itimer._12_4_ < 0) {
            itimer._12_4_ = 0;
            iVar1 = itimer._8_4_;
        } else {
            iVar1 = itimer._12_4_;
            if (itimer._8_4_ != 0)
                goto LAB_00051a28;
        }
        if (iVar1 == 0) {
            itimer._8_4_ = 1;
        }
    } else {
        itimer._8_4_ = 1;
        if ((int)itimer._12_4_ < 0) {
            itimer._12_4_ = 0;
        }
    }
LAB_00051a28:
    itimer._0_4_ = 1;
    itimer._4_4_ = 0;
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    iVar3 = setitimer(ITIMER_REAL, (itimerval *)itimer, (itimerval *)0x0);
    if (iVar3 == -1) {
        FUN_00075d40(3, "interval timer %s failed, %m", "setitimer");
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00051aa8(void)

{
    int iVar1;
    int iVar2;

    iVar2 = __stack_chk_guard;
    alarm_flag = 0;
    DAT_000cdbd8 = 1;
    DAT_000cdbe0 = "";
    DAT_000cdbe4 = 0;
    DAT_000cdbe8 = 0;
    DAT_000cdbdc = 0xe10;
    alarm_overflow = 0;
    current_time = 0;
    timer_overflows = 0;
    timer_xmtcalls = 0;
    timer_timereset = 0;
    FUN_0007e6c4(0xe, &DAT_00051890);
    iVar1 = __stack_chk_guard;
    itimer._8_4_ = 1;
    itimer._0_4_ = 1;
    itimer._12_4_ = 0;
    itimer._4_4_ = 0;
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    iVar2 = setitimer(ITIMER_REAL, (itimerval *)itimer, (itimerval *)0x0);
    if (iVar2 != -1) {
        if (iVar1 == __stack_chk_guard) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    FUN_00075d40(3, "interval timer %s failed, %m", "setitimer");
    /* WARNING: Subroutine does not return */
    exit(1);
}

/* WARNING: Removing unreachable block (ram,0x00051c20) */

void FUN_00051bb4(int param_1)

{
    if (param_1 == 0) {
        DAT_000cdbec = 0;
    } else {
        DAT_000cdbec = param_1 + current_time;
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00051c7c) */

void FUN_00051c38(undefined4 param_1)

{
    DAT_000cdbe8 = param_1;
    return;
}

void FUN_00051c8c(void)

{
    uint *puVar1;
    char cVar2;
    int *piVar3;
    int iVar4;
    undefined4 uVar5;
    int iVar6;
    uint uVar7;
    char *pcVar8;
    uint uVar9;
    int *piVar10;
    uint uVar11;
    bool bVar12;
    double dVar13;
    time_t tStack_5c;
    undefined4 local_58[2];
    undefined4 local_50;
    undefined4 local_4c;
    undefined4 local_48;
    undefined4 local_44;
    uint local_40;
    undefined4 local_3c;
    undefined4 local_38;
    undefined4 local_34;
    int local_2c;

    local_2c = __stack_chk_guard;
    current_time = (char *)((int)current_time + 1);
    piVar3 = peer_list;
    if (current_time < DAT_000cdbd8) {
    joined_r0x00051ce4:
        if (piVar3 != (int *)0x0) {
            do {
                piVar10 = (int *)*piVar3;
                if (0 < piVar3[0xb2]) {
                    piVar3[0xb2] = piVar3[0xb2] + -1;
                }
                if ((char *)piVar3[0xb4] <= current_time) {
                    if ((piVar3[0x11] & 8U) == 0)
                        goto code_r0x00051d28;
                    FUN_0004a114();
                }
                piVar3 = piVar10;
                if (piVar10 == (int *)0x0)
                    break;
            } while (true);
        }
        goto LAB_00051d34;
    }
    DAT_000cdbd8 = DAT_000cdbd8 + 1;
    FUN_000406f8();
    piVar10 = peer_list;
    if (peer_list != (int *)0x0) {
        do {
            puVar1 = (uint *)(piVar10 + 0x11);
            piVar10 = (int *)*piVar10;
            if ((*puVar1 & 8) != 0) {
                FUN_0004a064();
            }
            piVar3 = peer_list;
        } while (piVar10 != (int *)0x0);
        goto joined_r0x00051ce4;
    }
LAB_00051d34:
    if ((((int)sys_orphan < 0x10) && (sys_peer == 0)) &&
        (orphwait < current_time)) {
        if ((sys_leap == '\x03') && (FUN_00043adc(), crypto_flags != 0)) {
            FUN_00037dec();
        }
        sys_stratum = (undefined1)sys_orphan;
        if ((sys_orphan & 0xff) < 2) {
            sys_refid = 0x504f4f4c;
        } else {
            sys_refid = 0x100007f;
        }
        sys_offset._0_4_ = 0;
        sys_offset._4_4_ = 0;
        sys_rootdelay._0_4_ = 0;
        sys_rootdelay._4_4_ = 0;
        sys_rootdisp._0_4_ = 0;
        sys_rootdisp._4_4_ = 0;
    }
    FUN_0007055c(local_58);
    time(&tStack_5c);
    uVar5 = local_58[0];
    cVar2 = sys_leap;
    if ((leapsec == 0) && (((uint)current_time & 7) != 0)) {
        if (sys_leap == '\x03')
            goto LAB_00051db0;
    } else {
        iVar4 = pll_control;
        if ((pll_control != 0) && (iVar4 = kern_enable, kern_enable != 0)) {
            iVar4 = 1;
        }
        FUN_0003d5fc(iVar4);
        if (cVar2 == '\x03') {
            FUN_0003df74();
            iVar4 = 0;
            local_50 = 0;
            local_4c = 0;
            local_48 = 0;
            local_44 = 0;
            local_40 = 0;
            local_3c = 0;
            local_38 = 0;
            local_34 = 0;
        LAB_00051f10:
            uVar11 = 0;
        LAB_00051f14:
            uVar7 = leapsec;
            if (uVar11 < leapsec) {
                uVar9 = leapsec;
                if (leapsec != 0) {
                    uVar9 = 1;
                }
                if (uVar11 != 0) {
                    uVar9 = 0;
                }
                uVar7 = uVar11;
                if (uVar9 != 0) {
                    FUN_00036294(10, 0);
                }
            }
        LAB_00051f3c:
            leapsec = uVar7;
            leapdif = leapsec;
            if (leapsec == 0)
                goto LAB_00052074;
            uVar7 = (uint)local_3c._2_2_;
            leapdif = uVar7;
        } else {
            iVar4 = FUN_0003dbf8(&local_50, uVar5, &tStack_5c);
            if (iVar4 != 0) {
                dVar13 = (double)(longlong)(int)(short)local_38;
                if (dVar13 < 0.0) {
                    if (clock_max_back <= 0.0) {
                        pcVar8 =
                            "Positive leap second, no step correction. System "
                            "clock will be inaccurate for a long time.";
                    } else if (clock_max_back < -dVar13) {
                        FUN_00070d9c();
                        pcVar8 = "Positive leap second, stepped backward.";
                    } else {
                        pcVar8 =
                            "Positive leap second, no step correction. System "
                            "clock will be inaccurate for a long time.";
                    }
                LAB_00052030:
                    FUN_00075d40(5, "%s", pcVar8);
                } else if (dVar13 != 0.0 && dVar13 >= 0.0) {
                    if (clock_max_fwd <= 0.0) {
                        pcVar8 =
                            "Negative leap second, no step correction. System "
                            "clock will be inaccurate for a long time.";
                    } else if (clock_max_fwd < dVar13) {
                        FUN_00070d9c();
                        pcVar8 = "Negative leap second, stepped forward.";
                    } else {
                        pcVar8 =
                            "Negative leap second, no step correction. System "
                            "clock will be inaccurate for a long time.";
                    }
                    goto LAB_00052030;
                }
                iVar4 = 1;
                FUN_00036294(0xb, 0);
                sys_tai = (int)(short)local_3c;
                leapsec = 0;
                goto LAB_00051f10;
            }
            iVar6 = (int)(short)local_3c;
            uVar11 = local_38 >> 0x10 & 0xff;
            uVar7 = leapsec;
            if (leapsec != 0) {
                uVar7 = 1;
            }
            if (uVar11 < 3) {
                uVar7 = uVar7 | 1;
            }
            iVar4 = iVar6 - sys_tai;
            if (iVar4 != 0) {
                iVar4 = 1;
            }
            sys_tai = iVar6;
            if (uVar7 != 0) {
                if (uVar11 <= leapsec)
                    goto LAB_00051f14;
                uVar7 = uVar11;
                if (leapsec == 0) {
                    if (local_38._3_1_ == '\0') {
                        FUN_00036294(9, 0);
                    } else {
                        FUN_00036294(0x89, sys_peer, 0);
                    }
                }
                goto LAB_00051f3c;
            }
            leapdif = 0;
        LAB_00052074:
            uVar7 = (uint)local_3c._2_2_;
        }
        if (uVar7 != 0) {
            uVar7 = 1;
        }
        if (2 < local_40) {
            uVar7 = 0;
        }
        bVar12 = leap_sec_in_progress != uVar7;
        leap_sec_in_progress = uVar7;
        if (bVar12) {
            FUN_00043adc(sys_leap);
        }
        if (iVar4 != 0) {
            FUN_00037e64();
        }
        if (sys_leap == '\x03')
            goto LAB_00051db0;
        if ((1 < leapsec) && (leapdif != 0)) {
            if ((int)leapdif < 1) {
                uVar5 = 2;
            } else {
                uVar5 = 1;
            }
            FUN_00043adc(uVar5);
            goto LAB_00051db0;
        }
    }
    FUN_00043adc(0);
LAB_00051db0:
    if (DAT_000cdbe4 <= current_time) {
        DAT_000cdbe4 = DAT_000cdbe4 + 900;
        FUN_00040a6c();
    }
    if (DAT_000cdbf0 <= current_time) {
        DAT_000cdbf0 = DAT_000cdbf0 + (1 << (uint)sys_automax);
        FUN_000735e8();
    }
    if ((DAT_000cdbf4 != (char *)0x0) && (DAT_000cdbf4 <= current_time)) {
        DAT_000cdbf4 = DAT_000cdbf4 + (1 << sys_revoke);
        RAND_bytes((uchar *)&sys_private, 4);
    }
    if ((interface_interval != 0) && (DAT_000cdbe8 <= current_time)) {
        FUN_00051c38(current_time + interface_interval);
        FUN_00028ba4(0);
    }
    if ((DAT_000cdbec != (char *)0x0) && (DAT_000cdbec <= current_time)) {
        FUN_0007a5d4();
    }
    if (DAT_000cdbdc <= current_time) {
        DAT_000cdbdc = DAT_000cdbdc + 0xe10;
        FUN_00052798();
        bVar12 = DAT_000cdbe0 <= current_time;
        if (bVar12) {
            DAT_000cdbe0 = "mru_initalloc" + (int)(DAT_000cdbe0 + 0xd);
        }
        FUN_0005342c(bVar12, local_58[0], &tStack_5c);
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
code_r0x00051d28:
    FUN_00046a10();
    piVar3 = piVar10;
    goto joined_r0x00051ce4;
}

/* WARNING: Removing unreachable block (ram,0x0005245c) */

void FUN_000523f0(void)

{
    timer_overflows = 0;
    timer_xmtcalls = 0;
    timer_timereset = current_time;
    return;
}

void ntpd_time_stepped(void)

{
    int iVar1;
    int iVar2;

    iVar2 = __stack_chk_guard;
    iVar1 = mon_enabled;
    if (mon_enabled == 0) {
        return;
    }
    FUN_000412e8(0);
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    FUN_000411c4(iVar1);
    return;
}

void FUN_000524fc(int param_1, undefined4 param_2, undefined4 param_3)

{
    int iVar1;
    int iVar2;
    char *pcVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_0003e0b0(param_2, param_3);
    if (iVar2 == 0) {
        if (iVar1 == __stack_chk_guard) {
            FUN_00075d40(4, "%s (\'%s\'): will expire in less than one day",
                         "leapsecond file", DAT_000cdbf8);
            return;
        }
    } else {
        if (param_1 != 0 && iVar2 < 0x1c) {
            if (iVar2 < 0) {
                if (iVar2 == -1) {
                    pcVar3 = "";
                } else {
                    pcVar3 = "s";
                }
                FUN_00075d40(3, "%s (\'%s\'): expired less than %d day%s ago",
                             "leapsecond file", DAT_000cdbf8, -iVar2, pcVar3);
            } else {
                FUN_00075d40(4, "%s (\'%s\'): will expire in less than %d days",
                             "leapsecond file", DAT_000cdbf8, iVar2 + 1);
            }
        }
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00052660(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_0003cb18(statsdir, "peerstats", &DAT_000cdbfc);
    FUN_0003cb18(statsdir, "loopstats", &DAT_000cdc14);
    FUN_0003cb18(statsdir, "clockstats", &DAT_000cdc2c);
    FUN_0003cb18(statsdir, "rawstats", &DAT_000cdc44);
    FUN_0003cb18(statsdir, "sysstats", &DAT_000cdc5c);
    FUN_0003cb18(statsdir, "protostats", &DAT_000cdc74);
    FUN_0003cb18(statsdir, "cryptostats", &DAT_000cdc8c);
    FUN_0003cb18(statsdir, "timingstats", &DAT_000cdca4);
    step_callback = ntpd_time_stepped;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Globals starting with '_' overlap smaller symbols at the same
 * address */

void FUN_00052798(void)

{
    uint uVar1;
    char *pcVar2;
    FILE *pFVar3;
    int iVar4;
    undefined4 uVar5;
    double dVar6;
    uint local_24;
    undefined4 local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    if (stats_control != 0) {
        FUN_0007055c(&local_24);
        FUN_0003c1c4(&DAT_000cdc5c, local_24);
        pFVar3 = DAT_000cdc5c;
        uVar1 = local_24 / 0x15180;
        local_24 = local_24 % 0x15180;
        if (DAT_000cdc5c != (FILE *)0x0) {
            uVar5 = FUN_0007474c(local_24, local_20, 0, 3, 0);
            __fprintf_chk(
                pFVar3, 1,
                "%lu %s %lu %lu %lu %lu %lu %lu %lu %lu %lu %lu %lu\n",
                uVar1 + 0x3aac, uVar5, current_time - sys_stattime,
                sys_received, sys_processed, sys_newversion, sys_oldversion,
                sys_restricted, sys_badlength, sys_badauth, sys_declined,
                sys_limitrejected, sys_kodsent);
            fflush(DAT_000cdc5c);
            FUN_00049460();
        }
    }
    if (stats_drift_file != (char *)0x0) {
        if (DAT_000cdcc0 <= ABS(_DAT_000cdcc8 - drift_comp)) {
            DAT_000cdcc0 = (double)CONCAT44(wander_threshold._4_4_,
                                            (undefined4)wander_threshold);
            _DAT_000cdcc8 = drift_comp;
            pFVar3 = fopen64(DAT_000cdcd0, "w");
            if (pFVar3 == (FILE *)0x0) {
                FUN_00075d40(3, "frequency file %s: %m", DAT_000cdcd0);
            } else {
                dVar6 = drift_comp * 1000000.0;
                __fprintf_chk(pFVar3, 1, "%.3f\n");
                fclose(pFVar3);
                pcVar2 = DAT_000cdcd0;
                iVar4 = rename(DAT_000cdcd0, stats_drift_file);
                if (iVar4 != 0) {
                    FUN_00075d40(
                        4, "Unable to rename temp drift file %s to %s, %m",
                        pcVar2, stats_drift_file, dVar6);
                }
            }
        } else {
            DAT_000cdcc0 = DAT_000cdcc0 * 0.5;
        }
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00052a9c(undefined4 param_1, undefined4 param_2)

{
    uint uVar1;
    FILE *pFVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    uint local_54;
    undefined4 local_50;
    int local_4c;

    local_4c = __stack_chk_guard;
    if (stats_control != 0) {
        FUN_0007055c(&local_54);
        FUN_0003c1c4(&DAT_000cdbfc, local_54);
        pFVar2 = DAT_000cdbfc;
        uVar1 = local_54 / 0x15180;
        local_54 = local_54 % 0x15180;
        if (DAT_000cdbfc != (FILE *)0x0) {
            uVar3 = FUN_0007474c(local_54, local_50, 0, 3, 0);
            uVar4 = FUN_0007d2c0(param_1);
            __fprintf_chk(pFVar2, 1, "%lu %s %s %x %.9f %.9f %.9f %.9f\n",
                          uVar1 + 0x3aac, uVar3, uVar4, param_2);
            fflush(DAT_000cdbfc);
        }
    }
    if (local_4c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00052bd4(void)

{
    uint uVar1;
    FILE *pFVar2;
    undefined4 uVar3;
    uint local_44;
    undefined4 local_40;
    int local_3c;

    local_3c = __stack_chk_guard;
    if (stats_control != 0) {
        FUN_0007055c(&local_44);
        FUN_0003c1c4(&DAT_000cdc14, local_44);
        pFVar2 = DAT_000cdc14;
        uVar1 = local_44 / 0x15180;
        local_44 = local_44 % 0x15180;
        if (DAT_000cdc14 != (FILE *)0x0) {
            uVar3 = FUN_0007474c(local_44, local_40, 0, 3, 0);
            __fprintf_chk(pFVar2, 1, "%lu %s %.9f %.3f %.9f %.6f %d\n",
                          uVar1 + 0x3aac, uVar3);
            fflush(DAT_000cdc14);
        }
    }
    if (local_3c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00052d0c(undefined4 param_1, undefined4 param_2)

{
    uint uVar1;
    FILE *pFVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    uint local_34;
    undefined4 local_30;
    int local_2c;

    local_2c = __stack_chk_guard;
    if (stats_control != 0) {
        FUN_0007055c(&local_34);
        FUN_0003c1c4(&DAT_000cdc2c, local_34);
        pFVar2 = DAT_000cdc2c;
        uVar1 = local_34 / 0x15180;
        local_34 = local_34 % 0x15180;
        if (DAT_000cdc2c != (FILE *)0x0) {
            uVar3 = FUN_0007474c(local_34, local_30, 0, 3, 0);
            uVar4 = FUN_0007d2c0(param_1);
            __fprintf_chk(pFVar2, 1, "%lu %s %s %s\n", uVar1 + 0x3aac, uVar3,
                          uVar4, param_2);
            fflush(DAT_000cdc2c);
        }
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00052e1c(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    undefined4 uVar1;
    undefined1 auStack_22c[512];
    int local_2c;
    undefined4 uStack_8;
    undefined4 uStack_4;

    local_2c = __stack_chk_guard;
    uStack_8 = param_3;
    uStack_4 = param_4;
    uVar1 = FUN_00075afc(auStack_22c, 0x200, param_2, &uStack_8, &uStack_8);
    if (stats_control != 0) {
        FUN_00052d0c(param_1, auStack_22c);
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar1);
}

void FUN_00052ebc(int param_1, int param_2, undefined4 *param_3,
                  undefined4 *param_4, undefined4 *param_5, undefined4 *param_6,
                  undefined4 param_7, undefined4 param_8, undefined4 param_9,
                  undefined4 param_10, undefined4 param_11, undefined4 param_12,
                  undefined4 param_13, int param_14, undefined1 *param_15)

{
    uint uVar1;
    FILE *pFVar2;
    undefined4 uVar3;
    undefined *puVar4;
    undefined4 uVar5;
    undefined4 uVar6;
    undefined4 uVar7;
    undefined4 uVar8;
    undefined1 *puVar9;
    undefined *local_4c;
    uint local_44;
    undefined4 local_40;
    int local_3c;
    undefined1 *puVar10;

    local_3c = __stack_chk_guard;
    if (stats_control != 0) {
        FUN_0007055c(&local_44);
        FUN_0003c1c4(&DAT_000cdc44, local_44);
        pFVar2 = DAT_000cdc44;
        uVar1 = local_44 / 0x15180;
        local_44 = local_44 % 0x15180;
        if (DAT_000cdc44 != (FILE *)0x0) {
            uVar3 = FUN_0007474c(local_44, local_40, 0, 3, 0);
            if (param_1 == 0) {
                local_4c = &DAT_000a844c;
            } else {
                local_4c = (undefined *)FUN_0007d2c0(param_1);
            }
            if (param_2 == 0) {
                puVar4 = &DAT_000a844c;
            } else {
                puVar4 = (undefined *)FUN_0007d2c0(param_2);
            }
            uVar5 = FUN_0007474c(*param_3, param_3[1], 0, 9, 0);
            uVar6 = FUN_0007474c(*param_4, param_4[1], 0, 9, 0);
            uVar7 = FUN_0007474c(*param_5, param_5[1], 0, 9, 0);
            uVar8 = FUN_0007474c(*param_6, param_6[1], 0, 9, 0);
            FUN_0007a72c(param_13, param_10);
            __fprintf_chk(
                pFVar2, 1,
                "%lu %s %s %s %s %s %s %s %d %d %d %d %d %d %.6f %.6f %s",
                uVar1 + 0x3aac, uVar3, local_4c, puVar4, uVar5, uVar6, uVar7,
                uVar8, param_7, param_8, param_9, param_10, param_11, param_12);
            if (0 < param_14) {
                __fprintf_chk(DAT_000cdc44, 1, &DAT_000a8488, param_14, uVar3,
                              local_4c, puVar4, uVar5, uVar6, uVar7, uVar8,
                              param_7, param_8, param_9, param_10, param_11,
                              param_12);
                puVar10 = param_15;
                do {
                    puVar9 = puVar10 + 1;
                    __fprintf_chk(DAT_000cdc44, 1, &DAT_000a8490, *puVar10,
                                  uVar3, local_4c, puVar4, uVar5, uVar6, uVar7,
                                  uVar8, param_7, param_8, param_9, param_10,
                                  param_11, param_12);
                    puVar10 = puVar9;
                } while (puVar9 != param_15 + param_14);
            }
            fputc(10, DAT_000cdc44);
            fflush(DAT_000cdc44);
        }
    }
    if (local_3c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000531d4(undefined4 param_1)

{
    uint uVar1;
    FILE *pFVar2;
    undefined4 uVar3;
    uint local_24;
    undefined4 local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    if (stats_control != 0) {
        FUN_0007055c(&local_24);
        FUN_0003c1c4(&DAT_000cdc74, local_24);
        pFVar2 = DAT_000cdc74;
        uVar1 = local_24 / 0x15180;
        local_24 = local_24 % 0x15180;
        if (DAT_000cdc74 != (FILE *)0x0) {
            uVar3 = FUN_0007474c(local_24, local_20, 0, 3, 0);
            __fprintf_chk(pFVar2, 1, "%lu %s %s\n", uVar1 + 0x3aac, uVar3,
                          param_1);
            fflush(DAT_000cdc74);
        }
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000532d0(int param_1, undefined4 param_2)

{
    uint uVar1;
    FILE *pFVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    int iVar5;
    uint local_2c;
    undefined4 local_28;
    int local_24;

    local_24 = __stack_chk_guard;
    if (stats_control != 0) {
        FUN_0007055c(&local_2c);
        FUN_0003c1c4(&DAT_000cdc8c, local_2c);
        pFVar2 = DAT_000cdc8c;
        uVar1 = local_2c / 0x15180;
        local_2c = local_2c % 0x15180;
        iVar5 = uVar1 + 0x3aac;
        if (DAT_000cdc8c != (FILE *)0x0) {
            if (param_1 == 0) {
                uVar3 = FUN_0007474c(local_2c, local_28, 0, 3, 0);
                __fprintf_chk(pFVar2, 1, "%lu %s 0.0.0.0 %s\n", iVar5, uVar3,
                              param_2);
            } else {
                uVar3 = FUN_0007474c(local_2c, local_28, 0, 3, 0);
                uVar4 = FUN_0007d2c0(param_1);
                __fprintf_chk(pFVar2, 1, "%lu %s %s %s\n", iVar5, uVar3, uVar4,
                              param_2);
            }
            fflush(DAT_000cdc8c);
        }
    }
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0005342c(undefined4 param_1, undefined4 param_2, undefined4 param_3)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if ((DAT_000cdbf8 == (char *)0x0) || (*DAT_000cdbf8 == '\0')) {
    LAB_00053470:
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else {
        iVar2 = FUN_0003e9c8(DAT_000cdbf8, &DAT_000cdcd8, DAT_000cdcd4 == 0,
                             param_1);
        if (iVar2 == 0) {
            if (DAT_000cdcd4 == 0)
                goto LAB_00053470;
        } else {
            DAT_000cdcd4 = 1;
        }
        if (iVar1 == __stack_chk_guard) {
            FUN_000524fc(param_1, param_2, param_3);
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00053500(char *param_1)

{
    size_t sVar1;
    char *__filename;
    FILE *__stream;
    char *pcVar2;
    uint uVar3;
    int iVar4;
    EVP_MD *pEVar5;
    __int32_t **pp_Var6;
    int *piVar7;
    char *pcVar8;
    char *pcVar9;
    ushort **ppuVar10;
    undefined4 uVar11;
    undefined1 *extraout_r2;
    undefined1 *puVar12;
    byte *pbVar13;
    undefined1 *puVar14;
    uint uVar15;
    byte *pbVar16;
    uint uVar17;
    __int32_t *p_Var18;
    uint uVar19;
    bool bVar20;
    int local_290;
    int *local_284;
    char *local_270;
    uint local_26c;
    short local_268[14];
    undefined1 local_24c[32];
    char acStack_22c[512];
    int local_2c;
    undefined1 auStack_28[12];
    int local_1c;

    local_1c = __stack_chk_guard;
    sVar1 = strlen(param_1);
    if (sVar1 == 0) {
        if (local_1c == __stack_chk_guard) {
            return;
        }
    } else {
        DAT_000cdd40 = (void *)FUN_00074b04(DAT_000cdd40, sVar1 + 1, 0);
        __filename = (char *)memcpy(DAT_000cdd40, param_1, sVar1 + 1);
        if (local_1c == __stack_chk_guard) {
            local_2c = __stack_chk_guard;
            __stream = fopen64(__filename, "r");
            if (__stream != (FILE *)0x0) {
                if (ssl_init_done == 0) {
                    FUN_0007d690();
                }
                local_26c = 0;
                local_284 = (int *)0x0;
            LAB_00073af4:
                do {
                    local_270 = fgets(acStack_22c, 0x200, __stream);
                    if ((local_270 == (char *)0x0) || (0xf < local_26c))
                        goto LAB_00073e78;
                    pcVar2 = (char *)FUN_00073838(&local_270);
                    if (pcVar2 != (char *)0x0) {
                        uVar3 = strtol(pcVar2, (char **)0x0, 10);
                        if (uVar3 == 0) {
                            FUN_00073950(&local_26c,
                                         "authreadkeys: cannot change key %s",
                                         pcVar2);
                        } else if (uVar3 < 0x10000) {
                            iVar4 = FUN_00073838(&local_270);
                            if (iVar4 == 0) {
                                FUN_00073950(
                                    &local_26c,
                                    "authreadkeys: no key type for key %d",
                                    uVar3);
                            } else {
                                local_290 = FUN_0007d8e8(iVar4, 0);
                                if (local_290 == 0) {
                                    FUN_00073950(
                                        0,
                                        "authreadkeys: invalid type for key %d",
                                        uVar3);
                                    pcVar2 = (char *)FUN_00073838(&local_270);
                                } else {
                                    if (local_290 != 0x37e) {
                                        pcVar2 = OBJ_nid2sn(local_290);
                                        pEVar5 = EVP_get_digestbyname(pcVar2);
                                        if (pEVar5 == (EVP_MD *)0x0) {
                                            FUN_00073950(0,
                                                         "authreadkeys: no "
                                                         "algorithm for key %d",
                                                         uVar3);
                                            local_290 = 0;
                                        }
                                    }
                                    pcVar2 = (char *)FUN_00073838(&local_270);
                                }
                                if (pcVar2 == (char *)0x0) {
                                    FUN_00073950(
                                        &local_26c,
                                        "authreadkeys: no key for key %d",
                                        uVar3);
                                } else {
                                    sVar1 = strlen(pcVar2);
                                    if (sVar1 < 0x15) {
                                        piVar7 = (int *)FUN_00074b04(
                                            0, sVar1 + 0x14, 0);
                                        piVar7[2] = uVar3;
                                        *(undefined2 *)(piVar7 + 3) =
                                            (undefined2)local_290;
                                        *(short *)((int)piVar7 + 0xe) =
                                            (short)sVar1;
                                        piVar7[1] = 0;
                                        memcpy(piVar7 + 4, pcVar2, sVar1);
                                    } else {
                                        pbVar16 = (byte *)(pcVar2 + -1);
                                        uVar19 = 0;
                                        if (0x3f < sVar1) {
                                            sVar1 = 0x40;
                                        }
                                        pp_Var6 = __ctype_tolower_loc();
                                        p_Var18 = *pp_Var6;
                                        do {
                                            pbVar16 = pbVar16 + 1;
                                            pcVar2 = strchr("0123456789abcdef",
                                                            p_Var18[*pbVar16]);
                                            if (pcVar2 == (char *)0x0) {
                                                if (uVar19 < sVar1) {
                                                    FUN_00073950(
                                                        &local_26c,
                                                        "authreadkeys: invalid "
                                                        "hex digit for key %d",
                                                        uVar3);
                                                    goto LAB_00073af4;
                                                }
                                                break;
                                            }
                                            bVar20 = (uVar19 & 1) == 0;
                                            puVar12 = extraout_r2;
                                            if (!bVar20) {
                                                puVar12 =
                                                    auStack_28 + (uVar19 >> 1);
                                            }
                                            puVar14 = auStack_28;
                                            if (bVar20) {
                                                puVar14 =
                                                    puVar14 + (uVar19 >> 1);
                                            }
                                            uVar19 = uVar19 + 1;
                                            if (bVar20) {
                                                puVar14[-0x224] =
                                                    (char)(((uint)(pcVar2 +
                                                                   -0xac270) &
                                                            0xff)
                                                           << 4);
                                            } else {
                                                puVar12[-0x224] =
                                                    (byte)(pcVar2 + -0xac270) |
                                                    puVar12[-0x224];
                                            }
                                        } while (uVar19 != sVar1);
                                        uVar19 = sVar1 >> 1;
                                        piVar7 = (int *)FUN_00074b04(
                                            0, uVar19 + 0x14, 0);
                                        *(undefined2 *)(piVar7 + 3) =
                                            (undefined2)local_290;
                                        piVar7[2] = uVar3;
                                        *(short *)((int)piVar7 + 0xe) =
                                            (short)uVar19;
                                        piVar7[1] = 0;
                                        memcpy(piVar7 + 4, local_24c, uVar19);
                                    }
                                    pcVar2 = (char *)FUN_00073838(&local_270);
                                    while (pcVar2 != (char *)0x0) {
                                        pcVar8 = strchr(pcVar2, 0x2c);
                                        if (pcVar8 != (char *)0x0) {
                                            *pcVar8 = '\0';
                                        }
                                        pcVar9 = strchr(pcVar2, 0x2f);
                                        if (pcVar9 == (char *)0x0) {
                                            iVar4 = FUN_00074fd8(pcVar2, 0,
                                                                 local_268);
                                            if (iVar4 != 0) {
                                            LAB_00073df4:
                                                uVar19 = 0xffffffff;
                                                goto LAB_00073dc4;
                                            }
                                        LAB_00073e34:
                                            FUN_00073950(
                                                &local_26c,
                                                "authreadkeys: invalid IP "
                                                "address <%s> for key %d",
                                                pcVar2, uVar3);
                                        } else {
                                            uVar17 = (uint)(byte)pcVar9[1];
                                            uVar19 = 0;
                                            pbVar16 = (byte *)(pcVar9 + 1);
                                            *pcVar9 = '\0';
                                            if (uVar17 == 0) {
                                                iVar4 = FUN_00074fd8(pcVar2, 0,
                                                                     local_268);
                                                if (iVar4 != 0) {
                                                    uVar19 = 0;
                                                    goto LAB_00073dc4;
                                                }
                                                goto LAB_00073e34;
                                            }
                                            ppuVar10 = __ctype_b_loc();
                                            pbVar13 = pbVar16;
                                            do {
                                                uVar15 = (((*ppuVar10)[uVar17] ^
                                                           0x800)
                                                          << 0x14) >>
                                                         0x1f;
                                                if (1000 < uVar19) {
                                                    uVar15 = 1;
                                                }
                                                if (uVar15 != 0) {
                                                    FUN_00073950(
                                                        &local_26c,
                                                        "authreadkeys: Invalid "
                                                        "character in subnet "
                                                        "specification for "
                                                        "<%s/%s> in key %d",
                                                        pbVar13, pbVar16,
                                                        uVar3);
                                                    goto LAB_00073d34;
                                                }
                                                iVar4 = uVar17 - 0x30;
                                                pbVar13 = pbVar13 + 1;
                                                uVar17 = (uint)*pbVar13;
                                                uVar19 = iVar4 + uVar19 * 10;
                                            } while (uVar17 != 0);
                                            iVar4 = FUN_00074fd8(pcVar2, 0,
                                                                 local_268);
                                            if (iVar4 == 0)
                                                goto LAB_00073e34;
                                            if (uVar19 == 0xffffffff)
                                                goto LAB_00073df4;
                                            if (local_268[0] == 2) {
                                                if (0x20 < uVar19)
                                                    goto LAB_00073dac;
                                            } else if (local_268[0] == 10 &&
                                                       0x80 < uVar19) {
                                            LAB_00073dac:
                                                FUN_00073950(
                                                    0,
                                                    "authreadkeys: excessive "
                                                    "subnet mask <%s/%s> for "
                                                    "key %d",
                                                    pcVar2, pbVar16, uVar3);
                                            }
                                        LAB_00073dc4:
                                            iVar4 = FUN_0007258c(
                                                piVar7[1], local_268, uVar19);
                                            piVar7[1] = iVar4;
                                        }
                                    LAB_00073d34:
                                        if (pcVar8 == (char *)0x0)
                                            break;
                                        pcVar2 = pcVar8 + 1;
                                    }
                                    if (local_290 == 0) {
                                        FUN_000739d0(piVar7);
                                    } else {
                                        *piVar7 = (int)local_284;
                                        local_284 = piVar7;
                                    }
                                }
                            }
                        } else {
                            FUN_00073950(&local_26c,
                                         "authreadkeys: key %s > %d reserved "
                                         "for Autokey",
                                         pcVar2, 0xffff);
                        }
                    }
                } while (true);
            }
            FUN_00075d40(3, "authreadkeys: file \'%s\': %m", __filename);
            uVar11 = 0;
            goto LAB_00073edc;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
LAB_00073e78:
    fclose(__stream);
    if (local_26c == 0) {
        FUN_00073510();
        while (local_284 != (int *)0x0) {
            piVar7 = (int *)*local_284;
            FUN_000733b4(local_284[2], *(undefined2 *)(local_284 + 3),
                         local_284 + 4, *(undefined2 *)((int)local_284 + 0xe),
                         local_284[1]);
            local_284[1] = 0;
            FUN_000739d0(local_284);
            local_284 = piVar7;
        }
        uVar11 = 1;
    } else {
        if (local_26c < 0x10) {
            pcVar2 = "";
        } else {
            pcVar2 = " (emergency break)";
        }
        FUN_00075d40(3,
                     "authreadkeys: rejecting file \'%s\' after %u error(s)%s",
                     __filename, local_26c, pcVar2);
        while (local_284 != (int *)0x0) {
            local_284 = (int *)*local_284;
            FUN_000739d0();
        }
        uVar11 = 0;
    }
LAB_00073edc:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar11);
}

void FUN_00053614(undefined4 param_1)

{
    int iVar1;
    uint uVar2;
    undefined1 *__s;
    undefined2 local_28[2];
    undefined1 local_24;
    undefined1 local_23;
    undefined1 local_22;
    undefined1 local_21;
    int local_1c;

    local_1c = __stack_chk_guard;
    __s = lib_stringbuf + lib_nextbuf * 0x80;
    uVar2 = lib_nextbuf + 1;
    memset(__s, 0, 0x80);
    lib_nextbuf = uVar2 & 0xf;
    iVar1 = FUN_00077758(local_28, param_1, 0);
    if (iVar1 < 0) {
        FUN_0007d00c(__s, 0x80, "ntpcal_ntp_to_date: %ld: range error",
                     param_1);
    } else {
        FUN_0007d00c(__s, 0x80, "%04d%02d%02d%02d%02d", local_28[0], local_24,
                     local_23, local_22, local_21);
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

/* WARNING: Globals starting with '_' overlap smaller symbols at the same
 * address */

void FUN_00053708(undefined4 param_1, char *param_2)

{
    size_t sVar1;
    void *pvVar2;
    int iVar3;
    undefined4 uVar4;
    undefined4 uVar5;
    FILE *pFVar6;
    __pid_t _Var7;
    char *pcVar8;
    time_t tStack_4c;
    undefined4 local_48[2];
    undefined4 local_40;
    undefined4 uStack_3c;
    short local_38;
    char local_34[4];
    undefined2 local_30;
    int local_2c;

    local_34[0] = '.';
    local_34[1] = 'T';
    local_34[2] = 'E';
    local_34[3] = 'M';
    local_2c = __stack_chk_guard;
    local_30 = 0x50;
    switch (param_1) {
    case 1:
        if ((param_2 != (char *)0x0) && (sVar1 = strlen(param_2), sVar1 != 0)) {
            stats_drift_file =
                (char *)FUN_00074b04(stats_drift_file, sVar1 + 1, 0);
            pvVar2 = (void *)FUN_00074b04(DAT_000cdcd0, sVar1 + 6, 0);
            DAT_000cdcd0 = pvVar2;
            memcpy(stats_drift_file, param_2, sVar1 + 1);
            memcpy(pvVar2, param_2, sVar1);
            *(char(*)[4])((int)pvVar2 + sVar1) = local_34;
            pcVar8 = stats_drift_file;
            *(undefined2 *)((int)pvVar2 + sVar1 + 4) = local_30;
            pFVar6 = fopen64(pcVar8, "r");
            if (pFVar6 != (FILE *)0x0) {
                iVar3 = fscanf(pFVar6, "%lf", &local_40);
                if (iVar3 == 1) {
                    fclose(pFVar6);
                    FUN_00040b38(local_40, 0xc);
                    _DAT_000cdcc8 = (undefined4)drift_comp;
                    DAT_000cdccc = drift_comp._4_4_;
                } else {
                    FUN_00075d40(3, "format error frequency file %s",
                                 stats_drift_file);
                    fclose(pFVar6);
                }
            }
        }
        break;
    case 2:
        sVar1 = strlen(param_2);
        if (sVar1 < 0xff) {
            if ((sVar1 == 0) || (param_2[sVar1 - 1] == '/')) {
                FUN_0007d00c(statsdir, 0x100, "%s", param_2);
            } else {
                FUN_0007d00c(statsdir, 0x100, &DAT_0009e610, param_2, 0x2f);
            }
            FUN_0003cc3c();
        } else {
            FUN_00075d40(3, "statsdir too long (>%d, sigh)", 0xfe);
        }
        break;
    case 3:
        pFVar6 = fopen64(param_2, "w");
        if (pFVar6 == (FILE *)0x0) {
            FUN_00075d40(3, "pid file %s: %m", param_2);
        } else {
            _Var7 = getpid();
            __fprintf_chk(pFVar6, 1, "%d", _Var7);
            fclose(pFVar6);
        }
        break;
    case 4:
        if ((param_2 != (char *)0x0) && (sVar1 = strlen(param_2), sVar1 != 0)) {
            pvVar2 = (void *)FUN_00074b04(DAT_000cdbf8, sVar1 + 1, 0);
            DAT_000cdbf8 = pvVar2;
            memcpy(pvVar2, param_2, sVar1 + 1);
            iVar3 = FUN_0003e9c8(pvVar2, &DAT_000cdcd8, 1);
            if (iVar3 != 0) {
                FUN_0007055c(local_48);
                time(&tStack_4c);
                FUN_0003dfc4(&local_40);
                uVar4 = FUN_00053614(uStack_3c);
                iVar3 = FUN_0003e02c(local_48[0], 0);
                if (iVar3 == 0) {
                    pcVar8 = "expires";
                } else {
                    pcVar8 = "expired";
                }
                uVar5 = FUN_00053614(local_40);
                FUN_000366ac(0xe, 0, "%d leap %s %s %s", (int)local_38, uVar4,
                             pcVar8, uVar5);
                DAT_000cdcd4 = 1;
                FUN_000524fc(1, local_48[0], &tStack_4c);
            }
        }
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00053da8(int param_1)

{
    bool bVar1;
    byte bVar2;
    int iVar3;
    undefined1 *puVar4;
    undefined4 uVar5;
    undefined1 *puVar6;
    uint uVar7;
    undefined4 *puVar8;
    uint uVar9;
    int iVar10;
    undefined8 uVar11;
    double dVar12;
    double dVar13;
    undefined4 uVar14;
    undefined4 *puVar15;
    int *piVar16;

    iVar3 = __stack_chk_guard;
    iVar10 = *(int *)(param_1 + 0x54);
    puVar8 = (undefined4 *)**(undefined4 **)(*(int *)(param_1 + 4) + 0x54);
    bVar2 = *(byte *)((int)puVar8 + 0x49);
    uVar9 = (uint)bVar2;
    if (uVar9 == 0) {
        uVar5 = *(undefined4 *)(param_1 + 0x4c);
        puVar8[4] = *(undefined4 *)(param_1 + 0x48);
        puVar8[5] = uVar5;
        if (iVar10 < 1) {
            *(byte *)((int)puVar8 + 0x49) = bVar2;
        } else {
        LAB_00053e00:
            puVar4 = (undefined1 *)(param_1 + 0x57);
            puVar6 = (undefined1 *)((int)puVar8 + uVar9 + 0x40);
            uVar7 = uVar9;
            do {
                uVar7 = uVar7 + 1;
                puVar4 = puVar4 + 1;
                puVar6 = puVar6 + 1;
                *puVar6 = *puVar4;
            } while (uVar7 < 8 && (int)(uVar7 - uVar9) < iVar10);
            *(char *)((int)puVar8 + 0x49) = (char)uVar7;
            if (6 < uVar7)
                goto LAB_00053e8c;
        }
    } else {
        if (0 < iVar10 && uVar9 < 8)
            goto LAB_00053e00;
        *(byte *)((int)puVar8 + 0x49) = bVar2;
        if (uVar9 < 7)
            goto LAB_00053e48;
    LAB_00053e8c:
        iVar10 = (short)(ushort)(*(byte *)((int)puVar8 + 0x46) >> 4) * 100 +
                 (*(byte *)((int)puVar8 + 0x46) & 0xf) * 10 +
                 (uint)(*(byte *)((int)puVar8 + 0x47) >> 4);
        puVar8[0xe] = iVar10;
        puVar8[0xf] = iVar10 * 1000;
        puVar8[10] = (short)(*(byte *)((int)puVar8 + 0x41) & 0xf) * 100 +
                     (uint)(*(byte *)((int)puVar8 + 0x42) >> 4) * 10 +
                     (*(byte *)((int)puVar8 + 0x42) & 0xf);
        puVar8[0xd] =
            (((uint) * (byte *)((int)puVar8 + 0x45) << 0x19) >> 0x1d) * 10 +
            (*(byte *)((int)puVar8 + 0x45) & 0xf);
        puVar8[0xb] =
            (((uint) * (byte *)((int)puVar8 + 0x43) << 0x1a) >> 0x1e) * 10 +
            (*(byte *)((int)puVar8 + 0x43) & 0xf);
        puVar8[0xc] =
            (((uint) * (byte *)(puVar8 + 0x11) << 0x19) >> 0x1d) * 10 +
            (*(byte *)(puVar8 + 0x11) & 0xf);
        puVar15 = puVar8 + 8;
        uVar5 = puVar8[4];
        uVar14 = 0;
        piVar16 = puVar8 + 6;
        iVar10 = FUN_00074318();
        if (iVar10 == 0) {
            if (iVar3 == __stack_chk_guard) {
                FUN_00075d40(3, "Datum_PTS: Bad clocktime");
                return;
            }
            goto LAB_0005409c;
        }
        uVar11 = VectorShiftRight(CONCAT44(puVar8[0xf], puVar8[0xf]), 0x20);
        uVar11 = VectorShiftLeft(uVar11, 0x20, 0x40, 0);
        uVar9 = FUN_0009d518((uint)uVar11 + 500000,
                             (int)((ulonglong)uVar11 >> 0x20) +
                                 (uint)(0xfff85edf < (uint)uVar11),
                             &DAT_000f4240, 0, uVar14, uVar5, puVar15, piVar16);
        iVar10 = puVar8[6] - puVar8[4];
        if (uVar9 < uVar9 - puVar8[5]) {
            iVar10 = iVar10 + -1;
        }
        puVar8[9] = puVar8[9] + 1;
        uVar9 = uVar9 - puVar8[5] >> 0xc | iVar10 << 0x14;
        puVar8[6] = puVar8[4];
        puVar8[7] = puVar8[5];
        FUN_0004a534(*puVar8);
        dVar12 =
            (double)FixedToFP(CONCAT44(uVar9, uVar9), 0x20, 0x40, 0x14, 0, 0);
        dVar13 = *(double *)(puVar8 + 0x14);
        if (dVar12 < 0.0) {
            dVar12 = -dVar12;
        }
        if (dVar13 == 0.0) {
            bVar1 = dVar12 < 0.1;
            if (bVar1) {
                dVar12 = dVar12 * dVar12;
            } else {
                puVar8[0x14] = 0x47ae147c;
                puVar8[0x15] = 0x3f847ae1;
            }
            if (bVar1) {
                *(double *)(puVar8 + 0x14) = dVar12;
            }
        } else {
            if (dVar12 < 0.1) {
                dVar12 = dVar12 * 0.05 * dVar12 + dVar13 * 0.95;
            } else {
                dVar12 = dVar13 * 0.95 + 0.0005000000000000001;
            }
            *(double *)(puVar8 + 0x14) = dVar12;
        }
    }
LAB_00053e48:
    if (iVar3 == __stack_chk_guard) {
        return;
    }
LAB_0005409c:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0005485c(int param_1)

{
    char cVar1;
    int iVar2;
    int *piVar3;
    size_t sVar4;
    ssize_t sVar5;
    int iVar6;
    undefined4 uVar7;
    char *pcVar8;
    uint uVar9;
    undefined4 *puVar10;
    int iVar11;
    int iVar12;
    int iVar13;
    int iVar14;
    int iVar15;
    int iVar16;
    bool bVar17;

    iVar2 = __stack_chk_guard;
    iVar11 = *(int *)(param_1 + 4);
    puVar10 = *(undefined4 **)(iVar11 + 0x54);
    piVar3 = (int *)*puVar10;
    if (*piVar3 == 0) {
        *piVar3 = 1;
    LAB_00054a9c:
        if (iVar2 == __stack_chk_guard) {
            return;
        }
        goto LAB_00054ba0;
    }
    if (*(int *)(param_1 + 0x54) < 0x18) {
    LAB_00054af0:
        FUN_00049c88(iVar11);
        return;
    }
    pcVar8 = (char *)(param_1 + 0x58);
    cVar1 = *(char *)(param_1 + 0x58);
    while (cVar1 != '\x10') {
        pcVar8 = pcVar8 + 1;
        cVar1 = *pcVar8;
    }
    uVar9 =
        (short)(ushort)((byte)pcVar8[2] >> 4) * 10 + ((byte)pcVar8[2] & 0xf);
    puVar10[0x2f] = uVar9;
    if (uVar9 == 0x5e) {
        FUN_00049c88(iVar11, 2);
        sVar5 = write(puVar10[7], &DAT_000c7df0, 0x1a);
        if (sVar5 != 0x1a) {
            if (iVar2 == __stack_chk_guard)
                goto LAB_00054af0;
            goto LAB_00054ba0;
        }
        goto LAB_00054a9c;
    }
    if (uVar9 < 99) {
        uVar9 = uVar9 + 100;
    }
    puVar10[0x2f] = uVar9 + 0x76c;
    iVar12 = piVar3[2];
    iVar14 = (short)((byte)pcVar8[3] & 0xf) * 100 +
             (uint)((byte)pcVar8[4] >> 4) * 10 + ((byte)pcVar8[4] & 0xf);
    puVar10[0x30] = iVar14;
    if (iVar12 < 0xb) {
        puVar10[0x31] = (short)(ushort)((byte)pcVar8[5] >> 4) * 10 +
                        ((byte)pcVar8[5] & 0xf);
    LAB_0005495c:
        iVar6 = (short)(ushort)((byte)pcVar8[5] >> 4) * 10 +
                ((byte)pcVar8[5] & 0xf);
        puVar10[0x31] = iVar6;
        iVar16 = (short)(ushort)((byte)pcVar8[6] >> 4) * 10 +
                 ((byte)pcVar8[6] & 0xf);
        puVar10[0x32] = iVar16;
        iVar13 = (short)(ushort)((byte)pcVar8[7] >> 4) * 10 +
                 ((byte)pcVar8[7] & 0xf);
        puVar10[0x33] = iVar13;
        iVar15 = ((short)(ushort)((byte)pcVar8[8] >> 4) * 10 +
                  ((byte)pcVar8[8] & 0xf)) *
                 1000000;
        puVar10[0x34] = iVar15;
        puVar10[0x34] = (uint)((byte)pcVar8[9] >> 4) * 1000 + iVar15;
        if (iVar6 == 10)
            goto LAB_00054b58;
    } else {
        iVar6 = (short)(ushort)((byte)pcVar8[6] >> 4) * 10 +
                ((byte)pcVar8[6] & 0xf);
        puVar10[0x31] = iVar6;
        if (iVar6 != 10)
            goto LAB_0005495c;
        iVar16 = (short)(ushort)((byte)pcVar8[7] >> 4) * 10 +
                 ((byte)pcVar8[7] & 0xf);
        puVar10[0x32] = iVar16;
        iVar13 = (short)(ushort)((byte)pcVar8[8] >> 4) * 10 +
                 ((byte)pcVar8[8] & 0xf);
        puVar10[0x33] = iVar13;
        iVar6 = ((short)(ushort)((byte)pcVar8[9] >> 4) * 10 +
                 ((byte)pcVar8[9] & 0xf)) *
                1000000;
        puVar10[0x34] = iVar6;
        puVar10[0x34] = (uint)((byte)pcVar8[10] >> 4) * 1000 + iVar6;
    LAB_00054b58:
        if (iVar16 == 10) {
            piVar3[2] = iVar12 + 1;
        }
        iVar6 = 10;
    }
    FUN_0007d00c(puVar10 + 0xe, 0x80, "%d %d %d %d %d", uVar9 + 0x76c, iVar14,
                 iVar6, iVar16, iVar13);
    sVar4 = strlen((char *)(puVar10 + 0xe));
    puVar10[0x3e] = 0x88e368f1;
    puVar10[0x3f] = 0x3ee4f8b5;
    puVar10[0x2e] = sVar4;
    uVar7 = *(undefined4 *)(param_1 + 0x4c);
    puVar10[0x3a] = *(undefined4 *)(param_1 + 0x48);
    puVar10[0x3b] = uVar7;
    iVar12 = FUN_0004a4e8(puVar10);
    if (iVar12 == 0) {
        FUN_00049c88(iVar11, 6);
    }
    bVar17 = iVar2 == __stack_chk_guard;
    puVar10[0x38] = puVar10[0x3a];
    puVar10[0x39] = puVar10[0x3b];
    if (bVar17) {
        FUN_0004a534(iVar11);
        return;
    }
LAB_00054ba0:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00054d48(byte *param_1, undefined4 *param_2)

{
    uint uVar1;
    uint uVar2;
    uint uVar3;
    int iVar4;
    ushort **ppuVar5;
    int *piVar6;
    uint uVar7;
    byte *pbVar8;
    uint uVar9;
    uint uVar10;
    uint uVar11;
    uint uVar12;
    uint uVar13;
    ushort *puVar14;
    bool bVar15;
    bool bVar16;
    byte *local_3c;

    iVar4 = __stack_chk_guard;
    if (*param_1 == 0x2d) {
        local_3c = param_1 + 1;
        uVar11 = 2;
        uVar12 = 0;
        uVar13 = 0x80000000;
    } else {
        uVar12 = 0xffffffff;
        uVar13 = 0x7fffffff;
        uVar11 = 0;
        local_3c = param_1;
        if (*param_1 == 0x2b) {
            local_3c = param_1 + 1;
        }
    }
    ppuVar5 = __ctype_b_loc();
    uVar9 = 0;
    uVar10 = 0;
    puVar14 = *ppuVar5;
    pbVar8 = local_3c;
    while (true) {
        if ((puVar14[*pbVar8] & 0x800) == 0)
            break;
        bVar16 = 0xccccccb < uVar10;
        bVar15 = uVar10 == 0xccccccc;
        uVar7 = *pbVar8 - 0x30;
        if (bVar15) {
            bVar16 = 0xcccccccb < uVar9;
        }
        if (bVar16 && (!bVar15 || uVar9 != 0xcccccccc)) {
            ppuVar5 = (ushort **)0x1;
        }
        if (!bVar16 || bVar15 && uVar9 == 0xcccccccc) {
            ppuVar5 = (ushort **)0x0;
        }
        bVar16 = CARRY4(uVar9, uVar9);
        uVar1 = uVar9 * 2;
        bVar15 = CARRY4(uVar9, uVar9 * 4);
        uVar3 = uVar9 * 5;
        uVar2 = uVar9 * 10;
        uVar9 = uVar2 + uVar7;
        uVar10 = (uVar10 * 5 + (uint)bVar16 * 2 + (uint)CARRY4(uVar1, uVar1) +
                  (uint)bVar15) *
                     2 +
                 (uint)CARRY4(uVar3, uVar3) + ((int)uVar7 >> 0x1f) +
                 (uint)CARRY4(uVar2, uVar7);
        bVar16 = uVar13 <= uVar10;
        if (uVar10 == uVar13) {
            bVar16 = uVar12 <= uVar9;
        }
        if (bVar16 && (uVar10 != uVar13 || uVar9 != uVar12)) {
            ppuVar5 = (ushort **)((uint)ppuVar5 | 1);
        }
        uVar11 = uVar11 | (uint)ppuVar5;
        pbVar8 = pbVar8 + 1;
    }
    if (local_3c == pbVar8) {
        piVar6 = __errno_location();
        *piVar6 = 0x16;
        pbVar8 = param_1;
    }
    if ((uVar11 & 1) != 0) {
        piVar6 = __errno_location();
        *piVar6 = 0x22;
        uVar9 = uVar12;
        uVar10 = uVar13;
    }
    uVar11 = (uVar11 << 0x1e) >> 0x1f;
    if (param_2 != (undefined4 *)0x0) {
        *param_2 = pbVar8;
    }
    if (uVar9 == 0 && uVar10 == 0) {
        uVar11 = 0;
    }
    if (uVar11 != 0) {
        bVar16 = uVar9 != 0;
        uVar9 = -uVar9;
        uVar10 = -(uVar10 + bVar16);
    }
    if (iVar4 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar9, uVar10);
}

void FUN_00054ee8(void)

{
    bool bVar1;
    int iVar2;
    uint uVar3;
    int in_r3;
    uint uVar4;
    int iVar5;
    uint uVar6;
    int *piVar7;
    int iVar8;
    double dVar9;
    undefined8 uVar10;

    iVar2 = __stack_chk_guard;
    piVar7 = *(int **)(in_r3 + 0x54);
    iVar5 = *piVar7;
    dVar9 = *(double *)(piVar7 + 0xba);
    iVar8 = *(int *)(iVar5 + 8);
    bVar1 = dVar9 < 0.0;
    if (iVar8 == in_r3) {
        if (bVar1) {
            dVar9 = -dVar9;
        }
        uVar4 = (uint)bVar1;
        dVar9 = ldexp(dVar9, 0x20);
        uVar10 = FUN_0009d558(SUB84(dVar9, 0), (int)((ulonglong)dVar9 >> 0x20));
        uVar3 = (uint)uVar10 ^ -uVar4;
        *(uint *)(iVar5 + 0x78) = uVar4 + uVar3;
        *(uint *)(iVar5 + 0x74) =
            ((uint)((ulonglong)uVar10 >> 0x20) ^ -(uint)(uVar4 != 0)) +
            (uint)CARRY4(uVar4, uVar3);
        if ((*(byte *)(piVar7 + 0xc0) & 1) == 0) {
            *(uint *)(iVar8 + 0x44) = *(uint *)(iVar8 + 0x44) & 0xffffff7f;
        }
    } else {
        if (bVar1) {
            dVar9 = -dVar9;
        }
        uVar4 = (uint)bVar1;
        dVar9 = ldexp(dVar9, 0x20);
        uVar10 = FUN_0009d558(SUB84(dVar9, 0), (int)((ulonglong)dVar9 >> 0x20));
        uVar3 = (uint)uVar10 ^ -uVar4;
        *(uint *)(iVar5 + 0x6c) =
            ((uint)((ulonglong)uVar10 >> 0x20) ^ -(uint)(uVar4 != 0)) +
            (uint)CARRY4(uVar4, uVar3);
        dVar9 = *(double *)(piVar7 + 0xbc);
        *(uint *)(iVar5 + 0x70) = uVar4 + uVar3;
        bVar1 = dVar9 < 0.0;
        if (bVar1) {
            dVar9 = -dVar9;
        }
        uVar6 = (uint)bVar1;
        dVar9 = ldexp(dVar9, 0x20);
        uVar10 = FUN_0009d558(SUB84(dVar9, 0), (int)((ulonglong)dVar9 >> 0x20));
        uVar3 = (uint)uVar10 ^ -uVar6;
        *(uint *)(iVar5 + 0x7c) =
            ((uint)((ulonglong)uVar10 >> 0x20) ^ -(uint)(uVar6 != 0)) +
            (uint)CARRY4(uVar3, uVar6);
        uVar4 = *(uint *)(in_r3 + 0x4c);
        *(uint *)(iVar5 + 0x80) = uVar3 + uVar6;
        if (((uVar4 ^ *(uint *)(iVar5 + 0x10)) & 3) != 0) {
            iVar8 = **(int **)(in_r3 + 0x54);
            if ((*(uint *)(iVar5 + 0x10) & 3) == 2) {
                *(undefined4 *)(iVar8 + 0x48) = 0;
                *(byte *)(iVar8 + 0x84) = *(byte *)(iVar8 + 0x84) & 0xef;
            }
            *(byte *)(iVar8 + 0x84) = *(byte *)(iVar8 + 0x84) & 0xf9;
            iVar8 = **(int **)(in_r3 + 0x54);
            uVar3 = *(uint *)(in_r3 + 0x4c) & 3;
            *(uint *)(iVar5 + 0x10) = uVar3;
            if (uVar3 == 2) {
                *(undefined4 *)(iVar8 + 0x48) = 0x1e;
                *(byte *)(iVar8 + 0x84) = *(byte *)(iVar8 + 0x84) & 0xef;
            }
            *(byte *)(iVar8 + 0x84) = *(byte *)(iVar8 + 0x84) & 0xf9;
        }
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_000550bc(undefined4 param_1, int param_2)

{
    int iVar1;
    undefined4 uVar2;
    undefined4 *puVar3;
    int iVar4;
    undefined4 *puVar5;
    undefined4 *__ptr;
    undefined4 *puVar6;

    iVar1 = __stack_chk_guard;
    puVar6 = *(undefined4 **)(param_2 + 0x54);
    __ptr = (undefined4 *)*puVar6;
    if (__ptr != (undefined4 *)0x0) {
        if (__ptr[2] != param_2) {
            if (puVar6[7] != -1) {
                FUN_000290fc(puVar6 + 2);
                puVar6[7] = 0xffffffff;
            }
            if (__ptr[0x22] != -1) {
                close(__ptr[0x22]);
            }
        }
        iVar4 = __ptr[1];
        __ptr[1] = iVar4 + -1;
        if (iVar4 + -1 == 0) {
            puVar3 = &DAT_000cdd70;
            puVar5 = DAT_000cdd70;
            while (puVar5 != (undefined4 *)0x0) {
                if (__ptr == puVar5) {
                    puVar5 = (undefined4 *)*__ptr;
                    *puVar3 = puVar5;
                } else {
                    puVar3 = puVar5;
                    puVar5 = (undefined4 *)*puVar5;
                }
            }
            free((void *)__ptr[5]);
            free((void *)__ptr[6]);
            free(__ptr);
        }
        *puVar6 = 0;
        if ((ntp_syslogmask & 0x100) != 0) {
            uVar2 = FUN_0007b36c(param_2 + 0x10);
            if (iVar1 == __stack_chk_guard) {
                FUN_00075d40(5, "%s: shutdown", uVar2);
                return;
            }
            goto LAB_000551e8;
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_000551e8:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00055200(undefined4 param_1, int param_2, undefined4 param_3,
                  undefined4 param_4, undefined4 param_5)

{
    int iVar1;

    *(undefined4 *)(param_2 + 0xe0) = param_3;
    *(undefined4 *)(param_2 + 0xe4) = param_4;
    iVar1 = __stack_chk_guard;
    if (*(int *)(param_2 + 0xd8) == *(int *)(param_2 + 0xdc)) {
        FUN_00049c88(param_1, 0);
    }
    if (iVar1 == __stack_chk_guard) {
        FUN_0004a258((int)*(undefined8 *)(param_2 + 0x2e8), param_2, param_3,
                     param_4, param_5);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000552a0(int param_1, char *param_2)

{
    int iVar1;
    int iVar2;
    size_t __n;

    iVar1 = __stack_chk_guard;
    if (param_2 == (char *)0x0) {
        __n = 0;
    } else {
        __n = strlen(param_2);
        if (0x7e < __n) {
            __n = 0x7f;
        }
        memcpy((void *)(param_1 + 0x38), param_2, __n);
    }
    iVar2 = __stack_chk_guard;
    *(size_t *)(param_1 + 0xb8) = __n;
    *(undefined1 *)(param_1 + __n + 0x38) = 0;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00055330(int param_1, int param_2)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = param_1 + param_2 * 0x14;
    iVar2 = *(int *)(iVar3 + 8);
    iVar3 = *(int *)(iVar3 + 0x14);
    if (iVar2 == 1) {
        iVar3 = iVar3 << 1;
    } else if (iVar2 != 2) {
        iVar2 = *(int *)(param_1 + 4);
        param_2 = param_2 + 1;
        goto LAB_000553b4;
    }
    param_2 = param_2 + 1;
    if (iVar3 == 0) {
        iVar2 = *(int *)(param_1 + 4);
    } else {
        iVar2 = *(int *)(param_1 + 4);
        do {
            if ((-1 < param_2) && (param_2 < iVar2)) {
                param_2 = FUN_00055330(param_1);
            }
            iVar3 = iVar3 + -1;
        } while (iVar3 != 0);
    }
LAB_000553b4:
    if ((-1 < param_2) && (param_2 <= iVar2)) {
        iVar2 = param_2;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2);
}

void FUN_000553fc(int *param_1, undefined4 param_2, byte *param_3, int param_4)

{
    byte bVar1;
    ushort **ppuVar2;
    byte *pbVar3;
    byte *pbVar4;
    uint uVar5;
    byte *pbVar6;
    byte *pbVar7;
    int iVar8;
    byte abStack_34[8];
    int local_2c;

    iVar8 = *param_1;
    local_2c = __stack_chk_guard;
    if (1 < debug) {
        pbVar4 = &DAT_000cdd74;
        pbVar6 = param_3;
    LAB_00055474:
        if (pbVar4 != (byte *)0xce573 && param_3 + param_4 != pbVar6) {
            pbVar7 = pbVar6 + 1;
            bVar1 = *pbVar6;
            uVar5 = (uint)bVar1;
            pbVar6 = pbVar7;
            if (uVar5 == 0x5c) {
                pbVar7 = &DAT_000a86ec;
                pbVar3 = pbVar4;
                do {
                    pbVar4 = pbVar3;
                    if (*pbVar7 == 0)
                        break;
                    pbVar4 = pbVar3 + 1;
                    *pbVar3 = *pbVar7;
                    pbVar7 = pbVar7 + 1;
                    pbVar3 = pbVar4;
                } while (pbVar4 != (byte *)0xce573);
            } else {
                ppuVar2 = __ctype_b_loc();
                if (((*ppuVar2)[uVar5] & 0x4000) == 0) {
                    FUN_0007d00c(abStack_34, 6, "\\%03o", uVar5);
                    pbVar7 = abStack_34;
                    pbVar3 = pbVar4;
                    do {
                        pbVar4 = pbVar3;
                        if (*pbVar7 == 0)
                            break;
                        pbVar4 = pbVar3 + 1;
                        *pbVar3 = *pbVar7;
                        pbVar7 = pbVar7 + 1;
                        pbVar3 = pbVar4;
                    } while (pbVar4 != (byte *)0xce573);
                } else {
                    *pbVar4 = bVar1;
                    pbVar4 = pbVar4 + 1;
                }
            }
            goto LAB_00055474;
        }
        *pbVar4 = 0;
        FUN_00075c68("%s[%s]: \'%s\'\n", *(undefined4 *)(iVar8 + 0x14), param_2,
                     &DAT_000cdd74);
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0005558c(int *param_1)

{
    int iVar1;
    char *pcVar2;
    int *piVar3;
    uint uVar4;
    int iVar5;
    int local_28;
    pollfd local_24;
    int local_1c;

    iVar5 = *param_1;
    local_24.fd = *(int *)(iVar5 + 0x88);
    local_24.events = 4;
    local_1c = __stack_chk_guard;
    iVar1 = poll(&local_24, 1, 0);
    if ((iVar1 != 1) || ((local_24.revents & 4U) == 0))
        goto LAB_000555e0;
    *(undefined4 *)(iVar5 + 0x90) = 10;
    local_24.fd = 4;
    local_28 = 0;
    iVar1 = getsockopt(*(int *)(iVar5 + 0x88), 1, 4, &local_28,
                       (socklen_t *)&local_24);
    if (iVar1 == -1) {
        if (local_28 == 0) {
            piVar3 = __errno_location();
            local_28 = *piVar3;
        }
    LAB_00055644:
        pcVar2 = strerror(local_28);
        if (((*(byte *)(param_1 + 0xc0) & 4) != 0) ||
            (*(int *)(iVar5 + 0xb4) == 0xe10 || *(int *)(iVar5 + 0xb4) == 0)) {
            *(undefined4 *)(iVar5 + 0xb4) = 0xe10;
            FUN_00075d40(3,
                         "%s: async connect to GPSD failed, fd=%d, ec=%d(%s)",
                         *(undefined4 *)(iVar5 + 0x14),
                         *(undefined4 *)(iVar5 + 0x88), local_28, pcVar2);
        }
    } else {
        if (local_28 != 0)
            goto LAB_00055644;
        param_1[7] = *(int *)(iVar5 + 0x88);
        *(undefined4 *)(iVar5 + 0x88) = 0xffffffff;
        iVar1 = FUN_00029084(param_1 + 2);
        if (iVar1 != 0)
            goto LAB_000555e0;
        if (((*(byte *)(param_1 + 0xc0) & 4) != 0) ||
            (*(int *)(iVar5 + 0xb4) == 0xe10 || *(int *)(iVar5 + 0xb4) == 0)) {
            *(undefined4 *)(iVar5 + 0xb4) = 0xe10;
            FUN_00075d40(3, "%s: failed to register with I/O engine",
                         *(undefined4 *)(iVar5 + 0x14));
        }
    }
    if (*(int *)(iVar5 + 0x88) != -1) {
        close(*(int *)(iVar5 + 0x88));
    }
    *(undefined4 *)(iVar5 + 0x88) = 0xffffffff;
    uVar4 = *(int *)(iVar5 + 0x94) + 5;
    *(int *)(iVar5 + 0x90) = *(int *)(iVar5 + 0x94);
    if (0x77 < uVar4) {
        uVar4 = 0x78;
    }
    *(uint *)(iVar5 + 0x94) = uVar4;
LAB_000555e0:
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00055754(undefined4 param_1, int param_2)

{
    int iVar1;
    int *piVar2;
    int __type;
    int __protocol;
    uint uVar3;
    int iVar4;
    int *piVar5;
    int iVar6;
    undefined4 local_20;
    int local_1c;

    piVar5 = *(int **)(param_2 + 0x54);
    iVar4 = *piVar5;
    iVar6 = *(int *)(iVar4 + 8);
    local_1c = __stack_chk_guard;
    if (iVar6 == param_2) {
        if (*(int *)(iVar4 + 0x4c) < 1) {
            *(undefined4 *)(iVar4 + 0x4c) = 0;
        } else {
            iVar1 = *(int *)(iVar4 + 0x4c) + -1;
            *(int *)(iVar4 + 0x4c) = iVar1;
            if (iVar1 != 0)
                goto LAB_000557dc;
        }
        if (piVar5[0x36] != piVar5[0x37]) {
            FUN_00049c88(iVar6, 1);
            piVar5[0x36] = piVar5[0x37];
        }
        *(uint *)(iVar6 + 0x44) = *(uint *)(iVar6 + 0x44) & 0xffffff7f;
        goto LAB_000557dc;
    }
    if (*(int *)(iVar4 + 0xb4) != 0) {
        *(int *)(iVar4 + 0xb4) = *(int *)(iVar4 + 0xb4) + -1;
    }
    if (*(int *)(iVar4 + 0x90) != 0) {
        iVar6 = *(int *)(iVar4 + 0x90) + -1;
        *(int *)(iVar4 + 0x90) = iVar6;
        if (iVar6 == 0)
            goto LAB_000557f4;
        if (iVar6 == 4) {
            if (piVar5[7] != -1) {
                FUN_000553fc(piVar5, &DAT_000a8770, "?VERSION;\r\n", 0xb);
                write(piVar5[7], "?VERSION;\r\n", 0xb);
                goto LAB_000557dc;
            }
            iVar4 = *(int *)(iVar4 + 0x88);
        } else {
            if (piVar5[7] != -1)
                goto LAB_000557dc;
            iVar4 = *(int *)(iVar4 + 0x88);
        }
        if (iVar4 == -1)
            goto LAB_000557dc;
    LAB_000557d4:
        FUN_0005558c(piVar5);
        goto LAB_000557dc;
    }
LAB_000557f4:
    if (piVar5[7] != -1) {
        if (((*(byte *)(piVar5 + 0xc0) & 4) != 0) ||
            (*(int *)(iVar4 + 0xb4) == 0xe10 || *(int *)(iVar4 + 0xb4) == 0)) {
            *(undefined4 *)(iVar4 + 0xb4) = 0xe10;
            FUN_00075d40(6, "%s: closing socket to GPSD, fd=%d",
                         *(undefined4 *)(iVar4 + 0x14), piVar5[7]);
        }
        FUN_000290fc(piVar5 + 2);
        iVar6 = *(int *)(iVar4 + 0x94);
        piVar5[7] = -1;
        uVar3 = iVar6 + 5;
        *(int *)(iVar4 + 0x90) = iVar6;
        if (0x77 < uVar3) {
            uVar3 = 0x78;
        }
        *(byte *)(iVar4 + 0x84) = *(byte *)(iVar4 + 0x84) & 0x99;
        *(uint *)(iVar4 + 0x94) = uVar3;
        goto LAB_000557dc;
    }
    if (*(int *)(iVar4 + 0x88) != -1)
        goto LAB_000557d4;
    if (DAT_000ce574 == 0)
        goto LAB_000557dc;
    iVar6 = *(int *)(iVar4 + 0x8c);
    if (*(int *)(iVar4 + 0x8c) == 0) {
        iVar6 = DAT_000ce574;
    }
    __protocol = *(int *)(iVar6 + 0xc);
    __type = *(int *)(iVar6 + 8);
    iVar1 = *(int *)(iVar6 + 4);
    *(undefined4 *)(iVar4 + 0x8c) = *(undefined4 *)(iVar6 + 0x1c);
    iVar1 = socket(iVar1, __type, __protocol);
    *(int *)(iVar4 + 0x88) = iVar1;
    if (iVar1 == -1) {
        if (((*(byte *)(piVar5 + 0xc0) & 4) != 0) ||
            (*(int *)(iVar4 + 0xb4) == 0xe10 || *(int *)(iVar4 + 0xb4) == 0)) {
            *(undefined4 *)(iVar4 + 0xb4) = 0xe10;
            FUN_00075d40(3, "%s: cannot create GPSD socket: %m",
                         *(undefined4 *)(iVar4 + 0x14));
            goto LAB_00055884;
        }
        iVar6 = piVar5[7];
        if (iVar6 != -1)
            goto LAB_00055890;
    } else {
        iVar1 = fcntl(iVar1, 4, 0x800, 1);
        if (iVar1 == -1) {
            if (((*(byte *)(piVar5 + 0xc0) & 4) != 0) ||
                (*(int *)(iVar4 + 0xb4) == 0xe10 ||
                 *(int *)(iVar4 + 0xb4) == 0)) {
                *(undefined4 *)(iVar4 + 0xb4) = 0xe10;
                FUN_00075d40(3,
                             "%s: cannot set GPSD socket to non-blocking: %m",
                             *(undefined4 *)(iVar4 + 0x14));
            }
        } else {
            local_20 = 1;
            iVar1 = setsockopt(*(int *)(iVar4 + 0x88), 6, 1, &local_20, 4);
            if ((iVar1 == -1) && (((*(byte *)(piVar5 + 0xc0) & 4) != 0 ||
                                   (*(int *)(iVar4 + 0xb4) == 0xe10 ||
                                    *(int *)(iVar4 + 0xb4) == 0)))) {
                *(undefined4 *)(iVar4 + 0xb4) = 0xe10;
                FUN_00075d40(6, "%s: cannot disable TCP nagle: %m",
                             *(undefined4 *)(iVar4 + 0x14));
            }
            iVar6 =
                connect(*(int *)(iVar4 + 0x88), *(sockaddr **)(iVar6 + 0x14),
                        *(socklen_t *)(iVar6 + 0x10));
            if (iVar6 == -1) {
                piVar2 = __errno_location();
                if (*piVar2 == 0x73)
                    goto LAB_000557dc;
                if (((*(byte *)(piVar5 + 0xc0) & 4) != 0) ||
                    (*(int *)(iVar4 + 0xb4) == 0xe10 ||
                     *(int *)(iVar4 + 0xb4) == 0)) {
                    *(undefined4 *)(iVar4 + 0xb4) = 0xe10;
                    FUN_00075d40(3, "%s: cannot connect GPSD socket: %m",
                                 *(undefined4 *)(iVar4 + 0x14));
                }
            } else {
                piVar5[7] = *(int *)(iVar4 + 0x88);
                *(undefined4 *)(iVar4 + 0x88) = 0xffffffff;
                iVar6 = FUN_00029084(piVar5 + 2);
                if (iVar6 != 0)
                    goto LAB_000557dc;
                if (((*(byte *)(piVar5 + 0xc0) & 4) != 0) ||
                    (*(int *)(iVar4 + 0xb4) == 0xe10 ||
                     *(int *)(iVar4 + 0xb4) == 0)) {
                    *(undefined4 *)(iVar4 + 0xb4) = 0xe10;
                    FUN_00075d40(3, "%s: failed to register with I/O engine",
                                 *(undefined4 *)(iVar4 + 0x14));
                }
            }
        }
    LAB_00055884:
        iVar6 = piVar5[7];
        if (iVar6 != -1) {
        LAB_00055890:
            close(iVar6);
        }
        if (*(int *)(iVar4 + 0x88) != -1) {
            close(*(int *)(iVar4 + 0x88));
        }
    }
    iVar6 = *(int *)(iVar4 + 0x94);
    piVar5[7] = -1;
    uVar3 = iVar6 + 5;
    *(undefined4 *)(iVar4 + 0x88) = 0xffffffff;
    *(int *)(iVar4 + 0x90) = iVar6;
    if (0x77 < uVar3) {
        uVar3 = 0x78;
    }
    *(uint *)(iVar4 + 0x94) = uVar3;
LAB_000557dc:
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00055cc8(undefined4 param_1, int param_2)

{
    int iVar1;
    undefined4 uVar2;
    int iVar3;
    int *piVar4;
    int iVar5;
    bool bVar6;

    iVar1 = __stack_chk_guard;
    piVar4 = *(int **)(param_2 + 0x54);
    iVar3 = *piVar4;
    iVar5 = *(int *)(iVar3 + 8);
    piVar4[0xc2] = piVar4[0xc2] + 1;
    if (iVar5 == param_2) {
        if (piVar4[0x36] == piVar4[0x37]) {
            bVar6 = iVar1 == __stack_chk_guard;
            *(undefined1 *)(iVar5 + 0x5f) = 0xec;
            *(uint *)(iVar5 + 0x44) = *(uint *)(iVar5 + 0x44) & 0xffffff7f;
            if (bVar6) {
                FUN_00049c88(iVar5, 1);
                return;
            }
        } else {
            piVar4[0x38] = piVar4[0x3a];
            piVar4[0x39] = piVar4[0x3b];
            FUN_00049c88(iVar5, 0);
            if (iVar1 == __stack_chk_guard) {
                FUN_0004a534(iVar5);
                return;
            }
        }
    } else {
        if (piVar4[0x36] == piVar4[0x37]) {
            *(undefined1 *)(param_2 + 0x5f) = 0xf7;
            if (piVar4[7] == -1) {
                FUN_00049c88(param_2, 3);
            } else {
                if (*(int *)(iVar3 + 0x9c) == 0) {
                    uVar2 = 1;
                } else {
                    uVar2 = 2;
                }
                FUN_00049c88(param_2, uVar2);
            }
        } else {
            piVar4[0x38] = piVar4[0x3a];
            piVar4[0x39] = piVar4[0x3b];
            FUN_00049c88(param_2, 0);
            FUN_0004a534(param_2);
        }
        if ((*(byte *)(piVar4 + 0xc0) & 8) != 0) {
            FUN_00052e1c(
                param_2 + 0x10, "%u %u %u %u %u %u %u",
                *(undefined4 *)(iVar3 + 0x98), *(undefined4 *)(iVar3 + 0x9c),
                *(undefined4 *)(iVar3 + 0xa0), *(undefined4 *)(iVar3 + 0xa4),
                *(undefined4 *)(iVar3 + 0xa8), *(undefined4 *)(iVar3 + 0xac),
                *(undefined4 *)(iVar3 + 0xb0));
        }
        iVar5 = __stack_chk_guard;
        *(undefined4 *)(iVar3 + 0x9c) = 0;
        *(undefined4 *)(iVar3 + 0x98) = 0;
        *(undefined4 *)(iVar3 + 0xa0) = 0;
        *(undefined4 *)(iVar3 + 0xa4) = 0;
        *(undefined4 *)(iVar3 + 0xa8) = 0;
        *(undefined4 *)(iVar3 + 0xac) = 0;
        *(undefined4 *)(iVar3 + 0xb0) = 0;
        if (iVar1 == iVar5) {
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00055e90(undefined4 *param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    void *pvVar2;
    uint uVar3;
    size_t __size;
    undefined4 uStack_8;
    undefined4 uStack_4;

    iVar1 = __stack_chk_guard;
    pvVar2 = (void *)0x0;
    __size = 0x20;
    *param_1 = 0;
    uStack_8 = param_3;
    uStack_4 = param_4;
    while (true) {
        __size = __size * 2;
        free(pvVar2);
        pvVar2 = malloc(__size);
        *param_1 = pvVar2;
        if (pvVar2 == (void *)0x0)
            break;
        uVar3 =
            FUN_0007c654(pvVar2, __size, &DAT_000a885c, &uStack_8, &uStack_8);
        if (uVar3 < __size)
            goto LAB_00055f18;
        pvVar2 = (void *)*param_1;
    }
    uVar3 = 0xffffffff;
LAB_00055f18:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_000563fc(int *param_1, char *param_2, int param_3)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int iVar4;
    int iVar5;
    int iVar6;

    iVar1 = __stack_chk_guard;
    iVar5 = param_1[1];
    if ((((0 < iVar5) && (param_1[2] == 1)) &&
         (iVar4 = param_1[5], iVar4 != 0)) &&
        (2 < iVar5)) {
        iVar6 = 2;
        iVar3 = 1;
        do {
            if (param_1[iVar3 * 5 + 2] == 3) {
                iVar2 = strcmp(param_2,
                               (char *)(*param_1 + param_1[iVar3 * 5 + 3]));
                iVar3 = iVar6;
                if (iVar2 == 0) {
                    if ((-1 < param_3) && (param_3 != param_1[iVar6 * 5 + 2])) {
                        iVar6 = -1;
                    }
                    goto LAB_000564e8;
                }
            joined_r0x00056504:
                if ((iVar3 < iVar5) &&
                    (iVar3 = FUN_00055330(param_1), iVar3 < 0))
                    break;
            } else if (iVar3 < iVar5) {
                iVar3 = FUN_00055330(param_1);
                if (-1 < iVar3)
                    goto joined_r0x00056504;
                break;
            }
            iVar4 = iVar4 + -1;
            if ((iVar4 == 0) || (iVar6 = iVar3 + 1, iVar5 <= iVar6))
                break;
        } while (true);
    }
    iVar6 = -1;
LAB_000564e8:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar6);
}

void FUN_00056544(int *param_1, undefined4 param_2)

{
    int iVar1;
    int *piVar2;
    char *pcVar3;
    undefined8 uVar4;
    char *local_18;
    int local_14;

    local_14 = __stack_chk_guard;
    iVar1 = FUN_000563fc(param_1, param_2, 0);
    if ((iVar1 == -1) || (pcVar3 = (char *)(*param_1 + param_1[iVar1 * 5 + 3]),
                          pcVar3 == (char *)0x0)) {
        piVar2 = __errno_location();
        uVar4 = 0;
        *piVar2 = 0x16;
    } else {
        uVar4 = FUN_00054d48(pcVar3, &local_18);
        if ((pcVar3 == local_18) || (*local_18 != '\0')) {
            uVar4 = 0;
        }
    }
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail((int)uVar4, (int)((ulonglong)uVar4 >> 0x20));
}

void FUN_00056608(int *param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4, int param_5)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    int iVar4;
    int iVar5;
    int iVar6;
    undefined4 uVar7;
    undefined8 uVar8;

    iVar2 = __stack_chk_guard;
    uVar7 = 0;
    piVar3 = __errno_location();
    *piVar3 = 0;
    iVar4 = FUN_00056544(param_2, param_3);
    iVar5 = FUN_00056544(param_2, param_4);
    if (*piVar3 == 0) {
        iVar5 = iVar5 * param_5;
        iVar6 = iVar5;
        if (iVar5 < 0) {
            do {
                iVar4 = iVar4 + -1;
                iVar6 = iVar6 + 1000000000;
            } while (iVar6 < 0);
        } else if (999999999 < iVar5) {
            iVar6 = iVar5 + -1000000000;
            iVar1 = iVar5 + -1999999999;
            if (iVar6 < 1000000000) {
                iVar4 = iVar4 + 1;
            } else {
                iVar5 = iVar5 + -0x77360000;
            }
            if (iVar6 != 999999999 && iVar1 < 0 == SBORROW4(iVar6, 999999999)) {
                iVar4 = iVar4 + 2;
                iVar6 = iVar5 + 0x6c00;
            }
        }
        uVar8 = VectorShiftRight(CONCAT44(iVar6, iVar6), 0x20);
        uVar8 = VectorShiftLeft(uVar8, 0x20, 0x40, 0);
        *param_1 = iVar4 + -0x7c558180;
        uVar7 = 1;
        iVar4 = FUN_0009d518((uint)uVar8 + 500000000,
                             (int)((ulonglong)uVar8 >> 0x20) +
                                 (uint)(0xe2329aff < (uint)uVar8),
                             1000000000, 0);
        param_1[1] = iVar4;
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar7);
}

void FUN_00056750(int *param_1, undefined4 param_2)

{
    char cVar1;
    int iVar2;
    int iVar3;

    iVar2 = __stack_chk_guard;
    iVar3 = FUN_000563fc(param_1, param_2, 0);
    if (iVar3 != -1) {
        if (*param_1 + param_1[iVar3 * 5 + 3] == 0) {
            iVar3 = -1;
        } else {
            cVar1 = *(char *)(*param_1 + param_1[iVar3 * 5 + 3]);
            if (cVar1 == 'f') {
                iVar3 = 0;
            } else if (cVar1 == 't') {
                iVar3 = 1;
            } else {
                iVar3 = -1;
            }
        }
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar3);
    }
    return;
}

void FUN_000567e4(int *param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    char *pcVar2;
    undefined8 uVar3;
    char *local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    iVar1 = FUN_000563fc(param_1, param_2, 0);
    if (iVar1 != -1) {
        pcVar2 = (char *)(*param_1 + param_1[iVar1 * 5 + 3]);
        if (pcVar2 != (char *)0x0) {
            uVar3 = FUN_00054d48(pcVar2, &local_20);
            if ((pcVar2 != local_20) && (*local_20 == '\0'))
                goto LAB_0005686c;
        }
    }
    uVar3 = CONCAT44(param_4, param_3);
LAB_0005686c:
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail((int)uVar3, (int)((ulonglong)uVar3 >> 0x20));
}

void FUN_00056890(uint *param_1, int param_2, uint param_3, int param_4,
                  uint param_5)

{
    char cVar1;
    byte bVar2;
    int iVar3;
    int iVar4;
    int iVar5;
    uint uVar6;
    uint uVar7;
    uint uVar8;
    byte *pbVar9;
    undefined4 uVar10;
    uint uVar11;
    uint uVar12;
    int iVar13;
    int *piVar14;
    uint uVar15;
    int iVar16;
    bool bVar17;
    bool bVar18;

    iVar3 = __stack_chk_guard;
    uVar15 = *param_1;
    if (uVar15 < param_3) {
        uVar11 = (uint) * (byte *)(param_2 + uVar15);
        if (uVar11 != 0) {
            iVar5 = 0;
        LAB_00056914:
            iVar4 = iVar5;
            if (uVar11 == 0x2c) {
                if ((param_4 == 0) ||
                    (*(int *)(param_4 + param_1[2] * 0x14) - 1U < 2))
                    goto LAB_00056b74;
                uVar12 = *param_1;
                param_1[2] = *(uint *)(param_4 + param_1[2] * 0x14 + 0x10);
                goto LAB_000568f8;
            }
            if (0x2c < uVar11) {
                if (uVar11 == 0x5d) {
                LAB_00056c1c:
                    if (param_4 == 0)
                        goto LAB_00056b74;
                    if (uVar11 == 0x7d) {
                        iVar16 = 1;
                    } else {
                        iVar16 = 2;
                    }
                    if (param_1[1] != 0) {
                        iVar13 = param_1[1] * 0x14 + -0x14;
                        while (true) {
                            piVar14 = (int *)(param_4 + iVar13);
                            if ((piVar14[1] != -1) && (piVar14[2] == -1)) {
                                if (iVar16 != *piVar14)
                                    goto LAB_00056f14;
                                piVar14[2] = uVar15 + 1;
                                uVar12 = *param_1;
                                param_1[2] = piVar14[4];
                                goto LAB_000568f8;
                            }
                            if (piVar14[4] == -1)
                                break;
                            iVar13 = piVar14[4] * 0x14;
                        }
                        uVar15 = *param_1;
                        goto LAB_00056b78;
                    }
                LAB_00056f14:
                    iVar5 = -2;
                } else {
                    if (uVar11 < 0x5e) {
                        if (uVar11 == 0x3a) {
                            uVar12 = *param_1;
                            param_1[2] = param_1[1] - 1;
                            goto LAB_000568f8;
                        }
                        if (uVar11 != 0x5b)
                            goto LAB_00056d64;
                    } else if (uVar11 != 0x7b) {
                        if (uVar11 != 0x7d)
                            goto LAB_00056d64;
                        goto LAB_00056c1c;
                    }
                    iVar4 = iVar5 + 1;
                    if (param_4 == 0)
                        goto LAB_00056b74;
                    uVar6 = param_1[1];
                    if (uVar6 < param_5) {
                        uVar12 = param_1[2];
                        iVar4 = param_4 + uVar6 * 0x14;
                        param_1[1] = uVar6 + 1;
                        *(undefined4 *)(iVar4 + 8) = 0xffffffff;
                        *(undefined4 *)(iVar4 + 4) = 0xffffffff;
                        *(undefined4 *)(iVar4 + 0xc) = 0;
                        *(undefined4 *)(iVar4 + 0x10) = 0xffffffff;
                        if (uVar12 != 0xffffffff) {
                            iVar16 = param_4 + uVar12 * 0x14;
                            *(int *)(iVar16 + 0xc) = *(int *)(iVar16 + 0xc) + 1;
                            *(uint *)(iVar4 + 0x10) = uVar12;
                        }
                        uVar12 = *param_1;
                        if (uVar11 == 0x7b) {
                            uVar10 = 1;
                        } else {
                            uVar10 = 2;
                        }
                        *(undefined4 *)(param_4 + uVar6 * 0x14) = uVar10;
                        *(uint *)(iVar4 + 4) = uVar15;
                        param_1[2] = uVar6;
                        iVar4 = iVar5 + 1;
                        goto LAB_000568f8;
                    }
                    iVar5 = -1;
                }
                goto LAB_00056b4c;
            }
            if (uVar11 == 0xd)
                goto LAB_00056b74;
            if (uVar11 < 0xe) {
                if (1 < uVar11 - 9)
                    goto LAB_00056d64;
                goto LAB_00056b74;
            }
            if (uVar11 == 0x20)
                goto LAB_00056b74;
            if (uVar11 != 0x22) {
            LAB_00056d64:
                uVar11 = *param_1;
                if (uVar11 < param_3) {
                    pbVar9 = (byte *)(param_2 + uVar11);
                    bVar2 = *(byte *)(param_2 + uVar11);
                    while ((uVar12 = (uint)bVar2,
                            uVar12 != 0 && (uVar12 != 0x20))) {
                        if (uVar12 < 0x21) {
                            if ((8 < uVar12) &&
                                ((uVar12 < 0xb || (uVar12 == 0xd))))
                                break;
                        } else {
                            if (uVar12 == 0x3a)
                                break;
                            if (uVar12 < 0x3b) {
                                if (uVar12 == 0x2c)
                                    break;
                            } else if ((uVar12 == 0x5d) || (uVar12 == 0x7d))
                                break;
                        }
                        if (0x5e < uVar12 - 0x20)
                            goto switchD_000569b0_default;
                        uVar11 = uVar11 + 1;
                        *param_1 = uVar11;
                        if (param_3 <= uVar11)
                            break;
                        pbVar9 = pbVar9 + 1;
                        bVar2 = *pbVar9;
                    }
                }
                if (param_4 != 0) {
                    uVar12 = param_1[1];
                    if (param_5 <= uVar12)
                        goto LAB_00056e78;
                    uVar6 = param_1[2];
                    iVar4 = param_4 + uVar12 * 0x14;
                    param_1[1] = uVar12 + 1;
                    *(undefined4 *)(param_4 + uVar12 * 0x14) = 0;
                    *(uint *)(iVar4 + 4) = uVar15;
                    uVar12 = uVar11 - 1;
                    *(uint *)(iVar4 + 8) = uVar11;
                    *(uint *)(iVar4 + 0x10) = uVar6;
                    *(undefined4 *)(iVar4 + 0xc) = 0;
                    *param_1 = uVar12;
                    iVar4 = iVar5 + 1;
                    if (uVar6 == 0xffffffff)
                        goto LAB_000568f8;
                    goto LAB_00056e4c;
                }
                uVar12 = uVar11 - 1;
                iVar4 = iVar5 + 1;
                goto LAB_000568f8;
            }
            uVar11 = uVar15 + 1;
            *param_1 = uVar11;
            if (param_3 <= uVar11) {
            LAB_00056c00:
                *param_1 = uVar15;
                iVar5 = -3;
                goto LAB_00056b4c;
            }
            cVar1 = *(char *)(param_2 + uVar11);
            uVar12 = uVar11;
        joined_r0x00056958:
            if (cVar1 == '\0')
                goto LAB_00056c00;
            if (cVar1 == '\"')
                goto LAB_00056b68;
            if ((cVar1 != '\\') || (uVar6 = uVar12 + 1, param_3 <= uVar6)) {
                uVar6 = *param_1;
                goto LAB_00056964;
            }
            *param_1 = uVar6;
            pbVar9 = (byte *)(param_2 + uVar6);
            switch (*(undefined1 *)(param_2 + uVar6)) {
            case 0x22:
                break;
            case 0x23:
                goto switchD_000569b0_default;
            case 0x24:
                goto switchD_000569b0_default;
            case 0x25:
                goto switchD_000569b0_default;
            case 0x26:
                goto switchD_000569b0_default;
            case 0x27:
                goto switchD_000569b0_default;
            case 0x28:
                goto switchD_000569b0_default;
            case 0x29:
                goto switchD_000569b0_default;
            case 0x2a:
                goto switchD_000569b0_default;
            case 0x2b:
                goto switchD_000569b0_default;
            case 0x2c:
                goto switchD_000569b0_default;
            case 0x2d:
                goto switchD_000569b0_default;
            case 0x2e:
                goto switchD_000569b0_default;
            case 0x2f:
                break;
            case 0x30:
                goto switchD_000569b0_default;
            case 0x31:
                goto switchD_000569b0_default;
            case 0x32:
                goto switchD_000569b0_default;
            case 0x33:
                goto switchD_000569b0_default;
            case 0x34:
                goto switchD_000569b0_default;
            case 0x35:
                goto switchD_000569b0_default;
            case 0x36:
                goto switchD_000569b0_default;
            case 0x37:
                goto switchD_000569b0_default;
            case 0x38:
                goto switchD_000569b0_default;
            case 0x39:
                goto switchD_000569b0_default;
            case 0x3a:
                goto switchD_000569b0_default;
            case 0x3b:
                goto switchD_000569b0_default;
            case 0x3c:
                goto switchD_000569b0_default;
            case 0x3d:
                goto switchD_000569b0_default;
            case 0x3e:
                goto switchD_000569b0_default;
            case 0x3f:
                goto switchD_000569b0_default;
            case 0x40:
                goto switchD_000569b0_default;
            case 0x41:
                goto switchD_000569b0_default;
            case 0x42:
                goto switchD_000569b0_default;
            case 0x43:
                goto switchD_000569b0_default;
            case 0x44:
                goto switchD_000569b0_default;
            case 0x45:
                goto switchD_000569b0_default;
            case 0x46:
                goto switchD_000569b0_default;
            case 0x47:
                goto switchD_000569b0_default;
            case 0x48:
                goto switchD_000569b0_default;
            case 0x49:
                goto switchD_000569b0_default;
            case 0x4a:
                goto switchD_000569b0_default;
            case 0x4b:
                goto switchD_000569b0_default;
            case 0x4c:
                goto switchD_000569b0_default;
            case 0x4d:
                goto switchD_000569b0_default;
            case 0x4e:
                goto switchD_000569b0_default;
            case 0x4f:
                goto switchD_000569b0_default;
            case 0x50:
                goto switchD_000569b0_default;
            case 0x51:
                goto switchD_000569b0_default;
            case 0x52:
                goto switchD_000569b0_default;
            case 0x53:
                goto switchD_000569b0_default;
            case 0x54:
                goto switchD_000569b0_default;
            case 0x55:
                goto switchD_000569b0_default;
            case 0x56:
                goto switchD_000569b0_default;
            case 0x57:
                goto switchD_000569b0_default;
            case 0x58:
                goto switchD_000569b0_default;
            case 0x59:
                goto switchD_000569b0_default;
            case 0x5a:
                goto switchD_000569b0_default;
            case 0x5b:
                goto switchD_000569b0_default;
            case 0x5c:
                break;
            case 0x5d:
                goto switchD_000569b0_default;
            case 0x5e:
                goto switchD_000569b0_default;
            case 0x5f:
                goto switchD_000569b0_default;
            case 0x60:
                goto switchD_000569b0_default;
            case 0x61:
                goto switchD_000569b0_default;
            case 0x62:
                break;
            case 99:
                goto switchD_000569b0_default;
            case 100:
                goto switchD_000569b0_default;
            case 0x65:
                goto switchD_000569b0_default;
            case 0x66:
                break;
            case 0x67:
                goto switchD_000569b0_default;
            case 0x68:
                goto switchD_000569b0_default;
            case 0x69:
                goto switchD_000569b0_default;
            case 0x6a:
                goto switchD_000569b0_default;
            case 0x6b:
                goto switchD_000569b0_default;
            case 0x6c:
                goto switchD_000569b0_default;
            case 0x6d:
                goto switchD_000569b0_default;
            case 0x6e:
                break;
            case 0x6f:
                goto switchD_000569b0_default;
            case 0x70:
                goto switchD_000569b0_default;
            case 0x71:
                goto switchD_000569b0_default;
            case 0x72:
                break;
            case 0x73:
            switchD_000569b0_default:
                iVar5 = -2;
                *param_1 = uVar15;
                goto LAB_00056b4c;
            case 0x74:
                break;
            case 0x75:
                uVar6 = uVar12 + 2;
                uVar8 = uVar12 + 6;
                *param_1 = uVar6;
                do {
                    uVar12 = param_3;
                    if (uVar6 == param_3)
                        break;
                    pbVar9 = pbVar9 + 1;
                    uVar7 = (uint)*pbVar9;
                    uVar12 = uVar6;
                    if (uVar7 == 0)
                        break;
                    uVar12 = (uVar7 & 0xffffffdf) - 0x41;
                    bVar18 = 4 < uVar12;
                    bVar17 = uVar12 == 5;
                    if (5 < uVar12) {
                        bVar18 = 8 < uVar7 - 0x30;
                        bVar17 = uVar7 - 0x30 == 9;
                    }
                    if (bVar18 && !bVar17)
                        goto switchD_000569b0_default;
                    uVar6 = uVar6 + 1;
                    *param_1 = uVar6;
                    uVar12 = uVar8;
                } while (uVar6 != uVar8);
                *param_1 = uVar12;
                if (uVar12 < param_3)
                    goto LAB_00056974;
                goto LAB_00056c00;
            default:
                goto switchD_000569b0_default;
            }
        LAB_00056964:
            uVar12 = uVar6 + 1;
            *param_1 = uVar12;
            if (param_3 <= uVar12)
                goto LAB_00056c00;
        LAB_00056974:
            cVar1 = *(char *)(param_2 + uVar12);
            goto joined_r0x00056958;
        }
        iVar5 = 0;
    } else {
        iVar5 = 0;
    }
LAB_00056b88:
    if (param_4 != 0) {
        iVar4 = param_1[1] - 1;
        if (-1 < iVar4) {
            param_4 = param_4 + param_1[1] * 0x14;
            do {
                if ((*(int *)(param_4 + -0x10) != -1) &&
                    (*(int *)(param_4 + -0xc) == -1)) {
                    iVar5 = -3;
                    break;
                }
                iVar4 = iVar4 + -1;
                param_4 = param_4 + -0x14;
            } while (iVar4 != -1);
        }
    }
LAB_00056b4c:
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar5);
    }
    return;
LAB_00056b68:
    if (param_4 == 0) {
        iVar4 = iVar5 + 1;
    } else {
        uVar8 = param_1[1];
        if (param_5 <= uVar8) {
        LAB_00056e78:
            iVar5 = -1;
            *param_1 = uVar15;
            goto LAB_00056b4c;
        }
        uVar6 = param_1[2];
        iVar4 = iVar5 + 1;
        iVar16 = param_4 + uVar8 * 0x14;
        param_1[1] = uVar8 + 1;
        *(undefined4 *)(param_4 + uVar8 * 0x14) = 3;
        *(uint *)(iVar16 + 4) = uVar11;
        *(uint *)(iVar16 + 8) = uVar12;
        *(uint *)(iVar16 + 0x10) = uVar6;
        *(undefined4 *)(iVar16 + 0xc) = 0;
        if (uVar6 != 0xffffffff) {
            uVar12 = *param_1;
        LAB_00056e4c:
            iVar4 = param_4 + uVar6 * 0x14;
            *(int *)(iVar4 + 0xc) = *(int *)(iVar4 + 0xc) + 1;
            iVar4 = iVar5 + 1;
        LAB_000568f8:
            uVar15 = uVar12 + 1;
            *param_1 = uVar15;
            iVar5 = iVar4;
            goto joined_r0x00056904;
        }
    }
LAB_00056b74:
    uVar15 = *param_1;
    iVar5 = iVar4;
LAB_00056b78:
    uVar15 = uVar15 + 1;
    *param_1 = uVar15;
joined_r0x00056904:
    if ((param_3 <= uVar15) ||
        (uVar11 = (uint) * (byte *)(param_2 + uVar15), uVar11 == 0))
        goto LAB_00056b88;
    goto LAB_00056914;
}

void FUN_00056f38(undefined4 *param_1)

{
    int iVar1;

    param_1[1] = 0;
    param_1[2] = 0xffffffff;
    iVar1 = __stack_chk_guard;
    *param_1 = 0;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00056f8c(int param_1)

{
    ushort uVar1;
    int iVar2;
    size_t __n;
    size_t sVar3;
    ushort **ppuVar4;
    uint uVar5;
    char cVar6;
    int iVar7;
    undefined4 uVar8;
    uint uVar9;
    undefined4 uVar10;
    byte bVar11;
    undefined2 uVar12;
    int iVar13;
    byte *pbVar14;
    int *piVar15;
    int *piVar16;
    byte bVar17;
    int iVar18;
    char *pcVar19;
    int iVar20;
    byte *pbVar21;
    byte *pbVar22;
    int iVar23;
    int iVar24;
    int iVar25;
    int *piVar26;
    int *piVar27;
    byte *pbVar28;
    byte *pbVar29;
    uint uVar30;
    uint uVar31;
    bool bVar32;
    bool bVar33;
    double dVar34;
    undefined8 uVar35;
    char *pcVar36;
    int local_88;
    byte *local_64;
    char *local_60;
    char *local_5c;
    tm local_58;
    int local_2c;

    pbVar21 = (byte *)(param_1 + 0x58);
    iVar2 = *(int *)(param_1 + 4);
    iVar23 = **(int **)(iVar2 + 0x54);
    local_2c = __stack_chk_guard;
    FUN_000553fc(*(int **)(iVar2 + 0x54), &DAT_000a89cc, pbVar21,
                 *(undefined4 *)(param_1 + 0x54));
    pbVar28 = pbVar21 + *(int *)(param_1 + 0x54);
    iVar13 = iVar23 + *(int *)(iVar23 + 0x1c18) + 0x1c18;
    pbVar14 = (byte *)(iVar13 + 4);
    if (pbVar21 != pbVar28) {
        pbVar29 = (byte *)(iVar23 + 0x1c1c);
        do {
            while (true) {
                pbVar22 = pbVar21 + 1;
                bVar11 = *pbVar21;
                pbVar21 = pbVar22;
                if (bVar11 != 10)
                    break;
                if (pbVar29 == pbVar14) {
                    iVar7 = 0;
                    pbVar14 = pbVar29;
                } else {
                    bVar11 = pbVar14[-1];
                    while (bVar11 < 0x21) {
                        if (pbVar14 + -1 == pbVar29) {
                            iVar7 = 0;
                            pbVar14 = pbVar29;
                            goto LAB_000570f8;
                        }
                        bVar11 = pbVar14[-2];
                        pbVar14 = pbVar14 + -1;
                    }
                    iVar7 = (int)pbVar14 - (int)pbVar29;
                }
            LAB_000570f8:
                iVar18 = 0;
                *pbVar14 = 0;
                piVar15 = *(int **)(iVar2 + 0x54);
                *(int *)(iVar23 + 0x1c18) = iVar7;
                iVar24 = *piVar15;
                uVar8 = *(undefined4 *)(iVar24 + 0x1c18);
                FUN_00056f38(&local_58);
                pcVar36 = (char *)0x15e;
                iVar7 = FUN_00056890(&local_58, iVar24 + 0x1c1c, uVar8,
                                     iVar24 + 0xc0, 0x15e);
                if (iVar7 < 1) {
                LAB_00057170:
                    *(int *)(iVar24 + 0x9c) = *(int *)(iVar24 + 0x9c) + 1;
                } else {
                    *(int *)(iVar24 + 0xb8) = iVar24 + 0x1c1c;
                    *(int *)(iVar24 + 0xbc) = iVar7;
                    iVar7 = iVar24;
                    if (*(int *)(iVar24 + 0xc0) != 1)
                        goto LAB_00057170;
                    do {
                        iVar18 = iVar18 + 1;
                        if (*(int *)(iVar7 + 0xc4) < *(int *)(iVar7 + 200)) {
                            *(undefined1 *)(*(int *)(iVar24 + 0xb8) +
                                            *(int *)(iVar7 + 200)) = 0;
                        }
                        iVar7 = iVar7 + 0x14;
                    } while (iVar18 < *(int *)(iVar24 + 0xbc));
                    iVar18 = iVar24 + 0xb8;
                    iVar7 = FUN_000563fc(iVar18, "class", 3);
                    if (iVar7 == -1)
                        goto LAB_00057170;
                    iVar25 = *(int *)(iVar24 + 0xb8);
                    iVar7 = *(int *)(iVar24 + iVar7 * 0x14 + 0xc4);
                    pcVar19 = (char *)(iVar25 + iVar7);
                    if (pcVar19 == (char *)0x0)
                        goto LAB_00057170;
                    cVar6 = *(char *)(iVar25 + iVar7);
                    if (cVar6 != 'T') {
                        if ((((cVar6 != 'P') || (pcVar19[1] != 'P')) ||
                             (pcVar19[2] != 'S')) ||
                            (pcVar19[3] != '\0'))
                            goto LAB_000573e4;
                        piVar27 = *(int **)(iVar2 + 0x54);
                        iVar7 = *piVar27;
                        *(int *)(iVar7 + 0xac) = *(int *)(iVar7 + 0xac) + 1;
                        if ((*(byte *)(iVar7 + 0x84) & 1) != 0)
                            goto LAB_000572ec;
                        uVar8 = *(undefined4 *)(param_1 + 0x4c);
                        *(undefined4 *)(iVar7 + 0x20) =
                            *(undefined4 *)(param_1 + 0x48);
                        *(undefined4 *)(iVar7 + 0x24) = uVar8;
                        piVar16 = (int *)(iVar7 + 0x40);
                        if ((*(byte *)(iVar7 + 0x84) & 0x80) == 0) {
                            pcVar36 = (char *)0x3e8;
                            iVar25 = FUN_00056608(piVar16, iVar18, "clock_sec",
                                                  "clock_musec", 1000);
                            if (iVar25 != 0) {
                                pcVar36 = (char *)0x3e8;
                                iVar25 = FUN_00056608(iVar7 + 0x38, iVar18,
                                                      "real_sec", "real_musec",
                                                      1000);
                                goto joined_r0x00057b9c;
                            }
                        } else {
                            pcVar36 = (char *)0x1;
                            iVar25 = FUN_00056608(piVar16, iVar18, "clock_sec",
                                                  "clock_nsec", 1);
                            if (iVar25 != 0) {
                                pcVar36 = (char *)0x1;
                                iVar25 =
                                    FUN_00056608(iVar7 + 0x38, iVar18,
                                                 "real_sec", "real_nsec", 1);
                            joined_r0x00057b9c:
                                if (iVar25 != 0) {
                                    local_64 = (byte *)(iVar7 + 0x38);
                                    iVar18 = FUN_000567e4(
                                        iVar18, "precision",
                                        (int)*(short *)(iVar7 + 0x68),
                                        (int)*(short *)(iVar7 + 0x68) >> 0x1f);
                                    if (iVar18 < 1) {
                                        if (iVar18 + 0x20 < 0 ==
                                            SCARRY4(iVar18, 0x20)) {
                                            uVar12 = (undefined2)iVar18;
                                        } else {
                                            uVar12 = 0xffe0;
                                        }
                                    } else {
                                        uVar12 = 0;
                                    }
                                    piVar26 = (int *)(iVar7 + 0x30);
                                    uVar31 = *(uint *)(iVar7 + 0x44);
                                    *(undefined2 *)(iVar7 + 0x6a) = uVar12;
                                    uVar30 = uVar31 - *(int *)(iVar7 + 0x78);
                                    *piVar26 = *piVar16;
                                    *(undefined4 *)(iVar7 + 0x34) =
                                        *(undefined4 *)(iVar7 + 0x44);
                                    uVar5 = *(uint *)(iVar7 + 0x34);
                                    uVar9 = uVar5 - *(int *)(iVar7 + 0x70);
                                    *(uint *)(iVar7 + 0x34) = uVar9;
                                    iVar18 = *(int *)(iVar7 + 0x30) -
                                             *(int *)(iVar7 + 0x6c);
                                    if (uVar5 < uVar9) {
                                        iVar18 = iVar18 + -1;
                                    }
                                    *(int *)(iVar7 + 0x30) = iVar18;
                                    iVar18 = *(int *)(iVar7 + 0x34);
                                    iVar25 = *(int *)(iVar7 + 0x40) -
                                             *(int *)(iVar7 + 0x74);
                                    *(uint *)(iVar7 + 0x44) = uVar30;
                                    if (uVar31 < uVar30) {
                                        iVar25 = iVar25 + -1;
                                    }
                                    *(int *)(iVar7 + 0x40) = iVar25;
                                    iVar25 = *(int *)(iVar7 + 8);
                                    piVar27[0x3a] = *piVar26;
                                    piVar27[0x3b] = iVar18;
                                    iVar18 = *piVar26;
                                    *(int *)(iVar7 + 0x28) = iVar18;
                                    *(undefined4 *)(iVar7 + 0x2c) =
                                        *(undefined4 *)(iVar7 + 0x34);
                                    uVar5 = *(uint *)(iVar7 + 0x2c);
                                    *(undefined4 *)(iVar7 + 0x2c) = 0;
                                    if (0x7fffffff < uVar5) {
                                        iVar18 = iVar18 + 1;
                                    }
                                    *(int *)(iVar7 + 0x28) = iVar18;
                                    if (iVar25 != 0) {
                                        uVar10 = *(undefined4 *)(iVar25 + 0x54);
                                        uVar8 = FUN_0007ac20(local_64);
                                        FUN_000552a0(uVar10, uVar8);
                                    }
                                    *(byte *)(iVar7 + 0x84) =
                                        *(byte *)(iVar7 + 0x84) & 0xfb |
                                        (byte)(((int)((*(byte *)(piVar27 +
                                                                 0xc0) ^
                                                       2)
                                                      << 0x1e) >>
                                                    0x1f &
                                                1U)
                                               << 2) |
                                        8;
                                    goto LAB_000572ec;
                                }
                            }
                        }
                        goto LAB_000572e0;
                    }
                    if (((pcVar19[1] != 'P') || (pcVar19[2] != 'V')) ||
                        (pcVar19[3] != '\0')) {
                    LAB_000573e4:
                        iVar7 = strcmp("TOFF", pcVar19);
                        if (iVar7 == 0) {
                            piVar27 = *(int **)(iVar2 + 0x54);
                            iVar7 = *piVar27;
                            *(int *)(iVar7 + 0xa4) = *(int *)(iVar7 + 0xa4) + 1;
                            *(byte *)(iVar7 + 0x85) =
                                *(byte *)(iVar7 + 0x85) | 1;
                            if ((*(byte *)(iVar7 + 0x84) & 1) == 0) {
                                pcVar36 = (char *)0x1;
                                iVar25 =
                                    FUN_00056608(iVar7 + 0x60, iVar18,
                                                 "clock_sec", "clock_nsec", 1);
                                if (iVar25 != 0) {
                                    pcVar36 = (char *)0x1;
                                    iVar18 = FUN_00056608(iVar7 + 0x58, iVar18,
                                                          "real_sec",
                                                          "real_nsec", 1);
                                    if (iVar18 != 0) {
                                        uVar9 = *(uint *)(iVar7 + 100);
                                        uVar5 = uVar9 - *(int *)(iVar7 + 0x80);
                                        *(uint *)(iVar7 + 100) = uVar5;
                                        iVar18 = *(int *)(iVar7 + 0x60) -
                                                 *(int *)(iVar7 + 0x7c);
                                        if (uVar9 < uVar5) {
                                            iVar18 = iVar18 + -1;
                                        }
                                        *(int *)(iVar7 + 0x60) = iVar18;
                                        uVar8 = *(undefined4 *)(param_1 + 0x4c);
                                        *(undefined4 *)(iVar7 + 0x50) =
                                            *(undefined4 *)(param_1 + 0x48);
                                        *(undefined4 *)(iVar7 + 0x54) = uVar8;
                                        *(byte *)(iVar7 + 0x84) =
                                            *(byte *)(iVar7 + 0x84) | 2;
                                        uVar8 = FUN_0007ac20(iVar7 + 0x58);
                                        FUN_000552a0(piVar27, uVar8);
                                        goto LAB_000572ec;
                                    }
                                }
                            LAB_000572e0:
                                *(int *)(iVar7 + 0x9c) =
                                    *(int *)(iVar7 + 0x9c) + 1;
                            }
                            goto LAB_000572ec;
                        }
                        iVar7 = strcmp("VERSION", pcVar19);
                        if (iVar7 == 0) {
                            piVar27 = *(int **)(iVar2 + 0x54);
                            iVar7 = FUN_000563fc(iVar18, &DAT_000a8a40, 3);
                            iVar20 = *piVar27;
                            if (iVar7 == -1) {
                                local_60 = "(unknown)";
                            } else {
                                local_60 =
                                    (char *)(iVar25 +
                                             *(int *)(iVar24 + iVar7 * 0x14 +
                                                      0xc4));
                            }
                            iVar7 = FUN_000563fc(iVar18, "release", 3);
                            if (iVar7 == -1) {
                                local_5c = "(unknown)";
                            } else {
                                local_5c =
                                    (char *)(iVar25 +
                                             *(int *)(iVar24 + iVar7 * 0x14 +
                                                      0xc4));
                            }
                            piVar16 = __errno_location();
                            *piVar16 = 0;
                            uVar1 = FUN_00056544(iVar18, "proto_major");
                            uVar5 = FUN_00056544(iVar18, "proto_minor");
                            if (*piVar16 == 0) {
                                if ((*(byte *)(iVar20 + 0x84) & 0x20) == 0) {
                                    FUN_00075d40(6,
                                                 "%s: GPSD revision=%s "
                                                 "release=%s protocol=%u.%u",
                                                 *(undefined4 *)(iVar20 + 0x14),
                                                 local_60, local_5c, uVar1,
                                                 uVar5 & 0xffff);
                                    pcVar36 = local_5c;
                                }
                                uVar5 = uVar5 & 0xffff | (uint)uVar1 << 0x10;
                                bVar11 = *(byte *)(iVar20 + 0x84);
                                if (uVar5 < 0x30009) {
                                    cVar6 = '\0';
                                } else {
                                    cVar6 = -1;
                                }
                                *(uint *)(iVar20 + 0x1c) = uVar5;
                                uVar9 = uVar5;
                                if (uVar5 < 0x3000a) {
                                    uVar9 = 0;
                                }
                                bVar17 = (byte)uVar9;
                                if (0x30009 < uVar5) {
                                    bVar17 = 0xff;
                                }
                                *(byte *)(iVar20 + 0x84) =
                                    bVar11 & 0x7f | 0x20 | cVar6 << 7;
                                *(byte *)(iVar20 + 0x85) =
                                    *(byte *)(iVar20 + 0x85) & 0xfe |
                                    bVar17 & 1;
                                if ((bVar11 & 0x40) == 0) {
                                    pcVar19 = (char *)(iVar20 + 0x1c1c);
                                    if ((*(byte *)(iVar20 + 0x85) & 1) == 0) {
                                        pcVar36 = "";
                                    } else {
                                        pcVar36 = ",\"pps\":true";
                                    }
                                    FUN_0007d00c(
                                        pcVar19, 0x640,
                                        "?WATCH={\"device\":\"%s\",\"enable\":"
                                        "true,\"json\":true%s};\r\n",
                                        *(undefined4 *)(iVar20 + 0x18),
                                        pcVar36);
                                    __n = strlen(pcVar19);
                                    FUN_000553fc(*(undefined4 *)(iVar2 + 0x54),
                                                 &DAT_000a8770, pcVar19, __n);
                                    sVar3 = write(piVar27[7], pcVar19, __n);
                                    if ((__n != sVar3) &&
                                        (((*(byte *)(piVar27 + 0xc0) & 4) !=
                                              0 ||
                                          (*(int *)(iVar20 + 0xb4) == 0xe10 ||
                                           *(int *)(iVar20 + 0xb4) == 0)))) {
                                        *(undefined4 *)(iVar20 + 0xb4) = 0xe10;
                                        FUN_00075d40(
                                            3,
                                            "%s: failed to write watch request "
                                            "(%m)",
                                            *(undefined4 *)(iVar20 + 0x14));
                                    }
                                }
                            } else if (((*(byte *)(piVar27 + 0xc0) & 4) != 0) ||
                                       (*(int *)(iVar20 + 0xb4) == 0xe10 ||
                                        *(int *)(iVar20 + 0xb4) == 0)) {
                                *(undefined4 *)(iVar20 + 0xb4) = 0xe10;
                                FUN_00075d40(
                                    6, "%s: could not evaluate version data",
                                    *(undefined4 *)(iVar20 + 0x14));
                            }
                            goto LAB_000572ec;
                        }
                        iVar7 = strcmp("WATCH", pcVar19);
                        if (iVar7 == 0) {
                            iVar20 = **(int **)(iVar2 + 0x54);
                            iVar7 = FUN_000563fc(iVar18, "device", 3);
                            if (((iVar7 != -1) &&
                                 (pcVar19 =
                                      (char *)(iVar25 +
                                               *(int *)(iVar24 + iVar7 * 0x14 +
                                                        0xc4)),
                                  pcVar19 != (char *)0x0)) &&
                                (iVar7 =
                                     strcmp(pcVar19, *(char **)(iVar20 + 0x18)),
                                 iVar7 == 0)) {
                                iVar7 = FUN_00056750(iVar18, "enable");
                                if ((iVar7 < 1) || (iVar7 = FUN_00056750(
                                                        iVar18, &DAT_000a8ad4),
                                                    iVar7 < 1)) {
                                    *(byte *)(iVar20 + 0x84) =
                                        *(byte *)(iVar20 + 0x84) & 0xbf;
                                } else {
                                    *(byte *)(iVar20 + 0x84) =
                                        *(byte *)(iVar20 + 0x84) | 0x40;
                                }
                            }
                            goto LAB_000572ec;
                        }
                        goto LAB_0005717c;
                    }
                    piVar27 = *(int **)(iVar2 + 0x54);
                    iVar20 = *piVar27;
                    iVar7 = FUN_000567e4(iVar18, "mode", 0, 0);
                    iVar25 = FUN_000563fc(iVar18, "time", 3);
                    if ((iVar25 == -1) ||
                        (pcVar19 =
                             (char *)(*(int *)(iVar24 + 0xb8) +
                                      *(int *)(iVar24 + iVar25 * 0x14 + 0xc4)),
                         iVar7 < 2 || pcVar19 == (char *)0x0)) {
                        *(int *)(iVar20 + 0xa0) = *(int *)(iVar20 + 0xa0) + 1;
                        if ((*(byte *)(iVar20 + 0x85) & 1) == 0) {
                            *(int *)(iVar20 + 0xa4) =
                                *(int *)(iVar20 + 0xa4) + 1;
                        }
                        *(byte *)(iVar20 + 0x84) =
                            *(byte *)(iVar20 + 0x84) & 0xf9 | 1;
                    } else {
                        *(byte *)(iVar20 + 0x84) =
                            *(byte *)(iVar20 + 0x84) & 0xfe;
                        if ((*(byte *)(iVar20 + 0x85) & 1) == 0) {
                            *(int *)(iVar20 + 0xa4) =
                                *(int *)(iVar20 + 0xa4) + 1;
                            FUN_000552a0(piVar27, pcVar19);
                            local_64 = (byte *)strptime(
                                pcVar19, "%Y-%m-%dT%H:%M:%S", &local_58);
                            if (local_64 != (byte *)0x0) {
                                uVar5 = (uint)*local_64;
                                if (uVar5 == 0x2e) {
                                    ppuVar4 = __ctype_b_loc();
                                    uVar30 = 100000000;
                                    uVar9 = 0;
                                    while (true) {
                                        local_64 = local_64 + 1;
                                        uVar5 = (uint)*local_64;
                                        if (((*ppuVar4)[uVar5] & 0x800) == 0)
                                            break;
                                        uVar9 = (uVar5 - 0x30) * uVar30 + uVar9;
                                        uVar30 = uVar30 / 10;
                                    }
                                } else {
                                    uVar9 = 0;
                                }
                                if ((uVar5 == 0x5a) && (local_64[1] == 0)) {
                                    iVar25 = FUN_000773c8(&local_58);
                                    iVar7 = FUN_0007760c(&local_58);
                                    iVar7 =
                                        (iVar25 + -0xa955c) * 0x15180 + iVar7;
                                    if ((int)uVar9 < 0) {
                                        do {
                                            iVar7 = iVar7 + -1;
                                            uVar9 = uVar9 + 1000000000;
                                            uVar5 = uVar9;
                                        } while ((int)uVar9 < 0);
                                    } else {
                                        uVar5 = uVar9;
                                        if (999999999 < (int)uVar9) {
                                            iVar25 = iVar7 + 1;
                                            uVar5 = uVar9 + 0xc4653600;
                                            bVar33 = SBORROW4(uVar5, 999999999);
                                            bVar32 = uVar5 != 999999999;
                                            if (999999999 < (int)uVar5) {
                                                iVar25 = iVar7 + 2;
                                                uVar5 = 0x6c00;
                                            }
                                            iVar7 = iVar25;
                                            if (bVar32 &&
                                                (int)(uVar9 + 0x88ca6c01) < 0 ==
                                                    bVar33) {
                                                uVar5 =
                                                    uVar9 + (uVar5 & 0xffff |
                                                             0x88ca0000);
                                            }
                                        }
                                    }
                                    *(int *)(iVar20 + 0x58) = iVar7;
                                    uVar35 = VectorShiftRight(
                                        CONCAT44(uVar5, uVar5), 0x20);
                                    uVar35 =
                                        VectorShiftLeft(uVar35, 0x20, 0x40, 0);
                                    uVar8 = FUN_0009d518(
                                        (uint)uVar35 + 500000000,
                                        (int)((ulonglong)uVar35 >> 0x20) +
                                            (uint)(0xe2329aff < (uint)uVar35),
                                        1000000000, 0);
                                    *(undefined4 *)(iVar20 + 0x5c) = uVar8;
                                    uVar8 = *(undefined4 *)(param_1 + 0x4c);
                                    *(int *)(iVar20 + 0x50) =
                                        *(int *)(param_1 + 0x48);
                                    *(undefined4 *)(iVar20 + 0x54) = uVar8;
                                    iVar7 = *(int *)(param_1 + 0x48);
                                    uVar8 = *(undefined4 *)(param_1 + 0x4c);
                                    *(int *)(iVar20 + 0x60) = iVar7;
                                    *(undefined4 *)(iVar20 + 100) = uVar8;
                                    uVar9 = *(uint *)(iVar20 + 100);
                                    uVar5 = uVar9 - *(int *)(iVar20 + 0x80);
                                    *(byte *)(iVar20 + 0x84) =
                                        *(byte *)(iVar20 + 0x84) | 2;
                                    iVar7 = iVar7 - *(int *)(iVar20 + 0x7c);
                                    *(uint *)(iVar20 + 100) = uVar5;
                                    if (uVar9 < uVar5) {
                                        iVar7 = iVar7 + -1;
                                    }
                                    *(int *)(iVar20 + 0x60) = iVar7;
                                    goto LAB_00057644;
                                }
                            }
                            *(int *)(iVar20 + 0x9c) =
                                *(int *)(iVar20 + 0x9c) + 1;
                            *(byte *)(iVar20 + 0x84) =
                                *(byte *)(iVar20 + 0x84) & 0xfd;
                        }
                    LAB_00057644:
                        iVar7 = FUN_000563fc(iVar18, "ept", 0);
                        if ((((iVar7 == -1) ||
                              (pcVar19 =
                                   (char *)(*(int *)(iVar24 + 0xb8) +
                                            *(int *)(iVar24 + iVar7 * 0x14 +
                                                     0xc4)),
                               pcVar19 == (char *)0x0)) ||
                             (dVar34 = strtod(pcVar19, (char **)&local_58),
                              pcVar19 == (char *)local_58.tm_sec)) ||
                            (*(char *)local_58.tm_sec != '\0')) {
                            dVar34 = 0.00141421356;
                        } else {
                            dVar34 = ABS(dVar34) * 0.70710678;
                        }
                        dVar34 = frexp(dVar34, &local_58.tm_sec);
                        if (0.25 <= dVar34) {
                            if ((2.0 < dVar34) || (0 < local_58.tm_sec))
                                goto LAB_000576d4;
                            pcVar19 = (char *)local_58.tm_sec;
                            if ((int)(local_58.tm_sec + 0x20) < 0 ==
                                SCARRY4(local_58.tm_sec, 0x20)) {
                                pcVar19 = (char *)(local_58.tm_sec & 0xffff);
                            }
                            uVar12 = SUB42(pcVar19, 0);
                            if ((int)(local_58.tm_sec + 0x20) < 0 !=
                                SCARRY4(local_58.tm_sec, 0x20))
                                goto LAB_00057704;
                        } else {
                            local_58.tm_sec = -0x80000000;
                            if (dVar34 <= 2.0) {
                            LAB_00057704:
                                uVar12 = 0xffe0;
                            } else {
                            LAB_000576d4:
                                uVar12 = 0;
                            }
                        }
                        *(undefined2 *)(iVar20 + 0x68) = uVar12;
                    }
                LAB_000572ec:
                    iVar7 = *(int *)(iVar24 + 8);
                    *(int *)(iVar24 + 0x98) = *(int *)(iVar24 + 0x98) + 1;
                    bVar11 = *(byte *)(iVar24 + 0x84);
                    if ((iVar7 != 0) &&
                        (iVar18 = *(int *)(iVar7 + 0x54), (bVar11 & 8) != 0)) {
                        pcVar36 = *(char **)(iVar24 + 0x40);
                        FUN_00055200(iVar7, iVar18,
                                     *(undefined4 *)(iVar24 + 0x38),
                                     *(undefined4 *)(iVar24 + 0x3c), pcVar36,
                                     *(undefined4 *)(iVar24 + 0x44));
                        *(char *)(iVar7 + 0x5f) =
                            (char)*(undefined2 *)(iVar24 + 0x6a);
                        if (*(int *)(iVar24 + 0x4c) < 9) {
                            iVar25 = *(int *)(iVar24 + 0x4c) + 2;
                            *(int *)(iVar24 + 0x4c) = iVar25;
                            if (iVar25 == 10)
                                goto LAB_00057860;
                        } else {
                            *(undefined4 *)(iVar24 + 0x4c) = 10;
                        LAB_00057860:
                            if ((*(byte *)(iVar18 + 0x300) & 1) != 0) {
                                *(uint *)(iVar7 + 0x44) =
                                    *(uint *)(iVar7 + 0x44) | 0x80;
                            }
                        }
                        bVar11 = *(byte *)(iVar24 + 0x84) & 0xf7;
                        *(byte *)(iVar24 + 0x84) = bVar11;
                        *(int *)(iVar24 + 0xb0) = *(int *)(iVar24 + 0xb0) + 1;
                    }
                    if ((bVar11 & 6) == 6) {
                        iVar7 =
                            *(int *)(iVar24 + 0x50) - *(int *)(iVar24 + 0x20);
                        if (*(uint *)(iVar24 + 0x54) <
                            *(uint *)(iVar24 + 0x54) -
                                *(int *)(iVar24 + 0x24)) {
                            iVar7 = iVar7 + -1;
                        }
                        if (iVar7 < 1) {
                            if (iVar7 != 0) {
                                *(byte *)(iVar24 + 0x84) =
                                    *(byte *)(iVar24 + 0x84) & 0xfd;
                                goto LAB_00057744;
                            }
                            iVar7 = *(int *)(iVar24 + 0x10);
                            if (iVar7 != 1)
                                goto joined_r0x00057758;
                        } else {
                            *(byte *)(iVar24 + 0x84) =
                                *(byte *)(iVar24 + 0x84) & 0xfb;
                        LAB_00057744:
                            iVar7 = *(int *)(iVar24 + 0x10);
                            if (iVar7 != 1) {
                                bVar11 = *(byte *)(iVar24 + 0x84);
                                goto joined_r0x00057758;
                            }
                            if ((*(byte *)(iVar24 + 0x84) & 6) != 6)
                                goto LAB_0005717c;
                        }
                    LAB_00057380:
                        FUN_00055200(iVar2, piVar15,
                                     *(undefined4 *)(iVar24 + 0x58),
                                     *(undefined4 *)(iVar24 + 0x5c),
                                     *(undefined4 *)(iVar24 + 0x30),
                                     *(undefined4 *)(iVar24 + 0x34));
                        *(char *)(iVar2 + 0x5f) =
                            (char)*(undefined2 *)(iVar24 + 0x6a);
                        *(byte *)(iVar24 + 0x84) =
                            *(byte *)(iVar24 + 0x84) & 0xf9;
                        *(int *)(iVar24 + 0xa8) = *(int *)(iVar24 + 0xa8) + 1;
                    } else {
                        iVar7 = *(int *)(iVar24 + 0x10);
                        if (iVar7 == 1)
                            goto LAB_0005717c;
                    joined_r0x00057758:
                        if (iVar7 == 2) {
                            bVar17 = bVar11 & 2;
                            if (bVar17 != 0) {
                                if ((bVar11 & 4) == 0) {
                                    if (*(int *)(iVar24 + 0x48) < 1) {
                                        *(undefined4 *)(iVar24 + 0x48) = 0;
                                    } else {
                                        iVar7 = *(int *)(iVar24 + 0x48) + -1;
                                        *(int *)(iVar24 + 0x48) = iVar7;
                                        if (iVar7 != 0)
                                            goto LAB_00057364;
                                    }
                                    if ((bVar11 & 0x10) == 0) {
                                        uVar8 = 4;
                                        uVar10 = *(undefined4 *)(iVar24 + 0x14);
                                        bVar11 =
                                            *(byte *)(iVar24 + 0x84) | 0x10;
                                        pcVar19 = "%s: use TPV alone from now";
                                    LAB_00057d6c:
                                        *(byte *)(iVar24 + 0x84) = bVar11;
                                        FUN_00075d40(uVar8, pcVar19, uVar10,
                                                     bVar11, pcVar36);
                                        bVar11 = *(byte *)(iVar24 + 0x84);
                                        if ((bVar11 & 0x10) == 0)
                                            goto LAB_00057374;
                                        bVar17 = bVar11 & 2;
                                    }
                                    if (bVar17 != 0)
                                        goto LAB_00057764;
                                } else {
                                    if (*(int *)(iVar24 + 0x48) < 0x3a) {
                                        iVar7 = *(int *)(iVar24 + 0x48) + 3;
                                        *(int *)(iVar24 + 0x48) = iVar7;
                                        if (iVar7 == 0x3c)
                                            goto LAB_00057d50;
                                    LAB_00057364:
                                        if ((bVar11 & 0x10) != 0)
                                            goto LAB_00057764;
                                    } else {
                                        *(undefined4 *)(iVar24 + 0x48) = 0x3c;
                                    LAB_00057d50:
                                        if ((bVar11 & 0x10) != 0) {
                                            uVar8 = 6;
                                            uVar10 =
                                                *(undefined4 *)(iVar24 + 0x14);
                                            bVar11 =
                                                *(byte *)(iVar24 + 0x84) & 0xef;
                                            pcVar19 =
                                                "%s: expect valid PPS from now";
                                            goto LAB_00057d6c;
                                        }
                                    }
                                LAB_00057374:
                                    if ((bVar11 & 6) == 6)
                                        goto LAB_00057380;
                                }
                            }
                        } else {
                            if ((bVar11 & 2) == 0)
                                goto LAB_0005717c;
                        LAB_00057764:
                            FUN_00055200(iVar2, piVar15,
                                         *(undefined4 *)(iVar24 + 0x58),
                                         *(undefined4 *)(iVar24 + 0x5c),
                                         *(undefined4 *)(iVar24 + 0x60),
                                         *(undefined4 *)(iVar24 + 100));
                            *(char *)(iVar2 + 0x5f) =
                                (char)*(undefined2 *)(iVar24 + 0x68);
                            *(byte *)(iVar24 + 0x84) =
                                *(byte *)(iVar24 + 0x84) & 0xfd;
                            *(int *)(iVar24 + 0xa8) =
                                *(int *)(iVar24 + 0xa8) + 1;
                        }
                    }
                }
            LAB_0005717c:
                pbVar14 = pbVar29;
                if (pbVar28 == pbVar22)
                    goto LAB_00057188;
            }
            if ((pbVar14 != (byte *)(iVar13 + 0x643)) &&
                ((0x20 < bVar11 || (pbVar29 != pbVar14)))) {
                *pbVar14 = bVar11;
                pbVar14 = pbVar14 + 1;
            }
        } while (pbVar28 != pbVar22);
    }
LAB_00057188:
    local_88 = iVar23 + 0x1c1c;
    *(int *)(iVar23 + 0x1c18) = (int)pbVar14 - local_88;
    bVar32 = local_2c == __stack_chk_guard;
    *(undefined4 *)(iVar23 + 0x90) = 10;
    if (bVar32) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00058594(int param_1)

{
    uint uVar1;
    int iVar2;
    int iVar3;
    int *piVar4;
    int iVar5;
    int *__s;
    uint local_34;
    undefined1 auStack_30[4];
    int local_2c;
    int local_28;
    int local_24;

    iVar5 = *(int *)(param_1 + 4);
    piVar4 = *(int **)(iVar5 + 0x54);
    local_24 = __stack_chk_guard;
    if (*(int *)(*piVar4 + 0x14) != 0) {
        __s = piVar4 + 0xe;
        *(undefined4 *)(*piVar4 + 0x14) = 0;
        uVar1 = FUN_0004a6d4(param_1, __s, 0x80, piVar4 + 0x3a);
        piVar4[0x2e] = uVar1 & 0xffff;
        if ((uVar1 & 0xffff) != 0) {
            iVar2 = sscanf((char *)__s, "%1x%1x%2d%2d%2d%2d%2d%2d", &local_34,
                           auStack_30, piVar4 + 0x31, piVar4 + 0x32,
                           piVar4 + 0x33, &local_2c, &local_28, piVar4 + 0x2f);
            if (((((iVar2 == 8) && ((uint)piVar4[0x31] < 0x18)) &&
                  ((uint)piVar4[0x32] < 0x3c)) &&
                 (((uint)piVar4[0x33] < 0x3d && (local_2c - 1U < 0x1f)))) &&
                ((local_28 - 1U < 0xc && ((uint)piVar4[0x2f] < 100)))) {
                iVar3 = FUN_0007fbfc();
                iVar2 = piVar4[0x2f];
                *(undefined1 *)(piVar4 + 10) = 0;
                if (iVar2 < 0x62) {
                    iVar2 = iVar2 + 100;
                    piVar4[0x2f] = iVar2;
                }
                piVar4[0x2f] = iVar2 + 0x76c;
                piVar4[0x30] = iVar3;
                if (((local_34 & 0xc) == 0) ||
                    (((local_34 & 0xc) == 4 &&
                      ((*(byte *)(piVar4 + 0xc0) & 1) == 0)))) {
                    FUN_00049c88(iVar5, 6);
                    *(undefined1 *)(piVar4 + 10) = 3;
                } else {
                    iVar2 = FUN_0004a4e8(piVar4);
                    if (iVar2 == 0) {
                        FUN_00049c88(iVar5, 6);
                    } else {
                        piVar4[0x38] = piVar4[0x3a];
                        piVar4[0x39] = piVar4[0x3b];
                        FUN_0004a534(iVar5);
                        FUN_00052d0c(iVar5 + 0x10, __s);
                    }
                }
            } else {
                FUN_00049c88(iVar5, 2);
            }
        }
    }
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_000588c8(uint param_1, int param_2)

{
    int iVar1;
    undefined4 uVar2;
    size_t sVar3;
    undefined1 uVar4;
    int iVar5;
    uint unaff_r5;
    char *__s;
    int in_r12;
    bool in_ZR;
    undefined4 local_40;
    undefined4 local_3c;
    undefined4 local_34;
    undefined4 local_30;
    undefined4 local_2c;
    undefined4 local_28;
    int local_24;
    uint local_20;
    int local_1c;

    if (in_ZR) {
        param_1 = unaff_r5 & in_r12 >> 8;
    }
    local_1c = __stack_chk_guard;
    iVar5 = *(int *)(param_2 + 0x54);
    iVar1 = ioctl(fd, 0x20000, &local_40);
    if (iVar1 < 0) {
        FUN_00075d40(3, "HOPF_P(%d): HOPF_CLOCK_GET_UTC: %m", param_1);
    }
    *(int *)(iVar5 + 0x308) = *(int *)(iVar5 + 0x308) + 1;
    uVar2 = FUN_0007fbfc(local_40, local_3c, local_34);
    uVar4 = (undefined1)(local_20 & 0x20);
    if ((local_20 & 0x20) != 0) {
        uVar4 = 1;
    }
    *(undefined1 *)(iVar5 + 0x28) = uVar4;
    *(undefined4 *)(iVar5 + 0xc4) = local_30;
    *(undefined4 *)(iVar5 + 200) = local_2c;
    *(undefined4 *)(iVar5 + 0xcc) = local_28;
    *(int *)(iVar5 + 0xd0) = local_24 * 1000000;
    *(undefined4 *)(iVar5 + 0xc0) = uVar2;
    __s = (char *)(iVar5 + 0x38);
    FUN_0007d00c(__s, 0x80,
                 "ST: %02X T: %02d:%02d:%02d.%03ld D: %02d.%02d.%04d", local_20,
                 local_30, local_2c, local_28, (local_24 * 1000000) / 1000000,
                 local_34, local_3c, local_40);
    sVar3 = strlen(__s);
    *(size_t *)(iVar5 + 0xb8) = sVar3 & 0xffff;
    FUN_0007055c((undefined4 *)(iVar5 + 0xe8));
    if (((local_20 & 0xc0) == 0) || (((local_20 & 0xc0) == 0x40 &&
                                      ((*(byte *)(iVar5 + 0x300) & 1) == 0)))) {
        FUN_00049c88(param_2, 6);
        *(undefined1 *)(iVar5 + 0x28) = 3;
    } else {
        iVar1 = FUN_0004a4e8(iVar5);
        if (iVar1 == 0) {
            FUN_00049c88(param_2, 6);
        } else {
            *(undefined4 *)(iVar5 + 0xe0) = *(undefined4 *)(iVar5 + 0xe8);
            *(undefined4 *)(iVar5 + 0xe4) = *(undefined4 *)(iVar5 + 0xec);
            FUN_0004a534(param_2);
            FUN_00052d0c(param_2 + 0x10, __s);
        }
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00058c10(undefined4 param_1, int param_2)

{
    int iVar1;
    ssize_t sVar2;
    int iVar3;
    undefined4 *puVar4;
    bool bVar5;

    iVar1 = __stack_chk_guard;
    puVar4 = *(undefined4 **)(param_2 + 0x54);
    iVar3 = *(int *)*puVar4;
    if (iVar3 == 0) {
        FUN_00049c88(param_2, 1);
    } else {
        *(int *)*puVar4 = iVar3 + -1;
    }
    sVar2 = write(puVar4[7], ":PTIME:TCODE?\r", 0xe);
    if (sVar2 == 0xe) {
        bVar5 = iVar1 == __stack_chk_guard;
        puVar4[0xc2] = puVar4[0xc2] + 1;
        if (bVar5) {
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        FUN_00049c88(param_2, 3);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00059618(int param_1, int param_2)

{
    char cVar1;
    size_t sVar2;
    uint uVar3;
    int iVar4;
    char *__s;
    undefined4 *puVar5;
    int iVar6;
    undefined4 uVar7;
    char *__s_00;
    undefined4 uVar8;
    undefined4 uVar9;
    undefined4 uVar10;
    bool bVar11;
    undefined8 uVar12;
    undefined4 *puVar13;
    int local_78;
    int local_5c;
    undefined1 auStack_58[4];
    undefined1 auStack_54[8];
    int local_4c;

    puVar5 = *(undefined4 **)(param_1 + 0x54);
    __s = (char *)*puVar5;
    local_5c = 0;
    iVar4 = *(int *)(__s + 0xc98);
    local_4c = __stack_chk_guard;
    *(int *)(__s + 0xc98) = iVar4 >> 1;
    if (param_2 == 1) {
        iVar6 = *(int *)(__s + 0xc90);
        *(uint *)(__s + 0xc98) = iVar4 >> 1 | 0x200;
    } else {
        if ((param_2 == 2) && (*(int *)(__s + 0xc84) == 2)) {
            iVar6 = 1;
            if (*(int *)(__s + 0xc90) != 1) {
                *(uint *)(__s + 0x300) = *(uint *)(__s + 0x300) | 8;
            }
            *(undefined4 *)(__s + 0x28) = *(undefined4 *)(__s + 0x38);
            *(undefined4 *)(__s + 0x2c) = *(undefined4 *)(__s + 0x3c);
            __s[0xc84] = '\x02';
            __s[0xc85] = '\0';
            __s[0xc86] = '\0';
            __s[0xc87] = '\0';
            goto LAB_000596e8;
        }
        iVar6 = *(int *)(__s + 0xc90);
    }
    *(int *)(__s + 0xc84) = param_2;
    if (iVar6 % 10 != 0)
        goto LAB_000596e8;
    uVar3 = *(uint *)(__s + 0xc98);
    iVar4 = *(int *)(__s + 0xc94);
    if (iVar6 == 10) {
        if (iVar4 < 2)
            goto LAB_000596e8;
        uVar3 = (int)uVar3 >> 1;
    LAB_000596b4:
        cVar1 = "0123456789abcdef"[(uVar3 << 0x17) >> 0x1c];
        __s[iVar4 + -1] = "0123456789abcdef"[uVar3 & 0xf];
        *(int *)(__s + 0xc94) = iVar4 + -2;
        __s[iVar4 + -2] = cVar1;
    } else if (1 < iVar4)
        goto LAB_000596b4;
    if (iVar6 == 0) {
        __s[0xc94] = '\x14';
        __s[0xc95] = '\0';
        __s[0xc96] = '\0';
        __s[0xc97] = '\0';
        puVar13 = puVar5 + 0x33;
        iVar4 = sscanf(__s, "%6s%2d%1d%2s%3d%2d%2d%2d", auStack_54,
                       puVar5 + 0x2f, &local_5c, auStack_58, puVar5 + 0x30,
                       puVar5 + 0x31, puVar5 + 0x32, puVar13);
        local_78 = puVar5[0x30];
        if (iVar4 == 8) {
            *(undefined1 *)(puVar5 + 10) = 0;
        } else {
            *(undefined1 *)(puVar5 + 10) = 3;
        }
        iVar4 = (*(int *)(__s + 0xc88) + *(int *)(__s + 0xc58)) % 0x3c;
        *(int *)(__s + 0xc88) = iVar4;
        if ((local_78 == 0) || ((puVar5[0x2f] != 0 && (local_5c == 0)))) {
            uVar3 = *(uint *)(__s + 0x300) | 0x80;
            *(uint *)(__s + 0x300) = uVar3;
        } else {
            uVar3 = *(uint *)(__s + 0x300);
        }
        iVar6 = puVar5[0x33];
        if (iVar4 == iVar6) {
            *(int *)(__s + 0xc88) = iVar6;
            if ((uVar3 == 0) && (*(int *)(__s + 0xc6c) == 10)) {
                puVar5[0x38] = puVar5[0x3a];
                puVar5[0x39] = puVar5[0x3b];
                uVar7 = *(undefined4 *)(__s + 0x2c);
                puVar5[0x3a] = *(undefined4 *)(__s + 0x28);
                puVar5[0x3b] = uVar7;
                iVar4 = FUN_0004a4e8(puVar5);
                if (iVar4 == 0) {
                    FUN_00049c88(param_1, 6);
                }
                uVar3 = *(uint *)(__s + 0x300);
                iVar6 = puVar5[0x33];
                local_78 = puVar5[0x30];
            }
        } else {
            uVar3 = uVar3 | 0x20;
            *(int *)(__s + 0xc88) = iVar6;
            *(uint *)(__s + 0x300) = uVar3;
        }
        uVar8 = puVar5[0x2f];
        uVar7 = puVar5[0x31];
        uVar9 = puVar5[0x32];
        uVar10 = *(undefined4 *)(__s + 0xb14);
        __s_00 = (char *)(puVar5 + 0xe);
        uVar12 = *(undefined8 *)(__s + 3000);
        FUN_0007474c(puVar5[0x3a], puVar5[0x3b], 0, 6, 0);
        FUN_0007d00c(
            __s_00, 0x80,
            "%02x %02d %03d %02d:%02d:%02d %4.0f %3d %6.3f %2d %6.2f %6.1f %s",
            uVar3, uVar8, local_78, uVar7, uVar9, iVar6, puVar13, uVar12,
            uVar10);
        sVar2 = strlen(__s_00);
        puVar5[0x2e] = sVar2;
        __s[0x300] = '\0';
        __s[0x301] = '\0';
        __s[0x302] = '\0';
        __s[0x303] = '\0';
        if ((*(byte *)(puVar5 + 0xc0) & 8) != 0) {
            FUN_00052d0c(param_1 + 0x10, __s_00);
        }
        iVar6 = *(int *)(__s + 0xc90);
    }
LAB_000596e8:
    bVar11 = local_4c == __stack_chk_guard;
    *(int *)(__s + 0xc90) = (iVar6 + 1) % 100;
    if (bVar11) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0005a258(int param_1)

{
    byte bVar1;
    int iVar2;
    int iVar3;
    uint uVar4;
    int extraout_r1;
    int iVar5;
    uint uVar6;
    int iVar7;
    int iVar8;
    int iVar9;
    int iVar10;
    uint uVar11;
    bool bVar12;
    double in_d0;
    undefined8 uVar13;
    double dVar14;
    double dVar15;
    double dVar16;
    double dVar17;
    double dVar18;
    double dVar19;
    double dVar20;
    double dVar21;
    double dVar22;
    double dVar23;
    undefined8 uVar24;
    uint local_40;
    int iStack_3c;

    iVar9 = **(int **)(param_1 + 0x54);
    dVar17 = *(double *)(iVar9 + 0xb58);
    *(double *)(iVar9 + 0xb60) = dVar17;
    dVar18 = *(double *)(iVar9 + 0xb50);
    *(double *)(iVar9 + 0xb58) = dVar18;
    dVar19 = *(double *)(iVar9 + 0xb48);
    *(double *)(iVar9 + 0xb50) = dVar19;
    dVar20 = *(double *)(iVar9 + 0xb40);
    *(double *)(iVar9 + 0xb48) = dVar20;
    iVar2 = __stack_chk_guard;
    dVar21 = *(double *)(iVar9 + 0xb38);
    *(double *)(iVar9 + 0xb40) = dVar21;
    dVar22 = *(double *)(iVar9 + 0xb30);
    *(double *)(iVar9 + 0xb38) = dVar22;
    dVar23 = *(double *)(iVar9 + 0xb28);
    *(double *)(iVar9 + 0xb30) = dVar23;
    dVar15 = *(double *)(iVar9 + 0xb20);
    *(double *)(iVar9 + 0xb28) = dVar15;
    dVar16 = *(double *)(iVar9 + 0xb80);
    dVar14 =
        in_d0 - (dVar18 * -3.87518 + dVar17 * 0.6505491 + dVar19 * 11.5118 +
                 dVar20 * -21.41264 + dVar21 * 27.12837 + dVar22 * -23.84486 +
                 dVar23 * 14.27663 + dVar15 * -5.352734);
    *(double *)(iVar9 + 0xb20) = dVar14;
    dVar14 = dVar15 * -0.02055878 + dVar14 * 0.004952157 + dVar23 * 0.04401413 +
             dVar22 * -0.06558851 + dVar21 * 0.07462108 + dVar20 * -0.06558851 +
             dVar19 * 0.04401413 + dVar18 * -0.02055878 + dVar17 * 0.004952157;
    *(double *)(iVar9 + 0x2f0) = *(double *)(iVar9 + 0x2f0) + dVar14 * dVar14;
    *(double *)(iVar9 + 0xb88) = dVar16;
    dVar18 = *(double *)(iVar9 + 0xb78);
    *(double *)(iVar9 + 0xb80) = dVar18;
    dVar19 = *(double *)(iVar9 + 0xb70);
    *(double *)(iVar9 + 0xb78) = dVar19;
    dVar17 = *(double *)(iVar9 + 0xb68);
    iVar10 = *(int *)(iVar9 + 0xc58);
    *(double *)(iVar9 + 0xb70) = dVar17;
    dVar15 = in_d0 - (dVar18 * -3.589893 + dVar16 * 0.8694604 +
                      dVar19 * 5.570154 + dVar17 * -3.849667);
    *(double *)(iVar9 + 0xb68) = dVar15;
    dVar15 = dVar17 * -0.01174951 + dVar15 * 0.003215696 + dVar19 * 0.01712074 +
             dVar18 * -0.01174951 + dVar16 * 0.003215696;
    *(double *)(iVar9 + 0x2f8) = *(double *)(iVar9 + 0x2f8) + dVar15 * dVar15;
    FUN_0009d0ec(*(int *)(iVar9 + 0xc74) + 1, iVar10);
    iVar3 = __stack_chk_guard;
    *(int *)(iVar9 + 0xc74) = extraout_r1;
    iVar9 = __stack_chk_guard;
    if (extraout_r1 != 0) {
        if (iVar2 == iVar3) {
            return;
        }
    LAB_0005a458:
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    if (iVar10 != 1) {
        dVar14 = dVar15;
    }
    if (iVar2 != iVar3)
        goto LAB_0005a458;
    iVar8 = **(int **)(param_1 + 0x54);
    iVar7 = (*(int *)(iVar8 + 0xc5c) + 1) % 0x50;
    *(int *)(iVar8 + 0xc5c) = iVar7;
    iVar2 = iVar8 + iVar7 * 8;
    dVar15 = *(double *)(iVar2 + 0x40);
    iVar5 = iVar7 % 8;
    iVar3 = iVar8 + iVar5 * 8;
    iVar10 = iVar3 + 0xc10;
    dVar15 = dVar15 + (dVar14 - dVar15) /
                          (double)(longlong)(*(int *)(iVar8 + 0xc6c) * 5);
    *(double *)(iVar2 + 0x40) = dVar15;
    *(double *)(iVar3 + 0xbc8) = dVar14;
    *(double *)(iVar3 + 0xc08) = dVar15;
    dVar14 = *(double *)(iVar8 + 0xc48);
    if (0.0 < dVar14) {
        if (dVar15 <= 0.0) {
            iVar10 = iVar5 + -4;
        }
        if (dVar15 <= 0.0) {
            dVar14 = (double)FixedToFP(CONCAT44(iVar10, iVar10), 0x20, 0x40, 3,
                                       0, 0);
            dVar14 = *(double *)(iVar8 + 0x2d0) + dVar14;
        }
        if (dVar15 <= 0.0) {
            *(double *)(iVar8 + 0x2d0) = dVar14;
        }
    }
    *(double *)(iVar8 + 0xc48) = dVar15;
    if (iVar7 == 0) {
        dVar15 = *(double *)(iVar8 + 0xbb0);
        dVar14 = *(double *)(iVar8 + 0xba8);
        *(double *)(iVar8 + 3000) = dVar15;
        *(double *)(iVar8 + 0xbc0) = dVar14;
        *(undefined4 *)(iVar8 + 0xbb0) = 0;
        *(undefined4 *)(iVar8 + 0xbb4) = 0xc12e8480;
        *(undefined4 *)(iVar8 + 0xba8) = 0;
        *(undefined4 *)(iVar8 + 0xbac) = 0x412e8480;
        uVar4 = *(uint *)(iVar8 + 0x300);
        if (dVar15 < 100.0) {
            uVar4 = uVar4 | 1;
            *(uint *)(iVar8 + 0x300) = uVar4;
        }
        if (dVar15 <= 0.0) {
            *(undefined4 *)(iVar8 + 0x2e8) = 0;
            *(undefined4 *)(iVar8 + 0x2ec) = 0;
        LAB_00059fa4:
            uVar4 = uVar4 | 4;
            *(uint *)(iVar8 + 0x300) = uVar4;
        } else {
            dVar15 = (dVar15 - dVar14) / dVar15;
            *(double *)(iVar8 + 0x2e8) = dVar15;
            if (dVar15 < 0.5)
                goto LAB_00059fa4;
        }
        if ((uVar4 & 0xf) == 0) {
            dVar15 = (double)(longlong) * (int *)(iVar8 + 0xc6c);
            dVar14 = dVar15 * dVar15 * 4.0;
        } else {
            dVar14 = 16.0;
            *(undefined4 *)(iVar8 + 0xc6c) = 2;
            *(undefined4 *)(iVar8 + 0xc70) = 0;
            dVar15 = 2.0;
        }
        dVar17 = *(double *)(iVar8 + 0x2d0);
        *(undefined4 *)(iVar8 + 0x2d0) = 0;
        *(undefined4 *)(iVar8 + 0x2d4) = 0;
        dVar17 = ((double)(longlong) * (int *)(iVar8 + 0xc58) * dVar17) / 80.0;
        *(double *)(iVar8 + 0x2d8) = dVar17;
        dVar14 = dVar17 / dVar14 + *(double *)(iVar8 + 0x2c8);
        *(double *)(iVar8 + 0x2c0) =
            *(double *)(iVar8 + 0x2c0) + dVar17 / dVar15;
        if (dVar14 <= 2.0) {
            bVar12 = dVar14 < -2.0;
            if (bVar12) {
                uVar4 = uVar4 | 2;
            }
            if (bVar12) {
                *(uint *)(iVar8 + 0x300) = uVar4;
            } else {
                *(double *)(iVar8 + 0x2c8) = dVar14;
            }
            if (bVar12) {
                *(undefined8 *)(iVar8 + 0x2c8) = 0xc000000000000000;
            }
        } else {
            *(undefined8 *)(iVar8 + 0x2c8) = 0x4000000000000000;
            *(uint *)(iVar8 + 0x300) = uVar4 | 2;
        }
    }
    if (iVar5 != 7)
        goto switchD_00059f30_default;
    uVar4 = *(int *)(iVar8 + 0xc7c) << 1;
    dVar14 = (*(double *)(iVar8 + 0xc18) - *(double *)(iVar8 + 0xc38)) * 0.5;
    if (*(double *)(iVar8 + 0xbb0) < dVar14) {
        *(double *)(iVar8 + 0xbb0) = dVar14;
    }
    if (dVar14 < *(double *)(iVar8 + 0xba8)) {
        *(double *)(iVar8 + 0xba8) = dVar14;
    }
    *(uint *)(iVar8 + 0xc7c) = uVar4;
    uVar6 = (*(int *)(iVar8 + 0xc78) + 1) % 10;
    *(uint *)(iVar8 + 0xc78) = uVar6;
    bVar12 = (*(double *)(iVar8 + 3000) + *(double *)(iVar8 + 0xbc0)) * 0.5 <=
             dVar14;
    if (bVar12) {
        uVar4 = uVar4 | 1;
    }
    if (bVar12) {
        *(uint *)(iVar8 + 0xc7c) = uVar4;
    }
    if ((uVar4 & 0x303c0f03) == 0x300c0300) {
        bVar12 = uVar6 != 0;
        if (bVar12) {
            uVar6 = *(uint *)(iVar8 + 0x300);
        }
        if (bVar12) {
            uVar6 = uVar6 | 8;
        }
        if (bVar12) {
            *(uint *)(iVar8 + 0x300) = uVar6;
        }
        uVar4 = *(int *)(iVar8 + 0xc80) << 1;
        uVar6 = 0;
        *(uint *)(iVar8 + 0xc80) = uVar4;
        *(undefined4 *)(iVar8 + 0xc78) = 0;
        dVar14 =
            (*(double *)(iVar8 + 0xbd8) - *(double *)(iVar8 + 0xbf8)) * 0.5;
        if (*(double *)(iVar8 + 0xba0) <= dVar14)
            goto LAB_00059f24;
    LAB_0005a034:
        iVar2 = *(int *)(iVar8 + 0xc68) - iVar7;
        dVar15 = -*(double *)(iVar8 + 0x2d8);
        *(double *)(iVar8 + 0x2e0) = dVar15;
        if (iVar2 + 1U < 3) {
            iVar3 = *(int *)(iVar8 + 0xc6c);
            iVar10 = *(int *)(iVar8 + 0xc70) + 1;
            *(int *)(iVar8 + 0xc70) = iVar10;
            if (iVar10 != iVar3 * 0x14 &&
                iVar10 + iVar3 * -0x14 < 0 == SBORROW4(iVar10, iVar3 * 0x14)) {
                iVar2 = iVar3 + 1;
                if (iVar2 < 0xb) {
                    *(int *)(iVar8 + 0xc6c) = iVar2;
                }
                if (iVar2 != 10 && iVar3 + -9 < 0 == SBORROW4(iVar2, 10)) {
                    *(undefined4 *)(iVar8 + 0xc6c) = 10;
                }
                goto LAB_0005a054;
            }
            dVar15 = dVar15 - (double)(longlong)iVar2;
            *(double *)(iVar8 + 0x2e0) = dVar15;
        } else {
        LAB_0005a054:
            *(int *)(iVar8 + 0xc68) = iVar7;
            *(undefined4 *)(iVar8 + 0xc70) = 0;
        }
        *(undefined4 *)(iVar8 + 0x38) = *(undefined4 *)(iVar8 + 0x30);
        *(undefined4 *)(iVar8 + 0x3c) = *(undefined4 *)(iVar8 + 0x34);
        dVar15 = *(double *)(iVar8 + 0xc50) + (double)(longlong) *
                                                  (int *)(iVar8 + 0xc58) *
                                                  (dVar15 / 8000.0);
        bVar12 = dVar15 < 0.0;
        if (bVar12) {
            dVar15 = -dVar15;
        }
        dVar15 = ldexp(dVar15, 0x20);
        uVar13 =
            VectorShiftRight((ulonglong)CONCAT14(bVar12, (uint)bVar12), 0x20);
        uVar24 =
            FUN_0009d558(SUB84(dVar15, 0), (int)((ulonglong)dVar15 >> 0x20));
        local_40 = (uint)uVar13;
        iStack_3c = (int)((ulonglong)uVar13 >> 0x20);
        bVar1 = *(byte *)(iVar8 + 0xc80);
        uVar11 = (uint)uVar24 ^ -local_40;
        *(undefined4 *)(iVar8 + 0x30) = *(undefined4 *)(iVar8 + 0x18);
        *(undefined4 *)(iVar8 + 0x34) = *(undefined4 *)(iVar8 + 0x1c);
        uVar4 = *(uint *)(iVar8 + 0x34);
        uVar6 = uVar4 - (local_40 + uVar11);
        *(uint *)(iVar8 + 0x34) = uVar6;
        iVar2 =
            *(int *)(iVar8 + 0x30) - (iStack_3c +
                                      ((uint)((ulonglong)uVar24 >> 0x20) ^
                                       -(iStack_3c + (uint)(local_40 != 0))) +
                                      (uint)CARRY4(local_40, uVar11));
        if (uVar4 < uVar6) {
            iVar2 = iVar2 + -1;
        }
        *(int *)(iVar8 + 0x30) = iVar2;
        if (bVar1 == 0xe0) {
        LAB_0005a22c:
            FUN_00059618(param_1, 1);
        } else if (bVar1 < 0xe1) {
            if (bVar1 != 0x80) {
                if (bVar1 == 0xc0)
                    goto LAB_0005a22c;
                if (bVar1 != 0)
                    goto LAB_0005a13c;
            }
            FUN_00059618(param_1, 0);
        } else if (bVar1 == 0xf8) {
        LAB_0005a200:
            FUN_00059618(param_1, 2);
        } else {
            if (bVar1 < 0xf9) {
                if (bVar1 == 0xf0)
                    goto LAB_0005a22c;
            } else if ((bVar1 == 0xfc) || (bVar1 == 0xfe))
                goto LAB_0005a200;
        LAB_0005a13c:
            FUN_00059618(param_1, 0);
            *(uint *)(iVar8 + 0x300) = *(uint *)(iVar8 + 0x300) | 0x10;
        }
        dVar15 = *(double *)(iVar8 + 0xb90);
        if (dVar14 < dVar15) {
            dVar15 = dVar14;
        }
        *(double *)(iVar8 + 0xba0) =
            (dVar15 + *(double *)(iVar8 + 0xb98)) * 0.5;
        *(undefined4 *)(iVar8 + 0xb90) = 0;
        *(undefined4 *)(iVar8 + 0xb94) = 0x412e8480;
        *(undefined4 *)(iVar8 + 0xb98) = 0;
        *(undefined4 *)(iVar8 + 0xb9c) = 0xc12e8480;
        goto switchD_00059f30_default;
    }
    uVar4 = *(int *)(iVar8 + 0xc80) << 1;
    *(uint *)(iVar8 + 0xc80) = uVar4;
    dVar14 = (*(double *)(iVar8 + 0xbd8) - *(double *)(iVar8 + 0xbf8)) * 0.5;
    if (*(double *)(iVar8 + 0xba0) <= dVar14) {
    LAB_00059f24:
        *(uint *)(iVar8 + 0xc80) = uVar4 | 1;
    }
    switch (uVar6) {
    case 0:
        goto LAB_0005a034;
    case 1:
        goto LAB_00059fc0;
    case 2:
        if (dVar14 <= *(double *)(iVar8 + 0xb98))
            break;
    LAB_00059fc0:
        *(double *)(iVar8 + 0xb98) = dVar14;
        break;
    case 3:
        break;
    case 4:
        break;
    case 5:
        break;
    case 6:
        break;
    case 7:
        break;
    case 8:
        break;
    case 9:
        *(double *)(iVar8 + 0xb90) = dVar14;
    }
switchD_00059f30_default:
    if (iVar9 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0005a8b8(undefined4 param_1, undefined4 param_2, int param_3)

{
    short sVar1;
    short sVar2;
    int iVar3;
    int iVar4;
    short *psVar5;

    iVar3 = __stack_chk_guard;
    psVar5 = (short *)(param_3 + 500);
    iVar4 = (*(code *)(&PTR_LAB_000c56e4)[*(short *)(param_3 + 0x1f6) * 5 +
                                          (int)*psVar5])();
    if (iVar4 == 1) {
        *(undefined2 *)(param_3 + 0x1f0) = 0;
        iVar4 = (*(short *)(param_3 + 0x1f6) * 5 + (int)*psVar5) * 2;
        sVar1 = *(short *)(&DAT_000a8f20 + iVar4);
        sVar2 = *(short *)(&DAT_000a8f90 + iVar4);
        if ((int)*psVar5 != (int)sVar2) {
            *(undefined1 *)(param_3 + 0xf) = 0;
            *(undefined2 *)(param_3 + 0x1f2) = 0;
            *(undefined2 *)(param_3 + 0x1f8) = 0;
            *(undefined4 *)(param_3 + 0x38) = 0;
            *(undefined1 *)(param_3 + 0x1e8) = 0;
            *(undefined1 *)(param_3 + 0x1e9) = 0;
            *(undefined1 *)(param_3 + 0x1ea) = 0;
            *(undefined1 *)(param_3 + 0x1eb) = 0;
            *(undefined1 *)(param_3 + 0x1ec) = 0;
            *(undefined2 *)(param_3 + 0x196) = 0;
            if (sVar2 == 0) {
                *(undefined2 *)(param_3 + 0xc) = 3;
            }
        }
        *psVar5 = sVar2;
        if (sVar1 != 0) {
            *(short *)(param_3 + 0x1f6) = sVar1;
            FUN_0005a8b8(param_1, param_2, param_3);
        }
    }
    iVar4 = __stack_chk_guard;
    *(undefined2 *)(param_3 + 0x1f6) = 0;
    if (iVar3 != iVar4) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0005adcc(undefined4 param_1, undefined4 param_2, int param_3)

{
    short sVar1;
    short sVar2;
    int iVar3;
    int iVar4;
    short *psVar5;

    iVar3 = __stack_chk_guard;
    psVar5 = (short *)(param_3 + 0x200);
    iVar4 = (*(code *)(&PTR_LAB_000c57c0)[*(short *)(param_3 + 0x202) * 5 +
                                          (int)*psVar5])();
    if (iVar4 == 1) {
        iVar4 = (*(short *)(param_3 + 0x202) * 5 + (int)*psVar5) * 2;
        sVar1 = *(short *)(&DAT_000a90a0 + iVar4);
        sVar2 = *(short *)(&DAT_000a9000 + iVar4);
        if ((int)*psVar5 != (int)sVar1) {
            *(undefined2 *)(param_3 + 0x1fa) = 0;
            *(undefined2 *)(param_3 + 0x1fe) = 0;
            *(undefined2 *)(param_3 + 0x204) = 0;
        }
        *psVar5 = sVar1;
        if (sVar2 != 0) {
            *(short *)(param_3 + 0x202) = sVar2;
            FUN_0005adcc(param_1, param_2, param_3);
        }
    }
    iVar4 = __stack_chk_guard;
    *(undefined2 *)(param_3 + 0x202) = 0;
    if (iVar3 == iVar4) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0005b370(undefined4 param_1, int param_2)

{
    short sVar1;
    int iVar2;
    int iVar3;
    short sVar4;
    char *pcVar5;
    undefined4 *puVar6;
    int iVar7;
    int iVar8;
    int *piVar9;

    iVar2 = __stack_chk_guard;
    puVar6 = *(undefined4 **)(param_2 + 0x54);
    pcVar5 = (char *)*puVar6;
    if ((pcVar5[0xe] == '\0') && (*pcVar5 == 'd')) {
        iVar3 = *(short *)(pcVar5 + 500) * 2;
        sVar1 = *(short *)(&DAT_000a9140 + iVar3);
        if ((sVar1 != 0) &&
            (sVar4 = *(short *)(pcVar5 + 0x1f0) + 1,
             *(short *)(pcVar5 + 0x1f0) = sVar4, sVar1 <= sVar4)) {
            pcVar5[0x1f6] = '\t';
            pcVar5[0x1f7] = '\0';
            FUN_0005a8b8(param_2, puVar6, pcVar5);
            iVar3 = (int)*(short *)(pcVar5 + 500) << 1;
        }
        sVar1 = *(short *)(&DAT_000a914c + iVar3);
        if ((sVar1 != 0) && (sVar4 = *(short *)(pcVar5 + 0x1f2),
                             *(short *)(pcVar5 + 0x1f2) = sVar4 + 1,
                             sVar1 <= (short)(sVar4 + 1))) {
            pcVar5[0x1f6] = '\n';
            pcVar5[0x1f7] = '\0';
            FUN_0005a8b8(param_2, puVar6, pcVar5);
        }
        iVar8 = (int)*(short *)(pcVar5 + 0x200);
        iVar3 = iVar8 * 2;
        if ((*(short *)(&DAT_000a9158 + iVar3) != 0) ||
            (*(short *)(&DAT_000a9164 + iVar3) != 0)) {
            piVar9 = *(int **)(param_2 + 0x54);
            iVar7 = *piVar9;
            iVar3 = *(short *)(iVar7 + 0x200) * 2;
            sVar1 = *(short *)(&DAT_000a9158 + iVar3);
            if ((sVar1 != 0) &&
                (sVar4 = *(short *)(iVar7 + 0x1fc) + 1,
                 *(short *)(iVar7 + 0x1fc) = sVar4, sVar1 <= sVar4)) {
                *(undefined2 *)(iVar7 + 0x202) = 0xe;
                FUN_0005adcc(param_2, piVar9, iVar7);
                iVar3 = (int)*(short *)(iVar7 + 0x200) << 1;
            }
            sVar1 = *(short *)(&DAT_000a9164 + iVar3);
            if ((sVar1 != 0) &&
                (sVar4 = *(short *)(iVar7 + 0x1fe) + 1,
                 *(short *)(iVar7 + 0x1fe) = sVar4, sVar1 <= sVar4)) {
                *(undefined2 *)(iVar7 + 0x202) = 0xf;
                FUN_0005adcc(param_2, piVar9, iVar7);
            }
            iVar3 = __stack_chk_guard;
            sVar1 = *(short *)(pcVar5 + 0x200);
            if (iVar8 != sVar1) {
                if (sVar1 == 0) {
                    pcVar5[0x1f6] = '\x03';
                    pcVar5[0x1f7] = '\0';
                } else {
                    if (sVar1 != 3)
                        goto LAB_0005b3b4;
                    pcVar5[0x1f6] = '\x02';
                    pcVar5[0x1f7] = '\0';
                }
                if (iVar2 == iVar3) {
                    FUN_0005a8b8(param_2, puVar6, pcVar5);
                    return;
                }
                goto LAB_0005b61c;
            }
        }
    }
LAB_0005b3b4:
    if (iVar2 == __stack_chk_guard) {
        return;
    }
LAB_0005b61c:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0005b63c(int param_1, undefined4 param_2, char *param_3)

{
    size_t sVar1;
    ushort **ppuVar2;
    uint uVar3;
    uint uVar4;
    undefined *__src;
    uint uVar5;
    size_t sVar6;
    uint uVar7;
    byte *pbVar8;
    undefined1 *puVar9;
    char *__s;
    bool bVar10;
    bool bVar11;
    undefined1 *local_128;
    uint local_11c;
    undefined4 auStack_114[33];
    undefined1 auStack_90[4];
    undefined1 auStack_8c[96];
    int local_2c;

    local_2c = __stack_chk_guard;
    switch (param_2) {
    case 1:
        puVar9 = auStack_8c;
        sVar6 = 5;
        uVar7 = 0x60;
        __src = &UNK_000a9190;
        local_11c = 0x5f;
        break;
    case 2:
        sVar6 = 5;
        local_11c = 0x5f;
        uVar7 = 0x60;
        puVar9 = auStack_8c;
        __src = &UNK_000a9198;
        break;
    case 3:
        sVar6 = 5;
        local_11c = 0x5f;
        uVar7 = 0x60;
        puVar9 = auStack_8c;
        __src = &UNK_000a91a0;
        break;
    case 4:
        sVar6 = 5;
        local_11c = 0x5f;
        uVar7 = 0x60;
        puVar9 = auStack_8c;
        __src = &UNK_000a91a8;
        break;
    case 5:
        sVar6 = 5;
        local_11c = 0x5f;
        uVar7 = 0x60;
        puVar9 = auStack_8c;
        __src = &UNK_000a91b0;
        break;
    case 6:
        sVar6 = 5;
        local_11c = 0x5f;
        uVar7 = 0x60;
        puVar9 = auStack_8c;
        __src = &UNK_000a91b8;
        break;
    case 7:
        sVar6 = 5;
        local_11c = 0x5f;
        uVar7 = 0x60;
        puVar9 = auStack_8c;
        __src = &UNK_000a91c0;
        break;
    case 8:
        sVar6 = 5;
        local_11c = 0x5f;
        uVar7 = 0x60;
        puVar9 = auStack_8c;
        __src = &UNK_000a91c8;
        break;
    default:
        puVar9 = auStack_90;
        local_11c = 99;
        sVar6 = 1;
        uVar7 = 100;
        __src = &DAT_000a9528;
    }
    local_128 = auStack_90;
    sVar1 = strlen(param_3);
    memcpy(local_128, __src, sVar6);
    memcpy(auStack_114, &PTR_s_<NUL> _000c7ed0, 0x84);
    uVar4 = sVar1;
    if (sVar1 != 0) {
        pbVar8 = (byte *)(param_3 + -1);
        uVar5 = 0;
        ppuVar2 = __ctype_b_loc();
        uVar4 = 0;
        do {
            while (true) {
                pbVar8 = pbVar8 + 1;
                uVar3 = (uint)*pbVar8;
                if (((*ppuVar2)[uVar3] & 0x4000) == 0)
                    break;
                uVar3 = uVar4 + 1;
                if (uVar7 <= uVar3)
                    goto LAB_0005b7a8;
                puVar9[uVar4] = *pbVar8;
            LAB_0005b72c:
                uVar5 = uVar5 + 1;
                bVar11 = uVar3 <= uVar7;
                bVar10 = uVar7 == uVar3;
                if (bVar11 && !bVar10) {
                    bVar11 = uVar5 <= sVar1;
                    bVar10 = sVar1 == uVar5;
                }
                uVar4 = uVar3;
                if (!bVar11 || bVar10)
                    goto LAB_0005b7a8;
            }
            if (0x20 < uVar3) {
                if (uVar4 + 6 < uVar7) {
                    uVar3 = uVar4 + 5;
                    FUN_0007d00c(puVar9 + uVar4, uVar7 - uVar4, "<x%X>");
                    goto LAB_0005b72c;
                }
                break;
            }
            __s = (char *)auStack_114[uVar3];
            sVar6 = strlen(__s);
            if (uVar7 <= uVar4 + 1 + sVar6)
                break;
            uVar3 = sVar6 + uVar4;
            uVar5 = uVar5 + 1;
            FUN_0007e4b4(puVar9 + uVar4, __s, uVar7 - uVar4);
            bVar11 = uVar3 <= uVar7;
            bVar10 = uVar7 == uVar3;
            if (bVar11 && !bVar10) {
                bVar11 = uVar5 <= sVar1;
                bVar10 = sVar1 == uVar5;
            }
            uVar4 = uVar3;
        } while (bVar11 && !bVar10);
    LAB_0005b7a8:
        if (local_11c <= uVar4) {
            uVar4 = local_11c;
        }
    }
    puVar9[uVar4] = 0;
    FUN_00052d0c(param_1 + 0x10, local_128);
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0005b988(undefined4 param_1, int param_2)

{
    int iVar1;
    ssize_t sVar2;

    iVar1 = __stack_chk_guard;
    sVar2 = write(*(int *)(param_2 + 0x1c), "ATH0\r\n", 6);
    if (sVar2 != 6) {
        FUN_00049c88(param_1, 3);
    }
    FUN_0005b63c(param_1, 2, "ATH0\r\n");
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(1);
}

void FUN_0005ba64(undefined4 param_1, int param_2)

{
    int iVar1;
    ssize_t sVar2;

    iVar1 = __stack_chk_guard;
    sVar2 = write(*(int *)(param_2 + 0x1c), &DAT_000a91e0, 3);
    if (sVar2 != 3) {
        FUN_00049c88(param_1, 3);
    }
    FUN_0005b63c(param_1, 2, &DAT_000a91e0);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(0);
}

void FUN_0005baf4(undefined4 param_1, undefined4 param_2, int param_3)

{
    short sVar1;
    int iVar2;
    int iVar3;
    short sVar4;

    iVar2 = __stack_chk_guard;
    iVar3 = *(short *)(param_3 + 0x200) * 2;
    sVar4 = *(short *)(param_3 + 0x1fa) + 1;
    sVar1 = *(short *)(&DAT_000a9158 + iVar3);
    *(short *)(param_3 + 0x1fa) = sVar4;
    iVar3 = FUN_0009ce58((int)*(short *)(&DAT_000a9164 + iVar3), (int)sVar1);
    if (sVar4 < iVar3) {
        FUN_0005ba64(param_1, param_2, param_3);
        iVar3 = __stack_chk_guard;
        *(undefined2 *)(param_3 + 0x1fc) = 0;
        if (iVar2 == iVar3) {
            return;
        }
    } else if (iVar2 == __stack_chk_guard) {
        FUN_0005b988(param_1, param_2, param_3);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0005c054(undefined4 param_1, int param_2)

{
    undefined4 uVar1;
    int iVar2;
    int iVar3;
    bool bVar4;
    undefined1 auStack_58[60];
    int local_1c;

    local_1c = __stack_chk_guard;
    gettimeofday(
        (timeval *)(param_2 + (*(short *)(param_2 + 0x196) + 0x38) * 8),
        (__timezone_ptr_t)0x0);
    param_2 = param_2 + *(short *)(param_2 + 0x196) * 8;
    iVar3 = *(int *)(param_2 + 0x1c4) - *(int *)(param_2 + 0x19c);
    bVar4 = iVar3 < 0;
    *(int *)(param_2 + 0x1c4) = iVar3;
    if (bVar4) {
        iVar3 = iVar3 + 0xf4000;
    }
    iVar2 = *(int *)(param_2 + 0x1c0) - *(int *)(param_2 + 0x198);
    if (bVar4) {
        iVar3 = iVar3 + 0x240;
    }
    *(int *)(param_2 + 0x1c0) = iVar2;
    if (bVar4) {
        *(int *)(param_2 + 0x1c4) = iVar3;
        iVar2 = iVar2 + -1;
        *(int *)(param_2 + 0x1c0) = iVar2;
    }
    iVar2 = iVar2 * 1000 + iVar3 / 1000;
    FUN_0007d00c(auStack_58, 0x3c, "* Loopback delay : %d.%03d mSec.", iVar2,
                 iVar3 % 1000);
    if (iVar2 < 0x2bd) {
        uVar1 = 4;
    } else {
        uVar1 = 6;
    }
    FUN_0005b63c(param_1, uVar1, auStack_58);
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0005c15c(int param_1, int param_2, int param_3)

{
    int iVar1;
    undefined4 uVar2;
    int iVar3;
    char *pcVar4;
    undefined4 uVar5;
    int iVar6;
    undefined4 uVar7;
    int iVar8;
    undefined4 uVar9;
    undefined4 uVar10;
    undefined4 uVar11;
    undefined1 auStack_6c[80];
    int local_1c;

    uVar2 = *(undefined4 *)(param_3 + 0x18);
    uVar5 = *(undefined4 *)(param_3 + 0x20);
    local_1c = __stack_chk_guard;
    *(undefined4 *)(param_2 + 0xbc) = uVar2;
    iVar1 = FUN_0007fbfc(uVar2, *(undefined4 *)(param_3 + 0x1c), uVar5);
    iVar3 = *(int *)(param_3 + 0x30);
    iVar6 = *(int *)(param_3 + 0x24);
    uVar2 = *(undefined4 *)(param_3 + 0x2c);
    *(undefined4 *)(param_2 + 200) = *(undefined4 *)(param_3 + 0x28);
    iVar8 = iVar6 + -9;
    if (iVar8 >= 0) {
        *(int *)(param_2 + 0xc4) = iVar8;
    }
    *(undefined4 *)(param_2 + 0xcc) = uVar2;
    *(int *)(param_2 + 0xd0) = iVar3 * 1000000;
    *(int *)(param_2 + 0xc0) = iVar1;
    if (iVar8 < 0) {
        *(int *)(param_2 + 0xc0) = iVar1 + -1;
        *(int *)(param_2 + 0xc4) = iVar6 + 0xf;
        if (iVar1 + -1 < 1) {
            iVar1 = *(int *)(param_2 + 0xbc) + -1;
            *(int *)(param_2 + 0xbc) = iVar1;
            uVar2 = FUN_0007fbfc(iVar1, 0xc, 0x1f);
            *(undefined4 *)(param_2 + 0xc0) = uVar2;
        }
    }
    iVar1 = FUN_0004a4e8(param_2);
    if (iVar1 == 0) {
        FUN_00049c88(param_1, 6);
    } else {
        *(undefined4 *)(param_2 + 0xe0) = *(undefined4 *)(param_2 + 0xe8);
        *(undefined4 *)(param_2 + 0xe4) = *(undefined4 *)(param_2 + 0xec);
        FUN_0004a534(param_1);
        uVar9 = *(undefined4 *)(param_2 + 0xbc);
        iVar1 = *(int *)(param_2 + 0xd0) / 1000000;
        uVar2 = *(undefined4 *)(param_2 + 0xc4);
        uVar11 = *(undefined4 *)(param_2 + 200);
        uVar10 = *(undefined4 *)(param_2 + 0xc0);
        uVar5 = *(undefined4 *)(param_2 + 0xcc);
        FUN_0007d00c(
            auStack_6c, 0x50,
            "%04d/%02d/%02d %02d:%02d:%02d.%03d JST   ( %04d/%03d "
            "%02d:%02d:%02d.%03d UTC )",
            *(undefined4 *)(param_3 + 0x18), *(undefined4 *)(param_3 + 0x1c),
            *(undefined4 *)(param_3 + 0x20), *(undefined4 *)(param_3 + 0x24),
            *(undefined4 *)(param_3 + 0x28), *(undefined4 *)(param_3 + 0x2c),
            *(undefined4 *)(param_3 + 0x30), uVar9, uVar10, uVar2, uVar11,
            uVar5, iVar1);
        FUN_0005b63c(param_1, 5, auStack_6c);
        switch (*(undefined1 *)(param_1 + 0x128)) {
        case 0:
            uVar7 = 0x20;
            pcVar4 = "Reject";
            break;
        case 1:
            uVar7 = 0x78;
            pcVar4 = "FalseTick";
            break;
        case 2:
            uVar7 = 0x2e;
            pcVar4 = "Excess";
            break;
        case 3:
            uVar7 = 0x2d;
            pcVar4 = "Outlier";
            break;
        case 4:
            uVar7 = 0x2b;
            pcVar4 = "Candidate";
            break;
        case 5:
            uVar7 = 0x23;
            pcVar4 = "Selected";
            break;
        case 6:
            uVar7 = 0x2a;
            pcVar4 = "Sys.Peer";
            break;
        case 7:
            uVar7 = 0x6f;
            pcVar4 = "PPS.Peer";
            break;
        default:
            uVar7 = 0x20;
            pcVar4 = "";
        }
        FUN_0007d00c(
            auStack_6c, 0x50,
            "status %d [%c] %s : offset %3.3f mSec. : jitter %3.3f mSec.",
            *(undefined1 *)(param_1 + 0x128), uVar7, pcVar4,
            *(double *)(param_1 + 0x260) * 1000.0,
            *(double *)(param_1 + 0x270) * 1000.0, uVar9, uVar10, uVar2, uVar11,
            uVar5, iVar1);
        FUN_0005b63c(param_1, 4, auStack_6c);
    }
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0005ce20(undefined4 param_1, int param_2)

{
    byte bVar1;
    size_t sVar2;
    int iVar3;
    ssize_t sVar4;
    int *piVar5;
    short sVar6;
    int iVar7;
    uint uVar8;
    int iVar9;
    byte *pbVar10;
    undefined1 *__buf;
    undefined4 *puVar11;
    size_t __n;
    uint extraout_r12;
    uint uVar12;
    int iVar13;
    bool bVar14;
    undefined1 local_54;
    undefined1 local_53;
    undefined1 local_50;
    undefined1 local_4f;
    undefined1 local_4e;
    undefined1 local_4d;
    undefined1 local_4c;
    undefined1 local_4b;
    undefined1 local_4a;
    undefined1 local_49;
    undefined1 local_48;
    undefined1 auStack_44[40];
    int local_1c;

    puVar11 = *(undefined4 **)(param_2 + 0x54);
    pbVar10 = (byte *)*puVar11;
    local_1c = __stack_chk_guard;
    if (pbVar10[10] != 0) {
        FUN_0005b63c(param_2, 7,
                     "Ignore polling because of error during initializing");
        goto LAB_0005d070;
    }
    iVar9 = puVar11[0xc2];
    if ((iVar9 != 0) && (*(int *)(pbVar10 + 0x14) == 0)) {
        FUN_00049c88(param_2, 1);
        iVar9 = puVar11[0xc2];
    }
    puVar11[0xc2] = iVar9 + 1;
    bVar1 = *(byte *)(param_2 + 0x12a);
    if ((bVar1 & 0x80) == 0) {
        local_50 = 0x30;
    } else {
        local_50 = 0x31;
    }
    bVar14 = (bVar1 & 0x40) != 0;
    if (bVar14) {
        puVar11 = (undefined4 *)0x31;
    }
    local_4f = SUB41(puVar11, 0);
    if (!bVar14) {
        local_4f = 0x30;
    }
    if ((bVar1 & 0x20) == 0) {
        local_4e = 0x30;
    } else {
        local_4e = 0x31;
    }
    if ((bVar1 & 0x10) == 0) {
        local_4d = 0x30;
    } else {
        local_4d = 0x31;
    }
    local_49 = 0;
    if ((bVar1 & 8) == 0) {
        local_4c = 0x30;
    } else {
        local_4c = 0x31;
    }
    local_48 = 0;
    if ((bVar1 & 4) == 0) {
        local_4b = 0x30;
    } else {
        local_4b = 0x31;
    }
    if ((bVar1 & 2) == 0) {
        local_4a = 0x30;
    } else {
        local_4a = 0x31;
    }
    FUN_0007d00c(auStack_44, 0x28, "polls=%ld reach=%s", iVar9 + 1, &local_50);
    iVar9 = 0x5cf1c;
    FUN_0005b63c(param_2, 5, auStack_44);
    bVar1 = *pbVar10;
    pbVar10[0x10] = 0;
    pbVar10[0x11] = 0;
    pbVar10[0x12] = 0;
    pbVar10[0x13] = 0;
    pbVar10[0x14] = 0;
    pbVar10[0x15] = 0;
    pbVar10[0x16] = 0;
    pbVar10[0x17] = 0;
    pbVar10[0xf] = 0;
    pbVar10[0xb8] = 0;
    pbVar10[0xb9] = 0;
    pbVar10[0xba] = 0;
    pbVar10[0xbb] = 0;
    pbVar10[0xc] = 1;
    pbVar10[0xd] = 0;
    if (bVar1 == 4) {
    LAB_0005d128:
        *(undefined1 *)(**(int **)(param_2 + 0x54) + 0xf) = 0;
    } else {
        if (bVar1 < 5) {
            if (bVar1 == 2) {
                piVar5 = *(int **)(param_2 + 0x54);
                iVar3 = *piVar5;
                *(undefined1 *)(iVar3 + 0xf) = 0;
                iVar9 = piVar5[7];
                *(undefined4 *)(iVar3 + 0xb8) = 0;
                *(undefined4 *)(iVar3 + 0x128) = 0;
                *(undefined4 *)(iVar3 + 400) = 0;
                *(short *)(iVar3 + 0x10) = *(short *)(iVar3 + 0x10) + 1;
                sVar4 = write(iVar9, &DAT_000a9524, 4);
                if (sVar4 != 4) {
                    FUN_00049c88(param_2, 3);
                }
                FUN_0005b63c(param_2, 2, &DAT_000a9524);
                goto LAB_0005d070;
            }
            if (bVar1 < 3) {
                if (bVar1 != 1)
                    goto LAB_0005d070;
                piVar5 = *(int **)(param_2 + 0x54);
                iVar7 = *piVar5;
                *(undefined1 *)(iVar7 + 0xf) = 0;
                *(undefined4 *)(iVar7 + 0x38) = 0;
                iVar3 = piVar5[7];
                bVar14 = (*(byte *)(piVar5 + 0xc0) & 1) != 0;
                if (bVar14) {
                    iVar13 = *(ushort *)(iVar7 + 0x10) + 1;
                } else {
                    iVar13 = 3;
                    *(undefined4 *)(iVar7 + 0x14) = 2;
                    iVar9 = iVar13;
                }
                *(short *)(iVar7 + 0x10) = (short)iVar13;
                if (bVar14) {
                    iVar9 = (int)(short)iVar13;
                }
                __buf = *(undefined1 **)(&DAT_000c5a1c + iVar9 * 0x14);
                __n = *(size_t *)(&DAT_000c5a20 + iVar9 * 0x14);
                goto LAB_0005d028;
            }
            piVar5 = *(int **)(param_2 + 0x54);
            iVar9 = *piVar5;
            sVar6 = *(short *)(iVar9 + 2);
            *(undefined1 *)(iVar9 + 0xf) = 0;
            if (sVar6 == 1) {
                local_54 = 0x54;
            } else if ((0 < sVar6) && (sVar6 < 4)) {
                local_54 = 0x43;
            }
            __buf = &local_54;
            local_53 = 0;
            sVar4 = write(piVar5[7], __buf, 1);
            if (sVar4 != 1)
                goto LAB_0005d03c;
        } else {
            if (bVar1 == 6)
                goto LAB_0005d128;
            if (5 < bVar1) {
                if (bVar1 == 100) {
                    piVar5 = *(int **)(param_2 + 0x54);
                    iVar9 = *piVar5;
                    if (*(short *)(iVar9 + 500) == 0) {
                        *(undefined4 *)(iVar9 + 0xb8) = 0;
                        *(undefined4 *)(iVar9 + 0x128) = 0;
                        *(undefined4 *)(iVar9 + 400) = 0;
                    }
                    *(undefined2 *)(iVar9 + 0x1f6) = 1;
                    FUN_0005a8b8(param_2, piVar5, iVar9);
                }
                goto LAB_0005d070;
            }
            piVar5 = *(int **)(param_2 + 0x54);
            iVar9 = *piVar5;
            *(undefined4 *)(iVar9 + 0x38) = 0;
            bVar14 = (*(byte *)(piVar5 + 0xc0) & 1) == 0;
            if (bVar14) {
                *(undefined4 *)(iVar9 + 0x14) = 1;
                uVar8 = 2;
                uVar12 = uVar8;
            } else {
                uVar8 = (uint) * (ushort *)(iVar9 + 0x10);
                uVar12 = extraout_r12;
            }
            sVar6 = (short)uVar8;
            if (!bVar14) {
                sVar6 = sVar6 + 1;
            }
            *(short *)(iVar9 + 0x10) = sVar6;
            iVar3 = piVar5[7];
            if (!bVar14) {
                uVar12 = (uint)sVar6;
            }
            __buf = *(undefined1 **)(&DAT_000c5aa8 + uVar12 * 0x10);
            __n = *(size_t *)(&DAT_000c5aac + uVar12 * 0x10);
        LAB_0005d028:
            sVar2 = write(iVar3, __buf, __n);
            if (__n != sVar2) {
            LAB_0005d03c:
                FUN_00049c88(param_2, 3);
            }
        }
        FUN_0005b63c(param_2, 2, __buf);
    }
LAB_0005d070:
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0005d2e4(int param_1, undefined1 *param_2)

{
    byte bVar1;
    bool bVar2;
    undefined4 uVar3;
    size_t sVar4;
    ushort **ppuVar5;
    uint uVar6;
    char *pcVar7;
    undefined1 *puVar8;
    undefined1 *puVar9;
    int iVar10;
    uint uVar11;
    uint uVar12;
    char local_80[4];
    undefined1 auStack_7c[80];
    int local_2c;
    undefined1 auStack_28[4];

    local_2c = __stack_chk_guard;
    FUN_0005b63c(param_1, 1, "Refclock: Telephone JJY");
    *param_2 = 100;
    param_2[0xc0] = 1;
    param_2[0x194] = 1;
    *(undefined **)(param_2 + 0xbc) = &DAT_000c7f54;
    *(undefined4 *)(param_2 + 4) = 0xb;
    *(undefined2 *)(param_2 + 8) = 0x20;
    *(undefined2 *)(param_2 + 500) = 0;
    *(undefined2 *)(param_2 + 0x1f6) = 0;
    uVar3 = sys_phone._0_4_;
    if (sys_phone._0_4_ == 0) {
        FUN_00075d40(3, "refclock_jjy.c : jjy_start_telephone : phone in the "
                        "ntpd.conf must be specified.");
        param_2[10] = 1;
        uVar3 = 1;
    } else if (sys_phone._4_4_ == 0) {
        sVar4 = strlen((char *)sys_phone._0_4_);
        iVar10 = 0;
        bVar2 = false;
        uVar11 = 0;
        puVar9 = (undefined1 *)0x0;
        for (uVar12 = uVar11; uVar12 < sVar4; uVar12 = uVar12 + 1) {
            ppuVar5 = __ctype_b_loc();
            uVar6 = (uint) * (byte *)(uVar3 + uVar12);
            puVar8 = (undefined1 *)((*ppuVar5)[uVar6] & 0x800);
            if (((*ppuVar5)[uVar6] & 0x800) == 0) {
                if (uVar6 == 0x2c) {
                    if (bVar2) {
                        FUN_00075d40(
                            3, "refclock_jjy.c : jjy_start_telephone : phone "
                               "in the ntpd.conf should be zero or one comma.");
                        param_2[10] = 1;
                        uVar3 = 1;
                        goto LAB_0005d39c;
                    }
                    bVar2 = true;
                    uVar11 = uVar12;
                } else {
                    puVar8 = puVar9;
                    if (uVar6 != 0x2d) {
                        pcVar7 =
                            "refclock_jjy.c : jjy_start_telephone : phone in "
                            "the ntpd.conf should be a number or a hyphen.";
                        goto LAB_0005d444;
                    }
                }
            } else {
                if (puVar9 < (undefined1 *)0x3) {
                    puVar8 = auStack_28;
                }
                iVar10 = iVar10 + 1;
                if (puVar9 < (undefined1 *)0x3) {
                    (puVar8 + (int)puVar9)[-0x58] = *(byte *)(uVar3 + uVar12);
                    puVar9 = puVar9 + 1;
                }
                puVar8 = puVar9;
                sVar4 = strlen((char *)uVar3);
            }
            puVar9 = puVar8;
        }
        local_80[(int)puVar9] = '\0';
        if ((bVar2) && ((uVar11 != 1 || (*(char *)uVar3 != '0')))) {
            pcVar7 = "refclock_jjy.c : jjy_start_telephone : Getting an "
                     "outside line should be \'0,\'.";
        LAB_0005d444:
            FUN_00075d40(3, pcVar7);
            uVar3 = 1;
            param_2[10] = 1;
        } else {
            if ((iVar10 - uVar11) - 6 < 5) {
                pcVar7 = local_80 + uVar11;
                iVar10 = strncmp(pcVar7, "00", 2);
                if (((((iVar10 != 0) &&
                       (iVar10 = strncmp(pcVar7, "10", 2), iVar10 != 0)) &&
                      (iVar10 = strncmp(pcVar7, "11", 2), iVar10 != 0)) &&
                     ((iVar10 = strncmp(pcVar7, "12", 2),
                       iVar10 != 0 && (iVar10 = strncmp(pcVar7, "171", 3),
                                       iVar10 != 0)))) &&
                    ((iVar10 = strncmp(pcVar7, "177", 3),
                      iVar10 != 0 &&
                          ((local_80[0] != '0' || (local_80[2] != '0')))))) {
                    FUN_0007d00c(auStack_7c, 0x50, "phone=%s", uVar3);
                    FUN_0005b63c(param_1, 1, auStack_7c);
                    bVar1 = *(byte *)(param_1 + 0x41);
                    if (bVar1 < 8) {
                        *(undefined1 *)(param_1 + 0x41) = 8;
                        if (*(byte *)(param_1 + 0x5e) < 8) {
                            *(undefined1 *)(param_1 + 0x5e) = 8;
                        }
                        if (*(byte *)(param_1 + 0x42) < 8) {
                            *(undefined1 *)(param_1 + 0x42) = 8;
                        }
                        FUN_0007d00c(auStack_7c, 0x50, "minpoll=%d -> %d",
                                     bVar1, 8);
                        FUN_0005b63c(param_1, 1, auStack_7c);
                        uVar3 = 0;
                    } else {
                        uVar3 = 0;
                    }
                    goto LAB_0005d39c;
                }
                pcVar7 = "refclock_jjy.c : jjy_start_telephone : phone=%s : "
                         "First 2 or 3 digits are not allowed.";
            } else {
                pcVar7 = "refclock_jjy.c : jjy_start_telephone : phone=%s : "
                         "Number of digits should be 6 to 10.";
            }
            FUN_00075d40(3, pcVar7, uVar3);
            uVar3 = 1;
            param_2[10] = 1;
        }
    } else {
        FUN_00075d40(3, "refclock_jjy.c : jjy_start_telephone : phone in the "
                        "ntpd.conf should be only one.");
        uVar3 = 1;
        param_2[10] = 1;
    }
LAB_0005d39c:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar3);
    }
    return;
}

void FUN_0005db18(int param_1)

{
    byte bVar1;
    ushort uVar2;
    int iVar3;
    ushort **ppuVar4;
    tm *ptVar5;
    size_t sVar6;
    uint uVar7;
    ssize_t sVar8;
    char *__s2;
    int iVar9;
    short sVar10;
    int iVar11;
    char *pcVar12;
    int iVar13;
    byte *pbVar14;
    char *pcVar15;
    int iVar16;
    char cVar17;
    short sVar18;
    short sVar19;
    undefined4 *puVar20;
    undefined1 *puVar21;
    byte *pbVar22;
    int iVar23;
    byte *pbVar24;
    uint uVar25;
    int iVar26;
    undefined4 *puVar27;
    size_t sVar28;
    int iVar29;
    int *piVar30;
    int *piVar31;
    void *pvVar32;
    int iVar33;
    int iVar34;
    int *__s1;
    undefined4 *puVar35;
    byte *pbVar36;
    int iVar37;
    bool bVar38;
    int local_144;
    int local_140;
    undefined4 local_13c;
    undefined4 uStack_138;
    char local_134;
    char local_133;
    undefined1 local_132;
    undefined1 auStack_130[60];
    undefined1 auStack_f4[100];
    undefined1 auStack_90[100];
    int local_2c;

    iVar11 = *(int *)(param_1 + 4);
    puVar35 = *(undefined4 **)(iVar11 + 0x54);
    pbVar24 = (byte *)*puVar35;
    local_2c = __stack_chk_guard;
    pbVar14 = (byte *)(puVar35 + 0xe);
    if (*(short *)(pbVar24 + 8) == 0x20) {
        iVar3 = FUN_0004a784(param_1, pbVar14, 0x7f, &local_13c);
        iVar29 = *(int *)(pbVar24 + 0xb8);
        puVar35[0x2e] = iVar3;
        if ((0 < iVar3) && (iVar29 < 0x62)) {
            pbVar22 = (byte *)((int)puVar35 + 0x37);
            iVar26 = 0;
            iVar3 = iVar29;
            do {
                pbVar22 = pbVar22 + 1;
                iVar26 = iVar26 + 1;
                iVar29 = iVar3 + 1;
                pbVar24[iVar3 + 0x54] = *pbVar22;
                iVar3 = puVar35[0x2e];
                *(int *)(pbVar24 + 0xb8) = iVar29;
                if (iVar3 <= iVar26)
                    break;
                iVar3 = iVar29;
            } while (iVar29 != 0x62);
        }
        pbVar24[iVar29 + 0x54] = 0;
        iVar3 = puVar35[0x2e];
    } else {
        iVar3 = FUN_0004a6d4(param_1, pbVar14, 0x80, &local_13c);
        puVar35[0x2e] = iVar3;
    }
    if (iVar3 != 0) {
        if (*(ushort *)(pbVar24 + 0xc) == 0 ||
            *(ushort *)(pbVar24 + 0xc) - 3 < 2) {
            pbVar24[0xb8] = 0;
            pbVar24[0xb9] = 0;
            pbVar24[0xba] = 0;
            pbVar24[0xbb] = 0;
        } else {
            iVar29 = *(int *)(pbVar24 + 0xb8);
            sVar18 = *(short *)(pbVar24 + 8);
            puVar35[0x3a] = local_13c;
            puVar35[0x3b] = uStack_138;
            iVar29 = iVar29 + -1;
            pcVar12 = "# Invalid length : length=%d";
            pbVar24[0xc] = 2;
            pbVar24[0xd] = 0;
            *(int *)(pbVar24 + 0x14) = *(int *)(pbVar24 + 0x14) + 1;
            pbVar24[0xe] = 1;
            iVar3 = 0;
            do {
                if (sVar18 == 0x20) {
                    sVar10 = 0x20;
                    if (pbVar24[0xc0] == 0) {
                        iVar29 = *(int *)(pbVar24 + 0xb8);
                    LAB_0005dfb8:
                        iVar29 = iVar29 + -1;
                        iVar26 = 0;
                        pbVar24[400] = 0;
                        pbVar24[0x191] = 0;
                        pbVar24[0x192] = 0;
                        pbVar24[0x193] = 0;
                        pbVar24[0x128] = 0;
                        pbVar24[0x129] = 0;
                        pbVar24[0x12a] = 0;
                        pbVar24[299] = 0;
                        if (iVar3 <= iVar29)
                            goto LAB_0005dfcc;
                        uVar25 = 0;
                        bVar38 = true;
                    } else {
                        iVar26 = *(int *)(pbVar24 + 0xb8);
                        if (iVar3 < iVar26) {
                            puVar20 = *(undefined4 **)(pbVar24 + 0xbc);
                            pcVar15 = (char *)*puVar20;
                            iVar34 = iVar3;
                            do {
                                if (pcVar15 != (char *)0x0) {
                                    __s2 = pcVar15;
                                    puVar27 = puVar20;
                                    do {
                                        iVar29 = puVar27[1] + iVar34;
                                        if ((iVar29 <= iVar26) &&
                                            (iVar13 = strncmp((char *)(pbVar24 +
                                                                       iVar34 +
                                                                       0x54),
                                                              __s2, puVar27[1]),
                                             iVar13 == 0)) {
                                            if (iVar29 != 0)
                                                goto LAB_0005dfb8;
                                            goto LAB_0005df8c;
                                        }
                                        puVar27 = puVar27 + 2;
                                        __s2 = (char *)*puVar27;
                                    } while (__s2 != (char *)0x0);
                                }
                                iVar34 = iVar34 + 1;
                            } while (iVar34 != iVar26);
                        }
                    LAB_0005df8c:
                        if (iVar26 < 0x62)
                            break;
                        if (0 < iVar3)
                            goto LAB_0005e340;
                        iVar29 = iVar26 + -1;
                        pbVar24[400] = 0;
                        pbVar24[0x191] = 0;
                        pbVar24[0x192] = 0;
                        pbVar24[0x193] = 0;
                        pbVar24[0x128] = 0;
                        pbVar24[0x129] = 0;
                        pbVar24[0x12a] = 0;
                        pbVar24[299] = 0;
                    LAB_0005dfcc:
                        ppuVar4 = __ctype_b_loc();
                        pbVar22 = pbVar24 + iVar3 + 0x53;
                        pbVar36 = pbVar24 + 0xc0;
                        iVar26 = 0;
                        do {
                            pbVar22 = pbVar22 + 1;
                            bVar1 = *pbVar22;
                            pbVar36 = pbVar36 + 1;
                            *pbVar36 = bVar1;
                            if (((*ppuVar4)[bVar1] & 2) == 0) {
                                pbVar24[iVar26 + 300] = bVar1;
                                *(int *)(pbVar24 + 400) = iVar26 + 1;
                                iVar26 = iVar26 + 1;
                            }
                        } while (pbVar22 != pbVar24 + iVar29 + 0x54);
                        uVar25 = (iVar29 - iVar3) + 1;
                        *(uint *)(pbVar24 + 0x128) = uVar25;
                        bVar38 = iVar26 == 0;
                    }
                    if (pbVar24[0x194] == 0) {
                        bVar38 = false;
                    }
                    pbVar24[uVar25 + 0xc1] = 0;
                    pbVar24[iVar26 + 300] = 0;
                    if (!bVar38) {
                        pbVar22 = pbVar24 + 0xc1;
                        goto LAB_0005dd2c;
                    }
                    iVar26 = iVar29 + 1;
                    if (iVar26 < *(int *)(pbVar24 + 0xb8)) {
                        sVar19 = 2;
                        goto LAB_0005dd10;
                    }
                    break;
                }
                uVar25 = puVar35[0x2e];
                pbVar22 = pbVar14;
            LAB_0005dd2c:
                if (0x62 < uVar25) {
                    uVar25 = 99;
                }
                __memcpy_chk(auStack_f4, pbVar22, uVar25, 100);
                auStack_f4[uVar25] = 0;
                FUN_0005b63c(iVar11, 3, auStack_f4);
                bVar1 = *pbVar24;
                if (bVar1 == 4) {
                    iVar34 = *(int *)(param_1 + 4);
                    piVar30 = *(int **)(iVar34 + 0x54);
                    iVar26 = *piVar30;
                    if (*(short *)(iVar26 + 8) == 0x20) {
                        piVar31 = (int *)(iVar26 + 300);
                        puVar21 = *(undefined1 **)(iVar26 + 400);
                    } else {
                        piVar31 = piVar30 + 0xe;
                        puVar21 = (undefined1 *)piVar30[0x2e];
                    }
                    if (*(short *)(iVar26 + 0xc) != 2)
                        goto LAB_0005e118;
                    pcVar15 = "# Invalid length : length=%d";
                    if (puVar21 != (undefined1 *)0x17)
                        goto switchD_0005e2b4_default;
                    iVar13 = sscanf(
                        (char *)piVar31, "%c%2s %2d/%2d/%2d %1d %2d:%2d:%2d",
                        &local_144, &local_134, iVar26 + 0x18, iVar26 + 0x1c,
                        iVar26 + 0x20, &local_140, iVar26 + 0x24, iVar26 + 0x28,
                        iVar26 + 0x2c);
                    local_132 = 0;
                    if ((iVar13 == 9) && ((char)local_144 == '\'')) {
                        if (local_134 == 'O') {
                            if (local_133 == 'K')
                                goto LAB_0005ee40;
                            goto LAB_0005eccc;
                        }
                        if (local_134 == 'N') {
                            if (local_133 != 'G')
                                goto LAB_0005eccc;
                        } else if ((local_134 != 'E') || (local_133 != 'R'))
                            goto LAB_0005eccc;
                    LAB_0005ee40:
                        iVar9 = *(int *)(iVar26 + 0x1c);
                        iVar16 = *(int *)(iVar26 + 0x20);
                        if ((0xb < iVar9 - 1U) || (0x1e < iVar16 - 1U))
                            goto LAB_0005ecd4;
                        iVar37 = *(int *)(iVar26 + 0x24);
                        if (6 < local_140)
                            goto LAB_0005ecd8;
                        iVar33 = *(int *)(iVar26 + 0x28);
                        if (0x17 < iVar37)
                            goto LAB_0005ecdc;
                        iVar23 = *(int *)(iVar26 + 0x2c);
                        if ((iVar33 < 0x3c) && (iVar23 < 0x3d)) {
                            if (local_134 == 'N') {
                                if (local_133 != 'G') {
                                LAB_0005f210:
                                    *(undefined4 *)(iVar26 + 0x30) = 0;
                                    *(int *)(iVar26 + 0x18) =
                                        *(int *)(iVar26 + 0x18) + 2000;
                                    FUN_0005c15c(iVar34, piVar30, iVar26);
                                    goto LAB_0005e118;
                                }
                            } else if ((local_134 != 'E') || (local_133 != 'R'))
                                goto LAB_0005f210;
                            FUN_0007d00c(auStack_130, 0xf, "status=%s",
                                         &local_134);
                            FUN_0007d00c(auStack_90, 99,
                                         "* Unsure timestamp : %s",
                                         auStack_130);
                            FUN_0005b63c(iVar34, 6, auStack_90);
                            goto LAB_0005e118;
                        }
                    } else {
                    LAB_0005eccc:
                        iVar9 = *(int *)(iVar26 + 0x1c);
                        iVar16 = *(int *)(iVar26 + 0x20);
                    LAB_0005ecd4:
                        iVar37 = *(int *)(iVar26 + 0x24);
                    LAB_0005ecd8:
                        iVar33 = *(int *)(iVar26 + 0x28);
                    LAB_0005ecdc:
                        iVar23 = *(int *)(iVar26 + 0x2c);
                    }
                    FUN_0007d00c(auStack_90, 99,
                                 "# Invalid time : rc=%d year=%d month=%d "
                                 "day=%d hour=%d minute=%d second=%d",
                                 iVar13, *(undefined4 *)(iVar26 + 0x18), iVar9,
                                 iVar16, iVar37, iVar33, iVar23);
                    goto LAB_0005e234;
                }
                if (bVar1 < 5) {
                    if (bVar1 != 2) {
                        if (2 < bVar1) {
                            iVar34 = *(int *)(param_1 + 4);
                            piVar30 = *(int **)(iVar34 + 0x54);
                            iVar26 = *piVar30;
                            sVar18 = *(short *)(iVar26 + 2);
                            if (*(short *)(iVar26 + 8) == 0x20) {
                                piVar31 = (int *)(iVar26 + 300);
                                puVar21 = *(undefined1 **)(iVar26 + 400);
                            } else {
                                piVar31 = piVar30 + 0xe;
                                puVar21 = (undefined1 *)piVar30[0x2e];
                            }
                            if (sVar18 == 1) {
                                if (puVar21 != (undefined1 *)0xf) {
                                LAB_0005e21c:
                                    pcVar15 = "# Invalid length : length=%d";
                                    goto switchD_0005e2b4_default;
                                }
                                pbVar22 = (byte *)((int)piVar31 + -1);
                                uVar25 = 0;
                                do {
                                    pbVar22 = pbVar22 + 1;
                                    uVar25 = uVar25 ^ *pbVar22;
                                } while (pbVar22 != (byte *)(piVar31 + 3));
                                uVar7 = (int)uVar25 >> 4 | 0x30;
                                uVar25 = uVar25 & 0xf | 0x30;
                                if ((uVar7 != *(byte *)((int)piVar31 + 0xd)) ||
                                    (uVar25 != *(byte *)((int)piVar31 + 0xe))) {
                                    puVar21 = auStack_130;
                                    FUN_0007d00c(
                                        puVar21, 0x3b,
                                        " BCC error : Recv=%02X,%02X / "
                                        "Calc=%02X,%02X ",
                                        (uint) * (byte *)((int)piVar31 + 0xd),
                                        (uint) * (byte *)((int)piVar31 + 0xe),
                                        uVar7, uVar25);
                                    pcVar15 = "# Invalid reply : [%s]";
                                    goto switchD_0005e2b4_default;
                                }
                            } else {
                                if ((sVar18 != 2) && (sVar18 != 3))
                                    goto LAB_0005e118;
                                if (puVar21 != (undefined1 *)0x11)
                                    goto LAB_0005e21c;
                            }
                            iVar13 = sscanf(
                                (char *)piVar31, "%2d%2d%2d%*1d%2d%2d%2d",
                                iVar26 + 0x18, iVar26 + 0x1c, iVar26 + 0x20,
                                iVar26 + 0x24, iVar26 + 0x28, iVar26 + 0x2c);
                            if (iVar13 == 6) {
                                uVar25 = *(int *)(iVar26 + 0x1c) - 1;
                                iVar9 = *(int *)(iVar26 + 0x20);
                                if (uVar25 < 0xc) {
                                    uVar7 = iVar9 - 1;
                                    iVar33 = *(int *)(iVar26 + 0x24);
                                    iVar16 = *(int *)(iVar26 + 0x28);
                                    iVar37 = *(int *)(iVar26 + 0x2c);
                                    if ((((uVar7 < 0x1f) && (iVar33 < 0x18)) &&
                                         (iVar16 < 0x3c)) &&
                                        (iVar37 < 0x3d)) {
                                        iVar13 = *(int *)(iVar26 + 0x18);
                                        *(int *)(iVar26 + 0x18) = iVar13 + 2000;
                                        if (*(ushort *)(iVar26 + 2) - 2 < 2) {
                                            *(int *)(iVar26 + 0x2c) =
                                                iVar37 + -1;
                                            *(undefined4 *)(iVar26 + 0x30) =
                                                500;
                                            if (iVar37 + -1 < 0) {
                                                *(int *)(iVar26 + 0x28) =
                                                    iVar16 + -1;
                                                *(undefined4 *)(iVar26 + 0x2c) =
                                                    0x3b;
                                                if (iVar16 + -1 < 0) {
                                                    *(undefined4 *)(iVar26 +
                                                                    0x28) =
                                                        0x3b;
                                                    *(int *)(iVar26 + 0x24) =
                                                        iVar33 + -1;
                                                    if (iVar33 + -1 < 0) {
                                                        *(uint *)(iVar26 +
                                                                  0x20) = uVar7;
                                                        *(undefined4 *)(iVar26 +
                                                                        0x24) =
                                                            0x17;
                                                        if ((uVar7 == 0) &&
                                                            (*(uint *)(iVar26 +
                                                                       0x1c) =
                                                                 uVar25,
                                                             uVar25 == 0)) {
                                                            *(undefined4
                                                                  *)(iVar26 +
                                                                     0x1c) =
                                                                0xc;
                                                            *(int *)(iVar26 +
                                                                     0x18) =
                                                                iVar13 + 1999;
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                        FUN_0005c15c(iVar34, piVar30, iVar26);
                                        if (*(short *)(iVar26 + 2) == 3) {
                                            sVar8 = write(piVar30[7],
                                                          &DAT_000a9b10, 1);
                                            if (sVar8 != 1) {
                                                FUN_00049c88(iVar34, 3);
                                            }
                                            FUN_0005b63c(iVar34, 2,
                                                         &DAT_000a9b10);
                                        }
                                        goto LAB_0005e118;
                                    }
                                } else {
                                    iVar33 = *(int *)(iVar26 + 0x24);
                                    iVar16 = *(int *)(iVar26 + 0x28);
                                    iVar37 = *(int *)(iVar26 + 0x2c);
                                }
                            } else {
                                iVar9 = *(int *)(iVar26 + 0x20);
                                iVar33 = *(int *)(iVar26 + 0x24);
                                iVar16 = *(int *)(iVar26 + 0x28);
                                iVar37 = *(int *)(iVar26 + 0x2c);
                            }
                            FUN_0007d00c(
                                auStack_90, 99,
                                "# Invalid time : rc=%d year=%d month=%d "
                                "day=%d hour=%d minute=%d second=%d",
                                iVar13, *(undefined4 *)(iVar26 + 0x18),
                                *(int *)(iVar26 + 0x1c), iVar9, iVar33, iVar16,
                                iVar37);
                            goto LAB_0005e234;
                        }
                        if (bVar1 != 1)
                            goto LAB_0005dce8;
                        iVar34 = *(int *)(param_1 + 4);
                        piVar30 = *(int **)(iVar34 + 0x54);
                        iVar26 = *piVar30;
                        sVar18 = *(short *)(iVar26 + 0x10);
                        bVar38 = *(short *)(iVar26 + 8) == 0x20;
                        if (bVar38) {
                            piVar31 = (int *)(iVar26 + 300);
                        } else {
                            piVar31 = piVar30 + 0xe;
                        }
                        iVar13 = sVar18 * 0x14;
                        if (bVar38) {
                            __s1 = *(int **)(iVar26 + 400);
                        } else {
                            __s1 = (int *)piVar30[0x2e];
                        }
                        if (*(int *)(&DAT_000c5a1c + iVar13) == 0) {
                            pcVar15 = "# Unexpected reply : [%s]";
                            __s1 = piVar31;
                            goto LAB_0005dcc0;
                        }
                        if ((*(int **)(&DAT_000c5a24 + iVar13) != __s1) &&
                            (__s1 != *(int **)(&DAT_000c5a28 + iVar13))) {
                            pcVar15 = "# Invalid length : length=%d";
                            goto LAB_0005dcc0;
                        }
                        switch ((&DAT_000c5a18)[sVar18 * 0x14]) {
                        case 1:
                            iVar13 = sscanf((char *)piVar31, "%4d/%2d/%2d",
                                            iVar26 + 0x18, iVar26 + 0x1c,
                                            iVar26 + 0x20);
                            if (iVar13 == 3) {
                                iVar9 = *(int *)(iVar26 + 0x1c);
                                if (0x62 < *(int *)(iVar26 + 0x18) - 2000U) {
                                    iVar16 = *(int *)(iVar26 + 0x20);
                                    goto LAB_0005e684;
                                }
                                iVar16 = *(int *)(iVar26 + 0x20);
                                if ((0xb < iVar9 - 1U) || (0x1e < iVar16 - 1U))
                                    goto LAB_0005e684;
                                iVar13 = *(int *)(iVar26 + 0x38);
                                goto LAB_0005f258;
                            }
                            iVar9 = *(int *)(iVar26 + 0x1c);
                            iVar16 = *(int *)(iVar26 + 0x20);
                        LAB_0005e684:
                            FUN_0007d00c(auStack_90, 99,
                                         "# Invalid date : rc=%d year=%d "
                                         "month=%d day=%d",
                                         iVar13, *(int *)(iVar26 + 0x18), iVar9,
                                         iVar16);
                            goto LAB_0005dcd0;
                        case 2:
                            goto LAB_0005e634;
                        case 3:
                        LAB_0005e634:
                            __s1 = *(int **)(iVar26 + 0x38);
                            if (1 < (int)__s1) {
                                pcVar15 = "# Too many reply : count=%d";
                                break;
                            }
                            iVar13 = sscanf((char *)piVar31, "%2d:%2d:%2d",
                                            iVar26 + 0x24, iVar26 + 0x28,
                                            iVar26 + 0x2c);
                            iVar37 = *(int *)(iVar26 + 0x24);
                            iVar9 = *(int *)(iVar26 + 0x28);
                            iVar16 = *(int *)(iVar26 + 0x2c);
                            if ((((iVar13 != 3) || (0x17 < iVar37)) ||
                                 (0x3b < iVar9)) ||
                                (0x3c < iVar16)) {
                                FUN_0007d00c(auStack_90, 99,
                                             "# Invalid time : rc=%d hour=%d "
                                             "minute=%d second=%d",
                                             iVar13, iVar37, iVar9, iVar16);
                                goto LAB_0005dcd0;
                            }
                            iVar13 = *(int *)(iVar26 + 0x38) + 1;
                            *(int *)(iVar26 + *(int *)(iVar26 + 0x38) * 4 +
                                     0x3c) =
                                iVar16 + (iVar9 + iVar37 * 0x3c) * 0x3c;
                            *(int *)(iVar26 + 0x38) = iVar13;
                            *(undefined4 *)(iVar26 + 0x30) = 0;
                        LAB_0005f258:
                            if (iVar13 == 2) {
                            LAB_0005eacc:
                                iVar13 = *(int *)(iVar26 + 0x40);
                                iVar9 = *(int *)(iVar26 + 0x3c);
                                if (iVar13 < iVar9 || iVar9 < iVar13 + -2) {
                                    if (iVar9 <= iVar13) {
                                        FUN_0007d00c(
                                            auStack_90, 99,
                                            "# Slow reply : timestamp=%d, %d",
                                            iVar9, iVar13);
                                        goto LAB_0005dcd0;
                                    }
                                LAB_0005f294:
                                    FUN_0007d00c(
                                        auStack_90, 99,
                                        "* Over midnight : timestamp=%d, %d",
                                        iVar9, iVar13);
                                    FUN_0005b63c(iVar34, 4, auStack_90);
                                } else {
                                LAB_0005f308:
                                    FUN_0005c15c(iVar34, piVar30, iVar26);
                                }
                            LAB_0005e118:
                                pbVar24[0xc] = 3;
                                pbVar24[0xd] = 0;
                            } else {
                                sVar18 = *(short *)(iVar26 + 0x10);
                                if (*(int *)(&DAT_000c5a1c + sVar18 * 0x14) ==
                                    0)
                                    goto LAB_0005e118;
                            LAB_0005e5c8:
                                *(short *)(iVar26 + 0x10) = sVar18 + 1;
                                iVar26 = (short)(sVar18 + 1) * 0x14;
                                pvVar32 = *(void **)(&DAT_000c5a1c + iVar26);
                                if (pvVar32 == (void *)0x0)
                                    goto LAB_0005e118;
                                sVar28 = *(size_t *)(&DAT_000c5a20 + iVar26);
                                sVar6 = write(piVar30[7], pvVar32, sVar28);
                                if (sVar28 != sVar6) {
                                    FUN_00049c88(iVar34, 3);
                                }
                                FUN_0005b63c(iVar34, 2, pvVar32);
                            }
                            goto LAB_0005dcf0;
                        case 4:
                            iVar13 = strncmp((char *)piVar31, "adjusted", 8);
                            if ((iVar13 != 0) &&
                                (iVar13 =
                                     strncmp((char *)piVar31, "unadjusted", 10),
                                 iVar13 != 0)) {
                                pcVar15 = "# Invalid reply : [%s]";
                                __s1 = piVar31;
                                break;
                            }
                        LAB_0005e5bc:
                            if (*(int *)(iVar26 + 0x38) == 2)
                                goto LAB_0005eacc;
                            goto LAB_0005e5c8;
                        case 5:
                            iVar13 = strncmp((char *)piVar31, "valid", 5);
                            if ((iVar13 == 0) ||
                                (iVar13 =
                                     strncmp((char *)piVar31, "invalid", 7),
                                 iVar13 == 0))
                                goto LAB_0005e5bc;
                            pcVar15 = "# Invalid reply : [%s]";
                            __s1 = piVar31;
                            break;
                        default:
                            pcVar15 = "# Invalid reply : [%s]";
                            __s1 = piVar31;
                        }
                    LAB_0005dcc0:
                        FUN_0007d00c(auStack_90, 99, pcVar15, __s1);
                    LAB_0005dcd0:
                        FUN_0005b63c(iVar34, 7, auStack_90);
                        *(undefined1 *)(iVar26 + 0xf) = 1;
                        goto LAB_0005dce8;
                    }
                    iVar34 = *(int *)(param_1 + 4);
                    piVar30 = *(int **)(iVar34 + 0x54);
                    iVar26 = *piVar30;
                    if (*(short *)(iVar26 + 8) == 0x20) {
                        piVar31 = (int *)(iVar26 + 300);
                        iVar13 = *(int *)(iVar26 + 400);
                    } else {
                        piVar31 = piVar30 + 0xe;
                        iVar13 = piVar30[0x2e];
                    }
                    if (*(short *)(iVar26 + 0x10) != 1) {
                        FUN_0007d00c(auStack_90, 99,
                                     "# Unexpected reply : [%s]");
                    LAB_0005e0c8:
                        FUN_0005b63c(iVar34, 7, auStack_90);
                        *(undefined1 *)(iVar26 + 0xf) = 1;
                        goto LAB_0005dce8;
                    }
                    if ((0x10 < *(int *)(iVar26 + 0x128)) &&
                        (*(char *)(iVar26 + *(int *)(iVar26 + 0x128) + 0xc0) ==
                         '\x03')) {
                        if (iVar13 != 0xf) {
                            FUN_0007d00c(auStack_90, 99,
                                         "# Invalid length : length=%d",
                                         iVar13);
                            FUN_0005b63c(iVar34, 7, auStack_90);
                            *(undefined1 *)(iVar26 + 0xf) = 1;
                            goto LAB_0005dce8;
                        }
                        iVar13 =
                            sscanf((char *)piVar31,
                                   "J%2d%2d%2d%*1d%2d%2d%2d%1d", iVar26 + 0x18,
                                   iVar26 + 0x1c, iVar26 + 0x20, iVar26 + 0x24,
                                   iVar26 + 0x28, iVar26 + 0x2c, iVar26 + 0x30);
                        if (iVar13 == 7) {
                            iVar9 = *(int *)(iVar26 + 0x20);
                            if (*(int *)(iVar26 + 0x1c) - 1U < 0xc) {
                                iVar33 = *(int *)(iVar26 + 0x24);
                                iVar16 = *(int *)(iVar26 + 0x28);
                                iVar37 = *(int *)(iVar26 + 0x2c);
                                if ((((iVar9 - 1U < 0x1f) && (iVar33 < 0x18)) &&
                                     (iVar16 < 0x3c)) &&
                                    (iVar37 < 0x3d)) {
                                    *(int *)(iVar26 + 0x18) =
                                        *(int *)(iVar26 + 0x18) + 2000;
                                    *(int *)(iVar26 + 0x30) =
                                        *(int *)(iVar26 + 0x30) * 100;
                                    FUN_0005c15c(iVar34, piVar30, iVar26);
                                    goto LAB_0005e118;
                                }
                            } else {
                                iVar33 = *(int *)(iVar26 + 0x24);
                                iVar16 = *(int *)(iVar26 + 0x28);
                                iVar37 = *(int *)(iVar26 + 0x2c);
                            }
                        } else {
                            iVar9 = *(int *)(iVar26 + 0x20);
                            iVar33 = *(int *)(iVar26 + 0x24);
                            iVar16 = *(int *)(iVar26 + 0x28);
                            iVar37 = *(int *)(iVar26 + 0x2c);
                        }
                        FUN_0007d00c(auStack_90, 99,
                                     "# Invalid time : rc=%d year=%d month=%d "
                                     "day=%d hour=%d minute=%d second=%d",
                                     iVar13, *(undefined4 *)(iVar26 + 0x18),
                                     *(int *)(iVar26 + 0x1c), iVar9, iVar33,
                                     iVar16, iVar37);
                        goto LAB_0005e0c8;
                    }
                    sVar18 = *(short *)(pbVar24 + 8);
                    sVar10 = sVar18;
                    if (sVar18 != 0x20)
                        goto LAB_0005dd00;
                    break;
                }
                if (bVar1 != 6) {
                    if (bVar1 < 6) {
                        iVar34 = *(int *)(param_1 + 4);
                        piVar30 = *(int **)(iVar34 + 0x54);
                        iVar26 = *piVar30;
                        if (*(short *)(iVar26 + 8) == 0x20) {
                            __s1 = (int *)(iVar26 + 300);
                            piVar31 = *(int **)(iVar26 + 400);
                        } else {
                            __s1 = piVar30 + 0xe;
                            piVar31 = (int *)piVar30[0x2e];
                        }
                        if ((int)piVar31 < 6) {
                            if ((piVar31 == (int *)0x5) &&
                                (iVar13 = strncmp((char *)__s1, "$Cmd>", 5),
                                 iVar13 == 0))
                                goto LAB_0005dcf0;
                        LAB_0005e374:
                            sVar18 = *(short *)(iVar26 + 0x10);
                            iVar13 = sVar18 * 0x10;
                            if (*(int *)(&DAT_000c5aa8 + iVar13) == 0) {
                                pcVar15 = "# Unexpected reply : [%s]";
                                goto LAB_0005dcc0;
                            }
                            if (piVar31 != *(int **)(&DAT_000c5ab0 + iVar13)) {
                                pcVar15 = "# Invalid length : length=%d";
                                __s1 = piVar31;
                                goto LAB_0005dcc0;
                            }
                            cVar17 = (&DAT_000c5aa4)[iVar13];
                            if (cVar17 != '\x02') {
                                if (cVar17 == '\x04') {
                                    iVar13 = strncmp((char *)__s1, "*R", 2);
                                    if (((iVar13 == 0) ||
                                         (iVar13 =
                                              strncmp((char *)__s1, "*G", 2),
                                          iVar13 == 0)) ||
                                        ((iVar13 =
                                              strncmp((char *)__s1, "*U", 2),
                                          iVar13 == 0 ||
                                              (iVar13 = strncmp((char *)__s1,
                                                                "+U", 2),
                                               iVar13 == 0)))) {
                                        if (*(int *)(iVar26 + 0x38) == 2)
                                            goto LAB_0005f5a8;
                                    LAB_0005f0cc:
                                        *(short *)(iVar26 + 0x10) = sVar18 + 1;
                                        iVar13 = (short)(sVar18 + 1) * 0x10;
                                        pvVar32 =
                                            *(void **)(&DAT_000c5aa8 + iVar13);
                                        if (pvVar32 == (void *)0x0) {
                                            *(undefined2 *)(iVar26 + 0xc) = 3;
                                            goto LAB_0005e118;
                                        }
                                        sVar28 =
                                            *(size_t *)(&DAT_000c5aac + iVar13);
                                        sVar6 =
                                            write(piVar30[7], pvVar32, sVar28);
                                        if (sVar28 != sVar6) {
                                            FUN_00049c88(iVar34, 3);
                                        }
                                        FUN_0005b63c(iVar34, 2, pvVar32);
                                        goto LAB_0005dcf0;
                                    }
                                    pcVar15 = "# Invalid reply : [%s]";
                                } else {
                                    if (cVar17 == '\x01') {
                                        iVar13 =
                                            sscanf((char *)__s1, "%4d/%2d/%2d",
                                                   iVar26 + 0x18, iVar26 + 0x1c,
                                                   iVar26 + 0x20);
                                        if (iVar13 == 3) {
                                            iVar9 = *(int *)(iVar26 + 0x1c);
                                            if (*(int *)(iVar26 + 0x18) -
                                                    2000U <
                                                99) {
                                                iVar16 =
                                                    *(int *)(iVar26 + 0x20);
                                                if ((iVar9 - 1U < 0xc) &&
                                                    (iVar16 - 1U < 0x1f)) {
                                                    iVar13 =
                                                        *(int *)(iVar26 + 0x38);
                                                    goto LAB_0005f2d8;
                                                }
                                            } else {
                                                iVar16 =
                                                    *(int *)(iVar26 + 0x20);
                                            }
                                        } else {
                                            iVar9 = *(int *)(iVar26 + 0x1c);
                                            iVar16 = *(int *)(iVar26 + 0x20);
                                        }
                                        FUN_0007d00c(auStack_90, 99,
                                                     "# Invalid date : rc=%d "
                                                     "year=%d month=%d day=%d",
                                                     iVar13,
                                                     *(int *)(iVar26 + 0x18),
                                                     iVar9, iVar16);
                                        goto LAB_0005dcd0;
                                    }
                                    pcVar15 = "# Invalid reply : [%s]";
                                }
                                goto LAB_0005dcc0;
                            }
                            if (1 < (int)*(int **)(iVar26 + 0x38)) {
                                pcVar15 = "# Too many reply : count=%d";
                                __s1 = *(int **)(iVar26 + 0x38);
                                goto LAB_0005dcc0;
                            }
                            iVar13 = sscanf((char *)__s1, "%2d:%2d:%2d",
                                            iVar26 + 0x24, iVar26 + 0x28,
                                            iVar26 + 0x2c);
                            iVar9 = *(int *)(iVar26 + 0x24);
                            iVar37 = *(int *)(iVar26 + 0x28);
                            iVar16 = *(int *)(iVar26 + 0x2c);
                            if ((((iVar13 != 3) || (0x17 < iVar9)) ||
                                 (0x3b < iVar37)) ||
                                (0x3c < iVar16)) {
                                FUN_0007d00c(auStack_90, 99,
                                             "# Invalid time : rc=%d hour=%d "
                                             "minute=%d second=%d",
                                             iVar13, iVar9, iVar37, iVar16);
                                goto LAB_0005dcd0;
                            }
                            iVar13 = *(int *)(iVar26 + 0x38) + 1;
                            *(int *)(iVar26 + *(int *)(iVar26 + 0x38) * 4 +
                                     0x3c) =
                                iVar16 + (iVar37 + iVar9 * 0x3c) * 0x3c;
                            *(int *)(iVar26 + 0x38) = iVar13;
                            *(undefined4 *)(iVar26 + 0x30) = 0;
                        LAB_0005f2d8:
                            if (iVar13 == 2) {
                            LAB_0005f5a8:
                                iVar13 = *(int *)(iVar26 + 0x40);
                                iVar9 = *(int *)(iVar26 + 0x3c);
                                if (iVar9 <= iVar13 && iVar13 + -2 <= iVar9)
                                    goto LAB_0005f308;
                                if (iVar9 <= iVar13) {
                                    FUN_0007d00c(
                                        auStack_90, 99,
                                        "# Slow reply : timestamp=%d, %d",
                                        iVar9, iVar13);
                                    goto LAB_0005dcd0;
                                }
                                goto LAB_0005f294;
                            }
                            sVar18 = *(short *)(iVar26 + 0x10);
                            if (*(int *)(&DAT_000c5aa8 + sVar18 * 0x10) != 0)
                                goto LAB_0005f0cc;
                            goto LAB_0005f308;
                        }
                        iVar13 = strncmp((char *)__s1, "$GP", 3);
                        if ((iVar13 != 0) &&
                            (iVar13 = strncmp((char *)__s1, "$PFEC", 5),
                             iVar13 != 0)) {
                            iVar13 = strncmp((char *)__s1, "$Cmd>", 5);
                            if (iVar13 == 0) {
                                piVar31 = (int *)((int)piVar31 + -5);
                                __s1 = (int *)((int)__s1 + 5);
                                if ((int)piVar31 < 6)
                                    goto LAB_0005e374;
                                iVar13 = strncmp((char *)__s1, "$GP", 3);
                                if (iVar13 == 0)
                                    goto LAB_0005dcf0;
                            }
                            iVar13 = strncmp((char *)__s1, "$PFEC", 5);
                            if (iVar13 != 0)
                                goto LAB_0005e374;
                        }
                        goto LAB_0005dcf0;
                    }
                    if (bVar1 != 100)
                        goto LAB_0005dce8;
                    iVar34 = *(int *)(param_1 + 4);
                    piVar30 = *(int **)(iVar34 + 0x54);
                    iVar26 = *piVar30;
                    uVar2 = *(ushort *)(iVar26 + 500);
                    bVar38 = 3 < uVar2;
                    if (uVar2 != 4) {
                        bVar38 = uVar2 != 0;
                    }
                    if (!bVar38 || (uVar2 == 4 || uVar2 == 1)) {
                        if (*(short *)(iVar26 + 8) == 0x20) {
                            piVar31 = (int *)(iVar26 + 300);
                            uVar25 = *(uint *)(iVar26 + 400);
                        } else {
                            piVar31 = piVar30 + 0xe;
                            uVar25 = piVar30[0x2e];
                        }
                        sVar18 = *(short *)(iVar26 + 0x200);
                        if (uVar25 == 2) {
                            iVar13 = strncmp((char *)piVar31, "OK", 2);
                            if (iVar13 == 0) {
                                *(undefined2 *)(iVar26 + 0x202) = 4;
                            } else {
                            LAB_0005e4f8:
                                *(undefined2 *)(iVar26 + 0x202) = 0xd;
                            }
                        } else if (uVar25 == 7) {
                            iVar13 = strncmp((char *)piVar31, "CONNECT", 7);
                            if (iVar13 != 0)
                                goto LAB_0005e4f8;
                            *(undefined2 *)(iVar26 + 0x202) = 5;
                        } else if (uVar25 == 4) {
                            iVar13 = strncmp((char *)piVar31, "RING", 4);
                            if (iVar13 == 0) {
                                *(undefined2 *)(iVar26 + 0x202) = 6;
                            } else {
                                iVar13 = strncmp((char *)piVar31, "BUSY", 4);
                                if (iVar13 != 0)
                                    goto LAB_0005e4f8;
                                *(undefined2 *)(iVar26 + 0x202) = 0xb;
                            }
                        } else if (uVar25 == 10) {
                            iVar13 = strncmp((char *)piVar31, "NO CARRIER", 10);
                            if (iVar13 == 0) {
                                *(undefined2 *)(iVar26 + 0x202) = 7;
                            } else {
                            LAB_0005ed18:
                                iVar13 =
                                    strncmp((char *)piVar31, "CONNECT ", 8);
                                if (iVar13 == 0) {
                                    *(undefined2 *)(iVar26 + 0x202) = 9;
                                } else {
                                    if (uVar25 != 0xb)
                                        goto LAB_0005e4d4;
                                    iVar13 = strncmp((char *)piVar31,
                                                     "NO DAILTONE", 0xb);
                                    if (iVar13 != 0)
                                        goto LAB_0005e4f8;
                                    *(undefined2 *)(iVar26 + 0x202) = 10;
                                }
                            }
                        } else if (uVar25 == 5) {
                            iVar13 = strncmp((char *)piVar31, "ERROR", 5);
                            if (iVar13 != 0)
                                goto LAB_0005e4f8;
                            *(undefined2 *)(iVar26 + 0x202) = 8;
                        } else {
                            if (7 < uVar25)
                                goto LAB_0005ed18;
                        LAB_0005e4d4:
                            if ((uVar25 != 9) ||
                                (iVar13 =
                                     strncmp((char *)piVar31, "NO ANSWER", 9),
                                 iVar13 != 0))
                                goto LAB_0005e4f8;
                            *(undefined2 *)(iVar26 + 0x202) = 0xc;
                        }
                        FUN_0005adcc(iVar34, piVar30, iVar26);
                        sVar10 = *(short *)(iVar26 + 0x200);
                        if (sVar10 != sVar18) {
                            if (sVar10 == 0) {
                                *(undefined2 *)(iVar26 + 0x1f6) = 3;
                                FUN_0005a8b8(iVar34, piVar30, iVar26);
                            } else if (sVar10 == 3) {
                                *(undefined2 *)(iVar26 + 0x1f6) = 2;
                                FUN_0005a8b8(iVar34, piVar30, iVar26);
                            }
                        }
                        goto LAB_0005dcf0;
                    }
                    if (*(short *)(iVar26 + 8) == 0x20) {
                        piVar31 = (int *)(iVar26 + 300);
                        iVar13 = *(int *)(iVar26 + 400);
                    } else {
                        piVar31 = piVar30 + 0xe;
                        iVar13 = piVar30[0x2e];
                    }
                    *(undefined2 *)(iVar26 + 0x1f0) = 0;
                    if (iVar13 == 7) {
                        iVar13 = strncmp((char *)piVar31, "Name ? ", 7);
                        if (iVar13 == 0) {
                            *(undefined2 *)(iVar26 + 0x1f6) = 5;
                        } else {
                        LAB_0005ddec:
                            cVar17 = (char)*piVar31;
                        LAB_0005ddf0:
                            if (cVar17 != '?')
                                goto LAB_0005de04;
                            *(undefined2 *)(iVar26 + 0x1f6) = 8;
                        }
                    } else if (iVar13 == 1) {
                        cVar17 = (char)*piVar31;
                        if (cVar17 != '>')
                            goto LAB_0005ddf0;
                        *(undefined2 *)(iVar26 + 0x1f6) = 6;
                    } else {
                        if (0 < iVar13)
                            goto LAB_0005ddec;
                    LAB_0005de04:
                        *(undefined2 *)(iVar26 + 0x1f6) = 7;
                    }
                    FUN_0005a8b8(iVar34, piVar30, iVar26);
                    sVar18 = *(short *)(pbVar24 + 8);
                    goto joined_r0x0005de2c;
                }
                iVar34 = *(int *)(param_1 + 4);
                piVar30 = *(int **)(iVar34 + 0x54);
                iVar26 = *piVar30;
                if (*(short *)(iVar26 + 8) == 0x20) {
                    piVar31 = (int *)(iVar26 + 300);
                    puVar21 = *(undefined1 **)(iVar26 + 400);
                } else {
                    piVar31 = piVar30 + 0xe;
                    puVar21 = (undefined1 *)piVar30[0x2e];
                }
                if (*(short *)(iVar26 + 0xc) != 2)
                    goto LAB_0005e118;
                sVar18 = *(short *)(iVar26 + 0x12);
                sVar10 = sVar18 + 1;
                *(short *)(iVar26 + 0x12) = sVar10;
                pcVar15 = pcVar12;
                switch (puVar21) {
                case (undefined1 *)0x1:
                    if ((char)*piVar31 == -0x1b) {
                        if (sVar10 == 1) {
                            *(short *)(iVar26 + 0x12) = sVar18;
                            goto LAB_0005dcf0;
                        }
                        if (sVar10 < 3) {
                        LAB_0005efec:
                            iVar9 = *(int *)(iVar26 + 0x18);
                            goto LAB_0005ef90;
                        }
                        puVar21 = (undefined1 *)(iVar26 + 0xc1);
                        pcVar15 = "# Unexpected reply : [%s]";
                    } else {
                        puVar21 = (undefined1 *)(iVar26 + 0xc1);
                        pcVar15 = "# Invalid reply : [%s]";
                    }
                    break;
                case (undefined1 *)0x2:
                    break;
                case (undefined1 *)0x3:
                    break;
                case (undefined1 *)0x4:
                    break;
                case (undefined1 *)0x5:
                    break;
                case (undefined1 *)0x6:
                    break;
                case (undefined1 *)0x7:
                    break;
                case (undefined1 *)0x8:
                    pbVar22 = (byte *)((int)piVar31 + -1);
                    do {
                        pbVar22 = pbVar22 + 1;
                        *pbVar22 = *pbVar22 & 0x7f;
                    } while (pbVar22 != (byte *)((int)piVar31 + 7));
                    iVar13 =
                        sscanf((char *)((int)piVar31 + 1), "%2d:%2d:%2d",
                               iVar26 + 0x24, iVar26 + 0x28, iVar26 + 0x2c);
                    iVar16 = *(int *)(iVar26 + 0x24);
                    iVar37 = *(int *)(iVar26 + 0x28);
                    iVar9 = *(int *)(iVar26 + 0x2c);
                    if ((((iVar13 == 3) && (iVar16 < 0x18)) &&
                         (iVar37 < 0x3c)) &&
                        (iVar9 < 0x3d)) {
                        if (0x36 < iVar9 && (iVar16 == 0x17 && iVar37 == 0x3b))
                            goto LAB_0005dcf0;
                        time(&local_140);
                        ptVar5 = localtime(&local_140);
                        iVar13 = ptVar5->tm_mday;
                        iVar9 = ptVar5->tm_year;
                        *(int *)(iVar26 + 0x1c) = ptVar5->tm_mon + 1;
                        *(int *)(iVar26 + 0x20) = iVar13;
                    LAB_0005ef90:
                        *(int *)(iVar26 + 0x18) = iVar9 + 2000;
                        *(undefined4 *)(iVar26 + 0x30) = 0;
                        FUN_0005c15c(iVar34, piVar30, iVar26);
                        goto LAB_0005e118;
                    }
                    FUN_0007d00c(
                        auStack_90, 99,
                        "# Invalid time : rc=%d hour=%d minute=%d second=%d",
                        iVar13, iVar16, iVar37, iVar9);
                    goto LAB_0005e234;
                case (undefined1 *)0x9:
                    break;
                case (undefined1 *)0xa:
                    break;
                case (undefined1 *)0xb:
                    break;
                case (undefined1 *)0xc:
                    break;
                case (undefined1 *)0xd:
                    iVar13 = sscanf((char *)piVar31, "%2d%2d%2d%1d%2d%2d%2d",
                                    iVar26 + 0x18, iVar26 + 0x1c, iVar26 + 0x20,
                                    &local_144, iVar26 + 0x24, iVar26 + 0x28,
                                    iVar26 + 0x2c);
                    if (iVar13 == 7) {
                        iVar9 = *(int *)(iVar26 + 0x20);
                        if ((*(int *)(iVar26 + 0x1c) - 1U < 0xc) &&
                            (iVar9 - 1U < 0x1f)) {
                            iVar33 = *(int *)(iVar26 + 0x24);
                            iVar16 = *(int *)(iVar26 + 0x28);
                            iVar37 = *(int *)(iVar26 + 0x2c);
                            if (((local_144 < 7) && (iVar33 < 0x18)) &&
                                ((iVar16 < 0x3c && (iVar37 < 0x3d))))
                                goto LAB_0005dcf0;
                        } else {
                            iVar33 = *(int *)(iVar26 + 0x24);
                            iVar16 = *(int *)(iVar26 + 0x28);
                            iVar37 = *(int *)(iVar26 + 0x2c);
                        }
                    } else {
                        iVar9 = *(int *)(iVar26 + 0x20);
                        iVar33 = *(int *)(iVar26 + 0x24);
                        iVar16 = *(int *)(iVar26 + 0x28);
                        iVar37 = *(int *)(iVar26 + 0x2c);
                    }
                    FUN_0007d00c(auStack_90, 99,
                                 "# Invalid time : rc=%d year=%d month=%d "
                                 "day=%d hour=%d minute=%d second=%d",
                                 iVar13, *(undefined4 *)(iVar26 + 0x18),
                                 *(int *)(iVar26 + 0x1c), iVar9, iVar33, iVar16,
                                 iVar37);
                    goto LAB_0005e234;
                case (undefined1 *)0xe:
                    break;
                case (undefined1 *)0xf:
                    break;
                case (undefined1 *)0x10:
                    break;
                case (undefined1 *)0x11:
                    pbVar22 = (byte *)((int)piVar31 + -1);
                    do {
                        pbVar22 = pbVar22 + 1;
                        *pbVar22 = *pbVar22 & 0x7f;
                    } while (pbVar22 != (byte *)(piVar31 + 4));
                    iVar13 = sscanf((char *)((int)piVar31 + 1),
                                    "%2d%2d%2d%2d%2d%2d%1d", iVar26 + 0x18,
                                    iVar26 + 0x1c, iVar26 + 0x20, iVar26 + 0x24,
                                    iVar26 + 0x28, iVar26 + 0x2c, &local_144);
                    if (iVar13 == 7) {
                        iVar9 = *(int *)(iVar26 + 0x20);
                        if ((*(int *)(iVar26 + 0x1c) - 1U < 0xc) &&
                            (iVar9 - 1U < 0x1f)) {
                            iVar33 = *(int *)(iVar26 + 0x24);
                            iVar16 = *(int *)(iVar26 + 0x28);
                            iVar37 = *(int *)(iVar26 + 0x2c);
                            if ((((local_144 < 7) && (iVar33 < 0x18)) &&
                                 (iVar16 < 0x3c)) &&
                                (iVar37 < 0x3d))
                                goto LAB_0005efec;
                        } else {
                            iVar33 = *(int *)(iVar26 + 0x24);
                            iVar16 = *(int *)(iVar26 + 0x28);
                            iVar37 = *(int *)(iVar26 + 0x2c);
                        }
                    } else {
                        iVar9 = *(int *)(iVar26 + 0x20);
                        iVar33 = *(int *)(iVar26 + 0x24);
                        iVar16 = *(int *)(iVar26 + 0x28);
                        iVar37 = *(int *)(iVar26 + 0x2c);
                    }
                    FUN_0007d00c(auStack_90, 99,
                                 "# Invalid time : rc=%d year=%d month=%d "
                                 "day=%d hour=%d minute=%d second=%d",
                                 iVar13, *(undefined4 *)(iVar26 + 0x18),
                                 *(int *)(iVar26 + 0x1c), iVar9, iVar33, iVar16,
                                 iVar37);
                    goto LAB_0005e234;
                }
            switchD_0005e2b4_default:
                FUN_0007d00c(auStack_90, 99, pcVar15, puVar21);
            LAB_0005e234:
                FUN_0005b63c(iVar34, 7, auStack_90);
                *(undefined1 *)(iVar26 + 0xf) = 1;
            LAB_0005dce8:
                pbVar24[0xc] = 4;
                pbVar24[0xd] = 0;
            LAB_0005dcf0:
                sVar18 = *(short *)(pbVar24 + 8);
            joined_r0x0005de2c:
                if (sVar18 == 0x20) {
                    iVar26 = *(int *)(pbVar24 + 0xb8);
                    iVar3 = iVar29 + 1;
                    if (iVar26 <= iVar3) {
                        if (iVar3 < 1)
                            goto LAB_0005de64;
                        goto LAB_0005de50;
                    }
                    sVar19 = *(short *)(pbVar24 + 0xc);
                    sVar18 = 0x20;
                    iVar26 = iVar3;
                } else {
                LAB_0005dd00:
                    if (sVar18 == 1)
                        goto LAB_0005de64;
                    sVar19 = *(short *)(pbVar24 + 0xc);
                    iVar26 = iVar3;
                }
            LAB_0005dd10:
                iVar3 = iVar26;
                sVar10 = sVar18;
            } while (sVar19 == 2);
            if (0 < iVar3 && sVar10 == 0x20) {
                iVar26 = *(int *)(pbVar24 + 0xb8);
            LAB_0005e340:
                if (iVar3 < iVar26) {
                    pbVar22 = pbVar24 + iVar3 + 0x53;
                    pbVar14 = pbVar24 + 0x53;
                    do {
                        pbVar22 = pbVar22 + 1;
                        pbVar14 = pbVar14 + 1;
                        *pbVar14 = *pbVar22;
                    } while (pbVar22 != pbVar24 + iVar26 + 0x53);
                }
            LAB_0005de50:
                if (iVar26 - iVar3 < 0) {
                    pbVar24[0xb8] = 0;
                    pbVar24[0xb9] = 0;
                    pbVar24[0xba] = 0;
                    pbVar24[0xbb] = 0;
                } else {
                    *(int *)(pbVar24 + 0xb8) = iVar26 - iVar3;
                }
            }
        LAB_0005de64:
            pbVar24[0xe] = 0;
        }
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0005f82c(int param_1, int param_2)

{
    short sVar1;
    int iVar2;
    bool bVar3;
    ushort uVar4;
    ushort uVar5;
    short sVar6;

    iVar2 = __stack_chk_guard;
    uVar4 = *(byte *)(param_1 + 0x58) - 0x30;
    if (((((uVar4 & 0xff) < 10) &&
          (uVar5 = *(byte *)(param_1 + 0x59) - 0x30, (uVar5 & 0xff) < 10)) &&
         (*(byte *)(param_1 + 0x5a) - 0x30 < 10)) &&
        (((*(byte *)(param_1 + 0x5b) - 0x30 < 10 &&
           (*(byte *)(param_1 + 0x5c) - 0x30 < 10)) &&
          (*(byte *)(param_1 + 0x5d) - 0x30 < 10)))) {
        uVar5 = uVar5 + uVar4 * 10;
        *(ushort *)(param_2 + 0x2e) = uVar5;
        sVar6 = (*(byte *)(param_1 + 0x5b) - 0x30) +
                (*(byte *)(param_1 + 0x5a) - 0x30) * 10;
        *(short *)(param_2 + 0x32) = sVar6;
        sVar1 = (*(byte *)(param_1 + 0x5d) - 0x30) +
                (*(byte *)(param_1 + 0x5c) - 0x30) * 10;
        *(short *)(param_2 + 0x30) = sVar1;
        if (sVar1 < 0x3d) {
            sVar1 = sVar6;
        }
        bVar3 = uVar5 < 0x18 && sVar1 < 0x3d;
    } else {
        bVar3 = false;
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(bVar3);
    }
    return;
}

void FUN_00060548(undefined4 param_1, int param_2, undefined1 *param_3,
                  int param_4)

{
    byte bVar1;
    undefined4 uVar2;
    int iVar3;
    int iVar4;
    int iVar5;
    int *piVar6;
    undefined1 *puVar7;
    undefined1 auStack_74[80];
    int local_24;

    local_24 = __stack_chk_guard;
    if (((param_4 == 0) ||
         (piVar6 = *(int **)(param_4 + 0x54), piVar6 == (int *)0x0)) ||
        (iVar5 = *piVar6, iVar5 == 0)) {
        FUN_00075d40(3, "NeoClock4X(%d): control: unit invalid/inactive",
                     param_1);
        goto LAB_000607ec;
    }
    if (param_2 != 0) {
        if ((*(byte *)(param_2 + 2) & 1) == 0) {
            bVar1 = *(byte *)(piVar6 + 0xc0);
        } else {
            iVar3 = *(int *)(param_2 + 0x28);
            iVar4 = *(int *)(param_2 + 0x2c);
            piVar6[0xba] = iVar3;
            piVar6[0xbb] = iVar4;
            if ((ntp_syslogmask & 0x100) == 0)
                goto LAB_000605c4;
            FUN_00075d40(
                5,
                "NeoClock4X(%d): using fudgetime1 with %0.5fs from ntp.conf.",
                param_1, ntp_syslogmask, iVar3, iVar4);
            bVar1 = *(byte *)(piVar6 + 0xc0);
        }
        if ((bVar1 & 1) == 0) {
            if ((ntp_syslogmask & 0x100) != 0) {
                FUN_00075d40(5,
                             "NeoClock4X(%d): time is only adjusted with radio "
                             "signal reception.",
                             param_1);
            }
        } else if ((ntp_syslogmask & 0x100) != 0) {
            FUN_00075d40(5,
                         "NeoClock4X(%d): quartz clock is used to synchronize "
                         "time if radio clock has no reception.",
                         param_1);
        }
    }
LAB_000605c4:
    if (param_3 != (undefined1 *)0x0) {
        *(undefined4 *)(param_3 + 0x44) = 0;
        puVar7 = param_3 + 0x44;
        *param_3 = 0x2c;
        FUN_0007d00c(
            auStack_74, 0x4f, "%04d-%02d-%02d %02d:%02d:%02d.%03d",
            *(undefined4 *)(iVar5 + 0x80), *(undefined4 *)(iVar5 + 0x84),
            *(undefined4 *)(iVar5 + 0x88), *(undefined4 *)(iVar5 + 0x8c),
            *(undefined4 *)(iVar5 + 0x90), *(undefined4 *)(iVar5 + 0x94),
            *(undefined4 *)(iVar5 + 0x98));
        uVar2 = FUN_000346c8(puVar7, 0x4f, 0x21);
        FUN_0007d00c(uVar2, 0x4f, "calc_utc=\"%s\"", auStack_74);
        uVar2 = FUN_000346c8(puVar7, 0x28, 0x21);
        FUN_0007d00c(uVar2, 0x27, "radiosignal=\"%s\"", iVar5 + 0x70);
        uVar2 = FUN_000346c8(puVar7, 0x28, 0x21);
        FUN_0007d00c(uVar2, 0x27, &DAT_000aa06c, *(undefined4 *)(iVar5 + 0x78));
        uVar2 = FUN_000346c8(puVar7, 0x28, 0x21);
        FUN_0007d00c(uVar2, 0x27, "antenna2=\"%d\"",
                     *(undefined4 *)(iVar5 + 0x7c));
        uVar2 = FUN_000346c8(puVar7, 0x28, 0x21);
        if (*(char *)(iVar5 + 0x74) == 'A') {
            FUN_0007d00c(uVar2, 0x27, "timesource=\"radio\"");
        } else if (*(char *)(iVar5 + 0x74) == 'C') {
            FUN_0007d00c(uVar2, 0x27, "timesource=\"quartz\"");
        } else {
            FUN_0007d00c(uVar2, 0x27, "timesource=\"unknown\"");
        }
        uVar2 = FUN_000346c8(puVar7, 0x28, 0x21);
        if (*(char *)(iVar5 + 0x76) == 'I') {
            FUN_0007d00c(uVar2, 0x27, "quartzstatus=\"synchronized\"");
        } else if (*(char *)(iVar5 + 0x76) == 'X') {
            FUN_0007d00c(uVar2, 0x27, "quartzstatus=\"not synchronized\"");
        } else {
            FUN_0007d00c(uVar2, 0x27, "quartzstatus=\"unknown\"");
        }
        uVar2 = FUN_000346c8(puVar7, 0x28, 0x21);
        if (*(char *)(iVar5 + 0x75) == 'S') {
            FUN_0007d00c(uVar2, 0x27, "dststatus=\"summer\"");
        } else if (*(char *)(iVar5 + 0x75) == 'W') {
            FUN_0007d00c(uVar2, 0x27, "dststatus=\"winter\"");
        } else {
            FUN_0007d00c(uVar2, 0x27, "dststatus=\"unknown\"");
        }
        uVar2 = FUN_000346c8(puVar7, 0x50, 0x21);
        FUN_0007d00c(uVar2, 0x4f, "firmware=\"%s\"", iVar5 + 0x18);
        uVar2 = FUN_000346c8(puVar7, 0x28, 0x21);
        FUN_0007d00c(uVar2, 0x27, "firmwaretag=\"%c\"",
                     *(undefined1 *)(iVar5 + 0x68));
        uVar2 = FUN_000346c8(puVar7, 0x50, 0x21);
        FUN_0007d00c(uVar2, 0x4f, "driver version=\"%s\"", "1.16 (2009-12-04)");
        uVar2 = FUN_000346c8(puVar7, 0x50, 0x21);
        FUN_0007d00c(uVar2, 0x4f, "serialnumber=\"%s\"", iVar5 + 0x69);
    }
LAB_000607ec:
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00060980(undefined4 param_1, int param_2)

{
    int iVar1;
    undefined4 *puVar2;
    void *__ptr;
    uint local_28;
    int local_24;

    local_24 = __stack_chk_guard;
    if (((param_2 != 0) && (puVar2 = *(undefined4 **)(param_2 + 0x54),
                            puVar2 != (undefined4 *)0x0)) &&
        (__ptr = (void *)*puVar2, __ptr != (void *)0x0)) {
        if (puVar2[7] != -1) {
            iVar1 = ioctl(puVar2[7], 0x5415, &local_28);
            if (iVar1 == -1) {
                FUN_00075d40(2,
                             "NeoClock4X(%d): can\'t query RTS/DTR state: %m",
                             param_1);
            }
            local_28 = local_28 & 0xfffffff9;
            iVar1 = ioctl(puVar2[7], 0x5418, &local_28);
            if (iVar1 == -1) {
                FUN_00075d40(2,
                             "NeoClock4X(%d): can\'t set RTS/DTR to power "
                             "neoclock4x: %m",
                             param_1);
            }
            FUN_000290fc(puVar2 + 2);
        }
        free(__ptr);
        *puVar2 = 0;
    }
    FUN_00075d40(3, "NeoClock4X(%d): shutdown", param_1);
    if ((ntp_syslogmask & 0x100) != 0) {
        FUN_00075d40(6, "NeoClock4X(%d): receiver shutdown done", param_1);
    }
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00060ac8(int param_1, int *param_2)

{
    int iVar1;
    int iVar2;
    ushort **ppuVar3;
    uint uVar4;
    byte *pbVar5;
    int iVar6;
    int iVar7;

    iVar1 = __stack_chk_guard;
    pbVar5 = (byte *)(param_1 + -1);
    ppuVar3 = __ctype_b_loc();
    iVar2 = __stack_chk_guard;
    iVar6 = 0;
    iVar7 = 0;
    while (true) {
        pbVar5 = pbVar5 + 1;
        uVar4 = ((uint)(*ppuVar3)[*pbVar5] << 0x14) >> 0x1f;
        if (iVar7 == 2) {
            uVar4 = 0;
        }
        if (uVar4 == 0)
            break;
        iVar7 = iVar7 + 1;
        iVar6 = (*pbVar5 - 0x30) + iVar6 * 10;
    }
    *param_2 = iVar6;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar6);
}

void FUN_00060b6c(int param_1, int *param_2)

{
    byte bVar1;
    int iVar2;
    ushort **ppuVar3;
    __int32_t **pp_Var4;
    uint uVar5;
    int iVar6;
    ushort *puVar7;
    int iVar8;
    byte *pbVar9;
    int iVar10;

    iVar2 = __stack_chk_guard;
    pbVar9 = (byte *)(param_1 + -1);
    iVar10 = 0;
    iVar8 = 0;
    ppuVar3 = __ctype_b_loc();
    puVar7 = *ppuVar3;
    while (true) {
        iVar6 = __stack_chk_guard;
        pbVar9 = pbVar9 + 1;
        bVar1 = *pbVar9;
        uVar5 = ((uint)puVar7[bVar1] << 0x13) >> 0x1f;
        if (iVar8 == 2) {
            uVar5 = 0;
        }
        if (uVar5 == 0)
            break;
        if ((puVar7[bVar1] & 0x800) == 0) {
            pp_Var4 = __ctype_toupper_loc();
            iVar6 = (*pp_Var4)[bVar1] + -0x37;
        } else {
            pp_Var4 = __ctype_toupper_loc();
            iVar6 = (*pp_Var4)[bVar1] + -0x30;
        }
        iVar10 = iVar6 + iVar10 * 0x10;
        iVar8 = iVar8 + 1;
    }
    *param_2 = iVar10;
    if (iVar2 == iVar6) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar10);
}

void FUN_00060c2c(int param_1)

{
    char cVar1;
    byte bVar2;
    undefined1 uVar3;
    undefined2 uVar4;
    short sVar5;
    int iVar6;
    int iVar7;
    int iVar8;
    int iVar9;
    undefined4 uVar10;
    byte *pbVar11;
    uint uVar12;
    int extraout_r1;
    int extraout_r1_00;
    uint uVar13;
    uint uVar14;
    uint uVar15;
    int *piVar16;
    int iVar17;
    int iVar18;
    int *piVar19;
    int local_58;
    int local_3c;
    int local_38;
    int local_34;
    uint local_30;
    int local_2c;

    iVar18 = *(int *)(param_1 + 4);
    piVar16 = *(int **)(iVar18 + 0x54);
    iVar17 = *piVar16;
    local_2c = __stack_chk_guard;
    if (*(int *)(iVar17 + 0x14) != 0) {
        piVar19 = piVar16 + 0xe;
        *(undefined4 *)(iVar17 + 0x14) = 0;
        iVar6 = FUN_0004a6d4(param_1, piVar19, 0x80, piVar16 + 0x3a);
        *(undefined1 *)(piVar16 + 10) = 0;
        piVar16[0x2e] = iVar6;
        if (iVar6 == 0x25) {
            FUN_00060b6c((int)piVar16 + 0x5b, &local_30);
            pbVar11 = (byte *)((int)piVar16 + 0x37);
            uVar15 = 0;
            do {
                pbVar11 = pbVar11 + 1;
                uVar15 = uVar15 + *pbVar11 & 0xff;
            } while (pbVar11 != (byte *)((int)piVar16 + 0x5a));
            if (uVar15 == local_30) {
                cVar1 = *(char *)((int)piVar16 + 0x56);
                *(char *)(iVar17 + 0x76) = cVar1;
                if ((*(byte *)(piVar16 + 0xc0) & 2) == 0) {
                    if (cVar1 != 'I') {
                        if ((ntp_syslogmask & 0x200) != 0) {
                            FUN_00075d40(5,
                                         "NeoClock4X(%d): quartz clock is not "
                                         "initialized: %s",
                                         (int)*(short *)(iVar17 + 8), piVar19);
                        }
                        *(undefined1 *)(piVar16 + 10) = 3;
                        FUN_00049c88(iVar18, 5);
                        goto LAB_00060c64;
                    }
                } else if ((cVar1 != 'I') && ((ntp_syslogmask & 0x200) != 0)) {
                    FUN_00075d40(5,
                                 "NeoClock4X(%d): using uninitialized quartz "
                                 "clock for time synchronization: %s",
                                 (int)*(short *)(iVar17 + 8), piVar19);
                }
                iVar6 = piVar16[0x15];
                *(char *)(iVar17 + 0x74) = (char)iVar6;
                bVar2 = *(byte *)(piVar16 + 0xc0);
                uVar15 = ((bVar2 ^ 2) << 0x1e) >> 0x1f;
                if ((char)iVar6 == 'A') {
                    uVar15 = 0;
                }
                if ((uVar15 == 0) || ((bVar2 & 1) != 0)) {
                    if ((bVar2 & 8) != 0) {
                        FUN_00075d40(7, "NeoClock4X(%d): received data: %s",
                                     (int)*(short *)(iVar17 + 8), piVar19);
                    }
                    FUN_00060ac8(piVar16 + 0x12, piVar16 + 0x2f);
                    FUN_00060ac8((int)piVar16 + 0x46, &local_38);
                    FUN_00060ac8(piVar16 + 0x11, &local_3c);
                    FUN_00060ac8((int)piVar16 + 0x4a, piVar16 + 0x31);
                    FUN_00060ac8(piVar16 + 0x13, piVar16 + 0x32);
                    FUN_00060ac8((int)piVar16 + 0x4e, piVar16 + 0x33);
                    FUN_00060ac8(piVar16 + 0x14, &local_34);
                    piVar16[0x34] = local_34 * 10000000;
                    uVar4 = *(undefined2 *)((int)piVar16 + 0x41);
                    uVar3 = *(undefined1 *)((int)piVar16 + 0x43);
                    *(undefined1 *)(iVar17 + 0x73) = 0;
                    *(undefined2 *)(iVar17 + 0x70) = uVar4;
                    *(undefined1 *)(iVar17 + 0x72) = uVar3;
                    *(undefined4 *)(iVar17 + 0x69) =
                        *(undefined4 *)((int)piVar16 + 0x3b);
                    uVar4 = *(undefined2 *)((int)piVar16 + 0x3f);
                    *(undefined1 *)(iVar17 + 0x6f) = 0;
                    *(undefined2 *)(iVar17 + 0x6d) = uVar4;
                    *(undefined1 *)(iVar17 + 0x75) =
                        *(undefined1 *)((int)piVar16 + 0x55);
                    FUN_00060b6c((int)piVar16 + 0x57, iVar17 + 0x78);
                    FUN_00060b6c((int)piVar16 + 0x59, iVar17 + 0x7c);
                    uVar15 = piVar16[0x31];
                    if ((((uVar15 < 0x18) &&
                          (uVar13 = piVar16[0x32], uVar13 < 0x3c)) &&
                         (uVar14 = piVar16[0x33], uVar14 < 0x3d)) &&
                        (((local_3c - 1U < 0x1f && (local_38 - 1U < 0xc)) &&
                          (uVar12 = piVar16[0x2f], uVar12 < 100)))) {
                        local_58 = local_38 + -2;
                        iVar6 = uVar12 + 2000;
                        piVar16[0x2f] = iVar6;
                        if (local_58 < 1) {
                            iVar6 = uVar12 + 1999;
                            local_58 = local_38 + 10;
                        }
                        iVar7 = FUN_0009ce58(iVar6, 0xffffff9c);
                        iVar8 = FUN_0009ce58(iVar6, 400);
                        iVar9 = FUN_0009ce58(local_58 * 0x16f, 0xc);
                        iVar6 = (((iVar6 * 0x16d + local_3c + (iVar6 >> 2) +
                                   iVar7 + iVar8 + iVar9) *
                                      0x18 +
                                  uVar15) *
                                     0x3c +
                                 uVar13) *
                                    0x3c +
                                uVar14;
                        uVar15 = iVar6 + 0x86b1b170;
                        if (*(char *)(iVar17 + 0x75) == 'S') {
                            uVar15 = iVar6 + 0x86b1a360;
                        }
                        FUN_0009ce3c(uVar15, 0x3c);
                        uVar15 = uVar15 / 0x3c;
                        piVar16[0x32] = uVar15 % 0x3c;
                        piVar16[0x33] = extraout_r1;
                        FUN_0009ce3c(uVar15 / 0x3c, 0x18, uVar15 * -0x77777777);
                        iVar6 = (uVar15 / 0x3c) / 0x18 + 0x264965;
                        uVar15 = (uint)(iVar6 * 4) / 0x23ab1;
                        iVar6 = iVar6 - (uVar15 * 0x23ab1 + 3 >> 2);
                        piVar16[0x31] = extraout_r1_00;
                        uVar13 = (iVar6 * 4000 + 4000U) / 0x164b09;
                        local_3c = (iVar6 + 0x1f) - (uVar13 * 0x5b5 >> 2);
                        uVar14 = (uint)(local_3c * 0x50) / 0x98f;
                        iVar6 = uVar15 * 100 + uVar13 + -0x1324 + uVar14 / 0xb;
                        piVar16[0x2f] = iVar6;
                        local_38 = uVar14 + 2 + (uVar14 / 0xb) * -0xc;
                        local_3c = local_3c - (uVar14 * 0x98f) / 0x50;
                        iVar6 = FUN_0007fbfc(iVar6, local_38);
                        *(undefined1 *)(piVar16 + 10) = 0;
                        piVar16[0x30] = iVar6;
                        if ((*(byte *)(piVar16 + 0xc0) & 8) != 0) {
                            sVar5 = *(short *)(iVar17 + 8);
                            uVar10 = FUN_0009ce58(piVar16[0x34], &DAT_000f4240);
                            FUN_00075d40(
                                7,
                                "NeoClock4X(%d): calculated UTC date/time: "
                                "%04d-%02d-%02d %02d:%02d:%02d.%03ld",
                                (int)sVar5, piVar16[0x2f], local_38, local_3c,
                                piVar16[0x31], piVar16[0x32], piVar16[0x33],
                                uVar10);
                        }
                        *(int *)(iVar17 + 0x80) = piVar16[0x2f];
                        iVar6 = piVar16[0x31];
                        *(int *)(iVar17 + 0x84) = local_38;
                        iVar7 = piVar16[0x32];
                        *(int *)(iVar17 + 0x88) = local_3c;
                        iVar8 = piVar16[0x33];
                        *(int *)(iVar17 + 0x8c) = iVar6;
                        *(int *)(iVar17 + 0x90) = iVar7;
                        iVar6 = piVar16[0x34];
                        *(int *)(iVar17 + 0x94) = iVar8;
                        uVar10 = FUN_0009ce58(iVar6, &DAT_000f4240);
                        *(undefined4 *)(iVar17 + 0x98) = uVar10;
                        iVar6 = FUN_0004a4e8(piVar16);
                        if (iVar6 == 0) {
                            if ((ntp_syslogmask & 0x200) != 0) {
                                FUN_00075d40(
                                    4,
                                    "NeoClock4X(%d): refclock_process failed!",
                                    (int)*(short *)(iVar17 + 8));
                            }
                            FUN_00049c88(iVar18, 3);
                        } else {
                            FUN_0004a534(iVar18);
                            FUN_00049c88(iVar18, 0);
                            FUN_00052d0c(iVar18 + 0x10, piVar19);
                        }
                    } else {
                        if ((ntp_syslogmask & 0x200) != 0) {
                            FUN_00075d40(
                                4, "NeoClock4X(%d): date/time out of range: %s",
                                (int)*(short *)(iVar17 + 8), piVar19);
                        }
                        FUN_00049c88(iVar18, 5);
                    }
                } else {
                    FUN_00049c88(iVar18, 6);
                    *(undefined1 *)(piVar16 + 10) = 3;
                }
                goto LAB_00060c64;
            }
            if ((ntp_syslogmask & 0x200) != 0) {
                FUN_00075d40(
                    4, "NeoClock4X(%d): received data has invalid chksum: %s",
                    (int)*(short *)(iVar17 + 8), piVar19);
            }
        } else if ((ntp_syslogmask & 0x200) != 0) {
            FUN_00075d40(4,
                         "NeoClock4X(%d): received data has invalid length, "
                         "expected %d bytes, received %d bytes: %s",
                         (int)*(short *)(iVar17 + 8), 0x25, iVar6, piVar19);
        }
        FUN_00049c88(iVar18, 2);
    }
LAB_00060c64:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_000612f4(undefined4 param_1, int param_2)

{
    short sVar1;
    bool bVar2;
    bool bVar3;
    int __fd;
    int iVar4;
    void *__s;
    ssize_t sVar5;
    char *pcVar6;
    size_t sVar7;
    size_t sVar8;
    int *piVar9;
    char *__haystack;
    undefined4 *puVar10;
    char cVar11;
    undefined4 uVar12;
    int iVar13;
    uint uVar14;
    uint uVar15;
    int iVar16;
    int iVar17;
    uint local_1bc;
    undefined2 local_1b0;
    uint local_1a8;
    int local_198;
    char local_181;
    uint local_180;
    termios local_17c;
    undefined1 auStack_140[20];
    char local_12c[256];
    int local_2c;

    local_2c = __stack_chk_guard;
    FUN_0007d00c(auStack_140, 0x13, "/dev/neoclock4x-%d", param_1);
    __fd = FUN_0004aa90(auStack_140, 0xb, 0);
    if (__fd < 1) {
        uVar12 = 0;
    } else {
        iVar4 = tcgetattr(__fd, &local_17c);
        if (iVar4 < 0) {
            uVar12 = 0;
            FUN_00075d40(2,
                         "NeoClock4X(%d): (tcgetattr) can\'t query serial port "
                         "settings: %m",
                         param_1);
            close(__fd);
        } else {
            uVar12 = 0;
            local_17c.c_oflag = 0;
            local_17c.c_iflag = 0x105;
            local_17c.c_cflag = 0x8f0;
            cfsetispeed(&local_17c, 0xb);
            cfsetospeed(&local_17c, 0xb);
            iVar4 = tcsetattr(__fd, 0, &local_17c);
            if (iVar4 < 0) {
                FUN_00075d40(2,
                             "NeoClock4X(%d): (tcsetattr) can\'t set serial "
                             "port 2400 8N2: %m",
                             param_1);
                close(__fd);
            } else {
                iVar4 = ioctl(__fd, 0x5415, &local_180);
                if (iVar4 == -1) {
                    FUN_00075d40(
                        2, "NeoClock4X(%d): can\'t query RTS/DTR state: %m",
                        param_1);
                    close(__fd);
                } else {
                    local_180 = local_180 | 6;
                    iVar4 = ioctl(__fd, 0x5418, &local_180);
                    if (iVar4 == -1) {
                        FUN_00075d40(2,
                                     "NeoClock4X(%d): can\'t set RTS/DTR to "
                                     "power neoclock4x: %m",
                                     param_1);
                        close(__fd);
                    } else {
                        __s = (void *)FUN_00074b04(0, 0x9c, 0, 0);
                        if (__s == (void *)0x0) {
                            FUN_00075d40(3,
                                         "NeoClock4X(%d): can\'t allocate "
                                         "memory for: %m",
                                         param_1);
                            close(__fd);
                            uVar12 = 0;
                        } else {
                            memset(__s, 0, 0x9c);
                            __haystack = (char *)((int)__s + 0x18);
                            puVar10 = *(undefined4 **)(param_2 + 0x54);
                            puVar10[0xb] = "NeoClock4X";
                            puVar10[3] = FUN_00060c2c;
                            puVar10[0xba] = 0x1b4e81b5;
                            puVar10[0xbb] = 0x3fc5b4e8;
                            local_1b0 = (undefined2)param_1;
                            puVar10[5] = param_2;
                            *puVar10 = __s;
                            puVar10[6] = 0;
                            puVar10[7] = __fd;
                            *(undefined1 *)(param_2 + 0x5f) = 0xf6;
                            puVar10[0xbf] = 0x6c6f656e;
                            *(undefined2 *)((int)__s + 8) = local_1b0;
                            *(undefined1 *)((int)__s + 0x10) = 0;
                            FUN_0007e4b4(__haystack, &DAT_000aa52c, 0x50);
                            *(undefined1 *)((int)__s + 0x68) = 0x3f;
                            FUN_0007e4b4((int)__s + 0x69, &DAT_000aa52c, 7);
                            FUN_0007e4b4((int)__s + 0x70, &DAT_000aa52c, 4);
                            *(undefined4 *)((int)__s + 0x78) = 0xffffffff;
                            *(undefined4 *)((int)__s + 0x7c) = 0xffffffff;
                            *(undefined1 *)((int)__s + 0x74) = 0x3f;
                            *(undefined1 *)((int)__s + 0x75) = 0x3f;
                            local_198 = 0;
                            *(undefined1 *)((int)__s + 0x76) = 0x3f;
                            *(undefined4 *)((int)__s + 0x80) = 0;
                            *(undefined4 *)((int)__s + 0x84) = 0;
                            *(undefined4 *)((int)__s + 0x88) = 0;
                            *(undefined4 *)((int)__s + 0x8c) = 0;
                            *(undefined4 *)((int)__s + 0x90) = 0;
                            *(undefined4 *)((int)__s + 0x94) = 0;
                            *(undefined4 *)((int)__s + 0x98) = 0;
                            do {
                                if ((ntp_syslogmask & 0x100) != 0) {
                                    FUN_00075d40(
                                        6,
                                        "NeoClock4X(%d): checking NeoClock4X "
                                        "firmware version (%d/5)",
                                        param_1, local_198);
                                }
                                sleep(3);
                                iVar4 = puVar10[7];
                                iVar17 = (int)*(short *)((int)__s + 8);
                                sleep(1);
                                sVar5 = write(iVar4, &DAT_000aa56c, 1);
                                if (sVar5 == -1) {
                                    FUN_00075d40(3,
                                                 "NeoClock4X(%d): can\'t query "
                                                 "firmware version",
                                                 iVar17);
                                    FUN_0007e4b4(local_12c, "unknown error",
                                                 0x100);
                                } else {
                                    uVar14 = 0;
                                    sleep(1);
                                    memset(local_12c, 0, 0x100);
                                    local_1a8 = 0;
                                    bVar2 = false;
                                    local_1bc = 0;
                                    iVar13 = 0;
                                    iVar16 = 0;
                                    bVar3 = true;
                                    do {
                                        sVar5 = read(iVar4, &local_181, 1);
                                        if (sVar5 == -1) {
                                            piVar9 = __errno_location();
                                            if (*piVar9 == 0xb) {
                                                sleep(1);
                                            } else {
                                                iVar16 = iVar16 + 1;
                                                FUN_00075d40(
                                                    7,
                                                    "NeoClock4x(%d): read: %m",
                                                    iVar17);
                                            }
                                        } else {
                                            iVar13 = iVar13 + 1;
                                            if (bVar3) {
                                                if (local_181 == -0x57) {
                                                    bVar3 = false;
                                                    FUN_0007e4b4(local_12c,
                                                                 &DAT_000aa634,
                                                                 0x100);
                                                    uVar14 = 3;
                                                } else {
                                                    bVar3 = true;
                                                }
                                            } else {
                                                uVar15 = uVar14;
                                                if (local_181 == '\n' ||
                                                    local_181 == '\r') {
                                                    if (bVar2) {
                                                        pcVar6 = strstr(
                                                            local_12c +
                                                                local_1bc,
                                                            "S/N");
                                                        if (pcVar6 !=
                                                            (char *)0x0) {
                                                            local_12c
                                                                [local_1a8] =
                                                                    bVar3;
                                                            uVar14 =
                                                                FUN_0007e4b4(
                                                                    __haystack,
                                                                    local_12c,
                                                                    0x50);
                                                            if (0x4f < uVar14) {
                                                                FUN_0007e4b4(
                                                                    __haystack,
                                                                    "buffer "
                                                                    "too small",
                                                                    0x50);
                                                            }
                                                            if ((ntp_syslogmask &
                                                                 0x100) != 0) {
                                                                FUN_00075d40(
                                                                    6,
                                                                    "NeoClock4X"
                                                                    "(%d): "
                                                                    "firmware "
                                                                    "version: "
                                                                    "%s",
                                                                    iVar17,
                                                                    __haystack);
                                                            }
                                                            pcVar6 = strstr(
                                                                __haystack,
                                                                "/R2");
                                                            if (pcVar6 !=
                                                                (char *)0x0) {
                                                                FUN_00075d40(
                                                                    6,
                                                                    "NeoClock4X"
                                                                    "(%d): "
                                                                    "Your "
                                                                    "NeoClock4X"
                                                                    " uses the "
                                                                    "new R2 "
                                                                    "firmware "
                                                                    "release. "
                                                                    "Please "
                                                                    "note the "
                                                                    "changed "
                                                                    "LED "
                                                                    "behaviour"
                                                                    ".",
                                                                    iVar17);
                                                            }
                                                            goto LAB_000616e4;
                                                        }
                                                        local_1bc = uVar14 + 3;
                                                        local_12c[uVar14 + 1] =
                                                            '/';
                                                        local_12c[uVar14] = ' ';
                                                        local_12c[uVar14 + 2] =
                                                            ' ';
                                                        uVar15 = local_1bc;
                                                        bVar2 = true;
                                                        local_1a8 = uVar14;
                                                    } else {
                                                        bVar2 = true;
                                                    }
                                                } else {
                                                    bVar2 = bVar3;
                                                    if (local_181 != '\0') {
                                                        uVar15 = uVar14 + 1;
                                                        local_12c[uVar14] =
                                                            local_181;
                                                    }
                                                }
                                                local_12c[uVar15] = '\0';
                                                uVar14 = uVar15;
                                                if (0xfb < uVar15)
                                                    goto LAB_000616b4;
                                            }
                                        }
                                        if (5 < iVar16) {
                                            FUN_00075d40(
                                                3,
                                                "NeoClock4X(%d): can\'t read "
                                                "firmware version (timeout)",
                                                iVar17);
                                            FUN_0007e4b4(
                                                local_12c,
                                                "unknown due to timeout",
                                                0x100);
                                            goto LAB_000616b4;
                                        }
                                    } while (iVar13 < 0x1f5);
                                    FUN_00075d40(3,
                                                 "NeoClock4X(%d): can\'t read "
                                                 "firmware version (garbage)",
                                                 iVar17);
                                    FUN_0007e4b4(local_12c,
                                                 "unknown due to garbage input",
                                                 0x100);
                                }
                            LAB_000616b4:
                                uVar14 =
                                    FUN_0007e4b4(__haystack, local_12c, 0x50);
                                if (0x4f < uVar14) {
                                    FUN_0007e4b4(__haystack, "buffer too small",
                                                 0x50);
                                }
                                local_198 = local_198 + 1;
                            } while (local_198 != 5);
                        LAB_000616e4:
                            cVar11 = '?';
                            *(undefined1 *)((int)__s + 0x68) = 0x3f;
                            pcVar6 = strstr(__haystack, "NDF:");
                            sVar1 = *(short *)((int)__s + 8);
                            if (pcVar6 != (char *)0x0) {
                                sVar7 = strlen(__haystack);
                                sVar8 = strlen(pcVar6);
                                if (((6 < sVar7 - sVar8) &&
                                     (pcVar6[5] == ':')) &&
                                    (pcVar6[6] == '*')) {
                                    cVar11 = pcVar6[4];
                                    *(char *)((int)__s + 0x68) = cVar11;
                                    if (cVar11 == 'A') {
                                        iVar4 = FUN_00029084(puVar10 + 2);
                                        if (iVar4 == 0) {
                                            FUN_00075d40(
                                                3,
                                                "NeoClock4X(%d): error add "
                                                "peer to ntpd: %m",
                                                param_1);
                                            close(__fd);
                                            puVar10[7] = 0xffffffff;
                                            free((void *)*puVar10);
                                            *puVar10 = 0;
                                            uVar12 = 0;
                                        } else if ((ntp_syslogmask & 0x100) ==
                                                   0) {
                                            uVar12 = 1;
                                        } else {
                                            uVar12 = 1;
                                            FUN_00075d40(
                                                6,
                                                "NeoClock4X(%d): receiver "
                                                "setup successful done",
                                                param_1);
                                        }
                                        goto LAB_00061778;
                                    }
                                }
                            }
                            FUN_00075d40(
                                2,
                                "NeoClock4X(%d): firmware version \"%c\" not "
                                "supported with this driver version!",
                                (int)sVar1, cVar11);
                            close(__fd);
                            puVar10[7] = 0xffffffff;
                            free((void *)*puVar10);
                            uVar12 = 0;
                            *puVar10 = 0;
                        }
                    }
                }
            }
        }
    }
LAB_00061778:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar12);
}

void FUN_00061b74(undefined4 *param_1, int param_2, int param_3, int param_4)

{
    byte bVar1;
    int iVar2;
    uint uVar3;
    byte *pbVar4;
    int iVar5;

    iVar2 = __stack_chk_guard;
    iVar5 = param_1[3];
    if (param_2 < iVar5) {
        pbVar4 = (byte *)*param_1;
        param_1[1] = pbVar4;
        iVar5 = 0;
        param_1[3] = 0;
    } else {
        pbVar4 = (byte *)param_1[1];
    }
    if (iVar5 < param_2) {
        bVar1 = *pbVar4;
        while (bVar1 != 0) {
            pbVar4 = pbVar4 + 1;
            if (bVar1 == 0x2c) {
                iVar5 = iVar5 + 1;
            }
            param_1[1] = pbVar4;
            param_1[3] = iVar5;
            if (param_2 <= iVar5)
                goto LAB_00061bf8;
            bVar1 = *pbVar4;
        }
    } else {
    LAB_00061bf8:
        if (*pbVar4 != 0) {
            uVar3 = (uint)*pbVar4 - param_3;
            if (uVar3 != 0) {
                uVar3 = 1;
            }
            if (uVar3 != (param_4 == 0)) {
                iVar5 = 1;
                goto LAB_00061c24;
            }
        }
    }
    iVar5 = 0;
LAB_00061c24:
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail((&DAT_000aa7dc)[iVar5]);
    }
    return;
}

void FUN_00061ec0(undefined4 param_1, int param_2)

{
    undefined4 uVar1;
    int iVar2;
    uint uVar3;
    undefined4 local_38;
    undefined4 uStack_34;
    undefined4 local_30;
    undefined4 uStack_2c;
    int local_24;
    undefined4 local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    FUN_0007694c(&local_38, param_2 + -0xa8c0, 0);
    local_30 = local_38;
    uStack_2c = uStack_34;
    FUN_00076a00(&local_24, &local_30);
    uVar1 = FUN_000775b8(param_1);
    uVar1 = FUN_000767f8(local_20, uVar1, "");
    iVar2 = FUN_00076e14(param_1, uVar1);
    uVar3 = FUN_00076c70(param_1, "refclock_jjy.c : jjy_start_telephone : "
                                  "phone in the ntpd.conf must be specified." +
                                      iVar2 + local_24 + 0x18);
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(~uVar3 >> 0x1f);
}

void FUN_00061f80(undefined2 *param_1, undefined4 *param_2, int param_3,
                  int param_4)

{
    char cVar1;
    char *__s;
    undefined4 uVar2;
    int iVar3;
    undefined2 local_24[2];
    int local_20;
    int local_1c;
    int local_18;
    int local_14;

    iVar3 = param_2[3];
    local_14 = __stack_chk_guard;
    if (param_3 < iVar3) {
        iVar3 = 0;
        param_2[3] = 0;
        __s = (char *)*param_2;
        param_2[1] = __s;
    } else {
        __s = (char *)param_2[1];
    }
    if (iVar3 < param_3) {
        cVar1 = *__s;
        while (cVar1 != '\0') {
            __s = __s + 1;
            if (cVar1 == ',') {
                iVar3 = iVar3 + 1;
            }
            param_2[1] = __s;
            param_2[3] = iVar3;
            if (param_3 <= iVar3)
                break;
            cVar1 = *__s;
        }
    }
    if (param_4 == 0) {
        iVar3 = sscanf(__s, "%2u%2u%2u%n", &local_1c, &local_20, local_24,
                       &local_18);
        if ((iVar3 == 3) && (local_18 == 6))
            goto LAB_00062070;
    } else if ((param_4 == 1) &&
               ((iVar3 = sscanf(__s, "%2u,%2u,%4u%n", &local_1c, &local_20,
                                local_24, &local_18),
                 iVar3 == 3 && (local_18 == 10)))) {
    LAB_00062070:
        if ((local_1c - 1U < 0x1f) && (local_20 - 1U < 0xc)) {
            uVar2 = 1;
            *(char *)((int)param_1 + 5) = (char)local_1c;
            *(char *)(param_1 + 2) = (char)local_20;
            *param_1 = local_24[0];
            goto LAB_00062020;
        }
    }
    uVar2 = 0;
LAB_00062020:
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar2);
}

void FUN_000620f8(char *param_1, int *param_2, undefined4 *param_3, int param_4)

{
    char cVar1;
    char *__s;
    undefined4 uVar2;
    int iVar3;
    uint local_2c;
    uint local_28;
    uint local_24;
    int local_20;
    int local_1c;
    int local_18;
    int local_14;

    iVar3 = param_3[3];
    __s = param_1;
    if (param_4 < iVar3) {
        __s = (char *)*param_3;
    }
    local_14 = __stack_chk_guard;
    if (param_4 < iVar3) {
        param_3[1] = __s;
        iVar3 = 0;
        param_3[3] = 0;
    } else {
        __s = (char *)param_3[1];
    }
    if (iVar3 < param_4) {
        cVar1 = *__s;
        while (cVar1 != '\0') {
            __s = __s + 1;
            if (cVar1 == ',') {
                iVar3 = iVar3 + 1;
            }
            param_3[1] = __s;
            param_3[3] = iVar3;
            if (param_4 <= iVar3)
                break;
            cVar1 = *__s;
        }
    }
    iVar3 = sscanf(__s, "%2u%2u%2u%n.%3lu%n", &local_2c, &local_28, &local_24,
                   &local_20, &local_18, &local_1c);
    if ((((iVar3 < 3) || (local_20 != 6)) || (0x17 < local_2c)) ||
        ((0x3b < local_28 || (0x3c < local_24)))) {
        uVar2 = 0;
    } else {
        param_1[6] = (char)local_2c;
        param_1[7] = (char)local_28;
        param_1[8] = (char)local_24;
        if (iVar3 == 4) {
            uVar2 = 1;
            *param_2 =
                local_18 *
                *(int *)("NeoClock4X(%d): receiver setup successful done" +
                         local_1c * 4 + 0x2c);
        } else {
            uVar2 = 1;
            *param_2 = 0;
        }
    }
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar2);
}

void FUN_0006226c(int *param_1, uint param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    int iVar2;
    char *pcVar3;
    char cVar4;
    uint *puVar5;
    int iVar6;
    uint uVar7;
    bool bVar8;
    uint auStack_c[3];

    iVar1 = __stack_chk_guard;
    auStack_c[2] = param_4;
    auStack_c[1] = param_3;
    auStack_c[0] = param_2;
    iVar6 = 8;
    puVar5 = auStack_c;
    do {
        uVar7 = *puVar5;
        if (uVar7 < 0x21) {
            iVar2 = param_1[3];
            if ((int)uVar7 < iVar2) {
                param_1[3] = 0;
                pcVar3 = (char *)*param_1;
                iVar2 = 0;
                param_1[1] = (int)pcVar3;
            } else {
                pcVar3 = (char *)param_1[1];
            }
            cVar4 = *pcVar3;
            while (iVar2 < (int)uVar7) {
                if (cVar4 == '\0') {
                    cVar4 = '\0';
                    break;
                }
                if (cVar4 == ',') {
                    iVar2 = iVar2 + 1;
                }
                param_1[3] = iVar2;
                param_1[1] = (int)(pcVar3 + 1);
                cVar4 = pcVar3[1];
                pcVar3 = pcVar3 + 1;
            }
        } else {
            iVar2 = param_1[2];
            pcVar3 = (char *)(*param_1 + iVar2);
            if ((iVar2 < 3) || (pcVar3[-3] != '*')) {
                cVar4 = *(char *)(*param_1 + iVar2);
            } else {
                cVar4 = pcVar3[-2];
                pcVar3 = pcVar3 + -2;
            }
        }
        while (cVar4 != '\0' && (cVar4 - 0x2aU & 0xfd) != 0) {
            if (cVar4 != '.') {
                *pcVar3 = '_';
            }
            pcVar3 = pcVar3 + 1;
            cVar4 = *pcVar3;
        }
        bVar8 = iVar6 == 0;
        uVar7 = ~uVar7 >> 0x1f;
        iVar6 = iVar6 + -1;
        if (bVar8) {
            uVar7 = 0;
        }
        puVar5 = puVar5 + 1;
        if (uVar7 == 0) {
            if (iVar1 != __stack_chk_guard) {
                /* WARNING: Subroutine does not return */
                __stack_chk_fail();
            }
            return;
        }
    } while (true);
}

void FUN_000623c0(undefined4 param_1, int param_2)

{
    int iVar1;
    uint uVar2;
    undefined4 uVar3;
    char *pcVar4;
    int iVar5;
    int *piVar6;
    int iVar7;
    addrinfo *paVar8;
    undefined4 local_c0;
    char *local_bc;
    addrinfo *local_b4;
    addrinfo local_b0;
    char acStack_90[20];
    char acStack_7c[80];
    int local_2c;

    piVar6 = *(int **)(param_2 + 0x54);
    local_2c = __stack_chk_guard;
    iVar1 = FUN_00074b04(0, 0x30, 0, 1);
    switch ((uint)(*(int *)(param_2 + 0x4c) << 0x19) >> 0x1d) {
    case 0:
        local_bc = "4800";
        local_c0 = 0xc;
        break;
    case 1:
        local_bc = "9600";
        local_c0 = 0xd;
        break;
    case 2:
        local_bc = "19200";
        local_c0 = 0xe;
        break;
    case 3:
        local_bc = "38400";
        local_c0 = 0xf;
        break;
    case 4:
        local_bc = "57600";
        local_c0 = 0x1001;
        break;
    case 5:
        local_bc = "115200";
        local_c0 = 0x1002;
        break;
    default:
        local_bc = "4800 (fallback)";
        local_c0 = 0xc;
    }
    iVar7 = 0;
    *piVar6 = iVar1;
    piVar6[3] = (int)FUN_00062768;
    piVar6[5] = param_2;
    piVar6[7] = -1;
    piVar6[6] = 0;
    memset((void *)(iVar1 + 4), 0xff, 8);
    *(undefined1 *)(iVar1 + 0x28) = 2;
    memset((void *)(iVar1 + 0x10), 0, 0x18);
    *(undefined1 *)(param_2 + 0x5f) = 0xf7;
    piVar6[0xb] = (int)"NMEA GPS Clock";
    piVar6[0xbf] = 0x535047;
    uVar2 = FUN_0007d00c(acStack_90, 0x14, "/dev/gps%d", param_1);
    if (uVar2 < 0x14) {
        iVar1 = FUN_0004aa90(acStack_90, local_c0, 1);
        piVar6[7] = iVar1;
        if (iVar1 < 1) {
            uVar2 = readlink(acStack_90, acStack_7c, 0x50);
            if (uVar2 < 0x50) {
                acStack_7c[uVar2] = '\0';
                pcVar4 = strchr(acStack_7c, 0x3a);
                if (pcVar4 != (char *)0x0) {
                    *pcVar4 = '\0';
                    local_b0.ai_flags = 0;
                    local_b0.ai_family = 0;
                    local_b0.ai_addrlen = 0;
                    local_b0.ai_addr = (sockaddr *)0x0;
                    local_b0.ai_canonname = (char *)0x0;
                    local_b0.ai_next = (addrinfo *)0x0;
                    local_b0.ai_protocol = 6;
                    local_b0.ai_socktype = 1;
                    iVar1 = getaddrinfo(acStack_7c, pcVar4 + 1, &local_b0,
                                        &local_b4);
                    if (iVar1 == 0) {
                        iVar7 = 0;
                        paVar8 = local_b4;
                        if (local_b4 == (addrinfo *)0x0) {
                            freeaddrinfo((addrinfo *)0x0);
                            piVar6[7] = -1;
                        } else {
                            do {
                                iVar1 = socket(paVar8->ai_family,
                                               paVar8->ai_socktype,
                                               paVar8->ai_protocol);
                                if (iVar1 != -1) {
                                    iVar5 = connect(iVar1, paVar8->ai_addr,
                                                    paVar8->ai_addrlen);
                                    if (iVar5 != -1) {
                                        freeaddrinfo(local_b4);
                                        piVar6[7] = iVar1;
                                        goto LAB_000624f8;
                                    }
                                    close(iVar1);
                                }
                                paVar8 = paVar8->ai_next;
                            } while (paVar8 != (addrinfo *)0x0);
                            freeaddrinfo(local_b4);
                            piVar6[7] = -1;
                        }
                        goto LAB_0006251c;
                    }
                }
            }
            iVar7 = 0;
            piVar6[7] = -1;
        } else {
        LAB_000624f8:
            if ((ntp_syslogmask & 0x100) != 0) {
                uVar3 = FUN_0007b36c(param_2 + 0x10);
                FUN_00075d40(5, "%s serial %s open at %s bps", uVar3,
                             acStack_90, local_bc);
            }
            iVar7 = FUN_00029084(piVar6 + 2);
            if (iVar7 != 0) {
                iVar7 = 1;
            }
        }
    } else {
        uVar3 = FUN_0007b36c(param_2 + 0x10);
        FUN_00075d40(3, "%s clock device name too long", uVar3);
    }
LAB_0006251c:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar7);
    }
    return;
}

/* WARNING: Restarted to delay deadcode elimination for space: stack */

void FUN_00062768(int param_1)

{
    char cVar1;
    byte bVar2;
    short sVar3;
    undefined1 uVar4;
    ushort uVar5;
    uint __n;
    uint uVar6;
    byte *pbVar7;
    int iVar8;
    int iVar9;
    int iVar10;
    int iVar11;
    char *pcVar12;
    undefined *puVar13;
    uint uVar14;
    short sVar15;
    uint uVar16;
    uint uVar17;
    uint uVar18;
    int iVar19;
    int iVar20;
    int iVar21;
    undefined4 uVar22;
    char *pcVar23;
    byte *__s1;
    undefined4 *puVar24;
    char *pcVar25;
    bool bVar26;
    bool bVar27;
    double dVar28;
    undefined8 uVar29;
    int local_134;
    byte local_130;
    undefined4 local_128;
    undefined4 uStack_124;
    undefined *local_108;
    undefined4 uStack_104;
    undefined *local_100;
    undefined4 uStack_fc;
    undefined4 local_f4;
    char *local_f0;
    int local_ec;
    int local_e8;
    undefined *local_e4;
    undefined4 local_e0;
    uint local_dc[2];
    undefined2 local_d4;
    undefined *local_d0;
    char *local_cc;
    byte *local_c4;
    byte *local_c0;
    uint local_bc;
    undefined4 local_b8;
    byte local_b4[128];
    int local_34;

    iVar21 = *(int *)(param_1 + 4);
    puVar24 = *(undefined4 **)(iVar21 + 0x54);
    pcVar25 = (char *)*puVar24;
    local_34 = __stack_chk_guard;
    local_e8 = 0;
    local_ec = 0;
    local_dc[0] = 0;
    local_dc[1] = 0;
    local_d4 = 0;
    local_e4 = (undefined *)0x0;
    local_e0 = 0;
    __n = FUN_0004a6d4(param_1, local_b4, 0x80);
    local_b8 = 0;
    uVar17 = __n & ~((int)__n >> 0x1f);
    local_b4[uVar17] = 0;
    local_c4 = local_b4;
    local_c0 = local_b4;
    local_bc = uVar17;
    if (local_b4[0] == 0)
        goto LAB_00062818;
    if (local_b4[0] == 0x24) {
        uVar14 = (uint)local_b4[1];
        __s1 = local_b4 + 1;
        local_c4 = __s1;
        local_bc = uVar17 - 1;
        local_c0 = __s1;
        if (uVar14 - 0x41 < 0x1a) {
            uVar16 = (uint)local_b4[2];
            uVar6 = uVar16 - 0x41;
            bVar27 = 0x18 < uVar6;
            bVar26 = uVar6 == 0x19;
            if (0x19 < uVar6) {
                bVar27 = 8 < uVar16 - 0x30;
                bVar26 = uVar16 - 0x30 == 9;
            }
            pbVar7 = local_b4 + 2;
            if (!bVar27 || bVar26) {
                do {
                    uVar14 = uVar14 ^ uVar16;
                    pbVar7 = pbVar7 + 1;
                    uVar16 = (uint)*pbVar7;
                    uVar6 = uVar16 - 0x41;
                    bVar27 = 0x18 < uVar6;
                    bVar26 = uVar6 == 0x19;
                    if (0x19 < uVar6) {
                        bVar27 = 8 < uVar16 - 0x30;
                        bVar26 = uVar16 - 0x30 == 9;
                    }
                } while (!bVar27 || bVar26);
            }
            if ((uVar16 == 0x2c) && (4 < (int)pbVar7 - (int)__s1)) {
                uVar6 = (uint)pbVar7[1];
                uVar14 = uVar14 ^ 0x2c;
                pbVar7 = pbVar7 + 1;
                if (uVar6 != 0x2a && uVar6 != 0) {
                    do {
                        uVar14 = uVar14 ^ uVar6;
                        pbVar7 = pbVar7 + 1;
                        uVar6 = (uint)*pbVar7;
                    } while (uVar6 != 0x2a && uVar6 != 0);
                }
                if (uVar6 == 0) {
                    local_130 = 1;
                LAB_0006297c:
                    pbVar7 = local_b4 + 3;
                    *(int *)(pcVar25 + 0x10) = *(int *)(pcVar25 + 0x10) + 1;
                    iVar8 = strncmp((char *)pbVar7, "RMC,", 4);
                    if (iVar8 == 0) {
                        local_134 = 0;
                    } else {
                        iVar8 = strncmp((char *)pbVar7, "GGA,", 4);
                        if (iVar8 == 0) {
                            local_134 = 1;
                        } else {
                            iVar8 = strncmp((char *)pbVar7, "GLL,", 4);
                            if (iVar8 == 0) {
                                local_134 = 2;
                            } else {
                                iVar8 = strncmp((char *)pbVar7, "ZDA,", 4);
                                if (iVar8 == 0) {
                                    local_134 = 3;
                                } else {
                                    iVar8 = strncmp((char *)pbVar7, "ZDG,", 4);
                                    if (iVar8 == 0) {
                                        local_134 = 4;
                                    } else {
                                        iVar8 =
                                            strncmp((char *)__s1, "PGRMF,", 6);
                                        if (iVar8 != 0)
                                            goto LAB_00062818;
                                        local_134 = 5;
                                    }
                                }
                            }
                        }
                    }
                    uVar17 = *(uint *)(iVar21 + 0x4c);
                    if ((uVar17 & 0x80) != 0) {
                        dVar28 = ldexp((double)local_f0, -0x20);
                        pcVar23 = strchr((char *)local_b4, 0x2c);
                        local_128 = SUB84(dVar28, 0);
                        uStack_124 = (undefined4)((ulonglong)dVar28 >> 0x20);
                        FUN_00052e1c(iVar21 + 0x10, "delay %0.6f %.*s",
                                     local_128, uStack_124,
                                     (int)pcVar23 - (int)local_b4, local_b4);
                        uVar17 = *(uint *)(iVar21 + 0x4c);
                    }
                    if (((uVar17 & 0xff0f) == 0) ||
                        ((uVar17 & *(uint *)(&DAT_000aa7f8 + local_134 * 4)) !=
                         0)) {
                        if (local_130 < (byte)pcVar25[local_134 + 0x28]) {
                            FUN_00049c88(iVar21, 2);
                            *(int *)(pcVar25 + 0x1c) =
                                *(int *)(pcVar25 + 0x1c) + 1;
                            goto LAB_00062818;
                        }
                        cVar1 = *pcVar25;
                        pcVar25[local_134 + 0x28] = local_130;
                        if (local_134 != 4 && cVar1 != '\0')
                            goto LAB_000629e8;
                        switch (local_134) {
                        case 1:
                            iVar8 =
                                FUN_000620f8(local_dc, &local_e8, &local_c4, 1);
                            uVar4 = FUN_00061b74(&local_c4, 6, 0x30, 1);
                            *(undefined1 *)(puVar24 + 10) = uVar4;
                            iVar9 = FUN_00061ec0(local_dc, local_f4);
                            if ((*(byte *)(puVar24 + 0xc0) & 8) != 0) {
                                FUN_0006226c(&local_c4, 2, 4, 0xffffffff);
                            }
                            break;
                        case 2:
                            iVar8 =
                                FUN_000620f8(local_dc, &local_e8, &local_c4, 5);
                            uVar4 = FUN_00061b74(&local_c4, 6, 0x41, 0);
                            *(undefined1 *)(puVar24 + 10) = uVar4;
                            iVar9 = FUN_00061ec0(local_dc, local_f4);
                            if ((*(byte *)(puVar24 + 0xc0) & 8) != 0) {
                                FUN_0006226c(&local_c4, 1, 3, 0xffffffff);
                            }
                            break;
                        case 3:
                            *(undefined1 *)(puVar24 + 10) = 0;
                            iVar8 =
                                FUN_000620f8(local_dc, &local_e8, &local_c4, 1);
                            iVar9 = FUN_00061f80(local_dc, &local_c4, 2, 1);
                            break;
                        case 4:
                            iVar8 =
                                FUN_000620f8(local_dc, &local_e8, &local_c4, 1);
                            iVar9 = FUN_00061f80(local_dc, &local_c4, 2, 1);
                            uVar4 = FUN_00061b74(&local_c4, 4, 0x30, 1);
                            local_ec = -1;
                            *(undefined1 *)(puVar24 + 10) = uVar4;
                            break;
                        case 5:
                            if (local_b8 < 2) {
                                if (local_b8 != 1)
                                    goto LAB_00063094;
                            } else {
                                local_c0 = local_c4;
                                local_b8 = 0;
                            LAB_00063094:
                                bVar2 = *local_c0;
                                while (bVar2 != 0) {
                                    local_c0 = local_c0 + 1;
                                    if (bVar2 == 0x2c) {
                                        local_b8 = local_b8 + 1;
                                    }
                                    if (local_b8 == 1)
                                        break;
                                    bVar2 = *local_c0;
                                }
                            }
                            iVar8 = sscanf((char *)local_c0, "%hu", &local_e0);
                            if (local_b8 < 3) {
                                if (local_b8 != 2)
                                    goto LAB_00063100;
                            } else {
                                local_c0 = local_c4;
                                local_b8 = 0;
                            LAB_00063100:
                                bVar2 = *local_c0;
                                while (bVar2 != 0) {
                                    local_c0 = local_c0 + 1;
                                    if (bVar2 == 0x2c) {
                                        local_b8 = local_b8 + 1;
                                    }
                                    if (local_b8 == 2)
                                        break;
                                    bVar2 = *local_c0;
                                }
                            }
                            iVar9 = sscanf((char *)local_c0, "%lu", &local_d0);
                            if (local_b8 < 6) {
                                if (local_b8 != 5)
                                    goto LAB_0006316c;
                            } else {
                                local_c0 = local_c4;
                                local_b8 = 0;
                            LAB_0006316c:
                                bVar2 = *local_c0;
                                while (bVar2 != 0) {
                                    local_c0 = local_c0 + 1;
                                    if (bVar2 == 0x2c) {
                                        local_b8 = local_b8 + 1;
                                    }
                                    if (4 < local_b8)
                                        break;
                                    bVar2 = *local_c0;
                                }
                            }
                            iVar11 = sscanf((char *)local_c0, "%hd",
                                            (int)&local_e0 + 2);
                            if (((iVar8 + iVar9 + iVar11 == 3) &&
                                 ((ushort)local_e0 < 0x400)) &&
                                (local_d0 <= &UNK_00093a7f)) {
                                local_e4 = local_d0;
                                iVar8 = FUN_00061f80(local_dc, &local_c4, 3, 0);
                                if (iVar8 == 0) {
                                    iVar8 = FUN_000620f8(local_dc, &local_e8,
                                                         &local_c4, 4);
                                    uVar4 =
                                        FUN_00061b74(&local_c4, 0xb, 0x30, 1);
                                    *(undefined1 *)(puVar24 + 10) = uVar4;
                                    iVar9 = 0;
                                } else {
                                    iVar8 = FUN_000620f8(local_dc, &local_e8,
                                                         &local_c4, 4);
                                    uVar4 =
                                        FUN_00061b74(&local_c4, 0xb, 0x30, 1);
                                    *(undefined1 *)(puVar24 + 10) = uVar4;
                                    iVar11 = FUN_000775b8(local_dc);
                                    uVar17 = local_dc[0] & 0xffff;
                                    iVar10 = 5;
                                    uVar5 = *(ushort *)(pcVar25 + 2);
                                    iVar9 = iVar11 + local_e0._2_2_ >> 0x1f;
                                    if (0x1517f < iVar11 + local_e0._2_2_) {
                                        iVar9 = iVar9 + 1;
                                    }
                                    do {
                                        if (uVar5 - 0x13 < 5) {
                                            sVar15 = uVar5 * 100;
                                        } else {
                                            pcVar25[2] = '\x13';
                                            pcVar25[3] = '\0';
                                            sVar15 = 0x76c;
                                        }
                                        sVar3 = (short)(uVar17 % 100);
                                        local_dc[0] = CONCAT22(
                                            local_dc[0]._2_2_, sVar15 + sVar3);
                                        iVar11 = FUN_00077430(local_dc);
                                        iVar11 = iVar9 + iVar11 + -0xb0783;
                                        if ((-1 < iVar11) &&
                                            ((local_e0 & 0xffff) ==
                                             (iVar11 / 7 & 0x3ffU))) {
                                            iVar9 = 1;
                                            goto LAB_0006320c;
                                        }
                                        iVar10 = iVar10 + -1;
                                        uVar5 = *(short *)(pcVar25 + 2) + 1;
                                        *(ushort *)(pcVar25 + 2) = uVar5;
                                    } while (iVar10 != 0);
                                    local_dc[0] =
                                        CONCAT22(local_dc[0]._2_2_, sVar3);
                                    iVar9 = 0;
                                }
                            } else {
                                iVar9 = 0;
                                iVar8 = FUN_000620f8(local_dc, &local_e8,
                                                     &local_c4, 4);
                                uVar4 = FUN_00061b74(&local_c4, 0xb, 0x30, 1);
                                *(undefined1 *)(puVar24 + 10) = uVar4;
                            }
                        LAB_0006320c:
                            if ((*(byte *)(puVar24 + 0xc0) & 8) != 0) {
                                FUN_0006226c(&local_c4, 6, 8, 0xffffffff);
                            }
                            break;
                        default:
                            iVar8 =
                                FUN_000620f8(local_dc, &local_e8, &local_c4, 1);
                            uVar4 = FUN_00061b74(&local_c4, 2, 0x41, 0);
                            *(undefined1 *)(puVar24 + 10) = uVar4;
                            iVar9 = FUN_00061f80(local_dc, &local_c4, 9, 0);
                            if (iVar9 == 0) {
                                iVar9 = 0;
                            } else {
                                FUN_00077758(&local_d0, local_f4, 0);
                                iVar9 = ((uint)local_d0 & 0xffff) - 0x14;
                                if (iVar9 < DAT_000ce60c) {
                                    iVar9 = DAT_000ce60c;
                                }
                                uVar5 = FUN_000767f8(iVar9,
                                                     local_dc[0] & 0xffff, 100);
                                local_dc[0] =
                                    CONCAT22(local_dc[0]._2_2_, uVar5);
                                if (((int)(uint)uVar5 < iVar9) ||
                                    (iVar9 + 99 < (int)(uint)uVar5)) {
                                    iVar9 = 0;
                                } else {
                                    iVar9 = 1;
                                }
                            }
                            if ((*(byte *)(puVar24 + 0xc0) & 8) != 0) {
                                FUN_0006226c(&local_c4, 3, 4, 5, 6, 0xffffffff);
                            }
                        }
                        if (iVar8 == 0) {
                            uVar22 = 6;
                            *(int *)(pcVar25 + 0x1c) =
                                *(int *)(pcVar25 + 0x1c) + 1;
                        } else if (iVar9 == 0) {
                            uVar22 = 5;
                            *(int *)(pcVar25 + 0x1c) =
                                *(int *)(pcVar25 + 0x1c) + 1;
                        } else {
                            if (*(char *)(puVar24 + 10) != '\x03') {
                                if (local_134 == 4 && *pcVar25 == '\0') {
                                    uVar22 = FUN_0007b36c(iVar21 + 0x10);
                                    FUN_00075d40(
                                        6,
                                        "%s using GPS time as if it were UTC",
                                        uVar22);
                                    *pcVar25 = '\x01';
                                }
                                iVar19 = **(int **)(iVar21 + 0x54);
                                iVar10 = FUN_000775b8(local_dc);
                                iVar9 = FUN_00077430(local_dc);
                                iVar9 = iVar9 + -0xa955c;
                                iVar8 = local_ec;
                                iVar11 = local_e8;
                                if (local_e8 < 0) {
                                    do {
                                        iVar8 = iVar8 + -1;
                                        iVar11 = iVar11 + 1000000000;
                                    } while (iVar11 < 0);
                                } else if (999999999 < local_e8) {
                                    iVar11 = local_e8 + -1000000000;
                                    if (iVar11 < 1000000000) {
                                        iVar20 = local_e8;
                                        iVar8 = local_ec + 1;
                                    } else {
                                        iVar20 = local_e8 + -0x77360000;
                                    }
                                    if (iVar11 != 999999999 &&
                                        local_e8 + -1999999999 < 0 ==
                                            SBORROW4(iVar11, 999999999)) {
                                        iVar8 = iVar8 + 2;
                                        iVar11 = iVar20 + 0x6c00;
                                    }
                                }
                                pcVar23 = (char *)(iVar10 + iVar8);
                                uVar29 = VectorShiftRight(
                                    CONCAT44(iVar11, iVar11), 0x20);
                                uVar29 = VectorShiftLeft(uVar29, 0x20, 0x40, 0);
                                pcVar12 = (char *)FUN_0009d518(
                                    (uint)uVar29 + 500000000,
                                    (int)((ulonglong)uVar29 >> 0x20) +
                                        (uint)(0xe2329aff < (uint)uVar29),
                                    1000000000, 0);
                                if ((*(uint *)(iVar21 + 0x4c) & 0x2000000) ==
                                    0) {
                                    if ((int)pcVar23 < 0x15180) {
                                        for (; (int)pcVar23 < 0;
                                             pcVar23 = "mru_initalloc" +
                                                       (int)(pcVar23 + 0xd)) {
                                            iVar9 = iVar9 + -1;
                                        }
                                    } else {
                                        do {
                                            iVar9 = iVar9 + 1;
                                            pcVar23 = pcVar23 + -0x15180;
                                        } while (0x1517f < (int)pcVar23);
                                    }
                                    FUN_0007694c(&local_108, local_f4, 0);
                                    local_100 = local_108;
                                    uStack_fc = uStack_104;
                                    FUN_00076a00(&local_d0, &local_100);
                                    puVar13 = local_d0 + -0xe00;
                                    if (((int)pcVar23 < (int)local_cc) ||
                                        ((pcVar23 == local_cc &&
                                          (pcVar12 < local_f0)))) {
                                        puVar13 = local_d0 + -0xdff;
                                    }
                                    if ((int)puVar13 < (int)DAT_000ce608) {
                                        puVar13 = DAT_000ce608;
                                    }
                                    iVar11 =
                                        FUN_000767f8(puVar13, iVar9, 0x1c00);
                                    iVar8 = (iVar11 - iVar9) / 7;
                                    if ((iVar8 != *(short *)(iVar19 + 0xc)) &&
                                        (*(short *)(iVar19 + 0xc) =
                                             (short)iVar8,
                                         (ntp_syslogmask & 0x100) != 0)) {
                                        uVar22 = FUN_0007b36c(iVar21 + 0x10);
                                        FUN_00075d40(6,
                                                     "%s Changed GPS epoch "
                                                     "warp to %d weeks",
                                                     uVar22, iVar8);
                                    }
                                    FUN_0007702c(&local_108, iVar11, pcVar23);
                                } else {
                                    FUN_0007702c(&local_108, iVar9, pcVar23);
                                }
                                if ((*(undefined **)(pcVar25 + 4) !=
                                     local_108) ||
                                    (*(char **)(pcVar25 + 8) != pcVar12)) {
                                    if (0x7e < __n) {
                                        __n = 0x7f;
                                    }
                                    *(undefined **)(pcVar25 + 4) = local_108;
                                    *(char **)(pcVar25 + 8) = pcVar12;
                                    uVar29 = *(undefined8 *)(puVar24 + 0xbc);
                                    *(int *)(pcVar25 + 0x14) =
                                        *(int *)(pcVar25 + 0x14) + 1;
                                    puVar24[0x2e] = __n;
                                    memcpy(puVar24 + 0xe, local_b4, __n);
                                    *(undefined1 *)((int)puVar24 + __n + 0x38) =
                                        0;
                                    puVar24[0x3a] = local_f4;
                                    puVar24[0x3b] = local_f0;
                                    local_d0 = local_108;
                                    local_cc = pcVar12;
                                    FUN_0004a258((int)uVar29, puVar24,
                                                 local_108, pcVar12, local_f4,
                                                 local_f0);
                                    goto LAB_00062818;
                                }
                                goto LAB_000629e8;
                            }
                            uVar22 = 2;
                            *(int *)(pcVar25 + 0x18) =
                                *(int *)(pcVar25 + 0x18) + 1;
                        }
                        if (0x7e < __n) {
                            __n = 0x7f;
                        }
                        puVar24[0x2e] = __n;
                        memcpy(puVar24 + 0xe, local_b4, __n);
                        *(undefined1 *)((int)puVar24 + __n + 0x38) = 0;
                        FUN_00049c88(iVar21, uVar22);
                    } else {
                    LAB_000629e8:
                        *(int *)(pcVar25 + 0x20) = *(int *)(pcVar25 + 0x20) + 1;
                    }
                    goto LAB_00062818;
                }
                if (((uVar6 == 0x2a) && (pbVar7 == local_b4 + (uVar17 - 3))) &&
                    ((int)pbVar7 - (int)__s1 < 0x50)) {
                    uVar6 = (uint)pbVar7[1];
                    pbVar7 = local_b4 + (uVar17 - 2);
                    if (uVar6 == 0) {
                        uVar16 = 0;
                    } else {
                        uVar16 = 0;
                        do {
                            uVar18 = uVar6 - 0x30 & 0xff;
                            if (9 < uVar18) {
                                if (5 < uVar6 - 0x41)
                                    break;
                                uVar18 = uVar6 - 0x37;
                            }
                            pbVar7 = pbVar7 + 1;
                            uVar6 = (uint)*pbVar7;
                            uVar16 = uVar18 + uVar16 * 0x10 & 0xff;
                        } while (uVar6 != 0);
                    }
                    if (local_b4 + uVar17 == pbVar7 && uVar14 == uVar16) {
                        local_130 = 2;
                        goto LAB_0006297c;
                    }
                }
            }
        }
    }
    local_c4 = local_c0;
    FUN_00049c88(iVar21, 2);
LAB_00062818:
    if (local_34 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00063660(short *param_1, int param_2)

{
    short sVar1;
    int iVar2;

    iVar2 = __stack_chk_guard;
    sVar1 = *param_1;
    *param_1 = sVar1 + 1;
    *(undefined1 *)(*(int *)(param_1 + 2) + (int)sVar1) = 0x10;
    sVar1 = *param_1;
    *param_1 = sVar1 + 1;
    *(undefined1 *)(*(int *)(param_1 + 2) + (int)sVar1) = 3;
    if (iVar2 == __stack_chk_guard) {
        write(param_2, *(void **)(param_1 + 2), (int)*param_1);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00063770(uint *param_1, uint *param_2, byte *param_3)

{
    int iVar1;
    uint uVar2;
    ushort local_30;
    ushort local_2e;
    byte local_2c;
    byte local_2b;
    int local_24;

    local_24 = __stack_chk_guard;
    if (DAT_000ce610 == 0) {
        iVar1 = FUN_000766bc(&local_30);
        if (iVar1 == 0) {
            local_2c = 1;
            local_30 = 0x7df;
            local_2b = local_2c;
        }
        DAT_000ce610 = FUN_00077430(&local_30);
    }
    local_2c = param_3[1];
    local_2b = *param_3;
    local_30 = CONCAT11(param_3[2], param_3[3]);
    iVar1 = FUN_00077430(&local_30);
    FUN_00076c70(&local_30, iVar1);
    if (((local_2b == *param_3) && (local_2c == param_3[1])) &&
        (local_30 == CONCAT11(param_3[2], param_3[3]))) {
        for (; iVar1 < DAT_000ce610; iVar1 = iVar1 + 0x1c00) {
        }
        FUN_00076c70(&local_30, iVar1);
        uVar2 = (uint)local_2b | (uint)local_2c << 5;
        *param_2 = (uint)local_2e;
        *param_1 = (uint)local_30;
    } else {
        uVar2 = 0xffffffff;
    }
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2);
    }
    return;
}

void FUN_00063ce4(int param_1)

{
    char cVar1;
    int iVar2;
    int iVar3;
    undefined4 extraout_r1;
    undefined4 extraout_r1_00;
    undefined4 extraout_r1_01;
    int extraout_r1_02;
    undefined1 uVar4;
    uint uVar5;
    int *piVar6;
    int iVar7;
    byte bVar8;
    uint uVar9;
    bool bVar10;
    bool bVar11;
    double dVar12;

    iVar2 = __stack_chk_guard;
    piVar6 = *(int **)(param_1 + 0x54);
    iVar7 = *piVar6;
    iVar3 = *(int *)(iVar7 + 0x8c);
    cVar1 = *(char *)(iVar7 + 0xc);
    if ((iVar3 - 2U < 2) ||
        (cVar1 != 'm' &&
         (cVar1 != 'K' && (cVar1 != 'T' && (cVar1 != 'A' && cVar1 != 'F'))))) {
        if (cVar1 == -0x71) {
            if (((uint)(*(ushort *)(iVar7 + 0xe) >> 8 == 0 &&
                        (*(ushort *)(iVar7 + 0xe) & 0xff) == 0) &
                 (*(byte *)(piVar6 + 0xc0) ^ 2) >> 1) == 0) {
                bVar8 = *(byte *)(iVar7 + 0xd);
                if (bVar8 == 0xab) {
                    if (*(short *)(iVar7 + 10) == 0x11) {
                        if (*(int *)(iVar7 + 4) < 1)
                            goto LAB_00063de0;
                        if (*(ushort *)(iVar7 + 0x14) >> 8 != 0 ||
                            (*(ushort *)(iVar7 + 0x14) & 0xff) != 0) {
                            bVar8 = *(byte *)(iVar7 + 0x16) & 0x1d;
                            if ((*(byte *)(iVar7 + 0x16) & 0x1d) == 0) {
                                *(undefined1 *)(piVar6 + 10) = 3;
                                FUN_00049c88(param_1, 6);
                                *(undefined4 *)(iVar7 + 4) = 0xffffffff;
                                goto LAB_00063de4;
                            }
                            piVar6[0x34] = 0;
                            iVar3 = FUN_00063770(piVar6 + 0x2f, piVar6 + 0x30,
                                                 iVar7 + 0x1a);
                            if (-1 < iVar3) {
                                bVar8 = 1;
                                piVar6[0x31] = (uint) * (byte *)(iVar7 + 0x19);
                                piVar6[0x32] = (uint) * (byte *)(iVar7 + 0x18);
                                piVar6[0x33] = (uint) * (byte *)(iVar7 + 0x17);
                                goto LAB_00063de4;
                            }
                        }
                    }
                    goto LAB_00063db8;
                }
                if (bVar8 < 0xac) {
                    if ((bVar8 == 0xb) && (0 < *(int *)(iVar7 + 4))) {
                        if ((*(short *)(iVar7 + 10) == 0x4a) &&
                            (*(ushort *)(iVar7 + 0x1d) >> 8 != 0 ||
                             (*(ushort *)(iVar7 + 0x1d) & 0xff) != 0)) {
                            uVar9 = *(uint *)(iVar7 + 0x14);
                            uVar5 = *(uint *)(iVar7 + 0x10);
                            dVar12 = (double)CONCAT44(
                                uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                                    (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18,
                                uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10 |
                                    (uVar9 >> 0x10 & 0xff) << 8 |
                                    uVar9 >> 0x18);
                            iVar3 = (int)(longlong)dVar12;
                            piVar6[0x34] =
                                (int)(longlong)((dVar12 -
                                                 (double)(longlong)iVar3) *
                                                1000000000.0);
                            FUN_0009d0ec(iVar3, "");
                            iVar3 = FUN_0009ce58(extraout_r1, 0xe10);
                            piVar6[0x31] = iVar3;
                            FUN_0009d0ec(extraout_r1, 0xe10);
                            iVar3 = FUN_0009ce58(extraout_r1_00, 0x3c);
                            piVar6[0x32] = iVar3;
                            FUN_0009d0ec(extraout_r1_00, 0x3c);
                            FUN_0009d0ec(extraout_r1_01, 0x3c);
                            piVar6[0x33] = extraout_r1_02;
                            iVar3 = FUN_00063770(piVar6 + 0x2f, piVar6 + 0x30,
                                                 iVar7 + 0x18);
                            if (-1 < iVar3) {
                                if (*(char *)(iVar7 + 8) == '\0') {
                                    bVar8 = 2;
                                } else {
                                    bVar8 = 0;
                                    *(undefined1 *)(iVar7 + 8) = 0;
                                }
                                goto LAB_00063de4;
                            }
                        }
                        goto LAB_00063db8;
                    }
                } else if (bVar8 == 0xac) {
                    if (0 < *(int *)(iVar7 + 4)) {
                        if (*(short *)(iVar7 + 10) == 0x44) {
                            if ((*(short *)(iVar7 + 0x17) < 0) &&
                                (*(int *)(iVar7 + 0x90) == 6 ||
                                 *(int *)(iVar7 + 0x90) == 0xc)) {
                                *(undefined1 *)(piVar6 + 10) = 1;
                                bVar8 = 0;
                            } else {
                                bVar8 = 0;
                                *(undefined1 *)(piVar6 + 10) = 0;
                            }
                            goto LAB_00063de4;
                        }
                        goto LAB_00063db8;
                    }
                } else if (bVar8 == 0xad) {
                    if (*(short *)(iVar7 + 10) != 0x16)
                        goto LAB_00063db8;
                    *(undefined1 *)(iVar7 + 8) = *(undefined1 *)(iVar7 + 0x20);
                    if (*(int *)(iVar7 + 4) < 1)
                        goto LAB_00063de0;
                    uVar5 = (uint) * (byte *)(iVar7 + 0x1f);
                    if (uVar5 < 0xf) {
                        bVar11 = uVar5 != 0xb;
                        bVar10 = uVar5 - 0xb == 1;
                        if (1 < uVar5 - 0xb) {
                            bVar11 = 4 < uVar5 - 2;
                            bVar10 = uVar5 - 2 == 5;
                        }
                        if (!bVar11 || bVar10) {
                            FUN_00049c88(param_1, 6);
                            bVar8 = 0;
                            *(undefined4 *)(iVar7 + 4) = 0xffffffff;
                            goto LAB_00063de4;
                        }
                    }
                    iVar3 = FUN_00063770(piVar6 + 0x2f, piVar6 + 0x30,
                                         iVar7 + 0x1b);
                    if (iVar3 < 0)
                        goto LAB_00063db8;
                    bVar8 = *(byte *)(iVar7 + 8);
                    iVar3 = iVar3 >> 5;
                    *(int *)(iVar7 + 0x90) = iVar3;
                    if ((bVar8 & 2) == 0) {
                        if (bVar8 == 0) {
                            *(undefined1 *)(piVar6 + 10) = 3;
                            FUN_00049c88(param_1, 6);
                            *(undefined4 *)(iVar7 + 4) = 0xffffffff;
                            bVar8 = 0;
                            goto LAB_00063de4;
                        }
                    LAB_00064164:
                        *(undefined1 *)(piVar6 + 10) = 0;
                    } else {
                        if (iVar3 != 6 && iVar3 != 0xc)
                            goto LAB_00064164;
                        if ((bVar8 & 1) == 0) {
                            uVar4 = 2;
                        } else {
                            uVar4 = 1;
                        }
                        *(undefined1 *)(piVar6 + 10) = uVar4;
                    }
                    uVar5 = *(uint *)(iVar7 + 0x10);
                    bVar8 = 1;
                    uVar9 = *(uint *)(iVar7 + 0x14);
                    piVar6[0x34] =
                        (int)(longlong)((double)CONCAT44(
                                            uVar5 << 0x18 |
                                                (uVar5 >> 8 & 0xff) << 0x10 |
                                                (uVar5 >> 0x10 & 0xff) << 8 |
                                                uVar5 >> 0x18,
                                            uVar9 << 0x18 |
                                                (uVar9 >> 8 & 0xff) << 0x10 |
                                                (uVar9 >> 0x10 & 0xff) << 8 |
                                                uVar9 >> 0x18) *
                                        1000000000.0);
                    piVar6[0x31] = (uint) * (byte *)(iVar7 + 0x18);
                    piVar6[0x32] = (uint) * (byte *)(iVar7 + 0x19);
                    piVar6[0x33] = (uint) * (byte *)(iVar7 + 0x1a);
                    goto LAB_00063de4;
                }
            }
        } else if (cVar1 == 'B') {
            puts("0x42");
        } else {
            if (cVar1 == 'C') {
                puts("0x43");
                bVar8 = 0;
                goto LAB_00063de4;
            }
            if (iVar3 == 2 && cVar1 == 'A') {
                puts("Undocumented 0x41 packet on Thunderbolt");
                bVar8 = 0;
                goto LAB_00063de4;
            }
            if (cVar1 != 'A' || iVar3 != 3) {
                if (cVar1 == 'F' && iVar3 == 3) {
                    if (*(char *)(iVar7 + 0xe) != '\0') {
                        FUN_00049c88(param_1, 6);
                        *(undefined4 *)(iVar7 + 4) = 0xffffffff;
                        bVar8 = 0;
                        goto LAB_00063de4;
                    }
                } else if (cVar1 == 'm' || cVar1 == 'T')
                    goto LAB_00063de0;
            LAB_00063db8:
                FUN_00049c88(param_1, 2);
                bVar8 = 0;
                *(undefined4 *)(iVar7 + 4) = 0xffffffff;
                goto LAB_00063de4;
            }
        }
    }
LAB_00063de0:
    bVar8 = 0;
LAB_00063de4:
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(bVar8);
    }
    return;
}

void FUN_000641e4(undefined4 *param_1)

{
    int iVar1;
    undefined4 uVar2;
    short *psVar3;
    uint local_20;
    int local_1c;

    psVar3 = (short *)*param_1;
    local_1c = __stack_chk_guard;
    iVar1 = ioctl(param_1[7], 0x5415, &local_20);
    if (iVar1 < 0) {
        FUN_00075d40(3, "Palisade(%d) HW_poll: ioctl(fd,GET): %m",
                     (int)*psVar3);
        uVar2 = 0xffffffff;
    } else {
        local_20 = local_20 | 4;
        if (*(int *)(psVar3 + 0x46) == 3) {
            write(param_1[7], &DAT_000a9528, 1);
        }
        iVar1 = ioctl(param_1[7], 0x5418, &local_20);
        if (iVar1 < 0) {
            FUN_00075d40(3, "Palisade(%d) HW_poll: ioctl(fd, SET, RTS_on): %m",
                         (int)*psVar3);
            uVar2 = 0xffffffff;
        } else {
            local_20 = local_20 & 0xfffffffb;
            FUN_0007055c(param_1 + 0x3a);
            iVar1 = ioctl(param_1[7], 0x5418, &local_20);
            if (iVar1 == -1) {
                FUN_00075d40(
                    3, "Palisade(%d) HW_poll: ioctl(fd, UNSET, RTS_off): %m",
                    (int)*psVar3);
                uVar2 = 0xffffffff;
            } else {
                uVar2 = 0;
            }
        }
    }
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2);
    }
    return;
}

void FUN_0006432c(undefined4 param_1, int param_2)

{
    int iVar1;
    ssize_t sVar2;
    int iVar3;
    int *piVar4;
    int iVar5;

    piVar4 = *(int **)(param_2 + 0x54);
    iVar5 = *piVar4;
    iVar3 = *(int *)(iVar5 + 4);
    piVar4[0xc2] = piVar4[0xc2] + 1;
    iVar1 = __stack_chk_guard;
    if (0 < iVar3) {
        FUN_00049c88(param_2, 1);
    }
    *(undefined4 *)(iVar5 + 4) = 2;
    if ((*(byte *)(piVar4 + 0xc0) & 2) == 0) {
        if (*(int *)(iVar5 + 0x8c) == 1) {
            sVar2 = write(*(int *)(*(int *)(param_2 + 0x54) + 0x1c),
                          "SPSTAT\r\n", 8);
            if (-1 < sVar2) {
                praecis_msg = 1;
                goto LAB_000643b0;
            }
            FUN_00075d40(3, "Palisade(%d) write: %m:", param_1);
        }
        iVar3 = FUN_000641e4(piVar4);
        if (iVar3 < 0) {
            if (iVar1 == __stack_chk_guard) {
                FUN_00049c88(param_2, 3);
                return;
            }
            goto LAB_00064434;
        }
    }
LAB_000643b0:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_00064434:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0006444c(int param_1)

{
    char cVar1;
    short sVar2;
    int iVar3;
    int iVar4;
    int iVar5;
    uint uVar6;
    int iVar7;
    int iVar8;
    byte *pbVar9;
    byte *pbVar10;
    byte *pbVar11;
    int *piVar12;
    int *piVar13;
    bool bVar14;

    iVar3 = __stack_chk_guard;
    iVar4 = DAT_000ce614;
    iVar5 = *(int *)(param_1 + 4);
    piVar13 = *(int **)(iVar5 + 0x54);
    iVar8 = *piVar13;
    if ((*(int *)(iVar8 + 0x8c) == 1) && (praecis_msg != 0)) {
        memcpy(&DAT_000ce618 + DAT_000ce614, (void *)(param_1 + 0x58),
               *(size_t *)(param_1 + 0x54));
        DAT_000ce614 = iVar4 + *(int *)(param_1 + 0x54);
        if ((*(char *)((int)&DAT_000ce614 + DAT_000ce614 + 2) == '\r') &&
            (*(char *)((int)&DAT_000ce614 + DAT_000ce614 + 3) == '\n')) {
            *(undefined1 *)((int)&DAT_000ce614 + DAT_000ce614 + 2) = 0;
            FUN_00052d0c(iVar5 + 0x10, &DAT_000ce618);
            DAT_000ce614 = 0;
            praecis_msg = 0;
            iVar4 = FUN_000641e4(piVar13);
            if (iVar4 < 0) {
                if (iVar3 == __stack_chk_guard) {
                    FUN_00049c88(iVar5, 3);
                    return;
                }
                goto LAB_000647a4;
            }
        }
    } else {
        pbVar9 = (byte *)(param_1 + 0x58);
        pbVar11 = pbVar9 + *(int *)(param_1 + 0x54);
        if (pbVar9 != pbVar11) {
            pbVar10 = (byte *)(param_1 + 0x59);
            do {
                while (cVar1 = *(char *)(iVar8 + 9), cVar1 != '\x03') {
                    if (cVar1 == '\x04') {
                        if (*pbVar9 == 0x10) {
                            sVar2 = *(short *)(iVar8 + 10);
                            *(undefined1 *)(iVar8 + 9) = 3;
                            goto LAB_0006451c;
                        }
                        if (*pbVar9 != 3) {
                            *(undefined1 *)(iVar8 + 9) = 2;
                            *(byte *)(iVar8 + 0xc) = *pbVar9;
                            goto LAB_00064698;
                        }
                        *(undefined1 *)(iVar8 + 9) = 1;
                        goto LAB_00064530;
                    }
                    uVar6 = (uint)*pbVar9;
                    if (cVar1 != '\x02') {
                        if (uVar6 != 0x10)
                            goto LAB_000644dc;
                        *(undefined1 *)(iVar8 + 9) = 2;
                    LAB_00064698:
                        *(undefined2 *)(iVar8 + 10) = 0;
                        if ((*(byte *)(piVar13 + 0xc0) & 2) == 0)
                            goto LAB_00064544;
                        FUN_0007055c(piVar13 + 0x3a);
                        cVar1 = *(char *)(iVar8 + 9);
                        goto LAB_00064548;
                    }
                    if ((0x10 < uVar6) || ((1 << uVar6 & 0x10009U) == 0)) {
                        *(undefined1 *)(iVar8 + 9) = 3;
                        *(byte *)(iVar8 + 0xc) = *pbVar9;
                        goto LAB_00064530;
                    }
                LAB_000644dc:
                    *(undefined1 *)(iVar8 + 9) = 0;
                    *(undefined2 *)(iVar8 + 10) = 0;
                LAB_000644e8:
                    bVar14 = pbVar11 == pbVar10;
                    pbVar10 = pbVar10 + 1;
                    pbVar9 = pbVar9 + 1;
                    if (bVar14)
                        goto LAB_0006461c;
                }
                if (*pbVar9 == 0x10) {
                    *(undefined1 *)(iVar8 + 9) = 4;
                } else {
                    sVar2 = *(short *)(iVar8 + 10);
                LAB_0006451c:
                    *(short *)(iVar8 + 10) = sVar2 + 1;
                    *(byte *)(iVar8 + sVar2 + 0xd) = *pbVar9;
                }
            LAB_00064530:
                if (0x80 < *(short *)(iVar8 + 10)) {
                    *(undefined1 *)(iVar8 + 9) = 0;
                    goto LAB_000644e8;
                }
            LAB_00064544:
                cVar1 = *(char *)(iVar8 + 9);
            LAB_00064548:
                if (cVar1 != '\x01')
                    goto LAB_000644e8;
                piVar12 = *(int **)(iVar5 + 0x54);
                iVar7 = *piVar12;
                iVar4 = FUN_00063ce4(iVar5);
                if ((iVar4 == 0) || (*(int *)(iVar7 + 4) < 1))
                    goto LAB_000644e8;
                iVar4 = piVar12[0x34];
                *(undefined4 *)(iVar7 + 4) = 0;
                piVar12[0x2e] = 0;
                FUN_0007d00c(piVar12 + 0xe, 0x80,
                             "%4d %03d %02d:%02d:%02d.%09ld", piVar12[0x2f],
                             piVar12[0x30], piVar12[0x31], piVar12[0x32],
                             piVar12[0x33], iVar4);
                piVar12[0x2e] = 0x18;
                iVar4 = FUN_0004a4e8(piVar12);
                if (iVar4 == 0) {
                    FUN_00049c88(iVar5, 6);
                    goto LAB_000644e8;
                }
                pbVar9 = pbVar9 + 1;
                FUN_00052d0c(iVar5 + 0x10, piVar12 + 0xe);
                piVar12[0x38] = piVar12[0x3a];
                piVar12[0x39] = piVar12[0x3b];
                FUN_0004a534(iVar5);
                bVar14 = pbVar11 != pbVar10;
                pbVar10 = pbVar10 + 1;
            } while (bVar14);
        }
    }
LAB_0006461c:
    if (iVar3 == __stack_chk_guard) {
        return;
    }
LAB_000647a4:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00064e4c(int param_1)

{
    int iVar1;
    undefined4 *puVar2;
    undefined4 uVar3;
    int iVar4;
    undefined4 *puVar5;
    int *piVar6;
    undefined4 *puVar7;
    int iVar8;
    undefined1 uStack_46;
    undefined1 uStack_45;
    uint local_44;
    undefined4 local_40;
    undefined4 uStack_3c;
    undefined1 auStack_38[12];
    undefined1 auStack_2c[9];
    byte local_23;
    char local_20;
    int local_1c;

    iVar8 = *(int *)(param_1 + 4);
    puVar7 = *(undefined4 **)(iVar8 + 0x54);
    piVar6 = (int *)*puVar7;
    local_1c = __stack_chk_guard;
    iVar1 = FUN_0004a6d4(param_1, piVar6[1], (int)puVar7 + (0xb6 - piVar6[1]),
                         &local_40);
    iVar4 = piVar6[1];
    piVar6[1] = iVar4 + iVar1 + 1;
    *(undefined1 *)(iVar4 + iVar1) = 0x20;
    *(undefined1 *)piVar6[1] = 0;
    if (*piVar6 == 0) {
        iVar1 = piVar6[1];
        puVar7[0x3a] = local_40;
        puVar7[0x3b] = uStack_3c;
        *piVar6 = 1;
        puVar7[0x2e] = iVar1 - (int)(puVar7 + 0xe);
    } else {
        iVar1 = *piVar6 + 1;
        *piVar6 = iVar1;
        iVar4 = piVar6[1] - (int)(puVar7 + 0xe);
        puVar7[0x2e] = iVar4;
        if (2 < iVar1) {
            if ((iVar4 < 0x2e) ||
                (iVar1 =
                     sscanf((char *)(puVar7 + 0xe),
                            "%c%2d:%2d:%2d.%3ld%c %9s%3d%13s%4ld", &uStack_46,
                            puVar7 + 0x31, puVar7 + 0x32, puVar7 + 0x33,
                            puVar7 + 0x34, &uStack_45, auStack_38,
                            puVar7 + 0x30, auStack_2c, &local_44),
                 iVar1 != 10)) {
                FUN_00049c88(iVar8, 2);
            } else {
                puVar2 = (undefined4 *)puVar7[0x34];
                puVar5 = (undefined4 *)(uint)local_23;
                puVar7[0x34] = (int)puVar2 * 1000000;
                if (puVar5 != (undefined4 *)0x38) {
                    *(undefined1 *)(puVar7 + 10) = 3;
                }
                if (local_20 == 'H') {
                    puVar7[0xbf] = 0x48565757;
                } else {
                    puVar7[0xbf] = 0x565757;
                }
                if (*(byte *)(iVar8 + 0x5d) < 2) {
                    *(undefined4 *)(iVar8 + 0x70) = puVar7[0xbf];
                }
                if (local_44 == 0) {
                    puVar2 = puVar7 + 0x3a;
                    puVar5 = puVar7 + 0x38;
                }
                if (local_44 == 0) {
                    uVar3 = puVar2[1];
                    *puVar5 = *puVar2;
                    puVar5[1] = uVar3;
                }
                *(double *)(puVar7 + 0x3e) = (double)local_44 * 1e-05 * 60.0;
                iVar1 = FUN_0004a4e8(puVar7);
                if (iVar1 == 0) {
                    FUN_00049c88(iVar8, 6);
                } else if (1.5 < *(double *)(iVar8 + 0x278)) {
                    FUN_0004a534(iVar8);
                }
            }
        }
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00065098(int param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    FILE *__stream;
    int __fd;
    FILE *pFVar1;
    FILE *pFVar2;
    int iVar3;
    char acStack_4c[40];
    int local_24;
    undefined4 uStack_8;
    undefined4 uStack_4;

    iVar3 = **(int **)(param_1 + 0x54);
    __stream = *(FILE **)(iVar3 + 0x18);
    pFVar2 = (FILE *)-(
        (int)((uint) * (byte *)(*(int **)(param_1 + 0x54) + 0xc0) << 0x1e) >>
        0x1f);
    local_24 = __stack_chk_guard;
    pFVar1 = __stream;
    if (__stream != (FILE *)0x0) {
        pFVar1 = (FILE *)0x1;
    }
    uStack_8 = param_3;
    uStack_4 = param_4;
    if (pFVar2 != pFVar1) {
        if (pFVar2 == (FILE *)0x0) {
            fclose(__stream);
            *(undefined4 *)(iVar3 + 0x18) = 0;
            goto LAB_00065188;
        }
        FUN_0007d00c(acStack_4c, 0x28, "/tmp/true%d.debug",
                     *(undefined4 *)(iVar3 + 0x14));
        __fd = open64(acStack_4c, 0xc1, 0x180);
        if (-1 < __fd) {
            pFVar1 = fdopen(__fd, "w");
            *(FILE **)(iVar3 + 0x18) = pFVar1;
            if (pFVar1 != (FILE *)0x0) {
                setvbuf(pFVar1, &DAT_000ce67c, 1, 0x2000);
            }
        }
        __stream = *(FILE **)(iVar3 + 0x18);
    }
    if (__stream != (FILE *)0x0) {
        __fprintf_chk(__stream, 1, "true%d: ", *(undefined4 *)(iVar3 + 0x14));
        __vfprintf_chk(*(undefined4 *)(iVar3 + 0x18), 1, param_2, &uStack_8);
    }
LAB_00065188:
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000651d0(int param_1, char *param_2)

{
    int iVar1;
    size_t __n;
    size_t sVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = *(int *)(param_1 + 0x54);
    if ((*(byte *)(iVar3 + 0x300) & 1) == 0) {
        __n = strlen(param_2);
        FUN_00065098(param_1, "Send \'%s\'\n", param_2);
        sVar2 = write(*(int *)(iVar3 + 0x1c), param_2, __n);
        if (sVar2 != __n) {
            if (iVar1 == __stack_chk_guard) {
                FUN_00049c88(param_1, 3);
                return;
            }
            goto LAB_00065288;
        }
        *(int *)(iVar3 + 0x308) = *(int *)(iVar3 + 0x308) + 1;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_00065288:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00065298(int param_1, int *param_2)

{
    int iVar1;
    undefined *puVar2;
    char *pcVar3;
    undefined *puVar4;
    undefined *puVar5;
    int iVar6;
    int iVar7;
    int *piVar8;

    iVar1 = __stack_chk_guard;
LAB_00065300:
    piVar8 = *(int **)(param_1 + 0x54);
    iVar7 = *piVar8;
    if ((param_2 != (int *)0x9) && ((ntp_syslogmask & 0x400) != 0)) {
        puVar4 = &DAT_000aa52c;
        if (*(int *)(iVar7 + 0x10) < 6) {
            puVar4 = *(undefined **)(types + *(int *)(iVar7 + 0x10) * 4);
        }
        puVar5 = &DAT_000aa52c;
        if (*(int *)(iVar7 + 0xc) < 0xb) {
            puVar5 = *(undefined **)(states + *(int *)(iVar7 + 0xc) * 4);
        }
        puVar2 = &DAT_000aa52c;
        if ((int)param_2 < 10) {
            puVar2 = *(undefined **)(events + (int)param_2 * 4);
        }
        FUN_00075d40(6, "TRUE: clock %s, state %s, event %s", puVar4, puVar5,
                     puVar2);
    }
    puVar4 = &DAT_000aa52c;
    if (*(int *)(iVar7 + 0x10) < 6) {
        puVar4 = *(undefined **)(types + *(int *)(iVar7 + 0x10) * 4);
    }
    puVar5 = &DAT_000aa52c;
    if (*(int *)(iVar7 + 0xc) < 0xb) {
        puVar5 = *(undefined **)(states + *(int *)(iVar7 + 0xc) * 4);
    }
    if ((int)param_2 < 10) {
        puVar2 = *(undefined **)(events + (int)param_2 * 4);
    } else {
        puVar2 = &DAT_000aa52c;
    }
    FUN_00065098(param_1, "clock %s, state %s, event %s\n", puVar4, puVar5,
                 puVar2);
    switch (*(undefined4 *)(iVar7 + 0x10)) {
    case 0:
        if (param_2 == (int *)0x7)
            break;
        iVar6 = *(int *)(iVar7 + 0xc);
        switch (iVar6) {
        case 0:
            if (param_2 != (int *)0x0)
                goto switchD_00065780_default;
            FUN_000651d0(param_1, &DAT_000aad64);
            *(undefined4 *)(iVar7 + 0xc) = 4;
            goto switchD_0006550c_default;
        case 1:
            if (param_2 < (int *)0x2) {
                FUN_000651d0(param_1, &DAT_000aad98);
                *(undefined4 *)(iVar7 + 0xc) = 2;
                goto switchD_0006550c_default;
            }
            if (param_2 == (int *)0x2) {
                *(undefined4 *)(iVar7 + 0x10) = 2;
                goto LAB_00065734;
            }
            if (iVar1 != __stack_chk_guard)
                goto LAB_000659b8;
            pcVar3 = "TRUE: TM/TMD init fellthrough!";
            goto LAB_00065940;
        case 2:
            if (param_2 < (int *)0x2) {
                *(undefined4 *)(iVar7 + 0xc) = 0;
                if (iVar1 == __stack_chk_guard) {
                    sleep(1);
                    return;
                }
                goto LAB_000659b8;
            }
            if (param_2 != (int *)0x8) {
                if (iVar1 == __stack_chk_guard) {
                    pcVar3 = "TRUE: TCU init fellthrough!";
                LAB_00065940:
                    FUN_00075d40(6, pcVar3);
                    return;
                }
            LAB_000659b8:
                /* WARNING: Subroutine does not return */
                __stack_chk_fail();
            }
            *(undefined4 *)(iVar7 + 0x10) = 3;
        LAB_00065734:
            param_2 = (int *)0x0;
            goto LAB_00065300;
        case 3:
            if ((int *)0x1 < param_2) {
                if (param_2 != (int *)0x9)
                    goto switchD_00065780_default;
                *(undefined4 *)(iVar7 + 0x10) = 4;
                *(undefined4 *)(iVar7 + 0xc) = 10;
                goto switchD_0006550c_default;
            }
            *(undefined4 *)(iVar7 + 0xc) = 1;
            if (iVar1 == __stack_chk_guard) {
                pcVar3 = "F18\r";
                goto LAB_00065478;
            }
            goto LAB_000659b8;
        case 4:
            switch (param_2) {
            case (int *)0x0:
                goto LAB_000657bc;
            case (int *)0x1:
                goto LAB_000657bc;
            case (int *)0x2:
                break;
            case (int *)0x3:
                break;
            case (int *)0x4:
                break;
            case (int *)0x5:
                *(undefined4 *)(iVar7 + 0x10) = 1;
                goto LAB_00065734;
            case (int *)0x6:
                break;
            case (int *)0x7:
                break;
            case (int *)0x8:
                break;
            case (int *)0x9:
            LAB_000657bc:
                FUN_000651d0(param_1, &DAT_000aad68);
                sleep(1);
                *(undefined4 *)(iVar7 + 0xc) = 5;
                if (iVar1 == __stack_chk_guard) {
                    pcVar3 = "QV";
                LAB_00065478:
                    FUN_000651d0(param_1, pcVar3);
                    return;
                }
                goto LAB_000659b8;
            }
        switchD_00065780_default:
            /* WARNING: Subroutine does not return */
            abort();
        case 5:
            switch (param_2) {
            case (int *)0x0:
                goto LAB_00065848;
            case (int *)0x1:
            LAB_00065848:
                *(undefined4 *)(iVar7 + 0xc) = 3;
                if (iVar1 == __stack_chk_guard) {
                    pcVar3 = "C\r";
                    goto LAB_00065478;
                }
                goto LAB_000659b8;
            case (int *)0x2:
                break;
            case (int *)0x3:
                break;
            case (int *)0x4:
                break;
            case (int *)0x5:
                break;
            case (int *)0x6:
                *(undefined4 *)(iVar7 + 0x10) = 5;
                iVar6 = __stack_chk_guard;
                *(undefined4 *)(iVar7 + 0xc) = 10;
                if (iVar1 == iVar6) {
                    pcVar3 = "ST1";
                    goto LAB_00065478;
                }
                goto LAB_000659b8;
            case (int *)0x7:
                break;
            case (int *)0x8:
                break;
            case (int *)0x9:
                *(undefined4 *)(iVar7 + 0x10) = 5;
                *(undefined4 *)(iVar7 + 0xc) = 10;
                goto switchD_0006550c_default;
            }
            if (iVar1 == __stack_chk_guard) {
                pcVar3 = "TRUE: TL3 init fellthrough! (%d)";
                goto LAB_0006568c;
            }
            goto LAB_000659b8;
        case 6:
            break;
        case 7:
            break;
        case 8:
            break;
        case 9:
            break;
        case 10:
            break;
        case 0xb:
            break;
        default:
            goto switchD_0006550c_default;
        }
        if (iVar6 == 0xb) {
            param_2 = (int *)&DAT_000aa52c;
        } else {
            param_2 = *(int **)(states + iVar6 * 4);
        }
        if (iVar1 == __stack_chk_guard) {
            pcVar3 = "TRUE: state %s is unexpected!";
        LAB_0006568c:
            FUN_00075d40(6, pcVar3, param_2);
            return;
        }
        goto LAB_000659b8;
    case 1:
        if (param_2 != (int *)0x5) {
            if (param_2 == (int *)0x7) {
                if (iVar1 == __stack_chk_guard) {
                    pcVar3 = "P";
                    goto LAB_00065478;
                }
                goto LAB_000659b8;
            }
            if (param_2 != (int *)0x0)
                goto LAB_00065438;
        }
        FUN_000651d0(param_1, "C");
        *(undefined4 *)(iVar7 + 0xc) = 9;
        goto LAB_00065438;
    case 2:
        switch (param_2) {
        case (int *)0x0:
            FUN_000651d0(param_1, &DAT_000aacf8);
            *(undefined4 *)(iVar7 + 0xc) = 6;
            break;
        case (int *)0x1:
            break;
        case (int *)0x2:
            param_2 = piVar8 + 0xe;
            FUN_000651d0(param_1, &DAT_000aad00);
            iVar6 = strcmp((char *)param_2, " TRUETIME Mk III");
            if ((iVar6 == 0) ||
                (iVar6 = strncmp((char *)param_2, " TRUETIME XL", 0xc),
                 iVar6 == 0)) {
                FUN_00065298(param_1, 2);
                if ((ntp_syslogmask & 0x400) != 0) {
                    if (iVar1 == __stack_chk_guard) {
                        pcVar3 = "TM/TMD/XL: %s";
                        goto LAB_0006568c;
                    }
                    goto LAB_000659b8;
                }
            } else {
                *(undefined4 *)(iVar7 + 0xc) = 7;
            }
            break;
        case (int *)0x3:
            FUN_000651d0(param_1, &DAT_000aad3c);
            *(undefined4 *)(iVar7 + 0xc) = 8;
            break;
        case (int *)0x4:
            FUN_000651d0(param_1, &DAT_000aad44);
            *(undefined4 *)(iVar7 + 0xc) = 9;
            break;
        case (int *)0x5:
            break;
        case (int *)0x6:
            break;
        case (int *)0x7:
            break;
        case (int *)0x8:
            break;
        case (int *)0x9:
            goto LAB_00065448;
        }
        break;
    case 3:
        if (param_2 == (int *)0x0) {
            FUN_000651d0(param_1, &DAT_000aad4c);
            FUN_000651d0(param_1, &DAT_000aad54);
            FUN_000651d0(param_1, &DAT_000aad5c);
            *(undefined4 *)(iVar7 + 0xc) = 9;
            break;
        }
        goto LAB_00065440;
    case 4:
    LAB_00065438:
        if (param_2 == (int *)0x0) {
            FUN_000651d0(param_1, "C");
            *(undefined4 *)(iVar7 + 0xc) = 9;
        } else {
        LAB_00065440:
            if (param_2 == (int *)0x9) {
            LAB_00065448:
                if (*(int *)(iVar7 + 0xc) - 9U < 2) {
                LAB_00065590:
                    *(undefined4 *)(iVar7 + 0xc) = 10;
                    break;
                }
                if (iVar1 == __stack_chk_guard) {
                    pcVar3 = "\x03\r";
                    goto LAB_00065478;
                }
                goto LAB_000659b8;
            }
        }
        break;
    case 5:
        if (param_2 != (int *)0x0) {
            if (param_2 != (int *)0x9)
                break;
            goto LAB_00065590;
        }
        if (iVar1 == __stack_chk_guard) {
            pcVar3 = "ST1";
            goto LAB_00065478;
        }
        goto LAB_000659b8;
    default:
        FUN_00075d40(6, "TRUE: cannot identify refclock!");
        goto switchD_00065780_default;
    }
switchD_0006550c_default:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    goto LAB_000659b8;
}

void FUN_00065a64(undefined4 param_1, int param_2)

{
    int iVar1;
    int iVar2;
    undefined4 *puVar3;
    int *piVar4;
    bool bVar5;

    iVar1 = __stack_chk_guard;
    puVar3 = *(undefined4 **)(param_2 + 0x54);
    piVar4 = (int *)*puVar3;
    if (*piVar4 == 0) {
        FUN_00065298(param_2);
        FUN_00049c88(param_2, 1);
    } else {
        *piVar4 = *piVar4 + -1;
    }
    iVar2 = puVar3[0xc2];
    bVar5 = iVar1 == __stack_chk_guard;
    piVar4[2] = 1;
    puVar3[0xc2] = iVar2 + 1;
    if (bVar5) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00065b70(int param_1)

{
    uint uVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    char *pcVar5;
    undefined4 *puVar6;
    int iVar7;
    undefined4 *puVar8;
    byte local_c5;
    int local_c4;
    undefined1 auStack_c0[4];
    int local_bc;
    undefined1 auStack_b8[4];
    undefined4 local_b4;
    undefined4 uStack_b0;
    undefined1 auStack_ac[128];
    int local_2c;

    iVar7 = *(int *)(param_1 + 4);
    puVar6 = *(undefined4 **)(iVar7 + 0x54);
    local_2c = __stack_chk_guard;
    puVar8 = (undefined4 *)*puVar6;
    uVar1 = FUN_0004a6d4(param_1, auStack_ac, 0x80, &local_b4);
    uVar1 = uVar1 & 0xffff;
    auStack_ac[uVar1] = 0;
    if (uVar1 != 0) {
        pcVar5 = (char *)(puVar6 + 0xe);
        puVar6[0x2e] = uVar1;
        FUN_0007e4b4(pcVar5, auStack_ac, 0x80);
        puVar6[0x3a] = local_b4;
        puVar6[0x3b] = uStack_b0;
        FUN_00065098(iVar7, "receive(%s) [%d]\n", pcVar5, puVar6[0x2e]);
        *puVar8 = 2;
        FUN_00052d0c(iVar7 + 0x10, pcVar5);
        if ((*(char *)(puVar6 + 0xe) == '?') ||
            (iVar2 = strcmp(pcVar5, "ERROR 05 NO SUCH FUNCTION"), iVar2 == 0)) {
            FUN_00065298(iVar7, 1);
        } else if ((((*(char *)((int)puVar6 + 0x3d) - 0x2bU & 0xfd) == 0) &&
                    ((*(char *)((int)puVar6 + 0x41) - 0x2bU & 0xfd) == 0)) &&
                   (iVar2 = sscanf(pcVar5, "%5d%*c%3d%*c%3d", &local_bc,
                                   auStack_c0, auStack_b8),
                    iVar2 == 3)) {
            if (local_bc - 0x1b59U < 6999) {
                if (local_bc < 10000) {
                    pcVar5 = "EAST";
                } else {
                    pcVar5 = "WEST";
                }
                uVar1 = (uint)(local_bc < 10000);
                if (puVar8[1] != uVar1) {
                    uVar3 = puVar6[0xbc];
                    uVar4 = puVar6[0xbd];
                    puVar6[0xbc] = puVar6[0xba];
                    puVar6[0xbd] = puVar6[0xbb];
                    puVar6[0xba] = uVar3;
                    puVar6[0xbb] = uVar4;
                    puVar8[1] = uVar1;
                }
            } else {
                pcVar5 = "UNKNOWN";
            }
            FUN_00065098(iVar7, "GOES: station %s\n", pcVar5);
            FUN_00065298(iVar7, 5);
        } else {
            iVar2 = sscanf(pcVar5, "F%2d", &local_c4);
            if ((iVar2 == 1) && (local_c4 - 1U < 0x4f)) {
                if (local_c4 == 0x32) {
                    FUN_00065298(iVar7, 3);
                } else if (local_c4 == 0x33) {
                    FUN_00065298(iVar7, 4);
                } else {
                    FUN_00065098(iVar7, "got F%02d - ignoring\n");
                }
            } else if (((puVar6[0xe] & 0xffffff) == 0x524556) &&
                       (*(char *)((int)puVar6 + 0x3e) == '.')) {
                FUN_00065298(iVar7, 6);
                if ((ntp_syslogmask & 0x400) != 0) {
                    FUN_00075d40(6, "TL3: %s", pcVar5);
                }
            } else {
                iVar2 = strncmp(pcVar5, " TRUETIME Mk III ", 0x11);
                if ((iVar2 == 0) ||
                    (iVar2 = strncmp(pcVar5, " TRUETIME XL", 0xc),
                     iVar2 == 0)) {
                    FUN_00065298(iVar7, 2);
                    if ((ntp_syslogmask & 0x400) != 0) {
                        FUN_00075d40(6, "TM/TMD/XL: %s", pcVar5);
                    }
                } else if (((*(char *)(puVar6 + 0xe) == 'N' ||
                             *(char *)(puVar6 + 0xe) == 'S') &&
                            (*(char *)((int)puVar6 + 0x41) == 'W' ||
                             *(char *)((int)puVar6 + 0x41) == 'E')) &&
                           (*(char *)((int)puVar6 + 0x4a) == '+')) {
                    FUN_00065298(iVar7, 8);
                    if ((ntp_syslogmask & 0x400) != 0) {
                        FUN_00075d40(6, "TCU-800: %s", pcVar5);
                    }
                } else if (((*(char *)((int)puVar6 + 0x3b) == ':') &&
                            (*(char *)((int)puVar6 + 0x3e) == ':')) &&
                           ((*(char *)((int)puVar6 + 0x41) == ':' &&
                             (iVar2 = sscanf(pcVar5, "%3d:%2d:%2d:%2d%c",
                                             puVar6 + 0x30, puVar6 + 0x31,
                                             puVar6 + 0x32, puVar6 + 0x33,
                                             &local_c5),
                              iVar2 == 5)))) {
                    uVar1 = (uint)local_c5;
                    *(bool *)(puVar6 + 10) =
                        uVar1 - 0x3e < 2 || (uVar1 == 0x23 || uVar1 == 0x58);
                    FUN_00065298(iVar7, 9);
                    if (puVar8[2] != 0) {
                        if ((uint)puVar8[4] < 2) {
                            FUN_00065298(iVar7, 7);
                        }
                        iVar2 = FUN_0004a4e8(puVar6);
                        if (iVar2 == 0) {
                            FUN_00049c88(iVar7, 6);
                        } else {
                            puVar6[0x38] = puVar6[0x3a];
                            puVar6[0x39] = puVar6[0x3b];
                            FUN_0004a534(iVar7);
                            FUN_00049c88(iVar7, 0);
                            puVar8[2] = 0;
                        }
                    }
                } else {
                    FUN_00049c88(iVar7, 2);
                }
            }
        }
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0006630c(int param_1)

{
    char cVar1;
    int iVar2;
    undefined4 uVar3;
    undefined1 uVar4;
    undefined4 *puVar5;
    char *__s;
    char *pcVar6;
    int iVar7;
    char local_38;
    char local_37[3];
    uint local_34;
    undefined4 local_30;
    undefined4 uStack_2c;
    char local_28;
    byte local_27;
    int local_24;

    iVar7 = *(int *)(param_1 + 4);
    puVar5 = *(undefined4 **)(iVar7 + 0x54);
    local_34 = 0x7fffffff;
    __s = (char *)(puVar5 + 0xe);
    pcVar6 = (char *)*puVar5;
    local_24 = __stack_chk_guard;
    iVar2 = FUN_0004a6d4(param_1, __s, 0x80, &local_30);
    if (iVar2 == 0) {
        if (*pcVar6 == '\0') {
            *pcVar6 = '\x01';
            *(undefined4 *)(pcVar6 + 4) = local_30;
            *(undefined4 *)(pcVar6 + 8) = uStack_2c;
        } else {
            *pcVar6 = '\0';
        }
        goto LAB_0006637c;
    }
    puVar5[0x2e] = iVar2;
    uVar3 = *(undefined4 *)(pcVar6 + 8);
    puVar5[0x3a] = *(undefined4 *)(pcVar6 + 4);
    puVar5[0x3b] = uVar3;
    *(undefined4 *)(pcVar6 + 4) = local_30;
    *(undefined4 *)(pcVar6 + 8) = uStack_2c;
    *pcVar6 = '\x01';
    local_37[2] = ' ';
    local_37[1] = 0x20;
    local_37[0] = ' ';
    local_38 = ' ';
    if (puVar5[0x2e] == 0x18) {
    LAB_000663fc:
        iVar2 = sscanf(__s, "%c%1d%c%4d%3d%*c%2d:%2d:%2d.%2ld%c", &local_38,
                       &local_34, local_37 + 1, puVar5 + 0x2f, puVar5 + 0x30,
                       puVar5 + 0x31, puVar5 + 0x32, puVar5 + 0x33,
                       puVar5 + 0x34, local_37);
        if (iVar2 == 10) {
            iVar2 = puVar5[0x34] * 10000000;
            puVar5[0x34] = iVar2;
            if (local_37[0] == 'I') {
                iVar2 = 0x2b;
            }
            cVar1 = (char)iVar2;
            if ((local_37[0] != 'I') &&
                (cVar1 = local_37[0], local_37[0] == 'D')) {
                local_37[0] = '-';
                cVar1 = local_37[0];
            }
            local_37[0] = cVar1;
            if (local_38 != '?') {
                local_38 = ':';
            }
        LAB_000664b0:
            if (puVar5[0x2e] == 0x20) {
                switch (local_34) {
                case 0:
                    goto LAB_00066518;
                case 1:
                    goto LAB_00066574;
                case 2:
                    goto LAB_0006658c;
                case 3:
                    goto LAB_0006655c;
                }
            switchD_000664c8_default:
                puVar5[0x3e] = 0;
                puVar5[0x3f] = 0x40300000;
            } else {
                switch (local_34) {
                case 1:
                    puVar5[0x3e] = 0x47ae147b;
                    puVar5[0x3f] = 0x3fc47ae1;
                    break;
                case 2:
                LAB_0006655c:
                    puVar5[0x3e] = 0x47ae147b;
                    puVar5[0x3f] = 0x3fb47ae1;
                    break;
                case 3:
                LAB_0006658c:
                    puVar5[0x3e] = 0x47ae147b;
                    puVar5[0x3f] = 0x3fa47ae1;
                    break;
                case 4:
                LAB_00066574:
                    puVar5[0x3e] = 0x47ae147b;
                    puVar5[0x3f] = 0x3f947ae1;
                    break;
                case 5:
                LAB_00066518:
                    puVar5[0x3e] = 0xd2f1a9fc;
                    puVar5[0x3f] = 0x3f60624d;
                    break;
                default:
                    goto switchD_000664c8_default;
                }
            }
            if (local_38 == ':') {
                if (local_37[0] == '+') {
                    *(undefined1 *)(puVar5 + 10) = 1;
                } else {
                    if (local_37[0] == '-') {
                        uVar4 = 2;
                    } else {
                        uVar4 = 0;
                    }
                    *(undefined1 *)(puVar5 + 10) = uVar4;
                }
            } else {
                *(undefined1 *)(puVar5 + 10) = 3;
            }
            iVar2 = FUN_0004a4e8(puVar5);
            if (iVar2 == 0) {
                FUN_00049c88(iVar7, 6);
            }
            goto LAB_0006637c;
        }
    } else if (puVar5[0x2e] == 0x20) {
        iVar2 = sscanf(__s, "%c%*31c", local_37 + 2);
        if (iVar2 != 1)
            goto LAB_000663fc;
        if ((local_37[2] == 'R') &&
            (iVar2 =
                 sscanf(__s, "%*2c %*2c%2c%*c%4d%*c%3d%*4c %2d%c%2d:%2d%c%*2c",
                        &local_28, puVar5 + 0x2f, puVar5 + 0x30, puVar5 + 0x31,
                        &local_38, puVar5 + 0x32, puVar5 + 0x33, local_37),
             iVar2 == 8)) {
            if (local_28 == '0') {
                local_34 = 0;
            } else {
                local_34 = 99;
            }
            if (local_37[0] == 'I') {
                local_37[0] = '+';
            } else if (local_37[0] == 'D') {
                local_37[0] = '-';
            }
        }
        if ((local_37[2] != 'S') ||
            (iVar2 =
                 sscanf(__s, "%*4c %2c %4d%*c%3d%*4c %2d%c%2d:%2d%c%*2c",
                        &local_28, puVar5 + 0x2f, puVar5 + 0x30, puVar5 + 0x31,
                        &local_38, puVar5 + 0x32, puVar5 + 0x33, local_37),
             iVar2 != 8))
            goto LAB_000664b0;
        if (local_28 == 'L') {
            local_34 = 0;
            if (puVar5[0x2e] == 0x20)
                goto LAB_00066518;
        } else {
            if (local_28 == '0') {
                local_34 = local_27 & 0xf;
                goto LAB_000664b0;
            }
            local_34 = 99;
        }
        goto switchD_000664c8_default;
    }
    FUN_00049c88(iVar7, 2);
LAB_0006637c:
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000668a0(int *param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int iVar4;
    int *piVar5;
    bool bVar6;
    double dVar7;

    iVar1 = __stack_chk_guard;
    iVar4 = *param_1;
    iVar2 = param_1[1];
    dVar7 = *(double *)(param_1 + iVar4 * 2 + 6);
    param_1[1] = iVar2 + 1;
    iVar3 = iVar4 + -1;
    if (iVar2 + 1 == iVar4) {
        param_1[1] = 0;
    }
    if (0 < iVar3) {
        piVar5 = param_1 + (iVar4 + 4) * 2;
        do {
            iVar3 = iVar3 + -1;
            piVar5[-2] = piVar5[-4];
            piVar5[-1] = piVar5[-3];
            piVar5 = piVar5 + -2;
        } while (iVar3 != 0);
    }
    bVar6 = iVar1 != __stack_chk_guard;
    *(double *)(param_1 + 8) = (double)(longlong)(int)(longlong)dVar7;
    if (bVar6) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0006693c(undefined4 param_1, int param_2)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    int iVar4;
    bool bVar5;

    iVar1 = __stack_chk_guard;
    piVar3 = *(int **)(param_2 + 0x54);
    iVar4 = *piVar3;
    if (*(int *)(iVar4 + 0x34) != 0) {
        FUN_00049c88(param_2);
    }
    iVar2 = piVar3[0xc2];
    bVar5 = iVar1 == __stack_chk_guard;
    *(undefined4 *)(iVar4 + 0x34) = 0;
    piVar3[0xc2] = iVar2 + 1;
    if (bVar5) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00066a3c(int param_1, int param_2, int param_3)

{
    uint uVar1;
    byte bVar2;
    int iVar3;
    int iVar4;
    int iVar5;
    int *piVar6;
    double dVar7;
    double dVar8;
    undefined1 auStack_ac[128];
    int local_2c;

    piVar6 = *(int **)(param_1 + 0x54);
    dVar7 = *(double *)(param_2 + 0x28);
    iVar5 = *piVar6;
    iVar4 = *(int *)(iVar5 + 0x894);
    param_3 = iVar4 - param_3;
    iVar3 = param_3 + -0x1900;
    if (iVar3 < 0) {
        iVar3 = param_3 + 0x73a00;
    }
    local_2c = __stack_chk_guard;
    if (*(double *)(param_2 + 8) < dVar7) {
        *(double *)(param_2 + 8) = dVar7;
        *(int *)(param_2 + 0x18) = iVar3;
    }
    dVar7 = dVar7 + *(double *)(param_2 + 0x10);
    *(double *)(param_2 + 0x10) = dVar7;
    if (iVar4 == 0) {
        dVar8 = *(double *)(param_2 + 8);
        *(double *)(param_2 + 0x38) = dVar8;
        if (dVar8 <= 0.0) {
            dVar7 = 0.0;
        } else {
            dVar7 = (dVar7 - dVar8) / 480000.0;
            if (dVar7 <= 0.0) {
                dVar7 = 40.0;
            } else {
                dVar8 = log10(dVar8 / dVar7);
                dVar7 = dVar8 * 20.0;
                if (40.0 < dVar8 * 20.0) {
                    dVar7 = 40.0;
                }
                dVar8 = *(double *)(param_2 + 0x38);
            }
        }
        iVar3 = *(int *)(param_2 + 0x18);
        *(double *)(param_2 + 0x40) = dVar7;
        if (*(int *)(param_2 + 0x54) == 0) {
            *(int *)(param_2 + 0x1c) = iVar3;
            iVar4 = 0;
        } else {
            iVar4 = (iVar3 - *(int *)(param_2 + 0x1c)) % 480000;
        }
        uVar1 = *(int *)(param_2 + 0x50) << 1;
        *(uint *)(param_2 + 0x50) = uVar1;
        if ((uVar1 & 0x40) != 0) {
            *(int *)(param_2 + 0x54) = *(int *)(param_2 + 0x54) + -1;
        }
        if ((2500.0 < dVar8) && (20.0 < dVar7)) {
            if (iVar4 + 0x9fU < 0x13f) {
                *(int *)(param_2 + 0x1c) = iVar3;
                *(uint *)(param_2 + 0x50) = uVar1 | 1;
                *(int *)(param_2 + 0x20) = iVar3;
                *(int *)(param_2 + 0x54) = *(int *)(param_2 + 0x54) + 1;
            } else if (*(int *)(param_2 + 0x54) == 1) {
                *(int *)(param_2 + 0x1c) = iVar3;
            }
        }
        if (*(int *)(iVar5 + 0x38) < 7) {
            dVar7 = (double)(longlong) * (int *)(param_2 + 0x54) * 6000.0;
            if (6000.0 <= dVar8) {
                dVar7 = dVar7 + 5999.0;
            } else {
                dVar7 = dVar7 + dVar8;
            }
            *(double *)(param_2 + 0x48) = (dVar7 / 42000.0) * 100.0;
            bVar2 = *(byte *)(piVar6 + 0xc0);
        } else {
            *(undefined4 *)(param_2 + 0x48) = 0;
            *(undefined4 *)(param_2 + 0x4c) = 0;
            bVar2 = *(byte *)(piVar6 + 0xc0);
        }
        if ((bVar2 & 8) != 0) {
            FUN_0007d00c(auStack_ac, 0x80,
                         "wwv8 %04x %3d %s %04x %.0f %.0f/%.1f %ld %ld",
                         *(undefined4 *)(iVar5 + 0x10e8),
                         *(undefined4 *)(iVar5 + 0x844), param_2 + 0x5c,
                         *(undefined2 *)(param_2 + 0x50));
            FUN_00052d0c(param_1 + 0x10, auStack_ac);
        }
        *(undefined4 *)(param_2 + 0x10) = 0;
        *(undefined4 *)(param_2 + 0x14) = 0;
        *(undefined4 *)(param_2 + 8) = 0;
        *(undefined4 *)(param_2 + 0xc) = 0;
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00066d1c(int *param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int iVar4;
    bool bVar5;
    bool bVar6;

    iVar1 = __stack_chk_guard;
    iVar4 = *param_1;
    iVar2 = *(int *)(iVar4 + 0x844);
    if (*(int *)(iVar4 + 0x84c) == 0) {
        iVar3 = iVar2 + 4;
        bVar6 = SBORROW4(iVar3, 0xff);
        bVar5 = iVar3 != 0xff;
        if (0xff < iVar3) {
            iVar3 = 0xff;
        }
        if (bVar5 && iVar2 + -0xfb < 0 == bVar6) {
            *(int *)(iVar4 + 0x844) = iVar3;
            iVar2 = iVar3;
            goto LAB_00066d64;
        }
    } else {
        if (*(int *)(iVar4 + 0x84c) < 0x65)
            goto LAB_00066d64;
        iVar3 = iVar2 + -4;
        if (iVar3 < 0) {
            iVar3 = 0;
        }
    }
    *(int *)(iVar4 + 0x844) = iVar3;
    iVar2 = iVar3;
LAB_00066d64:
    FUN_000721dc(iVar2, *(undefined4 *)(iVar4 + 0x848),
                 *(undefined4 *)(iVar4 + 0x840));
    iVar2 = __stack_chk_guard;
    *(undefined4 *)(iVar4 + 0x84c) = 0;
    if (iVar1 != iVar2) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00066db4(uint param_1, int *param_2, int param_3)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    int iVar4;

    iVar1 = __stack_chk_guard;
    iVar4 = *param_2;
    iVar2 = *(int *)(iVar4 + 0x30);
    if (0 < iVar2) {
        *(undefined4 *)(*(int *)(iVar4 + 0xcdc) * 0xd8 + iVar4 + 0x898) =
            *(undefined4 *)(iVar4 + 0x844);
        FUN_00074d40((int)(&DAT_000ab070)[param_3], iVar2, param_1 & 0x7f);
        uVar3 = *(undefined4 *)(param_3 * 0xd8 + iVar4 + 0x898);
        *(int *)(iVar4 + 0xcdc) = param_3;
        *(undefined4 *)(iVar4 + 0x844) = uVar3;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00066e54(int param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int iVar4;
    int iVar5;
    uint uVar6;
    int iVar7;
    int *piVar8;
    uint uVar9;
    bool bVar10;
    double dVar11;
    double dVar12;
    double dVar13;
    double dVar14;

    iVar1 = __stack_chk_guard;
    iVar3 = 0;
    iVar4 = 0;
    piVar8 = *(int **)(param_1 + 0x54);
    dVar11 = 0.0;
    iVar2 = 0;
    iVar7 = *piVar8;
    iVar5 = iVar7 + 0x908;
    do {
        dVar13 = *(double *)(iVar5 + 0x48);
        dVar12 = dVar11;
        if (dVar11 <= dVar13) {
            dVar12 = dVar13;
        }
        dVar14 = *(double *)(iVar5 + -0x20);
        if (dVar11 <= dVar13) {
            iVar2 = iVar5;
            iVar3 = iVar4;
        }
        if (dVar12 <= dVar14) {
            iVar3 = iVar4;
        }
        iVar4 = iVar4 + 1;
        dVar11 = dVar12;
        if (dVar12 <= dVar14) {
            iVar2 = iVar5 + -0x68;
            dVar11 = dVar14;
        }
        iVar5 = iVar5 + 0xd8;
    } while (iVar4 != 5);
    uVar9 = *(uint *)(iVar7 + 0x10e8);
    *(uint *)(iVar7 + 0x10e8) = uVar9 & 0xfffffcff;
    if (13.0 <= dVar11) {
        *(int *)(iVar7 + 0xcd4) = iVar3;
        *(int *)(iVar7 + 0xcd0) = iVar2;
        piVar8[0xbf] = *(int *)(iVar2 + 0x5c);
        uVar9 = *(uint *)(iVar2 + 0x58);
        uVar6 = *(uint *)(iVar7 + 0x10e8);
        *(int *)(param_1 + 0x70) = piVar8[0xbf];
        *(uint *)(iVar7 + 0x10e8) = uVar6 | 0x80;
        if ((uVar9 & 0x100) == 0) {
            if ((uVar9 & 0x200) == 0) {
                *(undefined4 *)(iVar7 + 0x28) = 0;
                *(undefined4 *)(iVar7 + 0x2c) = 0;
            } else {
                iVar3 = piVar8[0xbc];
                iVar2 = piVar8[0xbd];
                *(uint *)(iVar7 + 0x10e8) = uVar6 | 0x280;
                *(int *)(iVar7 + 0x28) = iVar3;
                *(int *)(iVar7 + 0x2c) = iVar2;
            }
            piVar8 = (int *)0x1;
        } else {
            iVar3 = piVar8[0xba];
            iVar2 = piVar8[0xbb];
            piVar8 = (int *)0x1;
            *(uint *)(iVar7 + 0x10e8) = uVar6 | 0x180;
            *(int *)(iVar7 + 0x28) = iVar3;
            *(int *)(iVar7 + 0x2c) = iVar2;
        }
    } else {
        bVar10 = (uVar9 & 0x80) != 0;
        if (!bVar10) {
            piVar8 = (int *)0x0;
        }
        *(int *)(iVar7 + 0xcd4) = (*(int *)(iVar7 + 0xcd4) + 1) % 5;
        if (bVar10) {
            *(uint *)(iVar7 + 0x10e8) = uVar9 & 0xfffffc7f;
            FUN_00049c88(param_1, 4);
            piVar8 = (int *)0x0;
        }
    }
    if (0 < *(int *)(iVar7 + 0x30)) {
        FUN_00066db4(*(undefined4 *)(param_1 + 0x4c),
                     *(undefined4 *)(param_1 + 0x54),
                     *(undefined4 *)(iVar7 + 0xcd4));
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(piVar8);
    }
    return;
}

void FUN_00067010(int param_1)

{
    int iVar1;
    undefined4 uVar2;
    int iVar3;
    int iVar4;
    double *pdVar5;
    int iVar6;
    bool bVar7;
    double __x;

    iVar1 = __stack_chk_guard;
    iVar6 = **(int **)(param_1 + 0x54);
    pdVar5 = (double *)&DAT_000ab070;
    if (*(int *)(iVar6 + 0x10e8) != 0) {
        *(undefined4 *)(iVar6 + 0x34) = 1;
    }
    *(undefined1 *)(param_1 + 0x5b) = 3;
    *(undefined4 *)(iVar6 + 0x10ec) = 0;
    iVar4 = 0;
    *(undefined4 *)(iVar6 + 0x10e8) = 0;
    *(undefined4 *)(iVar6 + 0x844) = 0x7f;
    *(undefined4 *)(iVar6 + 0x850) = 8;
    *(undefined4 *)(iVar6 + 0x38) = 0;
    *(undefined8 *)(iVar6 + 0x18) = 0;
    memset((void *)(iVar6 + 0x898), 0, 0x438);
    uVar2 = 0x7f;
    iVar3 = iVar6;
    while (true) {
        *(undefined4 *)(iVar3 + 0x898) = uVar2;
        iVar4 = iVar4 + 1;
        *(undefined4 *)(iVar3 + 0x8f8) = 0x100;
        __x = *pdVar5;
        pdVar5 = pdVar5 + 1;
        floor(__x);
        FUN_0007d00c(iVar3 + 0x8fc, 5, "WV%.0f");
        *(undefined4 *)(iVar3 + 0x960) = 0x200;
        FUN_0007d00c(iVar3 + 0x964, 5, "WH%.0f");
        iVar3 = iVar3 + 0xd8;
        if (iVar4 == 5)
            break;
        uVar2 = *(undefined4 *)(iVar6 + 0x844);
    }
    *(undefined4 *)(iVar6 + 0xcd4) = 2;
    FUN_00066e54(param_1);
    bVar7 = iVar1 == __stack_chk_guard;
    *(undefined4 *)(iVar6 + 0xcd8) = *(undefined4 *)(iVar6 + 0xcd4);
    if (bVar7) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0006743c(int param_1, int param_2, double *param_3)

{
    double *pdVar1;
    double *pdVar2;
    int iVar3;
    int iVar4;
    int iVar5;
    int *piVar6;
    double *pdVar7;
    int iVar8;
    double dVar9;
    double dVar10;
    double dVar11;
    double dVar12;
    double dVar13;
    undefined1 auStack_ac[128];
    int local_2c;

    dVar11 = *param_3;
    piVar6 = *(int **)(param_1 + 0x54);
    local_2c = __stack_chk_guard;
    iVar4 = *piVar6;
    if (dVar11 == 0.0) {
        *(undefined4 *)(param_2 + 0x18) = 0;
        *(undefined4 *)(param_2 + 0x1c) = 0;
        *(undefined4 *)(param_2 + 0x10) = 0;
        *(undefined4 *)(param_2 + 0x14) = 0xc0b77000;
    } else {
        param_3 = param_3 + 4;
        pdVar7 = (double *)(param_2 + 0x20);
        iVar8 = 0;
        iVar3 = 0;
        dVar9 = -6000.0;
        dVar12 = -6000.0;
        do {
            dVar11 = DAT_000d0680 * dVar11 + 0.0;
            pdVar1 = &DAT_000d0680;
            for (pdVar2 = param_3 + -3; pdVar2 != param_3;
                 pdVar2 = pdVar2 + 1) {
                pdVar1 = pdVar1 + 1;
                dVar11 = dVar11 + *pdVar1 * *pdVar2;
            }
            dVar11 = *pdVar7 + (dVar11 - *pdVar7) * 0.0625;
            *pdVar7 = dVar11;
            pdVar7 = pdVar7 + 1;
            iVar5 = iVar8;
            dVar10 = dVar12;
            dVar13 = dVar11;
            if ((dVar11 <= dVar12) && (iVar5 = iVar3, dVar10 = dVar9,
                                       dVar13 = dVar12, dVar9 < dVar11)) {
                dVar10 = dVar11;
            }
            iVar8 = iVar8 + 1;
            dVar11 = *param_3;
            param_3 = param_3 + 4;
            iVar3 = iVar5;
            dVar9 = dVar10;
            dVar12 = dVar13;
        } while (dVar11 != 0.0);
        *(double *)(param_2 + 0x10) = dVar13;
        if (0.0 < dVar13) {
            if (dVar10 <= 0.0) {
            LAB_00067564:
                *(undefined4 *)(param_2 + 0x18) = 0;
                *(undefined4 *)(param_2 + 0x1c) = 0x40440000;
                if (dVar13 < 1000.0)
                    goto LAB_00067584;
            } else {
                dVar11 = log10(dVar13 / dVar10);
                dVar11 = dVar11 * 20.0;
                if (40.0 < dVar11) {
                    dVar13 = *(double *)(param_2 + 0x10);
                    goto LAB_00067564;
                }
                *(double *)(param_2 + 0x18) = dVar11;
                if ((*(double *)(param_2 + 0x10) < 1000.0) || (dVar11 < 3.0))
                    goto LAB_00067584;
            }
            if (*(int *)(param_2 + 4) == iVar5) {
                iVar3 = *(int *)(param_2 + 8);
                if (iVar3 < 3) {
                    iVar3 = iVar3 + 1;
                    *(int *)(param_2 + 8) = iVar3;
                }
                if (iVar3 == 3) {
                    *(uint *)(iVar4 + 0x10e8) = *(uint *)(iVar4 + 0x10e8) | 4;
                    *(int *)(iVar4 + 0x10d4) = *(int *)(iVar4 + 0x10d4) + 1;
                }
            } else {
                iVar8 = *(int *)(param_2 + 8);
                iVar3 = iVar8;
                if (0 < iVar8) {
                    iVar3 = iVar8 + -1;
                }
                *(uint *)(iVar4 + 0x10ec) = *(uint *)(iVar4 + 0x10ec) | 1;
                if (0 < iVar8) {
                    *(int *)(param_2 + 8) = iVar3;
                }
                if (iVar3 == 0) {
                    *(int *)(param_2 + 4) = iVar5;
                }
            }
            goto LAB_00067594;
        }
        *(undefined4 *)(param_2 + 0x18) = 0;
        *(undefined4 *)(param_2 + 0x1c) = 0;
    }
LAB_00067584:
    *(uint *)(iVar4 + 0x10e8) = *(uint *)(iVar4 + 0x10e8) | 0x40;
LAB_00067594:
    if (((*(byte *)(piVar6 + 0xc0) & 8) != 0) &&
        ((*(uint *)(iVar4 + 0x10e8) & 8) == 0)) {
        FUN_0007d00c(auStack_ac, 0x80,
                     "wwv4 %2d %04x %3d %4d %5.0f %2d %d %d %d %5.0f %5.1f",
                     *(int *)(iVar4 + 0x10d0) + -1, *(uint *)(iVar4 + 0x10e8),
                     *(undefined4 *)(iVar4 + 0x844),
                     *(undefined4 *)(iVar4 + 0x854));
        FUN_00052d0c(param_1 + 0x10, auStack_ac);
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Restarted to delay deadcode elimination for space: stack */

void FUN_00067748(int param_1)

{
    byte bVar1;
    size_t sVar2;
    undefined4 uVar3;
    int iVar4;
    uint uVar5;
    uint uVar6;
    int iVar7;
    undefined4 uVar8;
    undefined1 *puVar9;
    int *piVar10;
    undefined4 uVar11;
    undefined1 uVar12;
    int iVar13;
    int iVar14;
    undefined4 *puVar15;
    char *__s;
    int *piVar16;
    int iVar17;
    int iVar18;
    undefined4 uVar19;
    int iVar20;
    int iVar21;
    int iVar22;
    undefined4 *puVar23;
    uint uVar24;
    int iVar25;
    int iVar26;
    int iVar27;
    int iVar28;
    bool bVar29;
    double in_d0;
    double dVar30;
    double dVar31;
    double dVar32;
    undefined8 uVar33;
    undefined4 local_bc;
    undefined4 local_b8;
    undefined1 auStack_b4[128];
    int local_34;

    piVar16 = *(int **)(param_1 + 0x54);
    local_34 = __stack_chk_guard;
    iVar17 = *piVar16;
    if (DAT_000d06a0 == 0) {
        DAT_000d06a0 = 1;
        memset(&DAT_000d06a8, 0, 0x1e8);
    }
    dVar32 = 0.0625;
    iVar25 = *(int *)(iVar17 + 0x10d0);
    *(int *)(iVar17 + 0x10d0) = iVar25 + 1;
    iVar13 = iVar25 * 8;
    dVar30 = *(double *)(&DAT_000d06a8 + iVar13) +
             (in_d0 - *(double *)(&DAT_000d06a8 + iVar13)) * 0.0625;
    *(double *)(&DAT_000d06a8 + iVar13) = dVar30;
    puVar9 = progx + iVar13;
    uVar24 = *(uint *)(progx + iVar13 + 4);
    switch (*(undefined4 *)(progx + iVar25 * 8)) {
    case 1:
        if ((*(uint *)(iVar17 + 0x10e8) & 4) == 0) {
            *(undefined4 *)(&DAT_000d0680 + uVar24) = 0;
            *(undefined4 *)((int)&DAT_000d0680 + uVar24 * 8 + 4) = 0;
        } else {
            (&DAT_000d0680)[uVar24] = in_d0;
        }
        break;
    case 2:
        (&DAT_000d0680)[uVar24] = in_d0;
        break;
    case 3:
        *(undefined4 *)(&DAT_000d0680 + uVar24) = 0;
        *(undefined4 *)((int)&DAT_000d0680 + uVar24 * 8 + 4) = 0;
        break;
    case 4:
        iVar13 = 0x8d8;
        goto LAB_00067c84;
    case 5:
        iVar13 = 0x7c0;
        goto LAB_00067c84;
    case 6:
        iVar13 = 0x668;
        goto LAB_00067c84;
    case 7:
        iVar13 = 0x810;
    LAB_00067c84:
        FUN_0006743c(param_1, iVar17 + uVar24 * 0x70 + 0xce0,
                     *(undefined4 *)((int)&__DT_PLTGOT + iVar13));
        break;
    case 8:
        goto LAB_00067c00;
    case 9:
        FUN_0006743c(param_1, iVar17 + 0x1060, bcd9);
        dVar30 = *(double *)(&DAT_000d06a8 + iVar13);
    LAB_00067c00:
        if (dVar30 <= 1000.0) {
            if (-1000.0 <= dVar30) {
                *(uint *)(iVar17 + 0x10e8) = *(uint *)(iVar17 + 0x10e8) | 0x40;
            } else {
                uVar5 = *(uint *)(iVar17 + 0x10f0);
                *(uint *)(iVar17 + 0x10f0) = uVar5 & ~uVar24;
                if ((uVar5 & uVar24) != 0) {
                    *(uint *)(iVar17 + 0x10ec) = *(uint *)(iVar17 + 0x10ec) | 1;
                }
            }
        } else {
            uVar5 = *(uint *)(iVar17 + 0x10f0);
            *(uint *)(iVar17 + 0x10f0) = uVar5 | uVar24;
            if ((uVar5 & uVar24) == 0) {
                *(uint *)(iVar17 + 0x10ec) = *(uint *)(iVar17 + 0x10ec) | 1;
            }
        }
        break;
    case 10:
        if (1000.0 < dVar30) {
            bVar29 = (*(uint *)(iVar17 + 0x10f0) & uVar24) == 0;
            uVar5 = *(uint *)(iVar17 + 0x10e8);
            if (bVar29) {
                puVar9 = *(undefined1 **)(iVar17 + 0x10ec);
            }
            *(uint *)(iVar17 + 0x10f0) = *(uint *)(iVar17 + 0x10f0) | uVar24;
            if (bVar29) {
                *(uint *)(iVar17 + 0x10ec) = (uint)puVar9 | 1;
            }
        } else if (-1000.0 <= dVar30) {
            uVar5 = *(uint *)(iVar17 + 0x10e8) | 0x40;
        } else {
            bVar29 = (*(uint *)(iVar17 + 0x10f0) & uVar24) != 0;
            uVar5 = *(uint *)(iVar17 + 0x10e8);
            if (bVar29) {
                puVar9 = *(undefined1 **)(iVar17 + 0x10ec);
            }
            *(uint *)(iVar17 + 0x10f0) = *(uint *)(iVar17 + 0x10f0) & ~uVar24;
            if (bVar29) {
                *(uint *)(iVar17 + 0x10ec) = (uint)puVar9 | 1;
            }
        }
        *(uint *)(iVar17 + 0x10e8) = uVar5 & 0xfffffcff;
        if (*(int *)(iVar17 + 0x30) < 1) {
            *(undefined4 *)(*(int *)(iVar17 + 0xcdc) * 0xd8 + iVar17 + 0x898) =
                *(undefined4 *)(iVar17 + 0x844);
        } else {
            uVar19 = *(undefined4 *)(param_1 + 0x54);
            *(int *)(iVar17 + 0xcd8) = (*(int *)(iVar17 + 0xcd8) + 1) % 5;
            FUN_00066db4(*(undefined4 *)(param_1 + 0x4c), uVar19);
        }
        break;
    case 0xb:
        uVar24 = *(uint *)(iVar17 + 0x10e8);
        if ((uVar24 & 0x1000) == 0)
            goto LAB_00067d80;
        break;
    case 0xc:
        uVar24 = *(uint *)(iVar17 + 0x10e8);
    LAB_00067d80:
        piVar10 = *(int **)(param_1 + 0x54);
        *(uint *)(iVar17 + 0x10e8) = uVar24 & 0xffffefff;
        iVar18 = *piVar10;
        iVar13 = FUN_000668a0(iVar18 + 0xce0);
        if ((*(uint *)(iVar18 + 0x10e8) & 4) != 0) {
            if (((iVar13 == 0) &&
                 (iVar13 = FUN_000668a0(iVar18 + 0xd50), iVar13 == 0)) &&
                (iVar13 = FUN_000668a0(iVar18 + 0xdc0), iVar13 == 0)) {
                FUN_000668a0(iVar18 + 0xe30);
            }
            iVar13 = *(int *)(iVar18 + 0xf84) * 100 +
                     *(int *)(iVar18 + 0xf14) * 10 + *(int *)(iVar18 + 0xea4);
            iVar14 = *(int *)(iVar18 + 0xe34) * 600 +
                     *(int *)(iVar18 + 0xd54) * 10 + *(int *)(iVar18 + 0xce4) +
                     *(int *)(iVar18 + 0xdc4) * 0x3c;
            uVar24 = *(uint *)(iVar18 + 0xff4) & 3;
            if (((*(uint *)(iVar18 + 0x10f0) & 0x40) != 0) &&
                ((*(uint *)(iVar18 + 0x10e8) & 8) != 0)) {
                if (uVar24 == 0) {
                    if (iVar13 != 0xb7) {
                        iVar4 = 0x16e;
                        goto LAB_00067e44;
                    }
                } else if (iVar13 != 0xb6) {
                    iVar4 = 0x16d;
                LAB_00067e44:
                    if (iVar13 != iVar4)
                        goto LAB_00067e64;
                }
                if (iVar14 == 0x59f) {
                    *(uint *)(iVar18 + 0x10e8) =
                        *(uint *)(iVar18 + 0x10e8) | 0x1000;
                    goto LAB_00067e6c;
                }
            }
        LAB_00067e64:
            if (iVar14 == 0x5a0) {
                do {
                    iVar14 = FUN_000668a0(iVar18 + 0xdc0);
                } while (iVar14 != 0);
                do {
                    iVar14 = FUN_000668a0(iVar18 + 0xe30);
                } while (iVar14 != 0);
                iVar14 = FUN_000668a0(iVar18 + 0xea0);
                if ((iVar14 == 0) &&
                    (iVar14 = FUN_000668a0(iVar18 + 0xf10), iVar14 == 0)) {
                    FUN_000668a0(iVar18 + 0xf80);
                }
                iVar14 = 0x16d;
                if (uVar24 == 0) {
                    iVar14 = 0x16e;
                }
                if (iVar13 + 1 == iVar14) {
                    do {
                        iVar13 = FUN_000668a0(iVar18 + 0xea0);
                    } while (iVar13 != 1);
                    do {
                        iVar13 = FUN_000668a0(iVar18 + 0xf10);
                    } while (iVar13 != 0);
                    do {
                        iVar13 = FUN_000668a0(iVar18 + 0xf80);
                    } while (iVar13 != 0);
                    iVar13 = FUN_000668a0(iVar18 + 0xff0);
                    if (iVar13 == 0) {
                        FUN_000668a0(iVar18 + 0x1060);
                    }
                }
            }
        }
    LAB_00067e6c:
        puVar15 = *(undefined4 **)(param_1 + 0x54);
        puVar23 = (undefined4 *)*puVar15;
        *(undefined4 *)(iVar17 + 0x10d0) = 0;
        if ((puVar23[0x43a] & 2) == 0) {
            uVar24 = puVar23[0x43b] | 8;
            puVar23[0x43b] = uVar24;
            if ((int)puVar23[0x435] < 9)
                goto LAB_00068108;
        } else {
            uVar24 = puVar23[0x43b];
            if ((int)puVar23[0x435] < 9) {
            LAB_00068108:
                uVar24 = uVar24 | 4;
                puVar23[0x43b] = uVar24;
            } else if (uVar24 == 0) {
                puVar23[0x43a] = puVar23[0x43a] | 8;
            }
        }
        if ((puVar23[0x43a] & 10) == 10) {
            uVar12 = (undefined1)(puVar23[0x43c] & 0x40);
            if ((puVar23[0x43c] & 0x40) != 0) {
                uVar12 = 1;
            }
            *(undefined1 *)(puVar15 + 10) = uVar12;
            iVar14 = puVar23[0x3c5];
            iVar13 = puVar23[0x3a9];
            iVar22 = puVar23[0x38d];
            iVar26 = puVar23[0x419];
            iVar4 = puVar23[0x355];
            iVar7 = puVar23[0x3e1];
            iVar21 = puVar23[0x339];
            iVar20 = puVar23[0x355];
            iVar18 = puVar23[0x371];
            iVar27 = puVar23[0x3fd];
            puVar15[0x33] = puVar23[0x434];
            puVar15[0x30] = iVar7 * 100 + iVar14 * 10 + iVar13;
            puVar15[0x32] = iVar4 * 8 + iVar20 * 2 + iVar21;
            puVar15[0x2f] = iVar26 * 10 + iVar27 + 2000;
            puVar15[0x31] = iVar22 * 10 + iVar18;
            local_bc = 0;
            uVar33 = CONCAT44(&local_bc, puVar15 + 0x35);
            uVar19 = *puVar23;
            local_b8 = 0;
            iVar13 = FUN_00074318();
            if (iVar13 == 0) {
                uVar24 = puVar23[0x43b];
                puVar23[0xd] = 6;
            } else {
                uVar3 = *puVar23;
                uVar8 = puVar23[1];
                puVar23[0xe] = 0;
                uVar11 = puVar23[1];
                dVar30 = *(double *)(puVar23 + 10);
                *(undefined8 *)(puVar15 + 0x3e) = 0;
                puVar15[0x38] = uVar3;
                puVar15[0x39] = uVar8;
                FUN_0004a258(SUB84(dVar30 + 0.0051600000000000005, 0), puVar15,
                             local_bc, local_b8, *puVar23, uVar11, uVar19,
                             uVar33);
                FUN_0004a534(param_1);
                uVar24 = puVar23[0x43b];
            }
        }
        __s = (char *)(puVar15 + 0xe);
        iVar13 = puVar23[0x3c5] * 10;
        iVar18 = iVar13 + puVar23[0x3a9];
        bVar29 = (puVar23[0x43a] & 8) != 0;
        uVar5 = puVar23[0x43c];
        if (bVar29) {
            iVar13 = 0x20;
        }
        iVar14 = puVar23[0x3e1];
        if (!bVar29) {
            iVar13 = 0x3f;
        }
        iVar4 = puVar23[0x419];
        if ((uVar5 & 0x40) == 0) {
            uVar19 = 0x20;
        } else {
            uVar19 = 0x4c;
        }
        iVar20 = puVar23[0x419];
        bVar1 = *(byte *)((int)&dstcod + ((uVar5 << 0x1a) >> 0x1e));
        iVar27 = puVar23[0x3fd];
        iVar21 = puVar23[0x38d];
        uVar6 = (uint)((uVar5 & 8) == 0);
        iVar22 = puVar23[0x355];
        iVar28 = puVar23[0x371];
        iVar7 = puVar23[0x355];
        iVar26 = puVar23[0x339];
        FUN_0007d00c(__s, 0x80, "%c%1X", iVar13, uVar24);
        uVar24 = (uint)bVar1;
        FUN_0007d00c(auStack_b4, 0x32, " %4d %03d %02d:%02d:%02d %c%c %+d",
                     iVar4 * 8 + iVar20 * 2 + iVar27 + 2000,
                     iVar14 * 100 + iVar18, iVar21 * 10 + iVar28,
                     iVar22 * 8 + iVar7 * 2 + iVar26, 0, uVar19, bVar1,
                     (uVar5 & 7 ^ -uVar6) + uVar6);
        FUN_0007e558(__s, auStack_b4, 0x80);
        FUN_0007d00c(
            auStack_b4, 0x32, " %d %d %s %.0f %d %.1f %d", puVar23[0xe],
            puVar23[puVar23[0x335] * 0x36 + 0x226], puVar23[0x334] + 0x5c,
            *(undefined8 *)(puVar23[0x334] + 0x48), puVar23[0x43d], uVar24,
            (*(double *)(puVar23 + 6) / 8000.0) * 1000000.0, puVar23[0x214]);
        FUN_0007e558(__s, auStack_b4, 0x80);
        sVar2 = strlen(__s);
        puVar15[0x2e] = sVar2;
        FUN_00052d0c(param_1 + 0x10, __s);
        break;
    case 0xd:
        iVar13 = *(int *)(iVar17 + 0xcdc) * 0xd8 + iVar17;
        *(undefined8 *)(iVar13 + 0x8d8) = *(undefined8 *)(iVar13 + 0x8d0);
        *(undefined4 *)(iVar13 + 0x940) = *(undefined4 *)(iVar13 + 0x938);
        *(undefined4 *)(iVar13 + 0x944) = *(undefined4 *)(iVar13 + 0x93c);
        break;
    case 0xe:
        iVar18 = *(int *)(iVar17 + 0xcdc);
        iVar13 = iVar18 * 0xd8 + iVar17;
        dVar31 = *(double *)(iVar13 + 0x8d8);
        dVar30 = *(double *)(iVar13 + 0x8c8);
        if (dVar31 <= 0.0) {
            dVar30 = 0.0;
        } else if (dVar30 <= 0.0) {
            dVar30 = 40.0;
        } else {
            dVar31 = log10(dVar31 / dVar30);
            dVar32 = 40.0;
            dVar30 = dVar31 * 20.0;
            if (40.0 < dVar31 * 20.0) {
                dVar30 = dVar32;
            }
        }
        iVar13 = iVar18 * 0xd8 + iVar17;
        *(double *)(iVar13 + 0x8e0) = dVar30;
        uVar24 = *(int *)(iVar13 + 0x8f0) << 1;
        *(uint *)(iVar13 + 0x8f0) = uVar24;
        if ((uVar24 & 0x40) != 0) {
            *(int *)(iVar13 + 0x8f4) = *(int *)(iVar13 + 0x8f4) + -1;
        }
        iVar13 = iVar18 * 0xd8 + iVar17;
        dVar30 = *(double *)(iVar13 + 0x8d8);
        if (((dVar30 < 2500.0) ||
             (dVar32 = *(double *)(iVar13 + 0x8e0), dVar32 < 20.0)) ||
            ((*(uint *)(iVar17 + 0x10e8) & 0x60) != 0)) {
            iVar14 = *(int *)(iVar13 + 0x8f4);
        } else {
            *(uint *)(iVar13 + 0x8f0) = *(uint *)(iVar13 + 0x8f0) | 1;
            iVar14 = *(int *)(iVar13 + 0x8f4) + 1;
            *(int *)(iVar13 + 0x8f4) = iVar14;
        }
        iVar13 = iVar18 * 0xd8 + iVar17;
        if (6000.0 <= dVar30) {
            dVar32 = 5999.0;
        }
        if (6000.0 <= dVar30) {
            dVar30 = dVar32;
        }
        *(double *)(iVar13 + 0x8e8) =
            (((double)(longlong)iVar14 * 6000.0 + dVar30) / 42000.0) * 100.0;
        if (*(double *)(iVar13 + 0x940) <= 0.0) {
            dVar30 = 0.0;
        } else if (*(double *)(iVar13 + 0x930) <= 0.0) {
            dVar30 = 40.0;
        } else {
            dVar32 = log10(*(double *)(iVar13 + 0x940) /
                           *(double *)(iVar13 + 0x930));
            dVar30 = dVar32 * 20.0;
            if (40.0 < dVar32 * 20.0) {
                dVar30 = 40.0;
            }
        }
        iVar14 = iVar18 * 0xd8 + iVar17;
        *(double *)(iVar14 + 0x948) = dVar30;
        uVar24 = *(int *)(iVar14 + 0x958) << 1;
        *(uint *)(iVar14 + 0x958) = uVar24;
        iVar13 = iVar18 * 0xd8 + iVar17;
        if ((uVar24 & 0x40) != 0) {
            *(int *)(iVar14 + 0x95c) = *(int *)(iVar14 + 0x95c) + -1;
        }
        dVar30 = *(double *)(iVar13 + 0x940);
        if ((dVar30 < 2500.0) || (*(double *)(iVar13 + 0x948) < 20.0)) {
            iVar14 = *(int *)(iVar13 + 0x95c);
            uVar24 = *(uint *)(iVar17 + 0x10e8);
        } else {
            uVar24 = *(uint *)(iVar17 + 0x10e8);
            if ((uVar24 & 0x60) == 0) {
                *(uint *)(iVar13 + 0x958) = *(uint *)(iVar13 + 0x958) | 1;
                iVar14 = *(int *)(iVar13 + 0x95c) + 1;
                *(int *)(iVar13 + 0x95c) = iVar14;
            } else {
                iVar14 = *(int *)(iVar13 + 0x95c);
            }
        }
        iVar13 = iVar17 + iVar18 * 0xd8;
        if (6000.0 <= dVar30) {
            dVar30 = 5999.0;
        }
        dVar30 =
            (((double)(longlong)iVar14 * 6000.0 + dVar30) / 42000.0) * 100.0;
        *(double *)(iVar13 + 0x950) = dVar30;
        if ((*(byte *)(piVar16 + 0xc0) & 8) != 0) {
            FUN_0007d00c(auStack_b4, 0x80,
                         "wwv5 %04x %3d %4d %.0f/%.1f %.0f/%.1f %s %04x %.0f "
                         "%.0f/%.1f %s %04x %.0f %.0f/%.1f",
                         uVar24, *(undefined4 *)(iVar17 + 0x844),
                         *(undefined4 *)(iVar17 + 0x854),
                         *(undefined8 *)(iVar17 + 0x860),
                         *(undefined8 *)(iVar17 + 0x868),
                         *(undefined8 *)(iVar17 + 0x10d8),
                         *(undefined8 *)(iVar17 + 0x10e0), iVar13 + 0x8fc,
                         *(uint *)(iVar13 + 0x8f0) & 0xffff,
                         *(undefined4 *)(iVar13 + 0x8e8),
                         *(undefined4 *)(iVar13 + 0x8ec),
                         *(undefined4 *)(iVar13 + 0x8d8),
                         *(undefined4 *)(iVar13 + 0x8dc),
                         *(undefined4 *)(iVar13 + 0x8e0),
                         *(undefined4 *)(iVar13 + 0x8e4), iVar13 + 0x964,
                         *(uint *)(iVar13 + 0x958) & 0xffff, dVar30,
                         *(undefined4 *)(iVar13 + 0x940),
                         *(undefined4 *)(iVar13 + 0x944),
                         *(undefined4 *)(iVar13 + 0x948),
                         *(undefined4 *)(iVar13 + 0x94c));
            FUN_00052d0c(param_1 + 0x10, auStack_b4);
            uVar24 = *(uint *)(iVar17 + 0x10e8);
        }
        *(undefined4 *)(iVar17 + 0x10ec) = 0;
        *(undefined4 *)(iVar17 + 0x10d4) = 0;
        *(undefined4 *)(iVar17 + 0x10f4) = 0;
        if ((uVar24 & 8) == 0) {
            if ((uVar24 & 4) == 0) {
                if (0xf < *(int *)(iVar17 + 0x38))
                    goto LAB_000683c8;
            } else if (0x28 < *(int *)(iVar17 + 0x38)) {
            LAB_000683c8:
                FUN_00067010(param_1);
                goto LAB_00067ad0;
            }
        } else if (0xb40 < *(int *)(iVar17 + 0x38))
            goto LAB_000683c8;
        FUN_00066e54(param_1);
    }
    if (((*(byte *)(piVar16 + 0xc0) & 8) != 0) &&
        ((*(uint *)(iVar17 + 0x10e8) & 4) == 0)) {
        FUN_0007d00c(auStack_b4, 0x80,
                     "wwv3 %2d %04x %3d %4d %5.0f %5.1f %5.0f %5.1f %5.0f",
                     iVar25, *(uint *)(iVar17 + 0x10e8),
                     *(undefined4 *)(iVar17 + 0x844),
                     *(undefined4 *)(iVar17 + 0x854));
        FUN_00052d0c(param_1 + 0x10, auStack_b4);
    }
    *(double *)(piVar16 + 0x3e) = *(double *)(piVar16 + 0x3e) + 5e-06;
LAB_00067ad0:
    if (local_34 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00069ad4) */
/* WARNING: Removing unreachable block (ram,0x00069aac) */
/* WARNING: Removing unreachable block (ram,0x00069a9c) */
/* WARNING: Removing unreachable block (ram,0x00069ac4) */
/* WARNING: Removing unreachable block (ram,0x00069ab8) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same
 * address */

void FUN_000685b8(int param_1)

{
    int iVar1;
    undefined4 *puVar2;
    undefined4 *extraout_r0;
    int iVar3;
    int *piVar4;
    int iVar5;
    int iVar6;
    int iVar7;
    double *pdVar8;
    int iVar9;
    uint uVar10;
    int iVar11;
    int iVar12;
    int iVar13;
    uint uVar14;
    bool bVar15;
    double in_d0;
    double dVar16;
    double dVar17;
    double dVar18;
    double dVar19;
    double dVar20;
    double dVar21;
    double dVar22;
    double dVar23;
    double dVar24;
    double dVar25;
    double dVar26;
    double dVar27;
    double dVar28;
    double dVar29;
    double dVar30;
    double dVar31;
    double dVar32;
    double dVar33;
    double dVar34;
    double dVar35;
    double dVar36;
    double dVar37;
    int local_108;
    int local_fc;
    undefined1 auStack_dc[128];
    int local_5c;

    piVar4 = *(int **)(param_1 + 0x54);
    iVar7 = *piVar4;
    local_5c = __stack_chk_guard;
    if (DAT_000d0890 == 0) {
        DAT_000d0890 = 1;
        memset(&DAT_000d08c0, 0, 0x48);
        memset(&DAT_000d0908, 0, 0x148);
        memset(&DAT_000d0a50, 0, 0x2a80);
        memset(&DAT_000d34d0, 0, 0x2a80);
        memset(&DAT_000d5f50, 0, 0xc800);
        memset(&DAT_000e2750, 0, 0xc800);
        memset(&DAT_000eef50, 0, 0x140);
        memset(&DAT_000ef090, 0, 0x140);
        memset(&DAT_000ef1d0, 0, 0xc800);
        memset(&DAT_000fb9d0, 0, 0xc800);
        memset(&DAT_001081d0, 0, 0x140);
        memset(&DAT_00108310, 0, 0x140);
        memset(&DAT_00108450, 0, 64000);
        dVar16 = 0.0;
        dVar18 = -0.0;
        dVar17 = dVar16;
        dVar20 = dVar16;
        dVar19 = dVar16;
        DAT_000d08b8 = dVar16;
        dVar28 = dVar18;
        dVar30 = dVar16;
        dVar32 = dVar18;
        dVar21 = dVar16;
        dVar25 = dVar18;
        dVar22 = dVar16;
        dVar23 = dVar18;
        dVar24 = dVar16;
        dVar26 = dVar18;
        dVar27 = dVar16;
        dVar29 = dVar16;
        dVar31 = dVar16;
        dVar33 = dVar16;
        dVar34 = dVar16;
        dVar35 = dVar16;
        dVar36 = dVar16;
        DAT_000d0900 = dVar16;
        DAT_000d0898 = dVar16;
        dVar37 = dVar16;
        DAT_000d08b0 = dVar16;
    } else {
        dVar18 = DAT_000d08c0 * -0.02375732;
        dVar16 = DAT_000d08c8 * 0.03353214;
        dVar17 = DAT_000d08f0 * -2.765914 + DAT_000d08f8 * 0.4897278 +
                 DAT_000d08e8 * 8.110921 + DAT_000d08e0 * -15.17732 +
                 DAT_000d08d8 * 19.75197 + DAT_000d08d0 * -18.14365 +
                 DAT_000d08c8 * 11.59783 + DAT_000d08c0 * -4.73504;
        dVar20 = DAT_000d08a0 * 0.01654858;
        dVar19 = DAT_000d08b0 * 0.003281435;
        DAT_000d08b8 = DAT_000d08b0;
        dVar28 = DAT_000d08d0 * -0.04080258;
        dVar30 = DAT_000d08d8 * 0.04605479;
        dVar32 = DAT_000d08e0 * -0.04080258;
        dVar21 = DAT_000d08e8 * 0.03353214;
        dVar25 = DAT_000d0898 * -0.01149947;
        dVar22 = DAT_000d08f8 * 0.008203628;
        dVar23 = DAT_000d08f0 * -0.02375732;
        dVar24 = DAT_000d08a8 * -3.48174 + DAT_000d08b0 * 0.8360961 +
                 DAT_000d08a0 * 5.452988 + DAT_000d0898 * -3.807229;
        dVar26 = DAT_000d08a8 * -0.01149947;
        dVar27 = DAT_000d08c0;
        dVar29 = DAT_000d08c8;
        dVar31 = DAT_000d08d0;
        dVar33 = DAT_000d08d8;
        dVar34 = DAT_000d08e0;
        dVar35 = DAT_000d08e8;
        dVar36 = DAT_000d08f0;
        DAT_000d0900 = DAT_000d08f8;
        dVar37 = DAT_000d08a0;
        DAT_000d08b0 = DAT_000d08a8;
    }
    iVar13 = *(int *)(iVar7 + 0x880);
    iVar5 = DAT_00117e50 * 8;
    DAT_000d08a0 = DAT_000d0898;
    DAT_000d08a8 = dVar37;
    *(int *)(iVar7 + 0x880) = (iVar13 + 1) % 0x50;
    DAT_000d0898 = in_d0 * 5.0 - dVar24;
    pdVar8 = (double *)(iVar7 + 0x870);
    DAT_00117e50 = (DAT_00117e50 + 1) % 0x550;
    dVar19 = dVar25 + DAT_000d0898 * 0.003281435 + dVar20 + dVar26 + dVar19;
    dVar25 = (dVar19 * *(double *)(sintab + iVar13 * 8)) / 680.0;
    DAT_000d08c0 = in_d0 - dVar17;
    dVar20 = (dVar19 * *(double *)(sintab + (iVar13 + 0x14) * 8 +
                                   ((iVar13 + 0x14) / 0x50) * -0x280)) /
             680.0;
    dVar17 = DAT_000d08c0 * 0.008203628;
    DAT_000d08c8 = dVar27;
    DAT_000d08d0 = dVar29;
    DAT_000d08d8 = dVar31;
    DAT_000d08e0 = dVar33;
    DAT_000d08e8 = dVar34;
    DAT_000d08f0 = dVar35;
    DAT_000d08f8 = dVar36;
    *pdVar8 = *pdVar8 - *(double *)(&DAT_000d0a50 + iVar5);
    *(double *)(&DAT_000d0a50 + iVar5) = dVar25;
    *pdVar8 = *pdVar8 + dVar25;
    *(double *)(iVar7 + 0x878) =
        *(double *)(iVar7 + 0x878) - *(double *)(&DAT_000d34d0 + iVar5);
    *(double *)(&DAT_000d34d0 + iVar5) = dVar20;
    *(double *)(iVar7 + 0x878) = *(double *)(iVar7 + 0x878) + dVar20;
    iVar13 = DAT_00117e68;
    dVar20 = *(double *)(sintab + DAT_00117e54 * 8);
    dVar22 = dVar18 + dVar17 + dVar16 + dVar28 + dVar30 + dVar32 + dVar21 +
             dVar23 + dVar22;
    local_108 = DAT_00117e58;
    dVar19 = *(double *)(sintab + (DAT_00117e54 + 0x14) * 8 +
                         ((DAT_00117e54 + 0x14) / 0x50) * -0x280);
    DAT_00117e54 = (DAT_00117e54 + 10) % 0x50;
    iVar5 = DAT_00117e58 * 8;
    local_fc = DAT_00117e68;
    dVar17 = *(double *)(&DAT_000e2750 + iVar5);
    dVar32 = *(double *)(&DAT_000d5f50 + iVar5);
    iVar9 = (*(int *)(iVar7 + 0x894) + 1) % 480000;
    *(int *)(iVar7 + 0x894) = iVar9;
    iVar9 = iVar9 % 8000;
    iVar13 = iVar13 * 8;
    iVar11 = *(int *)(iVar7 + 0xcdc);
    dVar30 = *(double *)(&DAT_000ef090 + iVar13);
    dVar19 = dVar22 * dVar19 * 0.25;
    *(double *)(&DAT_000ef090 + iVar13) = dVar19;
    *(double *)(&DAT_000e2750 + iVar5) = dVar19;
    dVar20 = dVar22 * dVar20 * 0.25;
    dVar28 = *(double *)(&DAT_000eef50 + iVar13);
    DAT_00117e78 = dVar19 + (DAT_00117e78 - dVar17);
    *(double *)(&DAT_000d5f50 + iVar5) = dVar20;
    *(double *)(&DAT_000eef50 + iVar13) = dVar20;
    DAT_00117e60 = dVar20 + (DAT_00117e60 - dVar32);
    DAT_00117e80 = dVar19 + (DAT_00117e80 - dVar30);
    DAT_00117e70 = dVar20 + (DAT_00117e70 - dVar28);
    iVar11 = iVar11 * 0xd8;
    *(double *)(iVar7 + iVar11 + 0x8c8) =
        SQRT(DAT_00117e78 * DAT_00117e78 + DAT_00117e60 * DAT_00117e60) / 800.0;
    if ((*(uint *)(iVar7 + 0x10e8) & 1) == 0) {
        FUN_00066a3c(param_1, iVar7 + iVar11 + 0x8a0,
                     (int)(longlong)(*(double *)(piVar4 + 0xba) * 8000.0));
        local_108 = DAT_00117e58;
        local_fc = DAT_00117e68;
        iVar5 = DAT_00117e58 << 3;
        iVar13 = DAT_00117e68 << 3;
    }
    iVar12 = DAT_00117e88 + 0x14;
    dVar19 = *(double *)(sintab + DAT_00117e88 * 8);
    dVar17 = *(double *)(&DAT_000fb9d0 + iVar5);
    iVar11 = *(int *)(iVar7 + 0xcdc);
    dVar32 = *(double *)(&DAT_000ef1d0 + iVar5);
    DAT_00117e88 = (DAT_00117e88 + 0xc) % 0x50;
    dVar30 = *(double *)(&DAT_001081d0 + iVar13);
    dVar20 = dVar22 *
             *(double *)(sintab + iVar12 * 8 + (iVar12 / 0x50) * -0x280) * 0.25;
    *(double *)(&DAT_000fb9d0 + iVar5) = dVar20;
    dVar19 = dVar22 * dVar19 * 0.25;
    dVar28 = *(double *)(&DAT_00108310 + iVar13);
    *(double *)(&DAT_00108310 + iVar13) = dVar20;
    DAT_00117ea0 = dVar20 + (DAT_00117ea0 - dVar17);
    *(double *)(&DAT_001081d0 + iVar13) = dVar19;
    *(double *)(&DAT_000ef1d0 + iVar5) = dVar19;
    DAT_00117e90 = dVar19 + (DAT_00117e90 - dVar32);
    DAT_00117e98 = dVar19 + (DAT_00117e98 - dVar30);
    DAT_00117ea8 = dVar20 + (DAT_00117ea8 - dVar28);
    iVar11 = iVar11 * 0xd8;
    *(double *)(iVar7 + iVar11 + 0x930) =
        SQRT(DAT_00117ea0 * DAT_00117ea0 + DAT_00117e90 * DAT_00117e90) / 800.0;
    uVar14 = *(uint *)(iVar7 + 0x10e8);
    if ((uVar14 & 1) == 0) {
        FUN_00066a3c(param_1, iVar7 + iVar11 + 0x908,
                     (int)(longlong)(*(double *)(piVar4 + 0xbc) * 8000.0));
        uVar14 = *(uint *)(iVar7 + 0x10e8);
        uVar10 = uVar14 & 1;
        local_108 = DAT_00117e58;
        local_fc = DAT_00117e68;
    } else {
        uVar10 = 1;
    }
    DAT_00117e58 = (local_108 + 1) % 0x1900;
    DAT_00117e68 = (local_fc + 1) % 0x28;
    if (*(int *)(iVar7 + 0x894) == 0) {
        *(int *)(iVar7 + 0x38) = *(int *)(iVar7 + 0x38) + 1;
        if (uVar10 == 0) {
            iVar5 = FUN_00066e54(param_1);
            uVar14 = *(uint *)(iVar7 + 0x10e8);
            if (iVar5 == 0) {
                *(undefined4 *)(iVar7 + 0x38) = 0;
            }
            uVar10 = uVar14 & 1;
            goto LAB_0006906c;
        }
        if ((uVar14 & 0x1000) != 0) {
            *(undefined4 *)(iVar7 + 0x894) = 0x733c0;
        }
    LAB_00068d1c:
        iVar11 = **(int **)(param_1 + 0x54);
        iVar13 = *(int *)(iVar11 + 0xcdc);
        iVar5 = iVar13 * 0xd8 + iVar11;
        pdVar8 = (double *)(iVar5 + 0x8d0);
        dVar17 = *(double *)(iVar5 + 0x8c8);
        if (*pdVar8 < dVar17) {
            *pdVar8 = dVar17;
        }
        iVar5 = iVar13 * 0xd8 + iVar11;
        pdVar8 = (double *)(iVar5 + 0x938);
        dVar17 = *(double *)(iVar5 + 0x930);
        if (*pdVar8 < dVar17) {
            *pdVar8 = dVar17;
        }
        iVar5 = *(int *)(iVar11 + 0x890);
        if (iVar5 == 0x1900) {
            *(undefined4 *)(iVar11 + 0x858) = *(undefined4 *)(iVar11 + 0x854);
        } else if (iVar5 == 0x78) {
            pdVar8 = (double *)(iVar11 + 0x870);
            DAT_00117ec0._0_4_ = *(undefined4 *)pdVar8;
            DAT_00117ec0._4_4_ = *(undefined4 *)(iVar11 + 0x874);
            DAT_00117eb8 = *pdVar8;
            _DAT_00117eb0 = *pdVar8;
        } else if (iVar5 == 0x640) {
            DAT_00117eb8 = *(double *)(iVar11 + 0x870);
            DAT_00117ec8 =
                SQRT(*(double *)(iVar11 + 0x878) * *(double *)(iVar11 + 0x878) +
                     DAT_00117eb8 * DAT_00117eb8);
            dVar17 = *(double *)(iVar11 + 0x878) / (double)(longlong) *
                     (int *)(iVar11 + 0x850);
            *(double *)(iVar11 + 0x888) = dVar17;
            if (dVar17 < 0.0) {
                iVar13 = *(int *)(iVar11 + 0x880);
                iVar12 = iVar13 + -1;
                *(int *)(iVar11 + 0x880) = iVar12;
                if (iVar12 < 0) {
                    *(int *)(iVar11 + 0x880) = iVar13 + 0x4f;
                }
            } else {
                iVar6 = *(int *)(iVar11 + 0x880);
                iVar12 = iVar6 + 1;
                *(int *)(iVar11 + 0x880) = iVar12;
                iVar13 = iVar6 + -0x4e;
                if (0x4f < iVar12) {
                    iVar6 = iVar6 + -0x4f;
                }
                if (iVar12 != 0x4f && iVar13 < 0 == SBORROW4(iVar12, 0x4f)) {
                    *(int *)(iVar11 + 0x880) = iVar6;
                }
            }
        } else if (iVar5 == 4000) {
            _DAT_00117eb0 = *(double *)(iVar11 + 0x870);
        }
        *(int *)(iVar11 + 0x890) = iVar5 + 1;
        if (*(int *)(iVar11 + 0x894) % 8000 == *(int *)(iVar11 + 0x858)) {
            *(uint *)(iVar11 + 0x10e8) =
                *(uint *)(iVar11 + 0x10e8) & 0xffffff9f;
            dVar17 = DAT_00117ec8;
            dVar20 =
                SQRT(*(double *)(iVar11 + 0x878) * *(double *)(iVar11 + 0x878) +
                     *(double *)(iVar11 + 0x870) * *(double *)(iVar11 + 0x870));
            pdVar8 = (double *)(iVar11 + 0x10e0);
            DAT_00117ed0 = dVar20;
            *(double *)(iVar11 + 0x10d8) = DAT_00117ec8;
            if (dVar17 <= 0.0) {
                *(undefined4 *)pdVar8 = 0;
                *(undefined4 *)(iVar11 + 0x10e4) = 0;
            LAB_000698f4:
                *(uint *)(iVar11 + 0x10e8) = *(uint *)(iVar11 + 0x10e8) | 0x20;
                FUN_00067748(0, param_1);
            } else {
                if (dVar20 <= 0.0) {
                LAB_0006981c:
                    *(undefined4 *)pdVar8 = 0;
                    *(undefined4 *)(iVar11 + 0x10e4) = 0x40440000;
                    if (dVar17 < 1000.0)
                        goto LAB_000698f4;
                } else {
                    dVar20 = log10(dVar17 / dVar20);
                    dVar20 = dVar20 * 20.0;
                    if (40.0 < dVar20)
                        goto LAB_0006981c;
                    *pdVar8 = dVar20;
                    if ((dVar17 < 1000.0) || (dVar20 < 10.0))
                        goto LAB_000698f4;
                }
                DAT_00117eb8 = DAT_00117eb8 - _DAT_00117eb0;
                _DAT_00117eb0 =
                    _DAT_00117eb0 - (double)CONCAT44(DAT_00117ec0._4_4_,
                                                     (undefined4)DAT_00117ec0);
                FUN_00067748(SUB84(_DAT_00117eb0 - DAT_00117eb8, 0), param_1);
            }
            iVar5 = *(int *)(iVar11 + 0x10f4);
            if ((*(uint *)(iVar11 + 0x10e8) & 0x60) != 0) {
                iVar5 = iVar5 + 1;
                *(int *)(iVar11 + 0x10f4) = iVar5;
            }
            if (0x28 < iVar5) {
                *(uint *)(iVar11 + 0x10ec) = *(uint *)(iVar11 + 0x10ec) | 2;
            }
            FUN_00066d1c(*(undefined4 *)(param_1 + 0x54));
            iVar5 = *(int *)(iVar11 + 0xcdc) * 0xd8 + iVar11;
            *(undefined4 *)(iVar5 + 0x8d0) = 0;
            *(undefined4 *)(iVar5 + 0x8d4) = 0;
            *(undefined4 *)(iVar5 + 0x938) = 0;
            *(undefined4 *)(iVar5 + 0x93c) = 0;
            *(undefined4 *)(iVar11 + 0x890) = 0;
        }
        uVar14 = *(uint *)(iVar7 + 0x10e8);
    } else {
    LAB_0006906c:
        if (uVar10 != 0)
            goto LAB_00068d1c;
        iVar5 = *(int *)(iVar7 + 0xcd0);
        if ((iVar5 != 0) && (50.0 <= *(double *)(iVar5 + 0x48))) {
            iVar11 = *(int *)(iVar5 + 0x20);
            iVar5 = iVar11 >> 0x1f;
            iVar13 = iVar11 / 8000 + iVar5;
            if (iVar11 + (iVar13 - iVar5) * -8000 == iVar9) {
                iVar13 = (iVar5 - iVar13) + 0x3c;
                bVar15 = (uVar14 & 2) != 0;
                uVar14 = uVar14 | 1;
                iVar5 = (iVar13 / 0x3c) * 0x3c;
                if (bVar15) {
                    iVar5 = *(int *)(iVar7 + 0x854);
                }
                *(int *)(iVar7 + 0x10d0) = iVar13 % 0x3c;
                *(undefined4 *)(iVar7 + 0x890) = 0;
                *(uint *)(iVar7 + 0x10e8) = uVar14;
                *(undefined4 *)(iVar7 + 0x38) = 0;
                if (bVar15) {
                    *(int *)(iVar7 + 0x858) = iVar5;
                } else {
                    *(int *)(iVar7 + 0x854) = iVar9;
                    *(int *)(iVar7 + 0x858) = iVar9;
                }
            }
        }
    }
    dVar17 = DAT_00117ed8;
    dVar20 = DAT_00117e80;
    dVar19 = DAT_00117e70;
    if (((uVar14 & 0x100) == 0) &&
        (dVar20 = DAT_00117ea8, dVar19 = DAT_00117e98, (uVar14 & 0x200) == 0)) {
        dVar20 = 0.0;
    } else {
        dVar20 = SQRT(dVar20 * dVar20 + dVar19 * dVar19) / 5.0;
    }
    puVar2 = &DAT_00117ee0;
    dVar20 = *(double *)(&DAT_00108450 + iVar9 * 8) +
             (dVar20 - *(double *)(&DAT_00108450 + iVar9 * 8)) /
                 (double)(longlong) * (int *)(iVar7 + 0x850);
    *(double *)(&DAT_00108450 + iVar9 * 8) = dVar20;
    if (dVar17 < dVar20) {
        iVar5 = iVar9 + -0x30;
        if (iVar5 < 0) {
            iVar5 = iVar9 + 0x1f10;
        }
        DAT_00117ee8 = ABS(*(double *)(&DAT_00108450 + iVar5 * 8));
        DAT_00117ed8 = dVar20;
        DAT_00117ee0 = iVar9;
    }
    dVar20 = DAT_00117ee8;
    dVar17 = DAT_00117ed8;
    if (iVar9 != 0)
        goto LAB_00069034;
    *(double *)(iVar7 + 0x860) = DAT_00117ed8;
    if (dVar17 <= 0.0) {
        dVar17 = 0.0;
    } else if (dVar20 <= 0.0) {
        dVar17 = 40.0;
    } else {
        dVar20 = log10(dVar17 / dVar20);
        puVar2 = extraout_r0;
        dVar17 = dVar20 * 20.0;
        if (40.0 < dVar20 * 20.0) {
            dVar17 = 40.0;
        }
    }
    *(double *)(iVar7 + 0x868) = dVar17;
    iVar5 = DAT_00117ee0 + -0x28;
    if (iVar5 < 0) {
        iVar5 = DAT_00117ee0 + 0x1f18;
    }
    piVar4 = *(int **)(param_1 + 0x54);
    iVar13 = *piVar4;
    bVar15 = DAT_00117ef0 == (undefined4 *)0x0;
    if (bVar15) {
        DAT_00117ef4 = 0;
    }
    if (bVar15) {
        DAT_00117ef8 = 0;
        DAT_00117efc = 0;
        puVar2 = (undefined4 *)0x1;
    }
    iVar9 = DAT_00117ef8;
    dVar17 = *(double *)(iVar13 + 0x860);
    if (bVar15) {
        DAT_00117ef0 = puVar2;
    }
    DAT_00117f00 = DAT_00117f00 + 1;
    DAT_00117ee0 = iVar5;
    if ((dVar17 < 2500.0) || (*(double *)(iVar13 + 0x868) < 15.0)) {
        DAT_00117f04 = 0;
        DAT_00117f08 = 0;
        *(uint *)(iVar13 + 0x10e8) = *(uint *)(iVar13 + 0x10e8) & 0xffffffed;
        DAT_00117f0c = 0;
        iVar11 = DAT_00117f14;
    } else {
        uVar14 = *(uint *)(iVar13 + 0x10e8);
        iVar11 = DAT_00117f14;
        if ((uVar14 & 0x300) != 0) {
            DAT_00117ef8 = DAT_00117ef4;
            DAT_00117efc = iVar9;
            DAT_00117f10 = iVar5;
            if (DAT_00117ef4 < iVar5) {
                if (iVar9 < DAT_00117ef4)
                    goto LAB_000699c4;
                if (iVar9 <= iVar5) {
                    DAT_00117f10 = iVar9;
                }
            } else if (DAT_00117ef4 < iVar9) {
            LAB_000699c4:
                DAT_00117f10 = DAT_00117ef4;
            } else if (iVar5 <= iVar9) {
                DAT_00117f10 = iVar9;
            }
            iVar11 = DAT_00117f10;
            iVar9 = (DAT_00117f10 - DAT_00117f14) % 8000;
            DAT_00117ef4 = iVar5;
            if (iVar9 == 0) {
                DAT_00117f08 = DAT_00117f08 + 1;
                if (((10 < DAT_00117f08) && ((uVar14 & 1) != 0)) &&
                    (((uVar14 & 0x10) != 0 || (DAT_00117f00 - DAT_00117f18 <=
                                               *(int *)(iVar13 + 0x850))))) {
                    *(uint *)(iVar13 + 0x10e8) = uVar14 | 2;
                    *(int *)(iVar13 + 0x854) = iVar11;
                }
            } else if (DAT_00117f04 <= DAT_00117f08) {
                DAT_00117f04 = DAT_00117f08;
                DAT_00117f20 = DAT_00117f14;
                DAT_00117f08 = 0;
                DAT_00117f1c = DAT_00117f00;
            }
            if (((*(byte *)(piVar4 + 0xc0) & 8) != 0) &&
                ((*(uint *)(iVar13 + 0x10e8) & 1) == 0)) {
                FUN_0007d00c(auStack_dc, 0x80,
                             "wwv1 %04x %3d %4d %5.0f %5.1f %5d %4d %4d %4d",
                             *(uint *)(iVar13 + 0x10e8),
                             *(undefined4 *)(iVar13 + 0x844), iVar11, dVar17,
                             *(double *)(iVar13 + 0x868), iVar9, DAT_00117f0c,
                             DAT_00117f08, DAT_00117f04);
                FUN_00052d0c(param_1 + 0x10, auStack_dc);
                iVar11 = DAT_00117f10;
            }
            iVar5 = *(int *)(iVar13 + 0x850);
            DAT_00117f0c = DAT_00117f0c + 1;
            if (iVar5 <= DAT_00117f0c) {
                if (DAT_00117f04 <= DAT_00117f08) {
                    DAT_00117f04 = DAT_00117f08;
                    DAT_00117f1c = DAT_00117f00;
                    DAT_00117f20 = DAT_00117f14;
                }
                iVar1 = DAT_00117f04;
                iVar12 = 0x118560;
                uVar14 = *(uint *)(iVar13 + 0x10e8);
                iVar9 = iVar11;
                iVar3 = DAT_00117f00;
                iVar6 = DAT_00117f00;
                if (DAT_00117f04 != 0) {
                    iVar9 = DAT_00117f20;
                    iVar12 = DAT_00117f1c;
                    iVar3 = DAT_00117f1c;
                    iVar6 = DAT_00117f08;
                }
                DAT_00117f1c = iVar3;
                iVar3 = iVar9 - DAT_00117f24;
                DAT_00117f14 = iVar11;
                if (DAT_00117f04 == 0) {
                    *(int *)(iVar12 + -0x640) = iVar9;
                    iVar12 = iVar6;
                }
                dVar17 = (double)(longlong)(iVar3 % 8000);
                if ((uVar14 & 0x10) != 0) {
                    if (12.0 <= ABS(dVar17)) {
                        if (DAT_00117f28 + 2 < 0 == SCARRY4(DAT_00117f28, 2)) {
                            DAT_00117f28 = DAT_00117f28 + -1;
                        } else if (8 < iVar5) {
                            *(int *)(iVar13 + 0x850) = iVar5 >> 1;
                            DAT_00117f28 = 0;
                        }
                    } else {
                        dVar20 =
                            (dVar17 * 0.5) /
                                (double)(longlong)((iVar12 - DAT_00117f18) *
                                                   3) +
                            *(double *)(iVar13 + 0x18);
                        if (1.5 < dVar20) {
                            *(undefined8 *)(iVar13 + 0x18) = 0x3ff8000000000000;
                        } else {
                            if (dVar20 < -1.5) {
                                dVar20 = -1.5;
                            }
                            *(double *)(iVar13 + 0x18) = dVar20;
                        }
                        if (ABS(dVar17) < 6.0) {
                            if (DAT_00117f28 < 3) {
                                DAT_00117f28 = DAT_00117f28 + 1;
                            } else if (iVar5 < 0x400) {
                                *(int *)(iVar13 + 0x850) = iVar5 << 1;
                                DAT_00117f28 = 0;
                            }
                        }
                    }
                }
                if ((*(byte *)(piVar4 + 0xc0) & 8) != 0) {
                    FUN_0007d00c(
                        auStack_dc, 0x80,
                        "wwv2 %04x %5.0f %5.1f %5d %4d %4d %4d %4.0f %7.2f",
                        uVar14, *(double *)(iVar13 + 0x860),
                        *(undefined8 *)(iVar13 + 0x868), iVar9,
                        *(undefined4 *)(iVar13 + 0x850), iVar1,
                        iVar12 - DAT_00117f18, dVar17,
                        (*(double *)(iVar13 + 0x18) * 1000000.0) / 8000.0);
                    FUN_00052d0c(param_1 + 0x10, auStack_dc);
                    uVar14 = *(uint *)(iVar13 + 0x10e8);
                    iVar9 = DAT_00117f20;
                    iVar12 = DAT_00117f1c;
                }
                *(uint *)(iVar13 + 0x10e8) = uVar14 | 0x10;
                DAT_00117f04 = 0;
                DAT_00117f08 = 0;
                DAT_00117f0c = 0;
                iVar11 = DAT_00117f14;
                DAT_00117f18 = iVar12;
                DAT_00117f24 = iVar9;
            }
        }
    }
    DAT_00117f14 = iVar11;
    if ((*(uint *)(iVar7 + 0x10e8) & 2) == 0) {
        *(uint *)(iVar7 + 0x10ec) = *(uint *)(iVar7 + 0x10ec) | 8;
    }
    DAT_00117ed8 = 0.0;
    if ((*(uint *)(iVar7 + 0x10e8) & 1) == 0) {
        FUN_00066d1c(*(undefined4 *)(param_1 + 0x54));
    }
LAB_00069034:
    if (local_5c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00069d88(undefined4 param_1, int param_2)

{
    ssize_t sVar1;
    int iVar2;
    bool bVar3;
    undefined1 local_15;
    int local_14;

    local_14 = __stack_chk_guard;
    bVar3 = *(char *)(**(int **)(param_2 + 0x54) + 0xd) != '\0';
    iVar2 = __stack_chk_guard;
    if (bVar3) {
        iVar2 = 0x52;
    }
    local_15 = (undefined1)iVar2;
    if (!bVar3) {
        local_15 = 0x54;
    }
    sVar1 = write((*(int **)(param_2 + 0x54))[7], &local_15, 1);
    if (sVar1 != 1) {
        FUN_00049c88(param_2, 3);
    }
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00069f5c(int param_1)

{
    undefined4 uVar1;
    undefined4 uVar2;
    int iVar3;
    undefined4 *puVar4;
    undefined4 *puVar5;
    char *__s;
    int iVar6;
    int iVar7;
    undefined8 uVar8;
    char local_3d;
    undefined1 local_3c;
    char local_3b[3];
    undefined4 local_38;
    undefined4 local_34;
    undefined4 local_30;
    undefined4 local_2c;
    undefined4 uStack_28;
    int local_24;

    iVar6 = *(int *)(param_1 + 4);
    puVar5 = *(undefined4 **)(iVar6 + 0x54);
    __s = (char *)(puVar5 + 0xe);
    puVar4 = (undefined4 *)*puVar5;
    local_24 = __stack_chk_guard;
    uVar8 = FUN_0004a6d4(param_1, __s, 0x80, &local_2c);
    iVar3 = (int)uVar8;
    if (iVar3 == 0) {
        iVar3 = puVar4[2];
        uVar1 = 0;
        uVar2 = (int)((ulonglong)uVar8 >> 0x20);
        if (iVar3 == 0) {
            uVar1 = local_2c;
            uVar2 = uStack_28;
        }
        puVar4[2] = (uint)(iVar3 == 0);
        if (iVar3 == 0) {
            *puVar4 = uVar1;
            puVar4[1] = uVar2;
        }
        goto LAB_00069fc4;
    }
    uVar1 = *puVar4;
    uVar2 = puVar4[1];
    puVar5[0x2e] = iVar3;
    puVar5[0x3a] = uVar1;
    puVar5[0x3b] = uVar2;
    iVar7 = puVar5[0x3b];
    puVar4[2] = 1;
    *puVar4 = local_2c;
    puVar4[1] = uStack_28;
    if (iVar7 == 0 && puVar5[0x3a] == 0)
        goto LAB_00069fc4;
    local_3b[1] = 0x20;
    local_3b[0] = ' ';
    local_3c = 0x20;
    local_3d = ' ';
    local_38 = 0;
    if (iVar3 == 0x18) {
        iVar3 = sscanf(__s, "%c%c %2d %3d %2d:%2d:%2d.%3ld %c", &local_3d,
                       &local_3c, puVar5 + 0x2f, puVar5 + 0x30, puVar5 + 0x31,
                       puVar5 + 0x32, puVar5 + 0x33, puVar5 + 0x34, local_3b);
        if (iVar3 != 9)
            goto LAB_0006a040;
        puVar5[0x34] = puVar5[0x34] * 1000000;
    } else if (iVar3 == 0x1d) {
        iVar3 = sscanf(__s, "0003%c %4d%2d%2d %2d%2d%2d+0000%c%c", &local_3d,
                       puVar5 + 0x2f, &local_30, &local_34, puVar5 + 0x31,
                       puVar5 + 0x32, puVar5 + 0x33, local_3b + 1, local_3b);
        if (iVar3 != 8)
            goto LAB_0006a040;
        uVar1 = FUN_0007fbfc(puVar5[0x2f], local_30, local_34);
        puVar5[0x34] = 0;
        puVar5[0x30] = uVar1;
    } else {
        if ((iVar3 != 0x16) ||
            (iVar3 =
                 sscanf(__s, "%c %3d %2d:%2d:%2d%c%cTZ=%2d", &local_3d,
                        puVar5 + 0x30, puVar5 + 0x31, puVar5 + 0x32,
                        puVar5 + 0x33, local_3b + 2, local_3b + 1, &local_38),
             iVar3 != 8)) {
        LAB_0006a040:
            if (*(char *)((int)puVar4 + 0xd) == '\0') {
                FUN_00049c88(iVar6, 2);
            } else {
                *(char *)((int)puVar4 + 0xd) =
                    *(char *)((int)puVar4 + 0xd) + -1;
                FUN_00052d0c(iVar6 + 0x10, __s);
            }
            goto LAB_00069fc4;
        }
        puVar5[0x34] = 0;
    }
    switch (local_3c) {
    case 0x20:
        puVar5[0x3e] = 0xd2f1a9fc;
        puVar5[0x3f] = 0x3f50624d;
        puVar5[0x38] = puVar5[0x3a];
        puVar5[0x39] = puVar5[0x3b];
        goto LAB_0006a274;
    case 0x21:
        break;
    case 0x22:
        break;
    case 0x23:
        break;
    case 0x24:
        break;
    case 0x25:
        break;
    case 0x26:
        break;
    case 0x27:
        break;
    case 0x28:
        break;
    case 0x29:
        break;
    case 0x2a:
        break;
    case 0x2b:
        break;
    case 0x2c:
        break;
    case 0x2d:
        break;
    case 0x2e:
        break;
    case 0x2f:
        break;
    case 0x30:
        break;
    case 0x31:
        break;
    case 0x32:
        break;
    case 0x33:
        break;
    case 0x34:
        break;
    case 0x35:
        break;
    case 0x36:
        break;
    case 0x37:
        break;
    case 0x38:
        break;
    case 0x39:
        break;
    case 0x3a:
        break;
    case 0x3b:
        break;
    case 0x3c:
        break;
    case 0x3d:
        break;
    case 0x3e:
        break;
    case 0x3f:
        break;
    case 0x40:
        break;
    case 0x41:
        puVar5[0x3e] = 0x47ae147b;
        puVar5[0x3f] = 0x3f847ae1;
        goto LAB_0006a274;
    case 0x42:
        puVar5[0x3e] = 0x9999999a;
        puVar5[0x3f] = 0x3fb99999;
        goto LAB_0006a274;
    case 0x43:
        puVar5[0x3e] = 0;
        puVar5[0x3f] = 0x3fe00000;
        goto LAB_0006a274;
    case 0x44:
        puVar5[0x3e] = 0;
        puVar5[0x3f] = 0x40300000;
        goto LAB_0006a274;
    }
    puVar5[0x3e] = 0;
    puVar5[0x3f] = 0x40300000;
    FUN_00049c88(iVar6, 2);
LAB_0006a274:
    if (local_3d == ' ') {
        *(bool *)(puVar5 + 10) = local_3b[0] == 'L';
    } else {
        *(undefined1 *)(puVar5 + 10) = 3;
    }
    iVar3 = FUN_0004a3b0((int)*(undefined8 *)(puVar5 + 0xbc), puVar5);
    if (iVar3 == 0) {
        FUN_00049c88(iVar6, 6);
    }
LAB_00069fc4:
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0006a474(undefined4 param_1, int param_2)

{
    int iVar1;
    int *piVar2;
    int iVar3;
    bool bVar4;

    iVar1 = __stack_chk_guard;
    piVar2 = *(int **)(param_2 + 0x54);
    iVar3 = *piVar2;
    if (*(int *)(iVar3 + 0x20) == 0) {
        FUN_00049c88(param_2, 1);
    } else {
        *(int *)(iVar3 + 0x20) = *(int *)(iVar3 + 0x20) + -1;
    }
    bVar4 = iVar1 == __stack_chk_guard;
    piVar2[0xc2] = piVar2[0xc2] + 1;
    *(undefined1 *)(iVar3 + 0x1e) = 1;
    if (bVar4) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0006a6d8(int param_1)

{
    int iVar1;
    int *piVar2;
    int iVar3;
    int iVar4;
    int local_28;
    undefined1 auStack_24[4];
    int local_20;
    int local_1c;

    iVar3 = *(int *)(param_1 + 4);
    piVar2 = *(int **)(iVar3 + 0x54);
    iVar1 = piVar2[0x2e];
    iVar4 = *piVar2;
    local_1c = __stack_chk_guard;
    if (iVar1 < 0x1d) {
        if (iVar1 == 0)
            goto LAB_0006a788;
        memcpy((void *)((int)piVar2 + iVar1 + 0x38), (void *)(param_1 + 0x58),
               *(size_t *)(param_1 + 0x54));
        iVar1 = piVar2[0x2e] + *(int *)(param_1 + 0x54);
        piVar2[0x2e] = iVar1;
        *(undefined1 *)((int)piVar2 + iVar1 + 0x38) = 0;
    } else {
        piVar2[0x2e] = 0;
    LAB_0006a788:
        if (*(char *)(param_1 + 0x58) != '!')
            goto LAB_0006a794;
        iVar1 = FUN_0004a6d4(param_1, piVar2 + 0xe, 0x80, piVar2 + 0x3a);
        piVar2[0x2e] = iVar1;
    }
    if (iVar1 < 0x1d)
        goto LAB_0006a794;
    FUN_00052d0c(iVar3 + 0x10, piVar2 + 0xe);
    if (piVar2[0x2e] == 0x1d) {
        iVar1 =
            sscanf((char *)(piVar2 + 0xe), "!TIME,%4d,%3d,%2d,%2d,%2d,%d,%d,%d",
                   piVar2 + 0x2f, piVar2 + 0x30, piVar2 + 0x31, piVar2 + 0x32,
                   piVar2 + 0x33, &local_28, auStack_24, &local_20);
        if (iVar1 != 8) {
            FUN_00049c88(iVar3, 2);
            goto LAB_0006a794;
        }
        if (local_28 == 2) {
            if (local_20 != 1) {
                *(undefined1 *)(piVar2 + 10) = 3;
                goto LAB_0006a794;
            }
            iVar1 = FUN_0004a4e8(piVar2);
            if (iVar1 != 0) {
                *(undefined4 *)(iVar4 + 0x20) = 2;
                if (*(char *)(iVar4 + 0x1e) != '\0') {
                    *(undefined1 *)(iVar4 + 0x1e) = 0;
                    FUN_0004a534(iVar3);
                }
                goto LAB_0006a794;
            }
        }
    }
    FUN_00049c88(iVar3, 6);
LAB_0006a794:
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0006a9a0(undefined4 param_1, int param_2)

{
    bool bVar1;
    uint *puVar2;
    undefined **ppuVar3;
    int iVar4;
    uint uVar5;
    uint uVar6;
    char *pcVar7;
    size_t sVar8;
    int iVar9;
    undefined1 *puVar10;
    uint extraout_r2;
    undefined4 extraout_r2_00;
    undefined4 extraout_r2_01;
    undefined4 *puVar11;
    char *pcVar12;
    int iVar13;
    int extraout_r3;
    undefined4 extraout_r3_00;
    undefined4 extraout_r3_01;
    undefined4 *puVar14;
    int iVar15;
    int iVar16;
    undefined4 *puVar17;
    int iVar18;
    double dVar19;
    undefined8 uVar20;
    undefined2 local_1b8;
    undefined2 local_1b6;
    undefined4 local_1b4;
    undefined4 local_1b0;
    undefined4 local_1ac;
    undefined4 local_1a8;
    int local_1a4;
    int local_1a0;
    undefined4 local_19c;
    undefined4 local_198;
    undefined4 local_194;
    undefined4 local_190;
    undefined4 local_18c;
    undefined4 local_188;
    undefined4 local_184;
    undefined4 local_180;
    undefined4 local_17c;
    undefined2 local_170;
    undefined2 local_16e;
    undefined4 local_16c;
    undefined4 local_168;
    undefined4 local_164;
    undefined4 local_160;
    int local_15c;
    int local_158;
    uint local_154;
    undefined4 local_150;
    undefined4 local_14c;
    undefined2 local_140;
    undefined2 local_13e;
    undefined4 local_13c;
    undefined4 local_138;
    undefined4 local_134;
    undefined4 local_130;
    int local_12c;
    int local_128;
    undefined4 local_124;
    char *local_120;
    uint local_11c;
    undefined4 local_118;
    uint local_108;
    char *local_104;
    uint local_100;
    int local_fc;
    uint local_f8;
    int iStack_f4;
    char *local_f0;
    uint *local_ec;
    char *local_e8;
    uint local_e4;
    int *local_e0;
    undefined **local_dc;
    int local_d8;
    int local_d4;
    ushort local_d0[2];
    undefined1 local_cc;
    undefined1 local_cb;
    undefined1 local_ca;
    undefined1 local_c9;
    undefined1 local_c8;
    undefined1 uStack_c5;
    int local_c4;
    uint local_c0;
    uint local_bc;
    int local_b8;
    int local_b4;
    int local_b0;
    undefined1 auStack_a8[4];
    uint uStack_a4;
    byte local_9f;
    byte local_9e;
    ushort local_9c;
    ushort local_9a;
    ushort local_98;
    int local_94;
    int iStack_90;
    int local_88[7];
    undefined4 local_6c;
    undefined1 local_68;
    char *local_64;
    undefined1 local_60;
    char acStack_5c[32];
    int local_3c;

    local_dc = &__DT_PLTGOT;
    local_11c = (uint) * (byte *)(param_2 + 0x59);
    local_e0 = &__stack_chk_guard;
    local_120 = "/dev/tsyncpci";
    local_3c = __stack_chk_guard;
    __sprintf_chk(acStack_5c, 1, 0x20, &DAT_000ab3b0);
    __printf_chk(1, "Polling device number %d...\n",
                 *(undefined1 *)(param_2 + 0x59));
    local_88[0] = open64(acStack_5c, 0x800, 0x1ff);
    if (local_88[0] < 0) {
        FUN_00075d40(3, "Couldn\'t open device");
        goto LAB_0006abc0;
    }
    iVar4 = ioctl(local_88[0], 0xc01c7400, local_88);
    if (iVar4 < 0) {
        FUN_00075d40(3, "Couldn\'t initialize device");
        close(local_88[0]);
        goto LAB_0006abc0;
    }
    local_13e = 0x2500;
    local_140 = 1;
    local_130 = 0x10;
    local_13c = 0;
    local_138 = 0;
    local_134 = 0;
    local_12c = 0;
    local_128 = 0;
    local_124 = 0;
    local_120 = (char *)0x0;
    local_11c = 0;
    local_118 = 0;
    local_e4 = ioctl(local_88[0], 0xc020741a, &local_140);
    local_170 = 1;
    local_16c = 0;
    local_168 = 0;
    local_164 = 0;
    local_15c = 0;
    local_158 = 0;
    local_154 = 0;
    local_150 = 0;
    local_14c = 0;
    local_16e = 0x2301;
    local_160 = 0xc;
    uVar5 = ioctl(local_88[0], 0xc020741a, &local_170);
    local_1b6 = 0x2307;
    local_1a8 = 0x24;
    local_1b8 = 1;
    local_1b4 = 0;
    local_1b0 = 0;
    local_1ac = 0;
    local_1a4 = 0;
    local_1a0 = 0;
    local_19c = 0;
    local_198 = 0;
    local_194 = 0;
    local_190 = 0;
    local_18c = 0;
    local_188 = 0;
    local_184 = 0;
    local_180 = 0;
    local_17c = 0;
    local_e8 = (char *)ioctl(local_88[0], 0xc020741a, &local_1b8);
    puVar17 = *(undefined4 **)(param_2 + 0x54);
    local_ec = (uint *)*puVar17;
    uVar6 = ioctl(local_88[0], 0xc0207419, auStack_a8);
    close(local_88[0]);
    ppuVar3 = local_dc;
    if (((((int)(local_e4 | uVar5) < 0) ||
          ((int)((uint)local_e8 | uVar6) < 0)) ||
         (local_128 != 0)) ||
        (((local_158 != 0 || (local_1a0 != 0)) ||
          ((local_12c != 8 || ((local_15c != 4 || (local_1a4 != 0x1c)))))))) {
        FUN_00049c88(param_2, 3);
        goto LAB_0006abc0;
    }
    puVar14 = &local_198;
    local_6c = local_124;
    local_100 = local_154 << 0x18 | (local_154 >> 8 & 0xff) << 0x10 |
                (local_154 >> 0x10 & 0xff) << 8 | local_154 >> 0x18;
    iVar4 = 0;
    local_64 = local_120;
    local_68 = 0;
    local_60 = 0;
    do {
        puVar10 = &uStack_c5 + iVar4;
        puVar11 = puVar14;
        do {
            puVar11 = (undefined4 *)((int)puVar11 + -1);
            puVar10 = puVar10 + 1;
            *puVar10 = *(undefined1 *)puVar11;
        } while (puVar14 + -1 != puVar11);
        iVar4 = iVar4 + 4;
        puVar14 = puVar14 + 1;
    } while (iVar4 != 0x1c);
    pcVar12 = "gps";
    local_e4 = 0;
    do {
        pcVar7 = strstr((char *)&local_6c, pcVar12);
        if (pcVar7 != (char *)0x0)
            break;
        local_e4 = local_e4 + 1;
        pcVar12 = *(char **)(&DAT_000c5b04 + local_e4 * 8);
    } while (pcVar12 != (char *)0x0);
    pcVar7 = "gps";
    iVar4 = 0;
    local_f0 = pcVar12;
    local_dc = ppuVar3;
    do {
        pcVar12 = strstr((char *)&local_64, pcVar7);
        if (pcVar12 != (char *)0x0)
            break;
        iVar4 = iVar4 + 1;
        pcVar7 = *(char **)(&DAT_000c5b04 + iVar4 * 8);
    } while (pcVar7 != (char *)0x0);
    local_f8 = (uint)local_98;
    dVar19 = (double)(longlong)iStack_90 / 1000000.0;
    bVar1 = dVar19 < 0.0;
    if (bVar1) {
        dVar19 = -dVar19;
    }
    local_104 = pcVar7;
    local_fc = iVar4;
    local_dc = ppuVar3;
    dVar19 = ldexp(dVar19, 0x20);
    local_e8 = (char *)(puVar17 + 0xe);
    uVar20 = VectorShiftRight((ulonglong)CONCAT14(bVar1, (uint)bVar1), 0x20);
    iVar4 = (int)((ulonglong)uVar20 >> 0x20);
    uVar6 = (uint)uVar20;
    uVar20 = FUN_0009d558(SUB84(dVar19, 0), (int)((ulonglong)dVar19 >> 0x20));
    local_108 = (uint)local_9c;
    puVar17[0xc2] = puVar17[0xc2] + 1;
    uVar5 = -uVar6 ^ (uint)uVar20;
    puVar17[0x3a] =
        local_94 + -0x7c558180 + iVar4 +
        (-(iVar4 + (uint)(uVar6 != 0)) ^ (uint)((ulonglong)uVar20 >> 0x20)) +
        (uint)CARRY4(uVar6, uVar5);
    puVar17[0x3b] = uVar6 + uVar5;
    __sprintf_chk(local_e8, 1, 0x80, "%03d %02d:%02d:%02.6f");
    sVar8 = strlen(local_e8);
    iVar4 = (int)(longlong)((double)uStack_a4 / 1000000.0);
    puVar17[0x30] = (uint)local_9c;
    puVar17[0x31] = (uint)local_9e;
    puVar17[0x32] = (uint)local_9f;
    local_d0[1] = 1;
    puVar17[0x33] = iVar4;
    local_d0[0] = local_9a;
    local_cb = 1;
    local_cc = 1;
    local_ca = 0;
    local_c9 = 0;
    local_c8 = 0;
    puVar17[0x2e] = sVar8;
    puVar17[0x34] = (int)(longlong)(((double)uStack_a4 / 1000000.0 -
                                     (double)(longlong)iVar4) *
                                    1000000000.0);
    iVar4 = FUN_00074130(local_d0);
    iVar9 = puVar17[0x30];
    iVar18 = puVar17[0x31];
    iVar13 = puVar17[0x32];
    iVar16 = puVar17[0x33];
    dVar19 = (double)(longlong)(int)puVar17[0x34] / 1000000000.0;
    puVar17[0x35] = iVar4;
    bVar1 = dVar19 < 0.0;
    if (bVar1) {
        dVar19 = -dVar19;
    }
    dVar19 = ldexp(dVar19, 0x20);
    uVar20 = VectorShiftRight((ulonglong)CONCAT14(bVar1, (uint)bVar1), 0x20);
    iVar15 = (int)((ulonglong)uVar20 >> 0x20);
    uVar6 = (uint)uVar20;
    uVar20 = FUN_0009d558(SUB84(dVar19, 0), (int)((ulonglong)dVar19 >> 0x20));
    uVar5 = -uVar6 ^ (uint)uVar20;
    local_d4 = uVar6 + uVar5;
    local_d8 =
        (((iVar9 + -1) * 0x18 + iVar18) * 0x3c + iVar13) * 0x3c + iVar16 +
        iVar4 + iVar15 +
        (-(iVar15 + (uint)(uVar6 != 0)) ^ (uint)((ulonglong)uVar20 >> 0x20)) +
        (uint)CARRY4(uVar6, uVar5);
    FUN_0004a258((int)*(undefined8 *)(puVar17 + 0xba), puVar17, local_d8,
                 local_d4, puVar17[0x3a]);
    if (local_f8 == 4) {
        iVar9 = (local_c0 - 0x7b2) * 0x1e13380 +
                (local_c0 - 0x7b1 >> 2) * 0x15180 + local_b4 * 0x3c +
                local_b8 * 0xe10 + local_bc * 0x15180 + local_b0 + -0x15181;
        iVar4 = FUN_0009d478(iVar9, 0, 0x7861f80, 0);
        iVar4 = iVar4 * 4;
        FUN_0009d478(iVar9, 0, 0x7861f80, 0);
        iVar9 = iVar4;
        local_f8 = extraout_r2;
        iStack_f4 = extraout_r3;
        if (0 < (int)(extraout_r3 + (uint)(0x1e1337f < extraout_r2)) !=
            SBORROW4(-extraout_r3, (uint)(0x1e1337f < extraout_r2))) {
            local_f8 = extraout_r2 + 0xfe1ecc80;
            iStack_f4 = extraout_r3 + -1 + (uint)(0x1e1337f < extraout_r2);
            iVar9 = iVar4 + 1;
            if (0 < (int)(iStack_f4 + (uint)(0x1e1337f < local_f8)) !=
                SBORROW4(-iStack_f4, (uint)(0x1e1337f < local_f8))) {
                local_f8 = extraout_r2 + 0xfc3d9900;
                iStack_f4 = extraout_r3 + -1 + (uint)(0x3c266ff < extraout_r2);
                iVar9 = iVar4 + 2;
                if (0 < (int)(iStack_f4 + (uint)(0x1e284ff < local_f8)) !=
                    SBORROW4(-iStack_f4, (uint)(0x1e284ff < local_f8))) {
                    local_f8 = extraout_r2 + 0xfa5b1400;
                    iStack_f4 =
                        extraout_r3 + -1 + (uint)(0x5a4ebff < extraout_r2);
                    iVar9 = iVar4 + 3;
                }
            }
        }
        iVar4 = iStack_f4;
        uVar5 = local_f8;
        iVar13 = FUN_0009d478(local_f8, iStack_f4, "", 0);
        FUN_0009d478(uVar5, iVar4, "", 0);
        FUN_0009d478(extraout_r2_00, extraout_r3_00, 0xe10, 0);
        local_c0 = iVar9 + 0x7b2U;
        local_bc = iVar13 + 1U;
        local_b8 = FUN_0009d478(extraout_r2_00, extraout_r3_00, 0xe10, 0);
        local_b4 = FUN_0009d478(extraout_r2_01, extraout_r3_01, 0x3c, 0);
        FUN_0009d478(extraout_r2_01, extraout_r3_01, 0x3c, 0);
        if (((local_100 - 1 < 2) || ((uint)local_9a != iVar9 + 0x7b2U)) ||
            ((uint)local_9c != iVar13 + 1U)) {
        LAB_0006b268:
            local_c4 = 0;
        LAB_0006b26c:
            *(char *)(puVar17 + 10) = (char)local_c4;
        } else {
            if (local_c4 == 1)
                goto LAB_0006b26c;
            if (local_c4 != -1)
                goto LAB_0006b268;
            *(undefined1 *)(puVar17 + 10) = 2;
        }
        *(undefined1 *)(param_2 + 0x5b) = *(undefined1 *)(puVar17 + 10);
        FUN_00049c88(param_2, 0);
        if ((local_f0 == (char *)0x0) || (local_104 == (char *)0x0)) {
            uVar5 = local_ec[1];
            *(uint *)(param_2 + 0x44) = *(uint *)(param_2 + 0x44) | *local_ec;
            puVar17[0xbf] = uVar5;
            *(uint *)(param_2 + 0x70) = uVar5;
            uVar5 = local_ec[2];
            *(char *)(puVar17 + 0xbe) = (char)uVar5;
            *(char *)(param_2 + 0x5d) = (char)uVar5;
        } else {
            iVar9 = strcmp(*(char **)(&DAT_000c5b08 + local_e4 * 8), "LOCL");
            iVar4 = local_fc * 8;
            if (iVar9 == 0) {
            LAB_0006b2ec:
                puVar2 = local_ec;
                *(uint *)(param_2 + 0x44) =
                    *(uint *)(param_2 + 0x44) & 0xffffffdf;
                *(undefined1 *)(puVar17 + 0xbe) = 0x10;
                *(undefined1 *)(param_2 + 0x5d) = 0x10;
                iVar9 = *(int *)local_dc[0x241];
                if (param_2 != iVar9 && iVar9 != 0) {
                    *(undefined1 *)(local_ec + 2) =
                        *(undefined1 *)(iVar9 + 0x5d);
                    uVar5 = FUN_00071720(iVar9 + 0x10);
                    puVar2[1] = uVar5;
                }
            } else {
                pcVar12 = *(char **)(&DAT_000c5b08 + iVar4);
                iVar9 = strcmp(pcVar12, "LOCL");
                if (iVar9 == 0)
                    goto LAB_0006b2ec;
                *(uint *)(param_2 + 0x44) =
                    *(uint *)(param_2 + 0x44) | *local_ec;
                *(undefined1 *)(local_ec + 2) = 0;
                strncpy((char *)(local_ec + 1), pcVar12, 4);
                *(undefined1 *)(puVar17 + 0xbe) = 0;
                *(undefined1 *)(param_2 + 0x5d) = 0;
            }
            strncpy((char *)(puVar17 + 0xbf), *(char **)(&DAT_000c5b08 + iVar4),
                    4);
            *(undefined4 *)(param_2 + 0x70) = puVar17[0xbf];
        }
    } else {
        puVar17[0xbf] = 0x4c434f4c;
        *(undefined4 *)(param_2 + 0x70) = puVar17[0xbf];
        *(undefined1 *)(puVar17 + 10) = 3;
        *(undefined1 *)(param_2 + 0x5b) = 3;
    }
    if (puVar17[0x36] == puVar17[0x37]) {
        FUN_00049c88(param_2, 1);
    } else {
        FUN_00052d0c(param_2 + 0x10, local_e8);
        FUN_0004a534(param_2);
        puVar17[0xc2] = puVar17[0xc2] + 1;
    }
LAB_0006abc0:
    if (local_3c != *local_e0) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0006b410(int param_1)

{
    int iVar1;
    undefined4 *puVar2;
    undefined4 *puVar3;
    char acStack_9c[128];
    int local_1c;

    puVar2 = *(undefined4 **)(param_1 + 0x54);
    puVar3 = (undefined4 *)*puVar2;
    local_1c = __stack_chk_guard;
    if (puVar2[7] != -1) {
        FUN_00036294(0x8b, param_1, "close");
        iVar1 = ioctl(puVar2[7], 0x5417);
        if (iVar1 < 0) {
            FUN_00075d40(3, "acts: ioctl(TIOCMBIC) failed: %m");
        }
        FUN_000290fc(puVar2 + 2);
        puVar2[7] = 0xffffffff;
    }
    if ((*(byte *)(puVar2 + 0xc0) & 2) != 0) {
        FUN_0007d00c(acStack_9c, 0x80, "/var/spool/lock/LCK..cua%d", *puVar3);
        unlink(acStack_9c);
    }
    if (((puVar3[4] == 0) && (0 < (int)puVar3[3])) &&
        (*(int *)(sys_phone + puVar3[3] * 4) != 0)) {
        puVar3[1] = 0;
        puVar3[2] = 0x1e;
    } else {
        puVar3[1] = 0;
        puVar3[2] = 0;
    }
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0006b548(int param_1, undefined4 param_2)

{
    undefined *__buf;
    int iVar1;
    int iVar2;
    size_t sVar3;
    ssize_t sVar4;
    __pid_t _Var5;
    undefined4 *puVar6;
    undefined4 *puVar7;
    char acStack_c0[8];
    undefined1 auStack_b8[20];
    char acStack_a4[128];
    int local_24;

    puVar6 = *(undefined4 **)(param_1 + 0x54);
    puVar7 = (undefined4 *)*puVar6;
    local_24 = __stack_chk_guard;
    switch (param_2) {
    case 0:
        if (puVar6[7] == -1) {
            if ((*(byte *)(puVar6 + 0xc0) & 2) != 0) {
                FUN_0007d00c(acStack_a4, 0x80, "/var/spool/lock/LCK..cua%d",
                             *puVar7);
                iVar1 = open64(acStack_a4, 0xc1, 0x1a4);
                if (iVar1 < 0) {
                    FUN_00036294(0x8b, param_1, "acts: port busy");
                    goto LAB_0006b5ac;
                }
                _Var5 = getpid();
                FUN_0007d00c(acStack_c0, 8, "%d\n", _Var5);
                sVar3 = strlen(acStack_c0);
                sVar4 = write(iVar1, acStack_c0, sVar3);
                if (sVar4 < 0) {
                    FUN_00075d40(3, "acts: write lock fails %m");
                }
                close(iVar1);
            }
            FUN_0007d00c(auStack_b8, 0x14, "/dev/acts%d", *puVar7);
            iVar1 = FUN_0004aa90(auStack_b8, 0xe, 0xa4);
            if (iVar1 < 0) {
                FUN_00075d40(3, "acts: open fails %m");
            } else {
                puVar6[7] = iVar1;
                iVar2 = FUN_00029084(puVar6 + 2);
                if (iVar2 == 0) {
                    FUN_00075d40(3, "acts: addclock fails");
                    close(iVar1);
                    puVar6[7] = 0xffffffff;
                } else {
                    puVar7[4] = 0;
                    puVar7[7] = puVar7 + 8;
                    if (*(int *)(sys_phone + puVar7[3] * 4) == 0) {
                        sVar4 = write(puVar6[7], "T", 1);
                        if (sVar4 < 0) {
                            FUN_00075d40(3, "acts: write T fails %m");
                        }
                        puVar7[1] = 3;
                        puVar7[2] = 0x3c;
                    } else {
                        FUN_000366ac(0x8b, param_1, "SETUP %s", modem_setup);
                        __buf = modem_setup;
                        sVar3 = strlen(modem_setup);
                        sVar4 = write(puVar6[7], __buf, sVar3);
                        if (sVar4 < 0) {
                            FUN_00075d40(3, "acts: write SETUP fails %m");
                        }
                        write(puVar6[7], "\r", 1);
                        puVar7[1] = 1;
                        puVar7[2] = 3;
                    }
                }
            }
        }
        goto LAB_0006b5ac;
    case 1:
        FUN_00036294(0x8b, param_1, "no modem");
        break;
    case 2:
        FUN_00036294(0x8b, param_1, "no answer");
        break;
    case 3:
        if (puVar7[4] == 0) {
            FUN_00036294(0x8b, param_1, "no timecodes");
        } else {
            puVar6[0x38] = puVar6[0x3a];
            puVar6[0x39] = puVar6[0x3b];
            FUN_00052d0c(param_1 + 0x10, puVar6 + 0xe);
            FUN_0004a534(param_1);
        }
    }
    FUN_0006b410(param_1);
LAB_0006b5ac:
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0006ba64(int param_1)

{
    ushort **ppuVar1;
    size_t sVar2;
    ssize_t sVar3;
    byte *pbVar4;
    int iVar5;
    int *piVar6;
    int iVar7;
    int iVar8;
    byte *__buf;
    int iVar9;
    char *__s;
    int *piVar10;
    int iVar11;
    uint uVar12;
    char *__s_00;
    int iVar13;
    int *piVar14;
    int *piVar15;
    undefined8 uVar16;
    char local_16e;
    char local_16d;
    undefined1 uStack_16c;
    char local_16b;
    undefined1 uStack_16a;
    char local_169;
    undefined4 local_168;
    undefined4 local_164;
    int local_160;
    undefined1 auStack_15c[4];
    undefined1 auStack_158[4];
    int local_154;
    undefined1 auStack_150[4];
    int local_14c;
    undefined1 auStack_148[8];
    undefined1 auStack_140[8];
    undefined1 auStack_138[12];
    byte local_12c[128];
    char local_ac;
    char local_ab;
    char local_aa;
    int local_2c;

    iVar11 = *(int *)(param_1 + 4);
    __buf = local_12c;
    piVar15 = *(int **)(iVar11 + 0x54);
    piVar10 = piVar15 + 0x3a;
    iVar9 = *piVar15;
    __s = (char *)(iVar9 + 0x20);
    local_2c = __stack_chk_guard;
    FUN_0004a784(param_1, __buf, __s + (0x80 - *(int *)(iVar9 + 0x1c)),
                 piVar10);
    uVar12 = (uint)local_12c[0];
    if (uVar12 != 0) {
        do {
            while (uVar12 != 10) {
                ppuVar1 = __ctype_b_loc();
                if (((*ppuVar1)[uVar12] & 2) == 0) {
                    pbVar4 = *(byte **)(iVar9 + 0x1c);
                    *(byte **)(iVar9 + 0x1c) = pbVar4 + 1;
                    *pbVar4 = *__buf;
                    if (*__buf == 0x2a || *__buf == 0x23) {
                        iVar5 = piVar15[0x3b];
                        *(int *)(iVar9 + 0x14) = *piVar10;
                        *(int *)(iVar9 + 0x18) = iVar5;
                        sVar3 = write(piVar15[7], __buf, 1);
                        if (sVar3 < 0) {
                            FUN_00075d40(3, "acts: write echo fails %m");
                        }
                    }
                }
            LAB_0006bb58:
                __buf = __buf + 1;
                uVar12 = (uint)*__buf;
                if (uVar12 == 0)
                    goto LAB_0006bbf4;
            }
            if (__s == *(char **)(iVar9 + 0x1c)) {
                iVar5 = piVar15[0x3b];
                *(int *)(iVar9 + 0x14) = *piVar10;
                *(int *)(iVar9 + 0x18) = iVar5;
                goto LAB_0006bb58;
            }
            **(char **)(iVar9 + 0x1c) = '\0';
            piVar14 = *(int **)(iVar11 + 0x54);
            *(char **)(iVar9 + 0x1c) = __s;
            iVar13 = *piVar14;
            local_168 = 2;
            FUN_0007e4b4(&local_ac, __s, 0x80);
            strtok(&local_ac, " ");
            iVar5 = *(int *)(iVar13 + 4);
            if (iVar5 == 2) {
                iVar5 = strcmp(&local_ac, "CONNECT");
                if (iVar5 != 0)
                    goto LAB_0006bbd0;
                FUN_00036294(0x8b, iVar11, __s);
                *(undefined4 *)(iVar13 + 4) = 3;
                *(undefined4 *)(iVar13 + 8) = 0x3c;
                goto LAB_0006bb58;
            }
            if (iVar5 == 3) {
                if (((local_ac == 'N') && (local_ab == 'O')) &&
                    (local_aa == '\0')) {
                    FUN_00036294(0x8b, iVar11, __s);
                }
                if (*(int *)(iVar13 + 0x10) < 0x14) {
                    piVar14 = *(int **)(iVar11 + 0x54);
                    piVar14[0x34] = 0;
                    sVar2 = strlen(__s);
                    iVar5 = *piVar14;
                    if (sVar2 == 0x16) {
                        iVar13 = sscanf(
                            __s, "%c %3d %2d:%2d:%2d %cTZ=%2d", &local_16d,
                            piVar14 + 0x30, piVar14 + 0x31, piVar14 + 0x32,
                            piVar14 + 0x33, &uStack_16a, auStack_150);
                        if (iVar13 == 7) {
                            *(undefined1 *)(piVar14 + 10) = 0;
                            piVar6 = &DAT_000ab068;
                            if (local_16d != ' ') {
                                *(undefined1 *)(piVar14 + 10) = 3;
                            }
                            goto LAB_0006be34;
                        }
                    LAB_0006bf5c:
                        FUN_00049c88(iVar11, 2);
                    } else if (sVar2 < 0x17) {
                        if (sVar2 == 1) {
                            if ((*(char *)(iVar9 + 0x20) == '*') &&
                                (0 < *(int *)(iVar5 + 0x10))) {
                                iVar13 = *(int *)(iVar5 + 0x14);
                                iVar5 = *(int *)(iVar5 + 0x18);
                                *(int *)(iVar11 + 0x70) = piVar14[0xbf];
                                piVar14[0x3a] = iVar13;
                                piVar14[0x3b] = iVar5;
                                goto LAB_0006be68;
                            }
                        } else if (sVar2 == 0x14) {
                            iVar13 = sscanf(__s, "%5ld %3d %2d%2d%2d %3s",
                                            auStack_15c, piVar14 + 0x30,
                                            piVar14 + 0x31, piVar14 + 0x32,
                                            piVar14 + 0x33, auStack_138);
                            if (iVar13 != 6)
                                goto LAB_0006bf5c;
                            *(undefined1 *)(piVar14 + 10) = 0;
                            piVar6 = &DAT_000ab660;
                            goto LAB_0006be34;
                        }
                    } else {
                        if (sVar2 == 0x32) {
                            iVar13 =
                                sscanf(__s,
                                       "%5ld %2d-%2d-%2d %2d:%2d:%2d %2d %1d "
                                       "%3lf %5lf %9s %c",
                                       auStack_15c, piVar14 + 0x2f, &local_160,
                                       &local_164, piVar14 + 0x31,
                                       piVar14 + 0x32, piVar14 + 0x33,
                                       auStack_158, &local_154, auStack_148,
                                       auStack_140, auStack_138, &local_16e);
                            if (iVar13 != 0xd)
                                goto LAB_0006bf5c;
                            uVar16 = FUN_0007fbfc(piVar14[0x2f], local_160,
                                                  local_164);
                            iVar13 = (int)((ulonglong)uVar16 >> 0x20);
                            *(undefined1 *)(piVar14 + 10) = 0;
                            piVar14[0x30] = (int)uVar16;
                            if ((local_154 == 1) || (local_154 == 2)) {
                                *(char *)(piVar14 + 10) = (char)local_154;
                            }
                            piVar14[0xbf] = 0x5453494e;
                            iVar8 = *(int *)(iVar5 + 0x10);
                            iVar7 = iVar8 + 1;
                            *(int *)(iVar5 + 0x10) = iVar7;
                            if (9 < iVar7) {
                                iVar13 = 0;
                            }
                            if (iVar7 == 9 ||
                                iVar8 + -8 < 0 != SBORROW4(iVar7, 9)) {
                                iVar13 = 1;
                            }
                            if (local_16e == '#') {
                                iVar13 = 0;
                            }
                            if (iVar13 != 0)
                                goto LAB_0006bb58;
                        } else {
                            if (sVar2 == 0x4e) {
                                iVar13 = sscanf(
                                    __s,
                                    "%*4d-%*2d-%*2d %*2d:%*2d:%2d "
                                    "%*5c%*12c%4d%2d%2d%2d%2d%5ld%2lf%c%2d%3lf%"
                                    "*15c%c",
                                    piVar14 + 0x33, piVar14 + 0x2f, &local_160,
                                    &local_164, piVar14 + 0x31, piVar14 + 0x32,
                                    auStack_15c, auStack_148, &local_169,
                                    &local_14c, auStack_140, &local_16e);
                                if (iVar13 != 0xc)
                                    goto LAB_0006bf5c;
                                *(undefined1 *)(piVar14 + 10) = 0;
                                if (local_14c == local_160) {
                                    if (local_169 == '+') {
                                        *(undefined1 *)(piVar14 + 10) = 1;
                                    } else if (local_169 == '-') {
                                        *(undefined1 *)(piVar14 + 10) = 2;
                                    }
                                }
                                iVar13 = FUN_0007fbfc(piVar14[0x2f], local_160,
                                                      local_164);
                                piVar14[0x30] = iVar13;
                                piVar6 = &DAT_000ab488;
                            } else {
                                if (sVar2 != 0x18)
                                    goto LAB_0006bb58;
                                iVar13 = sscanf(
                                    __s, "%c%c%2d %3d %2d:%2d:%2d.%3ld%c%c%c",
                                    &local_16d, &uStack_16c, piVar14 + 0x2f,
                                    piVar14 + 0x30, piVar14 + 0x31,
                                    piVar14 + 0x32, piVar14 + 0x33,
                                    piVar14 + 0x34, &uStack_16a, &local_16b,
                                    &uStack_16a);
                                if (iVar13 != 0xb)
                                    goto LAB_0006bf5c;
                                *(undefined1 *)(piVar14 + 10) = 0;
                                piVar14[0x34] = piVar14[0x34] * 1000000;
                                if (local_16d == ' ') {
                                    if (local_16b == 'L') {
                                        *(undefined1 *)(piVar14 + 10) = 1;
                                    }
                                } else {
                                    *(undefined1 *)(piVar14 + 10) = 3;
                                }
                                piVar6 = &DAT_000ab068;
                            }
                        LAB_0006be34:
                            piVar14[0xbf] = *piVar6;
                            iVar7 = *(int *)(iVar5 + 0x10) + 1;
                            *(int *)(iVar5 + 0x10) = iVar7;
                        }
                        iVar13 = *(int *)(iVar5 + 0x14);
                        iVar5 = *(int *)(iVar5 + 0x18);
                        *(int *)(iVar11 + 0x70) = piVar14[0xbf];
                        piVar14[0x3a] = iVar13;
                        piVar14[0x3b] = iVar5;
                        if (iVar7 != 0) {
                        LAB_0006be68:
                            FUN_0007e4b4(piVar14 + 0xe, __s, 0x80);
                            sVar2 = strlen((char *)(piVar14 + 0xe));
                            piVar14[0x2e] = sVar2;
                            iVar5 = FUN_0004a4e8(piVar14);
                            if (iVar5 == 0) {
                                FUN_00049c88(iVar11, 6);
                            } else {
                                piVar14[0x38] = piVar14[0x3a];
                                piVar14[0x39] = piVar14[0x3b];
                            }
                        }
                    }
                } else {
                    FUN_0006b548(iVar11, 3);
                }
                goto LAB_0006bb58;
            }
            if (iVar5 == 1) {
                if (((local_ac == 'O') && (local_ab == 'K')) &&
                    (local_aa == '\0')) {
                    FUN_000366ac(0x8b, iVar11, "DIAL #%d %s",
                                 *(int *)(iVar13 + 0xc),
                                 *(undefined4 *)(sys_phone +
                                                 *(int *)(iVar13 + 0xc) * 4));
                    iVar5 = ioctl(piVar14[7], 0x5416, &local_168);
                    if (iVar5 < 0) {
                        FUN_00075d40(3, "acts: ioctl(TIOCMBIS) failed: %m");
                    }
                    __s_00 = *(char **)(sys_phone + *(int *)(iVar13 + 0xc) * 4);
                    sVar2 = strlen(__s_00);
                    sVar3 = write(piVar14[7], __s_00, sVar2);
                    if (sVar3 < 0) {
                        FUN_00075d40(3, "acts: write DIAL fails %m");
                    }
                    write(piVar14[7], "\r", 1);
                    *(undefined4 *)(iVar13 + 4) = 2;
                    *(undefined4 *)(iVar13 + 8) = 0x3c;
                    *(int *)(iVar13 + 0xc) = *(int *)(iVar13 + 0xc) + 1;
                } else {
                    iVar5 = strcmp(&local_ac, modem_setup);
                    if (iVar5 != 0)
                        goto LAB_0006bbd0;
                }
                goto LAB_0006bb58;
            }
        LAB_0006bbd0:
            FUN_00036294(0x8b, iVar11, __s);
            FUN_0006b410(iVar11);
            __buf = __buf + 1;
            uVar12 = (uint)*__buf;
        } while (uVar12 != 0);
    }
LAB_0006bbf4:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0006c260(undefined4 param_1, int param_2)

{
    int iVar1;
    undefined4 *puVar2;
    int iVar3;
    undefined4 *puVar4;

    iVar1 = __stack_chk_guard;
    puVar2 = (undefined4 *)FUN_00074b04(0, 0xa0, 0, 1);
    puVar4 = *(undefined4 **)(param_2 + 0x54);
    *puVar2 = param_1;
    puVar4[3] = FUN_0006ba64;
    *puVar4 = puVar2;
    puVar4[6] = 0;
    puVar4[5] = param_2;
    puVar4[7] = 0xffffffff;
    *(undefined1 *)(param_2 + 0x5f) = 0xf6;
    puVar4[0xb] = "Automated Computer Time Service";
    puVar4[0xbf] = 0x454e4f4e;
    *(undefined1 *)(param_2 + 0x5a) = 9;
    puVar2[7] = puVar2 + 8;
    if ((modem_setup == def_modem_setup) &&
        (iVar3 = FUN_00035034("modemsetup"), iVar3 != 0)) {
        modem_setup = (undefined *)FUN_00074c8c();
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(1);
}

void FUN_0006cd70(int param_1)

{
    ssize_t sVar1;
    int iVar2;
    int *piVar3;
    bool bVar4;
    char local_1d;
    int local_1c;

    piVar3 = *(int **)(param_1 + 0x54);
    iVar2 = *piVar3;
    local_1d = *(char *)(iVar2 + 0x1c);
    *(undefined1 *)(iVar2 + 0x1c) = *(undefined1 *)(iVar2 + 0x1d);
    local_1c = __stack_chk_guard;
    *(undefined1 *)(iVar2 + 0x1d) = *(undefined1 *)(iVar2 + 0x1e);
    *(undefined1 *)(iVar2 + 0x1e) = *(undefined1 *)(iVar2 + 0x1f);
    *(undefined1 *)(iVar2 + 0x1f) = *(undefined1 *)(iVar2 + 0x20);
    if ((local_1d != '\0') &&
        (sVar1 = write(piVar3[7], &local_1d, 1), sVar1 != 1)) {
        FUN_00075d40(5, "ARCRON: write to fd %d failed", piVar3[7]);
    }
    bVar4 = local_1c == __stack_chk_guard;
    *(int *)(*(int *)(param_1 + 0x54) + 0x30) = current_time + 2;
    if (bVar4) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0006ce40(byte *param_1, int *param_2)

{
    ushort uVar1;
    int iVar2;
    ushort uVar3;
    ushort **ppuVar4;

    iVar2 = __stack_chk_guard;
    ppuVar4 = __ctype_b_loc();
    uVar1 = (*ppuVar4)[*param_1];
    uVar3 = uVar1 & 0x800;
    if ((uVar1 & 0x800) != 0) {
        uVar1 = (*ppuVar4)[param_1[1]];
        uVar3 = uVar1 & 0x800;
        if ((uVar1 & 0x800) != 0) {
            uVar3 = 1;
            *param_2 = (*param_1 - 0x30) * 10 + (uint)param_1[1] + -0x30;
        }
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_0006cee8(int param_1, int param_2)

{
    int iVar1;
    int iVar2;
    void *__ptr;
    uint uVar3;
    int iVar4;
    undefined4 *puVar5;
    undefined4 uVar6;
    termios local_7c;
    char acStack_40[20];
    int local_2c;

    local_2c = __stack_chk_guard;
    FUN_00075d40(5, "MSF_ARCRON %s: opening unit %d", "V1.3 2003/02/21",
                 param_1);
    FUN_0007d00c(acStack_40, 0x14, "/dev/arc%d", param_1);
    iVar1 = FUN_0004aa90(acStack_40, 7, 1);
    if (iVar1 < 1) {
        uVar6 = 0;
    } else {
        iVar2 = open64(acStack_40, 0x102, 0x1ff);
        if (iVar2 < 0) {
            uVar6 = 0;
            FUN_00075d40(3, "MSF_ARCRON(%d): failed second open(%s, 0777): %m.",
                         param_1, acStack_40);
            close(iVar1);
        } else {
            close(iVar1);
            iVar1 = fcntl(iVar2, 4, 0);
            if (iVar1 == -1) {
                FUN_00075d40(3, "MSF_ARCRON(%d): fcntl(F_SETFL, 0): %m.",
                             param_1);
            }
            iVar1 = tcgetattr(iVar2, &local_7c);
            if (iVar1 < 0) {
                uVar6 = 0;
                FUN_00075d40(3, "MSF_ARCRON(%d): tcgetattr(%s): %m.", param_1,
                             acStack_40);
                close(iVar2);
            } else {
                uVar6 = 0;
                local_7c.c_oflag = 0;
                local_7c.c_lflag = 0;
                local_7c.c_cc[5] = '\0';
                local_7c.c_iflag = 0x21;
                local_7c.c_cflag = 0x8f7;
                local_7c.c_cc[6] = '\x01';
                iVar1 = tcsetattr(iVar2, 0, &local_7c);
                if (iVar1 < 0) {
                    uVar6 = 0;
                    FUN_00075d40(3, "MSF_ARCRON(%d): tcsetattr(%s): %m.",
                                 param_1, acStack_40);
                    close(iVar2);
                } else {
                    __ptr = (void *)FUN_00074b04(0, 0x28, 0, 1);
                    puVar5 = *(undefined4 **)(param_2 + 0x54);
                    puVar5[5] = param_2;
                    puVar5[6] = 0;
                    puVar5[7] = iVar2;
                    puVar5[3] = FUN_0006d46c;
                    iVar1 = FUN_00029084(puVar5 + 2);
                    if (iVar1 == 0) {
                        close(iVar2);
                        puVar5[7] = 0xffffffff;
                        free(__ptr);
                        uVar6 = 0;
                    } else {
                        uVar3 = *(uint *)(param_2 + 0x4c);
                        *puVar5 = __ptr;
                        *(undefined1 *)(param_2 + 0x5f) = 0xfc;
                        *(undefined1 *)(param_2 + 0x5d) = 2;
                        puVar5[0xb] = "ARCRON MSF/DCF/WWVB Receiver";
                        if (uVar3 < 4) {
                            if (uVar3 == 2) {
                                puVar5[0xbf] = 0x464344;
                            } else if (uVar3 == 3) {
                                puVar5[0xbf] = 0x42565757;
                            } else if (uVar3 == 1) {
                                puVar5[0xbf] = 0x46534d;
                            } else {
                                puVar5[0xbf] = 0x6146534d;
                            }
                            iVar1 = *(int *)(param_2 + 0x54);
                            uVar6 = 1;
                            iVar4 = current_time + 500;
                            iVar2 = current_time + 2;
                            *(undefined4 *)((int)__ptr + 0xc) = 0xffffffff;
                            *(int *)((int)__ptr + 0x14) =
                                iVar4 + (param_1 * 0x43) % 0x3f1;
                            *(int *)(iVar1 + 0x30) = iVar2;
                            *(code **)(iVar1 + 0x34) = FUN_0006cd70;
                        } else {
                            FUN_00075d40(5, "ARCRON: Invalid mode %d");
                        }
                    }
                }
            }
        }
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar6);
    }
    return;
}

void FUN_0006d260(int param_1, char *param_2)

{
    int iVar1;
    size_t sVar2;
    undefined4 uVar3;
    char cVar4;
    char *pcVar5;
    int iVar6;

    iVar1 = __stack_chk_guard;
    sVar2 = strlen(param_2);
    pcVar5 = (char *)(param_1 + 0x20);
    iVar6 = 0;
    do {
        pcVar5 = pcVar5 + -1;
        if (*pcVar5 != '\0')
            break;
        iVar6 = iVar6 + 1;
    } while (iVar6 != 4);
    if (iVar6 < (int)sVar2) {
        uVar3 = 0;
    } else {
        cVar4 = *param_2;
        if (cVar4 != '\0' && 0 < iVar6) {
            pcVar5 = (char *)(param_1 + (0x1f - iVar6));
            do {
                pcVar5 = pcVar5 + 1;
                *pcVar5 = cVar4;
                iVar6 = iVar6 + -1;
                param_2 = param_2 + 1;
                cVar4 = *param_2;
            } while ((cVar4 != '\0' && iVar6 != 0) &&
                     (cVar4 == '\0' || -1 < iVar6));
        }
        uVar3 = 1;
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar3);
    }
    return;
}

void FUN_0006d46c(int param_1)

{
    char cVar1;
    byte bVar2;
    byte bVar3;
    byte bVar4;
    char *pcVar5;
    ushort **ppuVar6;
    tm *ptVar7;
    undefined4 uVar8;
    int extraout_r1;
    int extraout_r1_00;
    int iVar9;
    undefined1 uVar10;
    int *piVar11;
    int iVar12;
    int iVar13;
    uint uVar14;
    undefined4 *puVar15;
    int *piVar16;
    uint uVar17;
    int iVar18;
    uint uVar19;
    int iVar20;
    bool bVar21;
    bool bVar22;
    int local_64;
    time_t local_60[2];
    tm local_58;
    int local_2c;

    iVar18 = *(int *)(param_1 + 4);
    puVar15 = *(undefined4 **)(iVar18 + 0x54);
    piVar16 = (int *)*puVar15;
    local_2c = __stack_chk_guard;
    if (piVar16[6] != 0) {
        piVar11 = piVar16 + 8;
        do {
            piVar11 = (int *)((int)piVar11 + -1);
            if (*(char *)piVar11 != '\0')
                goto LAB_0006d4d4;
        } while (piVar11 != piVar16 + 7);
        FUN_0006d260(piVar16, &DAT_000abaa0);
    }
LAB_0006d4d4:
    iVar9 = puVar15[0x2e];
    iVar12 = *(int *)(param_1 + 0x54);
    if (*(char *)(puVar15 + 0xe) != 'o')
        goto LAB_0006d4ec;
    if (*(char *)(param_1 + 0x58) == '\r' && iVar9 == 1) {
        iVar9 = 1;
    LAB_0006d518:
        if (iVar12 < 1) {
        LAB_0006d594:
            if (iVar9 == 0)
                goto LAB_0006d4fc;
        } else {
            iVar12 = 0;
            pcVar5 = (char *)(param_1 + 0x57);
            do {
                pcVar5 = pcVar5 + 1;
                cVar1 = *pcVar5;
                if (cVar1 == 'h' || cVar1 == '\r') {
                    iVar9 = puVar15[0x2e];
                } else {
                    puVar15[0x2e] = iVar9 + 1;
                    *(char *)((int)puVar15 + iVar9 + 0x38) = cVar1;
                    iVar9 = iVar9 + 1;
                }
                if (cVar1 == 'o') {
                    if (iVar9 == 1) {
                        *piVar16 = 0;
                    }
                    iVar13 = *(int *)(param_1 + 0x54);
                    if (iVar9 == 1) {
                        iVar9 = puVar15[0x2e];
                        piVar16[1] = 0;
                    }
                    if (iVar13 <= iVar12 + 1)
                        goto LAB_0006d594;
                } else if (*(int *)(param_1 + 0x54) <= iVar12 + 1)
                    goto LAB_0006d594;
                iVar12 = iVar12 + 1;
            } while (iVar9 < 0x10);
        }
        iVar12 = DAT_00117f38;
        if (*(char *)(puVar15 + 0xe) != 'g') {
            if (*(char *)(puVar15 + 0xe) != 'o')
                goto LAB_0006d7ec;
            if (iVar9 < 0x10)
                goto LAB_0006d4fc;
            if (piVar16[1] == 0 && *piVar16 == 0) {
                puVar15[0x2e] = 0;
                FUN_00049c88(iVar18, 2);
                goto LAB_0006d4fc;
            }
            iVar12 = piVar16[3];
            bVar21 = iVar12 != -1;
            *(undefined1 *)((int)puVar15 + iVar9 + 0x39) = 0;
            if (bVar21) {
                iVar12 = iVar12 + 0x30;
            }
            uVar10 = (undefined1)iVar12;
            if (!bVar21) {
                uVar10 = 0x36;
            }
            *(undefined1 *)((int)puVar15 + iVar9 + 0x38) = uVar10;
            puVar15[0x34] = 0;
            if ((((*(char *)(puVar15 + 0xe) == 'o') &&
                  (iVar9 = FUN_0006ce40((int)puVar15 + 0x39, puVar15 + 0x31),
                   iVar9 != 0)) &&
                 (iVar9 = FUN_0006ce40((int)puVar15 + 0x3b, puVar15 + 0x32),
                  iVar9 != 0)) &&
                (iVar9 = FUN_0006ce40((int)puVar15 + 0x3d, puVar15 + 0x33),
                 iVar9 != 0)) {
                ppuVar6 = __ctype_b_loc();
                bVar2 = *(byte *)((int)puVar15 + 0x3f);
                if (((((*ppuVar6)[bVar2] & 0x800) != 0) &&
                     (iVar9 = FUN_0006ce40(puVar15 + 0x10, puVar15 + 0x30),
                      iVar9 != 0)) &&
                    ((iVar9 = FUN_0006ce40((int)puVar15 + 0x42, &local_64),
                      iVar9 != 0 &&
                          (iVar9 = FUN_0006ce40(puVar15 + 0x11, puVar15 + 0x2f),
                           iVar9 != 0)))) {
                    bVar3 = *(byte *)((int)puVar15 + 0x46);
                    uVar17 = (uint)bVar3;
                    bVar4 = *(byte *)((int)puVar15 + 0x47);
                    if (((uint)puVar15[0x31] < 0x18) &&
                        ((uint)puVar15[0x32] < 0x3c)) {
                        uVar14 = puVar15[0x33];
                        uVar19 = bVar2 - 0x31;
                        bVar22 = 0x3b < uVar14;
                        bVar21 = uVar14 == 0x3c;
                        if (uVar14 < 0x3d) {
                            bVar22 = 5 < uVar19;
                            bVar21 = uVar19 == 6;
                        }
                        if ((((!bVar22 || bVar21) &&
                              (puVar15[0x30] - 1 < 0x1f)) &&
                             (local_64 - 1U < 0xc)) &&
                            (uVar14 = puVar15[0x2f], uVar14 < 100)) {
                            if ((*(int *)(iVar18 + 0x4c) == 0) &&
                                ((uVar17 << 0x1e) >> 0x1f !=
                                 ((uVar17 ^ 4) << 0x1d) >> 0x1f)) {
                                puVar15[0x2e] = 0;
                                FUN_00049c88(iVar18, 2);
                                goto LAB_0006d4fc;
                            }
                            if ((bVar4 & 8) != 0) {
                                FUN_00075d40(5, "ARCRON: battery low");
                                uVar14 = puVar15[0x2f];
                            }
                            if ((int)uVar14 < 0x62) {
                                uVar14 = uVar14 + 100;
                                puVar15[0x2f] = uVar14;
                            }
                            puVar15[0x2f] = uVar14 + 0x76c;
                            if (0x82f < (int)(uVar14 + 0x76c)) {
                                FUN_00075d40(
                                    5,
                                    "ARCRON: fix me!  EITHER YOUR DATE IS "
                                    "BADLY WRONG or else I will break soon!");
                            }
                            uVar14 = bVar4 & 7;
                            *(undefined1 *)(puVar15 + 10) = 0;
                            if (uVar14 == 3) {
                                if (piVar16[2] != 3) {
                                    FUN_00075d40(5, "ARCRON: signal acquired");
                                }
                            } else if (piVar16[2] != uVar14) {
                                FUN_00075d40(5, "ARCRON: signal lost");
                                *(undefined1 *)(puVar15 + 10) = 3;
                                piVar16[2] = uVar14;
                                puVar15[0x2e] = 0;
                                FUN_00049c88(iVar18);
                                goto LAB_0006d4fc;
                            }
                            iVar9 = local_64;
                            iVar12 = *(int *)(iVar18 + 0x4c);
                            piVar16[2] = uVar14;
                            if (iVar12 == 0) {
                                uVar17 = puVar15[0x2f];
                                iVar12 = puVar15[0x30];
                                iVar13 = *(int *)(&DAT_000ab81c + local_64 * 4);
                                puVar15[0x30] = iVar12 + iVar13;
                                if (((uVar17 & 3) == 0) &&
                                    (((FUN_0009d0ec(uVar17, 100),
                                       extraout_r1 != 0 ||
                                           (FUN_0009d0ec(uVar17, 400),
                                            extraout_r1_00 == 0)) &&
                                      (2 < iVar9)))) {
                                    puVar15[0x30] = iVar12 + iVar13 + 1;
                                }
                                if (((bVar3 & 2) != 0) &&
                                    (iVar9 = puVar15[0x31],
                                     puVar15[0x31] = iVar9 + -1,
                                     iVar9 + -1 < 0)) {
                                    iVar9 = puVar15[0x30];
                                    puVar15[0x31] = 0x17;
                                    puVar15[0x30] = iVar9 + -1;
                                    if (iVar9 + -1 < 0) {
                                        puVar15[0x2e] = 0;
                                        FUN_00049c88(iVar18, 6);
                                        goto LAB_0006d4fc;
                                    }
                                }
                            LAB_0006da7c:
                                if (piVar16[3] != -1) {
                                    bVar2 = *(byte *)(puVar15 + 0xc0);
                                    goto LAB_0006da94;
                                }
                                *(undefined1 *)(iVar18 + 0x5f) = 0xfc;
                            } else {
                                if ((*(byte *)(puVar15 + 0xc0) & 1) == 0) {
                                    uVar8 = FUN_0007fbfc(
                                        puVar15[0x2f], local_64, puVar15[0x30]);
                                    iVar9 = *(int *)(iVar18 + 0x4c);
                                    puVar15[0x30] = uVar8;
                                } else {
                                    memset(&local_58, 0, 0x2c);
                                    local_58.tm_year = puVar15[0x2f] + -0x76c;
                                    local_58.tm_mon = local_64 + -1;
                                    local_58.tm_mday = puVar15[0x30];
                                    local_58.tm_hour = puVar15[0x31];
                                    local_58.tm_min = puVar15[0x32];
                                    local_58.tm_sec = puVar15[0x33];
                                    if (iVar12 == 2) {
                                    LAB_0006dc60:
                                        local_58.tm_isdst = uVar17 & 2;
                                    } else {
                                        if (iVar12 != 3) {
                                            if (iVar12 != 1) {
                                                FUN_00075d40(
                                                    5,
                                                    "ARCRON: Invalid mode %d",
                                                    iVar12);
                                                goto LAB_0006d4fc;
                                            }
                                            goto LAB_0006dc60;
                                        }
                                        uVar17 = uVar17 & 3;
                                        if (uVar17 == 2) {
                                        LAB_0006dca8:
                                            local_58.tm_isdst = 0xffffffff;
                                        } else if (uVar17 == 3) {
                                            local_58.tm_isdst = 1;
                                        } else if (uVar17 == 1)
                                            goto LAB_0006dca8;
                                    }
                                    local_60[0] = mktime(&local_58);
                                    ptVar7 = gmtime(local_60);
                                    if (ptVar7 == (tm *)0x0) {
                                        puVar15[0x2e] = 0;
                                        FUN_00049c88(iVar18, 3);
                                        goto LAB_0006d4fc;
                                    }
                                    local_64 = ptVar7->tm_mon + 1;
                                    iVar12 = ptVar7->tm_mday;
                                    iVar9 = ptVar7->tm_year + 0x76c;
                                    puVar15[0x2f] = iVar9;
                                    uVar8 =
                                        FUN_0007fbfc(iVar9, local_64, iVar12);
                                    iVar12 = ptVar7->tm_min;
                                    iVar13 = ptVar7->tm_sec;
                                    iVar9 = *(int *)(iVar18 + 0x4c);
                                    puVar15[0x31] = ptVar7->tm_hour;
                                    puVar15[0x32] = iVar12;
                                    puVar15[0x33] = iVar13;
                                    puVar15[0x30] = uVar8;
                                }
                                if (((iVar9 == 0) || (uVar14 != 3)) ||
                                    (bVar2 = *(byte *)(puVar15 + 0xc0),
                                     (bVar2 & 2) == 0))
                                    goto LAB_0006da7c;
                            LAB_0006da94:
                                if ((bVar2 & 4) == 0) {
                                    uVar10 = 0xfc;
                                } else {
                                    uVar10 = 0xfb;
                                }
                                *(undefined1 *)(iVar18 + 0x5f) = uVar10;
                            }
                            iVar9 = piVar16[1];
                            if (piVar16[9] !=
                                (uint) * (byte *)(puVar15 + 0xc0)) {
                                piVar16[9] = (uint) * (byte *)(puVar15 + 0xc0);
                            }
                            puVar15[0x3a] = *piVar16;
                            puVar15[0x3b] = iVar9;
                            iVar9 = FUN_0004a4e8(puVar15);
                            if (iVar9 == 0) {
                                puVar15[0x2e] = 0;
                                FUN_00049c88(iVar18, 6);
                            } else {
                                FUN_00052d0c(iVar18 + 0x10, puVar15 + 0xe);
                                FUN_0004a534(iVar18);
                            }
                            goto LAB_0006d4fc;
                        }
                    }
                }
            }
        LAB_0006d7ec:
            puVar15[0x2e] = 0;
            FUN_00049c88(iVar18, 2);
            goto LAB_0006d4fc;
        }
        if (iVar9 < 3)
            goto LAB_0006d4fc;
        if ((((*(byte *)((int)puVar15 + 0x3a) & 0x70) != 0x30) ||
             (uVar17 = *(byte *)((int)puVar15 + 0x3a) & 0xf, 5 < uVar17)) ||
            ((*(byte *)((int)puVar15 + 0x39) & 0x70) != 0x30))
            goto LAB_0006d4fc;
        if ((*(byte *)((int)puVar15 + 0x39) & 0x7f) == 0x33) {
            if ((uint)piVar16[4] < current_time) {
                FUN_0007055c(local_60);
                FUN_0007407c(local_60[0], &local_58);
                DAT_00117f30 = 0;
                piVar16[4] = (current_time + 0x41) - (local_58.tm_hour & 0xffU);
                DAT_00117f34 = 0;
            }
            DAT_00117f30 = uVar17 + DAT_00117f30;
            DAT_00117f34 = DAT_00117f34 + 1;
            DAT_00117f38 = FUN_0009ce58();
        } else if (piVar16[6] != 0) {
            bVar21 = DAT_00117f38 == -1;
            piVar16[3] = DAT_00117f38;
            if (bVar21) {
                pcVar5 = "UNKNOWN, will use clock anyway";
            } else if (iVar12 < 3) {
                pcVar5 = "TOO POOR, will not use clock";
            } else {
                pcVar5 = "OK, will use clock";
            }
            FUN_00075d40(5, "ARCRON: sync finished, signal quality %d: %s",
                         iVar12, pcVar5);
            piVar16[6] = 0;
            DAT_00117f38 = 0;
            DAT_00117f30 = 0;
            DAT_00117f34 = 0;
            if (piVar16[3] < 3) {
                piVar16[5] = current_time + 0x654;
            }
        }
    } else {
        iVar12 = iVar9 + iVar12 + -1;
        if (0 < iVar12) {
            iVar13 = *(int *)(param_1 + 0x48);
            if (iVar12 < 0x11) {
                iVar20 = *piVar16;
                uVar17 = piVar16[1];
                uVar14 = *(uint *)(param_1 + 0x4c) -
                         *(int *)(&DAT_000ab7dc + iVar12 * 4);
                if (*(uint *)(param_1 + 0x4c) < uVar14) {
                    iVar13 = iVar13 + -1;
                }
                if ((uVar17 != 0 || iVar20 != 0) &&
                    (iVar20 + 0x80000000U <= iVar13 + 0x80000000U)) {
                    bVar21 = uVar14 == uVar17;
                    if (uVar14 <= uVar17) {
                        bVar21 = iVar13 == iVar20;
                    }
                    if (!bVar21)
                        goto LAB_0006d4ec;
                }
                *piVar16 = iVar13;
                piVar16[1] = uVar14;
                iVar9 = puVar15[0x2e];
                goto LAB_0006d4ec;
            }
            goto LAB_0006d7ec;
        }
    LAB_0006d4ec:
        if (iVar9 < 0x10) {
            iVar12 = *(int *)(param_1 + 0x54);
            goto LAB_0006d518;
        }
    }
    puVar15[0x2e] = 0;
LAB_0006d4fc:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0006df7c(int param_1)

{
    int iVar1;
    undefined1 *puVar2;
    size_t sVar3;
    long lVar4;
    undefined4 *puVar5;
    char *__nptr;
    int *piVar6;
    int iVar7;
    int *piVar8;
    int iVar9;
    bool bVar10;
    undefined4 local_34;
    undefined4 uStack_30;
    int local_2c;

    iVar7 = *(int *)(param_1 + 4);
    puVar5 = *(undefined4 **)(iVar7 + 0x54);
    __nptr = (char *)(puVar5 + 0xe);
    piVar8 = (int *)*puVar5;
    local_2c = __stack_chk_guard;
    iVar1 = FUN_0004a6d4(param_1, __nptr, 0x80, &local_34);
    puVar5[0x2e] = iVar1;
    if (iVar1 != 0) {
        if ((*(byte *)(puVar5 + 0xc0) & 2) != 0) {
            puVar5[0x3a] = local_34;
            puVar5[0x3b] = uStack_30;
        }
        if (piVar8[0x33] < 1) {
            if (iVar1 == 1) {
                lVar4 = strtol(__nptr, (char **)0x0, 10);
                piVar8[0x33] = lVar4;
            } else {
                piVar6 = piVar8 + 1;
                FUN_00052d0c(iVar7 + 0x10, piVar6);
                *(undefined1 *)(piVar8 + 1) = 0;
                iVar1 = puVar5[0x2e];
                *piVar8 = (int)piVar6;
                if ((iVar1 < 0x13) ||
                    (iVar1 =
                         sscanf(__nptr, "%2d:%3d:%2d:%2d:%2d.%3ld",
                                puVar5 + 0x2f, puVar5 + 0x30, puVar5 + 0x31,
                                puVar5 + 0x32, puVar5 + 0x33, puVar5 + 0x34),
                     iVar1 != 6)) {
                    FUN_00049c88(iVar7, 2);
                } else {
                    bVar10 = *(char *)((int)puVar5 + 0x3a) == ':';
                    if (bVar10) {
                        *(undefined1 *)(puVar5 + 10) = 0;
                    }
                    puVar5[0x34] = puVar5[0x34] * 1000000;
                    if (!bVar10) {
                        *(undefined1 *)(puVar5 + 10) = 3;
                    }
                    iVar1 = FUN_0004a4e8(puVar5);
                    if (iVar1 == 0) {
                        FUN_00049c88(iVar7, 6);
                    } else if (*piVar8 + (puVar5[0x2e] - (int)piVar6) < 199) {
                        memcpy((void *)*piVar8, __nptr, puVar5[0x2e]);
                        iVar1 = *piVar8;
                        iVar9 = puVar5[0x2e];
                        iVar7 = iVar1 + iVar9;
                        *piVar8 = iVar7;
                        if (((*(byte *)(puVar5 + 0xc0) & 8) != 0) &&
                            (sVar3 =
                                 strlen(&DAT_000c89f0 + piVar8[0x34] * 0x1e),
                             (int)((iVar7 - (int)piVar6) + 1 + sVar3) < 199)) {
                            *piVar8 = iVar7 + 1;
                            *(undefined1 *)(iVar1 + iVar9) = 0x20;
                            memcpy((void *)*piVar8,
                                   &DAT_000c89f0 + piVar8[0x34] * 0x1e, sVar3);
                            iVar1 = *piVar8;
                            *piVar8 = iVar1 + (sVar3 - 1);
                            *(undefined1 *)(iVar1 + (sVar3 - 1)) = 0;
                            iVar1 = piVar8[0x34];
                            sVar3 = strlen(&DAT_000c89f0 + iVar1 * 0x1e);
                            write(puVar5[7], &DAT_000c89f0 + iVar1 * 0x1e,
                                  sVar3);
                            iVar1 = piVar8[0x34];
                            piVar8[0x34] = iVar1 + 1;
                            if ((&DAT_000c89f0)[(iVar1 + 1) * 0x1e] == '\0') {
                                piVar8[0x34] = 0;
                            }
                        }
                    }
                }
            }
        } else {
            puVar2 = (undefined1 *)*piVar8;
            piVar8[0x33] = piVar8[0x33] + -1;
            if ((int)(puVar2 + (iVar1 - (int)(piVar8 + 1))) < 199) {
                *piVar8 = (int)(puVar2 + 1);
                *puVar2 = 0x20;
                memcpy((void *)*piVar8, __nptr, puVar5[0x2e] + 1);
                *piVar8 = *piVar8 + puVar5[0x2e];
            }
        }
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0006e434(int param_1)

{
    int iVar1;
    char *pcVar2;
    tm *ptVar3;
    undefined4 uVar4;
    int iVar5;
    char *pcVar6;
    char *__s;
    int iVar7;
    undefined4 *puVar8;
    int local_70;
    int local_6c;
    int local_68;
    time_t local_64;
    undefined4 local_60;
    undefined4 uStack_5c;
    tm local_58;
    int local_2c;

    iVar7 = *(int *)(param_1 + 4);
    puVar8 = *(undefined4 **)(iVar7 + 0x54);
    __s = (char *)(puVar8 + 0xe);
    pcVar6 = (char *)*puVar8;
    local_2c = __stack_chk_guard;
    iVar1 = FUN_0004a6d4(param_1, __s, 0x80, &local_60);
    if (iVar1 == 0) {
        if (*pcVar6 == '\0') {
            *pcVar6 = '\x01';
            *(undefined4 *)(pcVar6 + 4) = local_60;
            *(undefined4 *)(pcVar6 + 8) = uStack_5c;
        } else {
            *pcVar6 = '\0';
        }
    } else {
        puVar8[0x2e] = iVar1;
        uVar4 = *(undefined4 *)(pcVar6 + 8);
        puVar8[0x3a] = *(undefined4 *)(pcVar6 + 4);
        puVar8[0x3b] = uVar4;
        *(undefined4 *)(pcVar6 + 4) = local_60;
        *(undefined4 *)(pcVar6 + 8) = uStack_5c;
        *pcVar6 = '\x01';
        pcVar2 = (char *)sscanf(__s, "Y %d/%d/%d", pcVar6 + 0x10, pcVar6 + 0x18,
                                pcVar6 + 0x14);
        if (pcVar2 == (char *)0x0) {
            iVar1 = sscanf(__s, "Z %02d:%02d:%02d", &local_70, &local_6c,
                           &local_68);
            if (iVar1 == 3) {
                local_58.tm_year = *(int *)(pcVar6 + 0x10);
                local_58.tm_mday = *(int *)(pcVar6 + 0x14);
                local_58.tm_mon = *(int *)(pcVar6 + 0x18) + -1;
                local_58.tm_hour = local_70;
                local_58.tm_min = local_6c;
                local_58.tm_isdst = -1;
                local_58.tm_sec = local_68;
                local_58.tm_wday = (int)pcVar2;
                local_58.tm_yday = (int)pcVar2;
                local_58.tm_gmtoff = (long)pcVar2;
                local_58.tm_zone = pcVar2;
                local_64 = mktime(&local_58);
                ptVar3 = gmtime(&local_64);
                if (ptVar3 == (tm *)0x0) {
                    FUN_00049c88(iVar7, 3);
                } else {
                    uVar4 = FUN_0007fbfc(ptVar3->tm_year + 0x76c,
                                         ptVar3->tm_mon + 1, ptVar3->tm_mday);
                    iVar1 = ptVar3->tm_min;
                    iVar5 = ptVar3->tm_sec;
                    puVar8[0x31] = ptVar3->tm_hour;
                    puVar8[0x32] = iVar1;
                    puVar8[0x33] = iVar5;
                    puVar8[0x30] = uVar4;
                    iVar1 = FUN_0004a4e8(puVar8);
                    if (iVar1 == 0) {
                        FUN_00049c88(iVar7, 6);
                    } else {
                        puVar8[0x38] = puVar8[0x3a];
                        puVar8[0x39] = puVar8[0x3b];
                        FUN_0004a534(iVar7);
                        FUN_00052d0c(iVar7 + 0x10, __s);
                        pcVar6[0xc] = (char)puVar8[0x31];
                    }
                }
            }
        } else {
            iVar1 = *(int *)(pcVar6 + 0x10);
            if (iVar1 < 0x45) {
                iVar1 = iVar1 + 100;
            }
            *(int *)(pcVar6 + 0x10) = iVar1;
        }
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0006e6c4(int param_1)

{
    char cVar1;
    uint *puVar2;
    size_t sVar3;
    undefined1 *puVar4;
    int iVar5;
    int iVar6;
    uint uVar7;
    int iVar8;
    undefined1 *puVar9;
    int iVar10;
    int iVar11;
    undefined1 *puVar12;
    int *piVar13;
    uint uVar14;
    uint uVar15;
    int iVar16;
    uint *puVar17;
    char *pcVar18;
    int iVar19;
    uint *puVar20;
    undefined4 uVar21;
    undefined4 uVar22;
    int iVar23;
    undefined1 *puVar24;
    int iVar25;
    bool bVar26;
    int local_94;
    uint local_90;
    char local_88[12];
    char acStack_7c[80];
    int local_2c;

    piVar13 = *(int **)(param_1 + 0x54);
    iVar16 = *piVar13;
    iVar19 = *(int *)(iVar16 + 0x458);
    local_2c = __stack_chk_guard;
    if (iVar19 < 9) {
        *(uint *)(iVar16 + 0x398) = *(uint *)(iVar16 + 0x398) | 1;
    } else {
        puVar20 = (uint *)(iVar16 + 0x424);
        iVar23 = 0;
        iVar25 = 0;
        *(undefined4 *)(iVar16 + 0x460) = 0;
        puVar2 = (uint *)(iVar16 + 0x438);
        puVar17 = puVar20;
        do {
            puVar2 = puVar2 + 1;
            iVar10 = 8;
            puVar17 = puVar17 + 1;
            iVar5 = 0;
            uVar14 = *puVar17 ^ *puVar2;
            do {
                uVar7 = uVar14 & 1;
                uVar14 = (int)uVar14 >> 1;
                if (uVar7 == 0) {
                    iVar5 = iVar5 + 1;
                } else {
                    iVar5 = iVar5 + -1;
                }
                iVar10 = iVar10 + -1;
            } while (iVar10 != 0);
            iVar25 = iVar25 + 1;
            iVar23 = iVar23 + iVar5;
            *(int *)(iVar16 + 0x460) = iVar23;
        } while ((iVar25 != 5) && (iVar25 != iVar19 + -5));
        if (iVar23 < 0x1c) {
            if (iVar23 + 0x1b < 0 == SCARRY4(iVar23, 0x1b)) {
                *(uint *)(iVar16 + 0x398) = *(uint *)(iVar16 + 0x398) | 2;
                goto LAB_0006e7a4;
            }
            iVar23 = -iVar23;
            iVar5 = 0;
            uVar21 = *(undefined4 *)(iVar16 + 0x470);
            uVar22 = *(undefined4 *)(iVar16 + 0x474);
            uVar14 = 0x50;
            iVar25 = iVar19;
            FUN_0007d00c(acStack_7c, 0x50, "chuB %04x %4.0f %2d %2d ",
                         *(undefined4 *)(iVar16 + 0x398), uVar21, uVar22,
                         iVar19, iVar23);
            pcVar18 = acStack_7c;
            puVar2 = puVar20;
            do {
                sVar3 = strlen(pcVar18);
                if (uVar14 < sVar3 + 1) {
                    FUN_00075d40(3, "chu_b() fatal out buffer");
                    /* WARNING: Subroutine does not return */
                    exit(1);
                }
                uVar14 = uVar14 - sVar3;
                pcVar18 = pcVar18 + sVar3;
                iVar5 = iVar5 + 1;
                puVar2 = puVar2 + 1;
                FUN_0007d00c(pcVar18, uVar14, &DAT_000a8490, *puVar2, uVar21,
                             uVar22, iVar25, iVar23);
            } while (iVar5 != iVar19);
            if ((*(byte *)(piVar13 + 0xc0) & 8) != 0) {
                FUN_00052d0c(param_1 + 0x10, acStack_7c);
            }
            if (*(int *)(iVar16 + 0x460) + 0x27 < 0 ==
                SCARRY4(*(int *)(iVar16 + 0x460), 0x27)) {
                *(uint *)(iVar16 + 0x398) = *(uint *)(iVar16 + 0x398) | 4;
            } else {
                pcVar18 = local_88;
                do {
                    puVar20 = puVar20 + 1;
                    cVar1 = "0123456789abcdef_*="[(*puVar20 << 0x18) >> 0x1c];
                    *pcVar18 = "0123456789abcdef_*="[*puVar20 & 0xf];
                    pcVar18[1] = cVar1;
                    pcVar18 = pcVar18 + 2;
                } while (puVar20 != (uint *)(iVar16 + 0x438));
                iVar19 = sscanf(local_88, "%1x%1d%4d%2d%2x", iVar16 + 0x47c,
                                iVar16 + 0x480, piVar13 + 0x2f, iVar16 + 0x484,
                                iVar16 + 0x488);
                if (iVar19 == 5) {
                    *(uint *)(iVar16 + 0x398) =
                        *(uint *)(iVar16 + 0x398) | 0x200;
                    if ((*(uint *)(iVar16 + 0x47c) & 8) != 0) {
                        *(int *)(iVar16 + 0x480) = -*(int *)(iVar16 + 0x480);
                    }
                } else {
                    *(uint *)(iVar16 + 0x398) = *(uint *)(iVar16 + 0x398) | 8;
                }
            }
        } else {
            iVar5 = 0;
            uVar14 = *(uint *)(iVar16 + 0x434) & 0xf;
            iVar10 = -1;
            *(undefined4 *)(iVar16 + 0x464) = 0;
            local_94 = 0;
            iVar25 = iVar16;
            while (true) {
                uVar14 = uVar14 ^ 99;
                iVar6 = 8;
                iVar11 = 0;
                do {
                    uVar7 = uVar14 & 1;
                    uVar14 = (int)uVar14 >> 1;
                    if (uVar7 == 0) {
                        iVar11 = iVar11 + 1;
                    } else {
                        iVar11 = iVar11 + -1;
                    }
                    iVar6 = iVar6 + -1;
                } while (iVar6 != 0);
                uVar7 = iVar10 + 9;
                iVar6 = 8;
                uVar14 = uVar7;
                if ((int)uVar7 < iVar19) {
                    uVar14 = *(uint *)(iVar25 + 0x448) & 0xf;
                }
                uVar15 = (*(uint *)(iVar25 + 0x438) & 0xf) << 4;
                if ((int)uVar7 < iVar19) {
                    uVar15 = uVar15 | uVar14;
                }
                iVar8 = 0;
                uVar15 = uVar15 ^ 99;
                do {
                    uVar14 = uVar15 & 1;
                    uVar15 = (int)uVar15 >> 1;
                    if (uVar14 == 0) {
                        iVar8 = iVar8 + 1;
                    } else {
                        iVar8 = iVar8 + -1;
                    }
                    iVar6 = iVar6 + -1;
                } while (iVar6 != 0);
                iVar8 = iVar8 + iVar11;
                if (iVar5 < iVar8) {
                    local_94 = iVar10;
                }
                iVar10 = iVar10 + 1;
                if (iVar5 < iVar8) {
                    *(int *)(iVar16 + 0x464) = iVar8;
                    iVar5 = iVar8;
                }
                if (iVar10 == 2)
                    break;
                uVar14 = (*(uint *)(iVar25 + 0x428) & 0xf) << 4 |
                         *(uint *)(iVar25 + 0x438) & 0xf;
                iVar25 = iVar25 + 4;
            }
            iVar25 = iVar16 + local_94 * 4;
            uVar14 = (uint)(*(int *)(iVar25 + 0x438) << 0x18) >> 0x1c;
            if ((uVar14 - 2 < 8) && (local_94 + 9 < iVar19)) {
                local_90 = (uint)(*(int *)(iVar25 + 0x44c) << 0x18) >> 0x1c;
                if (uVar14 != local_90) {
                    local_90 = 0;
                }
            } else {
                local_90 = 0;
            }
            uVar7 = 0x50;
            uVar21 = *(undefined4 *)(iVar16 + 0x470);
            uVar22 = *(undefined4 *)(iVar16 + 0x474);
            iVar25 = iVar19;
            iVar10 = local_94;
            uVar14 = local_90;
            FUN_0007d00c(acStack_7c, 0x50,
                         "chuA %04x %4.0f %2d %2d %2d %2d %1d ",
                         *(undefined4 *)(iVar16 + 0x398), uVar21, uVar22,
                         iVar19, iVar23, local_94, iVar5, local_90);
            iVar6 = 0;
            pcVar18 = acStack_7c;
            do {
                sVar3 = strlen(pcVar18);
                if (uVar7 < sVar3 + 1) {
                    FUN_00075d40(3, "chu_a() fatal out buffer");
                    /* WARNING: Subroutine does not return */
                    exit(1);
                }
                uVar7 = uVar7 - sVar3;
                pcVar18 = pcVar18 + sVar3;
                iVar6 = iVar6 + 1;
                puVar20 = puVar20 + 1;
                FUN_0007d00c(pcVar18, uVar7, &DAT_000a8490, *puVar20, uVar21,
                             uVar22, iVar25, iVar23, iVar10, iVar5, uVar14);
            } while (iVar6 != iVar19);
            if ((*(byte *)(piVar13 + 0xc0) & 8) != 0) {
                FUN_00052d0c(param_1 + 0x10, acStack_7c);
            }
            if (*(int *)(iVar16 + 0x464) < 8) {
                *(uint *)(iVar16 + 0x398) = *(uint *)(iVar16 + 0x398) | 0x10;
            } else {
                if (local_90 == 0) {
                    *(uint *)(iVar16 + 0x398) =
                        *(uint *)(iVar16 + 0x398) | 0x20;
                } else {
                    iVar23 = local_90 + 0x1e;
                    *(uint *)(iVar16 + 0x398) =
                        *(uint *)(iVar16 + 0x398) | 0x100;
                    piVar13[0x33] = iVar23;
                    *(int *)(iVar16 + 0x390) = iVar23;
                    if (local_94 == -1) {
                        iVar23 = *(int *)(iVar16 + 0x388);
                        iVar25 = 0;
                        uVar14 = *(uint *)(iVar16 + 0x38c);
                    } else {
                        uVar14 = 0;
                        iVar25 = local_94;
                        if (local_94 != 0) {
                            iVar25 = 1;
                        }
                    }
                    iVar5 = iVar16 + iVar25 * 8;
                    do {
                        if (local_94 < iVar25 + -9)
                            break;
                        iVar11 = *(int *)(iVar16 + 0x454);
                        iVar25 = iVar25 + 1;
                        iVar10 = *(int *)(iVar5 + 0x140);
                        uVar21 = *(undefined4 *)(iVar5 + 0x144);
                        iVar6 = iVar16 + iVar11 * 8;
                        *(int *)(iVar6 + 0x198) = iVar10;
                        *(undefined4 *)(iVar6 + 0x19c) = uVar21;
                        iVar10 = iVar10 - iVar23;
                        uVar15 = *(uint *)(iVar6 + 0x19c);
                        uVar7 = uVar15 - uVar14;
                        *(uint *)(iVar6 + 0x19c) = uVar7;
                        if (uVar15 < uVar7) {
                            iVar10 = iVar10 + -1;
                        }
                        *(int *)(iVar6 + 0x198) = iVar10;
                        bVar26 = CARRY4(uVar14, *(uint *)(iVar16 + 0x38c));
                        uVar14 = uVar14 + *(uint *)(iVar16 + 0x38c);
                        iVar23 =
                            iVar23 + *(int *)(iVar16 + 0x388) + (uint)bVar26;
                        if (iVar11 < 0x3b) {
                            *(int *)(iVar16 + 0x454) = iVar11 + 1;
                        }
                        iVar5 = iVar5 + 8;
                    } while (iVar25 < iVar19);
                    iVar23 = *(int *)(iVar16 + 0x45c);
                    if (iVar23 < (int)local_90) {
                        iVar25 = 0;
                        do {
                            iVar5 = 0xf;
                            puVar4 = (undefined1 *)(iVar16 + 0xa0);
                            puVar9 = (undefined1 *)(iVar16 + 0x13f);
                            puVar12 = (undefined1 *)(iVar16 + 0x140);
                            puVar24 = (undefined1 *)(iVar16 + 0x9f);
                            do {
                                puVar24 = puVar24 + -1;
                                iVar5 = iVar5 + -1;
                                puVar4 = puVar4 + -1;
                                *puVar4 = *puVar24;
                                puVar9 = puVar9 + -1;
                                puVar12 = puVar12 + -1;
                                *puVar12 = *puVar9;
                            } while (iVar5 != 0);
                            iVar25 = iVar25 + 1;
                            *(undefined1 *)(iVar16 + 0x130) = 0;
                            *(undefined1 *)(iVar16 + 0x90) = 0;
                        } while (iVar25 != local_90 - iVar23);
                        *(uint *)(iVar16 + 0x45c) = local_90;
                    }
                }
                puVar2 = (uint *)(iVar16 + 0x428);
                uVar14 = local_94 * -2;
                uVar7 = uVar14 + iVar19 * 2;
                do {
                    if (uVar14 < 0x13) {
                        iVar23 = (*puVar2 & 0xf) + uVar14 * 0x10;
                        iVar19 =
                            ((*puVar2 << 0x18) >> 0x1c) + (uVar14 + 1) * 0x10;
                        *(char *)(iVar16 + iVar23) =
                            *(char *)(iVar16 + iVar23) + '\x01';
                        *(char *)(iVar16 + iVar19) =
                            *(char *)(iVar16 + iVar19) + '\x01';
                    }
                    uVar14 = uVar14 + 2;
                    puVar2 = puVar2 + 1;
                } while (uVar14 != uVar7);
                *(int *)(iVar16 + 0x468) = *(int *)(iVar16 + 0x468) + 1;
            }
        }
        if (*(int *)(param_1 + 0x2cc) != current_time) {
            *(int *)(param_1 + 0x2d0) = current_time + 10;
        }
    }
LAB_0006e7a4:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0006ed84(int param_1)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    double *pdVar4;
    int iVar5;
    int iVar6;
    uint uVar7;
    int iVar8;
    int iVar9;
    int *piVar10;
    int iVar11;
    double in_d0;
    double dVar12;
    double dVar13;

    iVar1 = __stack_chk_guard;
    piVar10 = *(int **)(param_1 + 0x54);
    iVar8 = *piVar10;
    iVar2 = *(int *)(iVar8 + 0x3a4);
    if (iVar2 < 1) {
        uVar3 = 0;
    } else {
        dVar12 = 0.0;
        iVar5 = *(int *)(iVar8 + 0x3a8) * 5;
        iVar6 = iVar8 + *(int *)(iVar8 + 0x3a8) * 0x28;
        iVar9 = *(int *)(iVar6 + 0x3d0);
        pdVar4 =
            (double *)(iVar8 + (iVar5 + *(int *)(iVar6 + 0x3d0) + 0x76) * 8);
        iVar11 = *(int *)(iVar6 + 0x3d0);
        *(double *)(iVar6 + 0x3c8) = *(double *)(iVar6 + 0x3c8) - *pdVar4;
        *pdVar4 = in_d0;
        dVar13 = *(double *)(iVar8 + (iVar5 + iVar9) * 8 + 0x3b0);
        *(undefined4 *)(iVar6 + 0x3d4) = 0;
        iVar5 = 0;
        *(int *)(iVar6 + 0x3d0) = (iVar11 + 1) % 3;
        *(double *)(iVar6 + 0x3c8) = *(double *)(iVar6 + 0x3c8) + dVar13;
        pdVar4 = (double *)(iVar8 + 0x3c8);
        do {
            dVar13 = *pdVar4;
            uVar7 = *(int *)((int)pdVar4 + 0xc) + 1;
            *(uint *)((int)pdVar4 + 0xc) = uVar7;
            if (dVar12 < dVar13) {
                uVar7 = *(uint *)(iVar8 + 0x398);
                *(int *)(iVar8 + 0x3a8) = iVar5;
            }
            iVar5 = iVar5 + 1;
            if (dVar12 < dVar13) {
                *(uint *)(iVar8 + 0x398) = uVar7 | 0x800;
                dVar12 = dVar13;
            }
            pdVar4 = pdVar4 + 5;
        } while (iVar5 != 3);
        iVar5 = (*(int *)(iVar8 + 0x3ac) + 1) % 5;
        *(int *)(iVar8 + 0x3ac) = iVar5;
        if (iVar5 == 0 || dVar12 == 0.0) {
            iVar9 = 0;
            iVar6 = 0;
            iVar5 = iVar8;
            do {
                iVar11 = *(int *)(iVar5 + 0x3d4);
                iVar5 = iVar5 + 0x28;
                if (iVar6 < iVar11) {
                    *(int *)(iVar8 + 0x3a8) = iVar9;
                }
                iVar9 = iVar9 + 1;
                if (iVar6 < iVar11) {
                    iVar6 = iVar11;
                }
            } while (iVar9 != 3);
        }
        uVar3 = FUN_00074d40(
            SUB84(*(double *)(&DAT_000abb58 + *(int *)(iVar8 + 0x3a8) * 8) +
                      0.001,
                  0),
            iVar2, *(uint *)(param_1 + 0x4c) & 0x7f);
        FUN_0007d00c(iVar8 + 0x39c, 5, "CHU%d", *(undefined4 *)(iVar8 + 0x3a8));
        piVar10[0xbf] = *(int *)(iVar8 + 0x39c);
        *(undefined4 *)(param_1 + 0x70) = *(undefined4 *)(iVar8 + 0x39c);
        if ((dVar12 == 0.0) && ((*(uint *)(iVar8 + 0x398) & 0x800) != 0)) {
            *(uint *)(iVar8 + 0x398) = *(uint *)(iVar8 + 0x398) & 0xfffff7ff;
            FUN_00049c88(param_1, 4);
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_0006f054(int param_1, uint param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    undefined **ppuVar2;
    undefined4 *puVar3;
    uint uVar4;
    int iVar5;
    int iVar6;
    int iVar7;
    undefined **ppuVar8;
    int iVar9;
    uint uVar10;
    double dVar11;
    uint uVar12;
    undefined8 uVar13;

    iVar1 = __stack_chk_guard;
    iVar7 = **(int **)(param_1 + 0x54);
    ppuVar2 = &__DT_PLTGOT;
    ppuVar8 = *(undefined ***)(iVar7 + 0x380);
    iVar9 = *(int *)(iVar7 + 900);
    iVar6 = __stack_chk_guard;
    if (iVar9 == 0 && ppuVar8 == (undefined **)0x0) {
        ppuVar2 = *(undefined ***)(iVar7 + 0x378);
        iVar6 = *(int *)(iVar7 + 0x37c);
    }
    if (iVar9 == 0 && ppuVar8 == (undefined **)0x0) {
        *(int *)(iVar7 + 0x380) = (int)ppuVar2;
        *(int *)(iVar7 + 900) = iVar6;
        iVar9 = *(int *)(iVar7 + 900);
        ppuVar8 = ppuVar2;
    }
    uVar4 = *(int *)(iVar7 + 0x378) - (int)ppuVar8;
    uVar10 = *(uint *)(iVar7 + 0x37c) - iVar9;
    if (*(uint *)(iVar7 + 0x37c) < uVar10) {
        uVar4 = uVar4 - 1;
    }
    *(int *)(iVar7 + 0x380) = *(int *)(iVar7 + 0x378);
    *(undefined4 *)(iVar7 + 900) = *(undefined4 *)(iVar7 + 0x37c);
    iVar6 = -((int)uVar4 >> 0x1f);
    uVar13 = VectorShiftRight(CONCAT44(iVar6, iVar6), 0x20);
    iVar5 = (int)((ulonglong)uVar13 >> 0x20);
    uVar12 = (uint)uVar13;
    uVar10 = uVar10 ^ -uVar12;
    iVar9 = uVar12 + uVar10;
    iVar5 = iVar5 + (uVar4 ^ -(iVar5 + (uint)(uVar12 != 0))) +
            (uint)CARRY4(uVar12, uVar10);
    dVar11 = (double)FUN_0009d40c(iVar9, iVar5, iVar9, iVar5, uVar13);
    dVar11 = ldexp(dVar11, -0x20);
    if (iVar6 != 0) {
        dVar11 = -dVar11;
    }
    if (0.4033333333333333 < dVar11) {
        FUN_0006e6c4(param_1);
    LAB_0006f168:
        iVar9 = 1;
        iVar6 = 0;
    } else {
        if (0.09166666666666667 < dVar11)
            goto LAB_0006f168;
        iVar6 = *(int *)(iVar7 + 0x458);
        if (10 < iVar6)
            goto LAB_0006f194;
        iVar9 = iVar6 + 1;
    }
    puVar3 = (undefined4 *)(iVar7 + (iVar6 + 0x28) * 8);
    *(uint *)(iVar7 + (iVar6 + 0x10a) * 4) = param_2 & 0xff;
    *puVar3 = param_3;
    puVar3[1] = param_4;
    *(int *)(iVar7 + 0x458) = iVar9;
LAB_0006f194:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0006f4f4(undefined4 param_1, int param_2)

{
    byte *pbVar1;
    size_t sVar2;
    int iVar3;
    int *piVar4;
    int iVar5;
    int iVar6;
    undefined4 uVar7;
    undefined1 *puVar8;
    int iVar9;
    int iVar10;
    uint uVar11;
    undefined4 uVar12;
    undefined1 *puVar13;
    int iVar14;
    uint uVar15;
    int *piVar16;
    int iVar17;
    int iVar18;
    char *pcVar19;
    byte *pbVar20;
    byte *pbVar21;
    byte bVar22;
    double dVar23;
    undefined4 local_50;
    undefined4 local_4c;
    char local_48[12];
    int local_3c;

    piVar16 = *(int **)(param_2 + 0x54);
    iVar14 = *piVar16;
    iVar3 = *(int *)(iVar14 + 0x390) + 1;
    local_3c = __stack_chk_guard;
    *(int *)(iVar14 + 0x390) = iVar3 % 0x3c;
    if (iVar3 % 0x3c == 0) {
        pcVar19 = (char *)((int)&local_4c + 3);
        FUN_0006e6c4(param_2, iVar3, iVar3 * -0x77777777);
        piVar4 = *(int **)(param_2 + 0x54);
        iVar9 = *(int *)(param_2 + 0x2c0);
        iVar18 = *piVar4;
        pbVar21 = (byte *)(iVar18 + -1);
        iVar6 = current_time + 0x1e;
        iVar10 = *(int *)(iVar18 + 0x468);
        iVar3 = 0;
        do {
            iVar17 = 0;
            pbVar20 = pbVar21 + 0xa0;
            uVar15 = 0;
            iVar5 = 0;
            pbVar1 = pbVar21;
            do {
                pbVar1 = pbVar1 + 1;
                pbVar20 = pbVar20 + 1;
                uVar11 = (uint)*pbVar1 + (uint)*pbVar20;
                if (uVar15 < uVar11) {
                    iVar17 = iVar5;
                }
                iVar5 = iVar5 + 1;
                if (uVar15 < uVar11) {
                    uVar15 = uVar11;
                }
            } while (iVar5 != 0x10);
            pbVar21 = pbVar21 + 0x10;
            iVar3 = iVar3 + uVar15;
            if ((int)uVar15 <= iVar10) {
                *(uint *)(iVar18 + 0x398) = *(uint *)(iVar18 + 0x398) | 0x40;
            }
            pcVar19 = pcVar19 + 1;
            *pcVar19 = "0123456789abcdef_*="[iVar17];
        } while (pbVar21 != (byte *)(iVar18 + 0x8f));
        iVar10 = sscanf(local_48, "%1x%3d%2d%2d", &local_50, piVar4 + 0x30,
                        piVar4 + 0x31, piVar4 + 0x32);
        dVar23 = (double)(longlong)iVar3;
        if (iVar10 != 4) {
            *(uint *)(iVar18 + 0x398) = *(uint *)(iVar18 + 0x398) | 0x40;
        }
        if (*(int *)(iVar18 + 0x454) < 0x14) {
            *(uint *)(iVar18 + 0x398) = *(uint *)(iVar18 + 0x398) | 0x80;
        }
        uVar15 = *(uint *)(iVar14 + 0x398);
        bVar22 = (uVar15 & 0x14) != 0;
        if ((uVar15 & 0x28) != 0) {
            bVar22 = bVar22 | 2;
        }
        if ((uVar15 & 0x40) != 0) {
            bVar22 = bVar22 | 4;
        }
        if ((uVar15 & 0x80) != 0) {
            bVar22 = bVar22 | 8;
        }
        if (((uVar15 & 0x200) != 0) && (50.0 <= dVar23)) {
            uVar15 = uVar15 | 0x400;
            *(uint *)(iVar14 + 0x398) = uVar15;
        }
        if ((uVar15 & 0x400) == 0) {
            uVar7 = 0x20;
            *(undefined1 *)(piVar16 + 10) = 3;
            uVar12 = 0x3f;
        } else if ((*(uint *)(iVar14 + 0x47c) & 2) == 0) {
            if ((*(uint *)(iVar14 + 0x47c) & 4) == 0) {
                *(undefined1 *)(piVar16 + 10) = 0;
                uVar7 = 0x20;
            } else {
                uVar7 = 0x6c;
                *(undefined1 *)(piVar16 + 10) = 2;
            }
            uVar12 = 0x20;
        } else {
            uVar7 = 0x4c;
            *(undefined1 *)(piVar16 + 10) = 1;
            uVar12 = 0x20;
        }
        piVar4 = piVar16 + 0xe;
        FUN_0007d00c(
            piVar4, 0x80,
            "%c%1X %04d %03d %02d:%02d:%02d %c%x %+d %d %d %s %.0f %d", uVar12,
            bVar22, piVar16[0x2f], piVar16[0x30], piVar16[0x31], piVar16[0x32],
            piVar16[0x33], uVar7, *(undefined4 *)(iVar14 + 0x488),
            *(undefined4 *)(iVar14 + 0x480), (uint)(iVar6 - iVar9) / 0x3c,
            *(undefined4 *)(iVar14 + 0x478), iVar14 + 0x39c, dVar23,
            *(undefined4 *)(iVar14 + 0x454));
        sVar2 = strlen((char *)piVar4);
        piVar16[0x2e] = sVar2;
        if (((*(uint *)(iVar14 + 0x398) & 0x4c0) == 0x400) && (50.0 < dVar23)) {
            iVar6 = 0;
            iVar3 = FUN_00074318(piVar16[0x30], piVar16[0x31], piVar16[0x32], 0,
                                 0, *(undefined4 *)(iVar14 + 0x198),
                                 piVar16 + 0x35, &local_50);
            if (iVar3 == 0) {
                *(undefined4 *)(iVar14 + 0x394) = 6;
            } else {
                local_4c = 0;
                if (0 < *(int *)(iVar14 + 0x454)) {
                    do {
                        iVar3 = iVar6 + 0x33;
                        iVar6 = iVar6 + 1;
                        FUN_0004a258(
                            SUB84(*(double *)(piVar16 + 0xba) + 0.1768, 0),
                            piVar16, local_50, local_4c,
                            *(undefined4 *)(iVar14 + iVar3 * 8),
                            *(undefined4 *)(iVar14 + iVar3 * 8 + 4));
                    } while (iVar6 < *(int *)(iVar14 + 0x454));
                }
                iVar3 = *(int *)(iVar14 + 0x37c);
                piVar16[0x38] = *(int *)(iVar14 + 0x378);
                piVar16[0x39] = iVar3;
                FUN_0004a534(param_2);
            }
        }
        if (0.0 < dVar23) {
            FUN_00052d0c(param_2 + 0x10, piVar4);
        }
        FUN_0006ed84(SUB84(dVar23, 0), param_2);
        iVar3 = **(int **)(param_2 + 0x54);
        *(undefined4 *)(iVar3 + 0x45c) = 0;
        *(uint *)(iVar3 + 0x398) = *(uint *)(iVar3 + 0x398) & 0xc00;
        puVar13 = (undefined1 *)(iVar3 + -1);
        *(undefined4 *)(iVar3 + 0x458) = 0;
        *(undefined4 *)(iVar3 + 0x454) = 0;
        *(undefined4 *)(iVar3 + 0x468) = 0;
        do {
            puVar8 = puVar13 + 0x10;
            do {
                puVar13 = puVar13 + 1;
                *puVar13 = 0;
            } while (puVar13 != puVar8);
        } while (puVar13 != (undefined1 *)(iVar3 + 0x13f));
        if (*(int *)(iVar14 + 0x394) != 0) {
            FUN_00049c88(param_2);
        }
        *(undefined4 *)(iVar14 + 0x394) = 0;
    }
    if (local_3c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00070300) */
/* WARNING: Removing unreachable block (ram,0x000702f4) */

void FUN_0006f960(int param_1)

{
    bool bVar1;
    int iVar2;
    int *piVar3;
    undefined4 uVar4;
    double *pdVar5;
    double *pdVar6;
    int iVar7;
    uint *puVar8;
    uint uVar9;
    int iVar10;
    undefined4 uVar11;
    uint uVar12;
    int iVar13;
    int iVar14;
    byte *pbVar15;
    int iVar17;
    int iVar18;
    uint uVar19;
    int iVar20;
    int iVar21;
    double dVar22;
    double dVar23;
    double dVar24;
    double dVar25;
    double dVar26;
    double dVar27;
    double dVar28;
    undefined8 uVar29;
    double dVar30;
    double dVar31;
    double dVar32;
    double dVar33;
    double dVar34;
    double dVar35;
    double dVar36;
    double dVar37;
    double dVar38;
    double dVar39;
    double dVar40;
    double dVar41;
    double dVar42;
    double dVar43;
    double dVar44;
    double dVar45;
    double dVar46;
    double dVar47;
    double dVar48;
    double dVar49;
    double dVar50;
    double dVar51;
    undefined8 uVar52;
    uint local_80;
    int iStack_7c;
    byte *pbVar16;

    iVar2 = __stack_chk_guard;
    iVar18 = *(int *)(param_1 + 4);
    piVar3 = *(int **)(iVar18 + 0x54);
    iVar13 = *piVar3;
    if (*(int *)(iVar13 + 0x48c) < 1) {
        FUN_0006f054(iVar18, *(undefined1 *)(param_1 + 0x58),
                     *(undefined4 *)(param_1 + 0x48),
                     *(undefined4 *)(param_1 + 0x4c));
        return;
    }
    dVar22 = (double)(longlong) * (int *)(param_1 + 0x54) / 8000.0;
    bVar1 = dVar22 < 0.0;
    if (bVar1) {
        dVar22 = -dVar22;
    }
    dVar22 = ldexp(dVar22, 0x20);
    uVar29 = VectorShiftRight((ulonglong)CONCAT14(bVar1, (uint)bVar1), 0x20);
    uVar52 = FUN_0009d558(SUB84(dVar22, 0), (int)((ulonglong)dVar22 >> 0x20));
    local_80 = (uint)uVar29;
    iStack_7c = (int)((ulonglong)uVar29 >> 0x20);
    uVar12 = *(uint *)(param_1 + 0x4c);
    iVar14 = *(int *)(param_1 + 0x54);
    uVar19 = (uint)uVar52 ^ -local_80;
    uVar9 = uVar12 - (local_80 + uVar19);
    iVar17 =
        *(int *)(param_1 + 0x48) - (iStack_7c +
                                    ((uint)((ulonglong)uVar52 >> 0x20) ^
                                     -(iStack_7c + (uint)(local_80 != 0))) +
                                    (uint)CARRY4(local_80, uVar19));
    *(uint *)(param_1 + 0x4c) = uVar9;
    if (uVar12 < uVar9) {
        iVar17 = iVar17 + -1;
    }
    *(int *)(param_1 + 0x48) = iVar17;
    uVar4 = *(undefined4 *)(param_1 + 0x4c);
    *(int *)(iVar13 + 0x378) = *(int *)(param_1 + 0x48);
    *(undefined4 *)(iVar13 + 0x37c) = uVar4;
    pbVar16 = (byte *)(param_1 + 0x58);
    if (0 < iVar14) {
        do {
            pbVar15 = pbVar16 + 1;
            dVar22 =
                *(double *)(iVar13 + ((~(uint)*pbVar16 & 0xff) + 0x92) * 8);
            if (6000.0 < dVar22) {
                *(int *)(iVar13 + 0xc98) = *(int *)(iVar13 + 0xc98) + 1;
                dVar22 = 6000.0;
            } else if (dVar22 < -6000.0) {
                *(int *)(iVar13 + 0xc98) = *(int *)(iVar13 + 0xc98) + 1;
                dVar22 = -6000.0;
            }
            iVar17 = **(int **)(iVar18 + 0x54);
            dVar34 = *(double *)(iVar17 + 0xce0);
            *(double *)(iVar17 + 0xce8) = dVar34;
            dVar36 = *(double *)(iVar17 + 0xcd8);
            *(double *)(iVar17 + 0xce0) = dVar36;
            dVar38 = *(double *)(iVar17 + 0xcd0);
            *(double *)(iVar17 + 0xcd8) = dVar38;
            dVar40 = *(double *)(iVar17 + 0xcc8);
            *(double *)(iVar17 + 0xcd0) = dVar40;
            dVar42 = *(double *)(iVar17 + 0xcc0);
            *(double *)(iVar17 + 0xcc8) = dVar42;
            dVar47 = *(double *)(iVar17 + 0xcb8);
            *(double *)(iVar17 + 0xcc0) = dVar47;
            dVar48 = *(double *)(iVar17 + 0xcb0);
            *(double *)(iVar17 + 0xcb8) = dVar48;
            dVar30 = *(double *)(iVar17 + 0xca8);
            *(double *)(iVar17 + 0xcb0) = dVar30;
            dVar22 = dVar22 - (dVar36 * 0.488486 + dVar34 * 0.5844676 +
                               dVar38 * 2.704384 + dVar40 * 1.645032 +
                               dVar42 * 4.644557 + dVar47 * 1.879165 +
                               dVar48 * 3.522634 + dVar30 * 0.7315738);
            *(double *)(iVar17 + 0xca8) = dVar22;
            dVar22 = dVar30 * 0.003156599 + dVar22 * 0.006176213 +
                     dVar48 * 0.007567487 + dVar47 * 0.00434458 +
                     dVar42 * 0.01190128 + dVar40 * 0.00434458 +
                     dVar38 * 0.007567487 + dVar36 * 0.003156599 +
                     dVar34 * 0.006176213;
            *(double *)(iVar17 + 0xe18) = dVar22 * 0.25;
            if (1000.0 < dVar22) {
                dVar30 = -1000.0;
                dVar34 = 1000.0;
            } else {
                dVar34 = -1000.0;
                dVar30 = 1000.0;
                if (-1000.0 <= dVar22) {
                    dVar30 = -dVar22;
                    dVar34 = dVar22;
                }
            }
            iVar14 = *(int *)(iVar17 + 0xe20);
            pdVar5 = (double *)(iVar17 + iVar14 * 8 + 0xcf0);
            dVar22 = *pdVar5;
            *pdVar5 = dVar34;
            dVar30 = dVar30 * dVar22;
            *(int *)(iVar17 + 0xe20) = (iVar14 + 1) % 10;
            if (dVar30 < 0.0) {
                dVar30 = -SQRT(-dVar30);
            } else {
                dVar30 = SQRT(dVar30);
            }
            dVar49 = *(double *)(iVar17 + 0xe08);
            *(double *)(iVar17 + 0xe10) = dVar49;
            dVar31 = *(double *)(iVar17 + 0xe00);
            *(double *)(iVar17 + 0xe08) = dVar31;
            dVar32 = *(double *)(iVar17 + 0xdf8);
            *(double *)(iVar17 + 0xe00) = dVar32;
            dVar38 = *(double *)(iVar17 + 0xdf0);
            *(double *)(iVar17 + 0xdf8) = dVar38;
            dVar45 = *(double *)(iVar17 + 0xde8);
            *(double *)(iVar17 + 0xdf0) = dVar45;
            dVar44 = *(double *)(iVar17 + 0xde0);
            *(double *)(iVar17 + 0xde8) = dVar44;
            dVar43 = *(double *)(iVar17 + 0xdd8);
            *(double *)(iVar17 + 0xde0) = dVar43;
            dVar41 = *(double *)(iVar17 + 0xdd0);
            *(double *)(iVar17 + 0xdd8) = dVar41;
            dVar39 = *(double *)(iVar17 + 0xdc8);
            *(double *)(iVar17 + 0xdd0) = dVar39;
            dVar37 = *(double *)(iVar17 + 0xdc0);
            *(double *)(iVar17 + 0xdc8) = dVar37;
            dVar35 = *(double *)(iVar17 + 0xdb8);
            *(double *)(iVar17 + 0xdc0) = dVar35;
            dVar36 = *(double *)(iVar17 + 0xdb0);
            *(double *)(iVar17 + 0xdb8) = dVar36;
            dVar22 = *(double *)(iVar17 + 0xda8);
            *(double *)(iVar17 + 0xdb0) = dVar22;
            dVar47 = *(double *)(iVar17 + 0xda0);
            *(double *)(iVar17 + 0xda8) = dVar47;
            dVar48 = *(double *)(iVar17 + 0xd98);
            *(double *)(iVar17 + 0xda0) = dVar48;
            dVar23 = *(double *)(iVar17 + 0xd90);
            *(double *)(iVar17 + 0xd98) = dVar23;
            dVar24 = *(double *)(iVar17 + 0xd88);
            *(double *)(iVar17 + 0xd90) = dVar24;
            dVar46 = *(double *)(iVar17 + 0xe28) + 0.000125;
            dVar25 = *(double *)(iVar17 + 0xd80);
            *(double *)(iVar17 + 0xd88) = dVar25;
            dVar26 = *(double *)(iVar17 + 0xd78);
            *(double *)(iVar17 + 0xd80) = dVar26;
            dVar27 = *(double *)(iVar17 + 0xd70);
            *(double *)(iVar17 + 0xd78) = dVar27;
            dVar28 = *(double *)(iVar17 + 0xd68);
            *(double *)(iVar17 + 0xd70) = dVar28;
            dVar40 = *(double *)(iVar17 + 0xd60);
            *(double *)(iVar17 + 0xd68) = dVar40;
            dVar42 = *(double *)(iVar17 + 0xd58);
            *(double *)(iVar17 + 0xd60) = dVar42;
            dVar51 = *(double *)(iVar17 + 0xd50);
            *(double *)(iVar17 + 0xd58) = dVar51;
            dVar50 = *(double *)(iVar17 + 0xd48);
            *(double *)(iVar17 + 0xd50) = dVar50;
            dVar34 = *(double *)(iVar17 + 0xd40);
            *(double *)(iVar17 + 0xd48) = dVar34;
            *(double *)(iVar17 + 0xd40) = dVar30 * 0.02538771;
            if (dVar46 <= 0.0004166666666666667) {
                *(double *)(iVar17 + 0xe28) = dVar46;
                goto LAB_0006fd2c;
            }
            uVar4 = *(undefined4 *)(iVar17 + 0x37c);
            *(double *)(iVar17 + 0xe28) = dVar46 - 0.0004166666666666667;
            iVar21 = (*(int *)(iVar17 + 0x1230) + 1) % 8;
            *(int *)(iVar17 + 0x1230) = iVar21;
            iVar14 = iVar21 * 0x80;
            iVar20 = iVar17 + iVar14;
            pdVar5 = (double *)(iVar17 + iVar14 + 0xe98);
            *(undefined4 *)(iVar20 + 0xe30) = *(undefined4 *)(iVar17 + 0x378);
            *(undefined4 *)(iVar20 + 0xe34) = uVar4;
            pdVar6 = (double *)(iVar17 + iVar14 + 0xe40);
            dVar33 = 1000000.0;
            dVar46 = -1000000.0;
            *(double *)(iVar20 + 0xe38) = -(
                (dVar31 * 0.1084671 + dVar49 * 0.02538771 + dVar32 * 0.2003159 +
                 dVar38 * 0.2985303 + dVar45 * 0.4003697 + dVar44 * 0.5028552 +
                 dVar43 * 0.6028795 + dVar41 * 0.6973249 + dVar39 * 0.7831828 +
                 dVar37 * 0.8576717 + dVar35 * 0.9183463 + dVar36 * 0.9631951 +
                 dVar22 * 0.9907208 + dVar47 + dVar48 * 0.9907208 +
                 dVar23 * 0.9631951 + dVar24 * 0.9183463 + dVar25 * 0.8576717 +
                 dVar26 * 0.7831828 + dVar27 * 0.6973249 + dVar28 * 0.6028795 +
                 dVar40 * 0.5028552 + dVar42 * 0.4003697 + dVar51 * 0.2985303 +
                 dVar50 * 0.2003159 + dVar34 * 0.1084671 +
                 dVar30 * 0.02538771) *
                6.0);
            do {
                dVar22 = pdVar5[-2];
                pdVar5 = pdVar5 + -1;
                *pdVar5 = dVar22;
                if (dVar46 < dVar22) {
                    dVar46 = dVar22;
                }
                if (dVar22 < dVar33) {
                    dVar33 = dVar22;
                }
            } while (pdVar5 != pdVar6);
            dVar34 = dVar46 - dVar33;
            iVar20 = iVar17 + iVar14;
            iVar10 = 0;
            iVar7 = 1;
            dVar22 = 0.0;
            *(double *)(iVar20 + 0xe98) = dVar34;
            dVar30 = dVar33 + dVar34 * 0.45;
        LAB_00070094:
            *(int *)(iVar20 + 0xea8) = iVar10 << 1;
            dVar36 = *pdVar6;
            pdVar6 = pdVar6 + 1;
            if (dVar30 < dVar36) {
                *(uint *)(iVar20 + 0xea8) = iVar10 << 1 | 1;
            }
            if (iVar7 - 1U < 2) {
            LAB_000700d0:
                dVar36 = dVar36 - dVar33;
            joined_r0x000700e0:
                dVar22 = dVar22 + dVar36;
                if (iVar7 == 0xb)
                    goto LAB_000700e4;
                iVar7 = iVar7 + 1;
                iVar10 = *(int *)(iVar20 + 0xea8);
                goto LAB_00070094;
            }
            if (iVar7 != 0xb) {
                if (dVar30 < dVar36)
                    goto LAB_000700d0;
                dVar36 = dVar46 - dVar36;
                goto joined_r0x000700e0;
            }
            dVar22 = dVar22 + (dVar46 - dVar36);
        LAB_000700e4:
            *(double *)(iVar17 + iVar14 + 0xea0) = dVar22 / (dVar34 * 11.0);
            if (*(int *)(iVar17 + 0x1238) < 1) {
                if (iVar21 == *(int *)(iVar17 + 0x1234))
                    goto LAB_0007011c;
            } else {
                iVar14 = *(int *)(iVar17 + 0x1238) + -1;
                *(int *)(iVar17 + 0x1238) = iVar14;
                if (iVar14 == 0) {
                    *(int *)(iVar17 + 0x1234) = iVar21;
                LAB_0007011c:
                    iVar14 = -1;
                    puVar8 = (uint *)(iVar17 + 0xea8);
                    dVar22 = 0.0;
                    iVar20 = 0;
                    do {
                        while (((*puVar8 & 0x601) == 0x600 &&
                                (800.0 <= *(double *)(puVar8 + -4)))) {
                            dVar30 = *(double *)(puVar8 + -2);
                            puVar8 = puVar8 + 0x20;
                            if (dVar22 < dVar30) {
                                iVar14 = iVar20;
                            }
                            iVar20 = iVar20 + 1;
                            if (dVar22 < dVar30) {
                                dVar22 = dVar30;
                            }
                            if (iVar20 == 8)
                                goto LAB_00070190;
                        }
                        iVar20 = iVar20 + 1;
                        puVar8 = puVar8 + 0x20;
                    } while (iVar20 != 8);
                LAB_00070190:
                    if (iVar14 != -1) {
                        iVar20 = iVar17 + iVar14 * 0x80;
                        iVar14 = *(int *)(iVar20 + 0xea8);
                        uVar4 = *(undefined4 *)(iVar20 + 0xe30);
                        uVar11 = *(undefined4 *)(iVar20 + 0xe34);
                        *(undefined8 *)(iVar17 + 0x470) =
                            *(undefined8 *)(iVar20 + 0xe98);
                        FUN_0006f054(iVar18, (uint)(iVar14 << 0x17) >> 0x18,
                                     uVar4, uVar11);
                        *(undefined4 *)(iVar17 + 0x1238) = 0x58;
                    }
                }
            }
        LAB_0006fd2c:
            uVar12 = *(uint *)(iVar13 + 0x37c);
            uVar9 = uVar12 + *(int *)(iVar13 + 0xca4);
            *(uint *)(iVar13 + 0x37c) = uVar9;
            iVar14 = (*(int *)(iVar13 + 0xc9c) + 1) % 8000;
            iVar17 = *(int *)(iVar13 + 0xca0) + *(int *)(iVar13 + 0x378);
            if (uVar9 < uVar12) {
                iVar17 = iVar17 + 1;
            }
            *(int *)(iVar13 + 0x378) = iVar17;
            *(int *)(iVar13 + 0xc9c) = iVar14;
            if (iVar14 == 0) {
                iVar14 = **(int **)(iVar18 + 0x54);
                iVar17 = *(int *)(iVar14 + 0x478);
                if (*(int *)(iVar14 + 0xc98) == 0) {
                    iVar17 = iVar17 + 4;
                    if (0xff < iVar17) {
                        iVar17 = 0xff;
                    }
                LAB_000701f4:
                    *(int *)(iVar14 + 0x478) = iVar17;
                } else if (100 < *(int *)(iVar14 + 0xc98)) {
                    iVar17 = iVar17 + -4;
                    if (-1 < iVar17)
                        goto LAB_000701f4;
                    *(undefined4 *)(iVar14 + 0x478) = 0;
                    iVar17 = 0;
                }
                FUN_000721dc(iVar17, *(undefined4 *)(iVar14 + 0xc94),
                             *(undefined4 *)(iVar14 + 0xc90));
                *(undefined4 *)(iVar14 + 0xc98) = 0;
            }
            pbVar16 = pbVar15;
        } while ((int)pbVar15 - (param_1 + 0x58) < *(int *)(param_1 + 0x54));
    }
    if ((*(byte *)(piVar3 + 0xc0) & 2) == 0) {
        *(undefined4 *)(iVar13 + 0xc90) = 1;
    } else {
        *(undefined4 *)(iVar13 + 0xc90) = 2;
    }
    uVar9 = *(byte *)(piVar3 + 0xc0) & 4;
    if ((*(byte *)(piVar3 + 0xc0) & 4) != 0) {
        uVar9 = 0x7f;
    }
    *(uint *)(iVar13 + 0xc94) = uVar9;
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00070310(int param_1, int param_2, int param_3, int param_4)

{
    uint uVar1;
    undefined *puVar2;
    undefined1 auStack_314[384];
    undefined1 auStack_194[384];
    int local_14;

    puVar2 = (undefined *)(param_2 - param_4);
    local_14 = __stack_chk_guard;
    uVar1 = param_1 - param_3;
    if ((undefined *)0x5b8d80 < puVar2 + 3000000) {
        uVar1 = uVar1 + (int)puVar2 / 1000000;
        puVar2 = (undefined *)((int)puVar2 % 1000000);
    }
    if ((int)puVar2 < 0) {
        do {
            uVar1 = uVar1 - 1;
            puVar2 = &DAT_000f4240 + (int)puVar2;
        } while ((int)puVar2 < 0);
    } else {
        for (; 999999 < (int)puVar2; puVar2 = puVar2 + -1000000) {
            uVar1 = uVar1 + 1;
        }
    }
    if ((int)uVar1 < 0) {
        if (puVar2 != (undefined *)0x0) {
            uVar1 = ~uVar1;
            goto LAB_000703c0;
        }
    } else {
    LAB_000703c0:
        if (uVar1 == 0)
            goto LAB_000703e8;
    }
    memset(auStack_314, 0, 0x180);
    memset(auStack_194, 0, 0x180);
LAB_000703e8:
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00070434(void)

{
    int iVar1;
    double in_d0;
    double dVar2;

    iVar1 = __stack_chk_guard;
    sys_fuzz = in_d0;
    if (in_d0 < 0.0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("systime.c", 0x75, 2, "sys_fuzz >= 0");
    }
    if (in_d0 <= 1.0) {
        dVar2 = ceil(in_d0 * 1000000000.0);
        sys_fuzz_nsec = (undefined4)(longlong)dVar2;
        if (iVar1 == __stack_chk_guard) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    /* WARNING: Subroutine does not return */
    FUN_0007fc54("systime.c", 0x76, 2, "sys_fuzz <= 1.0");
}

/* WARNING: Removing unreachable block (ram,0x00070550) */

void FUN_00070518(void)

{
    return;
}

/* WARNING: Control flow encountered bad instruction data */

void FUN_0007055c(int *param_1)

{
    int iVar1;
    __time_t _Var2;
    int iVar3;
    uint uVar4;
    int iVar5;
    undefined4 extraout_r2;
    int iVar6;
    uint uVar7;
    uint uVar8;
    int iVar9;
    uint uVar10;
    uint uVar11;
    undefined4 unaff_r9;
    undefined4 unaff_r10;
    undefined4 extraout_r12;
    bool bVar12;
    bool bVar13;
    undefined4 in_cr1;
    undefined4 in_cr2;
    undefined4 in_cr11;
    double dVar14;
    undefined8 uVar15;
    timespec local_34;
    int local_2c;

    local_2c = __stack_chk_guard;
    iVar3 = clock_gettime(0, &local_34);
    bVar12 = true;
    if (iVar3 < 0) {
        DAT_000c6564 = FUN_0001c6f0();
        __DT_PLTGOT = (undefined *)&DAT_00070b00;
        DAT_000c6580 = 0x70af8;
        DAT_000c657c = extraout_r12;
        DAT_000c6578 = unaff_r10;
        DAT_000c6574 = unaff_r9;
        DAT_000c6570 = param_1;
        DAT_000c656c = &local_34;
        DAT_000c6568 = extraout_r2;
        if (!bVar12) {
            coprocessor_function(0xe, 1, 0, in_cr2, in_cr1, in_cr11);
        }
        /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
    }
    if (trunc_os_clock != 0) {
        local_34.tv_nsec =
            (long)(longlong)(sys_tick *
                             (double)(longlong)(int)(longlong)(((double)(longlong)
                                                                    local_34
                                                                        .tv_nsec *
                                                                1e-09) /
                                                               sys_tick) *
                             1000000000.0);
    }
    iVar6 = local_34.tv_nsec + 50000000;
    iVar3 = local_34.tv_sec;
    if (iVar6 < 0) {
        do {
            iVar6 = iVar6 + 1000000000;
            iVar9 = iVar3 + -1;
            iVar3 = iVar3 + -1;
        } while (iVar6 < 0);
    } else {
        iVar9 = local_34.tv_sec;
        if (999999999 < iVar6) {
            iVar6 = local_34.tv_nsec + 0xc7602680;
            if (iVar6 < 1000000000) {
                iVar9 = local_34.tv_sec + 1;
            } else {
                iVar9 = local_34.tv_sec + 2;
                iVar6 = local_34.tv_nsec + 0x8bc55c80;
            }
        }
    }
    if (DAT_00117f40 < iVar9) {
        iVar3 = 1 - (uint)(iVar9 < DAT_00117f40);
    } else {
        iVar3 = -(uint)(iVar9 < DAT_00117f40);
    }
    if (iVar3 == 0) {
        if ((int)DAT_00117f44 < iVar6) {
            iVar3 = 1 - (uint)(iVar6 < (int)DAT_00117f44);
        } else {
            iVar3 = -(uint)(iVar6 < (int)DAT_00117f44);
        }
    }
    if (iVar3 == -1) {
        DAT_00117f48 = 1;
        sys_lamport = sys_lamport + 1;
    }
    DAT_00117f40 = local_34.tv_sec;
    DAT_00117f44 = local_34.tv_nsec;
    uVar7 = sys_fuzz_nsec + DAT_00117f50;
    uVar8 = uVar7;
    iVar3 = DAT_00117f4c;
    if ((int)uVar7 < 0) {
        do {
            iVar3 = iVar3 + -1;
            uVar8 = uVar8 + 1000000000;
        } while ((int)uVar8 < 0);
    } else if (999999999 < (int)uVar7) {
        uVar8 = uVar7 + 0xc4653600;
        iVar6 = uVar7 + 0x88ca6c01;
        if ((int)uVar8 < 1000000000) {
            iVar3 = DAT_00117f4c + 1;
        } else {
            uVar7 = uVar7 + 0x88ca0000;
        }
        if (uVar8 != 999999999 && iVar6 < 0 == SBORROW4(uVar8, 999999999)) {
            iVar3 = iVar3 + 2;
            uVar8 = uVar7 + 0x6c00;
        }
    }
    if (iVar3 < local_34.tv_sec) {
        iVar6 = 1 - (uint)(local_34.tv_sec < iVar3);
    } else {
        iVar6 = -(uint)(local_34.tv_sec < iVar3);
    }
    if (iVar6 == 0) {
        if ((int)uVar8 < local_34.tv_nsec) {
            iVar6 = 1 - (uint)(local_34.tv_nsec < (int)uVar8);
        } else {
            iVar6 = -(uint)(local_34.tv_nsec < (int)uVar8);
        }
    }
    if (iVar6 == -1) {
        iVar5 = uVar8 - local_34.tv_nsec;
        iVar6 = iVar3 - local_34.tv_sec;
        iVar9 = iVar5;
        if (iVar5 < 0) {
            do {
                iVar6 = iVar6 + -1;
                iVar9 = iVar9 + 1000000000;
            } while (iVar9 < 0);
        } else if (999999999 < iVar5) {
            iVar9 = iVar5 + -1000000000;
            iVar1 = iVar5 + -1999999999;
            if (iVar9 < 1000000000) {
                iVar6 = iVar6 + 1;
            } else {
                iVar5 = iVar5 + -0x77360000;
            }
            if (iVar9 != 999999999 && iVar1 < 0 == SBORROW4(iVar9, 999999999)) {
                iVar6 = iVar6 + 2;
                iVar9 = iVar5 + 0x6c00;
            }
        }
        if (iVar6 < 1) {
            uVar7 = uVar8;
            DAT_00117f50 = uVar8;
            _Var2 = iVar3;
            DAT_00117f4c = iVar3;
            if (DAT_00117f48 == 0)
                goto joined_r0x0007089c;
        } else if (DAT_00117f48 == 0) {
            dVar14 = (double)(longlong)iVar6 + (double)(longlong)iVar9 * 1e-09;
            FUN_00075d40(
                3, "get_systime Lamport advance exceeds one second (%.9f)",
                SUB84(dVar14, 0), (int)((ulonglong)dVar14 >> 0x20));
            /* WARNING: Subroutine does not return */
            exit(1);
        }
    }
    DAT_00117f4c = local_34.tv_sec;
    DAT_00117f50 = local_34.tv_nsec;
    uVar8 = local_34.tv_nsec;
    iVar3 = local_34.tv_sec;
    if (local_34.tv_nsec < 0) {
        do {
            iVar3 = iVar3 + -1;
            uVar8 = uVar8 + 1000000000;
            uVar7 = local_34.tv_nsec;
            _Var2 = local_34.tv_sec;
        joined_r0x0007089c:
            local_34.tv_sec = _Var2;
            local_34.tv_nsec = uVar7;
        } while ((int)uVar8 < 0);
    } else if (999999999 < local_34.tv_nsec) {
        uVar8 = local_34.tv_nsec + 0xc4653600;
        bVar13 = SBORROW4(uVar8, 999999999);
        bVar12 = uVar8 != 999999999;
        if ((int)uVar8 < 1000000000) {
            iVar3 = local_34.tv_sec + 1;
        } else {
            iVar3 = local_34.tv_sec + 2;
            uVar8 = 0x6c00;
        }
        if (bVar12 && (int)(local_34.tv_nsec + 0x88ca6c01U) < 0 == bVar13) {
            uVar8 = local_34.tv_nsec + (uVar8 & 0xffff | 0x88ca0000);
        }
    }
    uVar15 = VectorShiftRight(CONCAT44(uVar8, uVar8), 0x20);
    uVar15 = VectorShiftLeft(uVar15, 0x20, 0x40, 0);
    uVar8 = FUN_0009d518((uint)uVar15 + 500000000,
                         (int)((ulonglong)uVar15 >> 0x20) +
                             (uint)(0xe2329aff < (uint)uVar15),
                         1000000000, 0);
    iVar6 = FUN_00079a2c();
    dVar14 = ((double)(longlong)iVar6 + (double)(longlong)iVar6) *
             2.3283064365386963e-10 * sys_fuzz;
    bVar12 = dVar14 < 0.0;
    if (bVar12) {
        dVar14 = -dVar14;
    }
    uVar10 = (uint)bVar12;
    dVar14 = ldexp(dVar14, 0x20);
    uVar15 = FUN_0009d558(SUB84(dVar14, 0), (int)((ulonglong)dVar14 >> 0x20));
    uVar4 = (uint)uVar15 ^ -uVar10;
    uVar11 = uVar10 + uVar4;
    uVar7 = uVar8 + uVar11;
    iVar3 = iVar3 + -0x7c558180 +
            ((uint)((ulonglong)uVar15 >> 0x20) ^ -(uint)(uVar10 != 0)) +
            (uint)CARRY4(uVar10, uVar4) + (uint)CARRY4(uVar8, uVar11);
    if (DAT_00117f58 == 0 && DAT_00117f54 == 0) {
        if (DAT_00117f48 == 0)
            goto LAB_0007082c;
    } else if (DAT_00117f48 == 0) {
        if (0.0 < sys_fuzz) {
            uVar8 = uVar7 - DAT_00117f58;
            iVar6 = iVar3;
            if (uVar7 < uVar8) {
                iVar6 = iVar3 + -1;
            }
            iVar6 = iVar6 - DAT_00117f54;
            if (uVar8 < uVar8 - 1) {
                iVar6 = iVar6 + -1;
            }
            if (iVar6 < 0) {
                sys_tsrounding = sys_tsrounding + 1;
                iVar3 = (uint)(DAT_00117f58 == -1) + DAT_00117f54;
                uVar7 = DAT_00117f58 + 1;
            }
        }
        goto LAB_0007082c;
    }
    DAT_00117f48 = 0;
LAB_0007082c:
    DAT_00117f58 = uVar7;
    DAT_00117f54 = iVar3;
    iVar3 = DAT_00117f54;
    param_1[1] = DAT_00117f58;
    iVar6 = __stack_chk_guard;
    *param_1 = iVar3;
    if (local_2c == iVar6) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00070b0c(void)

{
    bool bVar1;
    int iVar2;
    double in_d0;
    double dVar3;
    double dVar4;
    timeval local_24;
    timeval tStack_1c;
    int local_14;

    local_14 = __stack_chk_guard;
    if (in_d0 == 0.0) {
        if (((enable_panic_check != 0) && (allow_panic != 0)) &&
            (FUN_00075d40(3, "adj_systime: allow_panic is TRUE!"),
             allow_panic != 0)) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("systime.c", 0x136, 2, "!allow_panic");
        }
    } else {
        dVar3 = in_d0 + sys_residual;
        bVar1 = dVar3 < 0.0;
        if (bVar1) {
            dVar3 = -dVar3;
        }
        local_24.tv_sec = (__time_t)(longlong)dVar3;
        dVar3 = dVar3 - (double)(longlong)local_24.tv_sec;
        dVar4 = sys_tick;
        if (sys_tick <= sys_fuzz) {
            dVar4 = 1e-06;
        }
        local_24.tv_usec =
            (__suseconds_t)(longlong)((double)(longlong)(int)(longlong)(dVar3 /
                                                                            dVar4 +
                                                                        0.5) *
                                          dVar4 * 1000000.0 +
                                      0.5);
        if (999999 < local_24.tv_usec) {
            local_24.tv_usec = local_24.tv_usec + -1000000;
            local_24.tv_sec = local_24.tv_sec + 1;
            dVar3 = dVar3 - 1.0;
        }
        sys_residual = dVar3 - (double)(longlong)local_24.tv_usec * 1e-06;
        if (bVar1) {
            local_24.tv_sec = -local_24.tv_sec;
            local_24.tv_usec = -local_24.tv_usec;
            sys_residual = -sys_residual;
        }
        if (((local_24.tv_sec != 0) || (local_24.tv_usec != 0)) &&
            (iVar2 = adjtime(&local_24, &tStack_1c), iVar2 < 0)) {
            FUN_00075d40(3, "adj_systime: %m");
            iVar2 = enable_panic_check;
            if ((enable_panic_check != 0) &&
                (iVar2 = allow_panic, allow_panic != 0)) {
                FUN_00075d40(3, "adj_systime: allow_panic is TRUE!");
                iVar2 = 0;
            }
            goto LAB_00070b64;
        }
        if ((enable_panic_check != 0) && (allow_panic != 0)) {
            FUN_00075d40(3, "adj_systime: allow_panic is TRUE!");
        }
    }
    iVar2 = 1;
LAB_00070b64:
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2);
}

void FUN_00070d9c(void)

{
    uint uVar1;
    int iVar2;
    uint uVar3;
    uint uVar4;
    uint uVar5;
    uint uVar6;
    uint uVar7;
    int iVar8;
    uint uVar9;
    uint uVar10;
    int iVar11;
    bool bVar12;
    bool bVar13;
    double in_d0;
    double dVar14;
    uint uVar15;
    undefined8 uVar16;
    undefined8 uVar17;
    undefined8 uVar18;
    int local_58[2];
    undefined4 local_50;
    int local_4c;
    undefined *local_48;
    int local_44;
    int local_40;
    timespec local_3c;
    int local_34;

    local_50 = 0x7fffffff;
    local_34 = __stack_chk_guard;
    dVar14 = sys_residual;
    if (sys_residual < 0.0) {
        dVar14 = -sys_residual;
    }
    uVar6 = (uint)(sys_residual < 0.0);
    dVar14 = ldexp(dVar14, 0x20);
    uVar18 = FUN_0009d558(SUB84(dVar14, 0), (int)((ulonglong)dVar14 >> 0x20));
    bVar12 = in_d0 < 0.0;
    uVar1 = (uint)uVar18 ^ -uVar6;
    uVar3 = uVar1 + uVar6;
    if (bVar12) {
        in_d0 = -in_d0;
    }
    uVar10 = (uint)bVar12;
    dVar14 = ldexp(in_d0, 0x20);
    uVar16 = VectorShiftRight((ulonglong)CONCAT14(bVar12, uVar10), 0x20);
    iVar11 = (int)((ulonglong)uVar16 >> 0x20);
    uVar15 = (uint)uVar16;
    uVar16 = FUN_0009d558(SUB84(dVar14, 0), (int)((ulonglong)dVar14 >> 0x20));
    uVar4 = (uint)uVar16 ^ -uVar15;
    uVar7 = uVar4 + uVar15;
    uVar9 = uVar7 + uVar3;
    iVar2 = clock_gettime(0, &local_3c);
    if (iVar2 < 0) {
        iVar2 = FUN_0001c6f0();
    } else {
        if (trunc_os_clock != 0) {
            local_3c.tv_nsec =
                (long)(longlong)(sys_tick *
                                 (double)(longlong)(int)(longlong)(((double)(longlong)
                                                                        local_3c
                                                                            .tv_nsec *
                                                                    1e-09) /
                                                                   sys_tick) *
                                 1000000000.0);
        }
        uVar5 = local_3c.tv_nsec;
        iVar2 = local_3c.tv_sec;
        if (local_3c.tv_nsec < 0) {
            do {
                uVar5 = uVar5 + 1000000000;
                iVar8 = iVar2 + -1;
                iVar2 = iVar2 + -1;
            } while ((int)uVar5 < 0);
        } else {
            iVar8 = local_3c.tv_sec;
            if (999999999 < local_3c.tv_nsec) {
                uVar5 = local_3c.tv_nsec + 0xc4653600;
                bVar13 = SBORROW4(uVar5, 999999999);
                bVar12 = uVar5 != 999999999;
                if ((int)uVar5 < 1000000000) {
                    iVar8 = local_3c.tv_sec + 1;
                } else {
                    iVar8 = local_3c.tv_sec + 2;
                    uVar5 = 0x6c00;
                }
                if (bVar12 &&
                    (int)(local_3c.tv_nsec + 0x88ca6c01U) < 0 == bVar13) {
                    uVar5 = local_3c.tv_nsec + (uVar5 & 0xffff | 0x88ca0000);
                }
            }
        }
        uVar17 = VectorShiftRight(CONCAT44(uVar5, uVar5), 0x20);
        iVar2 = local_3c.tv_nsec + 500;
        uVar17 = VectorShiftLeft(uVar17, 0x20, 0x40, 0);
        uVar5 = FUN_0009d518((uint)uVar17 + 500000000,
                             (int)((ulonglong)uVar17 >> 0x20) +
                                 (uint)(0xe2329aff < (uint)uVar17),
                             1000000000, 0);
        local_44 = local_3c.tv_sec;
        local_40 = iVar2 / 1000;
        FUN_00076898(
            local_58,
            iVar8 + ((uint)((ulonglong)uVar18 >> 0x20) ^ -(uint)(uVar6 != 0)) +
                (uint)CARRY4(uVar1, uVar6) + -0x7c558180 +
                ((uint)((ulonglong)uVar16 >> 0x20) ^
                 -(iVar11 + (uint)(uVar15 != 0))) +
                iVar11 + (uint)CARRY4(uVar4, uVar15) +
                (uint)CARRY4(uVar7, uVar3) + (uint)CARRY4(uVar5, uVar9),
            &local_50);
        local_48 =
            (undefined *)((ulonglong)(uVar5 + uVar9) * 1000000 + 0x80000000 >>
                          0x20);
        local_4c = local_58[0];
        if (local_48 == &DAT_000f4240) {
            local_4c = local_58[0] + 1;
            local_48 = (undefined *)0x0;
        }
        iVar2 = FUN_00075254(&local_4c, 0);
        if (iVar2 == 0) {
            sys_residual._0_4_ = 0;
            sys_residual._4_4_ = 0;
            DAT_00117f48 = uVar10;
            if (step_callback != (code *)0x0) {
                (*step_callback)();
            }
            FUN_00070310(local_4c, local_48, local_44, local_40);
            if (((enable_panic_check != 0) && (allow_panic != 0)) &&
                (FUN_00075d40(3, "step_systime: allow_panic is TRUE!"),
                 allow_panic != 0)) {
                /* WARNING: Subroutine does not return */
                FUN_0007fc54("systime.c", 0x24d, 2, "!allow_panic");
            }
            iVar2 = 1;
        } else {
            FUN_00075d40(3, "step-systime: %m");
            iVar2 = enable_panic_check;
            if ((enable_panic_check != 0) &&
                (iVar2 = allow_panic, allow_panic != 0)) {
                FUN_00075d40(3, "step_systime: allow_panic is TRUE!");
                iVar2 = 0;
            }
        }
        if (local_34 == __stack_chk_guard) {
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2);
}

/* WARNING: Removing unreachable block (ram,0x000711f4) */

void FUN_000711b8(void)

{
    return;
}

void FUN_00071200(undefined4 *param_1, int param_2, undefined4 *param_3,
                  undefined4 *param_4)

{
    EVP_MD_CTX *ctx;
    char *pcVar1;
    EVP_MD *pEVar2;
    int iVar3;
    size_t sVar4;
    CMAC_CTX *ctx_00;
    EVP_CIPHER *cipher;
    EVP_CIPHER_CTX *ctx_01;
    uint uVar5;
    undefined1 *key;
    size_t local_3c;
    uint local_38;
    undefined1 auStack_34[16];
    int local_24;

    local_3c = 0;
    local_24 = __stack_chk_guard;
    if (ssl_init_done == 0) {
        FUN_0007d690();
    }
    if (param_2 == 0x37e) {
        uVar5 = param_3[1];
        key = (undefined1 *)*param_3;
        if (uVar5 < 0x10) {
            key = auStack_34;
            __memcpy_chk(key, (undefined1 *)*param_3, uVar5, 0x10);
            memset(key + uVar5, 0, 0x10 - uVar5);
        }
        ctx_00 = CMAC_CTX_new();
        if (ctx_00 == (CMAC_CTX *)0x0) {
            FUN_00075d40(3, "MAC encrypt: CMAC %s CTX new failed.",
                         "AES128CMAC");
            sVar4 = local_3c;
        } else {
            cipher = EVP_aes_128_cbc();
            iVar3 = CMAC_Init(ctx_00, key, 0x10, cipher, (ENGINE *)0x0);
            if (iVar3 == 0) {
                FUN_00075d40(3, "MAC encrypt: CMAC %s Init failed.",
                             "AES128CMAC");
            } else {
                ctx_01 = CMAC_CTX_get0_cipher_ctx(ctx_00);
                if ((ctx_01 == (EVP_CIPHER_CTX *)0x0) ||
                    (uVar5 = EVP_CIPHER_CTX_block_size(ctx_01),
                     uVar5 <= (uint)param_1[1])) {
                    iVar3 = CMAC_Update(ctx_00, (void *)*param_4, param_4[1]);
                    if (iVar3 == 0) {
                        FUN_00075d40(3, "MAC encrypt: CMAC %s Update failed.",
                                     "AES128CMAC");
                    } else {
                        iVar3 =
                            CMAC_Final(ctx_00, (uchar *)*param_1, &local_3c);
                        if (iVar3 == 0) {
                            FUN_00075d40(3,
                                         "MAC encrypt: CMAC %s Final failed.",
                                         "AES128CMAC");
                            local_3c = 0;
                        }
                    }
                } else {
                    FUN_00075d40(3, "MAC encrypt: CMAC %s buf too small.",
                                 "AES128CMAC");
                }
            }
            CMAC_CTX_cleanup(ctx_00);
            sVar4 = local_3c;
        }
    } else {
        ctx = (EVP_MD_CTX *)EVP_MD_CTX_new();
        local_38 = 0;
        if (ctx == (EVP_MD_CTX *)0x0) {
            pcVar1 = OBJ_nid2sn(param_2);
            FUN_00075d40(3, "MAC encrypt: MAC %s Digest CTX new failed.",
                         pcVar1);
            sVar4 = local_38;
        } else {
            EVP_MD_CTX_set_flags(ctx, 8);
            pcVar1 = OBJ_nid2sn(param_2);
            pEVar2 = EVP_get_digestbyname(pcVar1);
            iVar3 = EVP_DigestInit_ex(ctx, pEVar2, (ENGINE *)0x0);
            if (iVar3 == 0) {
                pcVar1 = OBJ_nid2sn(param_2);
                FUN_00075d40(3, "MAC encrypt: MAC %s Digest Init failed.",
                             pcVar1);
            } else {
                pEVar2 = EVP_MD_CTX_md(ctx);
                uVar5 = EVP_MD_size(pEVar2);
                if ((uint)param_1[1] < uVar5) {
                    pcVar1 = OBJ_nid2sn(param_2);
                    FUN_00075d40(3, "MAC encrypt: MAC %s buf too small.",
                                 pcVar1);
                } else {
                    iVar3 = EVP_DigestUpdate(ctx, (void *)*param_3, param_3[1]);
                    if (iVar3 == 0) {
                        pcVar1 = OBJ_nid2sn(param_2);
                        FUN_00075d40(
                            3, "MAC encrypt: MAC %s Digest Update key failed.",
                            pcVar1);
                    } else {
                        iVar3 =
                            EVP_DigestUpdate(ctx, (void *)*param_4, param_4[1]);
                        if (iVar3 == 0) {
                            pcVar1 = OBJ_nid2sn(param_2);
                            FUN_00075d40(3,
                                         "MAC encrypt: MAC %s Digest Update "
                                         "data failed.",
                                         pcVar1);
                        } else {
                            iVar3 = EVP_DigestFinal(ctx, (uchar *)*param_1,
                                                    &local_38);
                            if (iVar3 == 0) {
                                pcVar1 = OBJ_nid2sn(param_2);
                                FUN_00075d40(
                                    3,
                                    "MAC encrypt: MAC %s Digest Final failed.",
                                    pcVar1);
                                local_38 = 0;
                            }
                        }
                    }
                }
            }
            local_3c = local_38;
            EVP_MD_CTX_free(ctx);
            sVar4 = local_3c;
        }
    }
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(sVar4);
}

void FUN_000715b4(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  int param_4, int param_5)

{
    uint __n;
    undefined1 *puStack_74;
    undefined4 uStack_70;
    undefined4 local_6c;
    undefined4 local_68;
    int local_64;
    int local_60;
    undefined1 auStack_5c[64];
    int local_1c;

    local_1c = __stack_chk_guard;
    uStack_70 = 0x40;
    local_60 = param_5;
    puStack_74 = auStack_5c;
    local_6c = param_2;
    local_68 = param_3;
    local_64 = param_4;
    __n = FUN_00071200(&puStack_74, param_1, &local_6c, &local_64);
    if (0x13 < __n) {
        __n = 0x14;
    }
    memcpy((void *)(param_4 + param_5 + 4), auStack_5c, __n);
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__n + 4);
}

void FUN_00071654(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  int param_4, int param_5, int param_6)

{
    bool bVar1;
    uint uVar2;
    int iVar3;
    undefined1 *puStack_74;
    undefined4 uStack_70;
    undefined4 local_6c;
    undefined4 local_68;
    int local_64;
    int local_60;
    undefined1 auStack_5c[64];
    int local_1c;

    local_1c = __stack_chk_guard;
    uStack_70 = 0x40;
    local_60 = param_5;
    puStack_74 = auStack_5c;
    local_6c = param_2;
    local_68 = param_3;
    local_64 = param_4;
    uVar2 = FUN_00071200(&puStack_74, param_1, &local_6c, &local_64);
    if (0x13 < uVar2) {
        uVar2 = 0x14;
    }
    if (uVar2 + 4 == param_6) {
        iVar3 = FUN_00089834(auStack_5c, param_4 + param_5 + 4, uVar2);
        bVar1 = iVar3 == 0;
    } else {
        FUN_00075d40(3, "MAC decrypt: MAC length error");
        bVar1 = false;
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(bVar1);
}

void FUN_00071720(short *param_1)

{
    EVP_MD_CTX *ctx;
    EVP_MD *type;
    int iVar1;
    uint uStack_58;
    undefined4 local_54[16];
    int local_14;

    local_14 = __stack_chk_guard;
    if (*param_1 == 2) {
        local_54[0] = *(undefined4 *)(param_1 + 2);
    } else {
        if (ssl_init_done == 0) {
            FUN_0007d690(param_1);
        }
        ctx = (EVP_MD_CTX *)EVP_MD_CTX_new();
        EVP_MD_CTX_set_flags(ctx, 8);
        type = EVP_md5();
        iVar1 = EVP_DigestInit_ex(ctx, type, (ENGINE *)0x0);
        if (iVar1 == 0) {
            FUN_00075d40(3, "MD5 init failed");
            EVP_MD_CTX_free(ctx);
            /* WARNING: Subroutine does not return */
            exit(1);
        }
        EVP_DigestUpdate(ctx, param_1 + 4, 0x10);
        EVP_DigestFinal(ctx, (uchar *)local_54, &uStack_58);
        EVP_MD_CTX_free(ctx);
    }
    if (local_14 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(local_54[0]);
    }
    return;
}

void FUN_00071924(char *param_1, int param_2)

{
    int iVar1;
    int iVar2;
    uint uVar3;

    iVar1 = __stack_chk_guard;
    uVar3 = 0;
    do {
        if (((param_2 >> (uVar3 & 0xff) & 1U) != 0) &&
            (iVar2 = strcmp((&PTR_DAT_000c5b64)[uVar3], param_1), iVar2 == 0))
            goto LAB_00071988;
        uVar3 = uVar3 + 1;
    } while (uVar3 != 0x19);
    uVar3 = 0xffffffff;
LAB_00071988:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar3);
    }
    return;
}

void FUN_000719b8(char *param_1, undefined4 param_2, undefined4 param_3)

{
    byte bVar1;
    ushort uVar2;
    FILE *__stream;
    char *pcVar3;
    size_t sVar4;
    ushort **ppuVar5;
    __int32_t **pp_Var6;
    int iVar7;
    undefined4 uVar8;
    int iVar9;
    int iVar10;
    int *piVar11;
    ushort *puVar12;
    byte *pbVar13;
    uint uVar14;
    uint uVar15;
    size_t sVar16;
    byte *__s;
    byte *__s1;
    char *local_148;
    char acStack_128[20];
    char acStack_114[31];
    byte abStack_f5[101];
    undefined1 auStack_90[100];
    int local_2c;

    local_2c = __stack_chk_guard;
    FUN_0007d00c(acStack_114, 0x1e, "/dev/mixer%d", param_3);
    FUN_0007d00c(acStack_128, 0x14, &DAT_000ab3b0, "/etc/ntp.audio", param_3);
    __stream = fopen64(acStack_128, "r");
    if (__stream == (FILE *)0x0) {
        __printf_chk(1, "audio_config_read: <%s> NO\n", acStack_128);
        FUN_0007d00c(acStack_128, 0x14, "%s.%d", "/etc/ntp.audio", param_3);
        __stream = fopen64(acStack_128, "r");
        if (__stream == (FILE *)0x0) {
            __printf_chk(1, "audio_config_read: <%s> NO\n", acStack_128);
            FUN_0007d00c(acStack_128, 0x14, "%s", "/etc/ntp.audio", param_3);
            __stream = fopen64(acStack_128, "r");
            if (__stream == (FILE *)0x0) {
                __printf_chk(1, "audio_config_read: <%s> NO\n", acStack_128);
                goto LAB_00071e04;
            }
        }
    }
    __s = abStack_f5 + 1;
    __printf_chk(1, "audio_config_read: reading <%s>\n", acStack_128);
LAB_00071aa8:
    pcVar3 = fgets((char *)__s, 100, __stream);
    if (pcVar3 != (char *)0x0) {
        pcVar3 = strchr((char *)__s, 0x23);
        if (pcVar3 != (char *)0x0) {
            *pcVar3 = '\0';
        }
        sVar4 = strlen((char *)__s);
        if (0 < (int)sVar4) {
            bVar1 = abStack_f5[sVar4];
            if ((bVar1 & 0x80) == 0) {
                ppuVar5 = __ctype_b_loc();
                pbVar13 = __s + (sVar4 - 1);
                puVar12 = *ppuVar5;
                sVar16 = sVar4 - 1;
                do {
                    sVar4 = sVar16 + 1;
                    if (((puVar12[bVar1] & 0x2000) == 0) ||
                        (*pbVar13 = 0, sVar4 = sVar16, sVar16 == 0))
                        break;
                    pbVar13 = pbVar13 + -1;
                    bVar1 = *pbVar13;
                    sVar16 = sVar16 - 1;
                } while ((bVar1 & 0x80) == 0);
            }
        }
        uVar15 = (uint)abStack_f5[1];
        if (uVar15 != 0) {
            uVar14 = uVar15 & 0xffffff80;
            pbVar13 = __s;
            __s1 = __s;
            if ((abStack_f5[1] & 0x80) == 0) {
                ppuVar5 = __ctype_b_loc();
                do {
                    if (((*ppuVar5)[uVar15] & 0x2000) == 0) {
                        uVar15 = (uint)*__s1;
                        pbVar13 = __s1;
                        if (uVar15 == 0)
                            goto LAB_00071c1c;
                        uVar14 = uVar15 & 0xffffff80;
                        break;
                    }
                    __s1 = __s1 + 1;
                    uVar15 = (uint)*__s1;
                    if (uVar15 == 0)
                        goto LAB_00071aa8;
                    uVar14 = uVar15 & 0xffffff80;
                    pbVar13 = __s1;
                } while ((*__s1 & 0x80) == 0);
            }
            do {
                if (uVar14 == 0) {
                    ppuVar5 = __ctype_b_loc();
                    uVar2 = (*ppuVar5)[(short)uVar15];
                    if ((uVar2 & 0x200) == 0) {
                        uVar14 = ((uint)uVar2 << 0x12) >> 0x1f;
                        if (uVar15 == 0x3d) {
                            uVar14 = 1;
                        }
                        if (uVar14 != 0) {
                            uVar15 = (uint)*pbVar13;
                            if (uVar15 != 0)
                                goto LAB_00071bf4;
                            goto LAB_00071c1c;
                        }
                    } else {
                        pp_Var6 = __ctype_toupper_loc();
                        *pbVar13 = (byte)(*pp_Var6)[(short)uVar15];
                    }
                }
                pbVar13 = pbVar13 + 1;
                uVar15 = (uint)*pbVar13;
                if (uVar15 == 0)
                    goto LAB_00071c1c;
                uVar14 = uVar15 & 0xffffff80;
            } while (true);
        }
        goto LAB_00071aa8;
    }
    fclose(__stream);
LAB_00071e04:
    pcVar3 = acStack_114;
    if (DAT_00117f88 != '\0') {
        pcVar3 = &DAT_00117f88;
    }
    local_148 = param_1;
    if (DAT_00117fec != '\0') {
        local_148 = &DAT_00117fec;
    }
    iVar7 = open64(local_148, 0x802, 0x1ff);
    if (iVar7 < 0) {
        FUN_00075d40(3, "audio_init: %s %m", local_148);
    } else {
        DAT_00118118 = open64(pcVar3, 2);
        if (DAT_00118118 < 0) {
            FUN_00075d40(3, "audio_init: invalid control device <%s>", pcVar3);
            close(iVar7);
            iVar7 = DAT_00118118;
        } else {
            __printf_chk(1, "audio_init: <%s> bufsiz %d\n", local_148, param_2);
            iVar9 = ioctl(iVar7, 0xc004500a);
            if (iVar9 == -1) {
                piVar11 = __errno_location();
                pcVar3 = strerror(*piVar11);
                __printf_chk(1, "audio_init: SNDCTL_DSP_SETFRAGMENT: %s\n",
                             pcVar3);
            }
            iVar9 = DAT_00118118;
            iVar10 = ioctl(DAT_00118118, 0x80044dfe, &DAT_0011811c);
            if (iVar10 == -1) {
                piVar11 = __errno_location();
                pcVar3 = strerror(*piVar11);
                __printf_chk(1, "SOUND_MIXER_READ_DEVMASK: %s\n", pcVar3);
                iVar9 = DAT_00118118;
            }
            iVar9 = ioctl(iVar9, 0x80044dfd, &DAT_00118120);
            if (iVar9 == -1) {
                piVar11 = __errno_location();
                pcVar3 = strerror(*piVar11);
                __printf_chk(1, "SOUND_MIXER_READ_RECMASK: %s\n", pcVar3);
            }
            uVar8 = DAT_00118120;
            if (DAT_00118050 != '\0') {
                uVar15 = FUN_00071924(&DAT_00118050, DAT_00118120);
                if ((int)uVar15 < 0) {
                    __printf_chk(1, "input %s not in recmask %#x\n",
                                 &DAT_00118050, uVar8);
                } else {
                    DAT_000c8cc0 = uVar15 | 0xc0044d00;
                }
            }
            uVar8 = DAT_0011811c;
            if (DAT_001180b4 != '\0') {
                uVar15 = FUN_00071924(&DAT_001180b4, DAT_0011811c);
                if ((int)uVar15 < 0) {
                    __printf_chk(1, "monitor %s not in devmask %#x\n",
                                 &DAT_001180b4, uVar8);
                } else {
                    DAT_000c8cc4 = uVar15 | 0xc0044d00;
                }
            }
        }
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar7);
    while (true) {
        uVar14 = ((uint)(*ppuVar5)[uVar15] << 0x12) >> 0x1f;
        if (uVar15 == 0x3d) {
            uVar14 = 1;
        }
        if (uVar14 == 0)
            break;
        pbVar13 = pbVar13 + 1;
        uVar15 = (uint)*pbVar13;
        if (uVar15 == 0)
            break;
    LAB_00071bf4:
        if ((uVar15 & 0x80) != 0)
            break;
    }
LAB_00071c1c:
    iVar7 = strncmp((char *)__s1, "IDEV", 4);
    if (iVar7 == 0) {
        iVar7 = sscanf((char *)pbVar13, "%99s", auStack_90);
        if (iVar7 == 1) {
            FUN_0007e4b4(&DAT_00117fec, auStack_90);
            __printf_chk(1, "idev <%s>\n", auStack_90);
            goto LAB_00071aa8;
        }
    }
    iVar7 = strncmp((char *)__s1, "CDEV", 4);
    if (iVar7 == 0) {
        iVar7 = sscanf((char *)pbVar13, "%99s", auStack_90);
        if (iVar7 == 1) {
            FUN_0007e4b4(&DAT_00117f88, auStack_90, 100);
            __printf_chk(1, "cdev <%s>\n", auStack_90);
            goto LAB_00071aa8;
        }
    }
    iVar7 = strncmp((char *)__s1, "AGC", 3);
    if (iVar7 == 0) {
        iVar7 = sscanf((char *)pbVar13, "%99s", auStack_90);
        if (iVar7 == 1) {
            FUN_0007e4b4(&DAT_00118050, auStack_90, 100);
            __printf_chk(1, "agc <%s> %d\n", auStack_90, sVar4);
            goto LAB_00071aa8;
        }
    }
    iVar7 = strncmp((char *)__s1, "MONITOR", 7);
    if (iVar7 == 0) {
        iVar7 = sscanf((char *)pbVar13, "%99s", auStack_90);
        if (iVar7 == 1) {
            FUN_0007e4b4(&DAT_001180b4, auStack_90, 100);
            uVar8 = FUN_00071924(auStack_90, 0xffffffff);
            __printf_chk(1, "monitor <%s> %d\n", auStack_90, uVar8);
        }
    }
    goto LAB_00071aa8;
}

void FUN_000721dc(int param_1, int param_2, int param_3)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    char *pcVar4;
    ulong uVar5;
    uint local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    local_20 = (param_1 * 100) / 0xff;
    local_20 = local_20 | local_20 * 0x100;
    if (DAT_00118050 == '\0') {
        uVar5 = 0xc0044d06;
        if (param_3 != 2) {
            uVar5 = 0xc0044d07;
        }
        iVar2 = ioctl(DAT_00118118, uVar5, &local_20);
    } else {
        iVar2 = ioctl(DAT_00118118, DAT_000c8cc0, &local_20);
    }
    if (iVar2 == -1) {
        piVar3 = __errno_location();
        pcVar4 = strerror(*piVar3);
        __printf_chk(1, "audio_gain: agc write: %s\n", pcVar4);
        iVar1 = DAT_000c8ccc;
    } else {
        iVar1 = DAT_000c8cc8;
        if (DAT_000c8cc8 != param_2) {
            local_20 = (param_2 * 100) / 0xff;
            uVar5 = DAT_000c8cc4;
            if (DAT_001180b4 == '\0') {
                uVar5 = 0xc0044d00;
            }
            local_20 = local_20 | local_20 * 0x100;
            iVar2 = ioctl(DAT_00118118, uVar5, &local_20);
            iVar1 = param_2;
            if (iVar2 == -1) {
                piVar3 = __errno_location();
                pcVar4 = strerror(*piVar3);
                __printf_chk(1, "audio_gain: mongain write: %s\n", pcVar4);
                iVar1 = DAT_000c8ccc;
                goto LAB_0007234c;
            }
        }
        DAT_000c8cc8 = iVar1;
        iVar1 = DAT_000c8ccc;
        if (DAT_000c8ccc != param_3) {
            if (param_3 == 2) {
                local_20 = 0x40;
            } else {
                local_20 = 0x80;
            }
            iVar2 = ioctl(DAT_00118118, 0xc0044dff, &local_20);
            iVar1 = param_3;
            if (iVar2 == -1) {
                piVar3 = __errno_location();
                pcVar4 = strerror(*piVar3);
                __printf_chk(1, "SOUND_MIXER_WRITE_RECSRC: %s\n", pcVar4);
                iVar1 = DAT_000c8ccc;
            }
        }
    }
LAB_0007234c:
    DAT_000c8ccc = iVar1;
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2);
}

/* WARNING: Removing unreachable block (ram,0x00072568) */

void FUN_000724e4(void)

{
    cache_keyid = 0;
    cache_type = 0;
    cache_flags = 0;
    cache_secret = 0;
    cache_secretsize = 0;
    cache_keyacclist = 0;
    return;
}

void FUN_0007258c(undefined4 param_1, undefined4 *param_2, undefined4 param_3)

{
    int iVar1;
    int iVar2;
    undefined4 *puVar3;
    undefined4 uVar4;
    undefined4 uVar5;
    undefined4 uVar6;

    iVar1 = __stack_chk_guard;
    puVar3 = (undefined4 *)FUN_00074b04(0, 0x24, 0);
    uVar6 = param_2[1];
    uVar4 = param_2[2];
    uVar5 = param_2[3];
    puVar3[1] = *param_2;
    iVar2 = __stack_chk_guard;
    puVar3[2] = uVar6;
    puVar3[3] = uVar4;
    puVar3[4] = uVar5;
    uVar5 = param_2[5];
    uVar4 = param_2[6];
    puVar3[5] = param_2[4];
    puVar3[6] = uVar5;
    puVar3[7] = uVar4;
    puVar3[8] = param_3;
    *puVar3 = param_1;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00072630(undefined4 *param_1)

{
    int iVar1;
    undefined4 *puVar2;

    iVar1 = __stack_chk_guard;
    puVar2 = param_1;
    if (param_1 != (undefined4 *)0x0) {
        puVar2 = (undefined4 *)*param_1;
        free(param_1);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(puVar2);
}

void FUN_00072688(int param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if (param_1 != 0) {
        do {
            iVar2 = FUN_00072630();
        } while (iVar2 != 0);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(0);
}

void FUN_000726e4(int *param_1)

{
    int iVar1;
    int *piVar2;
    uint uVar3;
    int *piVar4;
    int iVar5;
    uint uVar6;
    int *piVar7;

    iVar1 = __stack_chk_guard;
    if (param_1 != (int *)0x0) {
        if (param_1[6] == cache_keyid) {
            FUN_000724e4();
        }
        FUN_00072688(param_1[4]);
        iVar5 = key_hash;
        uVar3 = param_1[6];
        uVar6 = (uint)authhashmask;
        piVar7 = (int *)(key_hash + (uVar6 & uVar3) * 4);
        if ((void *)param_1[3] != (void *)0x0) {
            memset((void *)param_1[3], 0, param_1[8]);
            free((void *)param_1[3]);
        }
        piVar2 = *(int **)(iVar5 + (uVar6 & uVar3) * 4);
        piVar4 = param_1;
        if (piVar2 == param_1) {
        LAB_000727b4:
            *piVar7 = *piVar4;
        } else if (piVar2 != (int *)0x0) {
            piVar7 = piVar2;
            for (piVar4 = (int *)*piVar2; piVar4 != (int *)0x0;
                 piVar4 = (int *)*piVar4) {
                if (param_1 == piVar4)
                    goto LAB_000727b4;
                piVar7 = piVar4;
            }
        }
        iVar5 = param_1[1];
        *(int *)(iVar5 + 8) = param_1[2];
        *(int *)(param_1[2] + 4) = iVar5;
        memset(param_1 + 3, 0, 0x1c);
        piVar7 = param_1;
        param_1[2] = (int)authfreekeys;
        authfreekeys = piVar7;
        authnumkeys = authnumkeys + -1;
        authnumfreekeys = authnumfreekeys + 1;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00072868(ushort *param_1, ushort *param_2, uint param_3)

{
    int iVar1;
    int iVar2;
    uint uVar3;
    uint uVar4;
    bool bVar5;

    iVar1 = __stack_chk_guard;
    if (param_1 == (ushort *)0x0) {
        bVar5 = false;
        goto LAB_000728c4;
    }
    uVar3 = (uint)*param_1;
    if (uVar3 != 0 && param_2 != (ushort *)0x0) {
        bVar5 = false;
        uVar4 = uVar3 - *param_2;
        if (uVar4 != 0) {
            uVar4 = 1;
        }
        if (*param_2 == 0) {
            uVar4 = uVar4 | 1;
        }
        if (uVar4 != 0)
            goto LAB_000728c4;
        if (uVar3 == 2) {
            param_1 = param_1 + 2;
            param_2 = param_2 + 2;
            if (0x1f < param_3) {
                param_3 = 0x20;
            }
        } else {
            if ((uVar3 != 10) ||
                (*(int *)(param_1 + 0xc) != *(int *)(param_2 + 0xc))) {
                bVar5 = false;
                goto LAB_000728c4;
            }
            param_1 = param_1 + 4;
            param_2 = param_2 + 4;
            if (0x7f < param_3) {
                param_3 = 0x80;
            }
        }
        uVar3 = param_3 >> 3;
        uVar4 = ~(0xffU >> (param_3 & 7)) & 0xff;
        if ((uVar3 == 0) ||
            (iVar2 = memcmp(param_1, param_2, uVar3), iVar2 == 0)) {
            if (uVar4 == 0) {
                bVar5 = true;
            } else {
                bVar5 = (uVar4 & (*(byte *)((int)param_1 + uVar3) ^
                                  *(byte *)((int)param_2 + uVar3))) == 0;
            }
            goto LAB_000728c4;
        }
    }
    bVar5 = false;
LAB_000728c4:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(bVar5);
    }
    return;
}

void FUN_0007299c(int *param_1, undefined4 param_2, int param_3)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if (param_1 == (int *)0x0) {
        if (param_3 != 0) {
            param_3 = 1;
        }
    } else {
        do {
            iVar2 = FUN_00072868(param_1 + 1, param_2, param_1[8]);
            if (iVar2 != 0) {
                param_3 = 1;
                break;
            }
            param_1 = (int *)*param_1;
            param_3 = 0;
        } while (param_1 != (int *)0x0);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(param_3);
    }
    return;
}

void FUN_00072a24(void)

{
    int iVar1;
    uint uVar2;

    iVar1 = __stack_chk_guard;
    uVar2 = (uint)authhashbuckets;
    key_hash = (void *)FUN_00074b04(key_hash, uVar2 << 2, 0);
    memset(key_hash, 0, uVar2 << 2);
    key_listhead._8_4_ = key_listhead;
    key_listhead._4_4_ = key_listhead;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00072ac0(int param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int iVar4;

    iVar1 = __stack_chk_guard;
    if (param_1 < 1) {
        param_1 = 0x10;
    }
    iVar2 = FUN_00074bcc(0, param_1, 0x28);
    authnumfreekeys = param_1 + authnumfreekeys;
    iVar3 = param_1;
    iVar4 = iVar2;
    do {
        iVar3 = iVar3 + -1;
        *(int *)(iVar4 + 8) = authfreekeys;
        authfreekeys = iVar4;
        iVar4 = iVar4 + 0x28;
    } while (iVar3 != 0);
    authfreekeys = iVar2 + (param_1 + -1) * 0x28;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00072b84(uint param_1, undefined2 param_2, undefined2 param_3,
                  undefined4 param_4, undefined4 param_5, undefined4 param_6,
                  undefined4 param_7)

{
    int iVar1;
    undefined4 *puVar2;
    int iVar3;
    uint uVar4;
    undefined4 *unaff_r9;
    undefined4 uVar5;
    bool bVar6;

    iVar3 = __stack_chk_guard;
    iVar1 = key_hash;
    uVar4 = (uint)authhashmask;
    if (authnumfreekeys < 1) {
        FUN_00072ac0(0xffffffff);
    }
    puVar2 = authfreekeys;
    authnumfreekeys = authnumfreekeys + -1;
    bVar6 = authfreekeys != (undefined4 *)0x0;
    authfreekeys[3] = param_6;
    if (bVar6) {
        unaff_r9 = (undefined4 *)puVar2[2];
    }
    puVar2[4] = param_7;
    if (bVar6) {
        authfreekeys = unaff_r9;
    }
    uVar5 = *(undefined4 *)(iVar1 + (uVar4 & param_1) * 4);
    *(undefined2 *)(puVar2 + 7) = param_3;
    *puVar2 = uVar5;
    *(undefined2 *)(puVar2 + 9) = param_2;
    puVar2[8] = param_5;
    puVar2[6] = param_1;
    puVar2[5] = param_4;
    *(undefined4 **)(iVar1 + (uVar4 & param_1) * 4) = puVar2;
    uVar5 = key_listhead._4_4_;
    puVar2[2] = key_listhead;
    puVar2[1] = uVar5;
    uVar5 = key_listhead._4_4_;
    key_listhead._4_4_ = puVar2;
    *(undefined4 **)(uVar5 + 8) = puVar2;
    authnumkeys = authnumkeys + 1;
    if (iVar3 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00072cd4(int param_1)

{
    size_t __n;
    void *pvVar1;
    int iVar2;
    uint uVar3;
    undefined4 *puVar4;
    int iVar5;
    uint uVar6;
    int iVar7;
    undefined4 *puVar8;
    int iVar9;

    iVar2 = __stack_chk_guard;
    uVar6 = authnumfreekeys + authnumkeys;
    if (0 < (int)(param_1 - uVar6)) {
        FUN_00072ac0();
        uVar6 = authnumfreekeys + authnumkeys;
    }
    uVar6 = uVar6 >> 2;
    iVar9 = 5;
    iVar5 = 0;
    iVar7 = 0x10;
    uVar3 = 0xffffffff;
    do {
        uVar3 = uVar3 << iVar7;
        if ((uVar3 & uVar6) == 0) {
            uVar6 = uVar6 << iVar7;
        } else {
            iVar5 = iVar5 + iVar7;
        }
        iVar9 = iVar9 + -1;
        iVar7 = iVar7 >> 1;
    } while (iVar9 != 0);
    uVar6 = iVar5 + 1U & 0xffff;
    if (uVar6 < 4) {
        uVar6 = 4;
    }
    if (0xe < uVar6) {
        uVar6 = 0xf;
    }
    iVar7 = 1 << (uVar6 & 0xff);
    authhashbuckets = (short)iVar7;
    authhashmask = authhashbuckets - 1;
    __n = iVar7 << 2;
    key_hash = (void *)FUN_00074b04(key_hash, __n, 0, 0);
    memset(key_hash, 0, __n);
    if ((undefined1 *)key_listhead._8_4_ != key_listhead) {
        uVar6 = (uint)authhashmask;
        puVar8 = (undefined4 *)key_listhead._8_4_;
        do {
            pvVar1 = key_hash;
            puVar4 = (undefined4 *)puVar8[2];
            *puVar8 = *(undefined4 *)((int)key_hash + (puVar8[6] & uVar6) * 4);
            *(undefined4 **)((int)pvVar1 + (puVar8[6] & uVar6) * 4) = puVar8;
            puVar8 = puVar4;
        } while (puVar4 != (undefined4 *)key_listhead);
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00072ec8) */

void FUN_00072e48(uint param_1)

{
    int *piVar1;

    for (piVar1 = *(int **)(key_hash + (authhashmask & param_1) * 4);
         (piVar1 != (int *)0x0 && (piVar1[6] != param_1));
         piVar1 = (int *)*piVar1) {
    }
    return;
}

void FUN_00072edc(int param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if ((param_1 == 0) || (cache_keyid == param_1)) {
        iVar2 = 1;
    } else {
        iVar2 = FUN_00072e48();
        if (iVar2 != 0) {
            iVar2 = 1;
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar2);
    }
    return;
}

void FUN_00072f54(int param_1)

{
    ushort uVar1;
    int iVar2;
    ushort uVar3;
    int iVar4;

    iVar2 = __stack_chk_guard;
    authkeylookups = authkeylookups + 1;
    if ((param_1 == 0) || (cache_keyid == param_1)) {
        uVar3 = cache_flags & 1;
    } else {
        authkeyuncached = authkeyuncached + 1;
        iVar4 = FUN_00072e48();
        if ((iVar4 == 0) || (*(ushort *)(iVar4 + 0x1c) == 0)) {
            uVar3 = 0;
            authkeynotfound = authkeynotfound + 1;
        } else {
            uVar1 = *(ushort *)(iVar4 + 0x24);
            uVar3 = uVar1 & 1;
            if ((uVar1 & 1) == 0) {
                authnokey = authnokey + 1;
            } else {
                cache_keyid = *(int *)(iVar4 + 0x18);
                uVar3 = 1;
                cache_secret = *(undefined4 *)(iVar4 + 0xc);
                cache_keyacclist = *(undefined4 *)(iVar4 + 0x10);
                cache_secretsize = *(undefined4 *)(iVar4 + 0x20);
                cache_flags = uVar1;
                cache_type = (uint) * (ushort *)(iVar4 + 0x1c);
            }
        }
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_000730c4(int param_1, uint param_2)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00072e48();
    if (iVar2 != 0 || param_2 != 0) {
        if (iVar2 == 0) {
            if (param_2 < 2) {
                iVar2 = 0;
            } else {
                iVar2 = param_2 + current_time;
            }
            FUN_00072b84(param_1, 1, 0, iVar2, 0, 0, 0);
        } else {
            if (param_1 == cache_keyid) {
                FUN_000724e4();
            }
            if (param_2 == 0) {
                if (iVar1 == __stack_chk_guard) {
                    FUN_000726e4();
                    return;
                }
                goto LAB_000731d4;
            }
            *(ushort *)(iVar2 + 0x24) = *(ushort *)(iVar2 + 0x24) | 1;
            if (param_2 < 2) {
                *(undefined4 *)(iVar2 + 0x14) = 0;
            } else {
                *(uint *)(iVar2 + 0x14) = param_2 + current_time;
            }
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_000731d4:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000731e8(int param_1)

{
    int iVar1;
    ushort uVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    if (param_1 == cache_keyid) {
        uVar2 = cache_flags & 1;
    } else {
        authkeyuncached = authkeyuncached + 1;
        iVar3 = FUN_00072e48();
        if ((iVar3 == 0) || ((*(ushort *)(iVar3 + 0x24) & 1) == 0)) {
            uVar2 = 0;
            authkeynotfound = authkeynotfound + 1;
        } else {
            uVar2 = 1;
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2);
    }
    return;
}

void FUN_000732ac(int param_1, undefined4 param_2)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if (param_1 == cache_keyid) {
        if ((cache_flags & 1) != 0) {
            iVar2 = FUN_0007299c(cache_keyacclist, param_2, 1);
            if (iVar2 != 0) {
                iVar2 = 1;
            }
            goto LAB_00073314;
        }
    } else {
        iVar2 = FUN_00072e48();
        if (iVar2 == 0) {
            authkeynotfound = authkeynotfound + 1;
            iVar2 = 0;
            goto LAB_00073314;
        }
        authkeyuncached = authkeyuncached + 1;
        if ((*(ushort *)(iVar2 + 0x24) & 1) != 0) {
            iVar2 = FUN_0007299c(*(undefined4 *)(iVar2 + 0x10), param_2, 1);
            if (iVar2 != 0) {
                iVar2 = 1;
            }
            goto LAB_00073314;
        }
    }
    iVar2 = 0;
LAB_00073314:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar2);
    }
    return;
}

void FUN_000733b4(int param_1, undefined2 param_2, void *param_3,
                  size_t param_4, int param_5)

{
    int iVar1;
    int iVar2;
    void *pvVar3;
    int iVar4;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00072e48();
    if ((iVar2 == 0) || (iVar4 = *(int *)(iVar2 + 0x18), iVar4 != param_1)) {
        pvVar3 = (void *)FUN_00074b04(0, param_4 + 1, 0);
        memcpy(pvVar3, param_3, param_4);
        FUN_00072b84(param_1, 0, param_2, 0, param_4, pvVar3, param_5);
    } else {
        if (*(void **)(iVar2 + 0xc) != (void *)0x0) {
            memset(*(void **)(iVar2 + 0xc), 0, *(size_t *)(iVar2 + 0x20));
            free(*(void **)(iVar2 + 0xc));
        }
        pvVar3 = (void *)FUN_00074b04(0, param_4 + 1, 0);
        *(undefined2 *)(iVar2 + 0x1c) = param_2;
        *(size_t *)(iVar2 + 0x20) = param_4;
        *(void **)(iVar2 + 0xc) = pvVar3;
        if (*(int *)(iVar2 + 0x10) != param_5) {
            FUN_00072688(*(int *)(iVar2 + 0x10));
            pvVar3 = *(void **)(iVar2 + 0xc);
            *(int *)(iVar2 + 0x10) = param_5;
        }
        memcpy(pvVar3, param_3, param_4);
        if (iVar4 == cache_keyid) {
            if (iVar1 == __stack_chk_guard) {
                FUN_000724e4();
                return;
            }
            goto LAB_00073500;
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_00073500:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00073510(void)

{
    int iVar1;
    undefined4 uVar2;
    undefined1 *puVar3;
    undefined1 *puVar4;

    iVar1 = __stack_chk_guard;
    puVar3 = (undefined1 *)key_listhead._8_4_;
    if ((undefined1 *)key_listhead._8_4_ != key_listhead) {
    LAB_00073590:
        do {
            puVar4 = *(undefined1 **)(puVar3 + 8);
            if (*(uint *)(puVar3 + 0x18) < 0x10000) {
                if ((*(ushort *)(puVar3 + 0x24) & 1) == 0) {
                    FUN_000726e4(puVar3);
                    puVar3 = puVar4;
                    if (puVar4 == key_listhead)
                        break;
                    goto LAB_00073590;
                }
                if (*(void **)(puVar3 + 0xc) != (void *)0x0) {
                    memset(*(void **)(puVar3 + 0xc), 0,
                           *(size_t *)(puVar3 + 0x20));
                    free(*(void **)(puVar3 + 0xc));
                    *(undefined4 *)(puVar3 + 0xc) = 0;
                }
                uVar2 = FUN_00072688(*(undefined4 *)(puVar3 + 0x10));
                *(undefined4 *)(puVar3 + 0x20) = 0;
                *(undefined4 *)(puVar3 + 0x14) = 0;
                *(undefined4 *)(puVar3 + 0x10) = uVar2;
            }
            puVar3 = puVar4;
        } while (puVar4 != key_listhead);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000735e8(void)

{
    uint *puVar1;
    int iVar2;
    undefined1 *puVar3;

    iVar2 = __stack_chk_guard;
    puVar3 = (undefined1 *)key_listhead._8_4_;
    if ((undefined1 *)key_listhead._8_4_ != key_listhead) {
        do {
            while (true) {
                puVar1 = (uint *)(puVar3 + 0x14);
                puVar3 = *(undefined1 **)(puVar3 + 8);
                if ((*puVar1 == 0) || (current_time <= *puVar1))
                    break;
                FUN_000726e4();
                authkeyexpired = authkeyexpired + 1;
                if (puVar3 == key_listhead)
                    goto LAB_00073674;
            }
        } while (puVar3 != key_listhead);
    }
LAB_00073674:
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_000736a4(uint param_1, int param_2, uint param_3)

{
    uint uVar1;
    uint uVar2;
    uint uVar3;
    uint uVar4;
    int iVar5;
    int iVar6;
    bool bVar7;

    iVar5 = __stack_chk_guard;
    bVar7 = param_1 != 0;
    uVar1 = param_1 >> 8;
    uVar2 = param_1 >> 0x10;
    uVar3 = param_1 >> 0x18;
    uVar4 = param_1 << 0x18;
    if (!bVar7) {
        param_1 = 4;
    }
    authencryptions = authencryptions + 1;
    *(uint *)(param_2 + (param_3 & 0xfffffffc)) =
        uVar4 | (uVar1 & 0xff) << 0x10 | (uVar2 & 0xff) << 8 | uVar3;
    if (bVar7) {
        iVar6 = FUN_00072f54(param_1);
        if (iVar6 != 0) {
            FUN_000715b4(cache_type, cache_secret, cache_secretsize, param_2,
                         param_3);
        }
    }
    if (iVar5 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00073770(int param_1, undefined4 param_2, undefined4 param_3,
                  uint param_4)

{
    int iVar1;
    undefined4 uVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    authdecryptions = authdecryptions + 1;
    if ((param_1 == 0) || (iVar3 = FUN_00072f54(), iVar3 == 0 || param_4 < 4)) {
        uVar2 = 0;
    } else {
        uVar2 = FUN_00071654(cache_type, cache_secret, cache_secretsize,
                             param_2, param_3, param_4);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar2);
}

void FUN_00073838(undefined4 *param_1)

{
    byte bVar1;
    int iVar2;
    byte *pbVar3;
    byte *pbVar4;
    uint uVar5;
    byte *pbVar6;
    byte *pbVar7;

    iVar2 = __stack_chk_guard;
    pbVar3 = (byte *)*param_1;
    uVar5 = (uint)*pbVar3;
    if (uVar5 == 0x20 || uVar5 == 9) {
        do {
            pbVar3 = pbVar3 + 1;
            uVar5 = (uint)*pbVar3;
        } while (uVar5 == 0x20 || uVar5 == 9);
    }
    pbVar7 = (byte *)(uVar5 & 0xdf);
    if (pbVar7 != (byte *)0x0) {
        if ((1 < uVar5 - 9) && (pbVar6 = pbVar3, uVar5 != 0x23)) {
            do {
                pbVar4 = pbVar6 + 1;
                bVar1 = *pbVar4;
                if (bVar1 == 10 || bVar1 == 0) {
                    pbVar7 = (byte *)0x0;
                    if (pbVar3 == pbVar4)
                        goto LAB_000738fc;
                    if (bVar1 != 0x20 && bVar1 != 9)
                        goto LAB_000738e8;
                LAB_0007391c:
                    pbVar6 = pbVar6 + 2;
                    *pbVar4 = 0;
                    goto LAB_000738f4;
                }
                if (bVar1 == 0x20 || bVar1 == 9) {
                    pbVar7 = (byte *)0x0;
                    if (pbVar3 != pbVar4)
                        goto LAB_0007391c;
                    goto LAB_000738fc;
                }
                pbVar6 = pbVar4;
            } while (bVar1 != 0x23);
            if (pbVar3 != pbVar4) {
            LAB_000738e8:
                *pbVar4 = 0;
                pbVar6 = pbVar4;
            LAB_000738f4:
                *param_1 = pbVar6;
                pbVar7 = pbVar3;
                goto LAB_000738fc;
            }
        }
        pbVar7 = (byte *)0x0;
    }
LAB_000738fc:
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(pbVar7);
    }
    return;
}

void FUN_00073950(uint *param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    uint uVar1;
    uint uVar2;
    undefined4 uStack_8;
    undefined4 uStack_4;

    uVar1 = __stack_chk_guard;
    uVar2 = __stack_chk_guard;
    uStack_8 = param_3;
    uStack_4 = param_4;
    if (param_1 != (uint *)0x0) {
        uVar2 = *param_1 + 1;
        *param_1 = uVar2;
        if (5 < uVar2)
            goto LAB_000739a4;
    }
    FUN_00075dc8(3, param_2, &uStack_8, uVar2, &uStack_8);
LAB_000739a4:
    if (uVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000739d0(void *param_1)

{
    int iVar1;
    undefined4 *__ptr;

    iVar1 = __stack_chk_guard;
    __ptr = *(undefined4 **)((int)param_1 + 4);
    while (__ptr != (undefined4 *)0x0) {
        *(undefined4 *)((int)param_1 + 4) = *__ptr;
        free(__ptr);
        __ptr = *(undefined4 **)((int)param_1 + 4);
    }
    memset(param_1, 0, *(ushort *)((int)param_1 + 0xe) + 0x14);
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    free(param_1);
    return;
}

void FUN_0007407c(undefined4 param_1, int param_2)

{
    undefined4 local_38;
    undefined4 uStack_34;
    undefined4 local_30;
    undefined4 uStack_2c;
    undefined4 local_28;
    undefined4 uStack_24;
    undefined4 local_1c;
    undefined4 uStack_18;
    int local_14;

    local_14 = __stack_chk_guard;
    if (param_2 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("caljulian.c", 0x1f, 2, "((void *)0) != jt");
    }
    FUN_0007694c(&local_30, param_1, 0);
    local_28 = local_30;
    uStack_24 = uStack_2c;
    FUN_00076a00(&local_38, &local_28);
    local_1c = local_38;
    uStack_18 = uStack_34;
    FUN_00076edc(param_2, &local_1c,
                 "rt_telephone : phone in the ntpd.conf must be specified.");
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00074130(undefined2 *param_1)

{
    int iVar1;
    undefined4 uVar2;
    undefined4 local_20[3];
    int local_14;

    local_14 = __stack_chk_guard;
    if (param_1 == (undefined2 *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("caltontp.c", 0x2b, 0, "jt != ((void *)0)");
    }
    if (0xd < *(byte *)(param_1 + 2)) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("caltontp.c", 0x2d, 0, "jt->month <= 13");
    }
    if (0x20 < *(byte *)((int)param_1 + 5)) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("caltontp.c", 0x2e, 0, "jt->monthday <= 32");
    }
    if (0x16e < (ushort)param_1[1]) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("caltontp.c", 0x2f, 0, "jt->yearday <= 366");
    }
    if (0x18 < *(byte *)(param_1 + 3)) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("caltontp.c", 0x30, 0, "jt->hour <= 24");
    }
    if (0x3c < *(byte *)((int)param_1 + 7)) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("caltontp.c", 0x31, 0, "jt->minute <= (60)");
    }
    if (0x3c < *(byte *)(param_1 + 4)) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("caltontp.c", 0x32, 0, "jt->second <= (60)");
    }
    if (param_1[1] == 0) {
        iVar1 = FUN_00077430();
    } else {
        iVar1 = FUN_00077494(*param_1);
        iVar1 = iVar1 + (uint)(ushort)param_1[1] + -1;
    }
    uVar2 = FUN_00077368(*(undefined1 *)(param_1 + 3),
                         *(undefined1 *)((int)param_1 + 7),
                         *(undefined1 *)(param_1 + 4));
    FUN_0007702c(local_20, iVar1 + -0xa955c, uVar2);
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(local_20[0]);
}

void FUN_00074318(int param_1, int param_2, int param_3, int param_4,
                  int param_5, int param_6, int *param_7, int *param_8)

{
    uint uVar1;
    int iVar2;
    int iVar3;
    uint uVar4;
    int iVar5;
    undefined8 local_68;
    undefined8 local_60;
    int local_58[2];
    int local_50[6];
    uint local_38[3];
    int local_2c;

    param_4 =
        ((param_2 + param_5 + (param_1 + -1) * 0x18) * 0x3c + param_3) * 0x3c +
        param_4;
    local_2c = __stack_chk_guard;
    if (*param_7 != 0) {
        local_50[3] = param_4 + *param_7;
        local_38[0] = local_50[3] - param_6;
        if ((int)local_38[0] < 0) {
            local_38[0] = -local_38[0];
        }
        if (local_38[0] < 0xeff100) {
            *param_8 = local_50[3];
            uVar1 = local_38[0];
            goto LAB_000744ac;
        }
    }
    FUN_0007694c(&local_68, param_6 - param_4, 0);
    local_60 = local_68;
    FUN_00076a00(local_58, &local_60);
    FUN_00076aa8(local_58,
                 "refclock_jjy.c : jjy_start_telephone : phone in the "
                 "ntpd.conf must be specified." +
                     local_58[0] + 0x17,
                 0);
    iVar5 = 0;
    do {
        iVar2 = FUN_000770f0(local_58[0] + -1 + iVar5);
        iVar3 = (iVar2 + -0xa955b) * 0x15180;
        iVar2 = iVar3 + param_4;
        local_50[iVar5 + 3] = iVar2;
        iVar2 = iVar2 - param_6;
        if (iVar2 < 0) {
            iVar2 = -iVar2;
        }
        local_50[iVar5] = iVar3;
        local_50[iVar5 + 6] = iVar2;
        iVar5 = iVar5 + 1;
    } while (iVar5 != 3);
    uVar1 = local_38[0];
    if (local_38[1] <= local_38[0]) {
        uVar1 = local_38[1];
    }
    uVar4 = (uint)(local_38[1] <= local_38[0]);
    if (local_38[2] < uVar1) {
        uVar4 = 2;
        uVar1 = local_38[2];
    }
    iVar5 = local_50[uVar4];
    *param_8 = local_50[uVar4 + 3];
    *param_7 = iVar5;
LAB_000744ac:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar1 < 0x3840);
    }
    return;
}

void FUN_000744ec(char *param_1, void *param_2)

{
    addrinfo *__ai;
    char *pcVar1;
    size_t sVar2;
    char *pcVar3;
    int iVar4;
    undefined4 uVar5;
    char *pcVar6;
    char cVar7;
    ushort uVar8;
    char *pcVar9;
    char *pcVar10;
    ushort local_92;
    addrinfo *local_90;
    addrinfo local_8c;
    char acStack_6c[80];
    int local_1c;

    pcVar10 = (char *)0x0;
    local_90 = (addrinfo *)0x0;
    local_1c = __stack_chk_guard;
    if (param_1 == (char *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("decodenetnum.c", 0x26, 0, "num != ((void *)0)");
    }
    sVar2 = strlen(param_1);
    if (sVar2 < 0x50) {
        if (*param_1 == '[') {
            cVar7 = param_1[1];
            pcVar10 = param_1 + 1;
            pcVar9 = acStack_6c;
            pcVar3 = pcVar9;
            if (cVar7 != ']' && cVar7 != '\0') {
                pcVar1 = param_1 + 2;
                pcVar6 = pcVar9;
                do {
                    pcVar10 = pcVar1;
                    *pcVar6 = cVar7;
                    cVar7 = *pcVar10;
                    pcVar1 = pcVar10 + 1;
                    pcVar3 = pcVar6 + 1;
                    pcVar6 = pcVar6 + 1;
                } while (cVar7 != ']' && cVar7 != '\0');
            }
            *pcVar3 = '\0';
            if (((cVar7 == ']') && (pcVar10[1] == ':')) &&
                (pcVar10[2] != '\0')) {
                pcVar10 = pcVar10 + 2;
            } else {
                pcVar10 = (char *)0x0;
            }
        } else {
            pcVar3 = strchr(param_1, 0x3a);
            pcVar9 = param_1;
            if (pcVar3 == (char *)0x0) {
                pcVar10 = (char *)0x0;
            } else {
                pcVar3 = strchr(pcVar3 + 1, 0x3a);
                if (pcVar3 == (char *)0x0) {
                    pcVar9 = acStack_6c;
                    FUN_0007e4b4(pcVar9, param_1, 0x50);
                    pcVar3 = strchr(pcVar9, 0x3a);
                    pcVar10 = pcVar3 + 1;
                    *pcVar3 = '\0';
                }
            }
        }
        local_8c.ai_family = 0;
        local_8c.ai_socktype = 0;
        local_8c.ai_protocol = 0;
        local_8c.ai_addrlen = 0;
        local_8c.ai_addr = (sockaddr *)0x0;
        local_8c.ai_canonname = (char *)0x0;
        local_8c.ai_next = (addrinfo *)0x0;
        local_8c.ai_flags = 4;
        iVar4 = getaddrinfo(pcVar9, "ntp", &local_8c, &local_90);
        __ai = local_90;
        if (iVar4 == 0) {
            if (0x1c < local_90->ai_addrlen) {
                /* WARNING: Subroutine does not return */
                FUN_0007fc54("decodenetnum.c", 0x4e, 2,
                             "ai->ai_addrlen <= sizeof(*netnum)");
            }
            memset(param_2, 0, 0x1c);
            memcpy(param_2, __ai->ai_addr, __ai->ai_addrlen);
            freeaddrinfo(__ai);
            if ((pcVar10 == (char *)0x0) ||
                (iVar4 = sscanf(pcVar10, "%hu", &local_92), iVar4 != 1)) {
                uVar8 = 0x7b00;
            } else {
                uVar8 = local_92 >> 8 | local_92 << 8;
            }
            uVar5 = 1;
            *(ushort *)((int)param_2 + 2) = uVar8;
            goto LAB_00074618;
        }
    }
    uVar5 = 0;
LAB_00074618:
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar5);
    }
    return;
}

void FUN_0007474c(uint param_1, uint param_2, int param_3, uint param_4,
                  int param_5)

{
    int iVar1;
    uint uVar2;
    uint uVar3;
    char cVar4;
    int iVar5;
    uint uVar6;
    int iVar7;
    int iVar8;
    char *pcVar9;
    int *piVar10;
    char *__s;
    int *piVar11;
    int iVar12;
    char *pcVar13;
    int *piVar14;
    int *piVar15;
    bool bVar16;
    undefined4 local_44;
    undefined4 local_40;
    undefined1 local_3c[4];
    undefined1 local_38[4];
    undefined4 local_34;
    undefined4 local_30;
    int local_2c[2];

    iVar8 = lib_nextbuf;
    local_2c[0] = __stack_chk_guard;
    iVar1 = lib_nextbuf * 0x80;
    __s = lib_stringbuf + iVar1;
    memset(__s, 0, 0x80);
    lib_nextbuf = iVar8 + 1U & 0xf;
    local_44 = 0;
    local_40 = 0;
    local_3c = (undefined1[4])0x0;
    local_38 = (undefined1[4])0x0;
    local_34 = 0;
    local_30 = 0;
    piVar10 = (int *)(local_3c + 2);
    piVar14 = piVar10;
    if (param_1 != 0) {
        iVar12 = 10;
        do {
            iVar12 = iVar12 + -1;
            uVar3 = param_1 / 10;
            piVar14 = (int *)((int)piVar14 + -1);
            *(char *)piVar14 = (char)(param_1 % 10);
            param_1 = uVar3;
        } while ((uVar3 != 0 && iVar12 != 0) && (uVar3 == 0 || -1 < iVar12));
    }
    piVar11 = piVar10;
    if ((int)param_4 < 0) {
        if (param_5 != 0) {
            param_4 = 3;
            goto LAB_0007497c;
        }
    } else {
        piVar15 = piVar10;
        if (param_5 != 0) {
            param_4 = param_4 + 3;
        LAB_0007497c:
            piVar15 = (int *)(local_38 + 1);
        }
        if ((int)param_4 < 0xf) {
            bVar16 = (int)param_2 < 0;
            if (param_2 != 0) {
                bVar16 = (int)param_4 < 0;
            }
            if ((param_2 != 0 && param_4 != 0) && !bVar16)
                goto LAB_00074858;
        } else {
            if (param_2 == 0) {
                piVar11 = local_2c;
                piVar10 = piVar15;
                goto LAB_000748a0;
            }
            param_4 = 0xe;
        LAB_00074858:
            do {
                iVar5 = (int)param_2 >> 0x1f;
                iVar7 = (int)param_2 >> 0x1f;
                uVar3 = param_2 * 2;
                iVar12 = param_2 << 2;
                uVar2 = param_2 * 8;
                param_2 = param_2 * 10;
                param_4 = param_4 - 1;
                uVar6 = param_2;
                if (param_2 != 0) {
                    uVar6 = param_4;
                }
                *(byte *)piVar10 =
                    (((byte)((uint)iVar12 >> 0x1f) |
                      (byte)((iVar5 * -2 | uVar3 >> 0x1f) << 1)) -
                     (char)iVar7) +
                    CARRY4(uVar2, uVar3);
                piVar11 = (int *)((int)piVar10 + 1);
                piVar10 = (int *)((int)piVar10 + 1);
            } while ((param_2 != 0 && param_4 != 0) && -1 < (int)uVar6);
        }
        piVar10 = piVar15;
        if (param_4 != 0) {
            piVar11 = (int *)((int)piVar11 + param_4);
            goto LAB_000748a0;
        }
    }
    param_2 = param_2 >> 0x1f;
    if ((int)piVar11 - (int)&local_44 < 1) {
        param_2 = 0;
    }
    piVar15 = piVar11;
    if (param_2 != 0) {
        do {
            piVar15 = (int *)((int)piVar15 + -1);
            if ((char)(*(char *)piVar15 + '\x01') != '\n') {
                *(char *)piVar15 = *(char *)piVar15 + '\x01';
                break;
            }
            *(char *)piVar15 = '\0';
        } while (0 < (int)((int)piVar15 +
                           (((int)piVar11 - (int)&local_44) - (int)piVar11)));
    }
    if (piVar15 <= piVar14) {
        piVar14 = piVar15;
    }
LAB_000748a0:
    if (piVar14 < piVar10) {
        cVar4 = (char)*piVar14;
        while (cVar4 == '\0') {
            piVar14 = (int *)((int)piVar14 + 1);
            if (piVar14 == piVar10)
                goto LAB_000748d8;
            cVar4 = *(char *)piVar14;
        }
    } else {
    LAB_000748d8:
        piVar14 = (int *)((int)piVar10 + -1);
    }
    pcVar13 = __s;
    if (param_3 != 0) {
        lib_stringbuf[iVar8 * 0x80] = 0x2d;
        pcVar13 = lib_stringbuf + iVar1 + 1;
    }
    if (piVar14 < piVar11) {
        do {
            piVar15 = (int *)((int)piVar14 + 1);
            iVar1 = *piVar14;
            pcVar9 = pcVar13;
            if (piVar14 == piVar10) {
                *pcVar13 = '.';
                pcVar9 = pcVar13 + 1;
            }
            pcVar13 = pcVar9 + 1;
            *pcVar9 = (char)iVar1 + '0';
            piVar14 = piVar15;
        } while (piVar15 != piVar11);
    }
    *pcVar13 = '\0';
    if (local_2c[0] != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__s);
    }
    return;
}

void FUN_00074b04(void *param_1, size_t param_2, uint param_3, int param_4)

{
    int iVar1;
    void *pvVar2;

    iVar1 = __stack_chk_guard;
    if (param_2 == 0) {
        pvVar2 = realloc(param_1, 1);
        if (pvVar2 == (void *)0x0) {
        LAB_00074b8c:
            msyslog_term = 1;
            FUN_00075d40(3, "fatal out of memory (%lu bytes)", param_2);
            /* WARNING: Subroutine does not return */
            exit(1);
        }
    } else {
        pvVar2 = realloc(param_1, param_2);
        if (pvVar2 == (void *)0x0)
            goto LAB_00074b8c;
        if (param_4 != 0 && param_3 < param_2) {
            memset((void *)((int)pvVar2 + param_3), 0, param_2 - param_3);
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(pvVar2);
}

void FUN_00074bcc(undefined4 param_1, uint param_2, undefined **param_3,
                  int param_4)

{
    int iVar1;
    undefined **ppuVar2;
    bool bVar3;
    bool bVar4;

    iVar1 = __stack_chk_guard;
    bVar4 = (undefined **)0xfffe < param_3;
    bVar3 = param_3 == (undefined **)0xffff;
    if (param_3 < (undefined **)0x10000) {
        bVar4 = 0xfffe < param_2;
        bVar3 = param_2 == 0xffff;
    }
    ppuVar2 = &__DT_PLTGOT;
    if ((param_2 != 0 && (bVar4 && !bVar3)) &&
        (ppuVar2 = (undefined **)FUN_0009cbe0(0xffffffff), ppuVar2 < param_3)) {
        FUN_00075d40(3, "fatal allocation size overflow");
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(ppuVar2);
    }
    FUN_00074b04(param_1, (int)param_3 * param_2 + param_4, 0, 1);
    return;
}

void FUN_00074c8c(char *param_1)

{
    int iVar1;
    size_t sVar2;
    void *__dest;

    iVar1 = __stack_chk_guard;
    sVar2 = strlen(param_1);
    __dest = (void *)FUN_00074b04(0, sVar2 + 1, 0);
    memcpy(__dest, param_1, sVar2 + 1);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00074d34) */

void FUN_00074cfc(void)

{
    return;
}

void FUN_00074d40(int param_1, int param_2)

{
    byte bVar1;
    undefined1 *puVar2;
    size_t sVar3;
    undefined4 uVar4;
    byte bVar5;
    int iVar6;
    int iVar7;
    int iVar8;
    size_t __n;
    byte *pbVar9;
    double in_d0;
    undefined3 local_40;
    undefined1 uStack_3d;
    undefined4 uStack_3c;
    undefined4 uStack_38;
    undefined1 auStack_34[8];
    byte local_2c[8];
    int local_24;

    uStack_3c = 0x5e0;
    local_24 = __stack_chk_guard;
    uStack_38 = 0xfdfd0000;
    _local_40 = CONCAT13((char)param_2, 0xfefeff);
    if (param_2 == 4) {
        __n = 0xb;
        iVar8 = 4;
    } else {
        iVar8 = 5;
        __n = 0xc;
    }
    FUN_0007d00c(auStack_34, 0x10, " %10.0f", auStack_34, in_d0 * 1000000.0);
    if (local_2c[2] == 0x20) {
        iVar7 = 0;
    } else {
        pbVar9 = (byte *)((int)&uStack_3c + 1);
        iVar6 = 0;
        puVar2 = auStack_34;
        bVar5 = local_2c[2];
        do {
            bVar1 = bVar5 & 0xf;
            iVar6 = iVar6 + 1;
            bVar5 = puVar2[8];
            pbVar9 = pbVar9 + 1;
            *pbVar9 = bVar1 | puVar2[9] << 4;
            puVar2 = puVar2 + -2;
        } while (bVar5 != 0x20);
        iVar7 = iVar6;
        if (iVar8 <= iVar6)
            goto LAB_00074e28;
    }
    do {
        iVar6 = iVar7 + 1;
        *(undefined1 *)((int)&uStack_3c + iVar7 + 2) = 0;
        iVar7 = iVar6;
    } while (iVar6 < iVar8);
LAB_00074e28:
    *(undefined1 *)((int)&uStack_3c + iVar6 + 2) = 0xfd;
    sVar3 = write(param_1, &local_40, __n);
    if (sVar3 == 0xffffffff) {
        FUN_00075d40(3, "icom_freq: write() failed: %m", 0xffffffff);
        uVar4 = 0xffffffff;
    } else if (sVar3 == __n) {
        uVar4 = 0;
    } else {
        FUN_00075d40(3, "icom_freq: only wrote %d of %d bytes.", sVar3, __n);
        uVar4 = 1;
    }
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar4);
}

void FUN_00074ee8(char *param_1, speed_t param_2)

{
    int __fd;
    int iVar1;
    int iVar2;
    int *piVar3;
    termios local_58;
    int local_1c;

    local_1c = __stack_chk_guard;
    __fd = open64(param_1, 2, 0x1ff);
    if (__fd < 0) {
        iVar1 = -1;
    } else {
        iVar1 = tcgetattr(__fd, &local_58);
        if (-1 < iVar1) {
            local_58.c_iflag = 0;
            local_58.c_cflag = 0x839;
            local_58.c_oflag = 0;
            local_58.c_cc[5] = '\x05';
            local_58.c_lflag = 0;
            local_58.c_cc[6] = '\0';
            cfsetispeed(&local_58, param_2);
            cfsetospeed(&local_58, param_2);
            iVar2 = tcsetattr(__fd, 0, &local_58);
            iVar1 = __fd;
            if (-1 < iVar2)
                goto LAB_00074f84;
        }
        piVar3 = __errno_location();
        iVar2 = *piVar3;
        iVar1 = -1;
        close(__fd);
        *piVar3 = iVar2;
    }
LAB_00074f84:
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar1);
}

void FUN_00074fd8(char *param_1, uint param_2, undefined2 *param_3)

{
    size_t sVar1;
    int iVar2;
    undefined4 uVar3;
    char *pcVar4;
    sockaddr *psVar5;
    undefined4 uVar6;
    undefined4 uVar7;
    undefined4 uVar8;
    undefined4 local_c4;
    addrinfo *local_c0;
    addrinfo local_bc;
    char acStack_9c[128];
    int local_1c;

    local_1c = __stack_chk_guard;
    if (param_1 == (char *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("is_ip_address.c", 0x28, 0, "host != ((void *)0)");
    }
    if (param_3 == (undefined2 *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("is_ip_address.c", 0x29, 0, "addr != ((void *)0)");
    }
    memset(param_3, 0, 0x1c);
    if (((param_2 & 0xfffffffd) == 0) &&
        (iVar2 = inet_pton(2, param_1, &local_c4), iVar2 == 1)) {
        *param_3 = 2;
        *(undefined4 *)(param_3 + 2) = local_c4;
        uVar3 = 1;
    } else {
        if ((param_2 == 10 || param_2 == 0) &&
            (sVar1 = strlen(param_1), sVar1 < 0x80)) {
            if (*param_1 == '[') {
                FUN_0007e4b4(acStack_9c, param_1 + 1, 0x80);
                pcVar4 = strchr(acStack_9c, 0x5d);
                if (pcVar4 != (char *)0x0) {
                    *pcVar4 = '\0';
                }
            } else {
                FUN_0007e4b4(acStack_9c, param_1, 0x80);
            }
            local_bc.ai_socktype = 0;
            local_bc.ai_protocol = 0;
            local_bc.ai_addrlen = 0;
            local_bc.ai_addr = (sockaddr *)0x0;
            local_bc.ai_canonname = (char *)0x0;
            local_bc.ai_next = (addrinfo *)0x0;
            local_bc.ai_family = 10;
            local_bc.ai_flags = 4;
            iVar2 = getaddrinfo(acStack_9c, (char *)0x0, &local_bc, &local_c0);
            if (iVar2 == 0) {
                *param_3 = 10;
                psVar5 = local_c0->ai_addr;
                uVar8 = *(undefined4 *)(psVar5[1].sa_data + 6);
                uVar3 = *(undefined4 *)(psVar5->sa_data + 10);
                uVar6 = *(undefined4 *)(psVar5 + 1);
                uVar7 = *(undefined4 *)(psVar5[1].sa_data + 2);
                *(undefined4 *)(param_3 + 4) =
                    *(undefined4 *)(psVar5->sa_data + 6);
                *(undefined4 *)(param_3 + 6) = uVar3;
                *(undefined4 *)(param_3 + 8) = uVar6;
                *(undefined4 *)(param_3 + 10) = uVar7;
                *(undefined4 *)(param_3 + 0xc) = uVar8;
                freeaddrinfo(local_c0);
                uVar3 = 1;
                goto LAB_000750c0;
            }
        }
        uVar3 = 0;
    }
LAB_000750c0:
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar3);
    }
    return;
}

void FUN_000751b4(void)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if (lib_inited == 0) {
        iVar2 = FUN_00084c88();
        ipv4_works = (uint)(iVar2 == 0);
        iVar2 = FUN_00084ce0();
        ipv6_works = (uint)(iVar2 == 0);
        FUN_00070518();
        lib_inited = 1;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00075254(timeval *param_1, timezone *param_2)

{
    int *piVar1;
    uint uVar2;
    uint uVar3;
    int iVar4;
    int iVar5;
    timespec local_34;
    int local_2c;

    local_2c = __stack_chk_guard;
    if (0 < debug) {
        FUN_00075c68("In ntp_set_tod\n");
    }
    uVar3 = DAT_00118124;
    if (DAT_00118124 < 2) {
        local_34.tv_sec = param_1->tv_sec;
        local_34.tv_nsec = param_1->tv_usec * 1000;
        piVar1 = __errno_location();
        *piVar1 = 0;
        iVar4 = clock_settime(0, &local_34);
        iVar5 = *piVar1;
        if (0 < debug) {
            FUN_00075c68("ntp_set_tod: clock_settime: %d %m\n", iVar4);
            uVar3 = DAT_00118124;
        }
        if (uVar3 == 0 && iVar4 == 0) {
            DAT_00118124 = 1;
        } else if (iVar4 != 0)
            goto LAB_000752bc;
    LAB_000753e8:
        *piVar1 = iVar5;
        if (0 < debug) {
            iVar4 = 0;
            uVar3 = DAT_00118124;
        LAB_000752e8:
            FUN_00075c68("ntp_set_tod: Final result: %s: %d %m\n",
                         *(undefined4 *)(set_tod_used + uVar3 * 4), iVar4);
        LAB_00075304:
            if (iVar4 != 0)
                goto LAB_0007530c;
        }
        if (set_tod_using != (code *)0x0) {
            (*set_tod_using)(*(undefined4 *)(set_tod_used + DAT_00118124 * 4));
            set_tod_using = (code *)0x0;
        }
        iVar4 = 0;
    } else {
        iVar5 = 0;
        iVar4 = -1;
    LAB_000752bc:
        uVar3 = DAT_00118124;
        uVar2 = DAT_00118124 & 0xfffffffd;
        if (uVar2 == 0) {
            local_34.tv_sec = uVar2;
            local_34.tv_nsec = uVar2;
            adjtime((timeval *)&local_34, (timeval *)0x0);
            piVar1 = __errno_location();
            *piVar1 = 0;
            iVar4 = settimeofday(param_1, param_2);
            iVar5 = *piVar1;
            if (0 < debug) {
                FUN_00075c68("ntp_set_tod: settimeofday: %d %m\n", iVar4);
                uVar3 = DAT_00118124;
            }
            if (uVar3 == 0 && iVar4 == 0) {
                DAT_00118124 = 2;
            } else {
                uVar3 = DAT_00118124;
                if (iVar4 != 0)
                    goto LAB_000752cc;
            }
            goto LAB_000753e8;
        }
        piVar1 = __errno_location();
    LAB_000752cc:
        if (uVar3 == 3 || uVar3 == 0) {
            local_34.tv_sec = param_1->tv_sec;
            *piVar1 = 0;
            iVar4 = stime(&local_34.tv_sec);
            iVar5 = *piVar1;
            if (0 < debug) {
                FUN_00075c68("ntp_set_tod: stime: %d %m\n", iVar4);
                uVar3 = DAT_00118124;
            }
            if (uVar3 == 0 && iVar4 == 0) {
                DAT_00118124 = 3;
            }
            *piVar1 = iVar5;
            uVar3 = DAT_00118124;
            if (0 < debug)
                goto LAB_000752e8;
            goto LAB_00075304;
        }
        *piVar1 = iVar5;
        if (0 < debug)
            goto LAB_000752e8;
    LAB_0007530c:
        *piVar1 = iVar5;
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar4);
    }
    return;
}

void FUN_0007557c(uint param_1)

{
    int iVar1;
    undefined *__s;
    uint uVar2;

    iVar1 = __stack_chk_guard;
    if (param_1 < 9) {
        __s = (&PTR_s_unspec_000c5bd8)[param_1];
    } else {
        __s = lib_stringbuf + lib_nextbuf * 0x80;
        uVar2 = lib_nextbuf + 1;
        memset(__s, 0, 0x80);
        lib_nextbuf = uVar2 & 0xf;
        FUN_0007d00c(__s, 0x80, "mode#%zu", param_1);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

void FUN_0007563c(int param_1, char *param_2, char *param_3)

{
    int iVar1;
    char *pcVar2;
    int *piVar3;
    bool bVar4;

    iVar1 = __stack_chk_guard;
    *param_2 = '\0';
    pcVar2 = strerror_r(param_1, param_2, (size_t)param_3);
    if (pcVar2 == (char *)0x0) {
        if (*param_2 == '\0') {
            piVar3 = __errno_location();
            FUN_0007d00c(param_2, param_3, "%s(%d): errno %d", "strerror_r",
                         param_1, *piVar3);
        }
    } else {
        bVar4 = param_2 <= pcVar2;
        if (pcVar2 != param_2) {
            bVar4 = param_3 <= pcVar2;
        }
        if (bVar4 && (pcVar2 != param_2 && pcVar2 != param_3)) {
            if (iVar1 == __stack_chk_guard) {
                FUN_0007e4b4(param_2, pcVar2, param_3);
                return;
            }
            goto LAB_000756fc;
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_000756fc:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00075710(char *param_1, int param_2, char *param_3, undefined4 param_4)

{
    char cVar1;
    size_t __n;
    char *__dest;
    char acStack_124[256];
    int local_24;

    local_24 = __stack_chk_guard;
    __dest = param_1;
    while (true) {
        while (true) {
            cVar1 = *param_3;
            while (true) {
                if ((cVar1 == '\0') || (param_1 + param_2 + -1 <= __dest))
                    goto LAB_0007577c;
                if (cVar1 == '%')
                    break;
                param_3 = param_3 + 1;
                *__dest = cVar1;
                __dest = __dest + 1;
                cVar1 = *param_3;
            }
            cVar1 = param_3[1];
            param_3 = param_3 + 2;
            if (cVar1 != 'm')
                break;
            FUN_0007563c(param_4, acStack_124, 0x100);
            __n = strlen(acStack_124);
            if (__dest + __n < param_1 + param_2 + -1) {
                memcpy(__dest, acStack_124, __n);
                __dest = __dest + __n;
            }
        }
        *__dest = '%';
        if (cVar1 == '\0')
            break;
        __dest[1] = cVar1;
        __dest = __dest + 2;
    }
    __dest = __dest + 1;
LAB_0007577c:
    *__dest = '\0';
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0007581c(int param_1, char *param_2)

{
    bool bVar1;
    char *pcVar2;
    size_t sVar3;
    char *pcVar4;
    int iVar5;
    FILE *__stream;
    __pid_t _Var6;
    undefined2 *puVar7;
    undefined4 local_3c;
    undefined1 local_34[4];
    undefined2 local_30[2];
    int local_2c;

    local_30[0] = 10;
    local_34[0] = 0;
    local_2c = __stack_chk_guard;
    pcVar4 = progname;
    if ((progname != DAT_0011812c) &&
        (DAT_0011812c = pcVar4, pcVar2 = strrchr(progname, 0x2f),
         DAT_00118130 = pcVar4, pcVar2 != (char *)0x0)) {
        DAT_00118130 = pcVar2 + 1;
    }
    iVar5 = msyslog_term;
    if (syslogit == 0) {
        if (syslog_file != (FILE *)0x0) {
            bVar1 = true;
            goto LAB_000758cc;
        }
        iVar5 = 1;
        bVar1 = false;
    } else {
        bVar1 = false;
        __syslog_chk(param_1, 1, "%s", param_2);
    LAB_000758cc:
        if (!bVar1 && iVar5 == 0)
            goto LAB_000758d4;
    }
    if (msyslog_include_timestamp == 0) {
        local_3c = 0;
    } else {
        local_3c = FUN_00089a0c();
    }
    if (bVar1 || msyslog_term_pid != 0) {
        _Var6 = getpid();
    } else {
        _Var6 = -1;
    }
    sVar3 = strlen(param_2);
    if (param_2[sVar3 - 1] == '\n') {
        puVar7 = (undefined2 *)local_34;
    } else {
        puVar7 = local_30;
    }
    if (iVar5 != 0) {
        __stream = stderr;
        if (3 < param_1) {
            __stream = stdout;
        }
        if (msyslog_include_timestamp != 0) {
            __fprintf_chk(__stream, 1, &DAT_000a14fc, local_3c);
        }
        if (msyslog_term_pid != 0) {
            __fprintf_chk(__stream, 1, "%s[%d]: ", DAT_00118130, _Var6);
        }
        __fprintf_chk(__stream, 1, "%s%s", param_2, puVar7);
        fflush(__stream);
    }
    if (bVar1) {
        if (msyslog_include_timestamp != 0) {
            __fprintf_chk(syslog_file, 1, &DAT_000a14fc, local_3c);
        }
        __fprintf_chk(syslog_file, 1, "%s[%d]: %s%s", DAT_00118130, _Var6,
                      param_2, puVar7);
        fflush(syslog_file);
    }
LAB_000758d4:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00075afc(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int *piVar1;
    undefined1 auStack_11c[256];
    int local_1c;

    local_1c = __stack_chk_guard;
    piVar1 = __errno_location();
    FUN_00075710(auStack_11c, 0x100, param_3, *piVar1);
    FUN_0007c654(param_1, param_2, auStack_11c, param_4);
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00075b84(undefined4 param_1, undefined4 param_2, undefined4 param_3)

{
    int *piVar1;
    undefined1 auStack_11c[256];
    int local_1c;

    local_1c = __stack_chk_guard;
    piVar1 = __errno_location();
    FUN_00075710(auStack_11c, 0x100, param_2, *piVar1);
    __vfprintf_chk(param_1, 1, auStack_11c, param_3);
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00075c04(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    undefined4 uStack_8;
    undefined4 uStack_4;

    iVar1 = __stack_chk_guard;
    uStack_8 = param_3;
    uStack_4 = param_4;
    FUN_00075b84(param_1, param_2, &uStack_8, __stack_chk_guard, &uStack_8);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00075c68(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    undefined4 uStack_c;
    undefined4 uStack_8;
    undefined4 uStack_4;

    iVar1 = __stack_chk_guard;
    uStack_c = param_2;
    uStack_8 = param_3;
    uStack_4 = param_4;
    FUN_00075b84(stdout, param_1, &uStack_c, &stdout, &uStack_c);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00075d40(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    undefined1 auStack_424[1024];
    int local_24;
    undefined4 uStack_8;
    undefined4 uStack_4;

    local_24 = __stack_chk_guard;
    uStack_8 = param_3;
    uStack_4 = param_4;
    FUN_00075afc(auStack_424, 0x400, param_2, &uStack_8, &uStack_8);
    FUN_0007581c(param_1, auStack_424);
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00075dc8(undefined4 param_1, undefined4 param_2, undefined4 param_3)

{
    undefined1 auStack_414[1024];
    int local_14;

    local_14 = __stack_chk_guard;
    FUN_00075afc(auStack_414, 0x400, param_2, param_3);
    FUN_0007581c(param_1, auStack_414);
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00075e3c(char *param_1, int param_2, int param_3)

{
    int iVar1;
    char *pcVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = param_2;
    if (param_2 != 0) {
        iVar3 = 1;
    }
    if (ntp_syslogmask != -1) {
        iVar3 = 0;
    }
    if (iVar3 != 0) {
        ntp_syslogmask = param_2;
    }
    pcVar2 = strrchr(param_1, 0x2f);
    if (pcVar2 != (char *)0x0) {
        param_1 = pcVar2 + 1;
    }
    progname = (char *)FUN_00074c8c(param_1);
    if (param_3 == 0) {
        iVar3 = DAT_00118134;
        if (DAT_00118134 != 0) {
            iVar3 = 0x18;
        }
    } else {
        DAT_00118134 = 1;
        iVar3 = 0x18;
    }
    openlog(progname, 9, iVar3);
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    setlogmask(0xff);
    return;
}

void FUN_00075f28(char *param_1, int param_2)

{
    int iVar1;
    char *pcVar2;
    size_t sVar3;
    size_t sVar4;
    FILE *__stream;
    int iVar5;
    char *__buf;
    char *pcVar6;
    char acStack_22d[513];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (param_1 == (char *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("msyslog.c", 0x1d5, 0, "fname != ((void *)0)");
    }
    if (((syslog_file != (FILE *)0x0) && (syslog_fname != (char *)0x0)) &&
        (iVar1 = strcmp(syslog_fname, param_1), iVar1 == 0))
        goto LAB_000761bc;
    iVar1 = strcmp(param_1, "stderr");
    if (iVar1 == 0) {
        iVar1 = 0x9b8;
    LAB_00076218:
        __stream = (FILE *)**(undefined4 **)((int)&__DT_PLTGOT + iVar1);
        pcVar2 = (char *)FUN_00074c8c(param_1);
    } else {
        iVar1 = strcmp(param_1, "stdout");
        if (iVar1 == 0) {
            iVar1 = 0x968;
            goto LAB_00076218;
        }
        if (((syslog_fname == (char *)0x0) ||
             (iVar1 = strcmp(param_1, syslog_fname), pcVar6 = syslog_abs_fname,
              iVar1 != 0)) &&
            ((pcVar6 = param_1,
              param_1 != syslog_abs_fname && (*param_1 != '/')))) {
            __buf = acStack_22d + 1;
            pcVar2 = getcwd(__buf, 0x200);
            if (pcVar2 == (char *)0x0)
                goto LAB_000760a4;
            sVar3 = strlen(__buf);
            if ((1 < sVar3) && (acStack_22d[sVar3] == '/')) {
                sVar3 = sVar3 - 1;
            }
            sVar4 = strlen(param_1);
            iVar1 = sVar3 + sVar4 + 2;
            pcVar2 = (char *)FUN_00074b04(0, iVar1, 0);
            FUN_0007d00c(pcVar2, iVar1, "%.*s%c%s", sVar3, __buf, 0x2f,
                         param_1);
        } else {
        LAB_000760a4:
            pcVar2 = (char *)FUN_00074c8c(pcVar6);
        }
        if (0 < debug) {
            FUN_00075c68("attempting to open log %s\n", pcVar2);
        }
        __stream = fopen64(pcVar2, "a");
        param_1 = pcVar6;
    }
    if (__stream == (FILE *)0x0) {
        free(pcVar2);
        iVar1 = -1;
        goto LAB_000761bc;
    }
    if ((param_2 != 0) && ((syslogit != 0 || (param_1 != syslog_abs_fname)))) {
        FUN_00075d40(5, "switching logging to file %s", pcVar2);
    }
    if (((syslog_file != (FILE *)0x0) && (syslog_file != stderr)) &&
        (syslog_file != stdout)) {
        iVar1 = fileno(syslog_file);
        iVar5 = fileno(__stream);
        if (iVar1 != iVar5) {
            fclose(syslog_file);
        }
    }
    syslog_file = __stream;
    if (param_1 == syslog_abs_fname) {
        free(pcVar2);
    } else {
        if (syslog_abs_fname == (char *)0x0) {
        LAB_00076198:
            if (syslog_fname != (char *)0x0)
                goto LAB_000761a0;
        } else {
            if (syslog_abs_fname != syslog_fname) {
                free(syslog_abs_fname);
                goto LAB_00076198;
            }
        LAB_000761a0:
            free(syslog_fname);
        }
        syslog_fname = (char *)FUN_00074c8c(param_1);
        syslog_abs_fname = pcVar2;
    }
    iVar1 = 0;
    syslogit = 0;
LAB_000761bc:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar1);
}

void FUN_000762c8(int param_1)

{
    int iVar1;
    int iVar2;
    char *pcVar3;

    iVar1 = __stack_chk_guard;
    if (syslog_fname == 0) {
        if ((param_1 != 0) && (iVar2 = FUN_00075f28(param_1, 1), iVar2 == -1)) {
            if (iVar1 == __stack_chk_guard) {
                pcVar3 = "Cannot open log file %s, %m";
                goto LAB_00076388;
            }
            goto LAB_00076394;
        }
    } else {
        iVar2 = FUN_00075f28(syslog_fname, 0);
        if (iVar2 == -1) {
            if (iVar1 == __stack_chk_guard) {
                pcVar3 = "Cannot reopen log file %s, %m";
                param_1 = syslog_fname;
            LAB_00076388:
                FUN_00075d40(3, pcVar3, param_1);
                return;
            }
            goto LAB_00076394;
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_00076394:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000763ac(undefined4 *param_1)

{
    uint uVar1;
    uint uVar2;
    int iVar3;
    int iVar4;
    int iVar5;
    uint uVar6;
    uint uVar7;
    uint uVar8;
    undefined4 uVar9;
    undefined4 uVar10;
    undefined4 uVar11;
    bool bVar12;

    uVar10 = param_1[1];
    uVar9 = param_1[2];
    uVar11 = param_1[3];
    iVar4 = DAT_0011813c * 0x1c;
    *(undefined4 *)(&DAT_00118140 + iVar4) = *param_1;
    *(undefined4 *)(&DAT_00118144 + iVar4) = uVar10;
    uVar8 = DAT_0011813c + 1 & 7;
    *(undefined4 *)(&DAT_00118148 + iVar4) = uVar9;
    *(undefined4 *)(&DAT_0011814c + iVar4) = uVar11;
    uVar10 = param_1[4];
    uVar9 = param_1[5];
    *(undefined4 *)(&DAT_00118158 + iVar4) = param_1[6];
    *(undefined4 *)(&DAT_00118150 + iVar4) = uVar10;
    *(undefined4 *)(&DAT_00118154 + iVar4) = uVar9;
    iVar5 = __stack_chk_guard;
    if (*(short *)(&DAT_00118140 + iVar4) == 2) {
        uVar6 = *(uint *)(&DAT_00118144 + iVar4);
        uVar7 = uVar6 >> 0x18;
        uVar1 = uVar6 << 0x18;
        uVar2 = uVar1 | (uVar6 >> 8 & 0xff) << 0x10;
        bVar12 = (uVar1 & 0xe0000000) == 0xc0000000;
        if (bVar12) {
            uVar7 = 0;
        }
        uVar7 = uVar2 | (uVar6 >> 0x10 & 0xff) << 8 | uVar7;
        if ((!bVar12) && ((uVar1 & 0xc0000000) == 0x80000000)) {
            uVar7 = uVar2;
        }
        iVar3 = DAT_0011813c * 0x1c;
        DAT_0011813c = uVar8;
        *(uint *)(&DAT_00118144 + iVar3) =
            uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 |
            (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18;
    } else {
        DAT_0011813c = uVar8;
        if (*(short *)(&DAT_00118140 + iVar4) == 10) {
            *(undefined4 *)(&DAT_00118150 + iVar4) = 0;
            *(undefined4 *)(&DAT_00118154 + iVar4) = 0;
        }
    }
    if (iVar5 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(&DAT_00118140 + iVar4);
    }
    return;
}

void FUN_000764d8(int *param_1, uint param_2)

{
    uint uVar1;
    int iVar2;
    uint uVar3;
    uint uVar4;
    uint uVar5;
    bool bVar6;

    iVar2 = __stack_chk_guard;
    uVar5 = (int)param_2 >> 0x1f;
    uVar1 = (uVar5 ^ param_2) / 0x3c;
    uVar3 = uVar1 ^ uVar5;
    param_1[2] = param_2 + uVar3 * -0x3c;
    uVar1 = uVar1 / 0x3c;
    uVar4 = uVar1 ^ uVar5;
    bVar6 = iVar2 == __stack_chk_guard;
    param_1[1] = uVar3 + uVar4 * -0x3c;
    uVar5 = uVar5 ^ uVar1 / 0x18;
    *param_1 = uVar4 + uVar5 * -0x18;
    if (bVar6) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar5);
}

void FUN_000766bc(undefined2 *param_1)

{
    int iVar1;
    char *pcVar2;
    undefined1 local_32[2];
    undefined1 local_30[2];
    undefined1 local_2e[2];
    undefined1 local_2c[2];
    undefined2 local_2a;
    char acStack_28[4];
    int local_24;

    local_24 = __stack_chk_guard;
    *(undefined1 *)(param_1 + 1) = 0;
    *(undefined1 *)((int)param_1 + 3) = 0;
    *(undefined1 *)(param_1 + 2) = 0;
    *(undefined1 *)((int)param_1 + 5) = 0;
    *(undefined1 *)(param_1 + 3) = 0;
    *(undefined1 *)((int)param_1 + 7) = 0;
    *(undefined1 *)(param_1 + 4) = 0;
    *(undefined1 *)((int)param_1 + 9) = 0;
    *param_1 = 0x7b2;
    *(undefined1 *)(param_1 + 2) = 1;
    *(undefined1 *)((int)param_1 + 5) = 1;
    iVar1 = sscanf("14:10:08/Feb 19 2025", "%hu:%hu:%hu/%3s %hu %hu", local_32,
                   local_30, local_2e, acStack_28, local_2c, &local_2a);
    if (iVar1 == 6) {
        pcVar2 = strstr("JanFebMarAprMayJunJulAugSepOctNovDec", acStack_28);
        if (pcVar2 != (char *)0x0) {
            *param_1 = local_2a;
            *(char *)(param_1 + 2) =
                ((char)((ulonglong)((longlong)(int)(pcVar2 + -0xac87c) *
                                    0x55555556) >>
                        0x20) -
                 (char)((int)(pcVar2 + -0xac87c) >> 0x1f)) +
                '\x01';
            *(undefined1 *)((int)param_1 + 5) = local_2c[0];
            *(undefined1 *)(param_1 + 3) = local_32[0];
            *(undefined1 *)((int)param_1 + 7) = local_30[0];
            *(undefined1 *)(param_1 + 4) = local_2e[0];
            pcVar2 = (char *)0x1;
        }
    } else {
        pcVar2 = (char *)0x0;
    }
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(pcVar2);
    }
    return;
}

void FUN_000767f8(int param_1, int param_2, int param_3)

{
    int iVar1;
    uint extraout_r1;
    uint uVar2;
    uint uVar3;
    uint uVar4;
    bool bVar5;

    iVar1 = __stack_chk_guard;
    bVar5 = param_3 < 0;
    if (bVar5) {
        param_3 = -param_3;
    }
    uVar3 = (uint)bVar5;
    if (1 < param_3) {
        if (param_2 < param_1) {
            param_2 = param_1 - param_2;
            uVar4 = uVar3 ^ 1;
        } else {
            param_2 = param_2 - param_1;
            uVar4 = uVar3;
        }
        FUN_0009ce3c(param_2, param_3);
        if (extraout_r1 != 0) {
            uVar2 = extraout_r1;
            if (uVar4 != 0) {
                uVar2 = param_3 - extraout_r1;
            }
            param_1 = param_1 + (uVar2 ^ -uVar3) + uVar3;
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_00076898(int *param_1, int param_2, uint *param_3)

{
    int iVar1;
    uint uVar2;
    uint uVar3;
    uint uVar4;
    bool bVar5;

    iVar1 = __stack_chk_guard;
    if (param_3 == (uint *)0x0) {
        uVar3 = (*DAT_000c8ce8)(0);
    } else {
        uVar3 = *param_3;
    }
    uVar4 = uVar3 + 0x80000000;
    uVar2 = (0x7c558180 - uVar4) + param_2;
    bVar5 = iVar1 == __stack_chk_guard;
    *param_1 = uVar4 + uVar2;
    param_1[1] = (((int)uVar3 >> 0x1f) - (uint)(uVar3 < 0x80000000)) +
                 (uint)CARRY4(uVar4, uVar2);
    if (bVar5) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_0007694c(int *param_1, int param_2, undefined4 *param_3)

{
    int iVar1;
    undefined4 uVar2;
    uint uVar3;
    bool bVar4;
    undefined8 uVar5;

    iVar1 = __stack_chk_guard;
    if (param_3 == (undefined4 *)0x0) {
        uVar2 = (*DAT_000c8ce8)(0);
        uVar5 = VectorShiftRight(CONCAT44(uVar2, uVar2), 0x20);
    } else {
        uVar5 = VectorShiftRight(CONCAT44(*param_3, *param_3), 0x20);
    }
    uVar3 = (uint)uVar5 + 0x3aa7e80;
    bVar4 = iVar1 == __stack_chk_guard;
    *param_1 = uVar3 + (param_2 - uVar3);
    param_1[1] = (int)((ulonglong)uVar5 >> 0x20) +
                 (uint)(0xfc55817f < (uint)uVar5) +
                 (uint)CARRY4(uVar3, param_2 - uVar3);
    if (bVar4) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_00076a00(uint *param_1, uint *param_2)

{
    int iVar1;
    uint uVar2;
    uint uVar3;
    bool bVar4;

    iVar1 = __stack_chk_guard;
    uVar2 = param_2[1];
    if ((int)uVar2 < 0) {
        uVar2 = FUN_0009d518(~*param_2, ~uVar2, "", 0);
        uVar2 = ~uVar2;
    } else {
        uVar2 = FUN_0009d518(*param_2, uVar2, "", 0);
    }
    uVar3 = *param_2;
    bVar4 = iVar1 == __stack_chk_guard;
    *param_1 = uVar2;
    param_1[1] = uVar3 + uVar2 * -0x15180;
    if (bVar4) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_00076aa8(int *param_1, uint param_2, uint *param_3)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    uint uVar4;
    uint uVar5;
    uint uVar6;
    uint uVar7;

    iVar1 = __stack_chk_guard;
    uVar7 = (int)param_2 >> 0x1f;
    if (0x3fffffff < (uVar7 ^ param_2)) {
        piVar3 = __errno_location();
        param_2 = ~uVar7;
        *piVar3 = 0x21;
    }
    uVar4 = param_2 << 2 | 3;
    uVar7 = uVar7 ^ (uVar4 ^ uVar7) / 0x23ab1;
    uVar5 = uVar4 + uVar7 * -0x23ab1 | 3;
    uVar4 = uVar5 / 0x5b5;
    if (param_3 != (uint *)0x0) {
        if ((uVar4 + 1 & 3) == 0) {
            if (uVar4 == 99) {
                uVar6 = (uint)((uVar7 + 1 & 3) == 0);
            } else {
                uVar6 = 1;
            }
        } else {
            uVar6 = 0;
        }
        *param_3 = uVar6;
    }
    iVar2 = __stack_chk_guard;
    *param_1 = uVar7 * 100 + uVar4;
    param_1[1] = uVar5 % 0x5b5 >> 2;
    if (iVar1 != iVar2) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(param_1);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00076c60) */

void FUN_00076bb4(int *param_1, int param_2, int param_3)

{
    int iVar1;
    int iVar2;
    int iVar3;

    if (param_3 == 0) {
        iVar2 = 0;
    } else {
        iVar2 = 0x1a;
    }
    if ((param_2 < 0) ||
        ((int)(uint) * (ushort *)((int)&DAT_000ac8bc + iVar2) <= param_2)) {
        param_2 = -1;
        iVar3 = -1;
    } else {
        iVar3 = (param_2 >> 5) + 1;
        iVar1 = iVar3 * 2;
        if (param_2 < (int)(uint) * (ushort *)(&DAT_000ac8a4 + iVar1 + iVar2)) {
            iVar1 = iVar1 + -2;
            iVar3 = param_2 >> 5;
        }
        param_2 = param_2 - (uint) * (ushort *)(&DAT_000ac8a4 + iVar1 + iVar2);
    }
    *param_1 = iVar3;
    param_1[1] = param_2;
    return;
}

void FUN_00076c70(ushort *param_1, int param_2)

{
    char cVar1;
    int iVar2;
    undefined4 local_20;
    int local_1c;
    undefined4 local_18;
    int local_14;

    local_14 = __stack_chk_guard;
    cVar1 = (char)(param_2 % 7);
    if (6 < (param_2 % 7 & 0xffU)) {
        cVar1 = cVar1 + '\a';
    }
    *(char *)((int)param_1 + 9) = cVar1;
    FUN_00076aa8(&local_1c, param_2 + -1, &local_20);
    param_1[1] = (short)local_18 + 1;
    if (local_1c + 1U >> 0x10 == 0) {
        iVar2 = -1;
    } else {
        iVar2 = 0;
    }
    *param_1 = (ushort)(local_1c + 1U) & (ushort)iVar2;
    FUN_00076bb4(&local_1c, local_18, local_20);
    *(char *)((int)param_1 + 5) = (char)local_18 + '\x01';
    *(char *)(param_1 + 2) = (char)local_1c + '\x01';
    if (iVar2 == 0) {
        local_20 = 0xffffffff;
    }
    if (local_14 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(local_20);
    }
    return;
}

void FUN_00076d54(int param_1, int param_2)

{
    int iVar1;
    bool bVar2;
    undefined4 local_28;
    int local_24;
    int local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    iVar1 = param_2 % 7;
    if (iVar1 < 0) {
        iVar1 = iVar1 + 7;
    }
    *(int *)(param_1 + 0x18) = iVar1;
    FUN_00076aa8(&local_24, param_2 + -1, &local_28);
    *(int *)(param_1 + 0x1c) = local_20;
    *(int *)(param_1 + 0x14) = local_24 + -0x76b;
    FUN_00076bb4(&local_24, local_20, local_28);
    bVar2 = local_1c == __stack_chk_guard;
    *(int *)(param_1 + 0x10) = local_24;
    *(int *)(param_1 + 0xc) = local_20 + 1;
    if (bVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(local_28);
}

void FUN_00076e14(int param_1)

{
    bool bVar1;
    undefined1 local_20[4];
    undefined1 uStack_1c;
    undefined1 local_18;
    int local_14;

    local_14 = __stack_chk_guard;
    FUN_000764d8(local_20);
    bVar1 = local_14 == __stack_chk_guard;
    *(undefined1 *)(param_1 + 6) = local_20[0];
    *(undefined1 *)(param_1 + 7) = uStack_1c;
    *(undefined1 *)(param_1 + 8) = local_18;
    if (bVar1) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00076edc(undefined4 param_1, int *param_2, int param_3)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00076e14(param_1, param_2[1]);
    if (iVar1 == __stack_chk_guard) {
        FUN_00076c70(param_1, iVar2 + param_3 + *param_2);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00076fb4(undefined4 param_1)

{
    int iVar1;
    int local_1c;
    undefined4 local_18;
    int local_14;

    local_14 = __stack_chk_guard;
    FUN_00076a00(&local_1c);
    iVar1 = FUN_00076e14(param_1, local_18);
    if (local_14 == __stack_chk_guard) {
        FUN_00076c70(param_1, "PSTI/Traconex WWV/WWVH Receiver (3)" + iVar1 +
                                  local_1c + 0x1f);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x0007707c) */

void FUN_0007702c(longlong *param_1, int param_2, int param_3)

{
    *param_1 = (longlong)param_2 * 0x15180 + (longlong)param_3;
    return;
}

/* WARNING: Removing unreachable block (ram,0x000770e4) */

void FUN_00077088(void)

{
    return;
}

void FUN_000770f0(int param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00077088();
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1 * 0x16d + iVar2);
}

void FUN_00077144(int *param_1, int param_2)

{
    int iVar1;
    uint uVar2;
    uint uVar3;
    int in_r12;
    bool bVar4;

    iVar1 = __stack_chk_guard;
    uVar3 = param_2 + 10;
    if ((int)uVar3 < 0xc) {
        in_r12 = 0;
    }
    if (uVar3 != 0xb && param_2 + -1 < 0 == SBORROW4(uVar3, 0xb)) {
        in_r12 = 1;
    }
    if (in_r12 != 0) {
        uVar3 = param_2 - 2;
    }
    if (0xb < uVar3) {
        uVar2 = (int)uVar3 >> 0x1f ^ ((int)uVar3 >> 0x1f ^ uVar3) / 0xc;
        in_r12 = in_r12 + uVar2;
        uVar3 = uVar3 + uVar2 * -0xc;
    }
    *param_1 = in_r12;
    bVar4 = iVar1 == __stack_chk_guard;
    param_1[1] = *(ushort *)(&DAT_000ac8d8 + uVar3 * 2) - 0x132;
    if (bVar4) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_000771fc(int param_1, int param_2, int param_3)

{
    int iVar1;
    int local_1c;
    int local_18;
    int local_14;

    local_14 = __stack_chk_guard;
    if (param_2 == 0) {
        iVar1 = FUN_000770f0();
    } else {
        FUN_00077144(&local_1c);
        iVar1 = FUN_000770f0(param_1 + local_1c);
        iVar1 = iVar1 + local_18;
    }
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar1 + param_3);
}

void FUN_00077278(int param_1, uint param_2, int param_3)

{
    uint uVar1;
    int iVar2;
    int iVar3;
    int iStack_24;
    int iStack_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    if (param_2 < 0xc) {
        uVar1 = param_1 + 1;
        if ((uVar1 & 3) == 0) {
            if ((int)uVar1 % 100 == 0) {
                uVar1 = (uint)((int)uVar1 % 400 == 0);
            } else {
                uVar1 = 1;
            }
        } else {
            uVar1 = 0;
        }
        uVar1 =
            (uint) * (ushort *)(&DAT_000ac8a4 + (uVar1 * 0xd + param_2) * 2);
    } else {
        FUN_00077144(&iStack_24);
        iVar2 = FUN_000770f0(param_1 + iStack_24);
        iVar3 = FUN_000770f0(param_1);
        uVar1 = (iStack_20 + iVar2) - iVar3;
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar1 + param_3);
}

/* WARNING: Removing unreachable block (ram,0x000773bc) */

void FUN_00077368(void)

{
    return;
}

void FUN_000773c8(int param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_000771fc(*(int *)(param_1 + 0x14) + 0x76b,
                         *(undefined4 *)(param_1 + 0x10),
                         *(int *)(param_1 + 0xc) + -1);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2 + 1);
}

void FUN_00077430(ushort *param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_000771fc(*param_1 - 1, (byte)param_1[2] - 1,
                         *(byte *)((int)param_1 + 5) - 1);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2 + 1);
}

void FUN_00077494(int param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_000770f0(param_1 + -1);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2 + 1);
}

/* WARNING: Removing unreachable block (ram,0x00077600) */

void FUN_000775b8(int param_1)

{
    FUN_00077368(*(undefined1 *)(param_1 + 6), *(undefined1 *)(param_1 + 7),
                 *(undefined1 *)(param_1 + 8));
    return;
}

/* WARNING: Removing unreachable block (ram,0x00077654) */

void FUN_0007760c(undefined4 *param_1)

{
    FUN_00077368(param_1[2], param_1[1], *param_1);
    return;
}

void FUN_000776e0(undefined4 param_1)

{
    int iVar1;
    int local_1c;
    undefined4 local_18;
    int local_14;

    local_14 = __stack_chk_guard;
    FUN_00076a00(&local_1c);
    iVar1 = FUN_00076e14(param_1, local_18);
    if (local_14 == __stack_chk_guard) {
        FUN_00076c70(param_1, "refclock_jjy.c : jjy_start_telephone : phone in "
                              "the ntpd.conf must be specified." +
                                  iVar1 + local_1c + 0x18);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00077758(undefined4 param_1)

{
    undefined4 local_28;
    undefined4 uStack_24;
    undefined4 local_20;
    undefined4 uStack_1c;
    int local_14;

    local_14 = __stack_chk_guard;
    FUN_0007694c(&local_28);
    local_20 = local_28;
    uStack_1c = uStack_24;
    FUN_000776e0(param_1);
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

undefined4 FUN_000777bc(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00077430(param_2);
    uVar3 = FUN_000775b8(param_2);
    FUN_0007702c(param_1, iVar2 + -0xa955c, uVar3);
    if (iVar1 == __stack_chk_guard) {
        return param_1;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00077838(undefined4 param_1)

{
    undefined4 local_18[3];
    int local_c;

    local_c = __stack_chk_guard;
    FUN_000777bc(local_18, param_1);
    if (local_c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(local_18[0]);
}

/* WARNING: Removing unreachable block (ram,0x0007791c) */

void FUN_000778dc(undefined4 param_1, undefined4 param_2)

{
    FUN_000767f8(param_1, param_2, 7);
    return;
}

/* WARNING: Removing unreachable block (ram,0x00077aa4) */

void FUN_00077a14(void)

{
    return;
}

void FUN_00077ab4(int *param_1, uint param_2)

{
    int iVar1;
    int *piVar2;
    uint uVar3;
    uint uVar4;
    bool bVar5;

    iVar1 = __stack_chk_guard;
    uVar4 = (int)param_2 >> 0x1f;
    if (0x3fffffff < (uVar4 ^ param_2)) {
        piVar2 = __errno_location();
        param_2 = ~uVar4;
        *piVar2 = 0x21;
    }
    uVar3 = param_2 * 4 + 2;
    uVar4 = uVar4 ^ (uVar3 ^ uVar4) / 0x5187;
    bVar5 = iVar1 == __stack_chk_guard;
    uVar3 = (uVar3 + uVar4 * -0x5187 >> 2) * 0x9d +
            (uint) * (ushort *)(&DAT_000ac8fc + (uVar4 & 3) * 2);
    *param_1 = uVar4 * 100 + (uVar3 >> 0xd);
    param_1[1] = (uVar3 & 0x1fff) / 0x9d;
    if (bVar5) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1, uVar3, (uVar3 & 0x1fff) * 0x342da7f3);
}

void FUN_00077b94(short *param_1)

{
    uint uVar1;
    int iVar2;
    char *pcVar3;
    bool bVar4;
    uint local_30;
    undefined4 local_2c;
    undefined1 local_28[4];
    undefined1 local_24;
    undefined1 local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    FUN_00076a00(&local_30);
    uVar1 = local_30;
    iVar2 = FUN_000764d8(local_28, local_2c);
    *(undefined1 *)(param_1 + 3) = local_20;
    *(undefined1 *)((int)param_1 + 5) = local_24;
    *(undefined1 *)(param_1 + 2) = local_28[0];
    pcVar3 = "refclock_jjy.c : jjy_start_telephone : phone in the ntpd.conf "
             "must be specified." +
             iVar2 + uVar1 + 0x17;
    *(byte *)((int)param_1 + 3) =
        (char)pcVar3 +
        ((byte)((int)pcVar3 >> 0x1f) ^
         (byte)(((int)pcVar3 >> 0x1f ^ (uint)pcVar3) / 7)) *
            -7 +
        '\x01';
    FUN_00077ab4(&local_30);
    *(char *)(param_1 + 1) = (char)local_2c + '\x01';
    bVar4 = local_1c != __stack_chk_guard;
    *param_1 = (short)local_30 + 1;
    if (bVar4) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(local_30 < 0xffff);
    }
    return;
}

void FUN_00077c7c(undefined4 param_1)

{
    undefined4 local_28;
    undefined4 uStack_24;
    undefined4 local_20;
    undefined4 uStack_1c;
    int local_14;

    local_14 = __stack_chk_guard;
    FUN_0007694c(&local_28);
    local_20 = local_28;
    uStack_1c = uStack_24;
    FUN_00077b94(param_1);
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

undefined4 FUN_00077ce0(undefined4 param_1, ushort *param_2)

{
    byte bVar1;
    ushort uVar2;
    int iVar3;
    int iVar4;
    undefined4 uVar5;

    iVar3 = __stack_chk_guard;
    iVar4 = FUN_00077a14(*param_2 - 1);
    uVar2 = param_2[1];
    bVar1 = *(byte *)((int)param_2 + 3);
    uVar5 = FUN_00077368((char)param_2[2], *(undefined1 *)((int)param_2 + 5),
                         (char)param_2[3]);
    FUN_0007702c(param_1,
                 (iVar4 + (uint)(byte)uVar2 + -1) * 7 + (uint)bVar1 + -0xa955c,
                 uVar5);
    if (iVar3 == __stack_chk_guard) {
        return param_1;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00077d7c(undefined4 param_1)

{
    undefined4 local_18[3];
    int local_c;

    local_c = __stack_chk_guard;
    FUN_00077ce0(local_18, param_1);
    if (local_c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(local_18[0]);
}

void FUN_00077dd0(void)

{
    int iVar1;
    undefined1 auStack_20[5];
    char local_1b;
    int local_14;

    local_14 = __stack_chk_guard;
    iVar1 = FUN_000766bc(auStack_20);
    if (iVar1 == 0) {
        iVar1 = 0x63df;
    } else {
        local_1b = local_1b + -1;
        iVar1 = FUN_00077430(auStack_20);
        iVar1 = iVar1 + -0xa955c;
        if (iVar1 < 0x63df) {
            iVar1 = 0x63df;
        }
    }
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar1);
}

void FUN_00077e5c(char *param_1)

{
    size_t sVar1;
    int iVar2;
    ushort *puVar3;
    size_t *psVar4;
    ushort local_2a;
    short local_28;
    ushort local_26;
    int local_24;
    size_t local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    sVar1 = strlen(param_1);
    puVar3 = &local_26;
    psVar4 = &local_20;
    iVar2 = sscanf(param_1, "%4hu-%2hu-%2hu%n", &local_2a, &local_28, puVar3,
                   &local_20);
    if ((iVar2 == 3) && (local_20 == sVar1)) {
        if (((ushort)(local_28 - 1U) < 0xc) && (local_26 - 1 < 0x1f)) {
            local_24 = FUN_000771fc(local_2a - 1);
            local_24 = local_24 + -0xa955c;
            goto LAB_00077ef4;
        }
    } else {
        iVar2 = sscanf(param_1, "%lu%n", &local_24, &local_20, puVar3, psVar4);
        if ((iVar2 == 1) && ((local_20 == sVar1 && (-1 < local_24))))
            goto LAB_00077ef4;
    }
    FUN_00075d40(4, "basedate string \"%s\" invalid, build date substituted!",
                 param_1);
    local_24 = FUN_00077dd0();
LAB_00077ef4:
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(local_24);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00077fd4) */

void FUN_00077f90(void)

{
    return;
}

void FUN_00077fe4(int param_1)

{
    undefined4 uVar1;
    char *pcVar2;
    undefined2 local_30[2];
    undefined1 local_2c;
    undefined1 local_2b;
    int local_24;

    local_24 = __stack_chk_guard;
    if (param_1 < 0x63df) {
        pcVar2 = " (3)";
        FUN_00075d40(
            4, "baseday_set_day: invalid day (%lu), UNIX epoch substituted");
        param_1 = 0x63df;
    } else {
        pcVar2 = "refclock_jjy.c : jjy_start_telephone : phone in the "
                 "ntpd.conf must be specified." +
                 param_1 + 0x18;
    }
    uVar1 = DAT_000c8ce4;
    DAT_000c8ce4 = param_1;
    FUN_00076c70(local_30, pcVar2);
    FUN_00075d40(6, "basedate set to %04hu-%02hu-%02hu", local_30[0], local_2c,
                 local_2b);
    pcVar2 = (char *)FUN_000778dc(pcVar2, 0);
    if ((int)(pcVar2 + -0xa955c) < 0x7227) {
        DAT_00118220 = 0;
        pcVar2 = "";
    } else {
        DAT_00118220 = (int)(pcVar2 + -0xb0783) / 7;
    }
    FUN_00076c70(local_30, pcVar2);
    FUN_00075d40(6, "gps base set to %04hu-%02hu-%02hu (week %d)", local_30[0],
                 local_2c, local_2b, DAT_00118220);
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar1);
}

void FUN_000782dc(void)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    uint uVar4;
    undefined4 *puVar5;
    uint uVar6;

    iVar2 = __stack_chk_guard;
    uVar4 = 0;
    while (true) {
        while (dnschild_contexts_alloc <= uVar4) {
            uVar6 = dnschild_contexts_alloc + 0x14;
            iVar1 = uVar6 * 4;
            dnschild_contexts =
                FUN_00074b04(dnschild_contexts, iVar1, iVar1 + -0x50, 1);
            dnschild_contexts_alloc = uVar6;
        }
        puVar5 = (undefined4 *)(dnschild_contexts + uVar4 * 4);
        if (*(int *)(dnschild_contexts + uVar4 * 4) == 0)
            break;
        uVar4 = uVar4 + 1;
    }
    uVar3 = FUN_00074b04(0, 8, 0, 1);
    *puVar5 = uVar3;
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar4);
}

void FUN_000783a4(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if (worker_per_query != 0) {
        FUN_000782dc();
        return;
    }
    if (DAT_000c8cec == -1) {
        DAT_000c8cec = FUN_000782dc();
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00078440(undefined4 param_1, uint param_2)

{
    int iVar1;
    int iVar2;
    undefined4 *puVar3;
    uint uVar4;

    iVar1 = __stack_chk_guard;
    FUN_0007f21c(1);
    if (param_2 < dnsworker_contexts_alloc) {
        puVar3 = *(undefined4 **)(dnsworker_contexts + param_2 * 4);
        if (puVar3 == (undefined4 *)0x0) {
            puVar3 = (undefined4 *)FUN_00074b04(0, 0xc, 0, 1);
            *(undefined4 **)(dnsworker_contexts + param_2 * 4) = puVar3;
        }
    } else {
        uVar4 = param_2 + 5 & 0xfffffffc;
        dnsworker_contexts = FUN_00074b04(dnsworker_contexts, uVar4 << 2,
                                          dnsworker_contexts_alloc << 2, 1);
        dnsworker_contexts_alloc = uVar4;
        puVar3 = (undefined4 *)FUN_00074b04(0, 0xc, 0, 1);
        *(undefined4 **)(dnsworker_contexts + param_2 * 4) = puVar3;
    }
    FUN_0007f21c(0);
    *(undefined1 *)((int)puVar3 + 3) = 0;
    iVar2 = __stack_chk_guard;
    *(undefined1 *)(puVar3 + 1) = 0;
    *(undefined1 *)((int)puVar3 + 5) = 0;
    *(undefined1 *)((int)puVar3 + 6) = 0;
    *(undefined1 *)((int)puVar3 + 7) = 0;
    *(undefined1 *)(puVar3 + 2) = 0;
    *(undefined1 *)((int)puVar3 + 9) = 0;
    *(undefined1 *)((int)puVar3 + 10) = 0;
    *(undefined1 *)((int)puVar3 + 0xb) = 0;
    *puVar3 = param_1;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(puVar3);
}

void FUN_00078578(int param_1)

{
    int iVar1;
    char *pcVar2;
    undefined *puVar3;
    bool bVar4;

    iVar1 = __stack_chk_guard;
    switch (param_1) {
    case -0xb:
        goto LAB_000785e4;
    case -10:
        break;
    case -9:
        break;
    case -8:
        break;
    case -7:
        break;
    case -6:
        break;
    case -5:
        goto LAB_00078608;
    case -4:
        goto LAB_000785e4;
    case -3:
        DAT_00118224 = 1;
    LAB_000785e4:
        if (debug < 2) {
            bVar4 = true;
            goto LAB_0007865c;
        }
        pcVar2 = gai_strerror(param_1);
    LAB_0007863c:
        bVar4 = true;
        puVar3 = &DAT_000a9528;
        goto LAB_00078648;
    case -2:
    LAB_00078608:
        bVar4 = DAT_00118224 == 0;
        if (debug < 2)
            goto LAB_0007865c;
        pcVar2 = gai_strerror(param_1);
        if (bVar4)
            goto LAB_0007863c;
        puVar3 = &DAT_000ac9fc;
        goto LAB_00078648;
    }
    if (debug < 2) {
        bVar4 = false;
    } else {
        bVar4 = false;
        pcVar2 = gai_strerror(param_1);
        puVar3 = &DAT_000ac9fc;
    LAB_00078648:
        FUN_00075c68("intres: resolver returned: %s (%d), %sretrying\n", pcVar2,
                     param_1, puVar3);
    }
LAB_0007865c:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(bVar4);
}

void FUN_000786dc(undefined4 param_1, undefined4 *param_2, undefined4 param_3,
                  int param_4)

{
    uint uVar1;
    int iVar2;
    time_t tVar3;
    undefined4 uVar4;
    char *pcVar5;
    int *piVar6;
    int iVar7;
    int iVar8;
    int iVar9;
    uint uVar10;
    int iVar11;
    undefined4 *puVar12;
    undefined4 uVar13;
    undefined *puVar14;
    uint uVar15;
    int iVar16;
    int iVar17;
    int iVar18;

    iVar2 = __stack_chk_guard;
    puVar12 = param_2 + 0x12;
    iVar11 = param_2[0x10];
    iVar16 = *(int *)(dnschild_contexts + param_2[1] * 4);
    if (*(int *)(param_4 + 4) == 0) {
        if (2 < *(int *)(param_4 + 8)) {
            tVar3 = time((time_t *)0x0);
            *(time_t *)(iVar16 + 4) = tVar3;
            if (0 < debug) {
                uVar13 = param_2[1];
                uVar4 = FUN_00089b0c();
                FUN_00075c68("DNS success after retry, %u next_dns_timeslot "
                             "reset (%s)\n",
                             uVar13, uVar4);
            }
        }
    } else {
        uVar15 = param_2[0xd];
        if ((((uVar15 & 1) != 0) || (iVar17 = FUN_00078578(), iVar17 != 0)) &&
            (0 < (int)param_2[4])) {
            if ((param_2[4] == 2) && ((ntp_syslogmask & 1) != 0)) {
                if (param_2[6] == 10) {
                    puVar14 = &UNK_000aca34;
                } else if (param_2[6] == 2) {
                    puVar14 = &UNK_000aca3c;
                } else {
                    puVar14 = &DAT_000a9528;
                }
                if (*(int *)(param_4 + 4) == -0xb) {
                    piVar6 = __errno_location();
                    *piVar6 = *(int *)(param_4 + 0xc);
                    FUN_00075d40(6, "retrying DNS %s%s: EAI_SYSTEM %d: %m",
                                 puVar12, puVar14,
                                 *(undefined4 *)(param_4 + 0xc));
                } else {
                    pcVar5 = gai_strerror(*(int *)(param_4 + 4));
                    FUN_00075d40(6, "retrying DNS %s%s: %s (%d)", puVar12,
                                 puVar14, pcVar5, *(undefined4 *)(param_4 + 4));
                }
            }
            tVar3 = time((time_t *)0x0);
            iVar17 = tVar3 + param_2[4];
            uVar1 = param_2[4] * 2;
            if (iVar17 < *(int *)(iVar16 + 4)) {
                iVar17 = *(int *)(iVar16 + 4);
            }
            *(int *)(iVar16 + 4) = iVar17;
            if ((uVar15 & 1) == 0) {
                uVar15 = 0x40;
            } else {
                uVar15 = 0x400;
            }
            uVar10 = uVar1 - 1 & uVar1;
            param_2[2] = tVar3;
            if (uVar10 == 0) {
                uVar10 = uVar1 - ((int)uVar1 >> 2);
            }
            param_2[3] = iVar17;
            if ((int)uVar15 <= (int)uVar10) {
                uVar10 = uVar15;
            }
            param_2[4] = uVar10;
            iVar16 = FUN_0007a0f4(1, param_2, *param_2, FUN_000786dc, param_2);
            if (iVar16 == 0) {
                if (iVar2 == __stack_chk_guard) {
                    return;
                }
                goto LAB_000789d4;
            }
            FUN_00075d40(3, "unable to retry hostname %s", puVar12);
        }
    }
    iVar16 = *(int *)(param_4 + 0x10);
    iVar17 = param_4 + 0x14;
    if (-1 < iVar16 + -1) {
        iVar7 = 0;
        iVar18 = param_4 + (iVar16 + -1) * 0x20 + 0x14;
        do {
            *(int *)(iVar18 + 0x1c) = iVar7;
            iVar8 = iVar18 + -0x20;
            iVar7 = iVar18;
            iVar18 = iVar8;
        } while (iVar8 != param_4 + -0xc);
    }
    iVar7 = iVar17 + iVar16 * 0x20;
    iVar18 = iVar7 + iVar16 * 0x1c;
    if (iVar16 < 1) {
        if (iVar7 != iVar18) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_intres.c", 0x24d, 1,
                         "(char *)psau == canon_start");
        }
        if (iVar16 == 0) {
            iVar17 = 0;
        }
    } else {
        iVar8 = param_4;
        do {
            iVar9 = iVar8 + 0x20;
            if (*(int *)(iVar8 + 0x28) != 0) {
                *(int *)(iVar8 + 0x28) = iVar7;
            }
            iVar7 = iVar7 + 0x1c;
            if (*(int *)(iVar8 + 0x2c) != 0) {
                *(int *)(iVar8 + 0x2c) = *(int *)(iVar8 + 0x2c) + iVar18;
            }
            iVar8 = iVar9;
        } while (iVar9 != param_4 + iVar16 * 0x20);
    }
    (*(code *)param_2[0xe])(
        *(undefined4 *)(param_4 + 4), *(undefined4 *)(param_4 + 0xc),
        param_2[0xf], puVar12, (int)puVar12 + iVar11, param_2 + 5, iVar17);
    if (iVar2 == __stack_chk_guard) {
        free(param_2);
        return;
    }
LAB_000789d4:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00078a30(int param_1, int param_2, undefined4 *param_3)

{
    int iVar1;
    undefined4 uVar2;
    undefined4 uVar3;
    time_t tVar4;
    undefined4 uVar5;
    int iVar6;

    iVar1 = __stack_chk_guard;
    if (param_1 < (int)param_3[1]) {
        if (0 < debug) {
            uVar2 = FUN_00089b0c(param_2);
            uVar3 = FUN_00089b0c(param_1);
            FUN_00089b0c(param_3[1]);
            if (iVar1 == __stack_chk_guard) {
                FUN_00075c68(
                    "ignoring sleep until %s scheduled at %s (before %s)\n",
                    uVar2, uVar3);
                return;
            }
            goto LAB_00078bb4;
        }
    } else {
        tVar4 = time((time_t *)0x0);
        if (tVar4 < param_2) {
            if (0 < debug) {
                uVar2 = FUN_00089b0c(param_2);
                uVar3 = FUN_00089b0c(param_1);
                uVar5 = FUN_00089b0c(param_3[1]);
                FUN_00075c68("sleep until %s scheduled at %s (>= %s)\n", uVar2,
                             uVar3, uVar5);
            }
            iVar6 = FUN_0007f318(*param_3, param_2 - tVar4);
            if (iVar6 == -1) {
                tVar4 = time((time_t *)0x0);
                DAT_00118228 = tVar4 + 0x3c;
                param_3[1] = tVar4;
                param_3[2] = DAT_00118228;
                __res_init();
                if (0 < debug) {
                    uVar2 = FUN_00089b0c(param_3[1]);
                    if (iVar1 == __stack_chk_guard) {
                        FUN_00075c68("sleep interrupted by daemon, ignoring "
                                     "sleeps scheduled before now (%s)\n",
                                     uVar2);
                        return;
                    }
                    goto LAB_00078bb4;
                }
            }
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_00078bb4:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00078bd4(int *param_1)

{
    int iVar1;
    int iVar2;
    time_t tVar3;

    iVar2 = __stack_chk_guard;
    tVar3 = time((time_t *)0x0);
    iVar1 = DAT_00118228;
    *param_1 = DAT_00118228;
    if (iVar1 <= tVar3) {
        if (iVar1 != 0) {
            __res_init();
        }
        DAT_00118228 = tVar3 + 0x3c;
        *param_1 = DAT_00118228;
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00078c6c(undefined4 param_1, undefined4 *param_2, undefined4 param_3,
                  int param_4)

{
    uint uVar1;
    int iVar2;
    uint uVar3;
    time_t tVar4;
    undefined4 uVar5;
    uint uVar6;
    int iVar7;
    undefined4 uVar8;
    int iVar9;

    iVar2 = __stack_chk_guard;
    iVar7 = *(int *)(dnschild_contexts + param_2[1] * 4);
    if (*(int *)(param_4 + 4) == 0) {
        if (*(int *)(param_4 + 0xc) < 3) {
            uVar5 = 0;
        } else {
            tVar4 = time((time_t *)0x0);
            *(time_t *)(iVar7 + 4) = tVar4;
            if (debug < 1)
                goto LAB_00078dec;
            uVar8 = param_2[1];
            uVar5 = FUN_00089b0c();
            FUN_00075c68(
                "DNS success after retry, %u next_dns_timeslot reset (%s)\n",
                uVar8, uVar5);
            uVar5 = *(undefined4 *)(param_4 + 4);
        }
    } else {
        uVar3 = FUN_00078578();
        if (0 < (int)param_2[4]) {
            tVar4 = time((time_t *)0x0);
            iVar9 = tVar4 + param_2[4];
            uVar1 = param_2[4] * 2;
            if (iVar9 < *(int *)(iVar7 + 4)) {
                iVar9 = *(int *)(iVar7 + 4);
            }
            uVar6 = uVar1 - 1 & uVar1;
            if (uVar6 == 0) {
                uVar6 = uVar1 - ((int)uVar1 >> 2);
            }
            *(int *)(iVar7 + 4) = iVar9;
            param_2[2] = tVar4;
            param_2[3] = iVar9;
            if (0x3f < (int)uVar6) {
                uVar6 = 0x40;
            }
            uVar1 = uVar3;
            if (uVar3 != 0) {
                uVar1 = uVar6;
            }
            param_2[4] = uVar6;
            if ((uVar3 != 0 && uVar6 != 0) && -1 < (int)uVar1) {
                iVar7 =
                    FUN_0007a0f4(0, param_2, *param_2, FUN_00078c6c, param_2);
                if (iVar7 == 0) {
                    if (iVar2 == __stack_chk_guard) {
                        return;
                    }
                    goto LAB_00078e48;
                }
                uVar5 = FUN_0007d2c0(param_2 + 10);
                FUN_00075d40(3, "unable to retry reverse lookup of %s", uVar5);
                uVar5 = *(undefined4 *)(param_4 + 4);
                goto LAB_00078cc4;
            }
        }
    LAB_00078dec:
        uVar5 = *(undefined4 *)(param_4 + 4);
    }
LAB_00078cc4:
    if (*(int *)(param_4 + 0x10) == 0) {
        iVar7 = 0;
        iVar9 = 0;
    } else {
        iVar7 = *(int *)(param_4 + 0x14);
        iVar9 = param_4 + 0x18;
        if (iVar7 != 0) {
            iVar7 = iVar9 + *(int *)(param_4 + 0x10);
        }
    }
    (*(code *)param_2[8])(uVar5, *(undefined4 *)(param_4 + 8), param_2 + 10,
                          param_2[7], iVar9, iVar7, param_2[9]);
    if (iVar2 == __stack_chk_guard) {
        free(param_2);
        return;
    }
LAB_00078e48:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00078e68(char *param_1, char *param_2, int *param_3, int param_4,
                  int param_5, int param_6, int param_7)

{
    int iVar1;
    int iVar2;
    size_t sVar3;
    size_t sVar4;
    int *piVar5;
    time_t tVar6;
    int iVar7;
    int iVar8;
    int iVar9;
    size_t __n;

    iVar1 = __stack_chk_guard;
    if (param_1 == (char *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_intres.c", 0xfd, 0, "((void *)0) != node");
    }
    if (param_3 != (int *)0x0) {
        if (param_3[4] != 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_intres.c", 0xff, 0, "0 == hints->ai_addrlen");
        }
        if (param_3[5] != 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_intres.c", 0x100, 0,
                         "((void *)0) == hints->ai_addr");
        }
        if (param_3[6] != 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_intres.c", 0x101, 0,
                         "((void *)0) == hints->ai_canonname");
        }
        if (param_3[7] != 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("ntp_intres.c", 0x102, 0,
                         "((void *)0) == hints->ai_next");
        }
    }
    iVar2 = FUN_000783a4();
    iVar7 = *(int *)(dnschild_contexts + iVar2 * 4);
    sVar3 = strlen(param_1);
    __n = sVar3 + 1;
    sVar4 = strlen(param_2);
    sVar4 = sVar4 + 1;
    iVar9 = __n + sVar4 + 0x48;
    piVar5 = (int *)FUN_00074b04(0, iVar9);
    piVar5[1] = iVar2;
    *piVar5 = iVar9;
    tVar6 = time((time_t *)0x0);
    iVar2 = *(int *)(iVar7 + 4);
    piVar5[2] = tVar6;
    if (tVar6 < iVar2) {
        tVar6 = iVar2;
    }
    piVar5[3] = tVar6;
    *(time_t *)(iVar7 + 4) = tVar6;
    if (param_3 != (int *)0x0) {
        iVar2 = param_3[1];
        iVar7 = param_3[2];
        iVar8 = param_3[3];
        piVar5[5] = *param_3;
        piVar5[6] = iVar2;
        piVar5[7] = iVar7;
        piVar5[8] = iVar8;
        iVar2 = param_3[5];
        iVar7 = param_3[6];
        iVar8 = param_3[7];
        piVar5[9] = param_3[4];
        piVar5[10] = iVar2;
        piVar5[0xb] = iVar7;
        piVar5[0xc] = iVar8;
    }
    piVar5[0x10] = __n;
    piVar5[0x11] = sVar4;
    piVar5[4] = param_4;
    piVar5[0xe] = param_5;
    piVar5[0xf] = param_6;
    piVar5[0xd] = param_7;
    memcpy(piVar5 + 0x12, param_1, __n);
    memcpy((void *)((int)piVar5 + sVar3 + 0x49), param_2, sVar4);
    iVar2 = FUN_0007a0f4(1, piVar5, iVar9, FUN_000786dc, piVar5);
    if (iVar2 != 0) {
        FUN_00075d40(3, "unable to queue getaddrinfo request");
        piVar5 = __errno_location();
        iVar2 = -1;
        *piVar5 = 0xe;
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar2);
    }
    return;
}

void FUN_00079110(undefined4 param_1, int param_2)

{
    int iVar1;
    int iVar2;
    size_t sVar3;
    time_t tVar4;
    undefined4 uVar5;
    sockaddr *psVar6;
    int iVar7;
    addrinfo *paVar8;
    int iVar9;
    int iVar10;
    int *__dest;
    int *piVar11;
    addrinfo *paVar12;
    char *pcVar13;
    int iVar14;
    addrinfo *local_30;
    int local_2c;

    pcVar13 = (char *)(param_2 + 0x60);
    iVar9 = *(int *)(param_2 + 0x58);
    local_2c = __stack_chk_guard;
    iVar1 = FUN_00078440(param_1, *(undefined4 *)(param_2 + 0x1c));
    FUN_00078a30(*(undefined4 *)(param_2 + 0x20),
                 *(undefined4 *)(param_2 + 0x24), iVar1);
    FUN_00078bd4(iVar1 + 8);
    iVar2 = FUN_00074b04(0, 0x4ec, 0, 1);
    if (1 < debug) {
        FUN_00075c68(
            "blocking_getaddrinfo given node %s serv %s fam %d flags %x\n",
            pcVar13, pcVar13 + iVar9, *(undefined4 *)(param_2 + 0x30),
            *(undefined4 *)(param_2 + 0x2c));
    }
    iVar10 = 0;
    local_30 = (addrinfo *)0x0;
    iVar9 = getaddrinfo(pcVar13, pcVar13 + iVar9, (addrinfo *)(param_2 + 0x2c),
                        &local_30);
    iVar14 = *(int *)(param_2 + 0x28);
    *(int *)(iVar2 + 0x20) = iVar14;
    *(int *)(iVar2 + 0x1c) = iVar9;
    if (iVar9 == -0xb) {
        piVar11 = __errno_location();
        *(int *)(iVar2 + 0x24) = *piVar11;
    } else if (iVar9 == 0) {
        if (local_30 == (addrinfo *)0x0) {
            iVar10 = 0;
        } else {
            iVar9 = *(int *)(iVar2 + 0x28);
            iVar10 = 0;
            paVar12 = local_30;
            do {
                iVar9 = iVar9 + 1;
                pcVar13 = paVar12->ai_canonname;
                *(int *)(iVar2 + 0x28) = iVar9;
                if (pcVar13 != (char *)0x0) {
                    sVar3 = strlen(pcVar13);
                    iVar10 = iVar10 + 1 + sVar3;
                }
                paVar12 = paVar12->ai_next;
            } while (paVar12 != (addrinfo *)0x0);
        }
        if (2 < iVar14) {
            tVar4 = time((time_t *)0x0);
            iVar9 = debug;
            *(time_t *)(iVar1 + 4) = tVar4;
            if (0 < iVar9) {
                uVar5 = FUN_00089b0c();
                FUN_00075c68("DNS success after retry, ignoring sleeps "
                             "scheduled before now (%s)\n",
                             uVar5);
            }
        }
    }
    iVar10 = iVar10 + *(int *)(iVar2 + 0x28) * 0x3c;
    iVar9 = iVar10 + 0x2c;
    *(int *)(iVar2 + 0x18) = iVar10 + 0x14;
    iVar1 = FUN_00074b04(iVar2, iVar9, 0);
    if (*(int *)(iVar1 + 0x1c) == 0) {
        iVar2 = 0;
        paVar12 = local_30;
        piVar11 = (int *)(iVar1 + 0x2c);
        if (local_30 != (addrinfo *)0x0) {
            do {
                __dest = piVar11 + 8;
                iVar10 = paVar12->ai_family;
                iVar14 = paVar12->ai_socktype;
                iVar7 = paVar12->ai_protocol;
                *piVar11 = paVar12->ai_flags;
                piVar11[1] = iVar10;
                piVar11[2] = iVar14;
                piVar11[3] = iVar7;
                paVar8 = paVar12->ai_next;
                psVar6 = paVar12->ai_addr;
                pcVar13 = paVar12->ai_canonname;
                piVar11[4] = paVar12->ai_addrlen;
                piVar11[5] = (int)psVar6;
                piVar11[6] = (int)pcVar13;
                piVar11[7] = (int)paVar8;
                if (paVar12->ai_canonname != (char *)0x0) {
                    piVar11[6] = iVar2;
                    sVar3 = strlen(paVar12->ai_canonname);
                    iVar2 = iVar2 + 1 + sVar3;
                }
                paVar12 = paVar12->ai_next;
                piVar11 = __dest;
            } while (paVar12 != (addrinfo *)0x0);
            paVar12 = (addrinfo *)0x0;
            paVar8 = local_30;
            if (local_30 != (addrinfo *)0x0) {
                do {
                    if (0x1c < paVar8->ai_addrlen) {
                        /* WARNING: Subroutine does not return */
                        FUN_0007fc54("ntp_intres.c", 0x1a9, 2,
                                     "ai->ai_addrlen <= sizeof(sockaddr_u)");
                    }
                    memcpy(__dest, paVar8->ai_addr, paVar8->ai_addrlen);
                    paVar8 = paVar8->ai_next;
                    __dest = __dest + 7;
                } while (paVar8 != (addrinfo *)0x0);
                paVar8 = local_30;
                if (local_30 == (addrinfo *)0x0) {
                    paVar12 = (addrinfo *)0x0;
                } else {
                    do {
                        pcVar13 = paVar8->ai_canonname;
                        piVar11 = __dest;
                        if (pcVar13 != (char *)0x0) {
                            sVar3 = strlen(pcVar13);
                            piVar11 = (int *)((int)__dest + sVar3 + 1);
                            memcpy(__dest, pcVar13, sVar3 + 1);
                        }
                        paVar8 = paVar8->ai_next;
                        paVar12 = local_30;
                        __dest = piVar11;
                    } while (paVar8 != (addrinfo *)0x0);
                }
            }
        }
        freeaddrinfo(paVar12);
    }
    iVar1 = FUN_0007a2c4(param_1, iVar1, iVar9, param_2);
    if (iVar1 != 0) {
        FUN_00075d40(3, "blocking_getaddrinfo can not queue response");
        iVar1 = -1;
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar1);
}

void FUN_00079464(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_00078e68();
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000794c4(short *param_1, int param_2, int param_3, undefined4 param_4,
                  undefined4 param_5, undefined4 param_6)

{
    int iVar1;
    int iVar2;
    undefined4 *puVar3;
    time_t tVar4;
    int *piVar5;
    size_t __n;
    int iVar6;

    iVar1 = __stack_chk_guard;
    if (param_2 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_intres.c", 0x28f, 0, "hostoctets");
    }
    if (0x3ff < (uint)(param_2 + param_3)) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_intres.c", 0x290, 0,
                     "hostoctets + servoctets < 1024");
    }
    iVar2 = FUN_000783a4();
    iVar6 = *(int *)(dnschild_contexts + iVar2 * 4);
    puVar3 = (undefined4 *)FUN_00074b04(0, 0x44, 0, 1);
    *puVar3 = 0x44;
    puVar3[1] = iVar2;
    tVar4 = time((time_t *)0x0);
    iVar2 = *(int *)(iVar6 + 4);
    puVar3[2] = tVar4;
    if (tVar4 < iVar2) {
        tVar4 = iVar2;
    }
    puVar3[3] = tVar4;
    *(time_t *)(iVar6 + 4) = tVar4;
    if (*param_1 == 2) {
        __n = 0x10;
    } else {
        __n = 0x1c;
    }
    memcpy(puVar3 + 10, param_1, __n);
    puVar3[4] = 2;
    puVar3[8] = param_5;
    puVar3[9] = param_6;
    puVar3[5] = param_2;
    puVar3[6] = param_3;
    puVar3[7] = param_4;
    iVar2 = FUN_0007a0f4(0, puVar3, 0x44, FUN_00078c6c, puVar3);
    if (iVar2 != 0) {
        FUN_00075d40(3, "unable to queue getnameinfo request");
        piVar5 = __errno_location();
        iVar2 = -1;
        *piVar5 = 0xe;
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar2);
    }
    return;
}

void FUN_0007967c(undefined4 param_1, int param_2)

{
    int iVar1;
    undefined4 uVar2;
    int iVar3;
    size_t sVar4;
    size_t sVar5;
    int *piVar6;
    time_t tVar7;
    socklen_t __salen;
    int iVar8;
    uint uVar9;
    int iVar10;
    char *__serv;
    void *__dest;
    char acStack_42c[1024];
    int local_2c;

    iVar10 = *(int *)(param_2 + 0x2c);
    uVar9 = iVar10 + *(int *)(param_2 + 0x30);
    local_2c = __stack_chk_guard;
    if (0x3ff < uVar9) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_intres.c", 0x2d0, 0, "octets < sizeof(host)");
    }
    iVar1 = FUN_00078440(param_1, *(undefined4 *)(param_2 + 0x1c));
    __serv = acStack_42c + iVar10;
    FUN_00078a30(*(undefined4 *)(param_2 + 0x20),
                 *(undefined4 *)(param_2 + 0x24), iVar1);
    FUN_00078bd4(iVar1 + 8);
    iVar10 = FUN_00074b04(0, uVar9 + 0x30, 0, 1);
    if (1 < debug) {
        uVar2 = FUN_0007d2c0((sockaddr *)(param_2 + 0x40));
        FUN_00075c68("blocking_getnameinfo given addr %s flags 0x%x hostlen "
                     "%lu servlen %lu\n",
                     uVar2, *(undefined4 *)(param_2 + 0x34),
                     *(undefined4 *)(param_2 + 0x2c),
                     *(undefined4 *)(param_2 + 0x30));
    }
    if (*(short *)(param_2 + 0x40) == 2) {
        __salen = 0x10;
    } else {
        __salen = 0x1c;
    }
    iVar3 =
        getnameinfo((sockaddr *)(param_2 + 0x40), __salen, acStack_42c,
                    *(socklen_t *)(param_2 + 0x2c), __serv,
                    *(socklen_t *)(param_2 + 0x30), *(uint *)(param_2 + 0x34));
    iVar8 = *(int *)(param_2 + 0x28);
    *(int *)(iVar10 + 0x24) = iVar8;
    *(int *)(iVar10 + 0x1c) = iVar3;
    if (iVar3 == -0xb) {
        piVar6 = __errno_location();
        *(int *)(iVar10 + 0x20) = *piVar6;
    LAB_00079868:
        iVar1 = 0x18;
        *(undefined4 *)(iVar10 + 0x28) = 0;
        iVar3 = 0x30;
        *(undefined4 *)(iVar10 + 0x2c) = 0;
    } else {
        if (iVar3 != 0)
            goto LAB_00079868;
        sVar4 = strlen(acStack_42c);
        *(size_t *)(iVar10 + 0x28) = sVar4 + 1;
        sVar5 = strlen(__serv);
        *(size_t *)(iVar10 + 0x2c) = sVar5 + 1;
        if (iVar8 < 3) {
            iVar1 = sVar5 + 1 + sVar4 + 1;
            iVar3 = iVar1 + 0x30;
            iVar1 = iVar1 + 0x18;
        } else {
            tVar7 = time((time_t *)0x0);
            iVar3 = debug;
            *(time_t *)(iVar1 + 4) = tVar7;
            if (0 < iVar3) {
                uVar2 = FUN_00089b0c();
                FUN_00075c68("DNS success after retrying, ignoring sleeps "
                             "scheduled before now (%s)\n",
                             uVar2);
            }
            iVar1 = *(int *)(iVar10 + 0x2c) + *(int *)(iVar10 + 0x28);
            iVar3 = iVar1 + 0x30;
            iVar1 = iVar1 + 0x18;
        }
    }
    iVar10 = FUN_00074b04(iVar10, iVar3, 0);
    *(int *)(iVar10 + 0x18) = iVar1;
    if (*(int *)(iVar10 + 0x1c) == 0) {
        __dest = (void *)(iVar10 + 0x30 + *(size_t *)(iVar10 + 0x28));
        memcpy((void *)(iVar10 + 0x30), acStack_42c,
               *(size_t *)(iVar10 + 0x28));
        memcpy(__dest, __serv, *(size_t *)(iVar10 + 0x2c));
        if ((int)__dest + (*(int *)(iVar10 + 0x2c) - iVar10) == iVar3) {
            if (*(int *)(iVar10 + 0x18) != iVar1) {
                /* WARNING: Subroutine does not return */
                FUN_0007fc54("ntp_intres.c", 0x31d, 2,
                             "resp_octets - sizeof(*resp) == gni_resp->octets");
            }
            goto LAB_00079810;
        }
    } else if (iVar3 == 0x30) {
    LAB_00079810:
        iVar10 = FUN_0007a2c4(param_1, iVar10);
        if (iVar10 != 0) {
            FUN_00075d40(3, "blocking_getnameinfo unable to queue response");
        }
        if (local_2c == __stack_chk_guard) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar10);
    }
    /* WARNING: Subroutine does not return */
    FUN_0007fc54("ntp_intres.c", 0x31c, 2,
                 "(size_t)(cp - (char *)resp) == resp_octets");
}

/* WARNING: Removing unreachable block (ram,0x000799c8) */

void FUN_0007998c(int *param_1, int param_2, undefined4 *param_3)

{
    undefined4 *puVar1;
    int iVar2;
    char *pcVar3;
    short *psVar4;
    void *pvVar5;
    char cVar6;
    uint uVar7;
    undefined4 uVar8;
    int *piVar9;
    uint uVar10;
    int iVar11;
    uint uVar12;
    void *pvVar13;
    void *unaff_r10;
    short *psVar14;
    undefined4 *puVar15;
    void *pvVar16;
    bool bVar17;
    void *local_50;
    void *local_4c;
    int *local_48;
    int *local_44;
    int local_3c;
    int local_38;
    undefined4 local_34;
    int local_30;
    int local_2c;

    local_2c = __stack_chk_guard;
    iVar2 = FUN_000989f8(param_1, *param_3);
    if (iVar2 != 0) {
        uVar10 = FUN_0008e31c(option_xlateable_txt._60_4_);
        pvVar16 = (void *)0x9ae24;
        goto LAB_0009ae24;
    }
    if ((param_1[3] & 0x40U) == 0) {
        param_1[1] = param_2;
        param_1[3] = param_1[3] | 0x40;
        param_1[2] = (int)param_3;
        if (0x21fff < *param_1) {
            DAT_000c928c = param_1[0x1f];
        }
        iVar2 = FUN_000976b4(param_1);
        uVar10 = 0;
        if (iVar2 != 0)
            goto LAB_0009a780;
        if ((*(ushort *)((int)param_1 + 0x5e) & 0x7fff) == 0) {
            param_1[3] = param_1[3] | 0x80000;
            if (param_1[0xd] == 0) {
            LAB_0009ab08:
                FUN_0009a420(param_1, 0);
            } else {
                FUN_0009a420(param_1, 1);
            LAB_0009a6e4:
                FUN_0009a420(param_1, 2);
            }
            uVar10 = param_1[3] & 0xfff7ffff;
            param_1[3] = uVar10;
        } else {
            iVar2 =
                param_1[0x11] + (*(ushort *)((int)param_1 + 0x5e) + 1) * 0x40;
            if ((*(uint *)(iVar2 + 0x10) & 0x20) == 0) {
                param_1[3] = param_1[3] | 0x80000;
                if (param_1[0xd] == 0)
                    goto LAB_0009ab08;
                FUN_0009a420(param_1, 1);
                if ((*(uint *)(iVar2 + 0x10) & 0x20) == 0) {
                    FUN_00099a60(param_1);
                }
                goto LAB_0009a6e4;
            }
            uVar10 = param_1[3];
        }
        if ((((uVar10 & 0x2000) != 0) &&
             ((code *)param_1[0x16] != (code *)0x0)) &&
            ((uVar10 & 0x30000) == 0x10000)) {
            param_1[3] = uVar10 & 0xfffeffff;
            (*(code *)param_1[0x16])();
            uVar10 = param_1[3];
        }
        if ((uVar10 & 0x800) != 0) {
            local_3c = 0;
            local_38 = 0;
            local_30 = 0;
            local_34 = 4;
            pcVar3 = getenv("POSIXLY_CORRECT");
            if ((pcVar3 == (char *)0x0) && ((param_1[3] & 3U) != 0)) {
                local_50 = (void *)FUN_0008fbe0(param_1[1] << 2);
                if (local_50 != (void *)0x0) {
                    unaff_r10 = (void *)FUN_0008fbe0(param_1[1] << 2);
                    if (unaff_r10 != (void *)0x0) {
                        local_44 = &local_30;
                        uVar10 = 1;
                        local_48 = &local_3c;
                        param_1[5] = 0;
                        param_1[4] = 1;
                        uVar7 = param_1[1];
                        param_2 = 0;
                        local_4c = (void *)0x0;
                        pvVar16 = (void *)0x9a880;
                    LAB_0009a8c4:
                        pvVar13 = local_4c;
                        if (uVar10 < uVar7) {
                            pcVar3 = *(char **)(param_1[2] + uVar10 * 4);
                            if ((*pcVar3 == '-') &&
                                (cVar6 = pcVar3[1], cVar6 != '\0')) {
                                if (cVar6 == '-') {
                                    if (pcVar3[2] == '\0') {
                                        uVar12 = uVar10 + 1;
                                        bVar17 = uVar12 < uVar7;
                                        param_1[4] = uVar12;
                                        pvVar5 = pvVar13;
                                        if (bVar17) {
                                            pvVar5 = (void *)(uVar12 * 4);
                                        }
                                        *(char **)((int)local_50 +
                                                   (int)pvVar13 * 4) = pcVar3;
                                        if (bVar17) {
                                            pvVar16 = (void *)(uVar7 << 2);
                                        }
                                        pvVar13 = (void *)((int)pvVar13 + 1);
                                        if (bVar17) {
                                            puVar15 =
                                                (undefined4 *)((int)unaff_r10 +
                                                               param_2 * 4);
                                            do {
                                                puVar1 =
                                                    (undefined4 *)(param_1[2] +
                                                                   (int)pvVar5);
                                                pvVar5 =
                                                    (void *)((int)pvVar5 + 4);
                                                *puVar15 = *puVar1;
                                                puVar15 = puVar15 + 1;
                                            } while (pvVar5 != pvVar16);
                                            param_2 =
                                                (param_2 + uVar7 + -1) - uVar10;
                                            param_1[4] =
                                                ((uVar7 - 1) + uVar12) - uVar10;
                                        }
                                        goto LAB_0009acac;
                                    }
                                    iVar2 = FUN_00097008(param_1, pcVar3 + 2,
                                                         local_48);
                                } else if ((param_1[3] & 2U) == 0) {
                                    iVar2 = FUN_00097008(param_1, pcVar3 + 1,
                                                         local_48);
                                } else {
                                    iVar2 = FUN_0008f2c8(param_1, cVar6,
                                                         local_48, local_44);
                                }
                                if (iVar2 < 0) {
                                LAB_0009ad84:
                                    piVar9 = __errno_location();
                                    *piVar9 = 0x16;
                                    goto LAB_0009ac74;
                                }
                                iVar11 = param_1[4];
                                local_4c = (void *)((int)pvVar13 + 1);
                                iVar2 = (int)pvVar13 * 4;
                                uVar10 = iVar11 + 1;
                                uVar8 =
                                    *(undefined4 *)(param_1[2] + iVar11 * 4);
                                param_1[4] = uVar10;
                                *(undefined4 *)((int)local_50 +
                                                (int)pvVar13 * 4) = uVar8;
                                pvVar16 = local_50;
                                if ((*(uint *)(local_3c + 0x10) & 0xf000) ==
                                    0) {
                                    if (local_30 == 1) {
                                        cVar6 = pcVar3[2];
                                        pcVar3 = pcVar3 + 2;
                                        if (cVar6 == '\0') {
                                        LAB_0009ae24:
                                            uVar7 = param_1[1];
                                        } else {
                                            do {
                                                pvVar16 = (void *)0x9ad7c;
                                                iVar11 = FUN_0008f2c8(
                                                    param_1, cVar6, local_48,
                                                    local_44);
                                                if (iVar11 < 0)
                                                    goto LAB_0009ad84;
                                                if ((*(uint *)(local_3c +
                                                               0x10) &
                                                     0xf000) != 0) {
                                                    if ((*(uint *)(local_3c +
                                                                   0x10) &
                                                         0x10000) == 0) {
                                                        if (pcVar3[1] == '\0') {
                                                            uVar12 = param_1[4];
                                                            uVar7 = param_1[1];
                                                            if (uVar7 <= uVar12)
                                                                goto LAB_0009ad84;
                                                            uVar10 = uVar12 + 1;
                                                            uVar8 = *(
                                                                undefined4
                                                                    *)(param_1
                                                                           [2] +
                                                                       uVar12 *
                                                                           4);
                                                            param_1[4] = uVar10;
                                                            *(undefined4
                                                                  *)((int)
                                                                         local_50 +
                                                                     iVar2 +
                                                                     4) = uVar8;
                                                            local_4c =
                                                                (void
                                                                     *)((int)
                                                                            pvVar13 +
                                                                        2);
                                                            goto LAB_0009a8c4;
                                                        }
                                                    } else if (pcVar3[1] ==
                                                               '\0') {
                                                        uVar10 = param_1[4];
                                                        pcVar3 = *(
                                                            char *
                                                                *)(param_1[2] +
                                                                   uVar10 * 4);
                                                        if (*pcVar3 == '-')
                                                            goto LAB_0009ae24;
                                                        param_1[4] = uVar10 + 1;
                                                        uVar10 = param_1[4];
                                                        uVar7 = param_1[1];
                                                        *(char *
                                                              *)((int)local_50 +
                                                                 iVar2 + 4) =
                                                            pcVar3;
                                                        local_4c =
                                                            (void
                                                                 *)((int)
                                                                        pvVar13 +
                                                                    2);
                                                        goto LAB_0009a8c4;
                                                    }
                                                    break;
                                                }
                                                pcVar3 = pcVar3 + 1;
                                                cVar6 = *pcVar3;
                                            } while (cVar6 != '\0');
                                            uVar7 = param_1[1];
                                            uVar10 = param_1[4];
                                        }
                                        goto LAB_0009a8c4;
                                    }
                                } else {
                                    if ((*(uint *)(local_3c + 0x10) &
                                         0x10000) == 0) {
                                        if (local_30 == 1) {
                                            if (pcVar3[2] == '\0') {
                                            LAB_0009ad08:
                                                uVar7 = param_1[1];
                                                if (uVar7 <= uVar10)
                                                    goto LAB_0009ac68;
                                                uVar10 = iVar11 + 2;
                                                uVar8 =
                                                    *(undefined4 *)(param_1[2] +
                                                                    iVar11 * 4 +
                                                                    4);
                                                param_1[4] = uVar10;
                                                *(undefined4 *)((int)local_50 +
                                                                iVar2 + 4) =
                                                    uVar8;
                                                local_4c =
                                                    (void *)((int)pvVar13 + 2);
                                                goto LAB_0009a8c4;
                                            }
                                        } else {
                                            if (local_30 != 2) {
                                            LAB_0009ac68:
                                                piVar9 = __errno_location();
                                                *piVar9 = 5;
                                                goto LAB_0009ac74;
                                            }
                                            if (local_38 == 0)
                                                goto LAB_0009ad08;
                                        }
                                        uVar7 = param_1[1];
                                        goto LAB_0009a8c4;
                                    }
                                    if (local_30 == 1) {
                                        if (pcVar3[2] == '\0') {
                                        LAB_0009abec:
                                            uVar7 = param_1[1];
                                            if (uVar7 <= uVar10) {
                                                piVar9 = __errno_location();
                                                *piVar9 = 0;
                                                pvVar13 = local_4c;
                                                goto LAB_0009acac;
                                            }
                                            pcVar3 = *(char **)(param_1[2] +
                                                                iVar11 * 4 + 4);
                                            if (*pcVar3 != '-') {
                                                uVar10 = iVar11 + 2;
                                                param_1[4] = uVar10;
                                                *(char **)((int)local_50 +
                                                           iVar2 + 4) = pcVar3;
                                                local_4c =
                                                    (void *)((int)pvVar13 + 2);
                                            }
                                            goto LAB_0009a8c4;
                                        }
                                    } else {
                                        if (local_30 != 2)
                                            goto LAB_0009ac68;
                                        if (local_38 == 0)
                                            goto LAB_0009abec;
                                    }
                                }
                                uVar7 = param_1[1];
                                goto LAB_0009a8c4;
                            }
                            uVar10 = uVar10 + 1;
                            param_1[4] = uVar10;
                            *(char **)((int)unaff_r10 + param_2 * 4) = pcVar3;
                            param_2 = param_2 + 1;
                            local_4c = pvVar13;
                            goto LAB_0009a8c4;
                        }
                        piVar9 = __errno_location();
                        *piVar9 = 0;
                    LAB_0009acac:
                        if (pvVar13 != (void *)0x0) {
                            memcpy((void *)(param_1[2] + 4), local_50,
                                   (int)pvVar13 << 2);
                        }
                        if (param_2 != 0) {
                            memcpy(
                                (void *)(param_1[2] + ((int)pvVar13 + 1) * 4),
                                unaff_r10, param_2 << 2);
                        }
                    LAB_0009ac74:
                        free(local_50);
                        free(unaff_r10);
                        goto LAB_0009a724;
                    }
                    free(local_50);
                }
                piVar9 = __errno_location();
                *piVar9 = 0xc;
            }
        }
    LAB_0009a724:
        param_1[4] = 1;
        param_1[5] = 0;
    } else if (param_1[4] == 0) {
        param_1[5] = 0;
        param_1[4] = 1;
    }
    iVar2 = FUN_000977f0(param_1);
    if (iVar2 != 0) {
        uVar10 = param_1[1];
        goto LAB_0009a780;
    }
    uVar10 = (uint) * (ushort *)((int)param_1 + 0x5e);
    if (((uVar10 != 0) && (uVar10 != 0x8000)) &&
        ((*(uint *)(param_1[0x11] + uVar10 * 0x40 + 0x10) & 5) != 0)) {
        FUN_000968a8(param_1);
        /* WARNING: Subroutine does not return */
        FUN_0008e2b8(0);
    }
    uVar10 = param_1[3];
    if ((uVar10 & 4) != 0) {
        psVar14 = (short *)param_1[0x11];
        iVar2 = param_1[0x1a];
        psVar4 = psVar14;
        while (true) {
            uVar7 = *(uint *)(psVar4 + 8);
            if ((uVar7 & 5) != 0) {
                if (*(int *)(psVar4 + 0x10) != 0) {
                    piVar9 = (int *)(*(int *)(psVar4 + 0x10) + -4);
                    while (true) {
                        piVar9 = piVar9 + 1;
                        iVar11 = *piVar9;
                        if (iVar11 == 0x8000)
                            break;
                        if ((*(uint *)(psVar14 + iVar11 * 0x20 + 8) & 0xf) ==
                            0) {
                            fprintf(stderr,
                                    (char *)option_xlateable_txt._236_4_,
                                    param_1[7], *(undefined4 *)(psVar4 + 0x1a),
                                    *(undefined4 *)(psVar14 + iVar11 * 0x20 +
                                                    0x1a));
                            goto LAB_0009aa44;
                        }
                    }
                }
                if (*(int *)(psVar4 + 0x12) != 0) {
                    piVar9 = (int *)(*(int *)(psVar4 + 0x12) + -4);
                    while (true) {
                        piVar9 = piVar9 + 1;
                        iVar11 = *piVar9;
                        if (iVar11 == 0x8000)
                            break;
                        if ((*(uint *)(psVar14 + iVar11 * 0x20 + 8) & 5) != 0) {
                            fprintf(stderr,
                                    (char *)option_xlateable_txt._108_4_,
                                    param_1[7], *(undefined4 *)(psVar4 + 0x1a),
                                    *(undefined4 *)(psVar14 + iVar11 * 0x20 +
                                                    0x1a));
                            goto LAB_0009aa44;
                        }
                    }
                }
            }
            if (((psVar4[4] == -0x8000) || (*psVar4 == psVar4[4])) &&
                ((uVar12 = (uint)(ushort)psVar4[5],
                  (ushort)psVar4[7] < uVar12 &&
                      (((uVar7 & 0x100000) == 0 || ((uVar7 & 3) == 0)))))) {
                if (uVar12 < 2) {
                    fprintf(stderr, (char *)option_xlateable_txt._152_4_,
                            param_1[7], *(undefined4 *)(psVar4 + 0x1a));
                } else {
                    fprintf(stderr, (char *)option_xlateable_txt._200_4_,
                            param_1[7], *(undefined4 *)(psVar4 + 0x1a), uVar12);
                }
                goto LAB_0009aa44;
            }
            iVar2 = iVar2 + -1;
            if (iVar2 < 1)
                break;
            psVar4 = psVar4 + 0x20;
        }
        if ((uVar10 & 0x200) == 0) {
            if ((uVar10 & 0x400) == 0)
                goto LAB_0009a77c;
            uVar10 = param_1[4];
            if (uVar10 < (uint)param_1[1])
                goto LAB_0009a780;
            fprintf(stderr, (char *)option_xlateable_txt._88_4_, param_1[7]);
        } else {
            uVar10 = param_1[4];
            if ((uint)param_1[1] <= uVar10)
                goto LAB_0009a780;
            fprintf(stderr, (char *)option_xlateable_txt._160_4_, param_1[7]);
        }
    LAB_0009aa44:
        (*(code *)param_1[0x15])(param_1, 1);
    }
LAB_0009a77c:
    uVar10 = param_1[4];
LAB_0009a780:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar10);
    }
    return;
}

void FUN_000799d4(void)

{
    puts(Version);
    fflush(stdout);
    /* WARNING: Subroutine does not return */
    exit(0);
}

void FUN_00079a2c(void)

{
    int iVar1;
    uint uVar2;
    int *piVar3;
    int iVar4;
    uint *puVar5;

    iVar1 = __stack_chk_guard;
    piVar3 = DAT_000c8d74 + 1;
    iVar4 = *DAT_000c8d74;
    uVar2 = *DAT_000c8d70;
    puVar5 = DAT_000c8d70 + 1;
    *DAT_000c8d70 = iVar4 + uVar2;
    if (puVar5 < (uint *)0xc8d70) {
        if ((int *)0xc8d6f < piVar3) {
            piVar3 = &DAT_000c8cf4;
        }
    } else {
        puVar5 = &DAT_000c8cf4;
    }
    DAT_000c8d70 = puVar5;
    DAT_000c8d74 = piVar3;
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar4 + uVar2 >> 1);
    }
    return;
}

void FUN_00079ad4(int param_1)

{
    int iVar1;
    uint __seed;
    int iVar2;
    int iVar3;
    int *piVar4;
    int *piVar5;

    iVar1 = __stack_chk_guard;
    piVar4 = &DAT_000c8cf4;
    iVar2 = 1;
    piVar5 = piVar4;
    DAT_000c8cf4 = param_1;
    while (true) {
        iVar2 = iVar2 + 1;
        iVar3 = param_1 * 0x41a7 + (param_1 / 0x1f31d) * -0x7fffffff;
        if (iVar3 < 1) {
            iVar3 = iVar3 + 0x7fffffff;
        }
        piVar4 = piVar4 + 1;
        *piVar4 = iVar3;
        if (iVar2 == 0x1f)
            break;
        piVar5 = piVar5 + 1;
        param_1 = *piVar5;
    }
    iVar2 = 0x136;
    DAT_000c8d70 = &DAT_000c8d00;
    DAT_000c8d74 = &DAT_000c8cf4;
    do {
        __seed = FUN_00079a2c();
        iVar2 = iVar2 + -1;
    } while (iVar2 != 0);
    if (iVar1 == __stack_chk_guard) {
        srand(__seed);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00079ca0) */
/* WARNING: Removing unreachable block (ram,0x00079c38) */
/* WARNING: Removing unreachable block (ram,0x00079c3c) */
/* WARNING: Removing unreachable block (ram,0x00079c40) */
/* WARNING: Removing unreachable block (ram,0x00079d10) */
/* WARNING: Removing unreachable block (ram,0x00079e60) */

void FUN_00079e20(undefined4 *param_1)

{
    undefined4 *puVar1;
    int iVar2;
    undefined4 *puVar3;
    size_t sVar4;
    undefined4 uVar5;
    undefined4 uVar6;
    undefined4 uVar7;
    char *__s;
    int iVar8;
    undefined4 *__dest;
    undefined4 *__dest_00;
    undefined4 *puVar9;
    undefined4 *puVar10;
    int local_38;

    iVar2 = __stack_chk_guard;
    if (param_1 == (undefined4 *)0x0) {
        puVar9 = (undefined4 *)FUN_00074b04(0, 0, 0, 1);
        local_38 = 0;
        puVar3 = puVar9;
    } else {
        local_38 = 0;
        iVar8 = 0;
        puVar9 = param_1;
        do {
            puVar3 = puVar9 + 6;
            iVar8 = iVar8 + 1;
            puVar9 = (undefined4 *)puVar9[7];
            if ((char *)*puVar3 != (char *)0x0) {
                sVar4 = strlen((char *)*puVar3);
                local_38 = local_38 + 1 + sVar4;
            }
        } while (puVar9 != (undefined4 *)0x0);
        local_38 = iVar8 * 0x3c + local_38;
        puVar3 = (undefined4 *)FUN_00074b04(0, local_38, 0, 1);
        __dest = puVar3 + iVar8 * 8;
        __dest_00 = __dest + iVar8 * 7;
        puVar1 = puVar3;
        do {
            uVar5 = param_1[1];
            uVar6 = param_1[2];
            uVar7 = param_1[3];
            puVar10 = (undefined4 *)param_1[7];
            *puVar1 = *param_1;
            puVar1[1] = uVar5;
            puVar1[2] = uVar6;
            puVar1[3] = uVar7;
            uVar5 = param_1[5];
            uVar6 = param_1[6];
            uVar7 = param_1[7];
            puVar1[4] = param_1[4];
            puVar1[5] = uVar5;
            puVar1[6] = uVar6;
            puVar1[7] = uVar7;
            if (0x1c < (uint)param_1[4]) {
                /* WARNING: Subroutine does not return */
                FUN_0007fc54("ntp_rfc2553.c", 0xcf, 2,
                             "ai_src->ai_addrlen <= sizeof(sockaddr_u)");
            }
            memcpy(__dest, (void *)param_1[5], param_1[4]);
            puVar1[5] = __dest;
            __dest = __dest + 7;
            puVar9 = __dest_00;
            if (param_1[6] != 0) {
                puVar1[6] = __dest_00;
                __s = (char *)param_1[6];
                sVar4 = strlen(__s);
                puVar9 = (undefined4 *)((int)__dest_00 + sVar4 + 1);
                memcpy(__dest_00, __s, sVar4 + 1);
            }
            if (puVar1[7] != 0) {
                puVar1[7] = puVar1 + 8;
            }
            param_1 = puVar10;
            __dest_00 = puVar9;
            puVar1 = puVar1 + 8;
        } while (puVar10 != (undefined4 *)0x0);
    }
    if (puVar9 != (undefined4 *)((int)puVar3 + local_38)) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_rfc2553.c", 0xe1, 1,
                     "pcanon == ((char *)dst + octets)");
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(puVar3);
}

void FUN_00079e6c(int *param_1, undefined4 *param_2)

{
    int iVar1;
    undefined4 uVar2;
    int local_24;
    int local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    iVar1 = socketpair(1, 1, 0, &local_24);
    if (iVar1 == -1) {
        iVar1 = pipe(&local_24);
        if (iVar1 == -1)
            goto LAB_00079ed4;
        uVar2 = 1;
    } else {
        uVar2 = 0;
    }
    iVar1 = 0;
    *param_1 = local_24;
    param_1[1] = local_20;
    if (param_2 != (undefined4 *)0x0) {
        *param_2 = uVar2;
    }
LAB_00079ed4:
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar1);
    }
    return;
}

void FUN_00079f80(int param_1)

{
    long lVar1;
    int iVar2;
    int iVar3;
    int iVar4;

    iVar2 = __stack_chk_guard;
    if (0 < param_1) {
        iVar3 = 0;
        do {
            iVar4 = iVar3 + 1;
            close(iVar3);
            iVar3 = iVar4;
        } while (iVar4 != param_1);
    }
    iVar3 = __stack_chk_guard;
    if (iVar2 == __stack_chk_guard) {
        lVar1 = sysconf(4);
        iVar2 = param_1 + 1;
        if (param_1 + 1 < lVar1) {
            do {
                iVar4 = iVar2 + 1;
                close(iVar2);
                iVar2 = iVar4;
            } while (iVar4 != lVar1);
        }
        if (iVar3 != __stack_chk_guard) {
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00079fec(void)

{
    int iVar1;
    int iVar2;
    undefined4 *puVar3;
    int iVar4;
    int *piVar5;
    int iVar6;
    int iVar7;

    iVar2 = __stack_chk_guard;
    iVar1 = blocking_children_alloc;
    if (blocking_children_alloc == 0) {
        iVar4 = 0x10;
        iVar7 = 4;
        iVar6 = 0;
    LAB_0007a07c:
        blocking_children =
            (undefined4 *)FUN_00074b04(blocking_children, iVar4, iVar6, 1);
        iVar6 = iVar1;
        blocking_children_alloc = iVar7;
    } else {
        piVar5 = (int *)*blocking_children;
        if (piVar5 == (int *)0x0) {
            iVar6 = 0;
        } else {
            if (*piVar5 == 0) {
                iVar6 = 0;
                puVar3 = blocking_children;
                do {
                    iVar6 = iVar6 + 1;
                    if (iVar6 == blocking_children_alloc) {
                        iVar6 = blocking_children_alloc * 4;
                        iVar7 = blocking_children_alloc + 4;
                        iVar4 = iVar6 + 0x10;
                        goto LAB_0007a07c;
                    }
                    puVar3 = puVar3 + 1;
                    piVar5 = (int *)*puVar3;
                    if (piVar5 == (int *)0x0)
                        goto LAB_0007a090;
                } while (*piVar5 == 0);
            } else {
                iVar6 = 0;
            }
            *piVar5 = 0;
        }
    }
LAB_0007a090:
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar6);
    }
    return;
}

void FUN_0007a0f4(undefined4 param_1, undefined4 param_2, int param_3,
                  undefined4 param_4, undefined4 param_5)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int local_34[3];
    int local_28;
    undefined4 local_24;
    undefined4 local_20;
    int local_1c;

    local_34[0] = param_3 + 0x18;
    local_1c = __stack_chk_guard;
    local_34[1] = 0x510c7ecf;
    local_20 = param_5;
    local_34[2] = param_1;
    local_24 = param_4;
    if (((worker_per_query == 0) && (DAT_000c8d78 != -1)) &&
        (**(int **)(blocking_children + DAT_000c8d78 * 4) == 0)) {
    LAB_0007a204:
        if (intres_req_pending != 0) {
            intres_req_pending = intres_req_pending + 1;
            iVar2 = DAT_000c8d78;
            goto LAB_0007a1b0;
        }
    LAB_0007a224:
        iVar2 = DAT_000c8d78;
        FUN_00051bb4(0);
    } else {
        iVar2 = FUN_00079fec();
        if (worker_per_query == 0) {
            if (DAT_000c8d78 != -1)
                goto LAB_0007a204;
            DAT_000c8d78 = iVar2;
            if (intres_req_pending != 0)
                goto LAB_0007a1a0;
            goto LAB_0007a224;
        }
    }
LAB_0007a1a0:
    intres_req_pending = intres_req_pending + 1;
    if (iVar2 == -1) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("ntp_worker.c", 0xc1, 2,
                     "(2147483647 * 2U + 1U) != child_slot");
    }
LAB_0007a1b0:
    iVar3 = *(int *)(blocking_children + iVar2 * 4);
    if (iVar3 == 0) {
        iVar3 = FUN_00074b04(0, 0x90, 0, 1);
        iVar1 = blocking_children;
        *(undefined4 *)(iVar3 + 0x34) = 0xffffffff;
        *(undefined4 *)(iVar3 + 0x38) = 0xffffffff;
        *(int *)(iVar1 + iVar2 * 4) = iVar3;
    }
    local_28 = iVar2;
    FUN_0007f494(iVar3, local_34, param_2);
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007a2c4(undefined4 param_1, undefined4 *param_2, undefined4 param_3,
                  int param_4)

{
    int iVar1;
    undefined4 uVar2;
    bool bVar3;

    uVar2 = *(undefined4 *)(param_4 + 8);
    param_2[1] = 0x510c7e54;
    param_2[2] = uVar2;
    iVar1 = __stack_chk_guard;
    *param_2 = param_3;
    uVar2 = *(undefined4 *)(param_4 + 0x10);
    bVar3 = iVar1 == __stack_chk_guard;
    param_2[5] = *(undefined4 *)(param_4 + 0x14);
    param_2[4] = uVar2;
    if (bVar3) {
        FUN_0007f674();
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007a330(undefined4 param_1)

{
    int iVar1;
    int *__ptr;

    iVar1 = __stack_chk_guard;
    __ptr = (int *)FUN_0007f8d4(param_1);
    while (__ptr != (int *)0x0) {
        intres_req_pending = intres_req_pending + -1;
        (*(code *)__ptr[4])(__ptr[2], __ptr[5], *__ptr + -0x18, __ptr + 6);
        free(__ptr);
        __ptr = (int *)FUN_0007f8d4(param_1);
    }
    if (worker_per_query == 0) {
        if (intres_req_pending == 0) {
            if (iVar1 == __stack_chk_guard) {
                FUN_00051bb4(0xb4);
                return;
            }
        } else if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        FUN_0007fa74(param_1);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007a438(void)

{
    int iVar1;
    int iVar2;
    uint uVar3;

    iVar1 = __stack_chk_guard;
    if (blocking_child_ready_done != blocking_child_ready_seen) {
        blocking_child_ready_done = blocking_child_ready_seen;
        if (blocking_children_alloc != 0) {
            uVar3 = 0;
            do {
                iVar2 = *(int *)(blocking_children + uVar3 * 4);
                if (iVar2 != 0) {
                    if (*(int *)(iVar2 + 0x48) != *(int *)(iVar2 + 0x44)) {
                        *(int *)(iVar2 + 0x48) = *(int *)(iVar2 + 0x44);
                        FUN_0007a330();
                    }
                }
                uVar3 = uVar3 + 1;
            } while (uVar3 < blocking_children_alloc);
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007a508(undefined4 param_1)

{
    int iVar1;
    void *__ptr;
    int iVar2;

    iVar1 = __stack_chk_guard;
    do {
        __ptr = (void *)FUN_0007f7fc(param_1);
        if (__ptr == (void *)0x0)
            break;
        if (*(int *)((int)__ptr + 8) == 0) {
            iVar2 = FUN_0007967c(param_1, __ptr);
            if (iVar2 != 0) {
                iVar2 = 1;
            }
        } else {
            if (*(int *)((int)__ptr + 8) != 1) {
                FUN_00075d40(3, "unknown req %d to blocking worker");
                free(__ptr);
                break;
            }
            iVar2 = FUN_00079110(param_1, __ptr);
            if (iVar2 != 0) {
                iVar2 = 1;
            }
        }
        free(__ptr);
    } while (iVar2 == 0);
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(0);
    }
    return;
}

void FUN_0007a5d4(void)

{
    int iVar1;
    uint uVar2;

    iVar1 = __stack_chk_guard;
    FUN_00051bb4(0);
    if (blocking_children_alloc != 0) {
        uVar2 = 0;
        do {
            if (*(int *)(blocking_children + uVar2 * 4) != 0) {
                FUN_0007fa74();
            }
            uVar2 = uVar2 + 1;
        } while (uVar2 < blocking_children_alloc);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

undefined1 *FUN_0007a66c(uint param_1)

{
    int iVar1;
    uint uVar2;
    undefined1 *__s;

    iVar1 = __stack_chk_guard;
    __s = lib_stringbuf + lib_nextbuf * 0x80;
    uVar2 = lib_nextbuf + 1;
    memset(__s, 0, 0x80);
    lib_nextbuf = uVar2 & 0xf;
    FUN_0007d00c(__s, 0x80, "%lu.%lu.%lu.%lu", param_1 & 0xff,
                 param_1 >> 8 & 0xff, param_1 >> 0x10 & 0xff, param_1 >> 0x18);
    if (iVar1 == __stack_chk_guard) {
        return __s;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007a72c(undefined4 param_1, int param_2)

{
    int iVar1;
    uint uVar2;
    int iVar3;
    char *__s;
    size_t sVar4;

    iVar3 = __stack_chk_guard;
    uVar2 = lib_nextbuf;
    if (param_2 < 2) {
        iVar1 = lib_nextbuf * 0x80;
        __s = lib_stringbuf + iVar1;
        memset(__s, 0, 0x80);
        lib_stringbuf[uVar2 * 0x80] = 0x2e;
        lib_stringbuf[iVar1 + 5] = 0;
        lib_nextbuf = uVar2 + 1 & 0xf;
        *(undefined4 *)(lib_stringbuf + iVar1 + 1) = param_1;
        sVar4 = strlen(__s);
        __s[sVar4] = '.';
        (__s + sVar4)[1] = '\0';
    } else {
        __s = (char *)FUN_0007a66c();
    }
    if (iVar3 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

void FUN_0007a7f4(uint *param_1, int param_2)

{
    tm *ptVar1;
    uint uVar2;
    uint uVar3;
    int iVar4;
    int iVar5;
    bool bVar6;
    uint local_30;
    int local_2c;

    uVar2 = *param_1;
    uVar3 = param_1[1];
    local_2c = __stack_chk_guard;
    local_30 = uVar2;
    if (uVar3 == (int)uVar2 >> 0x1f) {
        iVar4 = 0;
    } else {
        iVar5 = 0;
        do {
            while (-1 < (int)uVar3) {
                iVar4 = iVar5 + 1;
                if (3 < iVar4)
                    goto LAB_0007a94c;
                bVar6 = 0x34aadc7f < local_30;
                local_30 = local_30 + 0xcb552380;
                uVar3 = (uVar3 - 1) + (uint)bVar6;
                iVar5 = iVar4;
                if (uVar3 == (int)local_30 >> 0x1f)
                    goto LAB_0007a8b4;
            }
            iVar4 = iVar5 + -1;
            if (iVar5 + 2 < 0 != SCARRY4(iVar4, 3))
                goto LAB_0007a94c;
            bVar6 = 0xcb55237f < local_30;
            local_30 = local_30 + 0x34aadc80;
            uVar3 = uVar3 + bVar6;
            iVar5 = iVar4;
        } while (uVar3 != (int)local_30 >> 0x1f);
    }
LAB_0007a8b4:
    if (param_2 != 0)
        goto LAB_0007a90c;
    while (ptVar1 = gmtime((time_t *)&local_30), iVar5 = iVar4,
           ptVar1 == (tm *)0x0) {
        while (true) {
            uVar2 = local_30;
            if ((int)local_30 < 0) {
                iVar4 = iVar5 + -1;
                if (iVar5 + 2 < 0 != SCARRY4(iVar4, 3))
                    goto LAB_0007a94c;
                local_30 = local_30 + 0x34aadc80;
                goto LAB_0007a8b4;
            }
            if (((int)local_30 < 0x34aadc80) || (iVar4 = iVar5 + 1, 3 < iVar4))
                goto LAB_0007a94c;
            local_30 = local_30 + 0xcb552380;
            if (param_2 == 0)
                break;
        LAB_0007a90c:
            ptVar1 = localtime((time_t *)&local_30);
            iVar5 = iVar4;
            if (ptVar1 != (tm *)0x0)
                goto LAB_0007a924;
        }
    }
LAB_0007a924:
    if ((iVar4 != 0) &&
        (iVar4 = iVar4 * 0x1c + ptVar1->tm_year, ptVar1->tm_year = iVar4,
         uVar2 = local_30, 0xc6 < iVar4 - 1U)) {
    LAB_0007a94c:
        local_30 = uVar2;
        ptVar1 = (tm *)0x0;
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(ptVar1);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007ab9c) */
/* WARNING: Removing unreachable block (ram,0x0007ac60) */

void FUN_0007ac20(int *param_1)

{
    undefined4 *puVar1;
    int iVar2;
    uint uVar3;
    undefined1 *__s;
    undefined4 local_40;
    undefined4 uStack_3c;
    undefined4 local_38;
    undefined4 uStack_34;
    undefined2 local_30[2];
    byte local_2c;
    undefined1 local_2b;
    undefined1 local_2a;
    undefined1 local_29;
    undefined1 local_28;
    byte local_27;
    int local_24;

    local_24 = __stack_chk_guard;
    __s = lib_stringbuf + lib_nextbuf * 0x80;
    uVar3 = lib_nextbuf + 1 & 0xf;
    memset(__s, 0, 0x80);
    iVar2 = *param_1;
    lib_nextbuf = uVar3;
    if ((iVar2 == 0) && (param_1[1] == 0)) {
        FUN_0007e4b4(__s, "(no time)", 0x80);
    } else {
        uVar3 = (uint)param_1[1] / 0x418937;
        if (uVar3 == 1000) {
            iVar2 = iVar2 + 1;
            uVar3 = 0;
        }
        FUN_00076898(&local_40, iVar2, 0);
        local_38 = local_40;
        uStack_34 = uStack_3c;
        puVar1 = (undefined4 *)FUN_0007a7f4(&local_38, 0);
        if (puVar1 == (undefined4 *)0x0) {
            FUN_00076fb4(local_30, &local_38);
            FUN_0007d00c(__s, 0x80,
                         "%08lx.%08lx  %s, %s %2d %4d %2d:%02d:%02d.%03u",
                         *param_1, param_1[1],
                         *(undefined4 *)(daynames + (uint)local_27 * 4),
                         *(undefined4 *)(months + (local_2c - 1) * 4), local_2b,
                         local_30[0], local_2a, local_29, local_28, uVar3);
        } else {
            FUN_0007d00c(
                __s, 0x80, "%08lx.%08lx  %s, %s %2d %4d %2d:%02d:%02d.%03u",
                *param_1, param_1[1], *(undefined4 *)(daynames + puVar1[6] * 4),
                *(undefined4 *)(months + puVar1[4] * 4), puVar1[3],
                puVar1[5] + 0x76c, puVar1[2], puVar1[1], *puVar1, uVar3);
        }
    }
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

/* WARNING: Removing unreachable block (ram,0x0007ad1c) */

void FUN_0007acd8(void)

{
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007ad70) */

void FUN_0007ad2c(void)

{
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007adc4) */

void FUN_0007ad80(void)

{
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007ae18) */

void FUN_0007add4(void)

{
    return;
}

void FUN_0007ae28(int param_1)

{
    int iVar1;
    int *piVar2;
    int iVar3;
    int *piVar4;

    iVar1 = __stack_chk_guard;
    iVar3 = DAT_0011823c;
    DAT_00118234 = 0;
    DAT_0011822c = 0;
    DAT_00118238 = 0;
    DAT_00118230 = 0;
    DAT_0011823c = 0;
    param_1 = param_1 + iVar3;
    piVar2 = (int *)FUN_00074bcc(0, param_1, 0x8a4, 0);
    if (0 < param_1) {
        iVar3 = 0;
        piVar4 = piVar2;
        do {
            iVar3 = iVar3 + 1;
            DAT_0011822c = DAT_0011822c + 1;
            *piVar4 = (int)DAT_00118240;
            DAT_00118234 = DAT_00118234 + 1;
            DAT_00118240 = piVar4;
            piVar4 = piVar4 + 0x229;
        } while (param_1 != iVar3);
        DAT_00118240 = piVar2 + param_1 * 0x229 + -0x229;
    }
    DAT_00118238 = DAT_00118238 + 1;
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0007af28(undefined4 *param_1)

{
    int iVar1;
    undefined4 *puVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    if (param_1 != (undefined4 *)0x0) {
        iVar3 = param_1[0x228];
        param_1[0x228] = iVar3 + -1;
        if (iVar3 + -1 != 0) {
            FUN_00075d40(3, "******** freerecvbuff non-zero usage: %d *******");
        }
        DAT_0011822c = DAT_0011822c + 1;
        puVar2 = param_1;
        *param_1 = DAT_00118240;
        DAT_00118240 = puVar2;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007afc4(undefined4 *param_1)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if (param_1 == (undefined4 *)0x0) {
        FUN_00075d40(3, "add_full_recv_buffer received NULL buffer");
        return;
    }
    *param_1 = 0;
    if (DAT_00118248 == (undefined4 *)0x0) {
        DAT_00118248 = &DAT_00118244;
        DAT_00118244 = param_1;
    } else {
        *(undefined4 **)*DAT_00118248 = param_1;
        DAT_00118248 = (undefined4 *)*DAT_00118248;
    }
    DAT_00118230 = DAT_00118230 + 1;
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0007b088(void)

{
    undefined4 *__s;
    int iVar1;

    iVar1 = __stack_chk_guard;
    __s = DAT_00118240;
    if (DAT_00118240 == (undefined4 *)0x0) {
        DAT_0011823c = DAT_0011823c + 1;
    } else {
        DAT_00118240 = (undefined4 *)*DAT_00118240;
        DAT_0011822c = DAT_0011822c + -1;
        memset(__s, 0, 0x8a4);
        __s[0x228] = 1;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

/* WARNING: Removing unreachable block (ram,0x0007b1ac) */

void FUN_0007b124(void)

{
    undefined4 *puVar1;
    undefined4 *puVar2;

    if (DAT_00118244 != (undefined4 *)0x0) {
        puVar2 = (undefined4 *)*DAT_00118244;
        puVar1 = puVar2;
        if ((puVar2 != (undefined4 *)0x0) &&
            (puVar1 = DAT_00118248, DAT_00118248 == DAT_00118244)) {
            puVar1 = &DAT_00118244;
        }
        DAT_00118248 = puVar1;
        DAT_00118230 = DAT_00118230 + -1;
        DAT_00118244 = puVar2;
    }
    return;
}

void FUN_0007b1c0(int param_1)

{
    int *piVar1;
    int iVar2;
    int *piVar3;
    int *piVar4;
    int *piVar5;
    int iVar6;
    int *piVar7;

    iVar2 = __stack_chk_guard;
    piVar4 = DAT_00118244;
    if (DAT_00118244 != (int *)0x0) {
        do {
            while (piVar7 = (int *)*piVar4, piVar4[0x10] == param_1) {
                if (DAT_00118244 == piVar4) {
                    piVar5 = (int *)&DAT_00118244;
                } else {
                    piVar3 = (int *)*DAT_00118244;
                    piVar5 = DAT_00118244;
                    while (true) {
                        piVar1 = piVar3;
                        if (piVar1 == (int *)0x0) {
                            /* WARNING: Subroutine does not return */
                            FUN_0007fc54("recvbuff.c", 0x11d, 2,
                                         "punlinked == rbufp");
                        }
                        if (piVar4 == piVar1)
                            break;
                        piVar3 = (int *)*piVar1;
                        piVar5 = piVar1;
                    }
                }
                iVar6 = *piVar4;
                *piVar5 = iVar6;
                if (iVar6 == 0) {
                    DAT_00118248 = (int *)0x0;
                } else if (DAT_00118248 == piVar4) {
                    DAT_00118248 = (int *)&DAT_00118244;
                }
                DAT_00118230 = DAT_00118230 + -1;
                FUN_0007af28();
                piVar4 = piVar7;
                if (piVar7 == (int *)0x0)
                    goto LAB_0007b2a4;
            }
            piVar4 = piVar7;
        } while (piVar7 != (int *)0x0);
    }
LAB_0007b2a4:
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x0007b35c) */

void FUN_0007b310(void)

{
    return;
}

void FUN_0007b36c(short *param_1)

{
    uint uVar1;
    uint uVar2;
    int iVar3;
    int iVar4;
    uint uVar5;
    undefined1 *__s;

    iVar3 = __stack_chk_guard;
    if ((*param_1 != 2) || (param_1[2] != 0x7f7f)) {
        FUN_0007d2c0(param_1);
        return;
    }
    __s = lib_stringbuf + lib_nextbuf * 0x80;
    uVar5 = lib_nextbuf + 1;
    memset(__s, 0, 0x80);
    uVar1 = *(uint *)(param_1 + 2) >> 0x10 & 0xff;
    uVar2 = *(uint *)(param_1 + 2) >> 0x18;
    lib_nextbuf = uVar5 & 0xf;
    iVar4 = FUN_0008998c(uVar1);
    if (iVar4 == 0) {
        FUN_0007d00c(__s, 0x80, "REFCLK(%lu,%lu)", uVar1, uVar2);
    } else {
        FUN_0007d00c(__s, 0x80, "%s(%lu)", iVar4, uVar2);
    }
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__s);
    }
    return;
}

void FUN_0007b490(int param_1, uint *param_2, uint param_3, char *param_4,
                  uint param_5, int param_6, uint param_7)

{
    int iVar1;
    uint uVar2;
    char cVar3;
    int iVar4;
    char *pcVar5;
    int iVar6;
    uint uVar7;
    uint uVar8;

    iVar1 = __stack_chk_guard;
    uVar2 = (uint)(param_6 == -1);
    if (param_4 == (char *)0x0) {
        param_4 = "(null)";
    }
    cVar3 = *param_4;
    if (cVar3 == '\0') {
        uVar7 = -(param_7 & 1);
        if (-1 < (int)param_5) {
            uVar7 = uVar7 ^ param_5;
        }
        iVar6 = uVar7 + (param_7 & 1);
        if (0 < iVar6)
            goto LAB_0007b540;
    } else {
        uVar7 = uVar2;
        if (0 < param_6) {
            uVar7 = 1;
        }
        if (uVar7 != 0) {
            uVar7 = 0;
            pcVar5 = param_4;
            do {
                pcVar5 = pcVar5 + 1;
                uVar7 = uVar7 + 1;
                if (*pcVar5 == '\0')
                    break;
                uVar8 = uVar2;
                if ((int)uVar7 < param_6) {
                    uVar8 = 1;
                }
            } while (uVar8 != 0);
        }
        uVar8 = -(param_7 & 1);
        if (-1 < (int)(param_5 - uVar7)) {
            uVar8 = uVar8 ^ param_5 - uVar7;
        }
        iVar6 = uVar8 + (param_7 & 1);
        if (0 < iVar6) {
        LAB_0007b540:
            uVar7 = *param_2;
            do {
                uVar8 = uVar7 + 1;
                if (uVar8 < param_3) {
                    *(undefined1 *)(param_1 + uVar7) = 0x20;
                    uVar8 = *param_2 + 1;
                }
                iVar6 = iVar6 + -1;
                *param_2 = uVar8;
                uVar7 = uVar8;
            } while (iVar6 != 0);
            cVar3 = *param_4;
            iVar6 = 0;
            if (cVar3 == '\0')
                goto LAB_0007b5e8;
        }
        do {
            iVar4 = param_6;
            if ((uVar2 == 0) && (iVar4 = param_6 + -1, param_6 < 1))
                break;
            uVar7 = *param_2 + 1;
            if (uVar7 < param_3) {
                *(char *)(param_1 + *param_2) = cVar3;
                uVar7 = *param_2 + 1;
            }
            *param_2 = uVar7;
            param_4 = param_4 + 1;
            cVar3 = *param_4;
            param_6 = iVar4;
        } while (cVar3 != '\0');
    }
    if (iVar6 != 0) {
        uVar2 = *param_2;
        do {
            uVar7 = uVar2 + 1;
            if (uVar7 < param_3) {
                *(undefined1 *)(param_1 + uVar2) = 0x20;
                uVar7 = *param_2 + 1;
            }
            iVar6 = iVar6 + 1;
            *param_2 = uVar7;
            uVar2 = uVar7;
        } while (iVar6 != 0);
    }
LAB_0007b5e8:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0007b63c(int param_1, uint *param_2, uint param_3, undefined4 param_4,
                  uint param_5, uint param_6, int param_7, int param_8,
                  uint param_9, uint param_10)

{
    byte bVar1;
    int iVar2;
    uint uVar3;
    uint uVar4;
    int extraout_r2;
    uint uVar5;
    undefined4 uVar6;
    undefined4 uVar7;
    uint uVar8;
    char *pcVar9;
    char *pcVar10;
    uint uVar11;
    uint uVar12;
    undefined8 uVar13;
    longlong lVar14;
    uint local_8c;
    uint local_88;
    uint uStack_84;
    int local_6c;
    undefined1 local_68;
    char acStack_61[45];
    int local_34;

    local_8c = param_10 & 0x20;
    local_34 = __stack_chk_guard;
    if ((param_10 & 0x80) == 0) {
        uVar8 = (int)param_6 >> 0x1f;
        local_88 = (uVar8 ^ param_5) - uVar8;
        uStack_84 = (uVar8 ^ param_6) - (uVar8 + ((uVar8 ^ param_5) < uVar8));
        if ((int)param_6 < 0) {
            local_68 = 0x2d;
            local_6c = 1;
        } else if ((param_10 & 2) == 0) {
            if ((param_10 & 4) == 0) {
                local_6c = 0;
                local_68 = 0;
            } else {
                local_68 = 0x20;
                local_6c = 1;
            }
        } else {
            local_68 = 0x2b;
            local_6c = 1;
        }
    } else {
        local_88 = param_5;
        uStack_84 = param_6;
        local_6c = 0;
        local_68 = 0;
    }
    lVar14 = CONCAT44(uStack_84, local_88);
    if ((param_10 & 0x40) == 0) {
        pcVar10 = "0123456789abcdef";
    } else {
        pcVar10 = "0123456789ABCDEF";
    }
    uVar13 = VectorShiftRight(CONCAT44(param_7, param_7), 0x20);
    uVar8 = 0;
    pcVar9 = acStack_61 + 1;
    do {
        uVar3 = uVar8;
        uVar7 = (undefined4)((ulonglong)lVar14 >> 0x20);
        uVar6 = (undefined4)((ulonglong)uVar13 >> 0x20);
        uVar8 = uVar3 + 1;
        FUN_0009d518((int)lVar14, uVar7, (int)uVar13, uVar6);
        *pcVar9 = pcVar10[extraout_r2];
        lVar14 = FUN_0009d518((int)lVar14, uVar7, (int)uVar13, uVar6);
        pcVar9 = pcVar9 + 1;
    } while (uVar8 < 0x2b && lVar14 != 0);
    uVar5 = (param_10 << 0x1c) >> 0x1f;
    if (local_88 == 0 && uStack_84 == 0) {
        uVar5 = 0;
    }
    uVar11 = param_9;
    if (uVar5 != 0) {
        uVar5 = 0;
        if (param_7 == 8) {
            if ((int)param_9 <= (int)uVar8) {
                uVar11 = uVar3 + 2;
            }
        } else if (param_7 == 0x10) {
            if ((param_10 & 0x40) == 0) {
                uVar5 = 0x78;
            } else {
                uVar5 = 0x58;
            }
        }
    }
    if (local_8c != 0) {
        local_8c = uVar8;
        if (uVar8 == ((int)uVar8 / 3) * 3) {
            local_8c = uVar3;
        }
        local_8c = (int)local_8c / 3;
    }
    iVar2 = uVar11 - uVar8;
    if ((int)uVar11 < (int)uVar8) {
        uVar11 = uVar8;
    }
    uVar3 = iVar2 - local_8c;
    if (uVar5 == 0) {
        iVar2 = 0;
    } else {
        iVar2 = 2;
    }
    uVar11 = (((param_8 - local_8c) - uVar11) - local_6c) - iVar2;
    uVar3 = uVar3 & ~((int)uVar3 >> 0x1f);
    uVar11 = uVar11 & ~((int)uVar11 >> 0x1f);
    if ((param_10 & 1) == 0) {
        if (((uint)(param_9 == 0xffffffff) & param_10 >> 4) == 0) {
            if (0 < (int)uVar11) {
                uVar4 = *param_2;
                do {
                    uVar12 = uVar4 + 1;
                    if (uVar12 < param_3) {
                        *(undefined1 *)(param_1 + uVar4) = 0x20;
                        uVar12 = *param_2 + 1;
                    }
                    uVar11 = uVar11 - 1;
                    *param_2 = uVar12;
                    uVar4 = uVar12;
                } while (uVar11 != 0);
            }
        } else {
            uVar3 = uVar3 + uVar11;
            uVar11 = 0;
        }
    } else {
        uVar11 = -uVar11;
    }
    if (local_6c != 0) {
        uVar4 = *param_2 + 1;
        if (uVar4 < param_3) {
            *(undefined1 *)(param_1 + *param_2) = local_68;
            uVar4 = *param_2 + 1;
        }
        *param_2 = uVar4;
    }
    if (uVar5 != 0) {
        uVar4 = *param_2;
        uVar12 = uVar4 + 1;
        if (uVar12 < param_3) {
            *(undefined1 *)(param_1 + uVar4) = 0x30;
            uVar4 = *param_2;
            uVar12 = uVar4 + 1;
        }
        *param_2 = uVar12;
        if (uVar4 + 2 < param_3) {
            *(char *)(param_1 + uVar12) = (char)uVar5;
            uVar12 = *param_2;
        }
        *param_2 = uVar12 + 1;
    }
    if (uVar3 != 0) {
        uVar5 = *param_2;
        do {
            uVar4 = uVar5 + 1;
            if (uVar4 < param_3) {
                *(undefined1 *)(param_1 + uVar5) = 0x30;
                uVar4 = *param_2 + 1;
            }
            uVar3 = uVar3 - 1;
            *param_2 = uVar4;
            uVar5 = uVar4;
        } while (uVar3 != 0);
    }
    if (0 < (int)uVar8) {
        if ((int)local_8c < 1) {
            bVar1 = 0;
        } else {
            bVar1 = 1;
        }
        do {
            while (true) {
                uVar3 = *param_2;
                uVar8 = uVar8 - 1;
                uVar5 = uVar3 + 1;
                if (uVar5 < param_3) {
                    *(char *)(param_1 + uVar3) = (acStack_61 + 1)[uVar8];
                    uVar3 = *param_2;
                    uVar5 = uVar3 + 1;
                }
                *param_2 = uVar5;
                if (!(bool)(0 < (int)uVar8 & bVar1))
                    break;
                if (uVar8 == ((int)uVar8 / 3) * 3) {
                    if (uVar3 + 2 < param_3) {
                        *(undefined1 *)(param_1 + uVar5) = 0x2c;
                        uVar5 = *param_2;
                    }
                    *param_2 = uVar5 + 1;
                }
            }
        } while (0 < (int)uVar8);
    }
    if (uVar11 != 0) {
        uVar8 = *param_2;
        do {
            uVar3 = uVar8 + 1;
            if (uVar3 < param_3) {
                *(undefined1 *)(param_1 + uVar8) = 0x20;
                uVar3 = *param_2 + 1;
            }
            uVar11 = uVar11 + 1;
            *param_2 = uVar3;
            uVar8 = uVar3;
        } while (uVar11 != 0);
    }
    if (local_34 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007bb70) */
/* WARNING: Removing unreachable block (ram,0x0007bcf0) */
/* WARNING: Removing unreachable block (ram,0x0007bd10) */
/* WARNING: Removing unreachable block (ram,0x0007bd18) */
/* WARNING: Removing unreachable block (ram,0x0007bd1c) */
/* WARNING: Removing unreachable block (ram,0x0007bd20) */
/* WARNING: Removing unreachable block (ram,0x0007bb7c) */
/* WARNING: Removing unreachable block (ram,0x0007bd24) */

void FUN_0007baf0(int param_1, uint *param_2, uint param_3, int param_4,
                  uint param_5, uint param_6, undefined4 *param_7)

{
    byte bVar1;
    uint uVar2;
    char *pcVar3;
    uint uVar4;
    undefined4 uVar5;
    char *pcVar6;
    int iVar7;
    int extraout_r2;
    int extraout_r2_00;
    uint uVar8;
    int extraout_r2_01;
    int extraout_r2_02;
    char cVar9;
    uint uVar10;
    int iVar11;
    undefined1 uVar12;
    uint uVar13;
    uint uVar14;
    bool bVar15;
    double in_d0;
    double dVar16;
    double dVar17;
    undefined8 uVar18;
    double dVar19;
    double dVar20;
    longlong lVar21;
    longlong lVar22;
    longlong lVar23;
    char *local_f0;
    int local_e4;
    uint local_d8;
    uint local_d4;
    uint local_d0;
    int local_c8;
    undefined4 local_bc;
    char local_b8;
    char local_b7;
    undefined1 local_b6;
    char local_b5[44];
    char acStack_89[45];
    int local_5c;

    if (param_5 == 0xffffffff) {
        param_5 = 6;
    }
    local_5c = __stack_chk_guard;
    if (in_d0 < 0.0) {
        local_e4 = 0x2d;
    LAB_0007bc2c:
        if (in_d0 + in_d0 == in_d0) {
            if ((param_6 & 0x40) == 0) {
                pcVar6 = "inf";
            } else {
                pcVar6 = "INF";
            }
            if (local_e4 != 0) {
                local_b5[1] = (undefined1)local_e4;
            }
            uVar2 = (uint)(local_e4 != 0);
            cVar9 = *pcVar6;
            if (cVar9 != '\0') {
                pcVar3 = local_b5 + uVar2;
                do {
                    pcVar3 = pcVar3 + 1;
                    *pcVar3 = cVar9;
                    uVar2 = uVar2 + 1;
                    pcVar6 = pcVar6 + 1;
                    cVar9 = *pcVar6;
                } while (cVar9 != '\0');
            }
            local_f0 = local_b5 + 1;
            FUN_0007b490(param_1, param_2, param_3, local_f0, param_4, uVar2,
                         param_6);
        LAB_0007bc00:
            if (local_5c == __stack_chk_guard) {
                return;
            }
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
    } else {
        if ((param_6 & 2) == 0) {
            if ((param_6 & 4) == 0) {
                local_e4 = 0;
            } else {
                local_e4 = 0x20;
            }
        } else {
            local_e4 = 0x2b;
        }
        if (in_d0 != 0.0)
            goto LAB_0007bc2c;
    }
    if ((param_6 & 0x300) == 0) {
        dVar17 = -in_d0;
        if (0.0 <= in_d0) {
            dVar17 = in_d0;
        }
        if (0x12 < (int)param_5) {
            param_5 = 0x13;
        }
        uVar2 = param_6 & 0x200;
        if (uVar2 == 0) {
            iVar11 = 0;
            local_d4 = 0;
            dVar19 = dVar17;
            goto LAB_0007bcac;
        }
        iVar11 = 0;
        local_d4 = 0;
    LAB_0007bca4:
        dVar16 = 1.0;
        dVar19 = dVar17;
    } else {
        if ((param_6 & 0x100) == 0) {
            local_d4 = 0;
        } else {
            param_5 = param_5 - 1;
            local_d4 = (uint)((param_6 & 8) == 0);
        }
        dVar17 = -in_d0;
        if (0.0 <= in_d0) {
            dVar17 = in_d0;
        }
        if ((1.0 <= dVar17) || (dVar17 <= 0.0)) {
            iVar11 = 0;
        } else {
            iVar11 = -1;
            do {
                dVar17 = dVar17 * 10.0;
                if ((1.0 <= dVar17) || (dVar17 <= 0.0)) {
                    if (dVar17 < 10.0)
                        goto LAB_0007bde8;
                    goto LAB_0007bdc4;
                }
                iVar11 = iVar11 + -1;
            } while (iVar11 != -99);
        }
        if (10.0 <= dVar17) {
        LAB_0007bdc4:
            iVar11 = iVar11 + 1;
            do {
                dVar17 = dVar17 / 10.0;
                if (dVar17 < 10.0)
                    break;
                iVar11 = iVar11 + 1;
            } while (iVar11 < 99);
        }
    LAB_0007bde8:
        uVar2 = 1;
        dVar17 = -in_d0;
        if (0.0 <= in_d0) {
            dVar17 = in_d0;
        }
        if (0x12 < (int)param_5) {
            param_5 = 0x13;
        }
        dVar19 = dVar17;
        if (iVar11 < 1) {
            if (iVar11 == 0)
                goto LAB_0007bca4;
            dVar16 = 1.0;
            iVar7 = iVar11;
            do {
                iVar7 = iVar7 + 1;
                dVar16 = dVar16 / 10.0;
            } while (iVar7 != 0);
        } else {
            dVar16 = 1.0;
            iVar7 = iVar11;
            do {
                iVar7 = iVar7 + -1;
                dVar16 = dVar16 * 10.0;
            } while (iVar7 != 0);
        }
    }
    dVar17 = dVar19 / dVar16;
LAB_0007bcac:
LAB_0007bcd4:
    if (1.8446744073709552e+19 <= dVar17)
        goto LAB_0007bce0;
    lVar21 = FUN_0009d558(SUB84(dVar17, 0), (int)((ulonglong)dVar17 >> 0x20));
    dVar16 = (double)FUN_0009d40c();
    if (dVar17 < dVar16) {
        lVar21 = CONCAT44((int)((ulonglong)lVar21 >> 0x20) -
                              (uint)((int)lVar21 == 0),
                          (int)lVar21 + -1);
    }
    iVar7 = (int)lVar21;
    if (lVar21 == -1)
        goto LAB_0007bce0;
    if ((int)param_5 < 1) {
        dVar16 = 1.0;
        for (uVar10 = param_5; uVar10 != 0; uVar10 = uVar10 + 1) {
            dVar16 = dVar16 / 10.0;
        }
    } else {
        dVar16 = 1.0;
        uVar10 = param_5;
        do {
            uVar10 = uVar10 - 1;
            dVar16 = dVar16 * 10.0;
        } while (uVar10 != 0);
    }
    lVar22 = FUN_0009d558(SUB84(dVar16, 0), (int)((ulonglong)dVar16 >> 0x20));
    uVar10 = (uint)((ulonglong)lVar22 >> 0x20);
    dVar16 = (double)FUN_0009d40c();
    dVar20 = (double)FUN_0009d40c(iVar7, (int)((ulonglong)lVar21 >> 0x20));
    dVar16 = dVar16 * (dVar17 - dVar20);
    if (1.8446744073709552e+19 <= dVar16) {
        if (0.5 <= dVar16 - 1.8446744073709552e+19) {
            lVar23 = 0;
            goto LAB_0007bf0c;
        }
    LAB_0007bf1c:
        lVar22 = lVar21 + 1;
        lVar21 = lVar21 + 1;
        if (uVar2 == 0 ||
            ((int)((ulonglong)lVar22 >> 0x20) != 0 || iVar7 != 9)) {
            lVar23 = 0;
        } else {
            iVar11 = iVar11 + 1;
            lVar23 = 0;
            lVar21 = 1;
        }
    } else {
        lVar23 =
            FUN_0009d558(SUB84(dVar16, 0), (int)((ulonglong)dVar16 >> 0x20));
        dVar17 = (double)FUN_0009d40c();
        if (dVar16 < dVar17) {
            lVar23 = CONCAT44((int)((ulonglong)lVar23 >> 0x20) -
                                  (uint)((int)lVar23 == 0),
                              (int)lVar23 + -1);
            dVar17 = (double)FUN_0009d40c();
        }
        if (0.5 <= dVar16 - dVar17) {
            lVar23 = lVar23 + 1;
        }
    LAB_0007bf0c:
        uVar14 = (uint)((ulonglong)lVar23 >> 0x20);
        bVar15 = uVar14 <= uVar10;
        if (uVar10 == uVar14) {
            bVar15 = (uint)lVar23 <= (uint)lVar22;
        }
        if (!bVar15 || lVar22 == lVar23)
            goto LAB_0007bf1c;
    }
    if (((param_6 & 0x100) != 0) && (uVar2 != 0 && iVar11 <= (int)param_5)) {
        if (iVar11 + 4 < 0 != SCARRY4(iVar11, 4)) {
        LAB_0007c38c:
            iVar11 = -iVar11;
            uVar12 = 0x2d;
            goto LAB_0007c394;
        }
        param_5 = param_5 - iVar11;
        uVar2 = 0;
        dVar17 = dVar19;
        if (0x12 < (int)param_5) {
            param_5 = 0x13;
        }
        goto LAB_0007bcd4;
    }
    if (uVar2 == 0) {
        local_c8 = 0;
    } else {
        if (iVar11 < 0)
            goto LAB_0007c38c;
        uVar12 = 0x2b;
    LAB_0007c394:
        uVar18 = VectorShiftRight(CONCAT44(iVar11, iVar11), 0x20);
        uVar5 = (undefined4)((ulonglong)uVar18 >> 0x20);
        FUN_0009d518((int)uVar18, uVar5, 10, 0);
        local_b8 = "0123456789abcdef"[extraout_r2_01];
        lVar22 = FUN_0009d518((int)uVar18, uVar5, 10, 0);
        if (lVar22 == 0) {
            local_b7 = '0';
        } else {
            FUN_0009d518((int)lVar22, (int)((ulonglong)lVar22 >> 0x20), 10, 0);
            local_b7 = "0123456789abcdef"[extraout_r2_02];
        }
        local_c8 = 4;
        local_b6 = uVar12;
        if ((param_6 & 0x40) == 0) {
            local_b5[0] = 'e';
        } else {
            local_b5[0] = 'E';
        }
    }
    pcVar6 = local_b5 + 1;
    uVar2 = 0;
    do {
        uVar10 = uVar2;
        uVar5 = (undefined4)((ulonglong)lVar21 >> 0x20);
        FUN_0009d518((int)lVar21, uVar5, 10, 0);
        uVar2 = uVar10 + 1;
        *pcVar6 = "0123456789abcdef"[extraout_r2];
        lVar21 = FUN_0009d518((int)lVar21, uVar5, 10, 0);
        pcVar6 = pcVar6 + 1;
    } while (uVar2 < 0x2b && lVar21 != 0);
    if (lVar23 == 0) {
        if (local_d4 == 0) {
            local_d0 = local_d4;
            uVar14 = param_5;
            local_d8 = param_5;
            goto LAB_0007c17c;
        }
        local_d0 = 0;
    LAB_0007c44c:
        uVar14 = 0;
        local_d8 = 0;
    LAB_0007c45c:
        local_d4 = (param_6 << 0x1c) >> 0x1f;
    } else {
        pcVar6 = acStack_89;
        local_d0 = 0;
        local_bc = param_5;
        do {
            pcVar6 = pcVar6 + 1;
            uVar5 = (undefined4)((ulonglong)lVar23 >> 0x20);
            FUN_0009d518((int)lVar23, uVar5, 10, 0);
            local_d0 = local_d0 + 1;
            *pcVar6 = "0123456789abcdef"[extraout_r2_00];
            lVar23 = FUN_0009d518((int)lVar23, uVar5, 10, 0);
        } while (local_d0 < 0x2b && lVar23 != 0);
        uVar14 = local_bc - local_d0;
        local_d8 = param_5;
        if (local_d4 != 0) {
            param_5 = local_bc;
            if ((int)local_d0 < 1)
                goto LAB_0007c44c;
            pcVar6 = acStack_89;
            local_d4 = 0;
            do {
                pcVar6 = pcVar6 + 1;
                if (*pcVar6 != '0') {
                    local_d8 = local_bc - local_d4;
                    break;
                }
                local_d4 = local_d4 + 1;
                local_d8 = uVar14;
            } while (local_d4 != local_d0);
        }
    LAB_0007c17c:
        param_5 = local_d4;
        if ((int)local_d8 < 1)
            goto LAB_0007c45c;
        local_d4 = 1;
    }
    uVar13 = param_6 & 0x20;
    if (uVar13 != 0) {
        uVar13 = uVar2;
        if (uVar2 == ((int)uVar2 / 3) * 3) {
            uVar13 = uVar10;
        }
        uVar13 = (int)uVar13 / 3;
    }
    iVar11 = local_e4;
    if (local_e4 != 0) {
        iVar11 = 1;
    }
    uVar10 =
        (((((param_4 - uVar2) - local_c8) - local_d8) - uVar13) - local_d4) -
        iVar11;
    uVar10 = uVar10 & ~((int)uVar10 >> 0x1f);
    if ((param_6 & 1) == 0) {
        if ((param_6 & 0x10) == 0) {
            if (0 < (int)uVar10) {
                uVar8 = *param_2;
                do {
                    uVar4 = uVar8 + 1;
                    if (uVar4 < param_3) {
                        *(undefined1 *)(param_1 + uVar8) = 0x20;
                        uVar4 = *param_2 + 1;
                    }
                    uVar10 = uVar10 - 1;
                    *param_2 = uVar4;
                    uVar8 = uVar4;
                } while (uVar10 != 0);
                uVar10 = 0;
            }
        } else {
            if (uVar10 != 0) {
                if (iVar11 == 0) {
                    uVar8 = *param_2;
                } else {
                    uVar8 = *param_2 + 1;
                    if (uVar8 < param_3) {
                        *(char *)(param_1 + *param_2) = (char)local_e4;
                        uVar8 = *param_2 + 1;
                    }
                    *param_2 = uVar8;
                }
                do {
                    uVar4 = uVar8 + 1;
                    if (uVar4 < param_3) {
                        *(undefined1 *)(param_1 + uVar8) = 0x30;
                        uVar4 = *param_2 + 1;
                    }
                    uVar10 = uVar10 - 1;
                    *param_2 = uVar4;
                    uVar8 = uVar4;
                } while (uVar10 != 0);
                local_e4 = 0;
            }
            uVar10 = 0;
        }
    } else {
        uVar10 = -uVar10;
    }
    if (local_e4 != 0) {
        uVar8 = *param_2 + 1;
        if (uVar8 < param_3) {
            *(char *)(param_1 + *param_2) = (char)local_e4;
            uVar8 = *param_2 + 1;
        }
        *param_2 = uVar8;
    }
    if (0 < (int)uVar2) {
        if ((int)uVar13 < 1) {
            bVar1 = 0;
        } else {
            bVar1 = 1;
        }
        do {
            while (true) {
                uVar13 = *param_2;
                uVar2 = uVar2 - 1;
                uVar8 = uVar13 + 1;
                if (uVar8 < param_3) {
                    *(char *)(param_1 + uVar13) = (local_b5 + 1)[uVar2];
                    uVar13 = *param_2;
                    uVar8 = uVar13 + 1;
                }
                *param_2 = uVar8;
                if (!(bool)(0 < (int)uVar2 & bVar1))
                    break;
                if (uVar2 == ((int)uVar2 / 3) * 3) {
                    if (uVar13 + 2 < param_3) {
                        *(undefined1 *)(param_1 + uVar8) = 0x2c;
                        uVar8 = *param_2;
                    }
                    *param_2 = uVar8 + 1;
                }
            }
        } while (0 < (int)uVar2);
    }
    if (local_d4 != 0) {
        uVar2 = *param_2 + 1;
        if (uVar2 < param_3) {
            *(undefined1 *)(param_1 + *param_2) = 0x2e;
            uVar2 = *param_2 + 1;
        }
        *param_2 = uVar2;
    }
    if (0 < (int)uVar14) {
        uVar2 = *param_2;
        do {
            uVar13 = uVar2 + 1;
            if (uVar13 < param_3) {
                *(undefined1 *)(param_1 + uVar2) = 0x30;
                uVar13 = *param_2 + 1;
            }
            uVar14 = uVar14 - 1;
            *param_2 = uVar13;
            uVar2 = uVar13;
        } while (uVar14 != 0);
    }
    if ((int)param_5 < (int)local_d0) {
        pcVar6 = acStack_89 + local_d0;
        uVar2 = *param_2;
        do {
            uVar14 = uVar2 + 1;
            pcVar3 = pcVar6 + -1;
            if (uVar14 < param_3) {
                *(char *)(param_1 + uVar2) = *pcVar6;
                uVar14 = *param_2 + 1;
            }
            *param_2 = uVar14;
            pcVar6 = pcVar3;
            uVar2 = uVar14;
        } while (pcVar3 != acStack_89 + param_5);
    }
    if (local_c8 != 0) {
        uVar2 = *param_2;
        do {
            uVar14 = uVar2 + 1;
            iVar11 = local_c8 + -1;
            if (uVar14 < param_3) {
                *(undefined1 *)(param_1 + uVar2) =
                    *(undefined1 *)((int)&local_bc + local_c8 + 3);
                uVar14 = *param_2 + 1;
            }
            *param_2 = uVar14;
            local_c8 = iVar11;
            uVar2 = uVar14;
        } while (iVar11 != 0);
    }
    if (uVar10 != 0) {
        uVar2 = *param_2;
        do {
            uVar14 = uVar2 + 1;
            if (uVar14 < param_3) {
                *(undefined1 *)(param_1 + uVar2) = 0x20;
                uVar14 = *param_2 + 1;
            }
            uVar10 = uVar10 + 1;
            *param_2 = uVar14;
            uVar2 = uVar14;
        } while (uVar10 != 0);
    }
    goto LAB_0007bc00;
LAB_0007bce0:
    *param_7 = 1;
    goto LAB_0007bc00;
}

void FUN_0007c654(int param_1, uint param_2, char *param_3, uint *param_4)

{
    uint uVar1;
    int *piVar2;
    uint uVar3;
    uint uVar4;
    uint *puVar5;
    char cVar6;
    undefined4 uVar7;
    undefined8 *puVar8;
    int iVar9;
    uint unaff_r6;
    uint uVar10;
    uint uVar11;
    uint uVar12;
    uint local_34;
    int local_30;
    int local_2c;

    if (param_2 == 0 || param_1 != 0) {
        unaff_r6 = param_2;
    }
    if (param_2 != 0 && param_1 == 0) {
        unaff_r6 = 0;
    }
    local_2c = __stack_chk_guard;
    local_34 = 0;
    uVar1 = 0;
    local_30 = 0;
    cVar6 = *param_3;
    param_3 = param_3 + 1;
    uVar3 = 0xffffffff;
    uVar10 = 0;
    uVar11 = 0;
    uVar12 = 0;
LAB_0007c6dc:
    if (cVar6 != '\0') {
        do {
            uVar4 = local_34;
            switch (uVar11) {
            case 0:
                goto LAB_0007ca38;
            case 1:
                switch (cVar6) {
                case ' ':
                    cVar6 = *param_3;
                    uVar12 = uVar12 | 4;
                    param_3 = param_3 + 1;
                    goto LAB_0007c6dc;
                case '!':
                    break;
                case '\"':
                    break;
                case '#':
                    cVar6 = *param_3;
                    uVar12 = uVar12 | 8;
                    param_3 = param_3 + 1;
                    goto LAB_0007c6dc;
                case '$':
                    break;
                case '%':
                    break;
                case '&':
                    break;
                case '\'':
                    cVar6 = *param_3;
                    uVar12 = uVar12 | 0x20;
                    param_3 = param_3 + 1;
                    goto LAB_0007c6dc;
                case '(':
                    break;
                case ')':
                    break;
                case '*':
                    break;
                case '+':
                    cVar6 = *param_3;
                    uVar12 = uVar12 | 2;
                    param_3 = param_3 + 1;
                    goto LAB_0007c6dc;
                case ',':
                    break;
                case '-':
                    uVar12 = uVar12 | 1;
                    goto LAB_0007ca58;
                case '.':
                    break;
                case '/':
                    break;
                case '0':
                    cVar6 = *param_3;
                    uVar12 = uVar12 | 0x10;
                    param_3 = param_3 + 1;
                    goto LAB_0007c6dc;
                }
                uVar11 = 2;
                goto LAB_0007c6dc;
            case 2:
                uVar4 = (uint)(byte)(cVar6 - 0x30);
                if (uVar4 < 10) {
                    if ((int)uVar1 <= (int)(0x7fffffff - uVar4) / 10) {
                        cVar6 = *param_3;
                        param_3 = param_3 + 1;
                        uVar1 = uVar4 + uVar1 * 10;
                        goto LAB_0007c6dc;
                    }
                LAB_0007cf3c:
                    local_30 = 1;
                    goto LAB_0007c990;
                }
                if (cVar6 == '*') {
                    uVar1 = *param_4;
                    uVar11 = 3;
                    cVar6 = *param_3;
                    param_4 = param_4 + 1;
                    param_3 = param_3 + 1;
                    if ((int)uVar1 < 0) {
                        uVar12 = uVar12 | 1;
                        uVar1 = -uVar1;
                    }
                } else {
                    uVar11 = 3;
                }
                goto LAB_0007c6dc;
            case 3:
                if (cVar6 == '.') {
                    cVar6 = *param_3;
                    uVar11 = 4;
                    param_3 = param_3 + 1;
                } else {
                LAB_0007c9e8:
                    uVar11 = 5;
                }
                goto LAB_0007c6dc;
            case 4:
                uVar4 = (uint)(byte)(cVar6 - 0x30);
                if (uVar3 != 0xffffffff) {
                    if (uVar4 < 10) {
                        if ((int)uVar3 <= (int)(0x7fffffff - uVar4) / 10) {
                            uVar3 = uVar3 * 10;
                            goto LAB_0007c978;
                        }
                        goto LAB_0007cf3c;
                    }
                LAB_0007ccb4:
                    if (cVar6 != '*')
                        goto LAB_0007c9e8;
                    uVar3 = *param_4;
                    uVar11 = 5;
                    cVar6 = *param_3;
                    param_4 = param_4 + 1;
                    param_3 = param_3 + 1;
                    uVar3 = uVar3 | (int)uVar3 >> 0x1f;
                    goto LAB_0007c6dc;
                }
                uVar3 = 0;
                if (9 < uVar4)
                    goto LAB_0007ccb4;
            LAB_0007c978:
                cVar6 = *param_3;
                uVar3 = uVar3 + uVar4;
                param_3 = param_3 + 1;
                if (cVar6 == '\0')
                    goto LAB_0007c990;
                break;
            case 5:
                switch (cVar6) {
                case 'L':
                    cVar6 = *param_3;
                    uVar11 = 6;
                    param_3 = param_3 + 1;
                    uVar10 = 5;
                    goto LAB_0007c6dc;
                case 'M':
                    break;
                case 'N':
                    break;
                case 'O':
                    break;
                case 'P':
                    break;
                case 'Q':
                    break;
                case 'R':
                    break;
                case 'S':
                    break;
                case 'T':
                    break;
                case 'U':
                    break;
                case 'V':
                    break;
                case 'W':
                    break;
                case 'X':
                    break;
                case 'Y':
                    break;
                case 'Z':
                    break;
                case '[':
                    break;
                case '\\':
                    break;
                case ']':
                    break;
                case '^':
                    break;
                case '_':
                    break;
                case '`':
                    break;
                case 'a':
                    break;
                case 'b':
                    break;
                case 'c':
                    break;
                case 'd':
                    break;
                case 'e':
                    break;
                case 'f':
                    break;
                case 'g':
                    break;
                case 'h':
                    cVar6 = *param_3;
                    if (cVar6 == 'h') {
                        cVar6 = param_3[1];
                        param_3 = param_3 + 2;
                        uVar10 = 1;
                    } else {
                        param_3 = param_3 + 1;
                        uVar10 = 2;
                    }
                    uVar11 = 6;
                    goto LAB_0007c6dc;
                case 'i':
                    break;
                case 'j':
                    cVar6 = *param_3;
                    uVar11 = 6;
                    param_3 = param_3 + 1;
                    uVar10 = 8;
                    goto LAB_0007c6dc;
                case 'k':
                    break;
                case 'l':
                    cVar6 = *param_3;
                    if (cVar6 == 'l') {
                        cVar6 = param_3[1];
                        param_3 = param_3 + 2;
                        uVar10 = 4;
                    } else {
                        param_3 = param_3 + 1;
                        uVar10 = 3;
                    }
                    uVar11 = 6;
                    goto LAB_0007c6dc;
                case 'm':
                    break;
                case 'n':
                    break;
                case 'o':
                    break;
                case 'p':
                    break;
                case 'q':
                    break;
                case 'r':
                    break;
                case 's':
                    break;
                case 't':
                    cVar6 = *param_3;
                    uVar11 = 6;
                    param_3 = param_3 + 1;
                    uVar10 = 7;
                    goto LAB_0007c6dc;
                case 'u':
                    break;
                case 'v':
                    break;
                case 'w':
                    break;
                case 'x':
                    break;
                case 'y':
                    break;
                case 'z':
                    uVar11 = 6;
                    cVar6 = *param_3;
                    uVar10 = 6;
                    param_3 = param_3 + 1;
                    goto LAB_0007c6dc;
                }
                uVar11 = 6;
                goto LAB_0007c6dc;
            case 6:
                uVar11 = local_34;
                switch (cVar6) {
                case '%':
                    uVar11 = local_34 + 1;
                    if (uVar11 < unaff_r6) {
                        *(undefined1 *)(param_1 + local_34) = 0x25;
                    }
                    break;
                case '&':
                    break;
                case '\'':
                    break;
                case '(':
                    break;
                case ')':
                    break;
                case '*':
                    break;
                case '+':
                    break;
                case ',':
                    break;
                case '-':
                    break;
                case '.':
                    break;
                case '/':
                    break;
                case '0':
                    break;
                case '1':
                    break;
                case '2':
                    break;
                case '3':
                    break;
                case '4':
                    break;
                case '5':
                    break;
                case '6':
                    break;
                case '7':
                    break;
                case '8':
                    break;
                case '9':
                    break;
                case ':':
                    break;
                case ';':
                    break;
                case '<':
                    break;
                case '=':
                    break;
                case '>':
                    break;
                case '?':
                    break;
                case '@':
                    break;
                case 'A':
                    goto LAB_0007cbb0;
                case 'B':
                    break;
                case 'C':
                    break;
                case 'D':
                    break;
                case 'E':
                    uVar12 = uVar12 | 0x40;
                    goto LAB_0007cc90;
                case 'F':
                LAB_0007cbb0:
                    uVar12 = uVar12 | 0x40;
                    goto LAB_0007cbb4;
                case 'G':
                    uVar12 = uVar12 | 0x40;
                    goto LAB_0007cc54;
                case 'H':
                    break;
                case 'I':
                    break;
                case 'J':
                    break;
                case 'K':
                    break;
                case 'L':
                    break;
                case 'M':
                    break;
                case 'N':
                    break;
                case 'O':
                    break;
                case 'P':
                    break;
                case 'Q':
                    break;
                case 'R':
                    break;
                case 'S':
                    break;
                case 'T':
                    break;
                case 'U':
                    break;
                case 'V':
                    break;
                case 'W':
                    break;
                case 'X':
                    uVar12 = uVar12 | 0x40;
                    goto LAB_0007cc18;
                case 'Y':
                    break;
                case 'Z':
                    break;
                case '[':
                    break;
                case '\\':
                    break;
                case ']':
                    break;
                case '^':
                    break;
                case '_':
                    break;
                case '`':
                    break;
                case 'a':
                    goto LAB_0007cbb4;
                case 'b':
                    break;
                case 'c':
                    puVar5 = param_4 + 1;
                    uVar1 = *param_4;
                    uVar11 = local_34 + 1;
                    param_4 = puVar5;
                    if (uVar11 < unaff_r6) {
                        *(char *)(param_1 + local_34) = (char)uVar1;
                    }
                    break;
                case 'd':
                    goto LAB_0007cdb0;
                case 'e':
                LAB_0007cc90:
                    uVar12 = uVar12 | 0x200;
                    puVar8 =
                        (undefined8 *)((uint)((int)param_4 + 7) & 0xfffffff8);
                    uVar7 = (undefined4)*puVar8;
                    goto LAB_0007cbdc;
                case 'f':
                LAB_0007cbb4:
                    puVar8 =
                        (undefined8 *)((uint)((int)param_4 + 7) & 0xfffffff8);
                    uVar7 = (undefined4)*puVar8;
                LAB_0007cbdc:
                    FUN_0007baf0(uVar7, param_1, &local_34, unaff_r6, uVar1,
                                 uVar3, uVar12, &local_30);
                    param_4 = (uint *)(puVar8 + 1);
                    uVar11 = local_34;
                    if (local_30 != 0)
                        goto LAB_0007c990;
                    break;
                case 'g':
                LAB_0007cc54:
                    puVar8 =
                        (undefined8 *)((uint)((int)param_4 + 7) & 0xfffffff8);
                    uVar12 = uVar12 | 0x100;
                    if (uVar3 == 0) {
                        uVar3 = 1;
                    }
                    uVar7 = (undefined4)*puVar8;
                    goto LAB_0007cbdc;
                case 'h':
                    break;
                case 'i':
                LAB_0007cdb0:
                    switch (uVar10) {
                    case 1:
                        uVar10 = (uint)(char)(byte)*param_4;
                        param_4 = param_4 + 1;
                        uVar11 = (int)uVar10 >> 0x1f;
                        break;
                    case 2:
                        uVar10 = (uint)(short)(ushort)*param_4;
                        param_4 = param_4 + 1;
                        uVar11 = (int)uVar10 >> 0x1f;
                        break;
                    case 3:
                    default:
                    switchD_0007cdb8_default:
                        uVar10 = *param_4;
                        param_4 = param_4 + 1;
                        uVar11 = (int)uVar10 >> 0x1f;
                        break;
                    case 4:
                        goto LAB_0007cf28;
                    case 5:
                        goto switchD_0007cdb8_default;
                    case 6:
                        uVar10 = *param_4;
                        uVar11 = 0;
                        param_4 = param_4 + 1;
                        break;
                    case 7:
                        goto switchD_0007cdb8_default;
                    case 8:
                    LAB_0007cf28:
                        puVar5 =
                            (uint *)((uint)((int)param_4 + 7) & 0xfffffff8);
                        param_4 = puVar5 + 2;
                        uVar10 = *puVar5;
                        uVar11 = puVar5[1];
                    }
                    FUN_0007b63c(param_1, &local_34, unaff_r6, 10, uVar10,
                                 uVar11, 10, uVar1, uVar3, uVar12);
                    uVar11 = local_34;
                    break;
                case 'j':
                    break;
                case 'k':
                    break;
                case 'l':
                    break;
                case 'm':
                    break;
                case 'n':
                    switch (uVar10) {
                    case 1:
                        *(char *)*param_4 = (char)local_34;
                        param_4 = param_4 + 1;
                        break;
                    case 2:
                        *(short *)*param_4 = (short)local_34;
                        param_4 = param_4 + 1;
                        break;
                    case 3:
                    default:
                    switchD_0007cd88_default:
                        *(uint *)*param_4 = local_34;
                        param_4 = param_4 + 1;
                        break;
                    case 4:
                        goto LAB_0007cf0c;
                    case 5:
                        goto switchD_0007cd88_default;
                    case 6:
                        *(uint *)*param_4 = local_34;
                        param_4 = param_4 + 1;
                        break;
                    case 7:
                        goto switchD_0007cd88_default;
                    case 8:
                    LAB_0007cf0c:
                        puVar5 = (uint *)*param_4;
                        puVar5[1] = 0;
                        *puVar5 = local_34;
                        param_4 = param_4 + 1;
                    }
                    break;
                case 'o':
                    uVar7 = 8;
                    goto LAB_0007cc1c;
                case 'p':
                    uVar11 = *param_4;
                    if (uVar11 == 0) {
                        FUN_0007b490(param_1, &local_34, unaff_r6, "(nil)",
                                     uVar1, 0xffffffff, uVar12);
                        param_4 = param_4 + 1;
                        uVar11 = local_34;
                    } else {
                        FUN_0007b63c(param_1, &local_34, unaff_r6, uVar11,
                                     uVar11, 0, 0x10, uVar1, uVar3,
                                     uVar12 | 0x88);
                        param_4 = param_4 + 1;
                        uVar11 = local_34;
                    }
                    break;
                case 'q':
                    break;
                case 'r':
                    break;
                case 's':
                    FUN_0007b490(param_1, &local_34, unaff_r6, *param_4, uVar1,
                                 uVar3, uVar12);
                    param_4 = param_4 + 1;
                    uVar11 = local_34;
                    break;
                case 't':
                    break;
                case 'u':
                    uVar7 = 10;
                    goto LAB_0007cc1c;
                case 'v':
                    break;
                case 'w':
                    break;
                case 'x':
                LAB_0007cc18:
                    uVar7 = 0x10;
                LAB_0007cc1c:
                    switch (uVar10) {
                    case 1:
                        uVar10 = (uint)(byte)*param_4;
                        uVar11 = 0;
                        param_4 = param_4 + 1;
                        break;
                    case 2:
                        uVar10 = (uint)(ushort)*param_4;
                        uVar11 = 0;
                        param_4 = param_4 + 1;
                        break;
                    case 3:
                    default:
                    switchD_0007cc28_default:
                        uVar10 = *param_4;
                        param_4 = param_4 + 1;
                        uVar11 = 0;
                        break;
                    case 4:
                        goto LAB_0007cd5c;
                    case 5:
                        goto switchD_0007cc28_default;
                    case 6:
                        goto switchD_0007cc28_default;
                    case 7:
                        uVar10 = *param_4;
                        param_4 = param_4 + 1;
                        uVar11 = (int)uVar10 >> 0x1f;
                        break;
                    case 8:
                    LAB_0007cd5c:
                        puVar5 =
                            (uint *)((uint)((int)param_4 + 7) & 0xfffffff8);
                        param_4 = puVar5 + 2;
                        uVar10 = *puVar5;
                        uVar11 = puVar5[1];
                    }
                    FUN_0007b63c(param_1, &local_34, unaff_r6, uVar7, uVar10,
                                 uVar11, uVar7, uVar1, uVar3, uVar12 | 0x80);
                    uVar11 = local_34;
                }
                local_34 = uVar11;
                uVar1 = 0;
                cVar6 = *param_3;
                param_3 = param_3 + 1;
                uVar3 = 0xffffffff;
                uVar10 = uVar1;
                uVar11 = uVar1;
                uVar12 = uVar1;
                goto LAB_0007c6dc;
            }
        } while (true);
    }
LAB_0007c990:
    if (local_34 < unaff_r6) {
        *(undefined1 *)(param_1 + local_34) = 0;
    } else if (unaff_r6 != 0) {
        *(undefined1 *)(param_1 + unaff_r6 + -1) = 0;
    }
    if (local_30 == 0) {
        uVar1 = local_34;
        if (local_34 < 0x7fffffff)
            goto LAB_0007c9c4;
        piVar2 = __errno_location();
        iVar9 = 0x22;
    } else {
        piVar2 = __errno_location();
        iVar9 = 0x4b;
    }
    *piVar2 = iVar9;
    uVar1 = 0xffffffff;
LAB_0007c9c4:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar1);
LAB_0007ca38:
    if (cVar6 == '%') {
        uVar11 = 1;
    } else {
        uVar4 = local_34 + 1;
        if (uVar4 < unaff_r6) {
            *(char *)(param_1 + local_34) = cVar6;
        }
    }
LAB_0007ca58:
    local_34 = uVar4;
    cVar6 = *param_3;
    param_3 = param_3 + 1;
    goto LAB_0007c6dc;
}

void FUN_0007d00c(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    undefined4 uStack_4;

    iVar1 = __stack_chk_guard;
    uStack_4 = param_4;
    FUN_0007c654(param_1, param_2, param_3, &uStack_4, &uStack_4);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007d070(int param_1)

{
    int iVar1;
    int iVar2;
    long lVar3;

    iVar1 = __stack_chk_guard;
    if (param_1 < 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("socket.c", 0x51, 0, "(int)fd >= 0");
    }
    if (DAT_000c8d7c == -1) {
        lVar3 = sysconf(4);
        if ((lVar3 < 0x1a) && (lVar3 = sysconf(4), lVar3 < 10)) {
            iVar2 = 0;
        } else {
            lVar3 = sysconf(4);
            if (lVar3 < 0x1a) {
                lVar3 = sysconf(4);
                iVar2 = lVar3 + -10;
            } else {
                iVar2 = 0x10;
            }
        }
        DAT_000c8d7c = iVar2;
        if (0 < debug) {
            lVar3 = sysconf(4);
            FUN_00075c68("move_fd: estimated max descriptors: %d, initial "
                         "socket boundary: %d\n",
                         lVar3, iVar2);
        }
    }
    do {
        if (DAT_000c8d7c <= param_1)
            break;
        iVar2 = fcntl(param_1, 0);
        if (iVar2 != -1) {
            close(param_1);
            param_1 = iVar2;
            break;
        }
        if (DAT_000c8d7c < 10) {
            DAT_000c8d7c = 0;
            if (debug < 1)
                break;
        LAB_0007d0dc:
            FUN_00075c68("move_fd: selecting new socket boundary: %d\n",
                         DAT_000c8d7c);
        } else {
            DAT_000c8d7c = DAT_000c8d7c + -10;
            if (0 < debug)
                goto LAB_0007d0dc;
        }
    } while (0 < DAT_000c8d7c);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_0007d244(int param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = fcntl(param_1, 4, 0x800);
    if (iVar2 < 0) {
        FUN_00075d40(3, "fcntl(O_NONBLOCK) fails on fd #%d: %m", param_1);
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007d2c0(short *param_1)

{
    int iVar1;
    short sVar2;
    int iVar3;
    int *piVar4;
    char *pcVar5;
    char *__buf;
    int iVar6;
    uint uVar7;
    int iVar8;

    iVar3 = __stack_chk_guard;
    piVar4 = __errno_location();
    iVar6 = *piVar4;
    __buf = lib_stringbuf + lib_nextbuf * 0x80;
    uVar7 = lib_nextbuf + 1 & 0xf;
    memset(__buf, 0, 0x80);
    lib_nextbuf = uVar7;
    if (param_1 == (short *)0x0) {
        FUN_0007e4b4(__buf, &DAT_000ad108, 0x80);
        goto LAB_0007d35c;
    }
    sVar2 = *param_1;
    if (sVar2 != 2) {
        if (sVar2 == 10) {
            inet_ntop(10, param_1 + 4, __buf, 0x80);
            iVar8 = *(int *)(param_1 + 0xc);
            if ((iVar8 != 0) && (pcVar5 = strchr(__buf, 0x25),
                                 uVar7 = lib_nextbuf, pcVar5 == (char *)0x0)) {
                iVar1 = lib_nextbuf * 0x80;
                pcVar5 = lib_stringbuf + iVar1;
                memset(pcVar5, 0, 0x80);
                lib_nextbuf = uVar7 + 1 & 0xf;
                FUN_0007d00c(pcVar5, 0x80, "%s%%%lu", __buf, iVar8);
                lib_stringbuf[iVar1 + 0x7f] = 0;
                __buf = pcVar5;
            }
            goto LAB_0007d35c;
        }
        if (sVar2 != 0) {
            FUN_0007d00c(__buf, 0x80, "(socktoa unknown family %d)");
            goto LAB_0007d35c;
        }
    }
    inet_ntop(2, param_1 + 2, __buf, 0x80);
LAB_0007d35c:
    iVar8 = __stack_chk_guard;
    *piVar4 = iVar6;
    if (iVar3 == iVar8) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__buf);
}

void FUN_0007d454(short *param_1)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    undefined4 uVar4;
    char *pcVar5;
    uint uVar6;
    undefined1 *__s;
    int iVar7;

    iVar1 = __stack_chk_guard;
    piVar3 = __errno_location();
    iVar7 = *piVar3;
    uVar4 = FUN_0007d2c0(param_1);
    __s = lib_stringbuf + lib_nextbuf * 0x80;
    uVar6 = lib_nextbuf + 1;
    memset(__s, 0, 0x80);
    if (*param_1 == 10) {
        pcVar5 = "[%s]:%hu";
    } else {
        pcVar5 = "%s:%hu";
    }
    lib_nextbuf = uVar6 & 0xf;
    FUN_0007d00c(__s, 0x80, pcVar5, uVar4,
                 (ushort)param_1[1] >> 8 | param_1[1] << 8);
    iVar2 = __stack_chk_guard;
    *piVar3 = iVar7;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

/* WARNING: Removing unreachable block (ram,0x0007d5d8) */

void FUN_0007d544(short *param_1)

{
    uint uVar1;
    uint uVar2;

    if (*param_1 == 2) {
        uVar2 = 4;
    } else {
        if (*param_1 != 10) {
            return;
        }
        uVar2 = 0x10;
    }
    uVar1 = 0;
    do {
        uVar1 = uVar1 + 1;
    } while (uVar1 < uVar2);
    return;
}

void FUN_0007d690(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_000751b4();
    ssl_init_done = 1;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007d6ec(void)

{
    int iVar1;
    uint uVar2;

    iVar1 = __stack_chk_guard;
    uVar2 = OpenSSL_version_num();
    if (((uVar2 ^ 0x1010104f) & 0xfffff00f) != 0) {
        FUN_00075d40(
            4, "OpenSSL version mismatch. Built against %lx, you have %lx",
            0x1010104f, uVar2);
        __fprintf_chk(
            stderr, 1,
            "OpenSSL version mismatch. Built against %lx, you have %lx\n",
            0x1010104f, uVar2);
    }
    if (ssl_init_done == 0) {
        if (iVar1 == __stack_chk_guard) {
            FUN_0007d690();
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007d7cc(int param_1)

{
    int iVar1;
    char *pcVar2;

    iVar1 = __stack_chk_guard;
    if (ssl_init_done == 0) {
        FUN_0007d690();
    }
    pcVar2 = OBJ_nid2sn(param_1);
    if (param_1 == 0x37e) {
        if (debug == 0) {
            pcVar2 = "AES128CMAC";
        } else {
            pcVar2 = "AES128CMAC";
            __fprintf_chk(stderr, 1, "%s:%d:%s():%s:nid\n", "ssl_init.c", 0xdf,
                          "keytype_name", "AES128CMAC");
        }
    } else if (pcVar2 == (char *)0x0) {
        pcVar2 = "(unknown key type)";
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(pcVar2);
    }
    return;
}

void FUN_0007d8e8(byte *param_1, uint *param_2)

{
    int iVar1;
    __int32_t **pp_Var2;
    int iVar3;
    int iVar4;
    char *name;
    EVP_MD *md;
    undefined4 uVar5;
    undefined4 uVar6;
    byte *pbVar7;
    uint uVar8;
    byte *s;

    iVar1 = __stack_chk_guard;
    if (ssl_init_done == 0) {
        FUN_0007d690();
    }
    iVar3 = lib_nextbuf;
    s = lib_stringbuf + lib_nextbuf * 0x80;
    memset(s, 0, 0x80);
    lib_nextbuf = iVar3 + 1U & 0xf;
    FUN_0007e4b4(s, param_1, 0x80);
    uVar8 = (uint)(byte)lib_stringbuf[iVar3 * 0x80];
    if (uVar8 != 0) {
        pp_Var2 = __ctype_toupper_loc();
        pbVar7 = s;
        do {
            *pbVar7 = (byte)(*pp_Var2)[uVar8];
            pbVar7 = pbVar7 + 1;
            uVar8 = (uint)*pbVar7;
        } while (uVar8 != 0);
    }
    iVar3 = OBJ_sn2nid((char *)s);
    if (iVar3 == 0) {
        iVar4 = strcmp("AES128CMAC", (char *)s);
        if (iVar4 == 0) {
            if (debug == 0) {
                iVar3 = 0x37e;
            } else {
                iVar3 = 0x37e;
                __fprintf_chk(stderr, 1, "%s:%d:%s():%s:key\n", "ssl_init.c",
                              0x87, "keytype_from_text", "AES128CMAC");
            }
        } else {
            pp_Var2 = __ctype_tolower_loc();
            if ((*pp_Var2)[*param_1] != 0x6d)
                goto LAB_0007da38;
            iVar3 = 4;
        }
    }
    if (param_2 != (uint *)0x0) {
        name = OBJ_nid2sn(iVar3);
        md = EVP_get_digestbyname(name);
        if ((md == (EVP_MD *)0x0) ||
            (uVar8 = EVP_MD_size(md), uVar6 = stderr, uVar8 == 0)) {
            uVar6 = stderr;
            if (iVar3 == 0x37e) {
                if (debug != 0) {
                    __fprintf_chk(stderr, 1, "%s:%d:%s():%s:len\n",
                                  "ssl_init.c", 0xa4, "keytype_from_text",
                                  "AES128CMAC");
                }
                *param_2 = 0x10;
            } else {
                uVar5 = FUN_0007d7cc(iVar3);
                __fprintf_chk(uVar6, 1,
                              "key type %s is not supported by OpenSSL\n",
                              uVar5);
                uVar6 = FUN_0007d7cc(iVar3);
                FUN_00075d40(3, "key type %s is not supported by OpenSSL\n",
                             uVar6);
                iVar3 = 0;
            }
        } else if (uVar8 < 0x15) {
            *param_2 = uVar8;
        } else {
            uVar5 = FUN_0007d7cc(iVar3);
            __fprintf_chk(uVar6, 1,
                          "key type %s %u octet digests are too big, max %lu\n",
                          uVar5, uVar8, 0x14);
            uVar6 = FUN_0007d7cc(iVar3);
            FUN_00075d40(3, "key type %s %u octet digests are too big, max %lu",
                         uVar6, uVar8, 0x14);
            iVar3 = 0;
        }
    }
LAB_0007da38:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar3);
}

/* WARNING: Removing unreachable block (ram,0x0007de0c) */
/* WARNING: Removing unreachable block (ram,0x0007de00) */
/* WARNING: Removing unreachable block (ram,0x0007e04c) */

void FUN_0007dff8(uint param_1)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    int iVar4;
    undefined1 *__s;
    undefined *puVar5;
    int *piVar6;
    uint uVar7;
    uint uVar8;
    int iVar9;
    undefined1 *puVar10;
    int iVar11;

    iVar2 = __stack_chk_guard;
    piVar3 = __errno_location();
    iVar11 = *piVar3;
    iVar1 = lib_nextbuf * 0x80;
    __s = lib_stringbuf + iVar1;
    uVar7 = lib_nextbuf + 1;
    memset(__s, 0, 0x80);
    lib_nextbuf = uVar7 & 0xf;
    piVar6 = (int *)&UNK_000c5d48;
    iVar9 = 0;
    puVar5 = &DAT_000a9528;
    puVar10 = __s;
    do {
        iVar4 = *piVar6;
        if ((param_1 & piVar6[-1]) == 0) {
            iVar4 = piVar6[1];
        }
        if (iVar4 != 0) {
            uVar8 = (iVar1 + 0x119e18) - (int)puVar10;
            uVar7 = FUN_0007d00c(puVar10, uVar8, "%s%s", puVar5, iVar4);
            if (uVar8 <= uVar7) {
                FUN_0007d00c(
                    __s, 0x80,
                    "decode_bitflags(%s) can\'t decode 0x%x in %d bytes",
                    &DAT_000a9528, param_1, 0x80);
                *piVar3 = iVar11;
                break;
            }
            puVar10 = puVar10 + uVar7;
            puVar5 = &DAT_000a848c;
        }
        iVar9 = iVar9 + 1;
        piVar6 = piVar6 + 3;
    } while (iVar9 != 3);
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__s);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007de0c) */
/* WARNING: Removing unreachable block (ram,0x0007de00) */
/* WARNING: Removing unreachable block (ram,0x0007e0b4) */

void FUN_0007e060(uint param_1)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    int iVar4;
    undefined1 *__s;
    undefined *puVar5;
    int *piVar6;
    uint uVar7;
    uint uVar8;
    int iVar9;
    undefined1 *puVar10;
    int iVar11;

    iVar2 = __stack_chk_guard;
    piVar3 = __errno_location();
    iVar11 = *piVar3;
    iVar1 = lib_nextbuf * 0x80;
    __s = lib_stringbuf + iVar1;
    uVar7 = lib_nextbuf + 1;
    memset(__s, 0, 0x80);
    lib_nextbuf = uVar7 & 0xf;
    piVar6 = (int *)&UNK_000c5d6c;
    iVar9 = 0;
    puVar5 = &DAT_000a9528;
    puVar10 = __s;
    do {
        iVar4 = *piVar6;
        if ((param_1 & piVar6[-1]) == 0) {
            iVar4 = piVar6[1];
        }
        if (iVar4 != 0) {
            uVar8 = (iVar1 + 0x119e18) - (int)puVar10;
            uVar7 = FUN_0007d00c(puVar10, uVar8, "%s%s", puVar5, iVar4);
            if (uVar8 <= uVar7) {
                FUN_0007d00c(
                    __s, 0x80,
                    "decode_bitflags(%s) can\'t decode 0x%x in %d bytes",
                    &DAT_000a9528, param_1, 0x80);
                *piVar3 = iVar11;
                break;
            }
            puVar10 = puVar10 + uVar7;
            puVar5 = &DAT_000a848c;
        }
        iVar9 = iVar9 + 1;
        piVar6 = piVar6 + 3;
    } while (iVar9 != 0xd);
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__s);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007ddcc) */
/* WARNING: Removing unreachable block (ram,0x0007de00) */
/* WARNING: Removing unreachable block (ram,0x0007e11c) */

void FUN_0007e0c8(uint param_1)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    int iVar4;
    undefined1 *__s;
    undefined *puVar5;
    int *piVar6;
    uint uVar7;
    uint uVar8;
    int iVar9;
    undefined1 *puVar10;
    int iVar11;

    iVar2 = __stack_chk_guard;
    piVar3 = __errno_location();
    iVar11 = *piVar3;
    iVar1 = lib_nextbuf * 0x80;
    __s = lib_stringbuf + iVar1;
    uVar7 = lib_nextbuf + 1;
    memset(__s, 0, 0x80);
    lib_nextbuf = uVar7 & 0xf;
    piVar6 = &DAT_000c5c88;
    iVar9 = 0;
    puVar5 = &DAT_000a9528;
    puVar10 = __s;
    do {
        iVar4 = *piVar6;
        if ((param_1 & piVar6[-1]) == 0) {
            iVar4 = piVar6[1];
        }
        if (iVar4 != 0) {
            uVar8 = (iVar1 + 0x119e18) - (int)puVar10;
            uVar7 = FUN_0007d00c(puVar10, uVar8, "%s%s", puVar5, iVar4);
            if (uVar8 <= uVar7) {
                FUN_0007d00c(
                    __s, 0x80,
                    "decode_bitflags(%s) can\'t decode 0x%x in %d bytes",
                    "kern_st", param_1, 0x80);
                *piVar3 = iVar11;
                break;
            }
            puVar10 = puVar10 + uVar7;
            puVar5 = &DAT_000a848c;
        }
        iVar9 = iVar9 + 1;
        piVar6 = piVar6 + 3;
    } while (iVar9 != 0x10);
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__s);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007e440) */

void FUN_0007e39c(uint param_1)

{
    int iVar1;
    undefined1 *__s;
    uint *puVar2;
    uint uVar3;

    iVar1 = __stack_chk_guard;
    if ((param_1 & 0x80) == 0) {
        if ((param_1 & 0x100) == 0) {
            puVar2 = &DAT_000c5ec4;
        } else {
            param_1 = param_1 & 0xfffffeff;
            puVar2 = &DAT_000c611c;
        }
    } else {
        param_1 = param_1 & 0xffffff7f;
        puVar2 = &DAT_000c5ffc;
    }
    uVar3 = *puVar2;
    do {
        if (uVar3 == 0xffffffff) {
            __s = lib_stringbuf + lib_nextbuf * 0x80;
            uVar3 = lib_nextbuf + 1;
            memset(__s, 0, 0x80);
            lib_nextbuf = uVar3 & 0xf;
            FUN_0007d00c(__s, 0x80, "%s_%d", puVar2[1], param_1);
        LAB_0007def0:
            if (iVar1 != __stack_chk_guard) {
                /* WARNING: Subroutine does not return */
                __stack_chk_fail(__s);
            }
            return;
        }
        if (uVar3 == param_1) {
            __s = (undefined1 *)puVar2[1];
            goto LAB_0007def0;
        }
        puVar2 = puVar2 + 3;
        uVar3 = *puVar2;
    } while (true);
}

/* WARNING: Removing unreachable block (ram,0x0007e4a4) */

void FUN_0007e458(int param_1)

{
    int iVar1;
    undefined1 *__s;
    int *piVar2;
    int *piVar3;
    uint uVar4;

    iVar1 = __stack_chk_guard;
    piVar2 = (int *)&UNK_000c60bc;
    piVar3 = piVar2;
    if (param_1 != 0) {
        do {
            piVar2 = piVar3 + 3;
            if (*piVar2 == -1) {
                __s = lib_stringbuf + lib_nextbuf * 0x80;
                uVar4 = lib_nextbuf + 1;
                memset(__s, 0, 0x80);
                lib_nextbuf = uVar4 & 0xf;
                FUN_0007d00c(__s, 0x80, "%s_%d", piVar3[4], param_1);
                goto LAB_0007def0;
            }
            piVar3 = piVar2;
        } while (*piVar2 != param_1);
    }
    __s = (undefined1 *)piVar2[1];
LAB_0007def0:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__s);
    }
    return;
}

void FUN_0007e4b4(char *param_1, char *param_2, int param_3)

{
    char cVar1;
    int iVar2;
    char *pcVar3;
    char *pcVar4;
    char *pcVar5;

    iVar2 = __stack_chk_guard;
    pcVar5 = param_2;
    if (param_3 == 0)
        goto LAB_0007e53c;
    pcVar3 = param_1;
    while (pcVar3 != param_1 + param_3 + -1) {
        pcVar4 = pcVar5 + 1;
        cVar1 = *pcVar5;
        *pcVar3 = cVar1;
        pcVar3 = pcVar3 + 1;
        pcVar5 = pcVar4;
        if (cVar1 == '\0')
            goto LAB_0007e518;
    }
    *pcVar3 = '\0';
    cVar1 = *pcVar5;
    while (pcVar4 = pcVar5 + 1, pcVar5 = pcVar4, cVar1 != '\0') {
    LAB_0007e53c:
        cVar1 = *pcVar5;
    }
LAB_0007e518:
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(pcVar4 + (-1 - (int)param_2));
}

void FUN_0007e558(char *param_1, char *param_2, int param_3)

{
    int iVar1;
    size_t sVar2;
    int iVar3;
    char cVar4;
    char *pcVar5;
    char *pcVar6;
    int iVar7;

    iVar1 = __stack_chk_guard;
    if (param_3 == 0) {
        iVar3 = 0;
    LAB_0007e624:
        sVar2 = strlen(param_2);
        iVar7 = sVar2 + iVar3;
    } else {
        if (*param_1 == '\0') {
            iVar3 = 0;
        } else {
            pcVar6 = param_1 + 1;
            do {
                pcVar5 = pcVar6;
                if (pcVar5 == param_1 + param_3) {
                    iVar3 = (int)(param_1 + param_3) - (int)param_1;
                    goto joined_r0x0007e5bc;
                }
                pcVar6 = pcVar5 + 1;
            } while (*pcVar5 != '\0');
            iVar3 = (int)pcVar5 - (int)param_1;
        joined_r0x0007e5bc:
            param_3 = param_3 - iVar3;
            param_1 = pcVar5;
            if (param_3 == 0)
                goto LAB_0007e624;
        }
        cVar4 = *param_2;
        pcVar6 = param_2;
        if (cVar4 == '\0') {
            iVar7 = 0;
        } else {
            do {
                if (param_3 != 1) {
                    *param_1 = cVar4;
                }
                pcVar6 = pcVar6 + 1;
                cVar4 = *pcVar6;
                if (param_3 != 1) {
                    param_3 = param_3 + -1;
                    param_1 = param_1 + 1;
                }
            } while (cVar4 != '\0');
            iVar7 = (int)pcVar6 - (int)param_2;
        }
        iVar7 = iVar7 + iVar3;
        *param_1 = '\0';
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar7);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007e6b4) */

void sigint_handler(void)

{
    if (DAT_0011824c != (code *)0x0) {
        /* WARNING: Could not recover jumptable at 0x0007e69c. Too many branches
         */
        /* WARNING: Treating indirect jump as call */
        (*DAT_0011824c)();
        return;
    }
    return;
}

void FUN_0007e6c4(int param_1, _union_1051 param_2)

{
    int *piVar1;
    int iVar2;
    _union_1051 local_134;
    sigset_t sStack_130;
    undefined4 local_b0;
    sigaction sStack_a8;
    int local_1c;

    local_1c = __stack_chk_guard;
    memset(&local_134, 0, 0x8c);
    sigemptyset(&sStack_130);
    local_134 = param_2;
    if (param_1 == 0x1d) {
        local_b0 = 0x10000000;
    }
    while (iVar2 = sigaction(param_1, (sigaction *)&local_134, &sStack_a8),
           iVar2 == -1) {
        piVar1 = __errno_location();
        if (*piVar1 != 4) {
            perror("sigaction");
            /* WARNING: Subroutine does not return */
            exit(1);
        }
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007e828(undefined4 *param_1, byte *param_2, undefined4 *param_3,
                  uint param_4)

{
    ushort uVar1;
    bool bVar2;
    ushort **ppuVar3;
    int *piVar4;
    __int32_t **pp_Var5;
    uint uVar6;
    byte *pbVar7;
    ushort *puVar8;
    ushort uVar9;
    undefined8 local_38;
    int local_2c;

    local_2c = __stack_chk_guard;
    ppuVar3 = __ctype_b_loc();
    puVar8 = *ppuVar3;
    do {
        pbVar7 = param_2;
        uVar6 = (uint)*pbVar7;
        param_2 = pbVar7 + 1;
        uVar1 = puVar8[uVar6];
        uVar9 = uVar1 & 0x2000;
    } while ((uVar1 & 0x2000) != 0);
    if (uVar6 == 0x2d) {
        uVar9 = 1;
        pbVar7 = param_2;
    } else if (uVar6 == 0x2b) {
        pbVar7 = param_2;
    }
    if (param_4 == 0) {
        if (*pbVar7 == 0x30) {
            pp_Var5 = __ctype_toupper_loc();
            if ((*pp_Var5)[pbVar7[1]] == 0x58) {
                pbVar7 = pbVar7 + 2;
                param_4 = 0x10;
            } else {
                pbVar7 = pbVar7 + 1;
                param_4 = 8;
            }
        } else {
            param_4 = 10;
        }
    } else if (param_4 == 0x10) {
        if ((*pbVar7 == 0x30) &&
            (pp_Var5 = __ctype_toupper_loc(), (*pp_Var5)[pbVar7[1]] == 0x58)) {
            pbVar7 = pbVar7 + 2;
        }
    } else if (0x21 < param_4 - 3) {
        memset(&local_38, 0xff, 8);
        piVar4 = __errno_location();
        *param_1 = (int)local_38;
        param_1[1] = local_38._4_4_;
        *piVar4 = 0x22;
        goto LAB_0007e97c;
    }
    bVar2 = false;
    local_38 = 0;
    uVar6 = (uint)*pbVar7;
    if (uVar6 == 0) {
    LAB_0007e958:
        piVar4 = __errno_location();
        *piVar4 = 0x16;
    } else {
        do {
            uVar1 = puVar8[uVar6];
            if ((uVar1 & 0x800) == 0) {
                if ((uVar1 & 0x100) != 0) {
                    uVar6 = uVar6 - 0x37 & 0xff;
                    goto LAB_0007e948;
                }
                if ((uVar1 & 0x200) != 0) {
                    uVar6 = uVar6 - 0x57 & 0xff;
                    goto LAB_0007e948;
                }
            LAB_0007e950:
                if (!bVar2)
                    goto LAB_0007e958;
                break;
            }
            uVar6 = uVar6 - 0x30 & 0xff;
        LAB_0007e948:
            if ((int)param_4 <= (int)uVar6)
                goto LAB_0007e950;
            bVar2 = true;
            local_38 = (ulonglong)param_4 * (local_38 & 0xffffffff) +
                       CONCAT44((int)local_38 * ((int)param_4 >> 0x1f) +
                                    param_4 * local_38._4_4_,
                                uVar6);
            pbVar7 = pbVar7 + 1;
            uVar6 = (uint)*pbVar7;
        } while (uVar6 != 0);
    }
    if (param_3 != (undefined4 *)0x0) {
        *param_3 = pbVar7;
    }
    if (uVar9 != 0) {
        local_38._4_4_ = ~local_38._4_4_;
        if ((int)local_38 == 0) {
            local_38._4_4_ = local_38._4_4_ + 1;
        }
        local_38 = CONCAT44(local_38._4_4_, -(int)local_38);
    }
    *param_1 = (int)local_38;
    param_1[1] = local_38._4_4_;
LAB_0007e97c:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

/* WARNING: Removing unreachable block (ram,0x0007eb1c) */

void FUN_0007eac0(void)

{
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007eb74) */

void FUN_0007eb28(int *param_1, uint *param_2, uint *param_3)

{
    uint uVar1;
    uint uVar2;
    uint uVar3;
    uint uVar4;

    uVar3 = *param_2;
    uVar4 = param_2[1];
    uVar1 = *param_3;
    uVar2 = param_3[1];
    *param_1 = uVar1 + uVar3;
    param_1[1] = uVar2 + uVar4 + (uint)CARRY4(uVar1, uVar3);
    return;
}

void FUN_0007eb80(int *param_1, uint *param_2, uint *param_3)

{
    int iVar1;
    uint uVar2;
    uint uVar3;
    uint uVar4;
    uint uVar5;

    iVar1 = __stack_chk_guard;
    uVar4 = *param_3;
    uVar5 = param_3[1];
    uVar2 = *param_2;
    uVar3 = param_2[1];
    *param_1 = uVar2 - uVar4;
    param_1[1] = uVar3 - (uVar5 + (uVar2 < uVar4));
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x0007ec28) */

void FUN_0007ebd8(int *param_1, uint *param_2, uint param_3)

{
    uint uVar1;
    uint uVar2;

    uVar1 = *param_2;
    uVar2 = param_2[1];
    *param_1 = uVar1 + param_3;
    param_1[1] = uVar2 + ((int)param_3 >> 0x1f) + (uint)CARRY4(uVar1, param_3);
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007ed3c) */

void FUN_0007ecec(int *param_1, uint *param_2, uint param_3)

{
    uint uVar1;
    uint uVar2;

    uVar1 = *param_2;
    uVar2 = param_2[1];
    *param_1 = uVar1 - param_3;
    param_1[1] = uVar2 - (uVar1 < param_3);
    return;
}

void FUN_0007ed48(void *param_1)

{
    int iVar1;
    undefined4 uVar2;
    uint uVar3;
    char *pcVar4;
    int __errnum;
    size_t __stacksize;
    undefined4 local_158;
    uint local_154;
    undefined4 local_150;
    undefined4 local_14c;
    pthread_attr_t pStack_148;
    sigset_t sStack_124;
    sigset_t sStack_a4;
    int local_24;

    *(undefined4 *)((int)param_1 + 8) = 0;
    local_24 = __stack_chk_guard;
    iVar1 = FUN_00079e6c(&local_150, &local_158);
    if (iVar1 != 0) {
        FUN_00075d40(3, "start_blocking_thread: pipe_socketpair() %m");
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    uVar2 = FUN_0007d070(local_150);
    *(undefined4 *)((int)param_1 + 0x34) = uVar2;
    uVar2 = FUN_0007d070(local_14c);
    *(undefined4 *)((int)param_1 + 0x3c) = local_158;
    *(undefined4 *)((int)param_1 + 0x38) = uVar2;
    uVar3 = fcntl(*(int *)((int)param_1 + 0x34), 3, 0);
    if (uVar3 == 0xffffffff) {
        FUN_00075d40(3, "start_blocking_thread: fcntl(F_GETFL) %m");
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    iVar1 = fcntl(*(int *)((int)param_1 + 0x34), 4, uVar3 | 0x800);
    if (iVar1 == -1) {
        FUN_00075d40(3, "start_blocking_thread: fcntl(F_SETFL, O_NONBLOCK) %m");
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    (*addremove_io_fd)(*(undefined4 *)((int)param_1 + 0x34),
                       *(undefined4 *)((int)param_1 + 0x3c), 0);
    pthread_attr_init(&pStack_148);
    pthread_attr_setdetachstate(&pStack_148, 1);
    iVar1 = pthread_attr_getstacksize(&pStack_148, &local_154);
    if (iVar1 == 0) {
        if (local_154 < 0x10000) {
            __stacksize = 0x10000;
        } else {
            if (local_154 < 0x40001)
                goto LAB_0007ee68;
            __stacksize = 0x40000;
        }
        iVar1 = pthread_attr_setstacksize(&pStack_148, __stacksize);
        if (iVar1 != 0) {
            pcVar4 = strerror(iVar1);
            FUN_00075d40(3,
                         "start_blocking_thread: "
                         "pthread_attr_setstacksize(0x%lx -> 0x%lx) -> %s",
                         local_154, __stacksize, pcVar4);
        }
    } else {
        pcVar4 = strerror(iVar1);
        FUN_00075d40(3,
                     "start_blocking_thread: pthread_attr_getstacksize() -> %s",
                     pcVar4);
    }
LAB_0007ee68:
    uVar2 = FUN_00074b04(0, 4, 0, 1);
    *(undefined4 *)((int)param_1 + 8) = uVar2;
    sigemptyset(&sStack_a4);
    sigaddset(&sStack_a4, 0xe);
    sigaddset(&sStack_a4, 10);
    sigaddset(&sStack_a4, 0xc);
    sigaddset(&sStack_a4, 1);
    sigaddset(&sStack_a4, 2);
    sigaddset(&sStack_a4, 3);
    sigaddset(&sStack_a4, 0xf);
    sigaddset(&sStack_a4, 7);
    sigemptyset(&sStack_124);
    pthread_sigmask(0, &sStack_a4, &sStack_124);
    __errnum = pthread_create((pthread_t *)((int)param_1 + 0x8c), &pStack_148,
                              blocking_thread, param_1);
    pthread_sigmask(2, &sStack_124, (__sigset_t *)0x0);
    pthread_attr_destroy(&pStack_148);
    iVar1 = __stack_chk_guard;
    if (__errnum != 0) {
        pcVar4 = strerror(__errnum);
        FUN_00075d40(3, "start_blocking_thread: pthread_create() -> %s",
                     pcVar4);
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    *(pthread_t **)((int)param_1 + 8) = (pthread_t *)((int)param_1 + 0x8c);
    if (local_24 == iVar1) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007f028(sem_t *param_1, timespec *param_2)

{
    int iVar1;
    int *piVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    if (param_1 == (sem_t *)0x0) {
        piVar2 = __errno_location();
        iVar3 = -1;
        *piVar2 = 0x16;
    } else {
        do {
            if (param_2 == (timespec *)0x0) {
                iVar3 = sem_wait(param_1);
            } else {
                iVar3 = sem_timedwait(param_1, param_2);
            }
        } while ((iVar3 == -1) && (piVar2 = __errno_location(), *piVar2 == 4));
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar3);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007f2ac) */

void FUN_0007f21c(int param_1)

{
    if (DAT_00118250 == (sem_t *)0x0) {
        return;
    }
    if (param_1 == 0) {
        sem_post(DAT_00118250);
        return;
    }
    FUN_0007f028(DAT_00118250, 0);
    return;
}

void FUN_0007f2bc(void *param_1)

{
    /* WARNING: Subroutine does not return */
    pthread_exit(param_1);
}

void blocking_thread(void)

{
    FUN_0007a508();
    /* WARNING: Subroutine does not return */
    FUN_0007f2bc();
}

void FUN_0007f318(int param_1, int param_2)

{
    int iVar1;
    int *piVar2;
    undefined4 uVar3;
    timespec local_24;
    int local_1c;

    local_1c = __stack_chk_guard;
    iVar1 = clock_gettime(0, &local_24);
    if (iVar1 == 0) {
        local_24.tv_sec = local_24.tv_sec + param_2;
        iVar1 = FUN_0007f028(*(undefined4 *)(param_1 + 0x30), &local_24);
        if (iVar1 == 0) {
            uVar3 = 0xffffffff;
        } else if ((iVar1 != -1) ||
                   (piVar2 = __errno_location(), uVar3 = 0, *piVar2 != 0x6e)) {
            uVar3 = 0xffffffff;
            FUN_00075d40(3, "worker_sleep: sem_timedwait: %m");
        }
    } else {
        uVar3 = 0xffffffff;
        FUN_00075d40(3, "worker_sleep: clock_gettime() failed: %m");
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_0007f494(int param_1, uint *param_2, void *param_3)

{
    undefined4 uVar1;
    uint *puVar2;
    void *pvVar3;
    int iVar4;
    int extraout_r1;
    int extraout_r1_00;
    uint uVar5;
    int iVar6;
    sem_t *__sem;
    uint uVar7;
    int iVar8;
    size_t __n;
    sem_t *__sem_00;
    sem_t *__sem_01;
    uint uVar9;

    iVar6 = __stack_chk_guard;
    if (param_2 == (uint *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("work_thread.c", 0x12e, 0, "hdr != ((void *)0)");
    }
    if (param_3 == (void *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("work_thread.c", 0x12f, 0, "data != ((void *)0)");
    }
    uVar5 = *param_2;
    if (uVar5 < 0x19) {
        return;
    }
    __n = uVar5 - 0x18;
    if (*(int *)(param_1 + 8) == 0) {
        if (DAT_00118250 == (undefined *)0x0) {
            iVar4 = sem_init((sem_t *)&DAT_00118254, 0, 1);
            DAT_00118250 = &DAT_00118254;
            if (iVar4 != 0) {
                DAT_00118250 = (undefined *)0x0;
            }
        }
        __sem_01 = (sem_t *)(param_1 + 0x4c);
        __sem_00 = (sem_t *)(param_1 + 0x5c);
        __sem = (sem_t *)(param_1 + 0x6c);
        iVar4 = sem_init(__sem_01, 0, 1);
        if (iVar4 != 0) {
            __sem_01 = (sem_t *)0x0;
        }
        *(sem_t **)(param_1 + 4) = __sem_01;
        iVar4 = sem_init(__sem_00, 0, 0);
        if (iVar4 != 0) {
            __sem_00 = (sem_t *)0x0;
        }
        *(sem_t **)(param_1 + 0x1c) = __sem_00;
        iVar4 = sem_init(__sem, 0, 0);
        if (iVar4 != 0) {
            __sem = (sem_t *)0x0;
        }
        *(sem_t **)(param_1 + 0x30) = __sem;
        FUN_0007ed48(param_1);
        uVar5 = *param_2;
    }
    puVar2 = (uint *)FUN_00074b04(0, uVar5, 0);
    uVar5 = param_2[1];
    uVar9 = param_2[3];
    uVar7 = param_2[2];
    *puVar2 = *param_2;
    puVar2[1] = uVar5;
    puVar2[2] = uVar7;
    puVar2[3] = uVar9;
    uVar5 = param_2[4];
    puVar2[5] = param_2[5];
    puVar2[4] = uVar5;
    pvVar3 = memcpy(puVar2 + 6, param_3, __n);
    iVar4 = __stack_chk_guard;
    if (iVar6 == __stack_chk_guard) {
        FUN_0007f028(*(undefined4 *)(param_1 + 4), 0);
        iVar6 = *(int *)(param_1 + 0x14);
        if (*(uint *)(param_1 + 0x10) <=
            (uint)(iVar6 - *(int *)(param_1 + 0x18))) {
            uVar7 = *(int *)(param_1 + 0x10) + 0x10;
            uVar1 = FUN_00074b04(*(undefined4 *)(param_1 + 0xc), uVar7 * 4, 0);
            *(undefined4 *)(param_1 + 0xc) = uVar1;
            uVar5 = *(uint *)(param_1 + 0x10);
            if (uVar5 < uVar7) {
                iVar6 = uVar5 << 2;
                do {
                    uVar5 = uVar5 + 1;
                    *(undefined4 *)(*(int *)(param_1 + 0xc) + iVar6) = 0;
                    iVar6 = iVar6 + 4;
                } while (uVar7 != uVar5);
            }
            iVar6 = *(int *)(param_1 + 0x10);
            *(uint *)(param_1 + 0x10) = uVar7;
            *(undefined4 *)(param_1 + 0x18) = 0;
            *(int *)(param_1 + 0x14) = iVar6;
        }
        iVar8 = *(int *)(param_1 + 0xc);
        FUN_0009ce3c(iVar6, *(undefined4 *)(param_1 + 0x10));
        if (*(int *)(iVar8 + extraout_r1 * 4) != 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("work_thread.c", 0xdb, 2,
                         "((void *)0) == c->workitems[c->head_workitem % "
                         "c->workitems_alloc]");
        }
        iVar8 = *(int *)(param_1 + 0xc);
        FUN_0009ce3c(iVar6, *(undefined4 *)(param_1 + 0x10));
        *(uint **)(iVar8 + extraout_r1_00 * 4) = puVar2;
        *(int *)(param_1 + 0x14) = iVar6 + 1;
        sem_post(*(sem_t **)(param_1 + 4));
        sem_post(*(sem_t **)(param_1 + 0x1c));
        if (iVar4 != __stack_chk_guard) {
            /* WARNING: Subroutine does not return */
            __stack_chk_fail(0);
        }
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(pvVar3);
}

void FUN_0007f674(int param_1, undefined4 param_2)

{
    int iVar1;
    ssize_t sVar2;
    undefined4 uVar3;
    int extraout_r1;
    int extraout_r1_00;
    int iVar4;
    uint uVar5;
    int iVar6;
    int iVar7;
    int iVar8;
    uint uVar9;

    iVar1 = __stack_chk_guard;
    FUN_0007f028(*(undefined4 *)(param_1 + 4), 0);
    iVar6 = *(int *)(param_1 + 0x28);
    iVar7 = *(int *)(param_1 + 0x2c);
    iVar4 = iVar6;
    if (*(uint *)(param_1 + 0x24) <= (uint)(iVar6 - iVar7)) {
        uVar9 = *(int *)(param_1 + 0x24) + 4;
        uVar3 = FUN_00074b04(*(undefined4 *)(param_1 + 0x20), uVar9 * 4, 0);
        *(undefined4 *)(param_1 + 0x20) = uVar3;
        uVar5 = *(uint *)(param_1 + 0x24);
        if (uVar5 < uVar9) {
            iVar4 = uVar5 << 2;
            do {
                uVar5 = uVar5 + 1;
                *(undefined4 *)(*(int *)(param_1 + 0x20) + iVar4) = 0;
                iVar4 = iVar4 + 4;
            } while (uVar9 != uVar5);
        }
        iVar4 = *(int *)(param_1 + 0x24);
        *(uint *)(param_1 + 0x24) = uVar9;
        *(undefined4 *)(param_1 + 0x2c) = 0;
        *(int *)(param_1 + 0x28) = iVar4;
    }
    iVar8 = *(int *)(param_1 + 0x20);
    FUN_0009ce3c(iVar4, *(undefined4 *)(param_1 + 0x24));
    if (*(int *)(iVar8 + extraout_r1 * 4) != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("work_thread.c", 0xff, 2,
                     "((void *)0) == c->responses[c->head_response % "
                     "c->responses_alloc]");
    }
    iVar8 = *(int *)(param_1 + 0x20);
    FUN_0009ce3c(iVar4, *(undefined4 *)(param_1 + 0x24));
    *(undefined4 *)(iVar8 + extraout_r1_00 * 4) = param_2;
    *(int *)(param_1 + 0x28) = iVar4 + 1;
    sem_post(*(sem_t **)(param_1 + 4));
    if ((iVar6 == iVar7) &&
        (sVar2 = write(*(int *)(param_1 + 0x38), &DAT_000a9528, 1),
         sVar2 != 1)) {
        FUN_00075d40(4, "async resolver: %s", "failed to notify main thread!");
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(0);
    }
    return;
}

void FUN_0007f7fc(int param_1)

{
    int iVar1;
    int iVar2;
    int extraout_r1;
    int iVar3;
    int iVar4;

    iVar1 = __stack_chk_guard;
    do {
        FUN_0007f028(*(undefined4 *)(param_1 + 0x1c), 0);
        FUN_0007f028(*(undefined4 *)(param_1 + 4), 0);
        iVar4 = *(int *)(param_1 + 0x14);
        iVar2 = *(int *)(param_1 + 0x18);
        while (iVar2 != iVar4) {
            *(int *)(param_1 + 0x18) = iVar2 + 1;
            FUN_0009ce3c(iVar2, *(undefined4 *)(param_1 + 0x10));
            iVar3 = *(int *)(*(int *)(param_1 + 0xc) + extraout_r1 * 4);
            *(undefined4 *)(*(int *)(param_1 + 0xc) + extraout_r1 * 4) = 0;
            iVar2 = iVar2 + 1;
            if (iVar3 != 0) {
                sem_post(*(sem_t **)(param_1 + 4));
                if (iVar3 == -1) {
                    FUN_0007f674(param_1, 0xffffffff);
                    iVar3 = 0;
                }
                if (iVar1 != __stack_chk_guard) {
                    /* WARNING: Subroutine does not return */
                    __stack_chk_fail(iVar3);
                }
                return;
            }
        }
        sem_post(*(sem_t **)(param_1 + 4));
    } while (true);
}

void FUN_0007f8d4(undefined4 *param_1)

{
    int *piVar1;
    ssize_t sVar2;
    int extraout_r1;
    int iVar3;
    int iVar4;
    int iVar5;
    undefined1 auStack_4c[32];
    int local_2c;

    local_2c = __stack_chk_guard;
    do {
        sVar2 = read(param_1[0xd], auStack_4c, 0x20);
        if (sVar2 != -1)
            break;
        piVar1 = __errno_location();
    } while (*piVar1 == 4);
    FUN_0007f028(param_1[1], 0);
    iVar5 = param_1[10];
    iVar3 = param_1[0xb];
    if (iVar5 == iVar3) {
        iVar4 = 0;
        sem_post((sem_t *)param_1[1]);
    } else {
        do {
            FUN_0009ce3c(iVar3, param_1[9]);
            iVar3 = iVar3 + 1;
            iVar4 = *(int *)(param_1[8] + extraout_r1 * 4);
            *(undefined4 *)(param_1[8] + extraout_r1 * 4) = 0;
        } while (iVar5 != iVar3 && iVar4 == 0);
        param_1[0xb] = iVar3;
        sem_post((sem_t *)param_1[1]);
        if (iVar4 == -1) {
            param_1[2] = 0;
            if ((sem_t *)param_1[1] != (sem_t *)0x0) {
                sem_destroy((sem_t *)param_1[1]);
            }
            param_1[1] = 0;
            if ((sem_t *)param_1[7] != (sem_t *)0x0) {
                sem_destroy((sem_t *)param_1[7]);
            }
            param_1[7] = 0;
            if ((sem_t *)param_1[0xc] != (sem_t *)0x0) {
                sem_destroy((sem_t *)param_1[0xc]);
            }
            iVar4 = 0;
            param_1[0xc] = 0;
            (*addremove_io_fd)(param_1[0xd], param_1[0xf], 1);
            close(param_1[0xe]);
            close(param_1[0xd]);
            param_1[5] = 0;
            param_1[6] = 0;
            param_1[10] = 0;
            param_1[0xb] = 0;
            param_1[0xe] = 0xffffffff;
            param_1[0xd] = 0xffffffff;
            *param_1 = 1;
        }
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar4);
}

/* WARNING: Removing unreachable block (ram,0x0007fad8) */

void FUN_0007fa74(int param_1)

{
    int iVar1;
    undefined4 uVar2;
    int extraout_r1;
    int extraout_r1_00;
    uint uVar3;
    int iVar4;
    int iVar5;
    uint uVar6;

    iVar1 = __stack_chk_guard;
    if (*(int *)(param_1 + 4) == 0) {
        return;
    }
    FUN_0007f028(*(undefined4 *)(param_1 + 4), 0);
    iVar4 = *(int *)(param_1 + 0x14);
    if (*(uint *)(param_1 + 0x10) <= (uint)(iVar4 - *(int *)(param_1 + 0x18))) {
        uVar6 = *(int *)(param_1 + 0x10) + 0x10;
        uVar2 = FUN_00074b04(*(undefined4 *)(param_1 + 0xc), uVar6 * 4, 0);
        *(undefined4 *)(param_1 + 0xc) = uVar2;
        uVar3 = *(uint *)(param_1 + 0x10);
        if (uVar3 < uVar6) {
            iVar4 = uVar3 << 2;
            do {
                uVar3 = uVar3 + 1;
                *(undefined4 *)(*(int *)(param_1 + 0xc) + iVar4) = 0;
                iVar4 = iVar4 + 4;
            } while (uVar6 != uVar3);
        }
        iVar4 = *(int *)(param_1 + 0x10);
        *(uint *)(param_1 + 0x10) = uVar6;
        *(undefined4 *)(param_1 + 0x18) = 0;
        *(int *)(param_1 + 0x14) = iVar4;
    }
    iVar5 = *(int *)(param_1 + 0xc);
    FUN_0009ce3c(iVar4, *(undefined4 *)(param_1 + 0x10));
    if (*(int *)(iVar5 + extraout_r1 * 4) == 0) {
        iVar5 = *(int *)(param_1 + 0xc);
        FUN_0009ce3c(iVar4, *(undefined4 *)(param_1 + 0x10));
        *(undefined4 *)(iVar5 + extraout_r1_00 * 4) = 0xffffffff;
        *(int *)(param_1 + 0x14) = iVar4 + 1;
        sem_post(*(sem_t **)(param_1 + 4));
        sem_post(*(sem_t **)(param_1 + 0x1c));
        if (iVar1 == __stack_chk_guard) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(0);
    }
    /* WARNING: Subroutine does not return */
    FUN_0007fc54(
        "work_thread.c", 0xdb, 2,
        "((void *)0) == c->workitems[c->head_workitem % c->workitems_alloc]");
}

void FUN_0007fae4(undefined4 *param_1, int param_2)

{
    int iVar1;
    uint uVar2;
    int *piVar3;
    uint uVar4;
    undefined1 *puVar5;
    uint uVar6;

    iVar1 = __stack_chk_guard;
    if (((param_1 == (undefined4 *)0x0) ||
         (puVar5 = (undefined1 *)*param_1, puVar5 == (undefined1 *)0x0)) ||
        (uVar6 = param_2 - (int)puVar5, (int)uVar6 < 1)) {
        piVar3 = __errno_location();
        uVar2 = 0xffffffff;
        *piVar3 = 0x16;
    } else {
        uVar2 = FUN_0007c654(puVar5, uVar6);
        if (0 < (int)uVar2) {
            uVar4 = uVar2;
            if (uVar6 <= uVar2) {
                uVar4 = 0;
            }
            puVar5 = puVar5 + uVar4;
            if (uVar6 <= uVar2) {
                uVar2 = uVar4;
            }
        }
        *puVar5 = 0;
        *param_1 = puVar5;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar2);
}

void FUN_0007fb98(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    undefined4 uStack_4;

    iVar1 = __stack_chk_guard;
    uStack_4 = param_4;
    FUN_0007fae4(param_1, param_2, param_3, &uStack_4, &uStack_4);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007fbfc(int param_1, int param_2, int param_3)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00077278(param_1 + -1, param_2 + -1, param_3 + -1);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2 + 1);
}

void FUN_0007fc54(void)

{
    (*DAT_000c8d80)();
    /* WARNING: Subroutine does not return */
    abort();
}

/* WARNING: Removing unreachable block (ram,0x0007fcf8) */

void FUN_0007fc94(code *param_1)

{
    DAT_000c8d80 = param_1;
    if (param_1 == (code *)0x0) {
        DAT_000c8d80 = FUN_0007fdb4;
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007fd98) */

void FUN_0007fd10(undefined4 param_1)

{
    switch (param_1) {
    case 0:
        break;
    case 1:
        break;
    case 2:
        break;
    case 3:
    }
    return;
}

void FUN_0007fdb4(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    FILE *pFVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    int iVar5;
    undefined4 *puVar6;
    char *pcVar7;
    int local_238;
    undefined4 local_234;
    undefined4 local_230;
    undefined4 local_22c[128];
    int local_2c;

    local_2c = __stack_chk_guard;
    iVar2 = FUN_0007ffec(local_22c, 0x80, &local_238);
    pFVar1 = stderr;
    if (iVar2 == 0) {
        if (local_238 < 1) {
            pcVar7 = ".";
        } else {
            pcVar7 = ", back trace";
        }
        uVar3 = FUN_0007fd10(param_3);
        uVar4 = FUN_0008487c(isc_msgcat, 1, 0x65, "failed");
        __fprintf_chk(pFVar1, 1, "%s:%d: %s(%s) %s%s\n", param_1, param_2,
                      uVar3, param_4, uVar4, pcVar7);
        if (0 < local_238) {
            iVar2 = 0;
            puVar6 = &local_230;
            do {
                puVar6 = puVar6 + 1;
                local_234 = 0;
                iVar5 = FUN_00080140(*puVar6, &local_234, &local_230);
                if (iVar5 == 0) {
                    uVar3 = local_234;
                    param_4 = local_230;
                    __fprintf_chk(stderr, 1, "#%d %p in %s()+0x%lx\n", iVar2,
                                  *puVar6, local_234, local_230, uVar4, pcVar7);
                } else {
                    __fprintf_chk(stderr, 1, "#%d %p in ??\n", iVar2, *puVar6,
                                  uVar3, param_4, uVar4, pcVar7);
                }
                iVar2 = iVar2 + 1;
            } while (iVar2 < local_238);
        }
    } else {
        uVar3 = FUN_0007fd10(param_3);
        uVar4 = FUN_0008487c(isc_msgcat, 1, 0x65, "failed");
        __fprintf_chk(pFVar1, 1, "%s:%d: %s(%s) %s%s\n", param_1, param_2,
                      uVar3, param_4, uVar4, ".");
    }
    fflush(stderr);
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00080034) */

void FUN_0007ffec(void)

{
    return;
}

/* WARNING: Removing unreachable block (ram,0x0008019c) */
/* WARNING: Removing unreachable block (ram,0x000801b0) */
/* WARNING: Removing unreachable block (ram,0x000801bc) */
/* WARNING: Removing unreachable block (ram,0x000801cc) */
/* WARNING: Removing unreachable block (ram,0x000801d0) */
/* WARNING: Removing unreachable block (ram,0x000801d4) */
/* WARNING: Removing unreachable block (ram,0x00080234) */
/* WARNING: Removing unreachable block (ram,0x000801e0) */
/* WARNING: Removing unreachable block (ram,0x000801e8) */
/* WARNING: Removing unreachable block (ram,0x0008023c) */
/* WARNING: Removing unreachable block (ram,0x000801f4) */
/* WARNING: Removing unreachable block (ram,0x00080224) */
/* WARNING: Removing unreachable block (ram,0x00080230) */
/* WARNING: Removing unreachable block (ram,0x00080258) */

void FUN_00080140(void)

{
    return;
}

void FUN_0008026c(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    __fprintf_chk(stderr, 1, "%s:%d: ", param_1, param_2);
    __vfprintf_chk(stderr, 1, param_3, param_4);
    fputc(10, stderr);
    if (iVar1 == __stack_chk_guard) {
        fflush(stderr);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00080310(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    FILE *pFVar2;
    undefined4 uVar3;

    pFVar2 = stderr;
    iVar1 = __stack_chk_guard;
    uVar3 = FUN_0008487c(isc_msgcat, 1, 0x6e, "fatal error");
    __fprintf_chk(pFVar2, 1, "%s:%d: %s: ", param_1, param_2, uVar3);
    __vfprintf_chk(stderr, 1, param_3, param_4);
    fputc(10, stderr);
    if (iVar1 == __stack_chk_guard) {
        fflush(stderr);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00080450) */

void FUN_000803ec(code *param_1)

{
    DAT_000c8d84 = param_1;
    if (param_1 == (code *)0x0) {
        DAT_000c8d84 = FUN_0008026c;
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x000804cc) */

void FUN_00080468(code *param_1)

{
    DAT_000c8d88 = param_1;
    if (param_1 == (code *)0x0) {
        DAT_000c8d88 = FUN_00080310;
    }
    return;
}

void FUN_000804e4(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    undefined4 uStack_4;

    iVar1 = __stack_chk_guard;
    uStack_4 = param_4;
    (*DAT_000c8d84)(param_1, param_2, param_3, &uStack_4, &uStack_4);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00080558(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    undefined4 uStack_4;

    uStack_4 = param_4;
    (*DAT_000c8d88)(param_1, param_2, param_3, &uStack_4, &uStack_4,
                    __stack_chk_guard);
    /* WARNING: Subroutine does not return */
    abort();
}

void FUN_000805ac(uint param_1, undefined4 param_2, uint param_3)

{
    uint uVar1;
    char *pcVar2;
    uint extraout_r2;
    FILE *__stream;
    int unaff_r8;
    uint extraout_r12;
    undefined4 *puVar3;
    undefined1 in_ZR;
    undefined4 local_28[3];
    int local_1c;

    puVar3 = local_28;
    local_1c = __stack_chk_guard;
    local_28[0] = FUN_0008487c(isc_msgcat, 1, 0x65, "failed");
    uVar1 = FUN_00080558(param_1, param_2, "RUNTIME_CHECK(%s) %s", param_3);
    if ((bool)in_ZR) {
        param_1 = unaff_r8 >> 0x1f & 0x82c;
        uVar1 = uVar1 & extraout_r12 >> 0x10 & 0x82c << (param_3 & 0xff);
        puVar3 = (undefined4 *)(extraout_r2 & 0x82c << (param_3 & 0xff));
    }
    __stream = *(FILE **)(uVar1 + 0xa8);
    *(undefined4 *)((int)puVar3 + -4) = 0x80618;
    *(uint *)((int)puVar3 + -8) = param_1;
    *(undefined4 *)((int)puVar3 + -0xc) = 0x82c;
    *(int *)((int)puVar3 + -0x14) = __stack_chk_guard;
    if ((__stream == (FILE *)0x0) ||
        (pcVar2 = fgets((char *)(uVar1 + 0xac), 0x3f, __stream),
         pcVar2 == (char *)0x0)) {
        *(undefined4 *)(uVar1 + 0xec) = 0x1d;
    } else {
        *(undefined4 *)(uVar1 + 0xec) = 0;
    }
    if (*(int *)((int)puVar3 + -0x14) != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0008062c(int param_1)

{
    int iVar1;
    char *pcVar2;

    iVar1 = __stack_chk_guard;
    if ((*(FILE **)(param_1 + 0xa8) == (FILE *)0x0) ||
        (pcVar2 =
             fgets((char *)(param_1 + 0xac), 0x3f, *(FILE **)(param_1 + 0xa8)),
         pcVar2 == (char *)0x0)) {
        *(undefined4 *)(param_1 + 0xec) = 0x1d;
    } else {
        *(undefined4 *)(param_1 + 0xec) = 0;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000806a8(int param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if ((*(int **)(param_1 + 0x14) == (int *)0x0) ||
        (iVar2 = **(int **)(param_1 + 0x14), *(int *)(param_1 + 0x14) = iVar2,
         iVar2 == 0)) {
        if (DAT_00118264 == 0) {
            if (iVar1 == __stack_chk_guard) {
                FUN_0008062c(param_1);
                return;
            }
            goto LAB_00080734;
        }
        param_1 = 0x1d;
    } else {
        param_1 = 0;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_00080734:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_00080744(int param_1, int *param_2, int param_3, char *param_4)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int iVar4;
    uint uVar5;

    iVar1 = __stack_chk_guard;
    memset(param_2, 0, 0x18);
    *param_2 = param_1;
    if (param_1 == 2) {
        param_2[1] = *(int *)(param_3 + 4);
    } else {
        if (param_1 != 10) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("./../lib/isc/unix/interfaceiter.c", 0x8f, 2, "0");
        }
        iVar2 = *(int *)(param_3 + 0xc);
        iVar3 = *(int *)(param_3 + 0x10);
        iVar4 = *(int *)(param_3 + 0x14);
        param_2[1] = *(int *)(param_3 + 8);
        param_2[2] = iVar2;
        param_2[3] = iVar3;
        param_2[4] = iVar4;
        uVar5 = *(uint *)(param_3 + 0x18);
        if (uVar5 != 0) {
        joined_r0x00080830:
            if (iVar1 == __stack_chk_guard) {
                FUN_00085c6c(param_2, uVar5);
                return;
            }
            goto LAB_00080894;
        }
        if ((*(uint *)(param_3 + 8) & 0xc0ff) == 0x80fe) {
            if (*(ushort *)(param_3 + 10) >> 8 == 0 &&
                (*(ushort *)(param_3 + 10) & 0xff) == 0) {
                if ((param_4 != (char *)0x0) &&
                    (uVar5 = if_nametoindex(param_4), uVar5 != 0))
                    goto joined_r0x00080830;
            } else {
                FUN_00085c6c(param_2);
                *(undefined1 *)((int)param_2 + 6) = 0;
                *(undefined1 *)((int)param_2 + 7) = 0;
            }
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_00080894:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000808bc(int *param_1)

{
    byte *pbVar1;
    size_t sVar2;
    char *pcVar3;
    char *pcVar4;
    undefined4 uVar5;
    int iVar6;
    uint uVar7;
    int iVar8;
    uint uVar9;
    byte *pbVar10;
    int *piVar11;
    byte *pbVar12;
    bool bVar13;
    int local_84;
    int local_80;
    undefined1 auStack_7c[4];
    uint local_78;
    byte local_74[16];
    byte abStack_64[20];
    byte local_50[36];
    int local_2c;

    local_2c = __stack_chk_guard;
    if ((param_1 == (int *)0x0) || (*param_1 != 0x49464947)) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/unix/ifiter_getifaddrs.c", 0x91, 0,
                     "(((iter) != ((void *)0)) && (((const isc__magic_t "
                     "*)(iter))->magic == (((\'I\') << 24 | (\'F\') << 16 | "
                     "(\'I\') << 8 | (\'G\')))))");
    }
    iVar8 = param_1[5];
    if (iVar8 == 0) {
        iVar8 = param_1[0x3b];
        if (iVar8 != 0)
            goto LAB_00080920;
        if (param_1[0x2a] == 0) {
            iVar8 = 0x19;
            FUN_00084350(isc_lctx, 0xc8dc4, 0xc8d9c, 0xfffffffc,
                         "/proc/net/if_inet6:iter->proc == NULL");
            goto LAB_00080920;
        }
        pbVar10 = local_50;
        iVar6 = sscanf((char *)(param_1 + 0x2b),
                       "%32[a-f0-9] %x %x %x %x %16s\n", pbVar10, &local_84,
                       &local_80, auStack_7c, &local_78, abStack_64);
        if (iVar6 != 6) {
            iVar8 = 0x19;
            FUN_00084350(isc_lctx, 0xc8dc4, 0xc8d9c, 0xfffffffc,
                         "/proc/net/if_inet6:sscanf() -> %d (expected 6)",
                         iVar6);
            goto LAB_00080920;
        }
        sVar2 = strlen((char *)pbVar10);
        if (sVar2 != 0x20) {
            iVar8 = 0x19;
            FUN_00084350(isc_lctx, 0xc8dc4, 0xc8d9c, 0xfffffffc,
                         "/proc/net/if_inet6:strlen(%s) != 32", pbVar10);
            goto LAB_00080920;
        }
        if ((local_78 & 0x40) == 0) {
            pbVar12 = local_74;
            do {
                pcVar3 = strchr("0123456789abcdef", (uint)*pbVar10);
                pbVar1 = pbVar10 + 1;
                pbVar10 = pbVar10 + 2;
                pcVar4 = strchr("0123456789abcdef", (uint)*pbVar1);
                *pbVar12 =
                    (char)pcVar4 - 0x3cU | ((char)pcVar3 + -0x3c) * '\x10';
                pbVar12 = pbVar12 + 1;
            } while (pbVar10 != local_50 + 0x20);
            piVar11 = param_1 + 0xf;
            param_1[0xe] = 10;
            param_1[0x27] = 1;
            FUN_00085bb8(piVar11, local_74);
            param_1[0x28] = local_84;
            iVar6 = FUN_00085fa8(piVar11);
            pbVar10 = local_74;
            if (iVar6 != 0) {
                FUN_00085c6c(piVar11, local_84);
            }
            do {
                pbVar12 = pbVar10 + 1;
                if (local_80 < 9) {
                    *pbVar10 = (byte)(0xff << (8U - local_80 & 0xff));
                    local_80 = 0;
                } else {
                    *pbVar10 = 0xff;
                    local_80 = local_80 + -8;
                }
                pbVar10 = pbVar12;
            } while (pbVar12 != abStack_64);
            FUN_00085bb8(param_1 + 0x15, local_74);
            strncpy((char *)(param_1 + 6), (char *)pbVar12, 0x20);
            goto LAB_00080920;
        }
    } else {
        if (*(int *)(iVar8 + 4) == 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("./../lib/isc/unix/ifiter_getifaddrs.c", 0xa3, 2,
                         "ifa->ifa_name != ((void *)0)");
        }
        if ((((*(uint *)(iVar8 + 8) & 0x40) != 0) &&
             (*(ushort **)(iVar8 + 0xc) != (ushort *)0x0)) &&
            (uVar9 = (uint) * *(ushort **)(iVar8 + 0xc),
             (uVar9 & 0xfffffff7) == 2)) {
            if (uVar9 == 10) {
                DAT_00118264 = 1;
            }
            piVar11 = param_1 + 6;
            memset(piVar11, 0, 0x8c);
            sVar2 = strlen(*(char **)(iVar8 + 4));
            memset(piVar11, 0, 0x20);
            if (0x1e < sVar2) {
                sVar2 = 0x1f;
            }
            memcpy(piVar11, *(void **)(iVar8 + 4), sVar2);
            uVar7 = *(uint *)(iVar8 + 8);
            param_1[0x27] = 0;
            bVar13 = (uVar7 & 1) != 0;
            param_1[0xe] = uVar9;
            if (bVar13) {
                param_1[0x27] = (uint)bVar13;
            }
            if ((uVar7 & 0x10) != 0) {
                param_1[0x27] = param_1[0x27] | 2;
            }
            if ((uVar7 & 8) != 0) {
                param_1[0x27] = param_1[0x27] | 4;
            }
            if ((uVar7 & 2) != 0) {
                param_1[0x27] = param_1[0x27] | 8;
            }
            uVar5 = *(undefined4 *)(iVar8 + 0xc);
            if ((uVar7 & 0x1000) != 0) {
                param_1[0x27] = param_1[0x27] | 0x10;
            }
            FUN_00080744(uVar9, param_1 + 0xf, uVar5,
                         *(undefined4 *)(iVar8 + 4));
            if (*(int *)(iVar8 + 0x10) != 0) {
                FUN_00080744(uVar9, param_1 + 0x15, *(int *)(iVar8 + 0x10),
                             *(undefined4 *)(iVar8 + 4));
            }
            iVar6 = *(int *)(iVar8 + 0x14);
            if (iVar6 != 0) {
                uVar7 = param_1[0x27];
                if ((uVar7 & 2) != 0) {
                    FUN_00080744(uVar9, param_1 + 0x21, iVar6,
                                 *(undefined4 *)(iVar8 + 4));
                    iVar6 = *(int *)(iVar8 + 0x14);
                    if (iVar6 == 0)
                        goto LAB_00080a54;
                    uVar7 = param_1[0x27];
                }
                if ((uVar7 & 8) != 0) {
                    FUN_00080744(uVar9, param_1 + 0x1b, iVar6,
                                 *(undefined4 *)(iVar8 + 4));
                }
            }
        LAB_00080a54:
            iVar8 = 0;
            uVar9 = if_nametoindex((char *)piVar11);
            param_1[0x28] = uVar9;
            goto LAB_00080920;
        }
    }
    iVar8 = 0x24;
LAB_00080920:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar8);
    }
    return;
}

void FUN_00080d88(int param_1, int *param_2)

{
    undefined4 *__ptr;
    int iVar1;
    int *piVar2;
    undefined4 uVar3;
    FILE *pFVar4;
    int iVar5;
    undefined1 auStack_a4[128];
    int local_24;

    local_24 = __stack_chk_guard;
    if (param_1 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/unix/ifiter_getifaddrs.c", 0x3c, 0,
                     "mctx != ((void *)0)");
    }
    if (param_2 == (int *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/unix/ifiter_getifaddrs.c", 0x3d, 0,
                     "iterp != ((void *)0)");
    }
    if (*param_2 != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/unix/ifiter_getifaddrs.c", 0x3e, 0,
                     "*iterp == ((void *)0)");
    }
    __ptr = (undefined4 *)FUN_00074b04(0, 0xf0, 0, 0);
    if (__ptr == (undefined4 *)0x0) {
        uVar3 = 1;
    } else {
        __ptr[1] = param_1;
        __ptr[2] = 0;
        __ptr[3] = 0;
        iVar5 = DAT_00118264;
        __ptr[4] = 0;
        if (iVar5 == 0) {
            pFVar4 = fopen64("/proc/net/if_inet6", "r");
            __ptr[0x2a] = pFVar4;
            if (pFVar4 == (FILE *)0x0) {
                piVar2 = __errno_location();
                FUN_00086b54(*piVar2, auStack_a4, 0x80);
                FUN_00084350(isc_lctx, 0xc8dc4, isc_modules, 0xfffffffd,
                             "failed to open /proc/net/if_inet6");
            }
        } else {
            __ptr[0x2a] = 0;
        }
        iVar5 = 3;
        __ptr[0x3b] = 0x19;
        do {
            iVar1 = getifaddrs(__ptr + 4);
            if (-1 < iVar1) {
                uVar3 = 0;
                __ptr[5] = 0;
                *__ptr = 0x49464947;
                __ptr[0x29] = 0x19;
                *param_2 = (int)__ptr;
                goto LAB_00080ec0;
            }
            piVar2 = __errno_location();
        } while ((*piVar2 == 4) && (iVar5 = iVar5 + -1, iVar5 != 0));
        FUN_00086b54(*piVar2, auStack_a4, 0x80);
        uVar3 = FUN_0008487c(isc_msgcat, 0x15, 0x709, "getifaddrs");
        FUN_000804e4("./../lib/isc/unix/ifiter_getifaddrs.c", 99,
                     "getting interface addresses: %s: %s", uVar3, auStack_a4);
        if ((FILE *)__ptr[0x2a] != (FILE *)0x0) {
            fclose((FILE *)__ptr[0x2a]);
        }
        if (__ptr[4] != 0) {
            freeifaddrs();
        }
        free(__ptr);
        uVar3 = 0x22;
    }
LAB_00080ec0:
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar3);
    }
    return;
}

void FUN_00081014(int param_1, void *param_2)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if (*(int *)(param_1 + 0xa4) != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/unix/interfaceiter.c", 0x10d, 0,
                     "iter->result == 0");
    }
    memcpy(param_2, (void *)(param_1 + 0x18), 0x8c);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(0);
}

void FUN_000810a0(int *param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    if ((param_1 == (int *)0x0) || (*param_1 != 0x49464947)) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/unix/interfaceiter.c", 0x116, 0,
                     "(((iter) != ((void *)0)) && (((const isc__magic_t "
                     "*)(iter))->magic == (((\'I\') << 24 | (\'F\') << 16 | "
                     "(\'I\') << 8 | (\'G\')))))");
    }
    if ((FILE *)param_1[0x2a] == (FILE *)0x0) {
        param_1[0x3b] = 0x1d;
    } else {
        rewind((FILE *)param_1[0x2a]);
        FUN_0008062c(param_1);
    }
    param_1[5] = param_1[4];
    do {
        iVar3 = FUN_000808bc(param_1);
        if (iVar3 != 0x24)
            break;
        iVar3 = FUN_000806a8(param_1);
    } while (iVar3 == 0);
    iVar2 = __stack_chk_guard;
    param_1[0x29] = iVar3;
    if (iVar1 != iVar2) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar3);
    }
    return;
}

void FUN_0008117c(int *param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    if ((param_1 == (int *)0x0) || (*param_1 != 0x49464947)) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/unix/interfaceiter.c", 0x129, 0,
                     "(((iter) != ((void *)0)) && (((const isc__magic_t "
                     "*)(iter))->magic == (((\'I\') << 24 | (\'F\') << 16 | "
                     "(\'I\') << 8 | (\'G\')))))");
    }
    if (param_1[0x29] != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/unix/interfaceiter.c", 0x12a, 0,
                     "iter->result == 0");
    }
    do {
        iVar3 = FUN_000806a8(param_1);
        if (iVar3 != 0)
            break;
        iVar3 = FUN_000808bc(param_1);
    } while (iVar3 == 0x24);
    iVar2 = __stack_chk_guard;
    param_1[0x29] = iVar3;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar3);
}

void FUN_00081260(undefined4 *param_1)

{
    int iVar1;
    int *__ptr;

    iVar1 = __stack_chk_guard;
    if (param_1 == (undefined4 *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/unix/interfaceiter.c", 0x13c, 0,
                     "iterp != ((void *)0)");
    }
    __ptr = (int *)*param_1;
    if ((__ptr != (int *)0x0) && (*__ptr == 0x49464947)) {
        if ((FILE *)__ptr[0x2a] != (FILE *)0x0) {
            fclose((FILE *)__ptr[0x2a]);
        }
        __ptr[0x2a] = 0;
        if (__ptr[4] != 0) {
            freeifaddrs();
        }
        __ptr[4] = 0;
        if ((void *)__ptr[2] != (void *)0x0) {
            free((void *)__ptr[2]);
        }
        free(__ptr);
        *param_1 = 0;
        if (iVar1 == __stack_chk_guard) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    /* WARNING: Subroutine does not return */
    FUN_0007fc54(
        "./../lib/isc/unix/interfaceiter.c", 0x13e, 0,
        "(((iter) != ((void *)0)) && (((const isc__magic_t *)(iter))->magic == "
        "(((\'I\') << 24 | (\'F\') << 16 | (\'I\') << 8 | (\'G\')))))");
}

void FUN_000813c4(void)

{
    int iVar1;
    undefined4 uVar2;
    int iVar3;
    undefined4 uVar4;
    undefined4 uVar5;

    iVar1 = __stack_chk_guard;
    iVar3 = pthread_once((pthread_once_t *)&DAT_00118268,
                         (__init_routine *)&DAT_00081364);
    uVar2 = stderr;
    if (iVar3 != 0) {
        uVar4 = FUN_0008487c(isc_msgcat, 1, 0x6e, "fatal error");
        uVar5 = FUN_0008487c(isc_msgcat, 1, 0x65, "failed");
        __fprintf_chk(uVar2, 1, "%s:%d: %s: isc_once_do() %s.\n",
                      "./../lib/isc/lib.c", 0x4d, uVar4, uVar5);
        /* WARNING: Subroutine does not return */
        abort();
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000817ac(int param_1)

{
    char *pcVar1;
    size_t __n;
    int iVar2;
    int iVar3;
    long lVar4;
    uint uVar5;
    undefined4 uVar6;
    int iVar7;
    char *pcVar8;
    char *__s;
    char *local_2544;
    undefined1 auStack_2540[1028];
    char acStack_213c[256];
    uint local_203c;
    undefined1 auStack_2034[4100];
    undefined1 auStack_1030[4100];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (*(int *)(param_1 + 0x18) != -2) {
        __s = *(char **)(param_1 + 0x14);
        if (*(int *)(param_1 + 4) != 3) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("./../lib/isc/log.c", 0x485, 0, "channel->type == 3");
        }
        pcVar1 = strrchr(__s, 0x2f);
        if (pcVar1 == (char *)0x0) {
            pcVar8 = ".";
            pcVar1 = __s;
        } else {
            *pcVar1 = '\0';
            pcVar8 = *(char **)(param_1 + 0x14);
            pcVar1 = pcVar1 + 1;
        }
        __n = strlen(pcVar1);
        FUN_0008b610(auStack_2540);
        iVar2 = FUN_0008b69c(auStack_2540, pcVar8);
        if (pcVar1 != *(char **)(param_1 + 0x14)) {
            pcVar1[-1] = '/';
        }
        if (iVar2 != 0)
            goto LAB_00081ae0;
        iVar2 = -1;
        while (iVar3 = FUN_0008b804(auStack_2540), iVar3 == 0) {
            while (
                ((__n < local_203c &&
                  (iVar3 = strncmp(acStack_213c, pcVar1, __n), iVar3 == 0)) &&
                 (acStack_213c[__n] == '.'))) {
                lVar4 = strtol(acStack_213c + __n + 1, &local_2544, 10);
                if (*local_2544 == '\0' && iVar2 < lVar4) {
                    iVar2 = lVar4;
                }
                iVar3 = FUN_0008b804(auStack_2540);
                if (iVar3 != 0)
                    goto LAB_00081908;
            }
        }
    LAB_00081908:
        iVar2 = iVar2 + 1;
        FUN_0008b8e8(auStack_2540);
        iVar3 = *(int *)(param_1 + 0x18);
        if (iVar3 <= iVar2 && iVar3 != -1) {
        LAB_0008194c:
            iVar2 = iVar2 + -1;
            iVar7 = iVar2;
            if (iVar3 <= iVar2) {
                do {
                    uVar5 =
                        FUN_0007d00c(auStack_2034, 0x1001, "%s.%d", __s, iVar7);
                    if (uVar5 < 0x1001) {
                        iVar2 = FUN_0008c9d8(auStack_2034);
                        if (iVar2 == 0x26 || iVar2 == 0)
                            goto code_r0x00081b58;
                    } else {
                        iVar2 = 0x13;
                    }
                    uVar6 = FUN_000864e0(iVar2);
                    iVar2 = iVar7 + -1;
                    __syslog_chk(3, 1,
                                 "unable to remove log file \'%s.%d\': %s", __s,
                                 iVar7, uVar6);
                    iVar3 = *(int *)(param_1 + 0x18);
                    iVar7 = iVar2;
                    if (iVar2 < iVar3)
                        break;
                } while (true);
            }
        }
        if (0 < iVar2) {
            do {
                while (true) {
                    iVar3 = iVar2 + -1;
                    uVar5 =
                        FUN_0007d00c(auStack_2034, 0x1001, "%s.%d", __s, iVar3);
                    if (uVar5 < 0x1001)
                        break;
                LAB_00081a48:
                    iVar7 = 0x13;
                LAB_00081a4c:
                    uVar6 = FUN_000864e0(iVar7);
                    __syslog_chk(
                        3, 1,
                        "unable to rename log file \'%s.%d\' to \'%s.%d\': %s",
                        __s, iVar3, __s, iVar2, uVar6);
                    iVar2 = iVar3;
                    if (iVar3 == 0)
                        goto LAB_00081a80;
                }
                uVar5 = FUN_0007d00c(auStack_1030, 0x1001, "%s.%d", __s, iVar2);
                if (0x1000 < uVar5)
                    goto LAB_00081a48;
                iVar7 = FUN_0008ca84(auStack_2034, auStack_1030);
                if (iVar7 != 0x26 && iVar7 != 0)
                    goto LAB_00081a4c;
                iVar2 = iVar3;
            } while (iVar3 != 0);
        LAB_00081a80:
            iVar3 = *(int *)(param_1 + 0x18);
        }
        if (iVar3 == 0) {
            iVar2 = FUN_0008c9d8(__s);
            if (iVar2 != 0x26 && iVar2 != 0) {
                uVar6 = FUN_000864e0();
                __syslog_chk(3, 1, "unable to remove log file \'%s\': %s", __s,
                             uVar6);
                iVar2 = 0;
                goto LAB_00081ae0;
            }
        } else {
            uVar5 = FUN_0007d00c(auStack_1030, 0x1001, &DAT_000ae180, __s);
            if (uVar5 < 0x1001) {
                iVar2 = FUN_0008ca84(__s, auStack_1030);
                if (iVar2 == 0x26 || iVar2 == 0)
                    goto LAB_00081adc;
            } else {
                iVar2 = 0x13;
            }
            uVar6 = FUN_000864e0(iVar2);
            __syslog_chk(3, 1,
                         "unable to rename log file \'%s\' to \'%s.0\': %s",
                         __s, __s, uVar6);
        }
    }
LAB_00081adc:
    iVar2 = 0;
LAB_00081ae0:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar2);
    }
    return;
code_r0x00081b58:
    iVar3 = *(int *)(param_1 + 0x18);
    iVar2 = iVar7;
    goto LAB_0008194c;
}

/* WARNING: Removing unreachable block (ram,0x00083628) */

void FUN_0008359c(void)

{
    return;
}

void FUN_00083634(int *param_1, undefined4 *param_2, undefined4 *param_3,
                  int param_4, int param_5, int param_6, undefined4 param_7,
                  undefined4 param_8, int param_9, undefined4 param_10)

{
    int iVar1;
    uint uVar2;
    uint uVar3;
    undefined4 uVar4;
    int *piVar5;
    size_t sVar6;
    int *piVar7;
    undefined *puVar8;
    uint uVar9;
    int iVar10;
    int iVar11;
    undefined4 *puVar12;
    undefined *puVar13;
    pthread_mutex_t *__mutex;
    uint uVar14;
    char *pcVar15;
    char *pcVar16;
    int iVar17;
    undefined4 *__ptr;
    undefined *puVar18;
    undefined4 uVar19;
    undefined *puVar20;
    char *pcVar21;
    undefined4 *puVar22;
    int iVar23;
    undefined *puVar24;
    undefined *puVar25;
    bool bVar26;
    int local_194;
    undefined *local_190;
    undefined1 auStack_160[8];
    stat64 sStack_158;
    stat64 sStack_f0;
    char local_84[24];
    char local_6c[64];
    int local_2c;

    local_2c = __stack_chk_guard;
    local_194 = param_9;
    if ((param_1 != (int *)0x0) && (*param_1 != 0x4c637478)) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/log.c", 0x590, 0,
                     "lctx == ((void *)0) || (((lctx) != ((void *)0)) && "
                     "(((const isc__magic_t *)(lctx))->magic == (((\'L\') << "
                     "24 | (\'c\') << 16 | (\'t\') << 8 | (\'x\')))))");
    }
    if (param_2 == (undefined4 *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/log.c", 0x591, 0, "category != ((void *)0)");
    }
    if (param_3 == (undefined4 *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/log.c", 0x592, 0, "module != ((void *)0)");
    }
    if (param_4 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/log.c", 0x593, 0, "level != 0");
    }
    if (param_9 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/log.c", 0x594, 0, "format != ((void *)0)");
    }
    if (param_1 != (int *)0x0) {
        if ((uint)param_1[3] <= (uint)param_2[1]) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("./../lib/isc/log.c", 0x59e, 0,
                         "category->id < lctx->category_count");
        }
        if ((uint)param_1[5] <= (uint)param_3[1]) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("./../lib/isc/log.c", 0x59f, 0,
                         "module->id < lctx->module_count");
        }
        iVar1 = FUN_0008359c(param_1, param_4);
        if (iVar1 != 0) {
            if (param_6 != 0) {
                local_194 = FUN_0008487c(param_6, param_7, param_8, param_9);
            }
            __mutex = (pthread_mutex_t *)(param_1 + 7);
            local_6c[0] = '\0';
            local_84[0] = '\0';
            iVar1 = pthread_mutex_lock(__mutex);
            if (iVar1 != 0) {
                FUN_000805ac("./../lib/isc/log.c", 0x5ac,
                             "((pthread_mutex_lock(((&lctx->lock))) == 0) ? 0 "
                             ": 34) == 0");
            }
            uVar9 = 0;
            iVar1 = param_1[0xd];
            *(undefined1 *)(param_1 + 0xe) = 0;
            puVar22 = *(undefined4 **)(*(int *)(iVar1 + 0x10) + param_2[1] * 8);
            uVar14 = (uint)(puVar22 == (undefined4 *)0x0);
            do {
                while (true) {
                    if (((uVar14 & (uVar9 ^ 1)) != 0) &&
                        (puVar22 =
                             (undefined4 *)**(undefined4 **)(iVar1 + 0x10),
                         (undefined4 *)**(undefined4 **)(iVar1 + 0x10) ==
                             (undefined4 *)0x0)) {
                        puVar22 = &DAT_00118270;
                    }
                    if (param_3 == (undefined4 *)*puVar22 ||
                        (undefined4 *)*puVar22 == (undefined4 *)0x0)
                        break;
                    puVar22 = (undefined4 *)puVar22[3];
                    uVar2 = uVar9;
                LAB_000837bc:
                    uVar14 = (uint)(puVar22 == (undefined4 *)0x0);
                    if ((uVar14 & uVar2) != 0)
                        goto LAB_00083834;
                }
                iVar17 = puVar22[1];
                puVar22 = (undefined4 *)puVar22[3];
                uVar14 = *(uint *)(iVar17 + 0xc);
                if (((uVar14 & 0x1000) == 0) || (param_1[6] != 0)) {
                    iVar10 = *(int *)(iVar17 + 8);
                    if (iVar10 == 0) {
                        iVar10 = param_1[6];
                    }
                    if (param_4 <= iVar10) {
                        if (((uVar14 & 1) != 0) && (local_6c[0] == '\0')) {
                            iVar10 = FUN_00087034(&sStack_f0);
                            if (iVar10 != 0) {
                                FUN_000805ac("./../lib/isc/log.c", 0x5eb,
                                             "isc_time_now((&isctime)) == 0");
                            }
                            FUN_00087a60(&sStack_f0, local_6c, 0x40);
                            uVar14 = *(uint *)(iVar17 + 0xc);
                        }
                        if (((uVar14 & 2) != 0) && (local_84[0] == '\0')) {
                            if (param_4 + 5 < 0 == SCARRY4(param_4, 5)) {
                                if (param_4 < 1) {
                                    FUN_0007d00c(
                                        local_84, 0x18, &DAT_000ae920,
                                        (&PTR_s_debug_000c61e8)[-param_4]);
                                } else {
                                    FUN_0007d00c(local_84, 0x18,
                                                 "%s %d: ", "debug", param_4);
                                }
                            } else {
                                uVar4 = FUN_0008487c(isc_msgcat, 10, 0x322,
                                                     "level");
                                FUN_0007d00c(local_84, 0x18, "%s %d: ", uVar4,
                                             param_4);
                            }
                        }
                        if ((char)param_1[0xe] == '\0') {
                            piVar5 = param_1 + 0xe;
                            FUN_0007c654(piVar5, 0x2000, local_194, param_10);
                            if (param_5 != 0) {
                                FUN_00086cf0(&sStack_f0,
                                             *(undefined4 *)(iVar1 + 0x18), 0);
                                iVar10 = FUN_00087034(auStack_160);
                                if (iVar10 != 0) {
                                    FUN_000805ac(
                                        "./../lib/isc/log.c", 0x61a,
                                        "isc_time_now((&oldest)) == 0");
                                }
                                iVar10 = FUN_00087610(auStack_160, &sStack_f0,
                                                      auStack_160);
                                if (iVar10 == 0) {
                                    __ptr = (undefined4 *)param_1[0x80e];
                                    while (__ptr != (undefined4 *)0x0) {
                                        iVar10 = FUN_000873e0(__ptr + 1,
                                                              auStack_160);
                                        if (iVar10 < 0) {
                                            puVar12 = (undefined4 *)__ptr[4];
                                            if (puVar12 == (undefined4 *)0x0) {
                                                if ((undefined4 *)
                                                        param_1[0x80f] !=
                                                    __ptr) {
                                                    /* WARNING: Subroutine does
                                                     * not return */
                                                    FUN_0007fc54(
                                                        "./../lib/isc/log.c",
                                                        0x638, 2,
                                                        "(lctx->messages).tail "
                                                        "== (message)");
                                                }
                                                iVar10 = __ptr[3];
                                                param_1[0x80f] = iVar10;
                                            } else {
                                                puVar12[3] = __ptr[3];
                                                iVar10 = __ptr[3];
                                            }
                                            if (iVar10 == 0) {
                                                if ((undefined4 *)
                                                        param_1[0x80e] !=
                                                    __ptr) {
                                                    /* WARNING: Subroutine does
                                                     * not return */
                                                    FUN_0007fc54(
                                                        "./../lib/isc/log.c",
                                                        0x638, 2,
                                                        "(lctx->messages).head "
                                                        "== (message)");
                                                }
                                                param_1[0x80e] = (int)puVar12;
                                            } else {
                                                *(undefined4 **)(iVar10 +
                                                                 0x10) =
                                                    puVar12;
                                            }
                                            free(__ptr);
                                            __ptr = puVar12;
                                        } else {
                                            iVar10 = strcmp((char *)piVar5,
                                                            (char *)*__ptr);
                                            if (iVar10 == 0) {
                                                iVar1 = pthread_mutex_unlock(
                                                    __mutex);
                                                if (iVar1 != 0) {
                                                    FUN_000805ac(
                                                        "./../lib/isc/log.c",
                                                        0x64e,
                                                        "((pthread_mutex_"
                                                        "unlock(((&lctx->lock))"
                                                        ") == 0) ? 0 : 34) == "
                                                        "0");
                                                }
                                                goto LAB_00083844;
                                            }
                                            __ptr = (undefined4 *)__ptr[4];
                                        }
                                    }
                                }
                                sVar6 = strlen((char *)piVar5);
                                piVar7 =
                                    (int *)FUN_00074b04(0, sVar6 + 0x15, 0);
                                if (piVar7 != (int *)0x0) {
                                    *piVar7 = (int)(piVar7 + 5);
                                    FUN_0007e4b4(piVar7 + 5, piVar5, sVar6 + 1);
                                    iVar10 = FUN_00087034(piVar7 + 1);
                                    if (iVar10 != 0) {
                                        FUN_000805ac(
                                            "./../lib/isc/log.c", 0x665,
                                            "isc_time_now((&new->time)) == 0");
                                    }
                                    iVar10 = param_1[0x80f];
                                    if (iVar10 == 0) {
                                        param_1[0x80e] = (int)piVar7;
                                    } else {
                                        *(int **)(iVar10 + 0x10) = piVar7;
                                    }
                                    piVar7[3] = iVar10;
                                    piVar7[4] = 0;
                                    param_1[0x80f] = (int)piVar7;
                                }
                            }
                        }
                        uVar14 = *(uint *)(iVar17 + 0xc);
                        uVar9 = uVar14 & 0x10;
                        if ((uVar9 != 0) &&
                            (uVar9 = *(uint *)(iVar1 + 0x20), uVar9 != 0)) {
                            uVar9 = 1;
                        }
                        iVar10 = *(int *)(iVar17 + 4);
                        iVar11 = uVar14 << 0x1d;
                        iVar23 = uVar14 << 0x1c;
                        if (iVar10 == 3) {
                            if (*(int *)(iVar17 + 0x28) == 0) {
                                iVar10 = *(int *)(iVar17 + 0x10);
                                if (iVar10 != 0)
                                    goto LAB_0008396c;
                            } else {
                                if ((*(int *)(iVar17 + 0x18) == -2) &&
                                    (((iVar10 = __xstat64(
                                           3, *(char **)(iVar17 + 0x14),
                                           &sStack_158),
                                       iVar10 == 0 ||
                                           (piVar5 = __errno_location(),
                                            *piVar5 != 2)) &&
                                      (iVar10 = *(int *)(iVar17 + 0x24),
                                       bVar26 = (uint)sStack_158.st_size <
                                                *(uint *)(iVar17 + 0x20),
                                       (int)(sStack_158.st_size._4_4_ -
                                             (iVar10 + (uint)bVar26)) < 0 ==
                                           (SBORROW4(sStack_158.st_size._4_4_,
                                                     iVar10) !=
                                            SBORROW4(sStack_158.st_size._4_4_ -
                                                         iVar10,
                                                     (uint)bVar26))))))
                                    goto LAB_00083938;
                                fclose(*(FILE **)(iVar17 + 0x10));
                                *(undefined4 *)(iVar17 + 0x10) = 0;
                                *(undefined4 *)(iVar17 + 0x28) = 0;
                                if (*(int *)(iVar17 + 4) != 3) {
                                    /* WARNING: Subroutine does not return */
                                    FUN_0007fc54("./../lib/isc/log.c", 0x52e, 0,
                                                 "channel->type == 3");
                                }
                            }
                            pcVar15 = *(char **)(iVar17 + 0x14);
                            if ((pcVar15 == (char *)0x0) ||
                                (*pcVar15 == '\0')) {
                                /* WARNING: Subroutine does not return */
                                FUN_0007fc54(
                                    "./../lib/isc/log.c", 0x533, 0,
                                    "path != ((void *)0) && *path != \'\\0\'");
                            }
                            iVar10 = __xstat64(3, pcVar15, &sStack_f0);
                            if (iVar10 != 0)
                                goto LAB_0008407c;
                            uVar3 = *(uint *)(iVar17 + 0x20);
                            iVar10 = *(int *)(iVar17 + 0x24);
                            uVar2 =
                                (uint)((sStack_f0.st_mode & 0xf000) == 0x8000);
                            if (uVar3 != 0 || iVar10 != 0) {
                                if (((iVar10 < (int)(uint)(uVar3 == 0)) ||
                                     ((int)(sStack_f0.st_size._4_4_ -
                                            (iVar10 +
                                             (uint)((uint)sStack_f0.st_size <
                                                    uVar3))) < 0 !=
                                      (SBORROW4(sStack_f0.st_size._4_4_,
                                                iVar10) !=
                                       SBORROW4(sStack_f0.st_size._4_4_ -
                                                    iVar10,
                                                (uint)((uint)sStack_f0.st_size <
                                                       uVar3))))) ||
                                    (uVar2 == 0))
                                    goto LAB_0008407c;
                                if (*(int *)(iVar17 + 0x18) != -2)
                                    goto LAB_00083cd4;
                            LAB_000840e0:
                                uVar9 = 1;
                                goto LAB_000837bc;
                            }
                            if ((*(int *)(iVar17 + 0x18) == -2) ||
                                (uVar2 == 0)) {
                            LAB_0008407c:
                                uVar3 = FUN_00086698(pcVar15, &DAT_000aaf30,
                                                     iVar17 + 0x10);
                                uVar2 = uVar3;
                                if (uVar3 != 0) {
                                    uVar2 = 1;
                                }
                                if (uVar3 == 0x3a || uVar3 == 0) {
                                    if (uVar2 == 0) {
                                        iVar10 = *(int *)(iVar17 + 0x10);
                                        *(uint *)(iVar17 + 0xc) =
                                            *(uint *)(iVar17 + 0xc) &
                                            0xffff7fff;
                                        goto LAB_0008396c;
                                    }
                                    goto LAB_000840e0;
                                }
                                uVar14 = *(uint *)(iVar17 + 0xc);
                            } else {
                            LAB_00083cd4:
                                uVar3 = FUN_000817ac(iVar17);
                                if (uVar3 == 0)
                                    goto LAB_0008407c;
                                uVar14 = *(uint *)(iVar17 + 0xc);
                                if ((uVar14 & 0x8000) == 0) {
                                    uVar19 = *(undefined4 *)(iVar17 + 0x14);
                                    uVar4 = FUN_000864e0();
                                    __syslog_chk(3, 1,
                                                 "isc_log_open: roll_log "
                                                 "\'%s\' failed: %s",
                                                 uVar19, uVar4);
                                    uVar14 = *(uint *)(iVar17 + 0xc) | 0x8000;
                                    *(uint *)(iVar17 + 0xc) = uVar14;
                                }
                                if (uVar3 == 0x3a)
                                    goto LAB_00083938;
                            }
                            if ((uVar14 & 0x8000) == 0) {
                                uVar19 = *(undefined4 *)(iVar17 + 0x14);
                                uVar4 = FUN_000864e0(uVar3);
                                __syslog_chk(3, 1,
                                             "isc_log_open \'%s\' failed: %s",
                                             uVar19, uVar4);
                                *(uint *)(iVar17 + 0xc) =
                                    *(uint *)(iVar17 + 0xc) | 0x8000;
                            }
                        } else {
                            if (iVar10 != 4) {
                                if (iVar10 != 2)
                                    goto LAB_00083938;
                                if (param_4 < 1) {
                                    uVar2 = 2;
                                    if (param_4 + 5 < 0 ==
                                        SCARRY4(param_4, 5)) {
                                        uVar2 = *(uint *)(&DAT_000adfd4 +
                                                          param_4 * -4);
                                    }
                                } else {
                                    uVar2 = 7;
                                }
                                if ((uVar14 & 1) == 0) {
                                    pcVar16 = "";
                                    pcVar15 = pcVar16;
                                    if (uVar9 == 0)
                                        goto LAB_00083e00;
                                LAB_00083ba4:
                                    puVar13 = *(undefined **)(iVar1 + 0x20);
                                    puVar24 = &DAT_000ae7c0;
                                    if (iVar11 < 0)
                                        goto LAB_00083bbc;
                                LAB_00083e18:
                                    puVar8 = &DAT_000a9528;
                                    puVar25 = puVar8;
                                    if (-1 < iVar23)
                                        goto LAB_00083e2c;
                                LAB_00083bd4:
                                    puVar18 = (undefined *)*param_3;
                                    puVar20 = &DAT_000ae7c0;
                                } else {
                                    pcVar16 = local_6c;
                                    pcVar15 = " ";
                                    if (uVar9 != 0)
                                        goto LAB_00083ba4;
                                LAB_00083e00:
                                    puVar13 = &DAT_000a9528;
                                    puVar24 = puVar13;
                                    if (-1 < iVar11)
                                        goto LAB_00083e18;
                                LAB_00083bbc:
                                    puVar8 = &DAT_000ae7c0;
                                    puVar25 = (undefined *)*param_2;
                                    if (iVar23 < 0)
                                        goto LAB_00083bd4;
                                LAB_00083e2c:
                                    puVar18 = &DAT_000a9528;
                                    puVar20 = puVar18;
                                }
                                if ((int)(uVar14 << 0x1e) < 0) {
                                    pcVar21 = local_84;
                                } else {
                                    pcVar21 = "";
                                }
                                __syslog_chk(uVar2 | *(uint *)(iVar17 + 0x10),
                                             1, "%s%s%s%s%s%s%s%s%s%s", pcVar16,
                                             pcVar15, puVar13, puVar24, puVar25,
                                             puVar8, puVar18, puVar20, pcVar21,
                                             param_1 + 0xe);
                                uVar9 = 1;
                                uVar2 = 1;
                                goto LAB_000837bc;
                            }
                            iVar10 = *(int *)(iVar17 + 0x10);
                        LAB_0008396c:
                            if ((uVar14 & 1) == 0) {
                                pcVar15 = "";
                                pcVar16 = pcVar15;
                                if (uVar9 == 0)
                                    goto LAB_00083d8c;
                            LAB_00083988:
                                puVar24 = *(undefined **)(iVar1 + 0x20);
                                puVar13 = &DAT_000ae7c0;
                            } else {
                                pcVar15 = local_6c;
                                pcVar16 = " ";
                                if (uVar9 != 0)
                                    goto LAB_00083988;
                            LAB_00083d8c:
                                puVar24 = &DAT_000a9528;
                                puVar13 = puVar24;
                            }
                            puVar25 = &DAT_000a9528;
                            puVar8 = &DAT_000a9528;
                            if (iVar11 < 0) {
                                puVar25 = (undefined *)*param_2;
                                puVar8 = &DAT_000ae7c0;
                            }
                            puVar20 = &DAT_000a9528;
                            local_190 = &DAT_000a9528;
                            if (iVar23 < 0) {
                                puVar20 = &DAT_000ae7c0;
                                local_190 = (undefined *)*param_3;
                            }
                            if ((int)(uVar14 << 0x1e) < 0) {
                                pcVar21 = local_84;
                            } else {
                                pcVar21 = "";
                            }
                            __fprintf_chk(iVar10, 1, "%s%s%s%s%s%s%s%s%s%s\n",
                                          pcVar15, pcVar16, puVar24, puVar13,
                                          puVar25, puVar8, local_190, puVar20,
                                          pcVar21, param_1 + 0xe);
                            fflush(*(FILE **)(iVar17 + 0x10));
                            if ((int)(uint)(*(int *)(iVar17 + 0x20) == 0) <=
                                *(int *)(iVar17 + 0x24)) {
                                if (*(int *)(iVar17 + 4) != 3) {
                                    /* WARNING: Subroutine does not return */
                                    FUN_0007fc54("./../lib/isc/log.c", 0x6bb, 2,
                                                 "channel->type == 3");
                                }
                                iVar10 = fileno(*(FILE **)(iVar17 + 0x10));
                                iVar10 = __fxstat64(3, iVar10, &sStack_158);
                                if ((-1 < iVar10) &&
                                    (iVar10 = *(int *)(iVar17 + 0x24),
                                     bVar26 = *(uint *)(iVar17 + 0x20) <
                                              (uint)sStack_158.st_size,
                                     (int)(iVar10 - (sStack_158.st_size._4_4_ +
                                                     (uint)bVar26)) < 0 !=
                                         (SBORROW4(iVar10,
                                                   sStack_158.st_size._4_4_) !=
                                          SBORROW4(iVar10 -
                                                       sStack_158.st_size._4_4_,
                                                   (uint)bVar26)))) {
                                    *(undefined4 *)(iVar17 + 0x28) = 1;
                                    uVar9 = 1;
                                    uVar2 = 1;
                                    goto LAB_000837bc;
                                }
                            }
                        }
                    }
                LAB_00083938:
                    uVar9 = 1;
                    uVar2 = uVar9;
                    goto LAB_000837bc;
                }
                uVar9 = 1;
                uVar14 = (uint)(puVar22 == (undefined4 *)0x0);
            } while (puVar22 != (undefined4 *)0x0);
        LAB_00083834:
            iVar1 = pthread_mutex_unlock(__mutex);
            if (iVar1 != 0) {
                FUN_000805ac("./../lib/isc/log.c", 0x6e6,
                             "((pthread_mutex_unlock(((&lctx->lock))) == 0) ? "
                             "0 : 34) == 0");
            }
        }
    }
LAB_00083844:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00084350(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_00083634();
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000843c0(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_00083634();
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00084924) */

void FUN_0008487c(int *param_1, int param_2, int param_3, int param_4)

{
    if ((param_1 != (int *)0x0) && (*param_1 != 0x4d436174)) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/nls/msgcat.c", 0x77, 0,
                     "(((msgcat) != ((void *)0)) && (((const isc__magic_t "
                     "*)(msgcat))->magic == (((\'M\') << 24 | (\'C\') << 16 | "
                     "(\'a\') << 8 | (\'t\'))))) || msgcat == ((void *)0)");
    }
    if (param_2 < 1) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/nls/msgcat.c", 0x78, 0, "set > 0");
    }
    if (param_3 < 1) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/nls/msgcat.c", 0x79, 0, "message > 0");
    }
    if (param_4 != 0) {
        return;
    }
    /* WARNING: Subroutine does not return */
    FUN_0007fc54("./../lib/isc/nls/msgcat.c", 0x7a, 0,
                 "default_text != ((void *)0)");
}

void FUN_00084988(int param_1)

{
    int iVar1;
    int *piVar2;
    int iVar3;
    undefined4 uVar4;
    socklen_t local_c4;
    sockaddr sStack_c0;
    undefined1 auStack_a4[128];
    int local_24;

    local_24 = __stack_chk_guard;
    iVar1 = socket(param_1, 1, 0);
    if (iVar1 == -1) {
        piVar2 = __errno_location();
        iVar1 = *piVar2;
        if (((iVar1 == 0x5d) || (iVar1 == 0x61)) || (iVar1 == 0x16)) {
            uVar4 = 0x17;
        } else {
            FUN_00086b54(iVar1, auStack_a4, 0x80);
            uVar4 = FUN_0008487c(isc_msgcat, 1, 0x65, "failed");
            FUN_000804e4("./../lib/isc/unix/net.c", 0x90, "socket() %s: %s",
                         uVar4, auStack_a4);
            uVar4 = 0x22;
        }
        goto LAB_000849dc;
    }
    if (param_1 == 10) {
        local_c4 = 0x1c;
        iVar3 = getsockname(iVar1, &sStack_c0, &local_c4);
        if (iVar3 < 0) {
            FUN_00084350(isc_lctx, 0xc8dc4, isc_modules, 0xfffffffc,
                         "retrieving the address of an IPv6 socket from the "
                         "kernel failed.");
        } else {
            if (local_c4 == 0x1c)
                goto LAB_000849cc;
            FUN_00084350(
                isc_lctx, 0xc8dc4, isc_modules, 0xfffffffc,
                "IPv6 structures in kernel and user space do not match.");
        }
        uVar4 = 0x17;
        FUN_00084350(isc_lctx, 0xc8dc4, isc_modules, 0xfffffffc,
                     "IPv6 is not supported.");
    } else {
    LAB_000849cc:
        uVar4 = 0;
    }
    close(iVar1);
LAB_000849dc:
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar4);
}

void FUN_00084bf0(void)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = pthread_once((pthread_once_t *)&DAT_00118284,
                         (__init_routine *)&LAB_00084b88);
    if (iVar2 == 0) {
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        FUN_000805ac("./../lib/isc/unix/net.c", 0xdd,
                     "((pthread_once((&once), (initialize_action)) == 0) ? 0 : "
                     "34) == 0");
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00084c88(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_00084bf0();
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(DAT_000c8dd4);
}

void FUN_00084ce0(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_00084bf0();
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(DAT_000c8dd8);
}

void FUN_00084d38(void)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    undefined4 uVar4;
    undefined4 local_a8;
    undefined1 auStack_a4[128];
    int local_24;

    local_24 = __stack_chk_guard;
    iVar1 = FUN_00084ce0();
    if (iVar1 == 0) {
        iVar1 = socket(10, 1, 0);
        if (iVar1 == -1) {
            piVar3 = __errno_location();
            FUN_00086b54(*piVar3, auStack_a4, 0x80);
            uVar4 = FUN_0008487c(isc_msgcat, 1, 0x65, "failed");
            FUN_000804e4("./../lib/isc/unix/net.c", 0x10a, "socket() %s: %s",
                         uVar4, auStack_a4);
            DAT_000c8ddc = 0x22;
            iVar1 = DAT_000c8ddc;
        } else {
            local_a8 = 1;
            iVar2 = setsockopt(iVar1, 0x29, 0x1a, &local_a8, 4);
            if (iVar2 < 0) {
                DAT_000c8ddc = 0x17;
            } else {
                close(iVar1);
                iVar1 = socket(10, 2, 0);
                if (iVar1 == -1) {
                    piVar3 = __errno_location();
                    FUN_00086b54(*piVar3, auStack_a4, 0x80);
                    uVar4 = FUN_0008487c(isc_msgcat, 1, 0x65, "failed");
                    FUN_000804e4("./../lib/isc/unix/net.c", 0x121,
                                 "socket() %s: %s", uVar4, auStack_a4);
                    DAT_000c8ddc = 0x22;
                    iVar1 = DAT_000c8ddc;
                    goto LAB_00084d70;
                }
                local_a8 = 1;
                iVar2 = setsockopt(iVar1, 0x29, 0x1a, &local_a8, 4);
                if (iVar2 < 0) {
                    DAT_000c8ddc = 0x17;
                } else {
                    DAT_000c8ddc = 0;
                }
            }
            close(iVar1);
            iVar1 = DAT_000c8ddc;
        }
    }
LAB_00084d70:
    DAT_000c8ddc = iVar1;
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00084f6c(void)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    undefined4 uVar4;
    undefined4 local_a0;
    undefined1 auStack_9c[128];
    int local_1c;

    local_1c = __stack_chk_guard;
    iVar1 = FUN_00084ce0();
    if (iVar1 == 0) {
        iVar1 = socket(10, 2, 0x11);
        if (iVar1 == -1) {
            piVar3 = __errno_location();
            FUN_00086b54(*piVar3, auStack_9c, 0x80);
            uVar4 = FUN_0008487c(isc_msgcat, 1, 0x65, "failed");
            FUN_000804e4("./../lib/isc/unix/net.c", 0x152, "socket() %s: %s",
                         uVar4, auStack_9c);
            DAT_000c8de0 = 0x22;
            iVar1 = DAT_000c8de0;
        } else {
            local_a0 = 1;
            iVar2 = setsockopt(iVar1, 0x29, 0x31, &local_a0, 4);
            if (iVar2 < 0) {
                DAT_000c8de0 = 0x17;
            } else {
                DAT_000c8de0 = 0;
            }
            close(iVar1);
            iVar1 = DAT_000c8de0;
        }
    }
    DAT_000c8de0 = iVar1;
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00085110(void)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = pthread_once((pthread_once_t *)&DAT_00118288, FUN_00084d38);
    if (iVar2 != 0) {
        FUN_000805ac("./../lib/isc/unix/net.c", 0x13d,
                     "((pthread_once((&once_ipv6only), (try_ipv6only)) == 0) ? "
                     "0 : 34) == 0");
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(DAT_000c8ddc);
}

void FUN_00085548(int *param_1, int *param_2, uint param_3)

{
    uint __n;
    int iVar1;
    uint uVar2;
    uint uVar3;
    int iVar4;
    bool bVar5;

    iVar1 = __stack_chk_guard;
    if (param_1 == (int *)0x0 || param_2 == (int *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/netaddr.c", 0x4e,
                     param_1 != (int *)0x0 && param_2 != (int *)0x0,
                     "a != ((void *)0) && b != ((void *)0)");
    }
    iVar4 = *param_1;
    if ((iVar4 == *param_2) && (param_1[5] == param_2[5] || param_2[5] == 0)) {
        bVar5 = false;
        if (iVar4 == 2) {
            uVar2 = 0x20;
            uVar3 = 4;
        } else {
            if (iVar4 != 10)
                goto LAB_00085590;
            uVar2 = 0x80;
            uVar3 = 0x10;
        }
        if (param_3 <= uVar2) {
            uVar2 = param_3;
        }
        __n = uVar2 >> 3;
        if ((__n == 0) ||
            (iVar4 = memcmp(param_1 + 1, param_2 + 1, __n), iVar4 == 0)) {
            if ((uVar2 & 7) == 0) {
                bVar5 = true;
            } else {
                if (uVar3 <= __n) {
                    /* WARNING: Subroutine does not return */
                    FUN_0007fc54("./../lib/isc/netaddr.c", 0x74, 2,
                                 "nbytes < ipabytes");
                }
                bVar5 = ((uint)(*(byte *)((int)(param_1 + 1) + (uVar2 >> 3)) ^
                                *(byte *)((int)(param_2 + 1) + (uVar2 >> 3))) &
                         0xff << (8 - (uVar2 & 7) & 0xff)) == 0;
            }
            goto LAB_00085590;
        }
    }
    bVar5 = false;
LAB_00085590:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(bVar5);
}

void FUN_00085bb8(undefined4 *param_1, undefined4 *param_2)

{
    int iVar1;
    undefined4 uVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    bool bVar5;

    iVar1 = __stack_chk_guard;
    memset(param_1, 0, 0x18);
    *param_1 = 10;
    uVar2 = param_2[1];
    uVar3 = param_2[2];
    uVar4 = param_2[3];
    bVar5 = iVar1 == __stack_chk_guard;
    param_1[1] = *param_2;
    param_1[2] = uVar2;
    param_1[3] = uVar3;
    param_1[4] = uVar4;
    if (bVar5) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00085cd0) */

void FUN_00085c6c(int *param_1, int param_2)

{
    if (*param_1 == 10) {
        param_1[5] = param_2;
        return;
    }
    /* WARNING: Subroutine does not return */
    FUN_0007fc54("./../lib/isc/netaddr.c", 0x144, 0, "netaddr->family == 10");
}

void FUN_00085d2c(uint *param_1, ushort *param_2)

{
    int iVar1;
    uint uVar2;
    uint uVar3;
    uint uVar4;

    iVar1 = __stack_chk_guard;
    uVar3 = (uint)*param_2;
    *param_1 = uVar3;
    if (uVar3 == 2) {
        uVar3 = *(uint *)(param_2 + 2);
        param_1[5] = 0;
        param_1[1] = uVar3;
    } else {
        if (uVar3 != 10) {
            /* WARNING: Subroutine does not return */
            FUN_0007fc54("./../lib/isc/netaddr.c", 0x166, 2, "0");
        }
        uVar2 = *(uint *)(param_2 + 6);
        uVar4 = *(uint *)(param_2 + 8);
        uVar3 = *(uint *)(param_2 + 10);
        param_1[1] = *(uint *)(param_2 + 4);
        param_1[2] = uVar2;
        param_1[3] = uVar4;
        param_1[4] = uVar3;
        param_1[5] = *(uint *)(param_2 + 0xc);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00086008) */

void FUN_00085fa8(void)

{
    return;
}

void FUN_0008615c(uint param_1, uint param_2, uint param_3, uint param_4,
                  uint param_5)

{
    int iVar1;
    uint *puVar2;
    uint *puVar3;
    int iVar4;
    undefined4 uVar5;

    iVar1 = __stack_chk_guard;
    if ((param_1 & 0xffff) != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/result.c", 0x79, 0, "base % 65536 == 0");
    }
    if (0x10000 < param_2) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/result.c", 0x7a, 0, "nresults <= 65536");
    }
    if (param_3 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/result.c", 0x7b, 0, "txt != ((void *)0)");
    }
    puVar3 = (uint *)malloc(0x1c);
    if (puVar3 == (uint *)0x0) {
        uVar5 = 1;
    } else {
        *puVar3 = param_1;
        puVar3[3] = param_4;
        puVar3[1] = (param_2 - 1) + param_1;
        puVar3[2] = param_3;
        puVar3[4] = param_5;
        puVar3[5] = 0xffffffff;
        puVar3[6] = 0xffffffff;
        iVar4 = pthread_mutex_lock((pthread_mutex_t *)&DAT_00118290);
        if (iVar4 != 0) {
            FUN_000805ac(
                "./../lib/isc/result.c", 0x8b,
                "((pthread_mutex_lock(((&lock))) == 0) ? 0 : 34) == 0");
        }
        puVar2 = puVar3;
        if (DAT_001182ac != (uint *)0x0) {
            DAT_001182ac[6] = (uint)puVar3;
            puVar2 = DAT_001182a8;
        }
        DAT_001182a8 = puVar2;
        puVar3[5] = (uint)DAT_001182ac;
        puVar3[6] = 0;
        DAT_001182ac = puVar3;
        iVar4 = pthread_mutex_unlock((pthread_mutex_t *)&DAT_00118290);
        uVar5 = 0;
        if (iVar4 != 0) {
            FUN_000805ac(
                "./../lib/isc/result.c", 0x8f,
                "((pthread_mutex_unlock(((&lock))) == 0) ? 0 : 34) == 0");
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar5);
    }
    return;
}

void FUN_00086320(void)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_000898e8(&DAT_00118290, "./../lib/isc/result.c", 0x98);
    if (iVar2 != 0) {
        FUN_000805ac(
            "./../lib/isc/result.c", 0x98,
            "isc__mutex_init((&lock), \"./../lib/isc/result.c\", 152) == 0");
    }
    DAT_001182a8 = 0;
    DAT_001182ac = 0;
    iVar2 = FUN_0008615c(0, 0x3e, &PTR_s_success_000c8de4, isc_msgcat, 2);
    if (iVar2 != 0) {
        uVar3 = FUN_0008487c(isc_msgcat, 1, 0x65, "failed");
        FUN_000804e4("./../lib/isc/result.c", 0x9e, "register_table() %s: %u",
                     uVar3, iVar2);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00086440(void)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    FUN_000813c4();
    iVar2 = pthread_once((pthread_once_t *)&DAT_001182b0, FUN_00086320);
    if (iVar2 == 0) {
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        FUN_000805ac("./../lib/isc/result.c", 0xa8,
                     "((pthread_once((&once), (initialize_action)) == 0) ? 0 : "
                     "34) == 0");
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000864e0(uint param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;
    uint *puVar4;

    iVar1 = __stack_chk_guard;
    FUN_00086440();
    iVar2 = pthread_mutex_lock((pthread_mutex_t *)&DAT_00118290);
    if (iVar2 != 0) {
        FUN_000805ac("./../lib/isc/result.c", 0xb3,
                     "((pthread_mutex_lock(((&lock))) == 0) ? 0 : 34) == 0");
    }
    puVar4 = (uint *)&DAT_00118290;
    do {
        puVar4 = (uint *)puVar4[6];
        if (puVar4 == (uint *)0x0)
            goto LAB_0008656c;
    } while ((param_1 < *puVar4) || (puVar4[1] < param_1));
    iVar2 = param_1 - *puVar4;
    iVar2 = FUN_0008487c(puVar4[3], puVar4[4], iVar2 + 1,
                         *(undefined4 *)(puVar4[2] + iVar2 * 4));
    if (iVar2 == 0) {
    LAB_0008656c:
        iVar2 =
            FUN_0008487c(isc_msgcat, 3, 1, "(result code text not available)");
    }
    iVar3 = pthread_mutex_unlock((pthread_mutex_t *)&DAT_00118290);
    if (iVar3 != 0) {
        FUN_000805ac("./../lib/isc/result.c", 0xca,
                     "((pthread_mutex_unlock(((&lock))) == 0) ? 0 : 34) == 0");
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2);
}

void FUN_00086698(char *param_1, char *param_2, undefined4 *param_3)

{
    int iVar1;
    FILE *pFVar2;
    int *piVar3;

    iVar1 = __stack_chk_guard;
    pFVar2 = fopen64(param_1, param_2);
    if (pFVar2 == (FILE *)0x0) {
        piVar3 = __errno_location();
        if (iVar1 == __stack_chk_guard) {
            FUN_0008bcf8(*piVar3, "./../lib/isc/unix/stdio.c", 0x24);
            return;
        }
    } else {
        *param_3 = pFVar2;
        piVar3 = (int *)0x0;
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(piVar3);
}

void FUN_00086b54(int param_1, int param_2, undefined4 param_3)

{
    int iVar1;
    int iVar2;
    char *pcVar3;

    iVar1 = __stack_chk_guard;
    if (param_2 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/unix/strerror.c", 0x37, 0,
                     "buf != ((void *)0)");
    }
    iVar2 = pthread_once((pthread_once_t *)&DAT_001182cc,
                         (__init_routine *)&LAB_00086abc);
    if (iVar2 != 0) {
        FUN_000805ac(
            "./../lib/isc/unix/strerror.c", 0x39,
            "((pthread_once((&once), (init_lock)) == 0) ? 0 : 34) == 0");
    }
    iVar2 = pthread_mutex_lock((pthread_mutex_t *)&DAT_001182b4);
    if (iVar2 == 0) {
        pcVar3 = strerror(param_1);
    } else {
        FUN_000805ac("./../lib/isc/unix/strerror.c", 0x3b,
                     "((pthread_mutex_lock(((&isc_strerror_lock))) == 0) ? 0 : "
                     "34) == 0");
        pcVar3 = strerror(param_1);
    }
    if (pcVar3 == (char *)0x0) {
        FUN_0007d00c(param_2, param_3, "Unknown error: %u", param_1);
    } else {
        FUN_0007d00c(param_2, param_3, "%s");
    }
    iVar2 = pthread_mutex_unlock((pthread_mutex_t *)&DAT_001182b4);
    if (iVar2 == 0) {
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        FUN_000805ac("./../lib/isc/unix/strerror.c", 0x41,
                     "((pthread_mutex_unlock(((&isc_strerror_lock))) == 0) ? 0 "
                     ": 34) == 0");
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00086d64) */

void FUN_00086cf0(undefined4 *param_1, undefined4 param_2, uint param_3)

{
    if (param_1 == (undefined4 *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/unix/time.c", 0x5a, 0, "i != ((void *)0)");
    }
    if (999999999 < param_3) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/unix/time.c", 0x5b, 0,
                     "nanoseconds < 1000000000");
    }
    param_1[1] = param_3;
    *param_1 = param_2;
    return;
}

void FUN_00087034(int *param_1)

{
    int iVar1;
    undefined4 uVar2;
    int *piVar3;
    timeval local_9c;
    undefined1 auStack_94[128];
    int local_14;

    local_14 = __stack_chk_guard;
    if (param_1 == (int *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/unix/time.c", 0x96, 0, "t != ((void *)0)");
    }
    iVar1 = gettimeofday(&local_9c, (__timezone_ptr_t)0x0);
    if (iVar1 == -1) {
        piVar3 = __errno_location();
        FUN_00086b54(*piVar3, auStack_94, 0x80);
        FUN_000804e4("./../lib/isc/unix/time.c", 0x9a, "%s", auStack_94);
        uVar2 = 0x22;
        goto LAB_000870ec;
    }
    if (local_9c.tv_usec < 0) {
        do {
            local_9c.tv_sec = local_9c.tv_sec + -1;
            local_9c.tv_usec =
                (__suseconds_t)(&DAT_000f4240 + local_9c.tv_usec);
        } while (local_9c.tv_usec < 0);
    LAB_000870b4:
        __syslog_chk(3, 1, "gettimeofday returned bad tv_usec: corrected");
    } else if (999999 < local_9c.tv_usec) {
        do {
            local_9c.tv_sec = local_9c.tv_sec + 1;
            local_9c.tv_usec = local_9c.tv_usec + -1000000;
        } while (999999 < local_9c.tv_usec);
        goto LAB_000870b4;
    }
    if (local_9c.tv_sec < 0) {
        uVar2 = 0x22;
    } else {
        *param_1 = local_9c.tv_sec;
        uVar2 = 0;
        param_1[1] = local_9c.tv_usec * 1000;
    }
LAB_000870ec:
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar2);
}

/* WARNING: Removing unreachable block (ram,0x000874b0) */

void FUN_000873e0(int param_1, int param_2)

{
    if (param_1 == 0 || param_2 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/unix/time.c", 0xf0,
                     param_1 != 0 && param_2 != 0,
                     "t1 != ((void *)0) && t2 != ((void *)0)");
    }
    if ((*(uint *)(param_1 + 4) < 1000000000) &&
        (*(uint *)(param_2 + 4) < 1000000000)) {
        return;
    }
    /* WARNING: Subroutine does not return */
    FUN_0007fc54(
        "./../lib/isc/unix/time.c", 0xf1, 2,
        "t1->nanoseconds < 1000000000 && t2->nanoseconds < 1000000000");
}

void FUN_00087610(uint *param_1, uint *param_2, int *param_3)

{
    int iVar1;
    undefined4 uVar2;
    uint uVar3;
    uint uVar4;
    uint uVar5;
    uint uVar6;
    bool bVar7;

    iVar1 = __stack_chk_guard;
    if (param_1 == (uint *)0x0 ||
        (param_2 == (uint *)0x0 || param_3 == (int *)0x0)) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54(
            "./../lib/isc/unix/time.c", 0x11c, 0,
            "t != ((void *)0) && i != ((void *)0) && result != ((void *)0)");
    }
    uVar6 = param_1[1];
    if ((uVar6 < 1000000000) && (uVar5 = param_2[1], uVar5 < 1000000000)) {
        uVar4 = *param_1;
        uVar3 = *param_2;
        if ((uVar4 < uVar3) || (uVar6 < uVar5 && uVar4 == uVar3)) {
            uVar2 = 0x29;
        } else {
            bVar7 = uVar5 <= uVar6;
            if (bVar7) {
                uVar6 = uVar6 - uVar5;
            }
            *param_3 = uVar4 - uVar3;
            if (!bVar7) {
                uVar6 = (uVar6 + 1000000000) - uVar5;
                *param_3 = (uVar4 - uVar3) + -1;
            }
            param_3[1] = uVar6;
            uVar2 = 0;
        }
        if (iVar1 != __stack_chk_guard) {
            /* WARNING: Subroutine does not return */
            __stack_chk_fail(uVar2);
        }
        return;
    }
    /* WARNING: Subroutine does not return */
    FUN_0007fc54("./../lib/isc/unix/time.c", 0x11d, 2,
                 "t->nanoseconds < 1000000000 && i->nanoseconds < 1000000000");
}

void FUN_00087a60(time_t *param_1, char *param_2, size_t param_3)

{
    tm *__tp;
    size_t sVar1;
    time_t local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    if (param_3 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/unix/time.c", 0x182, 0, "len > 0");
    }
    local_20 = *param_1;
    __tp = localtime(&local_20);
    sVar1 = strftime(param_2, param_3, "%d-%b-%Y %X", __tp);
    if (sVar1 < param_3) {
        if (sVar1 == 0) {
            FUN_0007d00c(param_2, param_3, "99-Bad-9999 99:99:99.999");
        } else {
            FUN_0007d00c(param_2 + sVar1, param_3 - sVar1, ".%03u",
                         (uint)param_1[1] / 1000000);
        }
        if (local_1c == __stack_chk_guard) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    /* WARNING: Subroutine does not return */
    FUN_0007fc54("./../lib/isc/unix/time.c", 0x186, 2, "flen < len");
}

void FUN_00087d0c(uint *param_1, uint *param_2)

{
    uint uVar1;
    uint uVar2;
    uint uVar3;
    uint uVar4;
    uint uVar5;
    uint uVar6;
    uint uVar7;
    uint uVar8;
    uint uVar9;
    uint uVar10;
    uint uVar11;
    uint uVar12;
    uint uVar13;
    uint *puVar14;
    uint uVar15;
    uint uVar16;
    uint uVar17;
    uint uVar18;
    uint uVar19;
    uint uVar20;
    uint uVar21;
    uint uVar22;
    uint uVar23;
    uint uVar24;
    uint *puVar25;
    uint *puVar26;
    uint uVar27;
    uint uVar28;
    uint uVar29;
    uint uVar30;
    uint uVar31;
    uint uVar32;
    bool bVar33;
    uint local_6c[7];
    uint local_50;
    uint local_4c;
    uint local_48;
    uint local_44;
    uint local_40;
    uint local_3c;
    uint local_38;
    uint local_34;
    uint local_30;
    int local_2c;

    local_2c = __stack_chk_guard;
    if (param_2 == (uint *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/sha1.c", 0xd0, 2, "buffer != ((void *)0)");
    }
    if (param_1 == (uint *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/sha1.c", 0xd1, 2, "state != ((void *)0)");
    }
    puVar14 = local_6c;
    puVar25 = param_2;
    do {
        puVar26 = puVar25 + 4;
        uVar2 = puVar25[1];
        uVar5 = puVar25[2];
        uVar10 = puVar25[3];
        *puVar14 = *puVar25;
        puVar14[1] = uVar2;
        puVar14[2] = uVar5;
        puVar14[3] = uVar10;
        puVar14 = puVar14 + 4;
        puVar25 = puVar26;
    } while (puVar26 != param_2 + 0x10);
    uVar3 = param_1[3];
    uVar6 = param_1[1];
    uVar24 = local_6c[2] << 0x18 | (local_6c[2] >> 8 & 0xff) << 0x10 |
             (local_6c[2] >> 0x10 & 0xff) << 8 | local_6c[2] >> 0x18;
    uVar4 = *param_1;
    uVar7 = param_1[2];
    uVar2 = uVar6 >> 2 | uVar6 << 0x1e;
    uVar8 = local_6c[1] << 0x18 | (local_6c[1] >> 8 & 0xff) << 0x10 |
            (local_6c[1] >> 0x10 & 0xff) << 8 | local_6c[1] >> 0x18;
    uVar22 = local_6c[0] << 0x18 | (local_6c[0] >> 8 & 0xff) << 0x10 |
             (local_6c[0] >> 0x10 & 0xff) << 8 | local_6c[0] >> 0x18;
    uVar5 = uVar4 >> 2 | uVar4 << 0x1e;
    uVar9 = param_1[4] + 0x5a827999 + (uVar4 >> 0x1b | uVar4 << 5) +
            ((uVar3 ^ uVar7) & uVar6 ^ uVar3) + uVar22;
    uVar11 = uVar3 + 0x5a827999 + ((uVar2 ^ uVar7) & uVar4 ^ uVar7) + uVar8 +
             (uVar9 >> 0x1b | uVar9 * 0x20);
    uVar10 = uVar9 >> 2 | uVar9 * 0x40000000;
    uVar19 = local_6c[3] << 0x18 | (local_6c[3] >> 8 & 0xff) << 0x10 |
             (local_6c[3] >> 0x10 & 0xff) << 8 | local_6c[3] >> 0x18;
    uVar13 = uVar11 >> 2 | uVar11 * 0x40000000;
    uVar9 = uVar7 + 0x5a827999 + uVar24 + ((uVar5 ^ uVar2) & uVar9 ^ uVar2) +
            (uVar11 >> 0x1b | uVar11 * 0x20);
    uVar32 = local_6c[4] << 0x18 | (local_6c[4] >> 8 & 0xff) << 0x10 |
             (local_6c[4] >> 0x10 & 0xff) << 8 | local_6c[4] >> 0x18;
    uVar11 = uVar2 + 0x5a827999 + uVar19 + ((uVar10 ^ uVar5) & uVar11 ^ uVar5) +
             (uVar9 >> 0x1b | uVar9 * 0x20);
    uVar20 = local_6c[5] << 0x18 | (local_6c[5] >> 8 & 0xff) << 0x10 |
             (local_6c[5] >> 0x10 & 0xff) << 8 | local_6c[5] >> 0x18;
    uVar2 = uVar9 >> 2 | uVar9 * 0x40000000;
    uVar12 = uVar5 + 0x5a827999 + uVar32 +
             ((uVar13 ^ uVar10) & uVar9 ^ uVar10) +
             (uVar11 >> 0x1b | uVar11 * 0x20);
    uVar5 = uVar11 >> 2 | uVar11 * 0x40000000;
    uVar1 = local_6c[6] << 0x18 | (local_6c[6] >> 8 & 0xff) << 0x10 |
            (local_6c[6] >> 0x10 & 0xff) << 8 | local_6c[6] >> 0x18;
    uVar15 = local_50 << 0x18 | (local_50 >> 8 & 0xff) << 0x10 |
             (local_50 >> 0x10 & 0xff) << 8 | local_50 >> 0x18;
    uVar9 = uVar12 >> 2 | uVar12 * 0x40000000;
    uVar17 = uVar20 + 0x5a827999 + uVar10 +
             ((uVar2 ^ uVar13) & uVar11 ^ uVar13) +
             (uVar12 >> 0x1b | uVar12 * 0x20);
    uVar11 = uVar1 + 0x5a827999 + uVar13 + ((uVar5 ^ uVar2) & uVar12 ^ uVar2) +
             (uVar17 >> 0x1b | uVar17 * 0x20);
    uVar27 = local_4c << 0x18 | (local_4c >> 8 & 0xff) << 0x10 |
             (local_4c >> 0x10 & 0xff) << 8 | local_4c >> 0x18;
    uVar10 = uVar17 >> 2 | uVar17 * 0x40000000;
    uVar13 = uVar11 >> 2 | uVar11 * 0x40000000;
    uVar12 = uVar15 + 0x5a827999 + uVar2 + ((uVar9 ^ uVar5) & uVar17 ^ uVar5) +
             (uVar11 >> 0x1b | uVar11 * 0x20);
    uVar21 = local_48 << 0x18 | (local_48 >> 8 & 0xff) << 0x10 |
             (local_48 >> 0x10 & 0xff) << 8 | local_48 >> 0x18;
    uVar23 = local_44 << 0x18 | (local_44 >> 8 & 0xff) << 0x10 |
             (local_44 >> 0x10 & 0xff) << 8 | local_44 >> 0x18;
    uVar2 = uVar12 >> 2 | uVar12 * 0x40000000;
    uVar11 = uVar27 + 0x5a827999 + uVar5 + ((uVar10 ^ uVar9) & uVar11 ^ uVar9) +
             (uVar12 >> 0x1b | uVar12 * 0x20);
    uVar28 = local_40 << 0x18 | (local_40 >> 8 & 0xff) << 0x10 |
             (local_40 >> 0x10 & 0xff) << 8 | local_40 >> 0x18;
    uVar12 = uVar21 + 0x5a827999 + uVar9 +
             ((uVar13 ^ uVar10) & uVar12 ^ uVar10) +
             (uVar11 >> 0x1b | uVar11 * 0x20);
    uVar5 = uVar11 >> 2 | uVar11 * 0x40000000;
    uVar29 = local_3c << 0x18 | (local_3c >> 8 & 0xff) << 0x10 |
             (local_3c >> 0x10 & 0xff) << 8 | local_3c >> 0x18;
    uVar9 = uVar12 >> 2 | uVar12 * 0x40000000;
    uVar11 = uVar23 + 0x5a827999 + uVar10 +
             ((uVar2 ^ uVar13) & uVar11 ^ uVar13) +
             (uVar12 >> 0x1b | uVar12 * 0x20);
    uVar16 = local_38 << 0x18 | (local_38 >> 8 & 0xff) << 0x10 |
             (local_38 >> 0x10 & 0xff) << 8 | local_38 >> 0x18;
    uVar10 = uVar11 >> 2 | uVar11 * 0x40000000;
    uVar30 = local_34 << 0x18 | (local_34 >> 8 & 0xff) << 0x10 |
             (local_34 >> 0x10 & 0xff) << 8 | local_34 >> 0x18;
    uVar13 = uVar28 + 0x5a827999 + uVar13 + ((uVar5 ^ uVar2) & uVar12 ^ uVar2) +
             (uVar11 >> 0x1b | uVar11 * 0x20);
    uVar17 = uVar29 + 0x5a827999 + uVar2 + ((uVar9 ^ uVar5) & uVar11 ^ uVar5) +
             (uVar13 >> 0x1b | uVar13 * 0x20);
    uVar2 = uVar13 >> 2 | uVar13 * 0x40000000;
    uVar12 = uVar16 + 0x5a827999 + uVar5 + ((uVar10 ^ uVar9) & uVar13 ^ uVar9) +
             (uVar17 >> 0x1b | uVar17 * 0x20);
    uVar5 = uVar17 >> 2 | uVar17 * 0x40000000;
    uVar18 = local_30 << 0x18 | (local_30 >> 8 & 0xff) << 0x10 |
             (local_30 >> 0x10 & 0xff) << 8 | local_30 >> 0x18;
    uVar11 = uVar24 ^ uVar22 ^ uVar27 ^ uVar16;
    uVar13 = uVar12 >> 2 | uVar12 * 0x40000000;
    uVar17 = uVar30 + 0x5a827999 + uVar9 +
             ((uVar2 ^ uVar10) & uVar17 ^ uVar10) +
             (uVar12 >> 0x1b | uVar12 * 0x20);
    uVar9 = uVar11 >> 0x1f | uVar11 << 1;
    uVar11 = uVar19 ^ uVar8 ^ uVar21 ^ uVar30;
    uVar11 = uVar11 >> 0x1f | uVar11 << 1;
    uVar8 = uVar20 ^ uVar19 ^ uVar28 ^ uVar9;
    uVar19 = uVar18 + 0x5a827999 + uVar10 + ((uVar5 ^ uVar2) & uVar12 ^ uVar2) +
             (uVar17 >> 0x1b | uVar17 * 0x20);
    uVar10 = uVar17 >> 2 | uVar17 * 0x40000000;
    uVar8 = uVar8 >> 0x1f | uVar8 << 1;
    uVar12 = uVar32 ^ uVar24 ^ uVar23 ^ uVar18;
    uVar22 = uVar9 + 0x5a827999 + uVar2 + ((uVar13 ^ uVar5) & uVar17 ^ uVar5) +
             (uVar19 >> 0x1b | uVar19 * 0x20);
    uVar2 = uVar19 >> 2 | uVar19 * 0x40000000;
    uVar12 = uVar12 >> 0x1f | uVar12 << 1;
    uVar17 = uVar1 ^ uVar32 ^ uVar29 ^ uVar11;
    uVar17 = uVar17 >> 0x1f | uVar17 << 1;
    uVar24 = uVar11 + 0x5a827999 + uVar5 +
             ((uVar10 ^ uVar13) & uVar19 ^ uVar13) +
             (uVar22 >> 0x1b | uVar22 * 0x20);
    uVar5 = uVar22 >> 2 | uVar22 * 0x40000000;
    uVar32 = uVar12 + 0x5a827999 + uVar13 +
             ((uVar2 ^ uVar10) & uVar22 ^ uVar10) +
             (uVar24 >> 0x1b | uVar24 * 0x20);
    uVar19 = uVar27 ^ uVar1 ^ uVar30 ^ uVar8;
    uVar13 = uVar24 >> 2 | uVar24 * 0x40000000;
    uVar1 = uVar32 >> 2 | uVar32 * 0x40000000;
    uVar22 = uVar15 ^ uVar20 ^ uVar16 ^ uVar12;
    uVar19 = uVar19 >> 0x1f | uVar19 << 1;
    uVar31 = uVar8 + 0x5a827999 + uVar10 + ((uVar5 ^ uVar2) & uVar24 ^ uVar2) +
             (uVar32 >> 0x1b | uVar32 * 0x20);
    uVar10 = uVar22 >> 0x1f | uVar22 << 1;
    uVar22 = uVar31 >> 2 | uVar31 * 0x40000000;
    uVar24 = uVar21 ^ uVar15 ^ uVar18 ^ uVar17;
    uVar24 = uVar24 >> 0x1f | uVar24 << 1;
    uVar32 = uVar17 + 0x6ed9eba1 + uVar2 + (uVar13 ^ uVar5 ^ uVar32) +
             (uVar31 >> 0x1b | uVar31 * 0x20);
    uVar2 = uVar23 ^ uVar27 ^ uVar9 ^ uVar10;
    uVar2 = uVar2 >> 0x1f | uVar2 << 1;
    uVar15 = uVar28 ^ uVar21 ^ uVar11 ^ uVar19;
    uVar15 = uVar15 >> 0x1f | uVar15 << 1;
    uVar20 = uVar29 ^ uVar23 ^ uVar12 ^ uVar24;
    uVar20 = uVar20 >> 0x1f | uVar20 << 1;
    uVar21 = uVar10 + 0x6ed9eba1 + uVar5 + (uVar1 ^ uVar13 ^ uVar31) +
             (uVar32 >> 0x1b | uVar32 * 0x20);
    uVar5 = uVar32 >> 2 | uVar32 * 0x40000000;
    uVar23 = uVar16 ^ uVar28 ^ uVar8 ^ uVar2;
    uVar32 = uVar19 + 0x6ed9eba1 + uVar13 + (uVar22 ^ uVar1 ^ uVar32) +
             (uVar21 >> 0x1b | uVar21 * 0x20);
    uVar13 = uVar21 >> 2 | uVar21 * 0x40000000;
    uVar28 = uVar24 + 0x6ed9eba1 + uVar1 + (uVar5 ^ uVar22 ^ uVar21) +
             (uVar32 >> 0x1b | uVar32 * 0x20);
    uVar1 = uVar32 >> 2 | uVar32 * 0x40000000;
    uVar27 = uVar2 + 0x6ed9eba1 + uVar22 + (uVar13 ^ uVar5 ^ uVar32) +
             (uVar28 >> 0x1b | uVar28 * 0x20);
    uVar22 = uVar28 >> 2 | uVar28 * 0x40000000;
    uVar21 = uVar29 ^ uVar30 ^ uVar17 ^ uVar15;
    uVar32 = uVar23 >> 0x1f | uVar23 << 1;
    uVar23 = uVar15 + 0x6ed9eba1 + uVar5 + (uVar1 ^ uVar13 ^ uVar28) +
             (uVar27 >> 0x1b | uVar27 * 0x20);
    uVar5 = uVar27 >> 2 | uVar27 * 0x40000000;
    uVar21 = uVar21 >> 0x1f | uVar21 << 1;
    uVar16 = uVar18 ^ uVar16 ^ uVar10 ^ uVar20;
    uVar16 = uVar16 >> 0x1f | uVar16 << 1;
    uVar28 = uVar30 ^ uVar9 ^ uVar19 ^ uVar32;
    uVar27 = uVar20 + 0x6ed9eba1 + uVar13 + (uVar22 ^ uVar1 ^ uVar27) +
             (uVar23 >> 0x1b | uVar23 * 0x20);
    uVar13 = uVar23 >> 2 | uVar23 * 0x40000000;
    uVar29 = uVar32 + 0x6ed9eba1 + uVar1 + (uVar5 ^ uVar22 ^ uVar23) +
             (uVar27 >> 0x1b | uVar27 * 0x20);
    uVar18 = uVar18 ^ uVar11 ^ uVar24 ^ uVar21;
    uVar1 = uVar27 >> 2 | uVar27 * 0x40000000;
    uVar23 = uVar28 >> 0x1f | uVar28 << 1;
    uVar30 = uVar21 + 0x6ed9eba1 + uVar22 + (uVar13 ^ uVar5 ^ uVar27) +
             (uVar29 >> 0x1b | uVar29 * 0x20);
    uVar22 = uVar29 >> 2 | uVar29 * 0x40000000;
    uVar27 = uVar18 >> 0x1f | uVar18 << 1;
    uVar28 = uVar16 + 0x6ed9eba1 + uVar5 + (uVar1 ^ uVar13 ^ uVar29) +
             (uVar30 >> 0x1b | uVar30 * 0x20);
    uVar9 = uVar12 ^ uVar9 ^ uVar2 ^ uVar16;
    uVar5 = uVar30 >> 2 | uVar30 * 0x40000000;
    uVar9 = uVar9 >> 0x1f | uVar9 << 1;
    uVar11 = uVar11 ^ uVar8 ^ uVar15 ^ uVar23;
    uVar18 = uVar23 + 0x6ed9eba1 + uVar13 + (uVar22 ^ uVar1 ^ uVar30) +
             (uVar28 >> 0x1b | uVar28 * 0x20);
    uVar13 = uVar28 >> 2 | uVar28 * 0x40000000;
    uVar11 = uVar11 >> 0x1f | uVar11 << 1;
    uVar12 = uVar12 ^ uVar17 ^ uVar20 ^ uVar27;
    uVar12 = uVar12 >> 0x1f | uVar12 << 1;
    uVar28 = uVar27 + 0x6ed9eba1 + uVar1 + (uVar5 ^ uVar22 ^ uVar28) +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar1 = uVar10 ^ uVar8 ^ uVar32 ^ uVar9;
    uVar8 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar1 = uVar1 >> 0x1f | uVar1 << 1;
    uVar29 = uVar9 + 0x6ed9eba1 + uVar22 + (uVar13 ^ uVar5 ^ uVar18) +
             (uVar28 >> 0x1b | uVar28 * 0x20);
    uVar22 = uVar28 >> 2 | uVar28 * 0x40000000;
    uVar17 = uVar19 ^ uVar17 ^ uVar21 ^ uVar11;
    uVar18 = uVar10 ^ uVar24 ^ uVar16 ^ uVar12;
    uVar10 = uVar17 >> 0x1f | uVar17 << 1;
    uVar30 = uVar11 + 0x6ed9eba1 + uVar5 + (uVar8 ^ uVar13 ^ uVar28) +
             (uVar29 >> 0x1b | uVar29 * 0x20);
    uVar5 = uVar29 >> 2 | uVar29 * 0x40000000;
    uVar17 = uVar18 >> 0x1f | uVar18 << 1;
    uVar28 = uVar12 + 0x6ed9eba1 + uVar13 + (uVar22 ^ uVar8 ^ uVar29) +
             (uVar30 >> 0x1b | uVar30 * 0x20);
    uVar13 = uVar30 >> 2 | uVar30 * 0x40000000;
    uVar19 = uVar2 ^ uVar19 ^ uVar23 ^ uVar1;
    uVar18 = uVar1 + 0x6ed9eba1 + uVar8 + (uVar5 ^ uVar22 ^ uVar30) +
             (uVar28 >> 0x1b | uVar28 * 0x20);
    uVar8 = uVar28 >> 2 | uVar28 * 0x40000000;
    uVar19 = uVar19 >> 0x1f | uVar19 << 1;
    uVar24 = uVar15 ^ uVar24 ^ uVar27 ^ uVar10;
    uVar24 = uVar24 >> 0x1f | uVar24 << 1;
    uVar28 = uVar10 + 0x6ed9eba1 + uVar22 + (uVar13 ^ uVar5 ^ uVar28) +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar22 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar29 = uVar17 + 0x6ed9eba1 + uVar5 + (uVar8 ^ uVar13 ^ uVar18) +
             (uVar28 >> 0x1b | uVar28 * 0x20);
    uVar18 = uVar20 ^ uVar2 ^ uVar9 ^ uVar17;
    uVar2 = uVar28 >> 2 | uVar28 * 0x40000000;
    uVar5 = uVar29 >> 2 | uVar29 * 0x40000000;
    uVar30 = uVar19 + 0x6ed9eba1 + uVar13 + (uVar22 ^ uVar8 ^ uVar28) +
             (uVar29 >> 0x1b | uVar29 * 0x20);
    uVar13 = uVar18 >> 0x1f | uVar18 << 1;
    uVar15 = uVar32 ^ uVar15 ^ uVar11 ^ uVar19;
    uVar15 = uVar15 >> 0x1f | uVar15 << 1;
    uVar20 = uVar21 ^ uVar20 ^ uVar12 ^ uVar24;
    uVar28 = uVar24 + 0x6ed9eba1 + uVar8 + (uVar2 ^ uVar22 ^ uVar29) +
             (uVar30 >> 0x1b | uVar30 * 0x20);
    uVar8 = uVar30 >> 2 | uVar30 * 0x40000000;
    uVar32 = uVar16 ^ uVar32 ^ uVar1 ^ uVar13;
    uVar20 = uVar20 >> 0x1f | uVar20 << 1;
    uVar32 = uVar32 >> 0x1f | uVar32 << 1;
    uVar18 = uVar13 + 0x8f1bbcdc + uVar22 +
             ((uVar30 | uVar5) & uVar2 | uVar30 & uVar5) +
             (uVar28 >> 0x1b | uVar28 * 0x20);
    uVar22 = uVar28 >> 2 | uVar28 * 0x40000000;
    uVar28 = uVar15 + 0x8f1bbcdc + uVar2 +
             ((uVar28 | uVar8) & uVar5 | uVar28 & uVar8) +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar2 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar21 = uVar23 ^ uVar21 ^ uVar10 ^ uVar15;
    uVar21 = uVar21 >> 0x1f | uVar21 << 1;
    uVar18 = uVar20 + 0x8f1bbcdc + uVar5 +
             ((uVar18 | uVar22) & uVar8 | uVar18 & uVar22) +
             (uVar28 >> 0x1b | uVar28 * 0x20);
    uVar5 = uVar28 >> 2 | uVar28 * 0x40000000;
    uVar16 = uVar27 ^ uVar16 ^ uVar17 ^ uVar20;
    uVar23 = uVar9 ^ uVar23 ^ uVar19 ^ uVar32;
    uVar16 = uVar16 >> 0x1f | uVar16 << 1;
    uVar28 = uVar32 + 0x8f1bbcdc + uVar8 +
             ((uVar28 | uVar2) & uVar22 | uVar28 & uVar2) +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar8 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar23 = uVar23 >> 0x1f | uVar23 << 1;
    uVar29 = uVar21 + 0x8f1bbcdc + uVar22 +
             ((uVar18 | uVar5) & uVar2 | uVar18 & uVar5) +
             (uVar28 >> 0x1b | uVar28 * 0x20);
    uVar22 = uVar28 >> 2 | uVar28 * 0x40000000;
    uVar27 = uVar11 ^ uVar27 ^ uVar24 ^ uVar21;
    uVar18 = uVar16 + 0x8f1bbcdc + uVar2 +
             ((uVar28 | uVar8) & uVar5 | uVar28 & uVar8) +
             (uVar29 >> 0x1b | uVar29 * 0x20);
    uVar2 = uVar27 >> 0x1f | uVar27 << 1;
    uVar9 = uVar12 ^ uVar9 ^ uVar13 ^ uVar16;
    uVar28 = uVar23 + 0x8f1bbcdc + uVar5 +
             ((uVar29 | uVar22) & uVar8 | uVar29 & uVar22) +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar5 = uVar29 >> 2 | uVar29 * 0x40000000;
    uVar27 = uVar1 ^ uVar11 ^ uVar15 ^ uVar23;
    uVar9 = uVar9 >> 0x1f | uVar9 << 1;
    uVar11 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar18 = uVar2 + 0x8f1bbcdc + uVar8 +
             ((uVar18 | uVar5) & uVar22 | uVar18 & uVar5) +
             (uVar28 >> 0x1b | uVar28 * 0x20);
    uVar8 = uVar27 >> 0x1f | uVar27 << 1;
    uVar27 = uVar28 >> 2 | uVar28 * 0x40000000;
    uVar12 = uVar10 ^ uVar12 ^ uVar20 ^ uVar2;
    uVar12 = uVar12 >> 0x1f | uVar12 << 1;
    uVar28 = uVar9 + 0x8f1bbcdc + uVar22 +
             ((uVar28 | uVar11) & uVar5 | uVar28 & uVar11) +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar22 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar1 = uVar17 ^ uVar1 ^ uVar32 ^ uVar9;
    uVar1 = uVar1 >> 0x1f | uVar1 << 1;
    uVar18 = uVar8 + 0x8f1bbcdc + uVar5 +
             ((uVar18 | uVar27) & uVar11 | uVar18 & uVar27) +
             (uVar28 >> 0x1b | uVar28 * 0x20);
    uVar5 = uVar28 >> 2 | uVar28 * 0x40000000;
    uVar10 = uVar19 ^ uVar10 ^ uVar21 ^ uVar8;
    uVar10 = uVar10 >> 0x1f | uVar10 << 1;
    uVar17 = uVar24 ^ uVar17 ^ uVar16 ^ uVar12;
    uVar17 = uVar17 >> 0x1f | uVar17 << 1;
    uVar28 = uVar12 + 0x8f1bbcdc + uVar11 +
             ((uVar28 | uVar22) & uVar27 | uVar28 & uVar22) +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar11 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar29 = uVar13 ^ uVar19 ^ uVar23 ^ uVar1;
    uVar18 = uVar1 + 0x8f1bbcdc + uVar27 +
             ((uVar18 | uVar5) & uVar22 | uVar18 & uVar5) +
             (uVar28 >> 0x1b | uVar28 * 0x20);
    uVar19 = uVar28 >> 2 | uVar28 * 0x40000000;
    uVar27 = uVar15 ^ uVar24 ^ uVar2 ^ uVar10;
    uVar28 = uVar10 + 0x8f1bbcdc + uVar22 +
             ((uVar28 | uVar11) & uVar5 | uVar28 & uVar11) +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar22 = uVar29 >> 0x1f | uVar29 << 1;
    uVar24 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar27 = uVar27 >> 0x1f | uVar27 << 1;
    uVar18 = uVar17 + 0x8f1bbcdc + uVar5 +
             ((uVar18 | uVar19) & uVar11 | uVar18 & uVar19) +
             (uVar28 >> 0x1b | uVar28 * 0x20);
    uVar5 = uVar28 >> 2 | uVar28 * 0x40000000;
    uVar29 = uVar20 ^ uVar13 ^ uVar9 ^ uVar17;
    uVar13 = uVar32 ^ uVar15 ^ uVar8 ^ uVar22;
    uVar28 = uVar22 + 0x8f1bbcdc + uVar11 +
             ((uVar28 | uVar24) & uVar19 | uVar28 & uVar24) +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar13 = uVar13 >> 0x1f | uVar13 << 1;
    uVar11 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar15 = uVar29 >> 0x1f | uVar29 << 1;
    uVar20 = uVar21 ^ uVar20 ^ uVar12 ^ uVar27;
    uVar18 = uVar27 + 0x8f1bbcdc + uVar19 +
             ((uVar18 | uVar5) & uVar24 | uVar18 & uVar5) +
             (uVar28 >> 0x1b | uVar28 * 0x20);
    uVar19 = uVar28 >> 2 | uVar28 * 0x40000000;
    uVar20 = uVar20 >> 0x1f | uVar20 << 1;
    uVar29 = uVar15 + 0x8f1bbcdc + uVar24 +
             ((uVar28 | uVar11) & uVar5 | uVar28 & uVar11) +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar24 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar32 = uVar16 ^ uVar32 ^ uVar1 ^ uVar15;
    uVar28 = uVar13 + 0x8f1bbcdc + uVar5 +
             ((uVar18 | uVar19) & uVar11 | uVar18 & uVar19) +
             (uVar29 >> 0x1b | uVar29 * 0x20);
    uVar5 = uVar29 >> 2 | uVar29 * 0x40000000;
    uVar32 = uVar32 >> 0x1f | uVar32 << 1;
    uVar21 = uVar23 ^ uVar21 ^ uVar10 ^ uVar13;
    uVar16 = uVar2 ^ uVar16 ^ uVar17 ^ uVar20;
    uVar21 = uVar21 >> 0x1f | uVar21 << 1;
    uVar16 = uVar16 >> 0x1f | uVar16 << 1;
    uVar18 = uVar20 + 0x8f1bbcdc + uVar11 +
             ((uVar29 | uVar24) & uVar19 | uVar29 & uVar24) +
             (uVar28 >> 0x1b | uVar28 * 0x20);
    uVar11 = uVar28 >> 2 | uVar28 * 0x40000000;
    uVar23 = uVar9 ^ uVar23 ^ uVar22 ^ uVar32;
    uVar28 = uVar32 + 0x8f1bbcdc + uVar19 +
             ((uVar28 | uVar5) & uVar24 | uVar28 & uVar5) +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar19 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar23 = uVar23 >> 0x1f | uVar23 << 1;
    uVar18 = uVar21 + 0xca62c1d6 + uVar24 + (uVar11 ^ uVar5 ^ uVar18) +
             (uVar28 >> 0x1b | uVar28 * 0x20);
    uVar24 = uVar8 ^ uVar2 ^ uVar27 ^ uVar21;
    uVar2 = uVar28 >> 2 | uVar28 * 0x40000000;
    uVar24 = uVar24 >> 0x1f | uVar24 << 1;
    uVar28 = uVar16 + 0xca62c1d6 + uVar5 + (uVar19 ^ uVar11 ^ uVar28) +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar9 = uVar12 ^ uVar9 ^ uVar15 ^ uVar16;
    uVar5 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar9 = uVar9 >> 0x1f | uVar9 << 1;
    uVar8 = uVar1 ^ uVar8 ^ uVar13 ^ uVar23;
    uVar30 = uVar23 + 0xca62c1d6 + uVar11 + (uVar2 ^ uVar19 ^ uVar18) +
             (uVar28 >> 0x1b | uVar28 * 0x20);
    uVar11 = uVar28 >> 2 | uVar28 * 0x40000000;
    uVar18 = uVar24 + 0xca62c1d6 + uVar19 + (uVar5 ^ uVar2 ^ uVar28) +
             (uVar30 >> 0x1b | uVar30 * 0x20);
    uVar8 = uVar8 >> 0x1f | uVar8 << 1;
    uVar19 = uVar30 >> 2 | uVar30 * 0x40000000;
    uVar12 = uVar10 ^ uVar12 ^ uVar20 ^ uVar24;
    uVar12 = uVar12 >> 0x1f | uVar12 << 1;
    uVar1 = uVar17 ^ uVar1 ^ uVar32 ^ uVar9;
    uVar1 = uVar1 >> 0x1f | uVar1 << 1;
    uVar29 = uVar22 ^ uVar10 ^ uVar21 ^ uVar8;
    uVar10 = uVar9 + 0xca62c1d6 + uVar2 + (uVar11 ^ uVar5 ^ uVar30) +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar2 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar18 = uVar8 + 0xca62c1d6 + uVar5 + (uVar19 ^ uVar11 ^ uVar18) +
             (uVar10 >> 0x1b | uVar10 * 0x20);
    uVar5 = uVar10 >> 2 | uVar10 * 0x40000000;
    uVar28 = uVar12 + 0xca62c1d6 + uVar11 + (uVar2 ^ uVar19 ^ uVar10) +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar10 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar11 = uVar29 >> 0x1f | uVar29 << 1;
    uVar17 = uVar27 ^ uVar17 ^ uVar16 ^ uVar12;
    uVar22 = uVar15 ^ uVar22 ^ uVar23 ^ uVar1;
    uVar18 = uVar1 + 0xca62c1d6 + uVar19 + (uVar5 ^ uVar2 ^ uVar18) +
             (uVar28 >> 0x1b | uVar28 * 0x20);
    uVar17 = uVar17 >> 0x1f | uVar17 << 1;
    uVar19 = uVar28 >> 2 | uVar28 * 0x40000000;
    uVar22 = uVar22 >> 0x1f | uVar22 << 1;
    uVar27 = uVar13 ^ uVar27 ^ uVar24 ^ uVar11;
    uVar27 = uVar27 >> 0x1f | uVar27 << 1;
    uVar30 = uVar11 + 0xca62c1d6 + uVar2 + (uVar10 ^ uVar5 ^ uVar28) +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar2 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar28 = uVar32 ^ uVar13 ^ uVar8 ^ uVar22;
    uVar29 = uVar17 + 0xca62c1d6 + uVar5 + (uVar19 ^ uVar10 ^ uVar18) +
             (uVar30 >> 0x1b | uVar30 * 0x20);
    uVar13 = uVar20 ^ uVar15 ^ uVar9 ^ uVar17;
    uVar5 = uVar30 >> 2 | uVar30 * 0x40000000;
    uVar18 = uVar12 ^ uVar21 ^ uVar20 ^ uVar27;
    uVar15 = uVar22 + 0xca62c1d6 + uVar10 + (uVar2 ^ uVar19 ^ uVar30) +
             (uVar29 >> 0x1b | uVar29 * 0x20);
    uVar10 = uVar13 >> 0x1f | uVar13 << 1;
    uVar13 = uVar29 >> 2 | uVar29 * 0x40000000;
    uVar20 = uVar27 + 0xca62c1d6 + uVar19 + (uVar5 ^ uVar2 ^ uVar29) +
             (uVar15 >> 0x1b | uVar15 * 0x20);
    uVar12 = uVar15 >> 2 | uVar15 * 0x40000000;
    uVar19 = uVar28 >> 0x1f | uVar28 << 1;
    uVar21 = uVar11 ^ uVar23 ^ uVar21 ^ uVar19;
    uVar1 = uVar1 ^ uVar16 ^ uVar32 ^ uVar10;
    uVar11 = uVar18 >> 0x1f | uVar18 << 1;
    uVar15 = uVar10 + 0xca62c1d6 + uVar2 + (uVar13 ^ uVar5 ^ uVar15) +
             (uVar20 >> 0x1b | uVar20 * 0x20);
    uVar2 = uVar1 >> 0x1f | uVar1 << 1;
    uVar10 = uVar20 >> 2 | uVar20 * 0x40000000;
    uVar32 = uVar17 ^ uVar24 ^ uVar16 ^ uVar11;
    uVar1 = uVar19 + 0xca62c1d6 + uVar5 + (uVar12 ^ uVar13 ^ uVar20) +
            (uVar15 >> 0x1b | uVar15 * 0x20);
    uVar5 = uVar15 >> 2 | uVar15 * 0x40000000;
    uVar17 = uVar21 >> 0x1f | uVar21 << 1;
    uVar15 = uVar11 + 0xca62c1d6 + uVar13 + (uVar10 ^ uVar12 ^ uVar15) +
             (uVar1 >> 0x1b | uVar1 * 0x20);
    uVar13 = uVar1 >> 2 | uVar1 * 0x40000000;
    uVar19 = uVar9 ^ uVar23 ^ uVar22 ^ uVar2;
    uVar11 = uVar2 + 0xca62c1d6 + uVar12 + (uVar5 ^ uVar10 ^ uVar1) +
             (uVar15 >> 0x1b | uVar15 * 0x20);
    uVar2 = uVar15 >> 2 | uVar15 * 0x40000000;
    uVar12 = uVar17 + 0xca62c1d6 + uVar10 + (uVar13 ^ uVar5 ^ uVar15) +
             (uVar11 >> 0x1b | uVar11 * 0x20);
    uVar10 = uVar11 >> 2 | uVar11 * 0x40000000;
    uVar17 = uVar17 ^ uVar8 ^ uVar24 ^ uVar27;
    uVar9 = uVar12 >> 2 | uVar12 * 0x40000000;
    uVar5 = (uVar32 >> 0x1f | uVar32 << 1) + 0xca62c1d6 + uVar5 +
            (uVar11 ^ uVar2 ^ uVar13) + (uVar12 >> 0x1b | uVar12 * 0x20);
    bVar33 = local_2c != __stack_chk_guard;
    uVar13 = (uVar19 >> 0x1f | uVar19 << 1) + 0xca62c1d6 + uVar13 +
             (uVar10 ^ uVar2 ^ uVar12) + (uVar5 >> 0x1b | uVar5 * 0x20);
    param_1[2] = uVar7 + (uVar5 >> 2 | uVar5 * 0x40000000);
    param_1[3] = uVar9 + uVar3;
    *param_1 = uVar4 + 0xca62c1d6 + (uVar17 >> 0x1f | uVar17 << 1) + uVar2 +
               (uVar9 ^ uVar10 ^ uVar5) + (uVar13 >> 0x1b | uVar13 * 0x20);
    param_1[4] = uVar10 + param_1[4];
    param_1[1] = uVar13 + uVar6;
    if (bVar33) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00089500) */

void FUN_0008945c(undefined4 *param_1)

{
    if (param_1 != (undefined4 *)0x0) {
        param_1[3] = 0x10325476;
        *param_1 = 0x67452301;
        param_1[1] = 0xefcdab89;
        param_1[2] = 0x98badcfe;
        param_1[4] = 0xc3d2e1f0;
        param_1[5] = 0;
        param_1[6] = 0;
        return;
    }
    /* WARNING: Subroutine does not return */
    FUN_0007fc54("./../lib/isc/sha1.c", 0x10e, 2, "context != ((void *)0)");
}

/* WARNING: Removing unreachable block (ram,0x00089558) */

void FUN_00089514(void *param_1)

{
    memset(param_1, 0, 0x5c);
    return;
}

void FUN_00089564(int param_1, void *param_2, uint param_3)

{
    size_t sVar1;
    int iVar2;
    size_t sVar3;
    void *__dest;
    size_t sVar4;
    uint uVar5;
    uint uVar6;
    uint uVar7;

    iVar2 = __stack_chk_guard;
    if (param_1 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/sha1.c", 0x128, 2, "context != 0");
    }
    if (param_2 == (void *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/sha1.c", 0x129, 2, "data != 0");
    }
    uVar6 = *(uint *)(param_1 + 0x14);
    uVar5 = uVar6 + param_3 * 8;
    *(uint *)(param_1 + 0x14) = uVar5;
    uVar7 = (uVar6 << 0x17) >> 0x1a;
    if (uVar5 < uVar6) {
        *(uint *)(param_1 + 0x18) =
            *(int *)(param_1 + 0x18) + 1 + (param_3 >> 0x1d);
    }
    if (uVar7 + param_3 < 0x40) {
        sVar4 = 0;
        __dest = (void *)(param_1 + uVar7 + 0x1c);
    } else {
        __dest = (void *)(param_1 + 0x1c);
        memcpy((void *)(param_1 + uVar7 + 0x1c), param_2, 0x40 - uVar7);
        FUN_00087d0c(param_1, __dest);
        sVar3 = 0x40 - uVar7;
        sVar1 = -uVar7;
        while (sVar4 = sVar3, sVar1 + 0x7f < param_3) {
            FUN_00087d0c(param_1, (int)param_2 + sVar4);
            sVar3 = sVar4 + 0x40;
            sVar1 = sVar4;
        }
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    memcpy(__dest, (void *)((int)param_2 + sVar4), param_3 - sVar4);
    return;
}

void FUN_000896b4(void *param_1, int param_2)

{
    int iVar1;
    uint uVar2;
    uint uVar3;
    undefined1 *puVar4;
    undefined1 auStack_24[8];
    int local_1c;

    local_1c = __stack_chk_guard;
    if (param_2 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/sha1.c", 0x149, 2, "digest != 0");
    }
    if (param_1 == (void *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/sha1.c", 0x14a, 2, "context != 0");
    }
    puVar4 = auStack_24;
    uVar3 = 0;
    do {
        uVar2 = uVar3 + 1;
        if (uVar3 < 4) {
            iVar1 = 0x14;
        } else {
            iVar1 = 0x10;
        }
        *puVar4 =
            (char)(*(uint *)((int)param_1 + iVar1 + 4) >> ((~uVar3 & 3) << 3));
        puVar4 = puVar4 + 1;
        uVar3 = uVar2;
    } while (uVar2 != 8);
    FUN_00089564(param_1, &DAT_000af80f, 1);
    uVar3 = *(uint *)((int)param_1 + 0x14);
    while ((uVar3 & 0x1f8) != 0x1c0) {
        FUN_00089564(param_1, &DAT_000af810, 1);
        uVar3 = *(uint *)((int)param_1 + 0x14);
    }
    puVar4 = (undefined1 *)(param_2 + -1);
    FUN_00089564(param_1, auStack_24, 8);
    uVar3 = 0;
    do {
        uVar2 = uVar3 + 1;
        puVar4 = puVar4 + 1;
        *puVar4 = (char)(*(uint *)((int)param_1 + (uVar3 & 0xfffffffc)) >>
                         ((~uVar3 & 3) << 3));
        uVar3 = uVar2;
    } while (uVar2 != 0x14);
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    memset(param_1, 0, 0x5c);
    return;
}

/* WARNING: Removing unreachable block (ram,0x000898dc) */

void FUN_00089834(undefined4 param_1, int param_2, int param_3)

{
    if (param_3 != 0) {
        param_3 = param_2 + param_3;
        do {
            param_2 = param_2 + 1;
        } while (param_2 != param_3);
    }
    return;
}

void FUN_000898e8(pthread_mutex_t *param_1, undefined4 param_2,
                  undefined4 param_3)

{
    int iVar1;
    int *piVar2;
    undefined1 auStack_9c[128];
    int local_1c;

    local_1c = __stack_chk_guard;
    iVar1 = pthread_mutex_init(param_1, (pthread_mutexattr_t *)0x0);
    if (iVar1 == 0xc) {
        iVar1 = 1;
    } else if (iVar1 != 0) {
        piVar2 = __errno_location();
        FUN_00086b54(*piVar2, auStack_9c, 0x80);
        FUN_000804e4(param_2, param_3, "isc_mutex_init() failed: %s",
                     auStack_9c);
        iVar1 = 0x22;
    }
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar1);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x000899fc) */

void FUN_0008998c(int param_1)

{
    undefined1 *puVar1;
    int iVar2;

    puVar1 = clktypes;
    iVar2 = clktypes._0_4_;
    if (clktypes._0_4_ != -1) {
        do {
            if (iVar2 == param_1) {
                return;
            }
            puVar1 = (undefined1 *)((int)puVar1 + 0xc);
            iVar2 = *(int *)puVar1;
        } while (iVar2 != -1);
    }
    return;
}

void FUN_00089a0c(void)

{
    tm *ptVar1;
    char *__s;
    uint uVar2;
    time_t local_28;
    int local_24;

    local_24 = __stack_chk_guard;
    local_28 = time((time_t *)0x0);
    ptVar1 = localtime(&local_28);
    if (ptVar1 == (tm *)0x0) {
        __s = "-- --- --:--:--";
    } else {
        __s = lib_stringbuf + lib_nextbuf * 0x80;
        uVar2 = lib_nextbuf + 1;
        memset(__s, 0, 0x80);
        lib_nextbuf = uVar2 & 0xf;
        FUN_0007d00c(__s, 0x80, "%2d %s %02d:%02d:%02d", ptVar1->tm_mday,
                     *(undefined4 *)(months + ptVar1->tm_mon * 4),
                     ptVar1->tm_hour, ptVar1->tm_min, ptVar1->tm_sec);
    }
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

void FUN_00089b0c(time_t param_1)

{
    tm *ptVar1;
    char *__s;
    uint uVar2;
    time_t local_24[2];
    int local_1c;

    local_1c = __stack_chk_guard;
    local_24[0] = param_1;
    ptVar1 = localtime(local_24);
    if (ptVar1 == (tm *)0x0) {
        __s = "--:--:--";
    } else {
        __s = lib_stringbuf + lib_nextbuf * 0x80;
        uVar2 = lib_nextbuf + 1;
        memset(__s, 0, 0x80);
        lib_nextbuf = uVar2 & 0xf;
        FUN_0007d00c(__s, 0x80, "%02d:%02d:%02d", ptVar1->tm_hour,
                     ptVar1->tm_min, ptVar1->tm_sec);
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

/* WARNING: Removing unreachable block (ram,0x0008b688) */

void FUN_0008b610(undefined4 *param_1)

{
    if (param_1 != (undefined4 *)0x0) {
        *param_1 = 0x4449522a;
        *(undefined1 *)(param_1 + 0x101) = 0;
        param_1[0x141] = 0;
        param_1[0x142] = 0;
        return;
    }
    /* WARNING: Subroutine does not return */
    FUN_0007fc54("./../lib/isc/unix/dir.c", 0x2d, 0, "dir != ((void *)0)");
}

void FUN_0008b69c(int *param_1, char *param_2)

{
    int iVar1;
    size_t sVar2;
    int *piVar3;
    DIR *pDVar4;
    int *__s;

    iVar1 = __stack_chk_guard;
    if ((param_1 == (int *)0x0) || (*param_1 != 0x4449522a)) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54(
            "./../lib/isc/unix/dir.c", 0x41, 0,
            "(((dir) != ((void *)0)) && (((const isc__magic_t *)(dir))->magic "
            "== (((\'D\') << 24 | (\'I\') << 16 | (\'R\') << 8 | (\'*\')))))");
    }
    if (param_2 == (char *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/unix/dir.c", 0x42, 0,
                     "dirname != ((void *)0)");
    }
    sVar2 = strlen(param_2);
    if (sVar2 + 3 < 0x401) {
        __s = param_1 + 1;
        FUN_0007e4b4(__s, param_2, sVar2 + 1);
        sVar2 = strlen((char *)__s);
        piVar3 = (int *)((int)param_1 + sVar2 + 4);
        if ((__s < piVar3) && (*(char *)((int)param_1 + sVar2 + 3) != '/')) {
            piVar3 = (int *)((int)param_1 + sVar2 + 5);
            *(undefined1 *)((int)param_1 + sVar2 + 4) = 0x2f;
        }
        *(undefined1 *)piVar3 = 0x2a;
        *(undefined1 *)((int)piVar3 + 1) = 0;
        pDVar4 = opendir(param_2);
        param_1[0x142] = (int)pDVar4;
        if (pDVar4 == (DIR *)0x0) {
            piVar3 = __errno_location();
            if (iVar1 == __stack_chk_guard) {
                FUN_0008bcf8(*piVar3, "./../lib/isc/unix/dir.c", 0x5d);
                return;
            }
            goto LAB_0008b7e4;
        }
        piVar3 = (int *)0x0;
    } else {
        piVar3 = (int *)0x13;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_0008b7e4:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(piVar3);
}

void FUN_0008b804(int *param_1)

{
    int iVar1;
    dirent64 *pdVar2;
    size_t sVar3;
    undefined4 uVar4;
    char *__s;

    iVar1 = __stack_chk_guard;
    if (((param_1 == (int *)0x0) || (*param_1 != 0x4449522a)) ||
        ((DIR *)param_1[0x142] == (DIR *)0x0)) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54(
            "./../lib/isc/unix/dir.c", 0x6e, 0,
            "(((dir) != ((void *)0)) && (((const isc__magic_t *)(dir))->magic "
            "== (((\'D\') << 24 | (\'I\') << 16 | (\'R\') << 8 | (\'*\'))))) "
            "&& dir->handle != ((void *)0)");
    }
    pdVar2 = readdir64((DIR *)param_1[0x142]);
    if (pdVar2 == (dirent64 *)0x0) {
        uVar4 = 0x1d;
    } else {
        __s = pdVar2->d_name;
        sVar3 = strlen(__s);
        if (sVar3 + 1 < 0x101) {
            FUN_0007e4b4(param_1 + 0x101, __s);
            sVar3 = strlen(__s);
            uVar4 = 0;
            param_1[0x141] = sVar3;
        } else {
            uVar4 = 0x22;
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar4);
    }
    return;
}

void FUN_0008b8e8(int *param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if (((param_1 != (int *)0x0) && (*param_1 == 0x4449522a)) &&
        ((DIR *)param_1[0x142] != (DIR *)0x0)) {
        closedir((DIR *)param_1[0x142]);
        iVar2 = __stack_chk_guard;
        param_1[0x142] = 0;
        if (iVar1 == iVar2) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    /* WARNING: Subroutine does not return */
    FUN_0007fc54("./../lib/isc/unix/dir.c", 0x8e, 0,
                 "(((dir) != ((void *)0)) && (((const isc__magic_t "
                 "*)(dir))->magic == (((\'D\') << 24 | (\'I\') << 16 | (\'R\') "
                 "<< 8 | (\'*\'))))) && dir->handle != ((void *)0)");
}

void FUN_0008bcf8(undefined4 param_1, undefined4 param_2, undefined4 param_3)

{
    undefined4 uVar1;
    undefined1 auStack_9c[128];
    int local_1c;

    local_1c = __stack_chk_guard;
    switch (param_1) {
    case 1:
        goto LAB_0008bf8c;
    case 2:
        uVar1 = 0x26;
        goto LAB_0008befc;
    case 3:
        break;
    case 4:
        break;
    case 5:
        uVar1 = 0x1a;
        goto LAB_0008befc;
    case 6:
        break;
    case 7:
        break;
    case 8:
        break;
    case 9:
        goto LAB_0008bef8;
    case 10:
        break;
    case 0xb:
        break;
    case 0xc:
        uVar1 = 1;
        goto LAB_0008befc;
    case 0xd:
    LAB_0008bf8c:
        uVar1 = 6;
        goto LAB_0008befc;
    case 0xe:
        break;
    case 0xf:
        break;
    case 0x10:
        break;
    case 0x11:
        uVar1 = 0x27;
        goto LAB_0008befc;
    case 0x12:
        break;
    case 0x13:
        break;
    case 0x14:
        goto LAB_0008bef8;
    case 0x15:
        break;
    case 0x16:
        goto LAB_0008bef8;
    case 0x17:
        goto LAB_0008bf24;
    case 0x18:
    LAB_0008bf24:
        uVar1 = 0x32;
        goto LAB_0008befc;
    case 0x19:
        break;
    case 0x1a:
        break;
    case 0x1b:
        break;
    case 0x1c:
        break;
    case 0x1d:
        break;
    case 0x1e:
        break;
    case 0x1f:
        break;
    case 0x20:
        goto LAB_0008bf2c;
    case 0x21:
        break;
    case 0x22:
        break;
    case 0x23:
        break;
    case 0x24:
        goto LAB_0008bef8;
    case 0x25:
        break;
    case 0x26:
        break;
    case 0x27:
        break;
    case 0x28:
    LAB_0008bef8:
        uVar1 = 0x1e;
        goto LAB_0008befc;
    case 0x29:
        break;
    case 0x2a:
        break;
    case 0x2b:
        break;
    case 0x2c:
        break;
    case 0x2d:
        break;
    case 0x2e:
        break;
    case 0x2f:
        break;
    case 0x30:
        break;
    case 0x31:
        break;
    case 0x32:
        break;
    case 0x33:
        break;
    case 0x34:
        break;
    case 0x35:
        break;
    case 0x36:
        break;
    case 0x37:
        break;
    case 0x38:
        break;
    case 0x39:
        break;
    case 0x3a:
        break;
    case 0x3b:
        break;
    case 0x3c:
        break;
    case 0x3d:
        break;
    case 0x3e:
        break;
    case 0x3f:
        break;
    case 0x40:
        break;
    case 0x41:
        break;
    case 0x42:
        break;
    case 0x43:
        break;
    case 0x44:
        break;
    case 0x45:
        break;
    case 0x46:
        break;
    case 0x47:
        break;
    case 0x48:
        break;
    case 0x49:
        break;
    case 0x4a:
        break;
    case 0x4b:
        break;
    case 0x4c:
        break;
    case 0x4d:
        break;
    case 0x4e:
        break;
    case 0x4f:
        break;
    case 0x50:
        break;
    case 0x51:
        break;
    case 0x52:
        break;
    case 0x53:
        break;
    case 0x54:
        break;
    case 0x55:
        break;
    case 0x56:
        break;
    case 0x57:
        break;
    case 0x58:
        break;
    case 0x59:
        break;
    case 0x5a:
        break;
    case 0x5b:
        break;
    case 0x5c:
        break;
    case 0x5d:
        break;
    case 0x5e:
        break;
    case 0x5f:
        break;
    case 0x60:
        break;
    case 0x61:
        uVar1 = 0x30;
        goto LAB_0008befc;
    case 0x62:
        uVar1 = 5;
        goto LAB_0008befc;
    case 99:
        uVar1 = 4;
        goto LAB_0008befc;
    case 100:
        uVar1 = 10;
        goto LAB_0008befc;
    case 0x65:
        uVar1 = 8;
        goto LAB_0008befc;
    case 0x66:
        break;
    case 0x67:
        goto LAB_0008bf2c;
    case 0x68:
    LAB_0008bf2c:
        uVar1 = 0x36;
        goto LAB_0008befc;
    case 0x69:
        uVar1 = 0xd;
        goto LAB_0008befc;
    case 0x6a:
        break;
    case 0x6b:
        uVar1 = 0x28;
        goto LAB_0008befc;
    case 0x6c:
        break;
    case 0x6d:
        break;
    case 0x6e:
        uVar1 = 2;
        goto LAB_0008befc;
    case 0x6f:
        uVar1 = 0xc;
        goto LAB_0008befc;
    case 0x70:
        uVar1 = 0xb;
        goto LAB_0008befc;
    case 0x71:
        uVar1 = 9;
        goto LAB_0008befc;
    }
    FUN_00086b54(param_1, auStack_9c, 0x80);
    FUN_000804e4(param_2, param_3,
                 "unable to convert errno to isc_result: %d: %s", param_1,
                 auStack_9c);
    uVar1 = 0x22;
LAB_0008befc:
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar1);
    }
    return;
}

void FUN_0008c9d8(char *param_1)

{
    int iVar1;
    int iVar2;
    int *piVar3;

    iVar1 = __stack_chk_guard;
    if (param_1 == (char *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/unix/file.c", 0x140, 0,
                     "filename != ((void *)0)");
    }
    iVar2 = unlink(param_1);
    if (iVar2 == 0) {
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else {
        piVar3 = __errno_location();
        if (iVar1 == __stack_chk_guard) {
            FUN_0008bcf8(*piVar3, "./../lib/isc/unix/file.c", 0x146);
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0008ca84(char *param_1, char *param_2)

{
    int iVar1;
    int iVar2;
    int *piVar3;

    iVar1 = __stack_chk_guard;
    if (param_1 == (char *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/unix/file.c", 0x14d, 0,
                     "oldname != ((void *)0)");
    }
    if (param_2 != (char *)0x0) {
        iVar2 = rename(param_1, param_2);
        if (iVar2 == 0) {
            if (iVar1 == __stack_chk_guard) {
                return;
            }
        } else {
            piVar3 = __errno_location();
            if (iVar1 == __stack_chk_guard) {
                FUN_0008bcf8(*piVar3, "./../lib/isc/unix/file.c", 0x154);
                return;
            }
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    /* WARNING: Subroutine does not return */
    FUN_0007fc54("./../lib/isc/unix/file.c", 0x14e, 0,
                 "newname != ((void *)0)");
}

void FUN_0008d460(void)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = pthread_once((pthread_once_t *)&DAT_001182e0,
                         (__init_routine *)&DAT_0008d404);
    if (iVar2 == 0) {
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        FUN_000805ac(
            "./../lib/isc/random.c", 0x3c,
            "((pthread_once((&once), (initialize_rand)) == 0) ? 0 : 34) == 0");
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0008d54c(uint *param_1)

{
    int iVar1;
    int iVar2;
    uint uVar3;
    bool bVar4;

    iVar1 = __stack_chk_guard;
    if (param_1 == (uint *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007fc54("./../lib/isc/random.c", 0x4e, 0, "val != ((void *)0)");
    }
    FUN_0008d460();
    iVar2 = rand();
    uVar3 = rand();
    bVar4 = iVar1 == __stack_chk_guard;
    *param_1 = (uint)(iVar2 << 0xc) >> 0x10 | (uVar3 & 0xffff0) << 0xc;
    if (bVar4) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void optionNumericVal(uint param_1, int param_2)

{
    byte bVar1;
    int *piVar2;
    int iVar3;
    byte *pbVar4;
    byte *local_28;
    int local_24;

    local_24 = __stack_chk_guard;
    if (((param_2 == 0 || param_1 < 0x10) ||
         ((*(uint *)(param_2 + 0x10) & 8) != 0)) ||
        (*(int *)(param_2 + 0x18) == 0))
        goto LAB_0008d8c0;
    piVar2 = __errno_location();
    *piVar2 = 0;
    iVar3 = strtol(*(char **)(param_2 + 0x18), (char **)&local_28, 0);
    pbVar4 = local_28;
    if ((*(byte **)(param_2 + 0x18) == local_28) || (*piVar2 != 0))
        goto LAB_0008d994;
    if ((*(uint *)(param_2 + 0x10) & 0x1000000) == 0) {
    LAB_0008d96c:
        pbVar4 = local_28;
        if (*local_28 == 0) {
            if ((*(uint *)(param_2 + 0x10) & 0x40) != 0) {
                free(*(byte **)(param_2 + 0x18));
                *(uint *)(param_2 + 0x10) =
                    *(uint *)(param_2 + 0x10) & 0xffffffbf;
            }
            *(int *)(param_2 + 0x18) = iVar3;
            goto LAB_0008d8c0;
        }
    } else {
        pbVar4 = local_28 + 1;
        bVar1 = *local_28;
        if (bVar1 == 0x54) {
            iVar3 = 0;
        LAB_0008da44:
            iVar3 = iVar3 << 10;
        LAB_0008d960:
            iVar3 = iVar3 << 10;
        LAB_0008d964:
            iVar3 = iVar3 << 10;
            local_28 = pbVar4;
            goto LAB_0008d96c;
        }
        if (bVar1 < 0x55) {
            if (bVar1 == 0x47)
                goto LAB_0008da44;
            if (bVar1 < 0x48) {
                if (bVar1 == 0)
                    goto LAB_0008d96c;
                goto LAB_0008d994;
            }
            if (bVar1 != 0x4b) {
                if (bVar1 != 0x4d)
                    goto LAB_0008d994;
                goto LAB_0008d960;
            }
            goto LAB_0008d964;
        }
        if (bVar1 == 0x6b) {
        LAB_0008da18:
            iVar3 = iVar3 * 1000;
            local_28 = pbVar4;
            goto LAB_0008d96c;
        }
        if (bVar1 < 0x6c) {
            if (bVar1 == 0x67) {
            LAB_0008da08:
                iVar3 = iVar3 * 1000;
                goto LAB_0008da10;
            }
        } else {
            if (bVar1 == 0x6d) {
            LAB_0008da10:
                iVar3 = iVar3 * 1000;
                goto LAB_0008da18;
            }
            if (bVar1 == 0x74) {
                iVar3 = iVar3 * 1000;
                goto LAB_0008da08;
            }
        }
    }
LAB_0008d994:
    local_28 = pbVar4;
    fprintf(stderr, (char *)option_xlateable_txt._204_4_,
            *(undefined4 *)(param_1 + 0x1c));
    if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
        (**(code **)(param_1 + 0x54))(param_1, 1);
    }
    *piVar2 = 0x16;
    *(undefined4 *)(param_2 + 0x18) = 0xffffffff;
LAB_0008d8c0:
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0008da6c(FILE *param_1, char *param_2, char *param_3, char *param_4)

{
    int iVar1;
    char *pcVar2;

    iVar1 = __stack_chk_guard;
    if (((param_2 == (char *)0x0) &&
         (param_2 = param_3, param_3 == (char *)0x0)) &&
        (param_2 = param_4, param_4 == (char *)0x0)) {
        return;
    }
    pcVar2 = strchr(param_2, 10);
    if (pcVar2 == (char *)0x0) {
        fputs(param_2, param_1);
    } else {
        fwrite(param_2, 1, (int)pcVar2 - (int)param_2, param_1);
    }
    if (iVar1 == __stack_chk_guard) {
        fputc(10, param_1);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0008db38(char *param_1)

{
    char cVar1;
    int iVar2;

    iVar2 = __stack_chk_guard;
    cVar1 = *param_1;
    while (cVar1 == '\'') {
        fwrite(&DAT_000b1612, 1, 2, stdout);
        param_1 = param_1 + 1;
        cVar1 = *param_1;
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_0008dbd0(FILE *param_1, int param_2, char *param_3)

{
    int iVar1;
    size_t sVar2;
    int iVar3;
    char *pcVar4;

    iVar1 = __stack_chk_guard;
    if (((*(uint *)(param_2 + 0x10) & 0x20) == 0) ||
        (*(short *)(param_2 + 8) != -0x8000)) {
        pcVar4 = *(char **)(param_2 + 0x34);
    } else {
        pcVar4 = *(char **)(param_2 + 0x38);
    }
    sVar2 = strlen(pcVar4);
    fputs(pcVar4, param_1);
    if ((param_3 != (char *)0x0) ||
        ((uint)(*(int *)(param_2 + 0x10) << 0x10) >> 0x1c == 5)) {
        fwrite(&DAT_000b3e88, 1, 3, param_1);
        iVar3 = -sVar2 + 0x10;
        if (0 < (int)(-sVar2 + 0x11)) {
            do {
                iVar3 = iVar3 + -1;
                fputc(0x20, param_1);
            } while (iVar3 != -1);
        }
        if ((uint)(*(int *)(param_2 + 0x10) << 0x10) >> 0x1c == 5) {
            fprintf(param_1, "%d", param_3);
        } else {
            while (pcVar4 = strchr(param_3, 10), pcVar4 != (char *)0x0) {
                fwrite(param_3, (int)pcVar4 - (int)param_3, 1, param_1);
                param_3 = pcVar4 + 1;
                fwrite(&DAT_000b3e8c, 1, 2, param_1);
            }
            fputs(param_3, param_1);
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    fputc(10, param_1);
    return;
}

void FUN_0008dd4c(uint param_1, int param_2, undefined4 *param_3, int param_4)

{
    char cVar1;
    char *__s;
    size_t sVar2;
    uint uVar3;
    int iVar4;
    undefined4 uVar5;
    undefined4 *puVar6;
    char *pcVar7;
    int iVar8;
    uint uVar9;
    int iVar10;
    uint uVar11;
    int local_60;
    uint local_4c;
    char acStack_3c[16];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (0xf < param_1) {
        fprintf(option_usage_fp, DAT_001182e4, *(undefined4 *)(param_1 + 0x1c),
                *(undefined4 *)(param_2 + 0x18),
                *(undefined4 *)(param_2 + 0x34));
    }
    uVar9 = 0;
    uVar11 = 0;
    fprintf(option_usage_fp, (char *)option_xlateable_txt._424_4_,
            *(undefined4 *)(param_2 + 0x34));
    pcVar7 = (char *)*param_3;
    cVar1 = *pcVar7;
    local_60 = param_4;
    if (cVar1 == '\x7f') {
        pcVar7 = (char *)param_3[1];
        param_3 = param_3 + 1;
        local_60 = param_4 + -1;
    }
    local_4c = (uint)(cVar1 == '\x7f');
    __s = pcVar7;
    puVar6 = param_3;
    iVar10 = local_60;
    while (true) {
        sVar2 = strlen(__s);
        iVar10 = iVar10 + -1;
        uVar3 = sVar2 + 1;
        uVar9 = uVar9 + uVar3;
        if (uVar11 < uVar3) {
            uVar11 = uVar3;
        }
        if (iVar10 < 1)
            break;
        puVar6 = puVar6 + 1;
        __s = (char *)*puVar6;
    }
    iVar10 = local_60;
    if (uVar11 < 0x24) {
        if (uVar9 < 0x4c) {
            fputc(0x20, option_usage_fp);
            do {
                fputc(0x20, option_usage_fp);
                iVar10 = iVar10 + -1;
                fputs((char *)*param_3, option_usage_fp);
                param_3 = param_3 + 1;
            } while (0 < iVar10);
            fputc(10, option_usage_fp);
        } else {
            iVar8 = 0;
            sprintf(acStack_3c, "%%-%ds", uVar11);
            iVar4 = FUN_0009cbe0(0x4e, uVar11);
            fwrite(&DAT_000b14d6, 1, 2, option_usage_fp);
            while (iVar10 = iVar10 + -1, 0 < iVar10) {
                iVar8 = iVar8 + 1;
                uVar5 = *param_3;
                param_3 = param_3 + 1;
                pcVar7 = acStack_3c;
                if (iVar8 == iVar4) {
                    iVar8 = 0;
                    pcVar7 = "%s\n  ";
                }
                fprintf(option_usage_fp, pcVar7, uVar5);
            }
            fprintf(option_usage_fp, "%s\n", *param_3);
        }
    } else {
        while (true) {
            fprintf(option_usage_fp, "  %s\n", pcVar7);
            if (iVar10 + -1 < 1)
                break;
            param_3 = param_3 + 1;
            pcVar7 = (char *)*param_3;
            iVar10 = iVar10 + -1;
        }
    }
    if (0xf < param_1) {
        fprintf(option_usage_fp, (char *)option_xlateable_txt._132_4_, local_4c,
                local_60 + -1 + local_4c);
        (**(code **)(param_1 + 0x54))(param_1, 1);
    }
    if ((uint)(*(int *)(param_2 + 0x10) << 0x10) >> 0x1c == 4) {
        fprintf(option_usage_fp, (char *)option_xlateable_txt._296_4_,
                local_60);
        fputs((char *)option_xlateable_txt._416_4_, option_usage_fp);
    } else {
        fprintf(option_usage_fp, (char *)option_xlateable_txt._132_4_, local_4c,
                local_60 + -1 + local_4c);
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0008e084(byte *param_1, undefined4 param_2, undefined4 param_3,
                  int param_4, uint param_5)

{
    size_t __n;
    ulong uVar1;
    int iVar2;
    uint uVar3;
    ulong uVar4;
    char *__s1;
    undefined4 *puVar5;
    char *local_30;
    int local_2c;

    local_2c = __stack_chk_guard;
    __n = strlen((char *)param_1);
    uVar3 = (uint)*param_1;
    if (uVar3 < 0x80) {
        if ((*(uint *)(&DAT_000b0784 + uVar3 * 4) & 0x30000) != 0) {
            uVar1 = strtoul((char *)param_1, &local_30, 0);
            if (*local_30 != '\0' || param_5 <= uVar1) {
                DAT_001182e4 = option_xlateable_txt._208_4_;
                option_usage_fp = stderr;
                FUN_0008dd4c(param_2, param_3, param_4, param_5);
                uVar1 = param_5;
            }
            goto LAB_0008e160;
        }
        if (((*(uint *)(&DAT_000b0784 + uVar3 * 4) & 0x8000) == 0) ||
            (param_1[2] != 0))
            goto LAB_0008e184;
        if (uVar3 == 0x7e) {
            if (param_1[1] == 0x30)
                goto LAB_0008e27c;
        } else if ((uVar3 == 0x2d) && (param_1[1] == 0x31)) {
        LAB_0008e27c:
            uVar1 = param_5 - 1;
            goto LAB_0008e160;
        }
    LAB_0008e258:
        DAT_001182e4 = option_xlateable_txt._168_4_;
    } else {
    LAB_0008e184:
        if (param_5 == 0)
            goto LAB_0008e258;
        uVar4 = 0;
        puVar5 = (undefined4 *)(param_4 + -4);
        uVar3 = param_5;
        do {
            puVar5 = puVar5 + 1;
            __s1 = (char *)*puVar5;
            iVar2 = strncmp(__s1, (char *)param_1, __n);
            uVar1 = uVar3;
            if (iVar2 == 0) {
                uVar1 = uVar4;
                if (__s1[__n] == '\0')
                    goto LAB_0008e160;
                if (uVar3 != param_5) {
                    uVar1 = 0xffffffff;
                }
            }
            uVar4 = uVar4 + 1;
            uVar3 = uVar1;
        } while (uVar4 != param_5);
        if (uVar1 < param_5)
            goto LAB_0008e160;
        DAT_001182e4 = option_xlateable_txt._76_4_;
        if (uVar1 == param_5)
            goto LAB_0008e258;
    }
    option_usage_fp = stderr;
    FUN_0008dd4c(param_2, param_3, param_4, param_5);
    uVar1 = param_5;
LAB_0008e160:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar1);
    }
    return;
}

void FUN_0008e2b8(int param_1)

{
    if (DAT_001182e8 != '\0') {
        printf("\nexit %d\n", param_1);
    }
    /* WARNING: Subroutine does not return */
    exit(param_1);
}

void FUN_0008e31c(undefined4 param_1)

{
    fprintf(stderr, (char *)option_xlateable_txt._48_4_, param_1);
    /* WARNING: Subroutine does not return */
    FUN_0008e2b8(0x46);
}

void FUN_0008e374(undefined4 param_1, undefined4 param_2, undefined4 param_3)

{
    undefined4 __format;
    FILE *__stream;
    int *piVar1;
    char *pcVar2;
    int __errnum;

    __stream = stderr;
    __format = option_xlateable_txt._96_4_;
    piVar1 = __errno_location();
    __errnum = *piVar1;
    pcVar2 = strerror(__errnum);
    fprintf(__stream, (char *)__format, param_1, __errnum, pcVar2, param_2,
            param_3);
    /* WARNING: Subroutine does not return */
    FUN_0008e2b8(1);
}

void FUN_0008e400(FILE *param_1, int param_2, int param_3, int *param_4)

{
    int iVar1;
    uint *puVar2;
    char *pcVar3;
    uint __c;
    int iVar4;
    byte *pbVar5;
    int *piVar6;
    undefined4 uVar7;
    int iVar8;
    undefined4 uVar9;

    iVar1 = __stack_chk_guard;
    param_2 = param_2 + -1;
    if (-1 < param_2) {
        do {
            _IO_putc(0x20, param_1);
            param_2 = param_2 + -1;
            _IO_putc(0x20, param_1);
        } while (param_2 != -1);
    }
    switch (*param_4) {
    case 1:
        iVar8 = param_4[1];
        pbVar5 = (byte *)((int)param_4 + 7);
        fprintf(param_1, "<%s>", iVar8);
    LAB_0008e5f0:
        while (true) {
            pbVar5 = pbVar5 + 1;
            __c = (uint)*pbVar5;
            if (__c != 0x26)
                break;
        LAB_0008e748:
            _IO_putc(0x26, param_1);
            if (__c == 0x26) {
                puVar2 = (uint *)&UNK_000b0984;
            LAB_0008e7ec:
                fputs((char *)(puVar2 + 2), param_1);
            } else {
                puVar2 = (uint *)&UNK_000b0984;
                do {
                    puVar2 = puVar2 + 4;
                    if (__c == *puVar2)
                        goto LAB_0008e7ec;
                } while (puVar2 != (uint *)&UNK_000b09c4);
                fprintf(param_1, "#x%02X;");
            }
        }
        if (0x26 < __c) {
            if (__c == 0x3e)
                goto LAB_0008e748;
            if (0x3e < __c) {
                if (__c < 0x7f)
                    goto LAB_0008e730;
                goto LAB_0008e748;
            }
            if (__c == 0x3c)
                goto LAB_0008e748;
        LAB_0008e730:
            _IO_putc(__c, param_1);
            goto LAB_0008e5f0;
        }
        if (__c != 0) {
            if (0x1f < __c)
                goto LAB_0008e730;
            goto LAB_0008e748;
        }
        if (iVar1 == __stack_chk_guard) {
            pcVar3 = "</%s>\n";
        LAB_0008e628:
            fprintf(param_1, pcVar3, iVar8);
            return;
        }
        break;
    case 2:
        goto LAB_0008e634;
    case 3:
        if (param_4[2] == 0) {
            pcVar3 = "false";
        } else {
            pcVar3 = "true";
        }
        if (iVar1 == __stack_chk_guard) {
            fprintf(param_1, "<%1$s type=boolean>%2$s</%1$s>\n", param_4[1],
                    pcVar3);
            return;
        }
        break;
    case 4:
    LAB_0008e634:
        if (param_3 == 0) {
        LAB_0008e484:
            if (iVar1 == __stack_chk_guard) {
                fprintf(param_1, "<%1$s type=integer>0x%2$lX</%1$s>\n",
                        param_4[1], param_4[2]);
                return;
            }
        } else {
            uVar7 = *(undefined4 *)(param_3 + 0x10);
            uVar9 = *(undefined4 *)(param_3 + 0x18);
            if (*param_4 == 2) {
                pcVar3 = "keyword";
            } else {
                pcVar3 = "set-membership";
            }
            fprintf(param_1, "<%s type=%s>", param_4[1], pcVar3);
            (**(code **)(param_3 + 0x28))(3, param_3);
            if ((*(char **)(param_3 + 0x18) != (char *)0x0) &&
                (fputs(*(char **)(param_3 + 0x18), param_1), *param_4 != 2)) {
                free(*(void **)(param_3 + 0x18));
            }
            iVar8 = __stack_chk_guard;
            *(undefined4 *)(param_3 + 0x18) = uVar9;
            *(undefined4 *)(param_3 + 0x10) = uVar7;
            if (iVar1 == iVar8) {
                fprintf(param_1, "</%s>\n", param_4[1]);
                return;
            }
        }
        break;
    case 5:
        goto LAB_0008e484;
    case 6:
        piVar6 = (int *)param_4[2];
        iVar8 = param_4[1];
        if (piVar6 == (int *)0x0) {
            if (iVar1 == __stack_chk_guard) {
                return;
            }
        } else if (*piVar6 < 1) {
            if (iVar1 == __stack_chk_guard) {
                pcVar3 = "<%s/>\n";
                goto LAB_0008e628;
            }
        } else {
            iVar4 = *piVar6 + -1;
            fprintf(param_1, "<%s type=nested>\n", iVar8);
            DAT_000c9164 = DAT_000c9164 + 1;
            piVar6 = piVar6 + 2;
            do {
                iVar4 = iVar4 + -1;
                FUN_0008e400(param_1, DAT_000c9164, 0, *piVar6);
                piVar6 = piVar6 + 1;
            } while (iVar4 != -1);
            iVar4 = DAT_000c9164 + -2;
            DAT_000c9164 = DAT_000c9164 + -1;
            if (-1 < iVar4) {
                do {
                    _IO_putc(0x20, param_1);
                    iVar4 = iVar4 + -1;
                    _IO_putc(0x20, param_1);
                } while (iVar4 != -1);
            }
            if (iVar1 == __stack_chk_guard) {
                fprintf(param_1, "</%s>\n", iVar8);
                return;
            }
        }
        break;
    default:
        if (iVar1 == __stack_chk_guard) {
            fprintf(param_1, "<%s/>\n", param_4[1]);
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0008e87c(uint param_1, undefined4 *param_2)

{
    undefined4 uVar1;
    undefined4 uVar2;
    undefined4 uVar3;
    int iVar4;
    undefined4 uVar5;

    iVar4 = __stack_chk_guard;
    param_1 = param_1 & 3;
    *param_2 = option_xlateable_txt._324_4_;
    uVar3 = option_xlateable_txt._16_4_;
    uVar2 = option_xlateable_txt._12_4_;
    uVar1 = option_xlateable_txt._8_4_;
    DAT_001182ec = option_xlateable_txt._16_4_;
    DAT_001182f4 = option_xlateable_txt._12_4_;
    DAT_001182fc = option_xlateable_txt._8_4_;
    DAT_00118304 = option_xlateable_txt._4_4_;
    DAT_001182f0 = &DAT_000b09d4;
    DAT_00118310 = &DAT_000b09d4;
    DAT_00118300 = &DAT_000b1411;
    DAT_00118324 = &DAT_000b142e;
    DAT_001182f8 = "=file";
    DAT_00118308 = &DAT_000b1416;
    DAT_0011830c = "[=arg]";
    DAT_00118314 = &DAT_000b1405;
    DAT_00118318 = &DAT_000b14c5;
    DAT_0011831c = &DAT_000b14d2;
    if (param_1 == 2) {
        DAT_00118320 = &DAT_000b146c;
        uVar5 = 8;
        DAT_001182f8 = "=file";
        DAT_00118300 = &DAT_000b1411;
        DAT_00118308 = &DAT_000b1416;
        DAT_00118314 = &DAT_000b1405;
        DAT_00118318 = &DAT_000b14c5;
        DAT_0011831c = &DAT_000b14d2;
        DAT_00118324 = &DAT_000b142e;
        *(undefined1 *)option_xlateable_txt._4_4_ = 0x20;
        *(undefined1 *)uVar1 = 0x20;
        *(undefined1 *)uVar2 = 0x20;
        *(undefined1 *)uVar3 = 0x20;
        DAT_0011830c = " [arg]";
    } else if ((param_1 == 3) || (param_1 == 1)) {
        DAT_00118320 = &DAT_000b1423;
        uVar5 = 0x16;
    } else {
        DAT_00118320 = &DAT_000b1425;
        uVar5 = 0x16;
        DAT_001182f8 = "=file";
        DAT_00118300 = &DAT_000b1411;
        DAT_00118308 = &DAT_000b1416;
        DAT_0011830c = "[=arg]";
        DAT_00118314 = &DAT_000b1405;
        DAT_00118318 = &DAT_000b14c5;
        DAT_0011831c = &DAT_000b14d2;
        DAT_00118324 = &DAT_000b142e;
    }
    if (iVar4 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar5);
    }
    return;
}

void FUN_0008e9d0(uint param_1, undefined4 *param_2)

{
    int iVar1;
    undefined4 uVar2;

    iVar1 = __stack_chk_guard;
    DAT_001182ec = &DAT_000b149b;
    DAT_001182f0 = &DAT_000b1497;
    DAT_001182f4 = &DAT_000b148f;
    DAT_001182fc = &DAT_000b147f;
    DAT_00118300 = &DAT_000b1483;
    DAT_00118324 = &DAT_000b149f;
    DAT_001182f8 = &DAT_000b147b;
    DAT_00118304 = &DAT_000b146f;
    DAT_00118308 = &DAT_000b1487;
    DAT_0011830c = &DAT_000b1493;
    DAT_00118310 = &DAT_000b148b;
    DAT_00118314 = &DAT_000b1473;
    DAT_00118318 = &DAT_000b14cc;
    DAT_0011831c = &DAT_000b14d6;
    switch (param_1 & 0x12) {
    case 0:
        uVar2 = 0x18;
        *param_2 = option_xlateable_txt._408_4_;
        DAT_00118320 = " %3s %-14s %s";
        goto LAB_0008eaf0;
    case 2:
        uVar2 = 0x18;
        *param_2 = option_xlateable_txt._412_4_;
        DAT_00118320 = " %3s %-14s %s";
        goto LAB_0008eaf0;
    case 4:
        break;
    case 6:
        break;
    case 8:
        break;
    case 10:
        break;
    case 0xc:
        break;
    case 0xe:
        break;
    case 0x10:
        uVar2 = 0x13;
        *param_2 = option_xlateable_txt._320_4_;
        DAT_00118320 = (char *)option_xlateable_txt._328_4_;
        goto LAB_0008eaf0;
    case 0x12:
        uVar2 = 0x13;
        *param_2 = option_xlateable_txt._324_4_;
        DAT_00118320 = (char *)option_xlateable_txt._328_4_;
        goto LAB_0008eaf0;
    }
    uVar2 = 0;
LAB_0008eaf0:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2);
    }
    return;
}

void FUN_0008f010(int param_1, int param_2)

{
    int iVar1;
    undefined *puVar2;

    iVar1 = __stack_chk_guard;
    puVar2 = (undefined *)option_xlateable_txt._116_4_;
    if (*(short *)(param_2 + 8) == -0x8000) {
        puVar2 = &DAT_000b09d8;
    }
    fprintf(stderr, (char *)option_xlateable_txt._272_4_,
            *(undefined4 *)(param_1 + 0x1c));
    if (*(ushort *)(param_2 + 0xc) < 2) {
        fprintf(stderr, (char *)option_xlateable_txt._216_4_,
                *(undefined4 *)(param_2 + 0x34), puVar2);
    } else {
        fprintf(stderr, (char *)option_xlateable_txt._92_4_,
                (uint) * (ushort *)(param_2 + 0xc),
                *(undefined4 *)(param_2 + 0x34), puVar2);
    }
    (**(code **)(param_1 + 0x54))(param_1, 1);
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0008f0f4(int param_1, undefined4 *param_2)

{
    ushort uVar1;
    ushort uVar2;
    int iVar3;
    uint uVar4;
    ushort *puVar5;
    uint uVar6;
    ushort *puVar7;
    code *pcVar8;
    undefined4 uVar9;

    iVar3 = __stack_chk_guard;
    puVar7 = (ushort *)*param_2;
    uVar6 = *(uint *)(puVar7 + 8);
    pcVar8 = *(code **)(puVar7 + 0x14);
    if ((uVar6 & 0x40) != 0) {
        free(*(void **)(puVar7 + 0xc));
        uVar6 = *(uint *)(puVar7 + 8);
    }
    uVar9 = param_2[1];
    *(undefined4 *)(puVar7 + 0xc) = uVar9;
    if (((*(uint *)(param_1 + 0xc) & 0x80000) != 0) && ((uVar6 & 0x100) != 0))
        goto LAB_0008f200;
    if (puVar7[4] == 0x8000) {
        uVar4 = param_2[2];
        puVar7[3] = puVar7[1];
        puVar7[2] = *puVar7;
    } else {
        puVar5 = (ushort *)(*(int *)(param_1 + 0x44) + (uint)puVar7[4] * 0x40);
        if ((uVar6 & 4) == 0) {
            uVar1 = *puVar7;
            puVar5[2] = 0x8000;
            if (uVar1 == 0x8000)
                goto LAB_0008f228;
            uVar2 = puVar7[1];
            uVar4 = param_2[2];
            puVar5[2] = uVar1;
            puVar5[3] = uVar2;
            uVar4 = uVar4 | 0x10;
            param_2[2] = uVar4;
        } else {
            if ((uint)*puVar7 != (uint)puVar5[2]) {
                fprintf(stderr, (char *)option_xlateable_txt._148_4_,
                        *(undefined4 *)(puVar5 + 0x1a),
                        *(undefined4 *)(puVar7 + 0x1a),
                        *(undefined4 *)(*(int *)(param_1 + 0x44) +
                                        (uint)puVar5[2] * 0x40 + 0x34));
                goto LAB_0008f200;
            }
        LAB_0008f228:
            uVar4 = param_2[2];
        }
        uVar6 = *(uint *)(puVar5 + 8);
        *(undefined4 *)(puVar5 + 0xc) = uVar9;
        puVar7 = puVar5;
    }
    *(uint *)(puVar7 + 8) = uVar4 & 0xf00000ff | uVar6 & 0xfffff00;
    if (((uVar4 & 4) == 0) || (uVar1 = puVar7[7], puVar7[7] = uVar1 + 1,
                               (ushort)(uVar1 + 1) <= puVar7[6])) {
        if (pcVar8 != (code *)0x0) {
            (*pcVar8)(param_1, puVar7);
        }
    } else if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
        FUN_0008f010(param_1, puVar7);
    }
LAB_0008f200:
    if (iVar3 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0008f2c8(int param_1, uint param_2, int *param_3, undefined4 *param_4)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    int iVar4;

    iVar1 = __stack_chk_guard;
    iVar2 = *(int *)(param_1 + 100);
    iVar4 = *(int *)(param_1 + 0x44);
    do {
        if (*(ushort *)(iVar4 + 2) == param_2) {
            if (((uint) * (undefined **)(iVar4 + 0x10) & 0x280000) == 0) {
                *param_3 = iVar4;
                *param_4 = 1;
                uVar3 = 0;
                goto LAB_0008f344;
            }
            if ((*(undefined **)(iVar4 + 0x10) != &UNK_00080100) ||
                (*(int *)(iVar4 + 0x34) == 0))
                goto LAB_0008f334;
            if ((*(uint *)(param_1 + 0xc) & 4) == 0)
                goto LAB_0008f340;
            fprintf(stderr, (char *)option_xlateable_txt._112_4_,
                    *(undefined4 *)(param_1 + 0x18));
            if (*(int *)(iVar4 + 0x2c) != 0) {
                fprintf(stderr, " -- %s");
            }
            fputc(10, stderr);
            goto LAB_0008f448;
        }
        iVar2 = iVar2 + -1;
        iVar4 = iVar4 + 0x40;
    } while (0 < iVar2);
    if ((((param_2 & 0xff) < 0x80) &&
         ((*(uint *)(&DAT_000b0784 + (param_2 & 0xff) * 4) & 0x30000) != 0)) &&
        (*(ushort *)(param_1 + 0x60) != 0x8000)) {
        *param_3 = *(int *)(param_1 + 0x44) +
                   (uint) * (ushort *)(param_1 + 0x60) * 0x40;
        uVar3 = 0;
        *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + -1;
        *param_4 = 1;
    } else {
    LAB_0008f334:
        if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
            fprintf(stderr, (char *)option_xlateable_txt._120_4_,
                    *(undefined4 *)(param_1 + 0x18), param_2);
        LAB_0008f448:
            (**(code **)(param_1 + 0x54))(param_1, 1);
            /* WARNING: Subroutine does not return */
            _exit(1);
        }
    LAB_0008f340:
        uVar3 = 0xffffffff;
    }
LAB_0008f344:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_0008f47c(char *param_1)

{
    int iVar1;
    char *__s;
    char *pcVar2;

    iVar1 = __stack_chk_guard;
    if ((param_1 == (char *)0x0) || (*param_1 == '\0')) {
        fwrite(&DAT_000b14ed, 1, 2, stdout);
        return;
    }
    __s = (char *)FUN_0008db38();
    if (*__s == '\0') {
    LAB_0008f504:
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else {
        fputc(0x27, stdout);
        while (pcVar2 = strchr(__s, 0x27), pcVar2 != (char *)0x0) {
            fwrite(__s, (int)pcVar2 - (int)__s, 1, stdout);
            fputc(0x27, stdout);
            __s = (char *)FUN_0008db38(pcVar2);
            if (*__s == '\0')
                goto LAB_0008f504;
            fputc(0x27, stdout);
        }
        fputs(__s, stdout);
        if (iVar1 == __stack_chk_guard) {
            fputc(0x27, stdout);
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0008f5d4(uint *param_1, ushort *param_2, undefined4 *param_3,
                  undefined4 *param_4)

{
    int iVar1;
    char *__s;
    uint uVar2;

    iVar1 = __stack_chk_guard;
    if ((*param_1 & 2) == 0) {
        __s = (char *)*param_4;
    LAB_0008f6a0:
        fputs(__s, option_usage_fp);
        return;
    }
    uVar2 = *param_2 & 0xff;
    if ((uVar2 < 0x80) &&
        ((*(uint *)(&DAT_000b0784 + uVar2 * 4) & 0x4000) != 0)) {
        fprintf(option_usage_fp, "   -%c", (uint)*param_2);
        if ((*param_1 & 0x1001) == 0x1001) {
            if (iVar1 == __stack_chk_guard) {
                fwrite(&DAT_000ad454, 1, 2, option_usage_fp);
                return;
            }
        } else if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else {
        if ((*param_1 & 0x1001) == 0x1001) {
            fputc(0x20, option_usage_fp);
        }
        if (iVar1 == __stack_chk_guard) {
            __s = (char *)*param_3;
            goto LAB_0008f6a0;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0008f738(int param_1)

{
    int iVar1;
    undefined1 *__s;
    undefined1 *puVar2;
    uint *puVar3;
    uint uVar4;
    bool bVar5;

    iVar1 = __stack_chk_guard;
    puVar3 = (uint *)&DAT_000b0784;
    uVar4 = *(uint *)(&DAT_000b09dc + param_1 * 4);
    __s = (undefined1 *)malloc(0x100);
    if (__s == (undefined1 *)0x0) {
        fwrite("no memory for char-mapper span map\n", 1, 0x23, stderr);
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    memset(__s, 0, 0x100);
    puVar2 = __s;
    do {
        puVar2 = puVar2 + 1;
        puVar3 = puVar3 + 1;
        if ((uVar4 & *puVar3) != 0) {
            *puVar2 = 1;
        }
    } while (puVar3 != (uint *)&UNK_000b0980);
    bVar5 = iVar1 == __stack_chk_guard;
    *(undefined1 **)(&DAT_00118328 + param_1 * 4) = __s;
    if (bVar5) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

void FUN_0008fa64(char *param_1)

{
    int iVar1;
    int iVar2;
    size_t sVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = __strdup();
    if (iVar2 == 0) {
        sVar3 = strlen(param_1);
        fprintf(stderr, (char *)option_xlateable_txt._20_4_, sVar3);
        /* WARNING: Subroutine does not return */
        FUN_0008e2b8(1);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0008fbe0(size_t param_1)

{
    int iVar1;
    void *pvVar2;

    iVar1 = __stack_chk_guard;
    pvVar2 = malloc(param_1);
    if (pvVar2 == (void *)0x0) {
        fprintf(stderr, (char *)option_xlateable_txt._20_4_, param_1);
        /* WARNING: Subroutine does not return */
        FUN_0008e2b8(1);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0008fc64(undefined4 *param_1, int param_2)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    int iVar4;
    int *__ptr;
    size_t __size;

    iVar1 = __stack_chk_guard;
    __ptr = (int *)*param_1;
    if (__ptr == (int *)0x0) {
        piVar3 = (int *)FUN_0008fbe0(0x20);
        if (piVar3 == (int *)0x0)
            goto LAB_0008fcb8;
        iVar4 = 0;
        piVar3[1] = 6;
        iVar2 = 1;
        *piVar3 = 0;
        *param_1 = piVar3;
    } else {
        iVar4 = *__ptr;
        iVar2 = __ptr[1];
        piVar3 = __ptr;
        if (iVar2 <= iVar4) {
            __size = iVar2 * 4 + 0x28;
            __ptr[1] = iVar2 + 8;
            piVar3 = (int *)realloc(__ptr, __size);
            if (piVar3 == (int *)0x0) {
                fprintf(stderr, (char *)option_xlateable_txt._36_4_, __size,
                        __ptr);
                /* WARNING: Subroutine does not return */
                FUN_0008e2b8(1);
            }
            iVar4 = *piVar3;
            *param_1 = piVar3;
        }
        iVar2 = iVar4 + 1;
    }
    *piVar3 = iVar2;
    piVar3[iVar4 + 2] = param_2;
LAB_0008fcb8:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0008ffa8(undefined4 *param_1, int param_2)

{
    int iVar1;
    code *pcVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    pcVar2 = *(code **)(param_2 + 0x28);
    if (pcVar2 == optionPrintVersion) {
        printf("            echo \"$%s_%s_TEXT\"\n            exit 0\n",
               *param_1, "VERSION");
    } else if (pcVar2 == optionPagedUsage) {
        printf("            echo \"$%s_LONGUSAGE_TEXT\" | ${PAGER-more}\n      "
               "      exit 0\n",
               *param_1);
    } else if (pcVar2 == optionLoadOpt) {
        printf("            %s\n",
               "echo \'Warning:  Cannot load options files\' >&2");
        printf("            %s\n", "OPT_ARG_NEEDED=YES");
    } else {
        iVar3 = *(int *)(param_2 + 0x30);
        if (iVar3 == 0) {
            if (pcVar2 == (code *)0x0) {
                printf("            %s\n",
                       "echo \'Warning:  Cannot save options files\' >&2");
                printf("            %s\n", "OPT_ARG_NEEDED=OK");
            } else {
                printf("            echo \"$%s_%s_TEXT\"\n            exit 0\n",
                       *param_1, "LONGUSAGE");
            }
        } else {
            if (*(short *)(param_2 + 0xc) == 1) {
                printf("            if [ -n \"${%1$s_%2$s}\" ] && "
                       "${%1$s_%2$s_set} ; then\n                echo \'Error: "
                       " duplicate %2$s option\'\n                echo "
                       "\"$%1$s_USAGE_TEXT\"\n                exit 1\n         "
                       "   fi >&2\n            %1$s_%2$s_set=true\n            "
                       "OPT_NAME=\'%2$s\'\n",
                       *param_1);
            } else {
                if (*(short *)(param_2 + 0xc) != -1) {
                    printf("            if [ $%1$s_%2$s_CT -gt %3$u ] ; then\n "
                           "               echo \'Error:  more than %3$d %2$s "
                           "options\'\n                echo "
                           "\"$%1$s_USAGE_TEXT\"\n                exit 1\n     "
                           "       fi >&2\n",
                           *param_1);
                    iVar3 = *(int *)(param_2 + 0x30);
                }
                printf("            %1$s_%2$s_CT=`expr ${%1$s_%2$s_CT} + 1`\n  "
                       "          OPT_ELEMENT=\"_${%1$s_%2$s_CT}\"\n           "
                       " OPT_NAME=\'%2$s\'\n",
                       *param_1, iVar3);
            }
            if ((*(uint *)(param_2 + 0x10) & 0xf000) == 0) {
                printf("            eval %1$s_%2$s${OPT_ELEMENT}=true\n        "
                       "    export %1$s_%2$s${OPT_ELEMENT}\n",
                       *param_1, *(undefined4 *)(param_2 + 0x30));
                printf("            %s\n", "OPT_ARG_NEEDED=NO");
            } else if ((*(uint *)(param_2 + 0x10) & 0x10000) == 0) {
                printf("            %s\n", "OPT_ARG_NEEDED=YES");
            } else {
                printf("            eval %1$s_%2$s${OPT_ELEMENT}=true\n        "
                       "    export %1$s_%2$s${OPT_ELEMENT}\n",
                       *param_1, *(undefined4 *)(param_2 + 0x30));
                printf("            %s\n", "OPT_ARG_NEEDED=OK");
            }
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    fwrite(&DAT_000b16de, 1, 0x10, stdout);
    return;
}

void FUN_0009021c(int param_1)

{
    int iVar1;
    uint uVar2;
    int iVar3;
    int iVar4;

    iVar1 = __stack_chk_guard;
    iVar4 = *(int *)(param_1 + 100);
    iVar3 = *(int *)(param_1 + 0x44);
    fwrite("        case \"${OPT_CODE}\" in\n", 1, 0x1e, stdout);
    if (0 < iVar4) {
        do {
            if ((*(uint *)(iVar3 + 0x10) & 0x280000) == 0) {
                uVar2 = *(ushort *)(iVar3 + 2) & 0xff;
                if ((uVar2 < 0x80) &&
                    ((*(uint *)(&DAT_000b0784 + uVar2 * 4) & 0x4000) != 0)) {
                    printf("        \'%c\' )\n");
                    FUN_0008ffa8(param_1 + 0x20, iVar3);
                }
            }
            iVar4 = iVar4 + -1;
            iVar3 = iVar3 + 0x40;
        } while (iVar4 != 0);
    }
    if (iVar1 == __stack_chk_guard) {
        printf("        * )\n            echo Unknown %s: \"${OPT_CODE}\" "
               ">&2\n            echo \"$%s_USAGE_TEXT\" >&2\n            exit "
               "1\n            ;;\n        esac\n",
               &DAT_000b1537, *(undefined4 *)(param_1 + 0x20));
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0009031c(byte *param_1, int param_2, int *param_3, int *param_4)

{
    byte bVar1;
    byte bVar2;
    size_t sVar3;
    __int32_t **pp_Var4;
    uint uVar5;
    byte *pbVar6;
    __int32_t *p_Var7;
    int iVar8;
    byte *pbVar9;
    int iVar10;
    uint __n;
    byte *pbVar11;
    byte abStack_4c[32];
    int local_2c;

    local_2c = __stack_chk_guard;
    sVar3 = strlen((char *)param_1);
    if (sVar3 - 1 < 0x1f) {
        __n = 2;
        iVar8 = *param_3;
        iVar10 = *param_4 + -1;
        if (0 < *param_4) {
            do {
                if ((iVar8 != param_2) &&
                    ((*(uint *)(iVar8 + 0x10) & 0x280000) == 0)) {
                    pp_Var4 = __ctype_toupper_loc();
                    pbVar6 = param_1 + -1;
                    pbVar11 = (byte *)(*(int *)(iVar8 + 0x34) + -1);
                    p_Var7 = *pp_Var4;
                    uVar5 = 0;
                    while (true) {
                        pbVar11 = pbVar11 + 1;
                        pbVar6 = pbVar6 + 1;
                        if (p_Var7[*pbVar11] != p_Var7[*pbVar6])
                            break;
                        uVar5 = uVar5 + 1;
                    }
                    pbVar6 = *(byte **)(iVar8 + 0x38);
                    if (__n < uVar5) {
                        __n = uVar5;
                    }
                    if ((pbVar6 != (byte *)0x0) &&
                        (p_Var7[*pbVar6] == p_Var7[*param_1])) {
                        uVar5 = 0;
                        pbVar11 = param_1;
                        do {
                            pbVar6 = pbVar6 + 1;
                            uVar5 = uVar5 + 1;
                            pbVar11 = pbVar11 + 1;
                        } while (p_Var7[*pbVar6] == p_Var7[*pbVar11]);
                        if (__n < uVar5) {
                            __n = uVar5;
                        }
                    }
                }
                iVar10 = iVar10 + -1;
                iVar8 = iVar8 + 0x40;
            } while (iVar10 != -1);
        }
        if (__n < sVar3 - 1) {
            pbVar11 = param_1 + __n;
            memcpy(abStack_4c, param_1, __n);
            pbVar6 = abStack_4c + __n;
            do {
                pbVar9 = pbVar6;
                *pbVar9 = 0;
                printf("        \'%s\' | \\\n", abStack_4c);
                bVar1 = *pbVar11;
                pbVar11 = pbVar11 + 1;
                bVar2 = *pbVar11;
                *pbVar9 = bVar1;
                pbVar6 = pbVar9 + 1;
            } while (bVar2 != 0);
            pbVar9[1] = 0;
        }
    }
    printf("        \'%s\' )\n", param_1);
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_000904e0(int param_1)

{
    int iVar1;
    char *__format;
    undefined4 uVar2;
    int iVar3;
    int iVar4;

    iVar1 = __stack_chk_guard;
    iVar3 = *(int *)(param_1 + 0x44);
    iVar4 = *(int *)(param_1 + 100);
    fwrite("        case \"${OPT_CODE}\" in\n", 1, 0x1e, stdout);
    do {
        while ((*(uint *)(iVar3 + 0x10) & 0x280000) != 0) {
        LAB_0009055c:
            iVar4 = iVar4 + -1;
            iVar3 = iVar3 + 0x40;
            if (iVar4 < 1)
                goto LAB_00090630;
        }
        FUN_0009031c(*(undefined4 *)(iVar3 + 0x34), iVar3, param_1 + 0x44,
                     param_1 + 100);
        FUN_0008ffa8(param_1 + 0x20, iVar3);
        if (*(int *)(iVar3 + 0x38) == 0)
            goto LAB_0009055c;
        FUN_0009031c(*(int *)(iVar3 + 0x38), iVar3, param_1 + 0x44,
                     param_1 + 100);
        if (*(code **)(iVar3 + 0x28) == optionLoadOpt) {
            printf("            %s\n", "echo \'Warning:  Cannot suppress the "
                                       "loading of options files\' >&2");
        } else {
            if (*(short *)(iVar3 + 0xc) == 1) {
                uVar2 = *(undefined4 *)(iVar3 + 0x3c);
                __format =
                    "            if [ -n \"${%1$s_%2$s}\" ] && "
                    "${%1$s_%2$s_set} ; then\n                echo \'Error:  "
                    "duplicate %2$s option\'\n                echo "
                    "\"$%1$s_USAGE_TEXT\"\n                exit 1\n            "
                    "fi >&2\n            %1$s_%2$s_set=true\n            "
                    "%1$s_%2$s=\'%3$s\'\n            export %1$s_%2$s\n        "
                    "    OPT_NAME=\'%2$s\'\n";
            } else {
                uVar2 = *(undefined4 *)(iVar3 + 0x3c);
                __format =
                    "            %1$s_%2$s_CT=0\n            "
                    "OPT_ELEMENT=\'\'\n            %1$s_%2$s=\'%3$s\'\n        "
                    "    export %1$s_%2$s\n            OPT_NAME=\'%2$s\'\n";
            }
            printf(__format, *(undefined4 *)(param_1 + 0x20),
                   *(undefined4 *)(iVar3 + 0x30), uVar2);
        }
        printf("            %s\n", "OPT_ARG_NEEDED=NO");
        iVar4 = iVar4 + -1;
        iVar3 = iVar3 + 0x40;
        fwrite(&DAT_000b16de, 1, 0x10, stdout);
    } while (0 < iVar4);
LAB_00090630:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    printf("        * )\n            echo Unknown %s: \"${OPT_CODE}\" >&2\n    "
           "        echo \"$%s_USAGE_TEXT\" >&2\n            exit 1\n          "
           "  ;;\n        esac\n",
           "option", *(undefined4 *)(param_1 + 0x20));
    return;
}

void FUN_00090694(int param_1, int *param_2)

{
    int iVar1;
    uint uVar2;
    char *pcVar3;
    uint uVar4;
    int iVar5;
    int iVar6;
    int iVar7;
    undefined **ppuVar8;

    iVar1 = __stack_chk_guard;
    if (((param_2[2] & 4U) != 0) &&
        ((*(uint *)(*param_2 + 0x10) & 0x2000000) != 0)) {
        fprintf(stderr, (char *)option_xlateable_txt._184_4_,
                *(undefined4 *)(*param_2 + 0x34));
        if (iVar1 == __stack_chk_guard) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(0xffffffff);
    }
    iVar7 = *param_2;
    ppuVar8 = &__DT_PLTGOT;
    uVar2 = param_2[2];
    uVar4 = *(uint *)(iVar7 + 0x10) & 0xfffff00 | uVar2;
    param_2[2] = uVar4;
    if (((uVar2 & 0x20) == 0) && ((uVar4 & 0xf000) != 0)) {
        iVar5 = param_2[3];
        if ((uVar4 & 0x10000) == 0) {
            if (iVar5 == 1) {
                iVar6 = *(int *)(param_1 + 0x14);
                iVar5 = iVar6 + 1;
                *(int *)(param_1 + 0x14) = iVar5;
                if (*(char *)(iVar6 + 1) == '\0') {
                    iVar5 = *(int *)(param_1 + 0x10);
                    uVar2 = iVar5 + 1;
                    *(uint *)(param_1 + 0x10) = uVar2;
                    iVar5 = *(int *)(*(int *)(param_1 + 8) + iVar5 * 4);
                    *(int *)(param_1 + 0x14) = iVar5;
                } else {
                    uVar2 = *(uint *)(param_1 + 0x10);
                }
            LAB_0008f928:
                param_2[1] = iVar5;
            } else {
                if ((iVar5 == 2) && (param_2[1] == 0)) {
                    iVar5 = *(int *)(param_1 + 0x10);
                    uVar2 = iVar5 + 1;
                    *(uint *)(param_1 + 0x10) = uVar2;
                    iVar5 = *(int *)(*(int *)(param_1 + 8) + iVar5 * 4);
                    goto LAB_0008f928;
                }
                uVar2 = *(uint *)(param_1 + 0x10);
            }
            if (*(uint *)(param_1 + 4) < uVar2) {
                fprintf(stderr, (char *)option_xlateable_txt._144_4_,
                        *(undefined4 *)(param_1 + 0x18),
                        *(undefined4 *)(iVar7 + 0x34));
                iVar5 = -1;
                goto LAB_0008f8c8;
            }
        } else if (iVar5 == 1) {
            iVar7 = *(int *)(param_1 + 0x14);
            pcVar3 = (char *)(iVar7 + 1);
            *(char **)(param_1 + 0x14) = pcVar3;
            if (*(char *)(iVar7 + 1) == '\0') {
                iVar7 = *(int *)(param_1 + 0x10);
                pcVar3 = *(char **)(*(int *)(param_1 + 8) + iVar7 * 4);
                if ((pcVar3 == (char *)0x0) || (*pcVar3 == '-')) {
                    param_2[1] = 0;
                    goto LAB_0008f8a4;
                }
            LAB_0008f9b4:
                *(int *)(param_1 + 0x10) = iVar7 + 1;
            }
            param_2[1] = (int)pcVar3;
        } else {
            if (iVar5 != 2) {
                ppuVar8 = (undefined **)0x8f9d4;
                param_1 = FUN_0008e31c(option_xlateable_txt._68_4_);
                goto LAB_0008f9d4;
            }
            if ((param_2[1] == 0) && ((*(uint *)(param_1 + 0xc) & 3) != 0)) {
                iVar7 = *(int *)(param_1 + 0x10);
                pcVar3 = *(char **)(*(int *)(param_1 + 8) + iVar7 * 4);
                if ((pcVar3 != (char *)0x0) && (*pcVar3 != '-'))
                    goto LAB_0008f9b4;
            }
        }
    LAB_0008f8a4:
        iVar5 = 0;
    } else {
        if (param_2[3] == 1) {
            iVar5 = 0;
            *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
            goto LAB_0008f8c8;
        }
        iVar5 = param_2[1];
        if (iVar5 != 0) {
        LAB_0008f9d4:
            fprintf(*(FILE **)ppuVar8[0x26e], *(char **)(ppuVar8[0x29e] + 0x9c),
                    *(undefined4 *)(param_1 + 0x18),
                    *(undefined4 *)(iVar7 + 0x34));
            iVar5 = -1;
            goto LAB_0008f8c8;
        }
    }
    *(int *)(param_1 + 0x14) = iVar5;
LAB_0008f8c8:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar5);
    }
    return;
}

void optionPagedUsage(int param_1, int param_2)

{
    char *pcVar1;
    size_t sVar2;
    char *pcVar3;
    __pid_t _Var4;
    char *pcVar5;
    __mode_t __mask;
    int iVar6;
    int iVar7;

    iVar6 = __stack_chk_guard;
    pcVar5 = DAT_001183e4;
    if (DAT_001183e0 != 0) {
        if (DAT_001183e0 != 1) {
            return;
        }
        fclose(option_usage_fp);
        option_usage_fp = (FILE *)0x0;
        pcVar1 = getenv("PAGER");
        if (pcVar1 == (char *)0x0) {
            pcVar1 = "more";
            iVar7 = 0x1a;
        } else {
            sVar2 = strlen(pcVar1);
            iVar7 = sVar2 + 0x16;
        }
        sVar2 = strlen(pcVar5);
        iVar7 = iVar7 + sVar2 * 2;
        pcVar3 = (char *)FUN_0008fbe0(iVar7);
        FUN_0007d00c(pcVar3, iVar7, "%1$s %2$s ; rm -f %2$s", pcVar1, pcVar5);
        free(pcVar5);
        DAT_001183e4 = pcVar3;
        if (DAT_001183e8 == '\0') {
            fclose(stderr);
            dup2(1, 2);
        } else {
            fwrite("\nexit 0\n", 1, 8, stdout);
            fclose(stdout);
            dup2(2, 1);
        }
        system(DAT_001183e4);
        if (iVar6 == __stack_chk_guard) {
            free(DAT_001183e4);
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    if ((*(uint *)(param_2 + 0x10) & 8) != 0) {
        return;
    }
    _Var4 = getpid();
    pcVar5 = getenv("TMPDIR");
    if (pcVar5 == (char *)0x0) {
        pcVar5 = "/tmp";
    }
    sVar2 = strlen(pcVar5);
    pcVar1 = (char *)FUN_0008fbe0(sVar2 + 0x1a);
    FUN_0007d00c(pcVar1, sVar2 + 0x1a, "%s/use-%u.XXXXXX", pcVar5, _Var4);
    __mask = umask(0x3f);
    iVar6 = mkstemp64(pcVar1);
    umask(__mask);
    if (iVar6 < 0) {
        free(pcVar1);
        option_usage_fp = (FILE *)0x0;
    } else {
        DAT_001183e4 = pcVar1;
        option_usage_fp = fdopen(iVar6, "w");
        if (option_usage_fp != (FILE *)0x0)
            goto LAB_00090964;
    }
    (**(code **)(param_1 + 0x54))(param_1, 0);
LAB_00090964:
    DAT_001183e0 = 1;
    DAT_001183e8 = DAT_001182e8;
    FUN_0009d6fc(optionPagedUsage);
    DAT_001182e8 = 0;
    (**(code **)(param_1 + 0x54))(param_1, 0);
    /* WARNING: Subroutine does not return */
    _exit(1);
}

/* WARNING: Restarted to delay deadcode elimination for space: stack */

void FUN_00090a10(int param_1, int *param_2)

{
    undefined4 uVar1;
    FILE *pFVar2;
    int *piVar3;
    int iVar4;
    char *pcVar5;
    char *__s;
    char *pcVar6;
    size_t sVar7;
    size_t sVar8;
    int *piVar9;
    char *pcVar10;
    int iVar11;
    uint __n;
    stat64 sStack_1098;
    undefined1 auStack_102c[4096];
    int local_2c;

    local_2c = __stack_chk_guard;
    if ((*(ushort *)(param_1 + 0x5e) & 0x7fff) != 0) {
        pcVar10 = *(char **)(*(int *)(param_1 + 0x44) +
                             (uint) * (ushort *)(param_1 + 0x5e) * 0x40 + 0x18);
        if ((pcVar10 == (char *)0x0) || (*pcVar10 == '\0')) {
            piVar9 = *(int **)(param_1 + 0x34);
            if (piVar9 != (int *)0x0) {
                if (piVar9[1] != 0) {
                    piVar3 = piVar9 + 1;
                    do {
                        piVar9 = piVar3;
                        piVar3 = piVar9 + 1;
                    } while (piVar9[1] != 0);
                }
                pcVar10 = (char *)*piVar9;
                if (*pcVar10 != '$')
                    goto LAB_00090ab8;
                pcVar5 = pcVar10 + 1;
                pcVar6 = strchr(pcVar5, 0x2f);
                if (pcVar6 == (char *)0x0) {
                    pcVar10 = getenv(pcVar5);
                    iVar11 = 0;
                    if (pcVar10 != (char *)0x0)
                        goto LAB_00090abc;
                LAB_00090b98:
                    fprintf(stderr, (char *)option_xlateable_txt._240_4_,
                            *(undefined4 *)(param_1 + 0x1c));
                    fprintf(stderr, (char *)option_xlateable_txt._192_4_,
                            pcVar5);
                } else {
                    sVar7 = (int)pcVar6 - (int)pcVar5;
                    if ((int)sVar7 < 0x80) {
                        pcVar10 = (char *)memcpy(auStack_102c, pcVar5, sVar7);
                        auStack_102c[sVar7] = 0;
                        __s = getenv(pcVar10);
                        if (__s == (char *)0x0)
                            goto LAB_00090b98;
                        sVar7 = strlen(__s);
                        sVar8 = strlen(pcVar6);
                        pcVar10 = (char *)FUN_0008fbe0(sVar7 + sVar8 + 2);
                        if (pcVar10 != (char *)0x0) {
                            iVar11 = 1;
                            sprintf(pcVar10, "%s/%s", __s, pcVar6);
                            goto LAB_00090abc;
                        }
                    }
                }
            }
        } else {
        LAB_00090ab8:
            iVar11 = 0;
        LAB_00090abc:
            iVar4 = __xstat64(3, pcVar10, &sStack_1098);
            pcVar6 = pcVar10;
            if (iVar4 == 0) {
                if ((sStack_1098.st_mode & 0xf000) == 0x4000) {
                    sVar7 = strlen(pcVar10);
                    sVar8 = strlen(*(char **)(param_1 + 0x24));
                    iVar4 = sVar7 + sVar8 + 2;
                    pcVar6 = (char *)FUN_0008fbe0(iVar4);
                    FUN_0007d00c(pcVar6, iVar4, "%s/%s", pcVar10,
                                 *(undefined4 *)(param_1 + 0x24));
                    if (iVar11 != 0) {
                        free(pcVar10);
                    }
                    iVar11 = __xstat64(3, pcVar6, &sStack_1098);
                    if (iVar11 == 0) {
                        if ((sStack_1098.st_mode & 0xf000) != 0x8000) {
                            fprintf(stderr,
                                    (char *)option_xlateable_txt._240_4_,
                                    *(undefined4 *)(param_1 + 0x1c), pcVar6);
                            pcVar10 = pcVar6;
                            goto LAB_00090c40;
                        }
                        iVar11 = 1;
                    } else {
                        piVar9 = __errno_location();
                        if (*piVar9 != 2) {
                            fprintf(stderr,
                                    (char *)option_xlateable_txt._240_4_,
                                    *(undefined4 *)(param_1 + 0x1c));
                            pFVar2 = stderr;
                            uVar1 = option_xlateable_txt._176_4_;
                            iVar11 = *piVar9;
                            pcVar10 = strerror(iVar11);
                            fprintf(pFVar2, (char *)uVar1, iVar11, pcVar10,
                                    pcVar6);
                            free(pcVar6);
                            pcVar6 = (char *)0x0;
                            goto LAB_00090bcc;
                        }
                        sStack_1098.st_mode = 0x8000;
                        iVar11 = 1;
                    }
                } else if ((sStack_1098.st_mode & 0xf000) != 0x8000) {
                    fprintf(stderr, (char *)option_xlateable_txt._240_4_,
                            *(undefined4 *)(param_1 + 0x1c), pcVar10);
                    if (iVar11 == 0) {
                        pcVar6 = (char *)0x0;
                        goto LAB_00090bcc;
                    }
                    goto LAB_00090c40;
                }
            LAB_00090b74:
                unlink(pcVar6);
                *param_2 = iVar11;
                goto LAB_00090bcc;
            }
            piVar9 = __errno_location();
            if (*piVar9 == 2) {
                pcVar5 = strrchr(pcVar10, 0x2f);
                if (pcVar5 == (char *)0x0) {
                    sStack_1098.st_mode = 0x8000;
                    goto LAB_00090b74;
                }
                __n = (int)pcVar5 - (int)pcVar10;
                if (__n < 0x1000) {
                    pcVar5 = (char *)memcpy(auStack_102c, pcVar10, __n);
                    auStack_102c[__n] = 0;
                    iVar4 = __xstat64(3, pcVar5, &sStack_1098);
                    if ((iVar4 == 0) &&
                        ((sStack_1098.st_mode & 0xf000) == 0x4000)) {
                        sStack_1098.st_mode = 0x8000;
                        goto LAB_00090b74;
                    }
                }
            }
            fprintf(stderr, (char *)option_xlateable_txt._240_4_,
                    *(undefined4 *)(param_1 + 0x1c));
            pFVar2 = stderr;
            uVar1 = option_xlateable_txt._176_4_;
            iVar4 = *piVar9;
            pcVar6 = strerror(iVar4);
            fprintf(pFVar2, (char *)uVar1, iVar4, pcVar6, pcVar10);
            if (iVar11 != 0) {
            LAB_00090c40:
                free(pcVar10);
            }
        }
    }
    pcVar6 = (char *)0x0;
LAB_00090bcc:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(pcVar6);
}

void FUN_00090e8c(char *param_1, char *param_2)

{
    char cVar1;
    char *pcVar2;
    size_t sVar3;
    DIR *__dirp;
    int iVar4;
    dirent64 *pdVar5;
    size_t sVar6;
    char *pcVar7;
    uint uVar8;
    char cVar9;
    char *__src;
    uint uVar10;
    char *pcVar11;
    uint uVar12;
    char cVar13;
    char *pcVar14;
    char local_1030[4100];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (param_1 != (char *)0x0) {
        uVar10 = 0;
    LAB_00090ed4:
        sVar3 = strlen(param_1);
        if (uVar10 < sVar3) {
            do {
                pcVar11 = param_1 + uVar10;
                cVar9 = param_1[uVar10];
                while (pcVar14 = local_1030, cVar9 == ':') {
                    pcVar11 = pcVar11 + 1;
                    cVar9 = *pcVar11;
                }
                while (true) {
                    pcVar11 = pcVar11 + 1;
                    *pcVar14 = cVar9;
                    if (cVar9 == '\0')
                        break;
                    if (cVar9 == ':') {
                        *pcVar14 = '\0';
                        break;
                    }
                    if (0xfff < (uint)((int)(pcVar14 + 1) - (int)local_1030))
                        break;
                    cVar9 = *pcVar11;
                    pcVar14 = pcVar14 + 1;
                }
                uVar10 = (int)pcVar11 - (int)param_1;
                if (local_1030[0] == '\0')
                    break;
                __dirp = opendir(local_1030);
                if (__dirp == (DIR *)0x0)
                    goto LAB_00090ed4;
                do {
                    pdVar5 = readdir64(__dirp);
                    if (pdVar5 == (dirent64 *)0x0) {
                        closedir(__dirp);
                        goto LAB_00090f78;
                    }
                    iVar4 = strcmp(pdVar5->d_name, param_2);
                } while (iVar4 != 0);
                if (*param_2 == '/') {
                    pcVar11 = (char *)__strdup(param_2);
                } else {
                    if (local_1030[0] == '\0') {
                        sVar3 = strlen(param_2);
                        pcVar11 = (char *)malloc(sVar3 + 3);
                        if (pcVar11 == (char *)0x0) {
                        LAB_00091278:
                            pcVar11 = (char *)0x0;
                            goto LAB_00091004;
                        }
                        *pcVar11 = '.';
                        pcVar11[1] = '/';
                        pcVar14 = pcVar11 + 2;
                        *pcVar14 = '\0';
                    } else {
                        sVar3 = strlen(local_1030);
                        sVar6 = strlen(param_2);
                        pcVar11 = (char *)malloc(sVar3 + sVar6 + 2);
                        if (pcVar11 == (char *)0x0)
                            goto LAB_00091278;
                        sVar6 = sVar3 + 1;
                        memcpy(pcVar11, local_1030, sVar6);
                        pcVar14 = pcVar11 + sVar3;
                        if (pcVar14[-1] != '/') {
                            pcVar11[sVar3] = '/';
                            pcVar14 = pcVar11 + sVar6;
                            pcVar11[sVar6] = '\0';
                        }
                    }
                    strcpy(pcVar14, param_2);
                }
            LAB_00091004:
                iVar4 = access(pcVar11, 5);
                if ((-1 < iVar4) && (pcVar14 = (char *)__strdup(pcVar11),
                                     pcVar14 != (char *)0x0)) {
                    cVar9 = *pcVar14;
                    uVar10 = 0;
                    if (*pcVar11 == '/') {
                        cVar13 = '/';
                    } else {
                        cVar13 = '.';
                    }
                    goto LAB_00091044;
                }
                free(pcVar11);
                closedir(__dirp);
            LAB_00090f78:
                sVar3 = strlen(param_1);
                if (sVar3 <= uVar10)
                    break;
            } while (true);
        }
    }
    pcVar14 = (char *)0x0;
    goto LAB_00091190;
LAB_00091044:
    uVar12 = uVar10;
    if (cVar9 != '\0') {
        do {
            if (cVar9 == '/') {
                uVar10 = uVar12 + 1;
            } else {
                pcVar7 = pcVar14 + uVar12;
                do {
                    uVar10 = uVar12;
                    pcVar7 = pcVar7 + 1;
                    cVar9 = *pcVar7;
                    uVar12 = uVar10 + 1;
                } while (cVar9 != '/' && cVar9 != '\0');
                uVar10 = uVar10 + 2;
                if (cVar9 == '\0')
                    break;
            }
            cVar9 = pcVar14[uVar10];
            pcVar7 = pcVar14 + uVar10;
            if (cVar9 == '/') {
                uVar8 = uVar10;
                pcVar2 = pcVar14 + uVar10 + 1;
                do {
                    __src = pcVar2;
                    uVar8 = uVar8 + 1;
                    pcVar2 = __src + 1;
                } while (*__src == '/');
                if (uVar8 != uVar10) {
                    strcpy(pcVar14 + uVar12 + 1, __src);
                    cVar9 = *pcVar7;
                }
            }
            if (uVar12 != 0) {
                if (pcVar14[uVar12 - 1] != '\\') {
                    if (cVar9 != '\0')
                        goto LAB_000910f0;
                LAB_0009126c:
                    pcVar7[-1] = '\0';
                    break;
                }
                goto LAB_00091044;
            }
        LAB_000910f0:
            if (cVar9 != '.')
                goto LAB_00091044;
            cVar1 = pcVar14[uVar10 + 1];
            if (cVar1 == '\0')
                goto LAB_0009126c;
            if (cVar1 == '/') {
                uVar12 = uVar12 & ~((int)uVar12 >> 0x1f);
                strcpy(pcVar7, pcVar14 + uVar10 + 1);
                cVar9 = pcVar14[uVar12];
                uVar10 = uVar12;
                goto LAB_00091044;
            }
            if ((cVar1 != '.') ||
                (pcVar14[uVar10 + 2] != '/' && pcVar14[uVar10 + 2] != '\0'))
                goto LAB_00091044;
            pcVar7 = pcVar14 + uVar12;
            do {
                uVar8 = uVar12;
                uVar12 = uVar8 - 1;
                if (uVar8 == 0)
                    break;
                pcVar7 = pcVar7 + -1;
            } while (*pcVar7 != '/');
            uVar12 = uVar12 & ~((int)uVar12 >> 0x1f);
            strcpy(pcVar14 + uVar8, pcVar14 + uVar10 + 2);
            cVar9 = pcVar14[uVar12];
            if (cVar9 == '\0')
                break;
        } while (true);
    }
    if (*pcVar14 == '\0') {
        *pcVar14 = cVar13;
        pcVar14[1] = '\0';
    }
    free(pcVar11);
    closedir(__dirp);
LAB_00091190:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(pcVar14);
}

void FUN_0009128c(int param_1, ushort *param_2, undefined4 param_3)

{
    char cVar1;
    ushort uVar2;
    size_t sVar3;
    int iVar4;
    uint uVar5;
    byte *pbVar6;
    int iVar7;
    uint uVar8;
    code *pcVar9;
    int *piVar10;
    int iVar11;
    char acStack_88[12];
    undefined1 auStack_7c[80];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (((*(uint *)(param_1 + 0xc) & 0x40000) != 0) && (param_2[3] == 0x57)) {
        iVar11 = *(int *)(param_1 + 0x68);
        iVar7 = *(int *)(param_1 + 0x44);
        fprintf(option_usage_fp, &UNK_000b14bd + DAT_001183ec,
                option_xlateable_txt._432_4_);
        uVar5 = 0;
        do {
            if (((*(uint *)(iVar7 + 0x10) & 0x6280000) == 0) &&
                (((0x7f < *(byte *)(iVar7 + 2) ||
                   ((*(uint *)(&DAT_000b0784 +
                               (uint) * (byte *)(iVar7 + 2) * 4) &
                     0x4000) == 0)) &&
                  (sVar3 = strlen(*(char **)(iVar7 + 0x34)), uVar5 < sVar3)))) {
                uVar5 = sVar3;
            }
            iVar11 = iVar11 + -1;
            iVar7 = iVar7 + 0x40;
        } while (0 < iVar11);
        FUN_0007d00c(acStack_88, 0xc, "%%-%us %%s\n", uVar5 + 4);
        iVar11 = *(int *)(param_1 + 0x68);
        iVar7 = *(int *)(param_1 + 0x44);
        if (DAT_001183ec != 0) {
            DAT_001183ec = DAT_001183ec + -1;
        }
        do {
            if (((*(uint *)(iVar7 + 0x10) & 0x6280000) == 0) &&
                ((0x7f < *(byte *)(iVar7 + 2) ||
                  ((*(uint *)(&DAT_000b0784 +
                              (uint) * (byte *)(iVar7 + 2) * 4) &
                    0x4000) == 0)))) {
                FUN_0008f5d4(param_1 + 0xc, iVar7 + 2, &DAT_00118318,
                             &DAT_0011831c);
                pbVar6 = DAT_0011830c;
                if ((*(uint *)(iVar7 + 0x10) & 0x10000) == 0) {
                    switch ((*(uint *)(iVar7 + 0x10) << 0x10) >> 0x1c) {
                    case 0:
                        pbVar6 = DAT_00118310;
                        break;
                    case 1:
                        pbVar6 = DAT_001182ec;
                        break;
                    case 2:
                        pbVar6 = DAT_001182fc;
                        break;
                    case 3:
                        pbVar6 = DAT_00118304;
                        break;
                    case 4:
                        pbVar6 = DAT_00118300;
                        break;
                    case 5:
                        pbVar6 = DAT_001182f4;
                        break;
                    case 6:
                        pbVar6 = DAT_00118308;
                        break;
                    case 7:
                        pbVar6 = DAT_001182f8;
                        break;
                    case 8:
                        pbVar6 = DAT_00118324;
                        break;
                    default:
                        fprintf(stderr, (char *)option_xlateable_txt._136_4_,
                                *(undefined4 *)(param_1 + 0x1c),
                                *(undefined4 *)(iVar7 + 0x34));
                        FUN_0008e31c(option_xlateable_txt._64_4_);
                        goto LAB_00091aec;
                    }
                }
                iVar4 = DAT_00118358;
                if (DAT_00118358 == 0) {
                    iVar4 = FUN_0008f738(0xc);
                }
                uVar5 = (uint)*pbVar6;
                cVar1 = *(char *)(iVar4 + uVar5);
                while (cVar1 != '\0') {
                    pbVar6 = pbVar6 + 1;
                    uVar5 = (uint)*pbVar6;
                    cVar1 = *(char *)(iVar4 + uVar5);
                }
                if (uVar5 == 0) {
                    FUN_0007d00c(auStack_7c, 0x50, "%s",
                                 *(undefined4 *)(iVar7 + 0x34));
                } else {
                    FUN_0007d00c(auStack_7c, 0x50, "%s=%s",
                                 *(undefined4 *)(iVar7 + 0x34), pbVar6);
                }
                fprintf(option_usage_fp, acStack_88, auStack_7c,
                        *(undefined4 *)(iVar7 + 0x2c));
                uVar5 = (uint)(*(int *)(iVar7 + 0x10) << 0x10) >> 0x1c;
                if (((uVar5 == 2) || (uVar5 == 4)) &&
                    (*(int *)(iVar7 + 0x28) != 0)) {
                    DAT_001183f0 = 1;
                }
                FUN_0009128c(param_1, iVar7, param_3);
            }
            iVar11 = iVar11 + -1;
            iVar7 = iVar7 + 0x40;
        } while (0 < iVar11);
        goto LAB_000915b4;
    }
    if ((*(int *)(param_2 + 0x10) != 0) || (*(int *)(param_2 + 0x12) != 0)) {
        fputs(&UNK_000b14a3 + DAT_001183ec, option_usage_fp);
        piVar10 = *(int **)(param_2 + 0x10);
        if (piVar10 != (int *)0x0) {
            if (piVar10[1] == 0x8000) {
                fprintf(option_usage_fp, (char *)option_xlateable_txt._400_4_,
                        *(undefined4 *)(*(int *)(param_1 + 0x44) +
                                        *piVar10 * 0x40 + 0x34));
            } else {
                fputs((char *)option_xlateable_txt._404_4_, option_usage_fp);
                iVar7 = *piVar10;
                do {
                    fprintf(option_usage_fp, &UNK_000b14bd + DAT_001183ec,
                            *(undefined4 *)(*(int *)(param_1 + 0x44) +
                                            iVar7 * 0x40 + 0x34));
                    piVar10 = piVar10 + 1;
                    iVar7 = *piVar10;
                } while (iVar7 != 0x8000);
            }
            if (*(int *)(param_2 + 0x12) == 0)
                goto LAB_000913ec;
            fputs("\t\t\t\t-- and " + DAT_001183ec, option_usage_fp);
        }
        piVar10 = *(int **)(param_2 + 0x12);
        if (piVar10 != (int *)0x0) {
            if (piVar10[1] == 0x8000) {
                fprintf(option_usage_fp, (char *)option_xlateable_txt._360_4_,
                        *(undefined4 *)(*(int *)(param_1 + 0x44) +
                                        *piVar10 * 0x40 + 0x34));
            } else {
                fputs((char *)option_xlateable_txt._356_4_, option_usage_fp);
                iVar7 = *piVar10;
                do {
                    fprintf(option_usage_fp, &UNK_000b14bd + DAT_001183ec,
                            *(undefined4 *)(*(int *)(param_1 + 0x44) +
                                            iVar7 * 0x40 + 0x34));
                    piVar10 = piVar10 + 1;
                    iVar7 = *piVar10;
                } while (iVar7 != 0x8000);
            }
        }
    }
LAB_000913ec:
    if (*(int *)(param_2 + 0x1c) != 0) {
        fprintf(option_usage_fp,
                (char *)(option_xlateable_txt._256_4_ + DAT_001183ec));
    }
    uVar8 = *(uint *)(param_2 + 8);
    uVar5 = (uVar8 << 0x10) >> 0x1c;
    if (uVar5 == 5) {
        pcVar9 = *(code **)(param_2 + 0x14);
        if (pcVar9 != (code *)0x0 && pcVar9 != optionNumericVal) {
            (*pcVar9)(1, param_2);
            uVar8 = *(uint *)(param_2 + 8);
        }
    } else if (uVar5 == 7) {
        (**(code **)(param_2 + 0x14))(1, param_2);
        uVar8 = *(uint *)(param_2 + 8);
    }
    if ((uVar8 & 0x800) != 0) {
        fputs((char *)(option_xlateable_txt._268_4_ + DAT_001183ec),
              option_usage_fp);
    }
    uVar5 = (uint)param_2[4];
    if ((uVar5 == 0x8000) || (param_2[2] == uVar5)) {
        uVar5 = *(uint *)(param_2 + 8);
        if (((uVar5 & 0x100) != 0) &&
            (((*(int *)(param_1 + 0x34) != 0 ||
               (*(int *)(param_1 + 0x20) != 0)) &&
              ((int)(uint)*param_2 < *(int *)(param_1 + 0x68))))) {
            fputs((char *)(option_xlateable_txt._316_4_ + DAT_001183ec),
                  option_usage_fp);
            uVar5 = *(uint *)(param_2 + 8);
        }
        if ((uVar5 << 0x10) >> 0x1c == 4) {
            fputs((char *)(option_xlateable_txt._300_4_ + DAT_001183ec),
                  option_usage_fp);
        } else if (param_2[5] < 2) {
            uVar2 = param_2[6];
            if (uVar2 != 1) {
                if (uVar2 == 0) {
                    fputs((char *)(option_xlateable_txt._348_4_ + DAT_001183ec),
                          option_usage_fp);
                } else if (uVar2 == 0xffff) {
                    fputs((char *)(option_xlateable_txt._312_4_ + DAT_001183ec),
                          option_usage_fp);
                } else {
                    fprintf(
                        option_usage_fp,
                        (char *)(option_xlateable_txt._420_4_ + DAT_001183ec));
                }
            }
        } else {
            fprintf(option_usage_fp,
                    (char *)(option_xlateable_txt._304_4_ + DAT_001183ec),
                    (uint)param_2[5], (uint)param_2[6]);
        }
        if (((*(uint *)(param_1 + 0xc) & 3) == 0) &&
            (*(ushort *)(param_1 + 0x62) == *param_2)) {
            fputs((char *)(option_xlateable_txt._252_4_ + DAT_001183ec),
                  option_usage_fp);
        }
    } else {
        fprintf(
            option_usage_fp,
            (char *)(option_xlateable_txt._244_4_ + DAT_001183ec),
            *(undefined4 *)(*(int *)(param_1 + 0x44) + uVar5 * 0x40 + 0x34));
    }
LAB_000915b4:
    if (local_2c == __stack_chk_guard) {
        return;
    }
LAB_00091aec:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00091b90(int param_1, int param_2, undefined4 param_3)

{
    undefined4 uVar1;
    undefined *puVar2;
    uint uVar3;
    undefined4 uVar4;
    int iVar5;
    int iVar6;
    int iVar7;
    int iVar8;
    int iVar9;
    int local_9c;
    undefined1 auStack_7c[80];
    int local_2c;

    iVar9 = 0;
    local_9c = 0;
    iVar6 = *(int *)(param_1 + 0x44);
    iVar8 = iVar6 + 2;
    local_2c = __stack_chk_guard;
    iVar7 = *(int *)(param_1 + 100);
    do {
        puVar2 = *(undefined **)(iVar6 + 0x10);
        if (((uint)puVar2 & 0x6080000) == 0) {
            if (((uint)puVar2 & 0x200000) == 0) {
                uVar3 = *(uint *)(param_1 + 0xc) & 0x40000;
                if ((uVar3 == 0) ||
                    ((*(byte *)(iVar6 + 2) < 0x80 &&
                      ((*(uint *)(&DAT_000b0784 +
                                  (uint) * (byte *)(iVar6 + 2) * 4) &
                        0x4000) != 0)))) {
                    if (0 < local_9c && param_2 == 0) {
                        if (*(int *)(param_1 + 0x68) == iVar9) {
                            if ((*(uint *)(iVar6 + -0x30) & 0x200000) == 0) {
                                fprintf(option_usage_fp, DAT_00118314,
                                        option_xlateable_txt._248_4_, param_3);
                            }
                        } else if (uVar3 != 0 && iVar7 == 1) {
                            fprintf(option_usage_fp, DAT_00118314,
                                    option_xlateable_txt._428_4_, param_3);
                        }
                    }
                    FUN_0008f5d4(param_1 + 0xc, iVar8, &DAT_00118318,
                                 &DAT_0011831c);
                    uVar4 = DAT_0011830c;
                    if ((*(uint *)(iVar6 + 0x10) & 0x10000) == 0) {
                        switch ((*(uint *)(iVar6 + 0x10) << 0x10) >> 0x1c) {
                        case 0:
                            uVar4 = DAT_00118310;
                            break;
                        case 1:
                            uVar4 = DAT_001182ec;
                            break;
                        case 2:
                            uVar4 = DAT_001182fc;
                            break;
                        case 3:
                            uVar4 = DAT_00118304;
                            break;
                        case 4:
                            uVar4 = DAT_00118300;
                            break;
                        case 5:
                            uVar4 = DAT_001182f4;
                            break;
                        case 6:
                            uVar4 = DAT_00118308;
                            break;
                        case 7:
                            uVar4 = DAT_001182f8;
                            break;
                        case 8:
                            uVar4 = DAT_00118324;
                            break;
                        default:
                            fprintf(stderr,
                                    (char *)option_xlateable_txt._136_4_,
                                    *(undefined4 *)(param_1 + 0x1c),
                                    *(undefined4 *)(iVar6 + 0x34));
                            /* WARNING: Subroutine does not return */
                            FUN_0008e2b8(0x46);
                        }
                    }
                    uVar1 = DAT_001182f0;
                    if (*(short *)(iVar6 + 10) == 0) {
                        uVar1 = DAT_0011830c;
                    }
                    FUN_0007d00c(auStack_7c, 0x50, DAT_00118320, uVar4,
                                 *(undefined4 *)(iVar6 + 0x34), uVar1);
                    fprintf(option_usage_fp, &DAT_001183f4, auStack_7c,
                            *(undefined4 *)(iVar6 + 0x2c));
                    uVar3 = (uint)(*(int *)(iVar6 + 0x10) << 0x10) >> 0x1c;
                    if (((uVar3 == 2) || (uVar3 == 4)) &&
                        (*(int *)(iVar6 + 0x28) != 0)) {
                        DAT_001183f0 = 1;
                    }
                    if (param_2 == 0) {
                        FUN_0009128c(param_1, iVar6, param_3);
                    }
                }
            } else if (param_2 == 0) {
                local_9c = local_9c + 1;
                fprintf(option_usage_fp, DAT_00118314,
                        *(undefined4 *)(iVar6 + 0x2c), param_3);
            }
        } else if (puVar2 == &UNK_00080100) {
            iVar5 = *(int *)(iVar6 + 0x34);
            if (iVar5 != 0) {
                iVar5 = 1;
            }
            if (param_2 != 0) {
                iVar5 = 0;
            }
            if (iVar5 != 0) {
                iVar5 = *(int *)(iVar6 + 0x2c);
                if (*(int *)(iVar6 + 0x2c) == 0) {
                    iVar5 = option_xlateable_txt._264_4_;
                }
                FUN_0008f5d4(param_1 + 0xc, iVar8, &DAT_00118318,
                             &DAT_0011831c);
                fprintf(option_usage_fp, (char *)option_xlateable_txt._260_4_,
                        *(undefined4 *)(iVar6 + 0x34), iVar5);
            }
        }
        iVar7 = iVar7 + -1;
        iVar6 = iVar6 + 0x40;
        iVar9 = iVar9 + 1;
        iVar8 = iVar8 + 0x40;
    } while (0 < iVar7);
    fputc(10, option_usage_fp);
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000926f8(byte *param_1, int param_2)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    uint uVar4;
    byte *pbVar5;

    iVar1 = __stack_chk_guard;
    if (param_2 - 3U < 0xc) {
        uVar4 = (uint)(byte)(&DAT_000b0aa0)[*param_1] + param_2;
        if (((uVar4 < 0x12) && (pbVar5 = *(byte **)(&DAT_000c6208 + uVar4 * 8),
                                (uint)*pbVar5 == (uint)*param_1)) &&
            (iVar2 = strncmp((char *)(param_1 + 1), (char *)(pbVar5 + 1),
                             param_2 - 1),
             iVar2 == 0)) {
            uVar3 = 0;
            if (pbVar5[param_2] == 0) {
                uVar3 = *(undefined4 *)(&DAT_000c620c + uVar4 * 8);
            }
            goto LAB_00092788;
        }
    }
    uVar3 = 0;
LAB_00092788:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar3);
    }
    return;
}

void FUN_000927bc(byte *param_1, int param_2)

{
    int iVar1;
    int iVar2;
    int iVar3;
    undefined4 uVar4;
    byte *pbVar5;

    iVar2 = __stack_chk_guard;
    if (param_2 - 4U < 5) {
        if ((uint)(byte) "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
                         "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
                         "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
                         "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
                             [*param_1] +
                param_2 <
            10) {
            iVar1 = ((uint)(byte) "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
                                  "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
                                  "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
                                  "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
                                  "\n\n\n\n\n\n\n\n\n\n\n"[*param_1] +
                     param_2) *
                    8;
            pbVar5 = *(byte **)(&DAT_000c6298 + iVar1);
            if (((uint)*pbVar5 == (uint)*param_1) &&
                (iVar3 = strncmp((char *)(param_1 + 1), (char *)(pbVar5 + 1),
                                 param_2 - 1),
                 iVar3 == 0)) {
                uVar4 = 0;
                if (pbVar5[param_2] == 0) {
                    uVar4 = *(undefined4 *)(&DAT_000c629c + iVar1);
                }
                goto LAB_0009284c;
            }
        }
    }
    uVar4 = 0;
LAB_0009284c:
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar4);
}

void FUN_00092880(byte *param_1, undefined4 *param_2, undefined4 *param_3)

{
    char cVar1;
    byte bVar2;
    int iVar3;
    undefined4 uVar4;
    int iVar5;
    uint uVar6;
    byte *pbVar7;
    byte *pbVar8;
    byte *pbVar9;

    iVar3 = __stack_chk_guard;
    do {
        iVar5 = DAT_0011837c;
        if (DAT_0011837c == 0) {
            iVar5 = FUN_0008f738(0x15);
        }
        uVar6 = (uint) * (byte *)(iVar5 + (uint)*param_1);
        pbVar8 = param_1;
        if (uVar6 != 0) {
            do {
                pbVar8 = pbVar8 + 1;
            } while (*(char *)(iVar5 + (uint)*pbVar8) != '\0');
            uVar6 = (int)pbVar8 - (int)param_1;
        }
        uVar4 = FUN_000927bc(param_1, uVar6);
        switch (uVar4) {
        case 1:
            pbVar7 = pbVar8 + 1;
            if (*pbVar8 != 0x3d) {
            LAB_00092a10:
                iVar5 = 0;
            switchD_00092c40_default:
                pbVar8 = pbVar7 + iVar5;
                *param_3 = 0;
                iVar5 = DAT_001183ac;
                if (DAT_001183ac == 0) {
                    iVar5 = FUN_0008f738(0x21);
                }
                uVar6 = (uint)*pbVar8;
                if (uVar6 != 0) {
                    while (*(char *)(iVar5 + uVar6) == '\0') {
                        pbVar8 = pbVar8 + 1;
                        uVar6 = (uint)*pbVar8;
                        if (uVar6 == 0)
                            goto LAB_000929e0;
                    }
                    break;
                }
                goto LAB_000929e0;
            }
            iVar5 = DAT_00118394;
            if (DAT_00118394 == 0) {
                iVar5 = FUN_0008f738(0x1b);
            }
            pbVar9 = pbVar7;
            if (*(char *)(iVar5 + (uint)pbVar8[1]) == '\0')
                goto LAB_00092a10;
            do {
                pbVar8 = pbVar9 + 1;
                uVar6 = (uint)*pbVar8;
                pbVar9 = pbVar8;
            } while (*(char *)(iVar5 + uVar6) != '\0');
            iVar5 = (int)pbVar8 - (int)pbVar7;
            if (iVar5 == 0)
                goto LAB_00092a10;
            if ((0x7f < uVar6) ||
                ((*(uint *)(&DAT_000b0784 + uVar6 * 4) & 0x1000c01) == 0))
                goto switchD_00092c40_default;
            uVar4 = FUN_000926f8(pbVar7, iVar5);
            switch (uVar4) {
            case 1:
                *param_3 = 1;
                break;
            case 2:
                *param_3 = 5;
                break;
            case 3:
                goto LAB_00092c90;
            case 4:
            LAB_00092c90:
                *param_3 = 3;
                break;
            case 5:
                *param_3 = 2;
                break;
            case 6:
                goto LAB_00092c78;
            case 7:
            LAB_00092c78:
                *param_3 = 4;
                break;
            case 8:
                goto LAB_00092c6c;
            case 9:
            LAB_00092c6c:
                *param_3 = 6;
                break;
            default:
                goto switchD_00092c40_default;
            }
            break;
        case 2:
            iVar5 = DAT_001183ac;
            if (DAT_001183ac == 0) {
                iVar5 = FUN_0008f738(0x21);
            }
            bVar2 = *pbVar8;
            while (true) {
                if (bVar2 == 0)
                    goto LAB_000929e0;
                if (*(char *)(iVar5 + (uint)bVar2) != '\0')
                    break;
                pbVar8 = pbVar8 + 1;
                bVar2 = *pbVar8;
            }
            break;
        case 3:
            iVar5 = DAT_001183ac;
            if (DAT_001183ac == 0) {
                iVar5 = FUN_0008f738(0x21);
            }
            bVar2 = *pbVar8;
            while (true) {
                if (bVar2 == 0)
                    goto LAB_000929e0;
                if (*(char *)(iVar5 + (uint)bVar2) != '\0')
                    break;
                pbVar8 = pbVar8 + 1;
                bVar2 = *pbVar8;
            }
            break;
        case 4:
            param_1 = pbVar8;
            if ((0x7f < *pbVar8) ||
                ((*(uint *)(&DAT_000b0784 + (uint)*pbVar8 * 4) & 0x1000c01) ==
                 0))
                goto switchD_00092930_default;
            *param_2 = 0;
            break;
        case 5:
            param_1 = pbVar8;
            if ((0x7f < *pbVar8) ||
                ((*(uint *)(&DAT_000b0784 + (uint)*pbVar8 * 4) & 0x1000c01) ==
                 0))
                goto switchD_00092930_default;
            *param_2 = 1;
            break;
        case 6:
            param_1 = pbVar8;
            if ((0x7f < *pbVar8) ||
                ((*(uint *)(&DAT_000b0784 + (uint)*pbVar8 * 4) & 0x1000c01) ==
                 0))
                goto switchD_00092930_default;
            *param_2 = 2;
            break;
        default:
        switchD_00092930_default:
            *param_3 = 0;
            iVar5 = DAT_001183ac;
            if (DAT_001183ac == 0) {
                iVar5 = FUN_0008f738(0x21);
            }
            uVar6 = (uint)*param_1;
            if (uVar6 != 0)
                goto LAB_00092b90;
            goto LAB_000929e0;
        }
        iVar5 = DAT_00118358;
        if (DAT_00118358 == 0) {
            iVar5 = FUN_0008f738(0xc);
        }
        uVar6 = (uint)*pbVar8;
        cVar1 = *(char *)(iVar5 + uVar6);
        param_1 = pbVar8;
        while (cVar1 != '\0') {
            param_1 = param_1 + 1;
            uVar6 = (uint)*param_1;
            cVar1 = *(char *)(iVar5 + uVar6);
        }
        if (uVar6 == 0x2f) {
            *param_3 = 0;
            goto LAB_000929e4;
        }
        if (uVar6 == 0x3e)
            goto LAB_000929e4;
        if ((0x7f < uVar6) ||
            ((*(uint *)(&DAT_000b0784 + uVar6 * 4) & 0x80000) == 0))
            goto LAB_000929e0;
    } while (true);
    while (true) {
        param_1 = param_1 + 1;
        uVar6 = (uint)*param_1;
        if (uVar6 == 0)
            break;
    LAB_00092b90:
        if (*(char *)(iVar5 + uVar6) != '\0')
            goto LAB_000929e4;
    }
LAB_000929e0:
    param_1 = (byte *)0x0;
LAB_000929e4:
    if (iVar3 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_00093074(int *param_1, char *param_2)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    int iVar4;
    int iVar5;
    int *piVar6;

    iVar1 = __stack_chk_guard;
    if ((param_1 == (int *)0x0) || (*param_1 != 6)) {
        piVar3 = __errno_location();
        iVar5 = 0;
        *piVar3 = 0x16;
    } else {
        piVar3 = (int *)param_1[2];
        iVar4 = *piVar3;
        if (0 < iVar4) {
            piVar6 = piVar3 + 2;
            if (param_2 == (char *)0x0) {
                iVar5 = piVar3[2];
                if (iVar5 != 0)
                    goto LAB_000930d4;
            } else {
                do {
                    iVar5 = *piVar6;
                    iVar2 = strcmp(*(char **)(iVar5 + 4), param_2);
                    if (iVar2 == 0)
                        goto LAB_000930d4;
                    iVar4 = iVar4 + -1;
                    piVar6 = piVar6 + 1;
                } while (iVar4 != 0);
            }
        }
        piVar3 = __errno_location();
        iVar5 = 0;
        *piVar3 = 2;
    }
LAB_000930d4:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar5);
    }
    return;
}

void FUN_00093260(int *param_1, int param_2)

{
    int iVar1;
    int *piVar2;
    int *piVar3;
    int iVar4;
    int iVar5;

    iVar1 = __stack_chk_guard;
    if ((param_1 == (int *)0x0) || (*param_1 != 6)) {
        piVar3 = __errno_location();
        iVar5 = 0;
        *piVar3 = 0x16;
    } else {
        piVar3 = (int *)param_1[2] + 2;
        iVar5 = *(int *)param_1[2];
        do {
            piVar2 = piVar3;
            iVar4 = iVar5 + -1;
            if (iVar5 < 1) {
                iVar4 = 0x16;
                goto LAB_000932c8;
            }
            piVar3 = piVar2 + 1;
            iVar5 = iVar4;
        } while (*piVar2 != param_2);
        if (iVar4 == 0) {
            iVar4 = 2;
        LAB_000932c8:
            piVar3 = __errno_location();
            iVar5 = 0;
            *piVar3 = iVar4;
        } else {
            iVar5 = piVar2[1];
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar5);
}

void FUN_00093324(byte *param_1, byte *param_2, byte param_3)

{
    byte bVar1;
    byte bVar2;
    ulong uVar3;
    int iVar4;
    int iVar5;
    byte local_18[4];
    int local_14;

    bVar1 = *param_1;
    local_14 = __stack_chk_guard;
    *param_2 = bVar1;
    switch (bVar1) {
    case 0:
        iVar5 = 0;
        goto LAB_00093548;
    case 1:
        break;
    case 2:
        break;
    case 3:
        break;
    case 4:
        break;
    case 5:
        break;
    case 6:
        break;
    case 7:
        break;
    case 8:
        break;
    case 9:
        break;
    case 10:
        iVar5 = 1;
    LAB_00093544:
        *param_2 = param_3;
        goto LAB_00093548;
    case 0xb:
        break;
    case 0xc:
        break;
    case 0xd:
        if (param_1[1] == 10) {
            iVar5 = 2;
            goto LAB_00093544;
        }
        break;
    case 0xe:
        break;
    case 0xf:
        break;
    case 0x10:
        break;
    case 0x11:
        break;
    case 0x12:
        break;
    case 0x13:
        break;
    case 0x14:
        break;
    case 0x15:
        break;
    case 0x16:
        break;
    case 0x17:
        break;
    case 0x18:
        break;
    case 0x19:
        break;
    case 0x1a:
        break;
    case 0x1b:
        break;
    case 0x1c:
        break;
    case 0x1d:
        break;
    case 0x1e:
        break;
    case 0x1f:
        break;
    case 0x20:
        break;
    case 0x21:
        break;
    case 0x22:
        break;
    case 0x23:
        break;
    case 0x24:
        break;
    case 0x25:
        break;
    case 0x26:
        break;
    case 0x27:
        break;
    case 0x28:
        break;
    case 0x29:
        break;
    case 0x2a:
        break;
    case 0x2b:
        break;
    case 0x2c:
        break;
    case 0x2d:
        break;
    case 0x2e:
        break;
    case 0x2f:
        break;
    case 0x30:
        goto LAB_000935b4;
    case 0x31:
        goto LAB_000935b4;
    case 0x32:
        goto LAB_000935b4;
    case 0x33:
        goto LAB_000935b4;
    case 0x34:
        goto LAB_000935b4;
    case 0x35:
        goto LAB_000935b4;
    case 0x36:
        goto LAB_000935b4;
    case 0x37:
    LAB_000935b4:
        iVar5 = 1;
        local_18[0] = *param_1;
        while (true) {
            bVar1 = param_1[iVar5];
            if ((0x7f < bVar1) ||
                ((*(uint *)(&DAT_000b0784 + (uint)bVar1 * 4) & 0x10000) == 0))
                goto LAB_000936b0;
            local_18[iVar5] = bVar1;
            if (iVar5 == 2)
                break;
            iVar5 = 2;
        }
        iVar5 = 3;
    LAB_000936b0:
        local_18[iVar5] = 0;
        uVar3 = strtoul((char *)local_18, (char **)0x0, 8);
        if (0xfe < uVar3) {
            uVar3 = 0xff;
        }
        *param_2 = (byte)uVar3;
        goto LAB_00093548;
    case 0x38:
        break;
    case 0x39:
        break;
    case 0x3a:
        break;
    case 0x3b:
        break;
    case 0x3c:
        break;
    case 0x3d:
        break;
    case 0x3e:
        break;
    case 0x3f:
        break;
    case 0x40:
        break;
    case 0x41:
        break;
    case 0x42:
        break;
    case 0x43:
        break;
    case 0x44:
        break;
    case 0x45:
        break;
    case 0x46:
        break;
    case 0x47:
        break;
    case 0x48:
        break;
    case 0x49:
        break;
    case 0x4a:
        break;
    case 0x4b:
        break;
    case 0x4c:
        break;
    case 0x4d:
        break;
    case 0x4e:
        break;
    case 0x4f:
        break;
    case 0x50:
        break;
    case 0x51:
        break;
    case 0x52:
        break;
    case 0x53:
        break;
    case 0x54:
        break;
    case 0x55:
        break;
    case 0x56:
        break;
    case 0x57:
        break;
    case 0x58:
        goto LAB_000935fc;
    case 0x59:
        break;
    case 0x5a:
        break;
    case 0x5b:
        break;
    case 0x5c:
        break;
    case 0x5d:
        break;
    case 0x5e:
        break;
    case 0x5f:
        break;
    case 0x60:
        break;
    case 0x61:
        iVar5 = 1;
        *param_2 = 7;
        goto LAB_00093548;
    case 0x62:
        iVar5 = 1;
        *param_2 = 8;
        goto LAB_00093548;
    case 99:
        break;
    case 100:
        break;
    case 0x65:
        break;
    case 0x66:
        iVar5 = 1;
        *param_2 = 0xc;
        goto LAB_00093548;
    case 0x67:
        break;
    case 0x68:
        break;
    case 0x69:
        break;
    case 0x6a:
        break;
    case 0x6b:
        break;
    case 0x6c:
        break;
    case 0x6d:
        break;
    case 0x6e:
        iVar5 = 1;
        *param_2 = 10;
        goto LAB_00093548;
    case 0x6f:
        break;
    case 0x70:
        break;
    case 0x71:
        break;
    case 0x72:
        iVar5 = 1;
        *param_2 = 0xd;
        goto LAB_00093548;
    case 0x73:
        break;
    case 0x74:
        iVar5 = 1;
        *param_2 = 9;
        goto LAB_00093548;
    case 0x75:
        break;
    case 0x76:
        iVar5 = 1;
        *param_2 = 0xb;
        goto LAB_00093548;
    case 0x77:
        break;
    case 0x78:
    LAB_000935fc:
        bVar1 = param_1[1];
        if ((bVar1 < 0x80) &&
            ((*(uint *)(&DAT_000b0784 + (uint)bVar1 * 4) & 0x70000) != 0)) {
            bVar2 = param_1[2];
            if ((bVar2 < 0x80) &&
                ((*(uint *)(&DAT_000b0784 + (uint)bVar2 * 4) & 0x70000) != 0)) {
                iVar5 = 3;
                iVar4 = 2;
                local_18[1] = bVar2;
            } else {
                iVar5 = 2;
                iVar4 = 1;
            }
            local_18[iVar4] = 0;
            local_18[0] = bVar1;
            uVar3 = strtoul((char *)local_18, (char **)0x0, 0x10);
            *param_2 = (byte)uVar3;
            goto LAB_00093548;
        }
    }
    iVar5 = 1;
LAB_00093548:
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar5);
}

void FUN_00093700(byte *param_1, int *param_2)

{
    byte *pbVar1;
    byte *__s;
    byte *pbVar2;
    byte *pbVar3;
    byte *pbVar4;
    int local_30;
    int local_2c;

    pbVar3 = (byte *)(uint)*param_1;
    __s = (byte *)(uint)param_1[1];
    if (param_2 == (int *)0x0) {
        param_2 = &local_30;
    }
    local_30 = 0;
    local_2c = __stack_chk_guard;
    pbVar4 = param_1 + 1;
    while (true) {
        while (pbVar1 = param_1, pbVar2 = pbVar4, pbVar3 != __s) {
            *pbVar1 = (byte)__s;
            param_1 = pbVar1 + 1;
            pbVar4 = pbVar2 + 1;
            if (__s == (byte *)0xa) {
                *param_2 = *param_2 + 1;
                __s = (byte *)(uint)pbVar2[1];
            } else if (__s == (byte *)0x5c) {
                __s = (byte *)(uint)pbVar2[1];
                if (__s == (byte *)0xa) {
                    *param_2 = *param_2 + 1;
                    __s = (byte *)(uint)pbVar2[2];
                    pbVar4 = pbVar2 + 2;
                    param_1 = pbVar1;
                } else if (pbVar3 == (byte *)0x27) {
                    if (((__s == (byte *)0x27) || (__s == (byte *)0x5c)) ||
                        (__s == (byte *)0x23)) {
                        *pbVar1 = pbVar2[1];
                        __s = (byte *)(uint)pbVar2[2];
                        pbVar4 = pbVar2 + 2;
                    }
                } else {
                    __s = (byte *)FUN_00093324(pbVar4, pbVar1, 10);
                    if (__s == (byte *)0x0)
                        goto LAB_000937d8;
                    pbVar2 = pbVar4 + (int)__s;
                    __s = (byte *)(uint)pbVar4[(int)__s];
                    pbVar4 = pbVar2;
                }
            } else {
                if (__s == (byte *)0x0)
                    goto LAB_000937d8;
                __s = (byte *)(uint)pbVar2[1];
            }
        }
        __s = pbVar2 + 1;
        *pbVar1 = 0;
        while (true) {
            while ((pbVar3 = (byte *)(uint)*__s,
                    pbVar3 < (byte *)0x80 &&
                        ((*(uint *)(&DAT_000b0784 + (int)pbVar3 * 4) & 0xc01) !=
                         0))) {
                __s = __s + 1;
                if (pbVar3 == (byte *)0xa) {
                    *param_2 = *param_2 + 1;
                }
            }
            if (pbVar3 == (byte *)0x27)
                goto LAB_00093894;
            if (pbVar3 != (byte *)0x2f)
                break;
            if (__s[1] == 0x2a) {
                pbVar3 = (byte *)strstr((char *)(__s + 2), "*/");
                if (pbVar3 == (byte *)0x0) {
                    __s = (byte *)0x0;
                    goto LAB_000937d8;
                }
                if (__s < pbVar3) {
                    while (__s != pbVar3 + -1) {
                        __s = __s + 1;
                        if (*__s == 10) {
                            *param_2 = *param_2 + 1;
                        }
                    }
                }
                __s = pbVar3 + 2;
            } else {
                if (__s[1] != 0x2f) {
                    __s = (byte *)0x0;
                    goto LAB_000937d8;
                }
                __s = (byte *)strchr((char *)__s, 10);
                if (__s == (byte *)0x0)
                    goto LAB_000937d8;
            }
        }
        if (pbVar3 != (byte *)0x22)
            break;
    LAB_00093894:
        pbVar4 = __s + 1;
        __s = (byte *)(uint)__s[1];
        param_1 = pbVar1;
    }
LAB_000937d8:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__s);
    }
    return;
}

void FUN_00094b1c(int param_1)

{
    int iVar1;
    undefined4 uVar2;
    undefined4 uVar3;
    bool bVar4;

    iVar1 = __stack_chk_guard;
    uVar3 = *(undefined4 *)(param_1 + 0x18);
    (**(code **)(param_1 + 0x28))(3, param_1);
    uVar2 = *(undefined4 *)(param_1 + 0x18);
    bVar4 = iVar1 == __stack_chk_guard;
    *(undefined4 *)(param_1 + 0x18) = uVar3;
    if (bVar4) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar2);
}

void FUN_00094b80(int param_1, int param_2, undefined4 *param_3, uint param_4)

{
    char cVar1;
    int iVar2;
    undefined1 *__dest;
    uint uVar3;
    undefined1 *puVar4;
    uint uVar5;
    byte *__s1;
    byte *pbVar6;
    uint uVar7;
    char *__s;
    size_t sVar8;
    bool bVar9;
    uint local_d4;
    byte *local_b0;
    undefined1 uStack_ac;
    undefined1 auStack_ab[127];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (param_1 == 2) {
        uVar5 = *(uint *)(param_2 + 0x1c) & ~(-1 << (param_4 & 0xff));
        if (uVar5 != 0) {
            uVar3 = 0;
            iVar2 = 0;
            do {
                if ((uVar5 & 1) != 0) {
                    bVar9 = iVar2 != 0;
                    iVar2 = iVar2 + 1;
                    if (bVar9) {
                        fwrite(&DAT_000b15f4, 1, 3, stdout);
                    }
                    fputs((char *)param_3[uVar3], stdout);
                }
                uVar3 = uVar3 + 1;
            } while ((uVar3 < param_4) && (uVar5 = uVar5 >> 1, uVar5 != 0));
        }
        goto LAB_00094db0;
    }
    if (param_1 == 3) {
        iVar2 = 1;
        uVar3 = (1 << (param_4 & 0xff)) - 1;
        uVar5 = *(uint *)(param_2 + 0x1c) & uVar3;
        if (uVar5 != 0) {
            uVar7 = 0;
            do {
                if ((uVar5 & 1) != 0) {
                    sVar8 = strlen((char *)param_3[uVar7]);
                    iVar2 = iVar2 + 4 + sVar8;
                }
                uVar7 = uVar7 + 1;
            } while ((uVar7 < param_4) && (uVar5 = uVar5 >> 1, uVar5 != 0));
        }
        __dest = (undefined1 *)FUN_0008fbe0(iVar2);
        uVar3 = *(uint *)(param_2 + 0x1c) & uVar3;
        *(undefined1 **)(param_2 + 0x18) = __dest;
        if (uVar3 != 0) {
            do {
                uVar5 = uVar3 & 1;
                uVar3 = uVar3 >> 1;
                if (uVar5 != 0) {
                    __s = (char *)*param_3;
                    sVar8 = strlen(__s);
                    memcpy(__dest, __s, sVar8);
                    puVar4 = __dest + sVar8;
                    if (uVar3 == 0)
                        goto code_r0x00094ea0;
                    *(undefined2 *)(__dest + sVar8) = 0x2b20;
                    __dest = puVar4 + 3;
                    puVar4[2] = 0x20;
                }
                param_3 = param_3 + 1;
            } while (true);
        }
        *__dest = 0;
        goto LAB_00094db0;
    }
    if (param_1 == 1) {
        FUN_0008dd4c();
        goto LAB_00094db0;
    }
    if ((*(uint *)(param_2 + 0x10) & 8) != 0)
        goto LAB_00094db0;
    __s1 = *(byte **)(param_2 + 0x18);
    local_d4 = *(uint *)(param_2 + 0x1c);
    iVar2 = DAT_00118358;
    if (DAT_00118358 == 0) {
        iVar2 = FUN_0008f738(0xc);
    }
    uVar5 = (uint)*__s1;
    cVar1 = *(char *)(iVar2 + uVar5);
    while (cVar1 != '\0') {
        __s1 = __s1 + 1;
        uVar5 = (uint)*__s1;
        cVar1 = *(char *)(iVar2 + uVar5);
    }
    if (uVar5 != 0) {
        if (uVar5 == 0x3d) {
            iVar2 = DAT_00118358;
            if (DAT_00118358 == 0) {
                iVar2 = FUN_0008f738(0xc);
            }
            uVar5 = (uint)__s1[1];
            cVar1 = *(char *)(iVar2 + uVar5);
            __s1 = __s1 + 1;
            while (cVar1 != '\0') {
                __s1 = __s1 + 1;
                uVar5 = (uint)*__s1;
                cVar1 = *(char *)(iVar2 + uVar5);
            }
            if (uVar5 != 0x3d) {
                if (uVar5 == 0x5e) {
                    local_d4 = 0;
                    goto LAB_00094f3c;
                }
                if (uVar5 != 0x2c) {
                    bVar9 = false;
                    local_d4 = 0;
                    goto LAB_00094c40;
                }
            }
        } else if (uVar5 == 0x5e) {
        LAB_00094f3c:
            iVar2 = DAT_00118358;
            if (DAT_00118358 == 0) {
                iVar2 = FUN_0008f738(0xc);
            }
            uVar5 = (uint)__s1[1];
            cVar1 = *(char *)(iVar2 + uVar5);
            __s1 = __s1 + 1;
            while (cVar1 != '\0') {
                __s1 = __s1 + 1;
                uVar5 = (uint)*__s1;
                cVar1 = *(char *)(iVar2 + uVar5);
            }
            if (uVar5 != 0x2c) {
                bVar9 = true;
                goto LAB_00094c40;
            }
        } else if (uVar5 != 0x2c) {
            bVar9 = false;
        LAB_00094c40:
            uVar5 = (uint)*__s1;
            while (uVar5 != 0) {
                if (uVar5 == 0x2c) {
                    iVar2 = DAT_00118358;
                    if (DAT_00118358 == 0) {
                        iVar2 = FUN_0008f738(0xc);
                    }
                    uVar5 = (uint)__s1[1];
                    cVar1 = *(char *)(iVar2 + uVar5);
                    __s1 = __s1 + 1;
                    while (cVar1 != '\0') {
                        __s1 = __s1 + 1;
                        uVar5 = (uint)*__s1;
                        cVar1 = *(char *)(iVar2 + uVar5);
                    }
                    if (uVar5 == 0x2c || uVar5 == 0x7c)
                        goto LAB_00094f88;
                    uVar5 = (uint)*__s1;
                } else {
                    if (uVar5 < 0x2d) {
                        if (uVar5 == 0x21) {
                        LAB_0009503c:
                            uVar5 = 1;
                            goto LAB_00094cac;
                        }
                        if (uVar5 == 0x2b)
                            goto LAB_00094ca8;
                    LAB_00095024:
                        uVar5 = 0;
                    } else {
                        if (uVar5 == 0x2d)
                            goto LAB_0009503c;
                        if (uVar5 != 0x7c)
                            goto LAB_00095024;
                    LAB_00094ca8:
                        uVar5 = 0;
                    LAB_00094cac:
                        iVar2 = DAT_00118358;
                        if (DAT_00118358 == 0) {
                            iVar2 = FUN_0008f738(0xc);
                        }
                        cVar1 = *(char *)(iVar2 + (uint)__s1[1]);
                        __s1 = __s1 + 1;
                        while (cVar1 != '\0') {
                            __s1 = __s1 + 1;
                            cVar1 = *(char *)(iVar2 + (uint)*__s1);
                        }
                    }
                    iVar2 = DAT_001183d0;
                    if (DAT_001183d0 == 0) {
                        iVar2 = FUN_0008f738(0x2a);
                    }
                    if ((*__s1 == 0) ||
                        (pbVar6 = __s1, *(char *)(iVar2 + (uint)*__s1) != '\0'))
                        break;
                    do {
                        pbVar6 = pbVar6 + 1;
                        if (*pbVar6 == 0)
                            break;
                    } while (*(char *)(iVar2 + (uint)*pbVar6) == '\0');
                    sVar8 = (int)pbVar6 - (int)__s1;
                    if (sVar8 == 0)
                        break;
                    if (sVar8 == 3) {
                        iVar2 = strncmp((char *)__s1, "all", 3);
                        if (iVar2 != 0)
                            goto LAB_00094f94;
                        local_d4 = -(uVar5 ^ 1);
                    } else if ((sVar8 == 4) &&
                               (iVar2 = strncmp((char *)__s1, "none", 4),
                                iVar2 == 0)) {
                        if (uVar5 == 0) {
                            local_d4 = 0;
                        }
                    } else {
                    LAB_00094f94:
                        uVar3 = strtoul((char *)__s1, (char **)&local_b0, 0);
                        if (local_b0 != pbVar6) {
                            memcpy(&uStack_ac, local_b0, sVar8);
                            auStack_ab[sVar8 - 1] = 0;
                            uVar3 = FUN_0008e084(&uStack_ac, param_1, param_2,
                                                 param_3, param_4);
                            if ((param_4 <= uVar3) ||
                                (uVar3 = 1 << (uVar3 & 0xff), uVar3 == 0))
                                goto LAB_00094f88;
                        }
                        if (uVar5 == 0) {
                            local_d4 = local_d4 | uVar3;
                        } else {
                            local_d4 = local_d4 & ~uVar3;
                        }
                    }
                    iVar2 = DAT_00118358;
                    if (DAT_00118358 == 0) {
                        iVar2 = FUN_0008f738(0xc);
                    }
                    uVar5 = (uint)*pbVar6;
                    cVar1 = *(char *)(iVar2 + uVar5);
                    __s1 = pbVar6;
                    while (cVar1 != '\0') {
                        __s1 = __s1 + 1;
                        uVar5 = (uint)*__s1;
                        cVar1 = *(char *)(iVar2 + uVar5);
                    }
                }
            }
            if (bVar9) {
                local_d4 = ~local_d4;
            }
            if (param_4 < 0x20) {
                local_d4 = local_d4 & ~(-1 << (param_4 & 0xff));
            }
            *(uint *)(param_2 + 0x1c) = local_d4;
            goto LAB_00094db0;
        }
    }
LAB_00094f88:
    *(undefined4 *)(param_2 + 0x1c) = 0;
LAB_00094db0:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
code_r0x00094ea0:
    *puVar4 = 0;
    goto LAB_00094db0;
}

void FUN_000954cc(char *param_1, char *param_2, char *param_3, char *param_4)

{
    int iVar1;
    char *pcVar2;
    char *pcVar3;
    int iVar4;
    size_t sVar5;
    size_t sVar6;
    uint uVar7;
    char cVar8;
    bool bVar9;
    byte *__s;
    int local_34;

    iVar1 = __stack_chk_guard;
    pcVar2 = (char *)strlen(param_3);
    if (pcVar2 != (char *)0x0 && pcVar2 < param_2) {
        bVar9 = false;
        cVar8 = *param_3;
        pcVar2 = param_1;
        pcVar3 = param_2;
        if (cVar8 == '$') {
            uVar7 = (uint)(byte)param_3[1];
            if (uVar7 == 0x24) {
                if (param_3[2] == '\0') {
                    local_34 = 2;
                } else {
                    if (param_3[2] != '/')
                        goto LAB_000955d0;
                    local_34 = 3;
                }
                pcVar3 = strchr(param_4, 0x2f);
                pcVar2 = param_4;
                if (pcVar3 == (char *)0x0) {
                    pcVar2 = getenv("PATH");
                    pcVar2 = (char *)FUN_00090e8c(pcVar2, param_4);
                    if (pcVar2 == (char *)0x0)
                        goto LAB_000955d0;
                }
                pcVar3 = strrchr(pcVar2, 0x2f);
                if (pcVar3 == (char *)0x0)
                    goto LAB_000955d0;
                pcVar3 = pcVar3 + (1 - (int)pcVar2);
                sVar5 = strlen(param_3 + local_34);
                if (param_2 <= pcVar3 + sVar5)
                    goto LAB_000955d0;
                memcpy(param_1, pcVar2, (size_t)pcVar3);
                strcpy(param_1 + (int)pcVar3, param_3 + local_34);
                if (param_4 != pcVar2) {
                    free(pcVar2);
                }
            } else if (uVar7 == 0x40) {
                if ((*DAT_000c928c == '\0') ||
                    (iVar4 = FUN_0007d00c(param_1, param_2, "%s%s",
                                          DAT_000c928c, param_3 + 2),
                     (int)param_2 <= iVar4))
                    goto LAB_000955cc;
            } else {
                if (((uVar7 == 0) || (0x7f < uVar7)) ||
                    ((*(uint *)(&DAT_000b0784 + uVar7 * 4) & 0x3b0060) == 0))
                    goto LAB_000955d0;
                __s = (byte *)(param_3 + 1);
                do {
                    pcVar3 = pcVar2 + 1;
                    *pcVar2 = (char)uVar7;
                    __s = __s + 1;
                    uVar7 = (uint)*__s;
                    if (0x7f < uVar7)
                        break;
                    pcVar2 = pcVar3;
                } while ((*(uint *)(&DAT_000b0784 + uVar7 * 4) & 0x3b0060) !=
                         0);
                if (param_1 == pcVar3)
                    goto LAB_000955d0;
                *pcVar3 = '\0';
                pcVar2 = getenv(param_1);
                if (pcVar2 == (char *)0x0)
                    goto LAB_000955d0;
                sVar5 = strlen(pcVar2);
                sVar6 = strlen((char *)__s);
                if (param_2 <= (char *)(sVar5 + sVar6 + 1))
                    goto LAB_000955d0;
                sprintf(param_1, "%s%s", pcVar2, __s);
            }
        } else {
            while (true) {
                *pcVar2 = cVar8;
                if (cVar8 == '\0')
                    break;
                if ((int)(pcVar3 + -1) < 1)
                    goto LAB_000955cc;
                param_3 = param_3 + 1;
                cVar8 = *param_3;
                pcVar2 = pcVar2 + 1;
                pcVar3 = pcVar3 + -1;
            }
        }
        pcVar2 = canonicalize_file_name(param_1);
        if (pcVar2 != (char *)0x0) {
            pcVar3 = (char *)strlen(pcVar2);
            bVar9 = pcVar3 < param_2;
            if (bVar9) {
                memcpy(param_1, pcVar2, (size_t)(pcVar3 + 1));
            }
            free(pcVar2);
            goto LAB_000955d0;
        }
    }
LAB_000955cc:
    bVar9 = false;
LAB_000955d0:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(bVar9);
}

void FUN_000957b8(undefined4 *param_1, char *param_2, undefined4 param_3)

{
    int iVar1;
    char *pcVar2;
    undefined4 *puVar3;
    char *__filename;
    stat64 sStack_1098;
    char acStack_1030[4100];
    int local_2c;

    local_2c = __stack_chk_guard;
    fputs((char *)option_xlateable_txt._352_4_, option_usage_fp);
    pcVar2 = (char *)*param_1;
    if (pcVar2 != (char *)0x0) {
        puVar3 = param_1 + 1;
        do {
            iVar1 = FUN_000954cc(acStack_1030, 0x1001, pcVar2, param_3);
            __filename = pcVar2;
            if (((iVar1 != 0) && (__filename = acStack_1030, *pcVar2 == '$')) &&
                (pcVar2[1] == '$' || pcVar2[1] == '@')) {
                pcVar2 = acStack_1030;
            }
            fprintf(option_usage_fp, (char *)option_xlateable_txt._340_4_,
                    pcVar2);
            if (((*param_2 != '\0') &&
                 (iVar1 = __xstat64(3, __filename, &sStack_1098),
                  iVar1 == 0)) &&
                ((sStack_1098.st_mode & 0xf000) == 0x4000)) {
                fputc(0x2f, option_usage_fp);
                fputs(param_2, option_usage_fp);
            }
            fputc(10, option_usage_fp);
            pcVar2 = (char *)*puVar3;
            puVar3 = puVar3 + 1;
        } while (pcVar2 != (char *)0x0);
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00095ce4(byte *param_1, char *param_2)

{
    byte *pbVar1;
    byte bVar2;
    int iVar3;
    size_t __n;
    int iVar4;
    undefined1 *puVar5;
    void *pvVar6;
    uint uVar7;
    int iVar8;
    byte *pbVar9;

    iVar3 = __stack_chk_guard;
    __n = strlen(param_2);
    iVar4 = 3;
    pbVar9 = param_1;
LAB_00095d28:
    while (true) {
        bVar2 = *pbVar9;
        while (true) {
            uVar7 = (uint)bVar2;
            pbVar9 = pbVar9 + 1;
            if (0x5e < uVar7 - 0x20)
                break;
            if (uVar7 == 0x22 || uVar7 == 0x5c) {
                iVar8 = 2;
            } else {
                iVar8 = 1;
            }
            iVar4 = iVar4 + iVar8;
            bVar2 = *pbVar9;
        }
        if (uVar7 < 0xe)
            break;
    LAB_00095d80:
        iVar4 = iVar4 + 4;
    }
    uVar7 = 1 << uVar7;
    if ((uVar7 & 0x3b80) != 0) {
        iVar4 = iVar4 + 2;
        goto LAB_00095d28;
    }
    if ((uVar7 & 0x400) != 0) {
        iVar4 = iVar4 + __n;
        goto LAB_00095d28;
    }
    if ((uVar7 & 1) == 0)
        goto LAB_00095d80;
    puVar5 = (undefined1 *)FUN_0008fbe0(iVar4);
    pbVar9 = puVar5 + 1;
    *puVar5 = 0x22;
LAB_00095dd4:
    do {
        bVar2 = *param_1;
        uVar7 = (uint)bVar2;
        if (uVar7 - 0x20 < 0x5f) {
            if (uVar7 == 0x22 || uVar7 == 0x5c) {
                *pbVar9 = 0x5c;
                pbVar9 = pbVar9 + 1;
            }
            *pbVar9 = bVar2;
            pbVar9 = pbVar9 + 1;
            goto LAB_00095dd0;
        }
        switch (uVar7) {
        case 0:
            goto LAB_00095e7c;
        case 1:
            break;
        case 2:
            break;
        case 3:
            break;
        case 4:
            break;
        case 5:
            break;
        case 6:
            break;
        case 7:
            *pbVar9 = 0x5c;
            pbVar9[1] = 0x61;
            pbVar9 = pbVar9 + 2;
            goto LAB_00095dd0;
        case 8:
            *pbVar9 = 0x5c;
            pbVar9[1] = 0x62;
            pbVar9 = pbVar9 + 2;
            goto LAB_00095dd0;
        case 9:
            *pbVar9 = 0x5c;
            pbVar9[1] = 0x74;
            pbVar9 = pbVar9 + 2;
            goto LAB_00095dd0;
        case 10:
            pbVar1 = param_1 + 1;
            param_1 = param_1 + 1;
            bVar2 = *pbVar1;
            pbVar1 = pbVar9;
            while (bVar2 == 10) {
                *pbVar1 = 0x5c;
                pbVar1[1] = 0x6e;
                param_1 = param_1 + 1;
                pbVar1 = pbVar1 + 2;
                bVar2 = *param_1;
            }
            if (bVar2 != 0)
                goto LAB_00095f58;
            pbVar9 = pbVar1 + 2;
            *pbVar1 = 0x5c;
            pbVar1[1] = 0x6e;
        LAB_00095e7c:
            pbVar9[1] = 0;
            *pbVar9 = 0x22;
            if (iVar3 != __stack_chk_guard) {
                /* WARNING: Subroutine does not return */
                __stack_chk_fail(puVar5);
            }
            return;
        case 0xb:
            *pbVar9 = 0x5c;
            pbVar9[1] = 0x76;
            pbVar9 = pbVar9 + 2;
            goto LAB_00095dd0;
        case 0xc:
            *pbVar9 = 0x5c;
            pbVar9[1] = 0x66;
            pbVar9 = pbVar9 + 2;
            goto LAB_00095dd0;
        case 0xd:
            *pbVar9 = 0x5c;
            pbVar9[1] = 0x72;
            pbVar9 = pbVar9 + 2;
            goto LAB_00095dd0;
        }
        sprintf((char *)pbVar9, "\\%03o");
        pbVar9 = pbVar9 + 4;
    LAB_00095dd0:
        param_1 = param_1 + 1;
    } while (true);
LAB_00095f58:
    pvVar6 = memcpy(pbVar1, param_2, __n);
    pbVar9 = (byte *)((int)pvVar6 + __n);
    goto LAB_00095dd4;
}

void FUN_00095f80(char *param_1, int param_2, FILE *param_3)

{
    int iVar1;
    void *__ptr;

    iVar1 = __stack_chk_guard;
    if (param_2 != 0) {
        fputs(param_1, param_3);
        return;
    }
    __ptr = (void *)FUN_00095ce4(param_1, &DAT_000b1551);
    fprintf(param_3, "  puts(_(%s));\n", __ptr);
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    free(__ptr);
    return;
}

void FUN_00096028(int param_1)

{
    undefined4 *puVar1;
    char cVar2;
    int iVar3;
    __int32_t **pp_Var4;
    uint uVar5;
    byte *pbVar6;
    uint uVar7;
    undefined4 uVar8;
    int iVar9;
    char *pcVar10;
    char *pcVar11;
    int iVar12;
    byte *pbVar13;
    int iVar14;
    int *piVar15;
    uint uVar16;
    int *piVar17;
    byte *__ptr;

    iVar3 = __stack_chk_guard;
    uVar16 = 0;
    printf("OPTION_CT=%d\nexport OPTION_CT\n", *(int *)(param_1 + 0x10) + -1);
    do {
        while (true) {
            iVar12 = *(int *)(param_1 + 0x44) + uVar16 * 0x40;
            uVar7 = *(uint *)(iVar12 + 0x10);
            if (((uVar7 & 0x8280000) == 0) &&
                (*(short *)(iVar12 + 8) == -0x8000))
                break;
        LAB_00096098:
            uVar16 = uVar16 + 1;
            if (*(int *)(param_1 + 0x68) <= (int)uVar16)
                goto LAB_00096214;
        }
        iVar14 = iVar12;
        if (*(ushort *)(iVar12 + 4) != uVar16) {
            iVar14 = *(int *)(param_1 + 0x44) +
                     (uint) * (ushort *)(iVar12 + 4) * 0x40;
            uVar8 = *(undefined4 *)(iVar12 + 0x30);
            *(undefined4 *)(iVar14 + 0x18) = *(undefined4 *)(iVar12 + 0x18);
            uVar7 = *(uint *)(iVar14 + 0x10) & 0xfffff00;
            *(uint *)(iVar14 + 0x10) = uVar7;
            *(uint *)(iVar14 + 0x10) =
                *(uint *)(iVar12 + 0x10) & 0xf00000ff | uVar7;
            printf("%1$s_%2$s_MODE=\'%3$s\'\nexport %1$s_%2$s_MODE\n",
                   *(undefined4 *)(param_1 + 0x20), uVar8,
                   *(undefined4 *)(iVar14 + 0x30));
            uVar7 = *(uint *)(iVar14 + 0x10);
        }
        uVar5 = (uVar7 << 0x10) >> 0x1c;
        if (uVar5 == 4) {
            uVar8 = *(undefined4 *)(iVar14 + 0x18);
            printf("%1$s_%2$s=%3$d # 0x%3$X\nexport %1$s_%2$s\n",
                   *(undefined4 *)(param_1 + 0x20),
                   *(undefined4 *)(iVar14 + 0x30),
                   *(undefined4 *)(iVar14 + 0x1c));
            *(undefined4 *)(iVar14 + 0x1c) = 0xffffffff;
            (**(code **)(iVar14 + 0x28))(3, iVar14);
            __ptr = *(byte **)(iVar14 + 0x18);
            if (*__ptr != 0) {
                iVar12 = 1;
                do {
                    printf("readonly %s_", *(undefined4 *)(iVar14 + 0x30));
                    iVar9 = DAT_001183b0;
                    if (DAT_001183b0 == 0) {
                        iVar9 = FUN_0008f738(0x22);
                    }
                    uVar7 = (uint)*__ptr;
                    cVar2 = *(char *)(iVar9 + uVar7);
                    pbVar6 = __ptr;
                    while (cVar2 != '\0') {
                        pbVar6 = pbVar6 + 1;
                        uVar7 = (uint)*pbVar6;
                        cVar2 = *(char *)(iVar9 + uVar7);
                    }
                LAB_0009643c:
                    pbVar13 = pbVar6 + 1;
                    if (0x7f < uVar7) {
                    LAB_00096418:
                        __ptr = pbVar6;
                        if (uVar7 == 0)
                            goto LAB_000964c8;
                        fputc(0x5f, stdout);
                    LAB_00096434:
                        uVar7 = (uint)*pbVar13;
                        pbVar6 = pbVar13;
                        goto LAB_0009643c;
                    }
                    uVar5 = *(uint *)(&DAT_000b0784 + uVar7 * 4);
                    if ((uVar5 & 0x80000) != 0) {
                        pp_Var4 = __ctype_toupper_loc();
                        fputc((*pp_Var4)[uVar7], stdout);
                        goto LAB_00096434;
                    }
                    if ((uVar5 & 0x100000) != 0) {
                        fputc(uVar7, stdout);
                        goto LAB_00096434;
                    }
                    __ptr = pbVar13;
                    if ((uVar5 & 0xc81) == 0)
                        goto LAB_00096418;
                LAB_000964c8:
                    printf("=%1$lu # 0x%1$lX\n", iVar12);
                    iVar12 = iVar12 << 1;
                } while (*__ptr != 0);
                __ptr = *(byte **)(iVar14 + 0x18);
            }
            free(__ptr);
            *(undefined4 *)(iVar14 + 0x18) = uVar8;
            goto LAB_00096098;
        }
        if ((*(uint *)(iVar14 + 0x10) & 0x2f) == 0x20)
            goto LAB_00096098;
        if (((uVar7 & 0x400) == 0) ||
            (piVar15 = *(int **)(iVar14 + 0x1c), piVar15 == (int *)0x0)) {
            if ((uVar7 & 0x20) == 0) {
                if (uVar5 == 5) {
                    printf("%1$s_%2$s=%3$d # 0x%3$X\nexport %1$s_%2$s\n",
                           *(undefined4 *)(param_1 + 0x20),
                           *(undefined4 *)(iVar14 + 0x30),
                           *(undefined4 *)(iVar14 + 0x18));
                } else if (uVar5 == 2) {
                    uVar8 = *(undefined4 *)(iVar14 + 0x18);
                    printf("%s_%s=", *(undefined4 *)(param_1 + 0x20),
                           *(undefined4 *)(iVar14 + 0x30));
                    (**(code **)(iVar14 + 0x28))(3, iVar14);
                    printf("\'%s\'", *(undefined4 *)(iVar14 + 0x18));
                    if ((*(uint *)(iVar14 + 0x10) & 0x40) != 0) {
                        free(*(void **)(iVar14 + 0x18));
                    }
                    *(undefined4 *)(iVar14 + 0x18) = uVar8;
                    printf("\nexport %s_%s\n", *(undefined4 *)(param_1 + 0x20),
                           *(undefined4 *)(iVar14 + 0x30));
                } else {
                    pcVar10 = *(char **)(iVar14 + 0x18);
                    if (uVar5 == 3) {
                        pcVar11 = "false";
                        if (pcVar10 != (char *)0x0) {
                            pcVar11 = "true";
                        }
                        printf("%1$s_%2$s=\'%3$s\'\nexport %1$s_%2$s\n",
                               *(undefined4 *)(param_1 + 0x20),
                               *(undefined4 *)(iVar14 + 0x30), pcVar11);
                    } else if ((pcVar10 == (char *)0x0) || (*pcVar10 == '\0')) {
                        printf("%1$s_%2$s=%3$d # 0x%3$X\nexport %1$s_%2$s\n",
                               *(undefined4 *)(param_1 + 0x20),
                               *(undefined4 *)(iVar14 + 0x30),
                               (uint) * (ushort *)(iVar14 + 0xe));
                    } else {
                        printf("%s_%s=", *(undefined4 *)(param_1 + 0x20),
                               *(undefined4 *)(iVar14 + 0x30));
                        FUN_0008f47c(*(undefined4 *)(iVar14 + 0x18));
                        printf("\nexport %s_%s\n",
                               *(undefined4 *)(param_1 + 0x20),
                               *(undefined4 *)(iVar14 + 0x30));
                    }
                }
            } else {
                pcVar10 = *(char **)(iVar14 + 0x3c);
                if (pcVar10 == (char *)0x0) {
                    pcVar10 = "false";
                }
                printf("%1$s_%2$s=%3$s\nexport %1$s_%2$s\n",
                       *(undefined4 *)(param_1 + 0x20),
                       *(undefined4 *)(iVar14 + 0x30), pcVar10);
            }
            goto LAB_00096098;
        }
        piVar17 = piVar15 + 2;
        iVar12 = *piVar15;
        printf("%1$s_%2$s_CT=%3$d\nexport %1$s_%2$s_CT\n",
               *(undefined4 *)(param_1 + 0x20), *(undefined4 *)(iVar14 + 0x30),
               iVar12);
        iVar12 = iVar12 + -1;
        if (iVar12 < 0)
            goto LAB_00096098;
        do {
            printf("%s_%s_%d=", *(undefined4 *)(param_1 + 0x20),
                   *(undefined4 *)(iVar14 + 0x30), *piVar15 - iVar12);
            FUN_0008f47c(*piVar17);
            iVar9 = *piVar15 - iVar12;
            iVar12 = iVar12 + -1;
            printf("\nexport %s_%s_%d\n", *(undefined4 *)(param_1 + 0x20),
                   *(undefined4 *)(iVar14 + 0x30), iVar9);
            piVar17 = piVar17 + 1;
        } while (iVar12 != -1);
        uVar16 = uVar16 + 1;
    } while ((int)uVar16 < *(int *)(param_1 + 0x68));
LAB_00096214:
    if (((*(uint *)(param_1 + 0xc) & 0x800) != 0) &&
        (*(uint *)(param_1 + 0x10) < *(uint *)(param_1 + 4))) {
        fwrite("set --", 1, 6, stdout);
        uVar16 = *(uint *)(param_1 + 0x10);
        if (uVar16 < *(uint *)(param_1 + 4)) {
            iVar12 = uVar16 << 2;
            do {
                fputc(0x20, stdout);
                uVar16 = uVar16 + 1;
                puVar1 = (undefined4 *)(*(int *)(param_1 + 8) + iVar12);
                iVar12 = iVar12 + 4;
                FUN_0008f47c(*puVar1);
            } while (uVar16 < *(uint *)(param_1 + 4));
        }
        fwrite("\nOPTION_CT=0\n", 1, 0xd, stdout);
    }
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    fflush(stdout);
    return;
}

void FUN_000968a8(int *param_1)

{
    char *pcVar1;
    FILE *pFVar2;
    int iVar3;
    size_t sVar4;
    undefined1 *__ptr;
    int *piVar5;
    uint uVar6;
    ushort *puVar7;
    int iVar8;
    int iVar9;
    char *pcVar10;
    undefined4 uVar11;
    ushort *puVar12;
    int iVar13;
    int *piVar14;
    time_t local_30;
    int local_2c;

    local_30 = 0;
    local_2c = __stack_chk_guard;
    pcVar1 = (char *)FUN_00090a10(param_1, &local_30);
    if (pcVar1 != (char *)0x0) {
        pFVar2 = fopen64(pcVar1, "w");
        if (pFVar2 == (FILE *)0x0) {
            fprintf(stderr, (char *)option_xlateable_txt._240_4_, param_1[7]);
            pFVar2 = stderr;
            piVar5 = __errno_location();
            uVar11 = option_xlateable_txt._164_4_;
            iVar8 = *piVar5;
            pcVar10 = strerror(iVar8);
            fprintf(pFVar2, (char *)uVar11, iVar8, pcVar10, pcVar1);
            if (local_30 != 0) {
                free(pcVar1);
            }
        } else {
            if (local_30 != 0) {
                free(pcVar1);
            }
            fwrite(&DAT_000b3f34, 1, 3, pFVar2);
            pcVar10 = (char *)param_1[0xe];
            pcVar1 = strchr(pcVar10, 10);
            if (pcVar1 != (char *)0x0) {
                fwrite(pcVar10, 1, (size_t)(pcVar1 + (1 - (int)pcVar10)),
                       pFVar2);
            }
            local_30 = time((time_t *)0x0);
            pcVar1 = ctime(&local_30);
            fprintf(pFVar2, "#  preset/initialization file\n#  %s#\n", pcVar1);
            iVar8 = param_1[0x1a];
            puVar7 = (ushort *)param_1[0x11];
            do {
                uVar6 = *(uint *)(puVar7 + 8);
                if ((((uVar6 & 0xf) != 0) && ((uVar6 & 0x280100) == 0)) &&
                    ((puVar7[4] == 0x8000 || (*puVar7 == puVar7[4])))) {
                    puVar12 = puVar7;
                    if ((uVar6 & 0x10) != 0) {
                        puVar12 =
                            (ushort *)(param_1[0x11] + (uint)puVar7[2] * 0x40);
                    }
                    switch ((uVar6 << 0x10) >> 0x1c) {
                    case 0:
                        iVar13 = *(int *)(puVar7 + 0x1a);
                        if ((*(uint *)(puVar12 + 8) & 0x20) != 0) {
                            iVar13 = *(int *)(puVar7 + 0x1c);
                        }
                        if (iVar13 == 0) {
                            iVar13 = *(int *)(puVar7 + 0x1a);
                        }
                        fprintf(pFVar2, "%s\n", iVar13);
                        break;
                    case 1:
                        if ((*(uint *)(puVar12 + 8) & 0x400) == 0)
                            goto LAB_00096a8c;
                        piVar5 = *(int **)(puVar12 + 0xe) + 2;
                        iVar13 = **(int **)(puVar12 + 0xe);
                        if (iVar13 < 2) {
                            iVar3 = iVar13 + -1;
                            if (iVar13 < 1)
                                break;
                        } else {
                            iVar3 = iVar13 + -1;
                            *(uint *)(puVar12 + 8) =
                                *(uint *)(puVar12 + 8) & 0xffffffdf;
                        }
                        do {
                            iVar3 = iVar3 + -1;
                            FUN_0008dbd0(pFVar2, puVar12, *piVar5);
                            piVar5 = piVar5 + 1;
                        } while (iVar3 != -1);
                        break;
                    case 2:
                        uVar11 = *(undefined4 *)(puVar12 + 0xc);
                        (**(code **)(puVar12 + 0x14))(3, puVar12);
                        FUN_0008dbd0(pFVar2, puVar12,
                                     *(undefined4 *)(puVar12 + 0xc));
                        *(undefined4 *)(puVar12 + 0xc) = uVar11;
                        break;
                    case 3:
                        pcVar1 = "false";
                        if (*(int *)(puVar12 + 0xc) != 0) {
                            pcVar1 = "true";
                        }
                        FUN_0008dbd0(pFVar2, puVar12, pcVar1);
                        break;
                    case 4:
                        pcVar1 = (char *)FUN_00094b1c(puVar12);
                        sVar4 = strlen(pcVar1);
                        __ptr = (undefined1 *)FUN_0008fbe0(sVar4 + 3);
                        *__ptr = 0x3d;
                        memcpy(__ptr + 1, pcVar1, sVar4 + 1);
                        FUN_0008dbd0(pFVar2, puVar12, __ptr);
                        free(__ptr);
                        free(pcVar1);
                        break;
                    case 5:
                    LAB_00096a8c:
                        FUN_0008dbd0(pFVar2, puVar12,
                                     *(undefined4 *)(puVar12 + 0xc));
                        break;
                    case 6:
                        piVar5 = *(int **)(puVar12 + 0xe);
                        if (piVar5 != (int *)0x0) {
                            piVar14 = piVar5 + 2;
                            iVar13 = *piVar5;
                            if (0 < iVar13) {
                                do {
                                    iVar9 = *piVar14;
                                    iVar3 = FUN_00093074(iVar9, 0);
                                    if (iVar3 != 0) {
                                        fprintf(
                                            pFVar2, "<%s type=nested>\n",
                                            *(undefined4 *)(puVar12 + 0x1a));
                                        do {
                                            FUN_0008e400(pFVar2, 1, puVar12,
                                                         iVar3);
                                            iVar3 = FUN_00093260(iVar9, iVar3);
                                        } while (iVar3 != 0);
                                        fprintf(
                                            pFVar2, "</%s>\n",
                                            *(undefined4 *)(puVar12 + 0x1a));
                                    }
                                    iVar13 = iVar13 + -1;
                                    piVar14 = piVar14 + 1;
                                } while (iVar13 != 0);
                            }
                        }
                        break;
                    case 7:
                        if ((*(int *)(puVar12 + 0xe) != 0) ||
                            ((0x1ffff < *param_1 &&
                              (*(int *)(param_1[0x1d] + (uint)*puVar12 * 4) !=
                               *(int *)(puVar12 + 0xc))))) {
                            FUN_0008dbd0(pFVar2, puVar12);
                        }
                    }
                }
                iVar8 = iVar8 + -1;
                puVar7 = puVar7 + 0x20;
            } while (0 < iVar8);
            fclose(pFVar2);
        }
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00096ff8) */

void FUN_00096f54(byte *param_1, byte *param_2, int param_3)

{
    byte *pbVar1;
    byte *pbVar2;
    uint uVar3;

    if (0 < param_3) {
        pbVar1 = param_2;
        do {
            uVar3 = (uint)*param_1;
            pbVar2 = pbVar1 + 1;
            if ((uVar3 != *pbVar1) &&
                ((&DAT_000c916c)[uVar3] != (&DAT_000c916c)[*pbVar1])) {
                return;
            }
            if (uVar3 == 0) {
                return;
            }
            param_1 = param_1 + 1;
            pbVar1 = pbVar2;
        } while (pbVar2 != param_2 + param_3);
    }
    return;
}

void FUN_00097008(int param_1, char *param_2, int *param_3)

{
    ushort uVar1;
    bool bVar2;
    int iVar3;
    undefined4 uVar4;
    char *pcVar5;
    int iVar6;
    undefined *puVar7;
    size_t sVar8;
    int iVar9;
    int iVar10;
    char *pcVar11;
    int iVar12;
    int iVar13;
    char local_ac[128];
    int local_2c;

    local_2c = __stack_chk_guard;
    pcVar5 = param_2;
    do {
        sVar8 = (int)pcVar5 - (int)param_2;
        pcVar11 = pcVar5 + 1;
        if (*pcVar5 == '\0') {
            pcVar11 = (char *)0x0;
        LAB_00097084:
            if (1 < (int)sVar8) {
                iVar10 = 0;
                bVar2 = false;
                iVar6 = *(int *)(param_1 + 0x44);
                iVar13 = 0;
                iVar9 = *(int *)(param_1 + 100);
                iVar12 = 0;
                goto LAB_000970d0;
            }
            break;
        }
        if (*pcVar5 == '=') {
            memcpy(local_ac, param_2, sVar8);
            local_ac[sVar8] = '\0';
            param_2 = local_ac;
            goto LAB_00097084;
        }
        pcVar5 = pcVar11;
    } while (pcVar11 != param_2 + 0x80);
    if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
        uVar4 = *(undefined4 *)(param_1 + 0x1c);
        pcVar5 = (char *)option_xlateable_txt._140_4_;
    LAB_000973bc:
        fprintf(stderr, pcVar5, uVar4, param_2);
        (**(code **)(param_1 + 0x54))(param_1, 1);
        /* WARNING: Subroutine does not return */
        _exit(1);
    }
    goto LAB_00097274;
LAB_000970d0:
    do {
        if ((*(int *)(iVar6 + 0x34) != 0) &&
            (*(undefined **)(iVar6 + 0x10) == &UNK_00080100 ||
             ((uint) * (undefined **)(iVar6 + 0x10) & 0x280000) == 0)) {
            iVar3 = FUN_00096f54(param_2, *(int *)(iVar6 + 0x34), sVar8);
            if (iVar3 == 0) {
                if (*(char *)(*(int *)(iVar6 + 0x34) + sVar8) == '\0')
                    goto LAB_000972e4;
            } else {
                if ((*(int *)(iVar6 + 0x38) == 0) ||
                    (iVar3 =
                         FUN_00096f54(param_2, *(int *)(iVar6 + 0x38), sVar8),
                     iVar3 != 0))
                    goto joined_r0x00097138;
                if (*(char *)(*(int *)(iVar6 + 0x38) + sVar8) == '\0') {
                    bVar2 = true;
                    goto LAB_000972e4;
                }
                bVar2 = true;
            }
            iVar10 = iVar10 + 1;
            iVar13 = iVar12;
        }
    joined_r0x00097138:
        iVar6 = iVar6 + 0x40;
        iVar12 = iVar12 + 1;
    } while (iVar12 < iVar9);
    if (iVar10 == 0) {
        if (((pcVar11 == (char *)0x0) &&
             ((*(uint *)(param_1 + 0xc) & 3) == 0)) &&
            (uVar1 = *(ushort *)(param_1 + 0x62), uVar1 != 0x8000)) {
            iVar12 = *(int *)(param_1 + 0x44);
            param_3[1] = (int)param_2;
            param_3[3] = 3;
            *param_3 = iVar12 + (uint)uVar1 * 0x40;
            uVar4 = 0;
            goto LAB_00097278;
        }
        if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
            uVar4 = *(undefined4 *)(param_1 + 0x18);
            pcVar5 = (char *)option_xlateable_txt._124_4_;
            goto LAB_000973bc;
        }
    } else {
        iVar12 = iVar13;
        if (iVar10 == 1) {
        LAB_000972e4:
            iVar12 = *(int *)(param_1 + 0x44) + iVar12 * 0x40;
            if ((*(uint *)(iVar12 + 0x10) & 0x280000) == 0) {
                uVar4 = 0;
                if (bVar2) {
                    param_3[2] = param_3[2] | 0x20;
                }
                *param_3 = iVar12;
                param_3[1] = (int)pcVar11;
                param_3[3] = 2;
                goto LAB_00097278;
            }
            if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
                fprintf(stderr, (char *)option_xlateable_txt._112_4_,
                        *(undefined4 *)(param_1 + 0x1c),
                        *(undefined4 *)(iVar12 + 0x34));
                if (*(int *)(iVar12 + 0x2c) != 0) {
                    fprintf(stderr, " -- %s");
                }
                fputc(10, stderr);
                goto LAB_00097368;
            }
        } else if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
            fprintf(stderr, (char *)option_xlateable_txt._84_4_,
                    *(undefined4 *)(param_1 + 0x18), param_2, iVar10);
            if (iVar10 < 5) {
                sVar8 = strlen(param_2);
                if ((*(uint *)(param_1 + 0xc) & 3) == 0) {
                    puVar7 = &DAT_000a9528;
                } else {
                    puVar7 = &DAT_000b1561;
                }
                iVar10 = 0;
                iVar12 = *(int *)(param_1 + 0x44);
                fputs((char *)option_xlateable_txt._80_4_, stderr);
                do {
                    if (*(int *)(iVar12 + 0x34) != 0) {
                        iVar6 = FUN_00096f54(param_2, *(int *)(iVar12 + 0x34),
                                             sVar8);
                        if (iVar6 == 0) {
                            fprintf(stderr, "  %s%s\n", puVar7,
                                    *(undefined4 *)(iVar12 + 0x34));
                        } else if ((*(int *)(iVar12 + 0x38) != 0) &&
                                   (iVar6 = FUN_00096f54(
                                        param_2, *(int *)(iVar12 + 0x38),
                                        sVar8),
                                    iVar6 == 0)) {
                            fprintf(stderr, "  %s%s\n", puVar7,
                                    *(undefined4 *)(iVar12 + 0x38));
                        }
                    }
                    iVar10 = iVar10 + 1;
                    iVar12 = iVar12 + 0x40;
                } while (iVar10 < *(int *)(param_1 + 100));
            }
        LAB_00097368:
            (**(code **)(param_1 + 0x54))(param_1, 1);
            /* WARNING: Subroutine does not return */
            _exit(1);
        }
    }
LAB_00097274:
    uVar4 = 0xffffffff;
LAB_00097278:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar4);
    }
    return;
}

void FUN_000974d4(int param_1, int param_2)

{
    undefined2 uVar1;
    uint uVar2;
    uint uVar3;
    char cVar4;
    char *pcVar5;
    uint uVar6;
    char *pcVar7;
    bool bVar8;

    uVar3 = __stack_chk_guard;
    if ((*(char **)(param_1 + 0x14) != (char *)0x0) &&
        (cVar4 = **(char **)(param_1 + 0x14), cVar4 != '\0')) {
    LAB_00097618:
        FUN_0008f2c8(param_1, cVar4, param_2, param_2 + 0xc);
        return;
    }
    uVar6 = *(uint *)(param_1 + 0x10);
    if (uVar6 < *(uint *)(param_1 + 4)) {
        uVar2 = *(uint *)(param_1 + 0xc);
        pcVar5 = *(char **)(*(int *)(param_1 + 8) + uVar6 * 4);
        *(char **)(param_1 + 0x14) = pcVar5;
        if ((uVar2 & 3) != 0) {
            *(char **)(param_1 + 0x14) = pcVar5 + 1;
            if ((*pcVar5 == '-') && (pcVar5[1] != '\0')) {
                *(uint *)(param_1 + 0x10) = uVar6 + 1;
                cVar4 = pcVar5[1];
                if (cVar4 != '-') {
                    pcVar7 = pcVar5 + 1;
                    if ((uVar2 & 2) != 0) {
                        if (uVar3 == __stack_chk_guard)
                            goto LAB_00097618;
                        goto LAB_00097604;
                    }
                    goto joined_r0x000975fc;
                }
                pcVar7 = pcVar5 + 2;
                *(char **)(param_1 + 0x14) = pcVar7;
                if (pcVar5[2] != '\0') {
                    if ((uVar2 & 1) != 0) {
                        if (uVar3 != __stack_chk_guard)
                            goto LAB_00097604;
                        goto LAB_000975b8;
                    }
                    fprintf(stderr, (char *)option_xlateable_txt._124_4_,
                            *(undefined4 *)(param_1 + 0x18), pcVar5);
                    uVar6 = 0xffffffff;
                    goto LAB_00097590;
                }
            }
            goto LAB_0009758c;
        }
        *(uint *)(param_1 + 0x10) = uVar6 + 1;
        uVar2 = uVar3;
        pcVar7 = pcVar5;
        if (*pcVar5 != '-') {
        joined_r0x000975fc:
            bVar8 = uVar3 == __stack_chk_guard;
            uVar3 = uVar2;
            if (bVar8) {
            LAB_000975b8:
                FUN_00097008(param_1, pcVar7);
                return;
            }
            goto LAB_00097604;
        }
        do {
            pcVar5 = pcVar5 + 1;
        } while (*pcVar5 == '-');
        uVar1 = *(undefined2 *)(param_1 + 0x62);
        *(undefined2 *)(param_1 + 0x62) = 0x8000;
        uVar6 = FUN_00097008(param_1);
        *(undefined2 *)(param_1 + 0x62) = uVar1;
    } else {
    LAB_0009758c:
        uVar6 = 1;
    }
LAB_00097590:
    bVar8 = uVar3 == __stack_chk_guard;
    uVar3 = uVar6;
    if (bVar8) {
        return;
    }
LAB_00097604:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_000976b4(int param_1)

{
    int iVar1;
    int iVar2;
    uint uVar3;
    undefined4 local_34;
    undefined4 local_30;
    uint local_2c;
    undefined4 local_28;
    int local_24;

    local_24 = __stack_chk_guard;
    *(undefined4 *)(param_1 + 0x14) = 0;
    *(uint *)(param_1 + 0xc) = *(uint *)(param_1 + 0xc) | 0x8000;
    *(undefined4 *)(param_1 + 0x10) = 1;
    do {
        local_34 = 0;
        local_30 = 0;
        local_2c = 2;
        local_28 = 0;
        iVar1 = FUN_000974d4(param_1, &local_34);
        if (iVar1 == 0) {
            iVar1 = FUN_00090694(param_1, &local_34);
        }
        if (iVar1 == -1)
            break;
        if (iVar1 == 1) {
            uVar3 = *(uint *)(param_1 + 0xc);
            iVar1 = 0;
            goto LAB_0009779c;
        }
    } while ((((local_2c & 0x20020) != 0x20000) &&
              ((local_2c & 0x40020) != 0x40020)) ||
             (iVar2 = FUN_0008f0f4(param_1, &local_34), iVar2 == 0));
    uVar3 = *(uint *)(param_1 + 0xc);
    if ((uVar3 & 4) != 0) {
        (**(code **)(param_1 + 0x54))(param_1, 1);
        uVar3 = *(uint *)(param_1 + 0xc);
    }
LAB_0009779c:
    iVar2 = __stack_chk_guard;
    *(uint *)(param_1 + 0xc) = uVar3 & 0xffff7fff;
    if (local_24 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar1);
}

void FUN_000977f0(int param_1)

{
    int iVar1;
    undefined4 uVar2;
    int local_2c[5];

    local_2c[4] = __stack_chk_guard;
LAB_0009782c:
    do {
        local_2c[0] = 0;
        local_2c[1] = 0;
        local_2c[2] = 4;
        local_2c[3] = 0;
        iVar1 = FUN_000974d4(param_1, local_2c);
        if (iVar1 == 0) {
            iVar1 = FUN_00090694(param_1, local_2c);
        }
        if (iVar1 == -1)
            goto LAB_000978e4;
        if (iVar1 == 1) {
            uVar2 = 0;
            goto LAB_000978f4;
        }
        if (((local_2c[2] & 0x20020U) != 0) &&
            ((local_2c[2] & 0x40020U) != 0x20)) {
            if (((local_2c[2] & 0x400020U) != 0x400000) &&
                ((local_2c[2] & 0x800020U) != 0x800020))
                goto LAB_0009782c;
            *(short *)(local_2c[0] + 0xe) = *(short *)(local_2c[0] + 0xe) + -1;
        }
        iVar1 = FUN_0008f0f4(param_1, local_2c);
        if (iVar1 != 0) {
        LAB_000978e4:
            if ((*(uint *)(param_1 + 0xc) & 4) == 0) {
                uVar2 = 0xffffffff;
            } else {
                (**(code **)(param_1 + 0x54))(param_1, 1);
                uVar2 = 0xffffffff;
            }
        LAB_000978f4:
            if (local_2c[4] != __stack_chk_guard) {
                /* WARNING: Subroutine does not return */
                __stack_chk_fail(uVar2);
            }
            return;
        }
    } while (true);
}

void FUN_00097938(undefined4 param_1, int *param_2, byte *param_3, int param_4,
                  int param_5)

{
    char cVar1;
    undefined4 uVar2;
    int iVar3;
    byte *pbVar4;
    int iVar5;
    size_t sVar6;
    uint uVar7;
    byte *pbVar8;
    uint uVar9;

    iVar3 = __stack_chk_guard;
    iVar5 = DAT_001183dc;
    if (DAT_001183dc == 0) {
        iVar5 = FUN_0008f738(0x2d);
    }
    cVar1 = *(char *)(iVar5 + (uint)*param_3);
    while (cVar1 != '\0') {
        param_3 = param_3 + 1;
        cVar1 = *(char *)(iVar5 + (uint)*param_3);
    }
    pbVar4 = (byte *)strpbrk((char *)param_3, " \t\n:=");
    if (pbVar4 == (byte *)0x0) {
        sVar6 = strlen((char *)param_3);
        pbVar8 = param_3 + sVar6;
    } else if (param_5 == 2) {
        pbVar8 = pbVar4 + 1;
        *pbVar4 = 0;
    } else {
        if (*pbVar4 < 0x80) {
            uVar9 = *(uint *)(&DAT_000b0784 + (uint)*pbVar4 * 4) & 0xc01;
            if (uVar9 != 0) {
                uVar9 = 1;
            }
        } else {
            uVar9 = 0;
        }
        pbVar8 = pbVar4 + 1;
        *pbVar4 = 0;
        iVar5 = DAT_00118358;
        if (DAT_00118358 == 0) {
            iVar5 = FUN_0008f738(0xc);
        }
        uVar7 = (uint)pbVar4[1];
        cVar1 = *(char *)(iVar5 + uVar7);
        while (cVar1 != '\0') {
            pbVar8 = pbVar8 + 1;
            uVar7 = (uint)*pbVar8;
            cVar1 = *(char *)(iVar5 + uVar7);
        }
        if ((uVar9 != 0) && (uVar7 == 0x3a || uVar7 == 0x3d)) {
            iVar5 = DAT_00118358;
            if (DAT_00118358 == 0) {
                iVar5 = FUN_0008f738(0xc);
            }
            cVar1 = *(char *)(iVar5 + (uint)pbVar8[1]);
            pbVar8 = pbVar8 + 1;
            while (cVar1 != '\0') {
                pbVar8 = pbVar8 + 1;
                cVar1 = *(char *)(iVar5 + (uint)*pbVar8);
            }
        }
    }
    if ((param_3[1] < 0x80) &&
        ((*(uint *)(&DAT_000b0784 + (uint)param_3[1] * 4) & 0x3b0040) != 0)) {
        iVar5 = FUN_00097008(param_1, param_3, param_2);
        if (iVar5 != 0)
            goto LAB_00097ac4;
        if (param_4 != 0)
            goto LAB_00097a78;
    LAB_00097b70:
        if ((*pbVar8 == 0x22) || (*pbVar8 == 0x27)) {
            FUN_00093700(pbVar8, 0);
        }
        param_2[1] = (int)pbVar8;
    } else {
        iVar5 = FUN_0008f2c8(param_1, *param_3, param_2, param_2 + 3);
        if (iVar5 != 0)
            goto LAB_00097ac4;
        if (param_4 == 0)
            goto LAB_00097b70;
    LAB_00097a78:
        uVar9 = param_2[2];
        if ((uVar9 & 0x100) != 0)
            goto LAB_00097ac4;
        if ((*pbVar8 == 0x22) || (*pbVar8 == 0x27)) {
            FUN_00093700(pbVar8, 0);
            param_2[1] = (int)pbVar8;
            uVar9 = param_2[2];
        } else {
            param_2[1] = (int)pbVar8;
        }
        uVar7 = uVar9 & 0x60000;
        if (uVar7 == 0x20000) {
            if (param_4 < 0) {
            LAB_00097c8c:
                if ((uVar9 & 0x20) == 0)
                    goto LAB_00097ac4;
            } else {
            LAB_00097c78:
                if ((uVar9 & 0x20) != 0)
                    goto LAB_00097ac4;
            }
        } else if (uVar7 < 0x20001) {
            if ((uVar7 == 0) && (param_4 < 0))
                goto LAB_00097ac4;
        } else {
            if (uVar7 == 0x40000) {
                if (param_4 < 0)
                    goto LAB_00097c78;
                goto LAB_00097c8c;
            }
            if ((uVar7 == 0x60000) && (0 < param_4))
                goto LAB_00097ac4;
        }
    }
    if ((*(uint *)(*param_2 + 0x10) & 0xf000) == 0) {
        if (*pbVar8 != 0)
            goto LAB_00097ac4;
    LAB_00097ba4:
        param_2[1] = 0;
    } else if ((*(uint *)(*param_2 + 0x10) & 0x10000) == 0) {
        if (*pbVar8 != 0)
            goto LAB_00097c10;
        param_2[1] = (int)&DAT_000b09d8;
    } else {
        if (*pbVar8 == 0)
            goto LAB_00097ba4;
    LAB_00097c10:
        iVar5 = FUN_0008fa64(pbVar8);
        param_2[1] = iVar5;
        param_2[2] = param_2[2] | 0x40;
    }
    uVar2 = DAT_000c9168;
    DAT_000c9168 = param_5;
    FUN_0008f0f4(param_1, param_2);
    DAT_000c9168 = uVar2;
LAB_00097ac4:
    if (iVar3 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000981c8(int param_1, char *param_2)

{
    char cVar1;
    byte bVar2;
    int iVar3;
    char *__needle;
    size_t sVar4;
    int iVar5;
    byte *pbVar6;
    byte *pbVar7;

    iVar3 = __stack_chk_guard;
    __needle = (char *)FUN_0008fbe0(10);
    sVar4 = strlen(*(char **)(param_1 + 0x1c));
    builtin_strncpy(__needle, "<?program", 10);
    do {
        pbVar7 = (byte *)(param_2 + 1);
        iVar5 = DAT_00118358;
        if (DAT_00118358 == 0) {
            iVar5 = FUN_0008f738(0xc);
        }
        cVar1 = *(char *)(iVar5 + (uint)(byte)param_2[1]);
        while (cVar1 != '\0') {
            pbVar7 = pbVar7 + 1;
            cVar1 = *(char *)(iVar5 + (uint)*pbVar7);
        }
        iVar5 = FUN_00096f54(pbVar7, *(undefined4 *)(param_1 + 0x1c), sVar4);
        if (iVar5 == 0) {
            if ((pbVar7[sVar4] < 0x80) &&
                ((*(uint *)(&DAT_000b0784 + (uint)pbVar7[sVar4] * 4) &
                  0x1000c01) != 0)) {
                free(__needle);
                pbVar7 = pbVar7 + sVar4;
                goto LAB_0009831c;
            }
        }
        param_2 = strstr((char *)pbVar7, __needle);
    } while (param_2 != (char *)0x0);
    free(__needle);
    pbVar6 = (byte *)0x0;
    goto LAB_000982d8;
    while (pbVar7 = pbVar6, bVar2 != 0x3e) {
    LAB_0009831c:
        pbVar6 = pbVar7 + 1;
        bVar2 = *pbVar7;
        if (bVar2 == 0) {
            pbVar6 = (byte *)0x0;
            break;
        }
    }
LAB_000982d8:
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(pbVar6);
    }
    return;
}

void FUN_00098348(uint *param_1, byte *param_2)

{
    char cVar1;
    int iVar2;
    int iVar3;
    undefined4 *puVar4;
    uint uVar5;
    uint uVar6;
    int *piVar7;
    uint uVar8;

    iVar2 = __stack_chk_guard;
    if ((param_2 != (byte *)0x0) ||
        (param_2 = (byte *)getenv("AUTOOPTS_USAGE"), param_2 != (byte *)0x0)) {
        iVar3 = DAT_00118358;
        if (DAT_00118358 == 0) {
            iVar3 = FUN_0008f738(0xc);
        }
        uVar5 = (uint)*param_2;
        cVar1 = *(char *)(iVar3 + uVar5);
        while (cVar1 != '\0') {
            param_2 = param_2 + 1;
            uVar5 = (uint)*param_2;
            cVar1 = *(char *)(iVar3 + uVar5);
        }
        if (uVar5 != 0) {
            uVar5 = 0;
            while (true) {
                piVar7 = &DAT_000c62e8;
                uVar8 = 0;
                while (iVar3 = FUN_00096f54(param_2, piVar7[2], *piVar7),
                       iVar3 != 0) {
                    uVar8 = uVar8 + 1;
                    piVar7 = piVar7 + 3;
                    if (uVar8 == 5)
                        goto LAB_0009840c;
                }
                param_2 = param_2 + *piVar7;
                uVar6 = (uint)*param_2;
                if ((0x7f < uVar6) ||
                    ((*(uint *)(&DAT_000b0784 + uVar6 * 4) & 0xc13) == 0))
                    goto LAB_0009840c;
                uVar5 = uVar5 | 1 << (uVar8 & 0xff);
                iVar3 = DAT_00118358;
                if (DAT_00118358 == 0) {
                    iVar3 = FUN_0008f738(0xc);
                    uVar6 = (uint)*param_2;
                }
                cVar1 = *(char *)(iVar3 + uVar6);
                while (cVar1 != '\0') {
                    param_2 = param_2 + 1;
                    uVar6 = (uint)*param_2;
                    cVar1 = *(char *)(iVar3 + uVar6);
                }
                if (uVar6 == 0)
                    break;
                if (uVar6 == 0x2c) {
                    iVar3 = DAT_00118358;
                    if (DAT_00118358 == 0) {
                        iVar3 = FUN_0008f738(0xc);
                    }
                    cVar1 = *(char *)(iVar3 + (uint)param_2[1]);
                    param_2 = param_2 + 1;
                    while (cVar1 != '\0') {
                        param_2 = param_2 + 1;
                        cVar1 = *(char *)(iVar3 + (uint)*param_2);
                    }
                }
            }
            if (((uVar5 & 3) != 3) && ((uVar5 & 0xc) != 0xc)) {
                puVar4 = &DAT_000c62e8;
                while (true) {
                    if ((uVar5 & 1) != 0) {
                        uVar8 = puVar4[1];
                        if ((uVar8 & 1) == 0) {
                            uVar8 = *param_1 | uVar8;
                        } else {
                            uVar8 = uVar8 & *param_1;
                        }
                        *param_1 = uVar8;
                    }
                    uVar5 = uVar5 >> 1;
                    if (uVar5 == 0)
                        break;
                    puVar4 = puVar4 + 3;
                }
            }
        }
    }
LAB_0009840c:
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x000986f8) */

void FUN_0009867c(byte *param_1, byte *param_2)

{
    uint uVar1;

    while (true) {
        uVar1 = (uint)*param_1;
        if ((uVar1 != *param_2) &&
            ((&DAT_000c916c)[uVar1] != (&DAT_000c916c)[*param_2]))
            break;
        param_1 = param_1 + 1;
        param_2 = param_2 + 1;
        if (uVar1 == 0) {
            return;
        }
    }
    return;
}

void FUN_00098708(int *param_1, char *param_2, undefined4 param_3, int param_4)

{
    int iVar1;
    char *pcVar2;
    int iVar3;
    int iVar4;
    uint uVar5;

    iVar1 = __stack_chk_guard;
    pcVar2 = getenv(param_2);
    param_1[1] = (int)pcVar2;
    if (pcVar2 == (char *)0x0)
        goto LAB_000987e8;
    iVar4 = *(int *)(*param_1 + 0x3c);
    uVar5 = *(uint *)(*param_1 + 0x10);
    param_1[3] = 0;
    param_1[2] = uVar5 | 0x42;
    if ((iVar4 == 0) ||
        (iVar3 = FUN_0009867c(), iVar4 = __stack_chk_guard, iVar3 != 0)) {
        if (param_4 == 1) {
            if (((param_1[2] & 0x20020U) == 0x20000) ||
                ((param_1[2] & 0x40020U) == 0x40020))
                goto LAB_00098834;
        } else if (((param_4 != 2) ||
                    (((uVar5 = param_1[2],
                       (uVar5 & 0x20020) == 0 || ((uVar5 & 0x40020) == 0x20)) ||
                      ((uVar5 & 0x400020) == 0x400000)))) ||
                   ((uVar5 & 0x800020) == 0x800020)) {
        LAB_00098834:
            if ((*(uint *)(*param_1 + 0x10) & 0xf000) != 0) {
                if (*(char *)param_1[1] != '\0') {
                    iVar4 = FUN_0008fa64();
                    param_1[1] = iVar4;
                    param_1[2] = param_1[2] | 0x40;
                    iVar4 = __stack_chk_guard;
                    goto joined_r0x000988a8;
                }
                if ((*(uint *)(*param_1 + 0x10) & 0x10000) == 0)
                    goto LAB_000987e8;
            }
            param_1[1] = 0;
            iVar4 = __stack_chk_guard;
            goto joined_r0x000988a8;
        }
    LAB_000987e8:
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else {
        param_1[1] = 0;
        param_1[2] = param_1[2] | 0x20;
    joined_r0x000988a8:
        if (iVar1 == iVar4) {
            FUN_0008f0f4(param_3, param_1);
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0009897c(byte *param_1)

{
    byte bVar1;
    byte bVar2;
    int iVar3;

    iVar3 = __stack_chk_guard;
    if (param_1 != (byte *)0x0) {
        bVar1 = *param_1;
        bVar2 = bVar1;
        while (bVar2 != 0) {
            (&DAT_000c916c)[bVar2] = bVar1;
            param_1 = param_1 + 1;
            bVar2 = *param_1;
        }
    }
    if (iVar3 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000989f8(uint *param_1, char *param_2)

{
    int iVar1;
    undefined4 uVar2;
    char *pcVar3;
    uint uVar4;

    iVar1 = __stack_chk_guard;
    if (param_1 == (uint *)0x0) {
        fputs((char *)option_xlateable_txt._24_4_, stderr);
        uVar2 = 0xffffffff;
    } else {
        uVar4 = param_1[3];
        DAT_001182e8 = (byte)((uVar4 << 10) >> 0x1f);
        if ((((uVar4 & 0x2000) != 0) &&
             ((code *)param_1[0x16] != (code *)0x0)) &&
            (option_xlateable_txt._0_4_ != 0)) {
            if ((uVar4 & 0x30000) == 0x20000) {
                param_1[3] = uVar4 | 0x10000;
            }
            (*(code *)param_1[0x16])();
        }
        uVar4 = *param_1;
        if (uVar4 - 0x19000 < 0x10002) {
            if (param_1[7] == 0) {
                pcVar3 = strrchr(param_2, 0x2f);
                if (pcVar3 == (char *)0x0) {
                    param_1[7] = (uint)param_2;
                } else {
                    param_1[7] = (uint)(pcVar3 + 1);
                }
                pcVar3 = getenv("PATH");
                pcVar3 = (char *)FUN_00090e8c(pcVar3, param_2);
                if (pcVar3 == (char *)0x0) {
                    pcVar3 = param_2;
                }
                param_1[6] = (uint)pcVar3;
                FUN_0009897c(&ao_strs_strtable);
                uVar2 = 0;
            } else {
                uVar2 = 0;
            }
        } else {
            fprintf(stderr, (char *)option_xlateable_txt._32_4_, param_2,
                    (int)uVar4 >> 0xc, (uVar4 << 0x14) >> 0x1b, uVar4 & 0x7f);
            pcVar3 = (char *)option_xlateable_txt._28_4_;
            if ((int)*param_1 < 0x29002) {
                pcVar3 = (char *)option_xlateable_txt._40_4_;
            }
            fputs(pcVar3, stderr);
            fwrite("41:0:16\n", 8, 1, stderr);
            uVar2 = 0xffffffff;
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar2);
}

void FUN_00098c38(char *param_1, uint param_2, uint param_3,
                  undefined4 *param_4)

{
    int iVar1;
    int *piVar2;
    long lVar3;
    void *pvVar4;
    uint uVar5;
    size_t __len;
    undefined4 uVar6;
    stat64 sStack_88;
    int local_1c;

    local_1c = __stack_chk_guard;
    memset(param_4, 0, 0x20);
    uVar5 = param_2 & 2;
    param_4[6] = param_2;
    param_4[7] = param_3;
    param_4[3] = 0xffffffff;
    if (uVar5 != 0) {
        if ((param_3 & 3) == 1) {
            uVar5 = 2;
        } else {
            uVar5 = 0;
        }
        if ((param_3 & 1) == 0) {
            uVar5 = uVar5 | 0x80;
        }
    }
    iVar1 = open64(param_1, uVar5);
    param_4[3] = iVar1;
    if (iVar1 < 0) {
        piVar2 = __errno_location();
        iVar1 = *piVar2;
        param_4[3] = 0xffffffff;
        param_4[5] = iVar1;
    } else {
        iVar1 = __fxstat64(3, iVar1, &sStack_88);
        if (iVar1 == 0) {
            if ((sStack_88.st_mode & 0xf000) == 0x8000) {
                param_4[1] = (undefined4)sStack_88.st_size;
                if (param_4[3] == -1) {
                    piVar2 = __errno_location();
                    iVar1 = *piVar2;
                    param_4[5] = iVar1;
                    goto LAB_00098d04;
                }
            } else {
                piVar2 = __errno_location();
                *piVar2 = 0x16;
                param_4[5] = 0x16;
                close(param_4[3]);
            }
        } else {
            piVar2 = __errno_location();
            param_4[5] = *piVar2;
            close(param_4[3]);
        }
        iVar1 = param_4[5];
    }
LAB_00098d04:
    if (iVar1 != 0) {
        uVar6 = 0xffffffff;
        goto LAB_00098d10;
    }
    lVar3 = sysconf(0x1e);
    __len = param_4[1];
    uVar5 = lVar3 + __len;
    param_4[2] = -lVar3 & uVar5;
    if (uVar5 == (-lVar3 & uVar5)) {
        pvVar4 = mmap64((void *)0x0, uVar5, 3, 0x22, -1, 0);
        if (pvVar4 != (void *)0xffffffff) {
            __len = param_4[1];
            uVar5 = param_4[7] | 0x10;
            param_4[7] = uVar5;
            goto LAB_00098d58;
        }
    LAB_00098e54:
        piVar2 = __errno_location();
        iVar1 = *piVar2;
        param_4[5] = iVar1;
    } else {
        uVar5 = param_4[7];
        pvVar4 = (void *)0x0;
    LAB_00098d58:
        pvVar4 = mmap64(pvVar4, __len, param_4[6], uVar5, param_4[3], 0);
        *param_4 = pvVar4;
        if (pvVar4 == (void *)0xffffffff)
            goto LAB_00098e54;
        iVar1 = param_4[5];
    }
    if (iVar1 == 0) {
        uVar6 = *param_4;
    } else {
        if (param_4[3] != -1) {
            close(param_4[3]);
            iVar1 = param_4[5];
            param_4[3] = 0xffffffff;
        }
        piVar2 = __errno_location();
        uVar6 = 0xffffffff;
        *piVar2 = iVar1;
        *param_4 = 0xffffffff;
    }
LAB_00098d10:
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar6);
    }
    return;
}

void FUN_00098e70(undefined4 *param_1)

{
    int iVar1;
    int *piVar2;
    void *__addr;
    int iVar3;

    iVar1 = __stack_chk_guard;
    piVar2 = __errno_location();
    __addr = (void *)*param_1;
    *piVar2 = 0;
    munmap(__addr, param_1[2]);
    iVar3 = *piVar2;
    param_1[5] = iVar3;
    if (param_1[3] != -1) {
        close(param_1[3]);
        iVar3 = param_1[5];
        param_1[3] = 0xffffffff;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar3);
}

void FUN_00098efc(int param_1, undefined4 param_2, int param_3)

{
    char cVar1;
    ushort uVar2;
    byte *pbVar3;
    byte bVar4;
    byte *pbVar5;
    byte *pbVar6;
    int iVar7;
    byte *pbVar8;
    size_t sVar9;
    int iVar11;
    uint uVar12;
    byte *pbVar13;
    char *pcVar14;
    byte *__haystack;
    byte *pbVar15;
    undefined4 *puVar16;
    undefined4 uVar17;
    undefined4 uVar18;
    bool bVar19;
    int local_d0;
    int local_b0;
    byte *local_ac;
    undefined4 local_a8;
    undefined4 local_a4;
    undefined4 local_a0;
    undefined4 local_9c;
    undefined1 auStack_98[32];
    int local_78[3];
    byte local_6c;
    byte local_6b;
    undefined1 local_6a;
    int local_2c;
    ulong uVar10;

    local_a0 = 2;
    uVar18 = *(undefined4 *)(param_1 + 0xc);
    local_2c = __stack_chk_guard;
    local_a8 = 0;
    local_a4 = 0;
    local_9c = 0;
    pbVar5 = (byte *)FUN_00098c38(param_2, 3, 2, auStack_98);
    if (pbVar5 != (byte *)0xffffffff) {
        uVar12 = *(uint *)(param_1 + 0xc);
        if (param_3 == 0) {
            uVar17 = 4;
        } else {
            uVar17 = 2;
        }
        if (param_3 == 0) {
            param_3 = 1;
        }
        *(uint *)(param_1 + 0xc) = uVar12 & 0xfffffffb;
        if ((uVar12 & 0x80000) == 0) {
            uVar17 = 1;
        }
        do {
            iVar7 = DAT_00118358;
            local_a0 = uVar17;
            if (DAT_00118358 == 0) {
                iVar7 = FUN_0008f738(0xc);
            }
            pcVar14 = DAT_00118418;
            uVar12 = (uint)*pbVar5;
            cVar1 = *(char *)(iVar7 + uVar12);
            pbVar13 = pbVar5;
            while (cVar1 != '\0') {
                pbVar13 = pbVar13 + 1;
                uVar12 = (uint)*pbVar13;
                cVar1 = *(char *)(iVar7 + uVar12);
            }
            if ((uVar12 < 0x80) &&
                ((*(uint *)(&DAT_000b0784 + uVar12 * 4) & 0x180040) != 0)) {
                pbVar5 = pbVar13 + 1;
                pbVar6 = (byte *)strchr((char *)pbVar5, 10);
                if (pbVar6 == (byte *)0x0) {
                    sVar9 = strlen((char *)pbVar5);
                    pbVar5 = pbVar5 + sVar9;
                } else {
                    iVar7 = DAT_00118398;
                    if (DAT_00118398 == 0) {
                        iVar7 = FUN_0008f738(0x1c);
                    }
                    cVar1 = *(char *)(iVar7 + (uint)pbVar13[1]);
                    while (cVar1 != '\0') {
                        pbVar5 = pbVar5 + 1;
                        cVar1 = *(char *)(iVar7 + (uint)*pbVar5);
                    }
                    iVar7 = DAT_00118358;
                    if (DAT_00118358 == 0) {
                        iVar7 = FUN_0008f738(0xc);
                    }
                    uVar12 = (uint)*pbVar5;
                    cVar1 = *(char *)(iVar7 + uVar12);
                    while (cVar1 != '\0') {
                        pbVar5 = pbVar5 + 1;
                        uVar12 = (uint)*pbVar5;
                        cVar1 = *(char *)(iVar7 + uVar12);
                    }
                    if (pbVar6 < pbVar5) {
                    LAB_00099478:
                        pbVar5 = pbVar6 + 1;
                        *pbVar6 = 0;
                    } else {
                        if (uVar12 == 0x3d || uVar12 == 0x3a) {
                            pbVar15 = pbVar5 + 1;
                            iVar7 = DAT_00118358;
                            if (DAT_00118358 == 0) {
                                iVar7 = FUN_0008f738(0xc);
                            }
                            cVar1 = *(char *)(iVar7 + (uint)pbVar5[1]);
                            while ((pbVar5 = pbVar15,
                                    cVar1 != '\0' &&
                                        (pbVar5 = pbVar15 + 1,
                                         *(char *)(iVar7 + (uint)*pbVar5) !=
                                             '\0'))) {
                                pbVar15 = pbVar15 + 2;
                                cVar1 = *(char *)(iVar7 + (uint)*pbVar15);
                            }
                            if (pbVar6 < pbVar5)
                                goto LAB_00099478;
                        } else if ((0x7f < pbVar5[-1]) ||
                                   ((*(uint *)(&DAT_000b0784 +
                                               (uint)pbVar5[-1] * 4) &
                                     0xc01) == 0))
                            break;
                        if (pbVar6[-1] == 0x5c) {
                            bVar4 = *pbVar6;
                            pbVar15 = pbVar6 + -1;
                            while (pbVar5 = pbVar6 + 1, bVar4 != 10) {
                                if (bVar4 == 0x5c) {
                                    if (pbVar6[1] == 10) {
                                        pbVar5 = pbVar6 + 2;
                                        bVar4 = 10;
                                    }
                                } else if (bVar4 == 0) {
                                    pbVar5 = (byte *)0x0;
                                    break;
                                }
                                *pbVar15 = bVar4;
                                pbVar15 = pbVar15 + 1;
                                pbVar6 = pbVar5;
                                bVar4 = *pbVar5;
                            }
                            *pbVar15 = 0;
                        } else {
                            pbVar5 = pbVar6 + 1;
                            *pbVar6 = 0;
                        }
                    }
                    FUN_00097938(param_1, &local_a8, pbVar13, param_3, 1);
                }
            } else if (uVar12 == 0x3c) {
                uVar12 = (uint)pbVar13[1];
                if ((uVar12 < 0x80) &&
                    ((*(uint *)(&DAT_000b0784 + uVar12 * 4) & 0x180040) != 0)) {
                    pbVar6 = pbVar13 + 1;
                    local_b0 = DAT_000c9168;
                    iVar7 = DAT_00118398;
                    if (DAT_00118398 == 0) {
                        iVar7 = FUN_0008f738(0x1c);
                    }
                    cVar1 = *(char *)(iVar7 + (uint)pbVar13[1]);
                    pbVar13 = pbVar6;
                    while (cVar1 != '\0') {
                        pbVar13 = pbVar13 + 1;
                        cVar1 = *(char *)(iVar7 + (uint)*pbVar13);
                    }
                    local_78[0] = 1;
                    uVar12 = (uint)*pbVar13;
                    if (uVar12 == 0x20) {
                    LAB_00099644:
                        iVar7 = DAT_00118358;
                        if (DAT_00118358 == 0) {
                            iVar7 = FUN_0008f738(0xc);
                            uVar12 = (uint)*pbVar13;
                        }
                        cVar1 = *(char *)(iVar7 + uVar12);
                        pbVar5 = pbVar13;
                        while (cVar1 != '\0') {
                            pbVar5 = pbVar5 + 1;
                            cVar1 = *(char *)(iVar7 + (uint)*pbVar5);
                        }
                        pbVar15 =
                            (byte *)FUN_00092880(pbVar5, &local_b0, local_78);
                        if (pbVar15 == (byte *)0x0)
                            break;
                        if (*pbVar15 != 0x3e) {
                            if (*pbVar15 == 0x2f) {
                            LAB_000996a8:
                                if (pbVar15[1] == 0x3e) {
                                    pbVar5 = pbVar15 + 2;
                                    *pbVar15 = 0;
                                    FUN_00097938(param_1, &local_a8, pbVar6,
                                                 param_3, local_b0);
                                    goto LAB_0009913c;
                                }
                            }
                            break;
                        }
                    } else {
                        if (uVar12 < 0x21) {
                            if (uVar12 == 9)
                                goto LAB_00099644;
                        LAB_000996f8:
                            pcVar14 = strchr((char *)pbVar13, 0x3e);
                            if (pcVar14 != (char *)0x0)
                                goto LAB_00099618;
                            break;
                        }
                        pbVar15 = pbVar13;
                        if (uVar12 == 0x2f)
                            goto LAB_000996a8;
                        if (uVar12 != 0x3e)
                            goto LAB_000996f8;
                    }
                    *pbVar13 = 0;
                    __haystack = pbVar15 + 1;
                    sVar9 = strlen((char *)pbVar6);
                    iVar7 = local_b0;
                    if (sVar9 + 4 < 0x40) {
                        local_d0 = sprintf((char *)&local_6c, "</%s>", pbVar6);
                        pbVar15[1] = 0x20;
                        pbVar8 = (byte *)strstr((char *)__haystack,
                                                (char *)&local_6c);
                    } else {
                        pbVar5 = (byte *)FUN_0008fbe0();
                        local_d0 = sprintf((char *)pbVar5, "</%s>", pbVar6);
                        pbVar15[1] = 0x20;
                        pbVar8 =
                            (byte *)strstr((char *)__haystack, (char *)pbVar5);
                        if (pbVar5 != &local_6c) {
                            free(pbVar5);
                        }
                    }
                    if (pbVar8 == (byte *)0x0)
                        break;
                    pbVar5 = pbVar8 + local_d0;
                    if (iVar7 != 1) {
                        iVar7 = DAT_00118358;
                        if (DAT_00118358 == 0) {
                            iVar7 = FUN_0008f738(0xc);
                        }
                        if (pbVar8 <= __haystack) {
                            sVar9 = strlen((char *)__haystack);
                            pbVar8 = __haystack + sVar9;
                            if (pbVar8 <= __haystack)
                                goto LAB_00099344;
                        }
                        if (*(char *)(iVar7 + (uint)pbVar8[-1]) != '\0') {
                            pbVar3 = pbVar8 + -1;
                            do {
                                pbVar8 = pbVar3;
                                if (pbVar8 <= __haystack)
                                    break;
                                pbVar3 = pbVar8 + -1;
                            } while (*(char *)(iVar7 + (uint)pbVar8[-1]) !=
                                     '\0');
                        }
                    }
                LAB_00099344:
                    *pbVar8 = 0;
                    if (pbVar5 == (byte *)0x0)
                        break;
                    memset(pbVar13, 0x20, (int)__haystack - (int)pbVar13);
                    if ((local_78[0] == 1) && (local_b0 == 0)) {
                        local_6a = 0;
                        bVar4 = *__haystack;
                        pbVar13 = __haystack;
                        pbVar15 = pbVar15 + 2;
                        if (bVar4 == 0x25)
                            goto LAB_00099818;
                        while (bVar4 != 0x26) {
                            if (bVar4 == 0) {
                                *__haystack = 0;
                                goto LAB_00099374;
                            }
                            while (true) {
                                *__haystack = bVar4;
                            LAB_00099804:
                                bVar4 = *pbVar15;
                                __haystack = __haystack + 1;
                                pbVar13 = pbVar15;
                                pbVar15 = pbVar15 + 1;
                                if (bVar4 != 0x25)
                                    break;
                            LAB_00099818:
                                local_6c = pbVar13[1];
                                pbVar15 = pbVar13 + 3;
                                local_6b = pbVar13[2];
                                if (local_6b == 0 || local_6c == 0)
                                    goto LAB_0009991c;
                                uVar10 = strtoul((char *)&local_6c,
                                                 (char **)0x0, 0x10);
                                bVar4 = (byte)uVar10;
                            }
                        }
                        uVar12 = (uint)pbVar13[1];
                        if (uVar12 == 0x23) {
                            pbVar15 = pbVar13 + 2;
                            uVar12 = (uint)pbVar13[2];
                        LAB_000998a4:
                            if ((uVar12 == 0x58) || (uVar12 == 0x78)) {
                                iVar7 = 0x10;
                                local_ac = pbVar15 + 1;
                            } else {
                                local_ac = pbVar15;
                                if (uVar12 == 0x30) {
                                    if (pbVar15[1] == 0x30) {
                                        iVar7 = 0x10;
                                    } else {
                                        iVar7 = 10;
                                    }
                                } else {
                                    iVar7 = 10;
                                }
                            }
                            uVar10 = strtoul((char *)local_ac,
                                             (char **)&local_ac, iVar7);
                            bVar19 = uVar10 == 0x7f;
                            if (uVar10 < 0x80) {
                                bVar19 = *local_ac == 0x3b;
                            }
                            if (bVar19) {
                                pbVar15 = local_ac + 1;
                            LAB_000998e4:
                                *__haystack = (byte)uVar10;
                                if (uVar10 != 0)
                                    goto LAB_00099804;
                                goto LAB_00099374;
                            }
                        } else {
                            if ((uVar12 < 0x80) &&
                                ((*(uint *)(&DAT_000b0784 + uVar12 * 4) &
                                  0x30000) != 0))
                                goto LAB_000998a4;
                            iVar7 = 0;
                            puVar16 = &DAT_000c6324;
                            local_ac = pbVar15;
                            do {
                                uVar2 = *(ushort *)(puVar16 + 1);
                                iVar11 =
                                    strncmp((char *)pbVar15,
                                            (char *)(&DAT_000c6324)[iVar7 * 2],
                                            (uint)uVar2);
                                if (iVar11 == 0) {
                                    pbVar15 = pbVar15 + uVar2;
                                    uVar10 =
                                        (ulong)(short)(&DAT_000c632a)[iVar7 *
                                                                      4];
                                    goto LAB_000998e4;
                                }
                                iVar7 = iVar7 + 1;
                                puVar16 = puVar16 + 2;
                            } while (iVar7 != 0xc);
                        }
                    LAB_0009991c:
                        *__haystack = 0;
                    }
                LAB_00099374:
                    FUN_00097938(param_1, &local_a8, pbVar6, param_3, local_b0);
                } else if (uVar12 == 0x2f) {
                    pcVar14 = strchr((char *)(pbVar13 + 2), 0x3e);
                    pbVar5 = (byte *)(pcVar14 + 1);
                    if (pcVar14 == (char *)0x0)
                        break;
                } else if (uVar12 == 0x3f) {
                    if (DAT_00118418 == (char *)0x0) {
                        sVar9 = 7;
                        pcVar14 = "program";
                        DAT_0011841c = "auto-options";
                        DAT_00118418 = pcVar14;
                    } else {
                        sVar9 = strlen(DAT_00118418);
                    }
                    iVar7 = 0;
                    while (true) {
                        iVar11 = strncmp((char *)(pbVar13 + 2), pcVar14, sVar9);
                        pcVar14 = DAT_0011841c;
                        if (iVar11 == 0) {
                            if ((0x7f < pbVar13[sVar9 + 2]) ||
                                ((*(uint *)(&DAT_000b0784 +
                                            (uint)pbVar13[sVar9 + 2] * 4) &
                                  0x3b0060) == 0)) {
                                pbVar5 =
                                    (byte *)(*(code *)(&DAT_000c6384)[iVar7])(
                                        param_1, pbVar13 + sVar9 + 2);
                                goto LAB_0009913c;
                            }
                        }
                        if (iVar7 == 1)
                            break;
                        iVar7 = 1;
                        sVar9 = strlen(DAT_0011841c);
                    }
                    pcVar14 = strchr((char *)(pbVar13 + 2), 0x3e);
                    if (pcVar14 == (char *)0x0)
                        break;
                LAB_00099618:
                    pbVar5 = (byte *)(pcVar14 + 1);
                } else {
                    if ((uVar12 != 0x21) ||
                        (pcVar14 = strstr((char *)pbVar13, "-->"),
                         pcVar14 == (char *)0x0))
                        break;
                    pbVar5 = (byte *)(pcVar14 + 3);
                }
            } else {
                if (uVar12 == 0x5b) {
                    pcVar14 = *(char **)(param_1 + 0x20);
                    sVar9 = strlen(pcVar14);
                    iVar7 = strncmp((char *)(pbVar13 + 1), pcVar14, sVar9);
                    if ((iVar7 == 0) && (pbVar13[sVar9 + 1] == 0x5d)) {
                        pbVar5 =
                            (byte *)strchr((char *)(pbVar13 + sVar9 + 2), 10);
                        goto LAB_0009913c;
                    }
                    if (0x10 < sVar9)
                        break;
                    sprintf((char *)&local_6c, "[%s]", pcVar14);
                    pbVar13 =
                        (byte *)strstr((char *)pbVar13, (char *)&local_6c);
                    if (pbVar13 == (byte *)0x0)
                        break;
                } else {
                    if (uVar12 != 0x23)
                        break;
                    pbVar13 = pbVar13 + 1;
                }
                pbVar5 = (byte *)strchr((char *)pbVar13, 10);
            }
        LAB_0009913c:
        } while (pbVar5 != (byte *)0x0);
        FUN_00098e70(auStack_98);
        *(undefined4 *)(param_1 + 0xc) = uVar18;
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00099a60(int param_1)

{
    int iVar1;
    char *pcVar2;
    size_t sVar3;
    size_t sVar4;
    int *piVar5;
    int iVar6;
    int iVar7;
    int iVar8;
    uint uVar9;
    int iVar10;
    char *__s;
    stat64 sStack_1098;
    char acStack_1030[4100];
    int local_2c;

    iVar7 = *(int *)(param_1 + 0x34);
    local_2c = __stack_chk_guard;
    if (iVar7 != 0) {
        iVar8 = *(int *)(iVar7 + 4);
        uVar9 = *(uint *)(param_1 + 0xc);
        *(uint *)(param_1 + 0xc) = uVar9 & 0xfffffffb;
        if (iVar8 != 0) {
            piVar5 = (int *)(iVar7 + 4);
            iVar8 = 0;
            do {
                piVar5 = piVar5 + 1;
                iVar8 = iVar8 + 1;
            } while (*piVar5 != 0);
        }
        iVar10 = -1;
        while (true) {
            if (iVar8 != -1) {
                iVar6 = iVar8;
                iVar1 = iVar8 << 2;
            } else {
                iVar6 = 0;
                iVar1 = iVar6;
            }
            if (iVar8 == -1) {
                iVar10 = 1;
            }
            if (*(int *)(iVar7 + iVar1) == 0)
                break;
            iVar8 = iVar6 + iVar10;
            iVar7 = FUN_000954cc(acStack_1030, 0x1001, *(int *)(iVar7 + iVar1),
                                 *(undefined4 *)(param_1 + 0x18));
            if ((iVar7 != 0) &&
                (iVar7 = __xstat64(3, acStack_1030, &sStack_1098),
                 iVar7 == 0)) {
                if ((sStack_1098.st_mode & 0xf000) == 0x4000) {
                    sVar3 = strlen(acStack_1030);
                    __s = *(char **)(param_1 + 0x24);
                    sVar4 = strlen(__s);
                    if (0x1000 < sVar3 + 1 + sVar4 + 1)
                        goto LAB_00099ad8;
                    pcVar2 = acStack_1030;
                    if (acStack_1030[sVar3 - 1] != '/') {
                        acStack_1030[sVar3] = '/';
                        pcVar2 = acStack_1030 + 1;
                    }
                    memcpy(pcVar2 + sVar3, __s, sVar4 + 1);
                }
                FUN_00098efc(param_1, acStack_1030, iVar10);
                if (((uint)(iVar10 == -1) &
                     *(uint *)(*(int *)(param_1 + 0x44) +
                               (uint) * (ushort *)(param_1 + 0x5e) * 0x40 +
                               0x50) >>
                         5) != 0) {
                    iVar10 = 1;
                    iVar8 = iVar6;
                }
            }
        LAB_00099ad8:
            iVar7 = *(int *)(param_1 + 0x34);
        }
        *(uint *)(param_1 + 0xc) = uVar9;
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void optionLoadOpt(uint param_1, int param_2)

{
    int iVar1;
    int *piVar2;
    stat64 sStack_80;
    int local_14;

    local_14 = __stack_chk_guard;
    if ((0xf < param_1) && ((*(uint *)(param_2 + 0x10) & 0x28) == 0)) {
        iVar1 = __xstat64(3, *(char **)(param_2 + 0x18), &sStack_80);
        if (iVar1 == 0) {
            if ((sStack_80.st_mode & 0xf000) == 0x8000) {
                FUN_00098efc(param_1, *(undefined4 *)(param_2 + 0x18), 0);
            } else if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
                piVar2 = __errno_location();
                *piVar2 = 0x16;
                /* WARNING: Subroutine does not return */
                FUN_0008e374(*(undefined4 *)(param_1 + 0x1c), &DAT_000a25d0,
                             *(undefined4 *)(param_2 + 0x18));
            }
        } else if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
            /* WARNING: Subroutine does not return */
            FUN_0008e374(*(undefined4 *)(param_1 + 0x1c), &DAT_000a25d0,
                         *(undefined4 *)(param_2 + 0x18));
        }
    }
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00099fb0(byte *param_1)

{
    char cVar1;
    byte bVar2;
    int *piVar3;
    char *pcVar4;
    char *pcVar5;
    int *piVar6;
    byte *pbVar7;
    byte bVar8;
    uint uVar9;
    int iVar10;
    int iVar11;
    byte *pbVar12;
    byte *pbVar13;
    byte local_2d;
    int local_2c;

    local_2c = __stack_chk_guard;
    if (param_1 == (byte *)0x0) {
    LAB_0009a3cc:
        piVar3 = __errno_location();
        *piVar3 = 2;
    } else {
        pcVar4 = DAT_00118358;
        if (DAT_00118358 == (char *)0x0) {
            pcVar4 = (char *)FUN_0008f738(0xc);
        }
        uVar9 = (uint)*param_1;
        cVar1 = pcVar4[uVar9];
        pbVar13 = param_1;
        while (cVar1 != '\0') {
            pbVar13 = pbVar13 + 1;
            uVar9 = (uint)*pbVar13;
            cVar1 = pcVar4[uVar9];
        }
        if (uVar9 == 0)
            goto LAB_0009a3cc;
        iVar11 = 2;
        pbVar7 = pbVar13;
        do {
            while (true) {
                iVar11 = iVar11 + 1;
                pbVar12 = pbVar7 + 1;
                if (DAT_00118358 == (char *)0x0)
                    break;
                pcVar5 = DAT_00118358;
                if (pbVar7[1] != 0) {
                    pcVar4 = DAT_00118358;
                    if (DAT_00118358[pbVar7[1]] == '\0') {
                        do {
                            pbVar12 = pbVar12 + 1;
                            if (*pbVar12 == 0)
                                break;
                            cVar1 = pcVar4[*pbVar12];
                        joined_r0x0009a358:
                        } while (cVar1 == '\0');
                        goto LAB_0009a078;
                    }
                    goto LAB_0009a084;
                }
                if (*DAT_00118358 == '\0')
                    goto LAB_0009a0b0;
            LAB_0009a098:
                do {
                    pbVar12 = pbVar12 + 1;
                } while (pcVar5[*pbVar12] != '\0');
                pbVar7 = pbVar12;
                if (*pbVar12 == 0)
                    goto LAB_0009a0b0;
            }
            pcVar4 = (char *)FUN_0008f738(0xc);
            pcVar5 = DAT_00118358;
            if (pbVar7[1] != 0) {
                cVar1 = pcVar4[pbVar7[1]];
                goto joined_r0x0009a358;
            }
        LAB_0009a078:
            if (pcVar5 == (char *)0x0) {
                pcVar5 = (char *)FUN_0008f738(0xc);
            }
        LAB_0009a084:
            if (pcVar5[*pbVar12] != '\0')
                goto LAB_0009a098;
            pbVar7 = pbVar12;
        } while (*pbVar12 != 0);
    LAB_0009a0b0:
        piVar3 =
            (int *)FUN_0008fbe0(pbVar12 + ((iVar11 * 4 + 8) - (int)pbVar13));
        if (piVar3 != (int *)0x0) {
            iVar10 = 0;
            pbVar13 = (byte *)(piVar3 + iVar11);
            piVar3[1] = (int)pbVar13;
            do {
                *piVar3 = iVar10 + 1;
                piVar3[iVar10 + 1] = (int)pbVar13;
                uVar9 = (uint)*param_1;
                do {
                    while (true) {
                        if ((uVar9 < 0x80) &&
                            (pbVar7 = param_1, pcVar4 = DAT_00118358,
                             (*(uint *)(&DAT_000b0784 + uVar9 * 4) & 0xc01) !=
                                 0))
                            goto joined_r0x0009a24c;
                        if (uVar9 == 0x22)
                            break;
                        if (uVar9 == 0x27) {
                            bVar8 = param_1[1];
                            pbVar7 = param_1 + 1;
                        LAB_0009a1e0:
                            param_1 = pbVar7 + 1;
                            if (bVar8 != 0x27) {
                                do {
                                    if (bVar8 == 0x5c) {
                                        bVar2 = pbVar7[1];
                                        if (bVar2 == 0xd) {
                                            bVar8 = pbVar7[2];
                                            if (bVar8 == 10) {
                                                bVar8 = pbVar7[3];
                                                pbVar7 = pbVar7 + 3;
                                            } else {
                                                pbVar7 = pbVar7 + 2;
                                            }
                                            goto LAB_0009a1e0;
                                        }
                                        if (bVar2 < 0xe) {
                                            if (bVar2 == 0)
                                                goto LAB_0009a36c;
                                            if (bVar2 == 10)
                                                goto code_r0x0009a2dc;
                                        } else {
                                            if (bVar2 == 0x27) {
                                                bVar8 = 0x27;
                                            } else if (bVar2 != 0x5c)
                                                goto LAB_0009a1fc;
                                            param_1 = pbVar7 + 2;
                                        }
                                    } else if (bVar8 == 0)
                                        goto LAB_0009a36c;
                                LAB_0009a1fc:
                                    pbVar7 = param_1;
                                    *pbVar13 = bVar8;
                                    bVar8 = *pbVar7;
                                    pbVar13 = pbVar13 + 1;
                                    param_1 = pbVar7 + 1;
                                    if (bVar8 == 0x27)
                                        break;
                                } while (true);
                            }
                            if (param_1 == (byte *)0x0)
                                goto LAB_0009a36c;
                            uVar9 = (uint)*param_1;
                            if ((uVar9 < 0x80) &&
                                (pbVar7 = param_1, pcVar4 = DAT_00118358,
                                 (*(uint *)(&DAT_000b0784 + uVar9 * 4) &
                                  0xc01) != 0))
                                goto joined_r0x0009a24c;
                        } else {
                            if (uVar9 == 0)
                                goto LAB_0009a1b8;
                            *pbVar13 = (byte)uVar9;
                            uVar9 = (uint)param_1[1];
                            pbVar13 = pbVar13 + 1;
                            param_1 = param_1 + 1;
                        }
                    }
                    pbVar7 = param_1 + 1;
                LAB_0009a26c:
                    local_2d = *pbVar7;
                    pbVar7 = pbVar7 + 1;
                    if (local_2d != 0x22) {
                        if (local_2d == 0x5c)
                            goto LAB_0009a29c;
                        if (local_2d != 0)
                            goto LAB_0009a290;
                        goto LAB_0009a36c;
                    }
                    if (pbVar7 == (byte *)0x0) {
                    LAB_0009a36c:
                        free(piVar3);
                        piVar6 = __errno_location();
                        piVar3 = (int *)0x0;
                        *piVar6 = 0x16;
                        goto LAB_0009a384;
                    }
                    uVar9 = (uint)*pbVar7;
                    param_1 = pbVar7;
                } while ((0x7f < uVar9) ||
                         (pcVar4 = DAT_00118358,
                          (*(uint *)(&DAT_000b0784 + uVar9 * 4) & 0xc01) == 0));
            joined_r0x0009a24c:
                param_1 = pbVar7 + 1;
                DAT_00118358 = pcVar4;
                if (pcVar4 == (char *)0x0) {
                    pcVar4 = (char *)FUN_0008f738(0xc);
                }
                cVar1 = pcVar4[pbVar7[1]];
                while (cVar1 != '\0') {
                    param_1 = param_1 + 1;
                    cVar1 = pcVar4[*param_1];
                }
            LAB_0009a1b8:
                *pbVar13 = 0;
                pbVar13 = pbVar13 + 1;
                if (*param_1 == 0)
                    goto LAB_0009a3a4;
                iVar10 = *piVar3;
            } while (true);
        }
        piVar3 = __errno_location();
        *piVar3 = 0xc;
    }
    piVar3 = (int *)0x0;
LAB_0009a384:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(piVar3);
LAB_0009a29c:
    iVar11 = FUN_00093324(pbVar7, &local_2d, 0x7f);
    pbVar7 = pbVar7 + iVar11;
    if (local_2d != 0x7f) {
    LAB_0009a290:
        *pbVar13 = local_2d;
        pbVar13 = pbVar13 + 1;
    }
    goto LAB_0009a26c;
code_r0x0009a2dc:
    bVar8 = pbVar7[2];
    pbVar7 = pbVar7 + 2;
    goto LAB_0009a1e0;
LAB_0009a3a4:
    piVar3[*piVar3 + 1] = 0;
    goto LAB_0009a384;
}

/* WARNING: Restarted to delay deadcode elimination for space: stack */

void FUN_0009a420(int param_1, int param_2)

{
    char *pcVar1;
    int *__ptr;
    size_t sVar2;
    int iVar3;
    undefined1 *__dest;
    int iVar4;
    int iVar5;
    uint uVar6;
    int *unaff_r9;
    undefined4 uVar7;
    int unaff_r11;
    int local_bc[4];
    undefined1 auStack_ac[128];
    int local_2c;

    local_2c = __stack_chk_guard;
    if ((*(uint *)(param_1 + 0xc) & 0x100) == 0)
        goto LAB_0009a454;
    pcVar1 = getenv(*(char **)(param_1 + 0x20));
    if ((pcVar1 != (char *)0x0) &&
        (__ptr = (int *)FUN_00099fb0(), __ptr != (int *)0x0)) {
        iVar3 = *__ptr;
        uVar6 = *(uint *)(param_1 + 0xc);
        unaff_r9 = *(int **)(param_1 + 4);
        uVar7 = *(undefined4 *)(param_1 + 8);
        unaff_r11 = 0;
        *(uint *)(param_1 + 0xc) = uVar6 & 0xfffffffb;
        *(int *)(param_1 + 4) = iVar3 + 1;
        *(int **)(param_1 + 8) = __ptr;
        *(undefined4 *)(param_1 + 0x10) = 1;
        *(undefined4 *)(param_1 + 0x14) = 0;
        if (param_2 == 1) {
            FUN_000976b4(param_1);
        } else {
            if (param_2 == 0) {
                FUN_000976b4(param_1);
                *(undefined4 *)(param_1 + 0x14) = 0;
                *(undefined4 *)(param_1 + 0x10) = 1;
            } else if (param_2 != 2)
                goto LAB_0009a4d4;
            FUN_000977f0(param_1);
        }
    LAB_0009a4d4:
        free(__ptr);
        *(int **)(param_1 + 4) = unaff_r9;
        *(undefined4 *)(param_1 + 8) = uVar7;
        *(uint *)(param_1 + 0xc) = uVar6;
    }
    local_bc[0] = *(int *)(param_1 + 0x44);
    iVar4 = *(int *)(param_1 + 0x68);
    iVar3 = FUN_0007d00c(auStack_ac, 0x80, &DAT_000b3f58,
                         *(undefined4 *)(param_1 + 0x20));
    iVar5 = iVar4 + -1;
    if (0 < iVar4) {
        unaff_r9 = local_bc;
        unaff_r11 = local_bc[0];
    }
    __dest = auStack_ac + iVar3;
    if (0 < iVar4) {
        do {
            if (((*(uint *)(unaff_r11 + 0x10) & 0x100) == 0) &&
                (*(short *)(unaff_r11 + 8) == -0x8000)) {
                pcVar1 = *(char **)(unaff_r11 + 0x30);
                sVar2 = strlen(pcVar1);
                if (sVar2 + 1 <= 0x7fU - iVar3) {
                    memcpy(__dest, pcVar1, sVar2 + 1);
                    FUN_00098708(unaff_r9, auStack_ac, param_1, param_2);
                    unaff_r11 = local_bc[0];
                }
            }
            iVar5 = iVar5 + -1;
            unaff_r11 = unaff_r11 + 0x40;
            local_bc[0] = unaff_r11;
        } while (iVar5 != -1);
    }
    if ((*(ushort *)(param_1 + 0x5e) & 0x7fff) != 0) {
        local_bc[0] =
            *(int *)(param_1 + 0x44) + (*(ushort *)(param_1 + 0x5e) + 1) * 0x40;
        pcVar1 = *(char **)(local_bc[0] + 0x30);
        if (pcVar1 != (char *)0x0) {
            sVar2 = strlen(pcVar1);
            if (sVar2 + 1 <= 0x7fU - iVar3) {
                memcpy(__dest, pcVar1, sVar2 + 1);
                FUN_00098708(local_bc, auStack_ac, param_1, param_2);
            }
        }
    }
LAB_0009a454:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0009aef8(int param_1, int param_2)

{
    uint uVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 local_20;
    int local_1c;

    local_20 = 0;
    local_1c = __stack_chk_guard;
    FUN_00098348(param_1 + 0xc, 0);
    uVar1 = *(uint *)(param_1 + 0xc);
    if ((param_2 == 0) || ((uVar1 & 0x4000) == 0)) {
        if ((uVar1 & 0x1000) == 0) {
            FUN_0008e9d0();
        } else {
            FUN_0008e87c(uVar1, &local_20);
        }
        FUN_00091b90(param_1, param_2, local_20);
        fflush(option_usage_fp);
        iVar2 = ferror(option_usage_fp);
        if (iVar2 != 0) {
            uVar3 = option_xlateable_txt._224_4_;
            if (option_usage_fp != stderr) {
                uVar3 = option_xlateable_txt._220_4_;
            }
            /* WARNING: Subroutine does not return */
            FUN_0008e374(*(undefined4 *)(param_1 + 0x1c),
                         option_xlateable_txt._228_4_, uVar3);
        }
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0009aff0(char *param_1, uint param_2, undefined4 param_3)

{
    int iVar1;
    byte *pbVar2;
    byte *__ptr;
    char *pcVar3;
    ushort **ppuVar4;
    uint uVar5;
    byte *__s;
    byte *pbVar6;
    byte *pbVar7;
    byte bVar8;
    uint uVar9;

    iVar1 = __stack_chk_guard;
    pbVar2 = (byte *)strlen(param_1);
    uVar5 = param_2;
    if (pbVar2 < (byte *)0x100) {
        uVar5 = param_2 | 1;
    }
    if (uVar5 == 0) {
        __ptr = (byte *)FUN_0008fa64(param_1);
        __s = __ptr;
        pbVar7 = __ptr;
    LAB_0009b050:
        do {
            do {
                while (true) {
                    pcVar3 = strchr((char *)__s, 10);
                    __s = pbVar7;
                    if (pcVar3 == (char *)0x0)
                        goto LAB_0009b114;
                    if (0x27 < (int)pcVar3 - (int)pbVar7)
                        break;
                    __s = (byte *)(pcVar3 + 1);
                }
                ppuVar4 = __ctype_b_loc();
                bVar8 = pcVar3[1];
                uVar9 = (uint)bVar8;
                pbVar6 = (byte *)(pcVar3 + 1);
                uVar5 = (((*ppuVar4)[uVar9] ^ 0x2000) << 0x12) >> 0x1f;
                if (uVar9 == 9) {
                    uVar5 = 1;
                }
                __s = pbVar6;
            } while (uVar5 != 0);
            if (uVar9 == 10) {
                do {
                    pbVar6 = pbVar6 + 1;
                    bVar8 = *pbVar6;
                } while (bVar8 == 10);
            } else if (uVar9 == 0x20) {
                do {
                    __s = __s + 1;
                    if (*__s != 0x20)
                        goto LAB_0009b0e4;
                } while (__s != (byte *)(pcVar3 + 8));
                goto LAB_0009b050;
            }
        LAB_0009b0e4:
            __s = pbVar6;
            *__s = 0;
            FUN_00095f80(pbVar7, 0, param_3);
            pbVar2 = pbVar7 + ((int)pbVar2 - (int)__s);
            if (pbVar2 == (byte *)0x0)
                goto LAB_0009b124;
            *__s = bVar8;
            pbVar7 = __s;
        } while ((byte *)0xff < pbVar2);
    LAB_0009b114:
        FUN_00095f80(__s, 0, param_3);
    LAB_0009b124:
        if (iVar1 == __stack_chk_guard) {
            free(__ptr);
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        FUN_00095f80(param_1, param_2, param_3);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Control flow encountered bad instruction data */

void FUN_0009b180(int *param_1, int param_2)

{
    undefined2 uVar1;
    char *__s;
    int iVar2;
    int iVar3;
    char *pcVar4;
    undefined4 uVar5;
    int iVar6;
    uint uVar7;
    int iVar8;
    uint uVar9;
    char *local_40;
    undefined4 local_3c;
    ushort local_38;
    undefined1 local_36;
    undefined4 local_24;

    local_24 = __stack_chk_guard;
    if (param_2 == 0x2750) {
        DAT_001183f0 = '\0';
        FUN_00098348(param_1 + 3, 0);
    LAB_0009b24c:
        if (*param_1 < 0x1e000) {
            if (option_usage_fp == (FILE *)0x0) {
                __s = (char *)0x0;
                pcVar4 = (char *)0x0;
                goto LAB_0009b618;
            }
        } else {
            __s = (char *)param_1[0x1b];
            pcVar4 = __s;
            if (__s != (char *)0x0) {
                pcVar4 = (char *)0x1;
            }
            if (option_usage_fp == (FILE *)0x0) {
            LAB_0009b618:
                option_usage_fp = stderr;
                if (DAT_001182e8 == '\0') {
                    option_usage_fp = stdout;
                }
            }
            uVar9 = param_1[3];
            if (((uint)pcVar4 & ((uVar9 ^ 0x100000) << 0xb) >> 0x1f) != 0) {
                param_2 = 0;
                goto joined_r0x0009b294;
            }
        }
        fprintf(option_usage_fp, (char *)param_1[0xe], param_1[7]);
        uVar9 = param_1[3];
        iVar3 = 0;
    LAB_0009b314:
        local_40 = (char *)0x0;
        if ((uVar9 & 0x1000) == 0) {
            iVar2 = FUN_0008e9d0();
            sprintf(&DAT_001183f4, "%%-%ds %%s\n", iVar2);
            if ((param_2 != 0) ||
                ((*(uint *)(param_1[0x11] + 0x10) & 0x200000) == 0)) {
                fputs(local_40, option_usage_fp);
            }
        } else {
            iVar2 = FUN_0008e87c(uVar9, &local_40);
            sprintf(&DAT_001183f4, "%%-%ds %%s\n", iVar2);
            fputc(10, option_usage_fp);
        }
        iVar6 = iVar2 + 0xf;
        if (iVar6 < 0) {
            iVar6 = iVar2 + 0x16;
        }
        iVar2 = 4 - (iVar6 >> 3);
        if (0 < iVar2) {
            DAT_001183ec = iVar2;
        }
        FUN_00091b90(param_1, param_2, local_40);
        uVar7 = param_1[3];
        uVar9 = uVar7 & 3;
        if (uVar9 == 1) {
            fputs((char *)option_xlateable_txt._308_4_, option_usage_fp);
            uVar7 = param_1[3];
        } else if (uVar9 == 0) {
            fputs((char *)option_xlateable_txt._336_4_, option_usage_fp);
            uVar7 = param_1[3];
        } else if (uVar9 == 3) {
            fputs((char *)option_xlateable_txt._288_4_, option_usage_fp);
            uVar7 = param_1[3];
        }
        if ((uVar7 & 0x20) != 0) {
            fputs((char *)option_xlateable_txt._332_4_, option_usage_fp);
            uVar7 = param_1[3];
        }
        if ((uVar7 & 0x800) != 0) {
            fputs((char *)option_xlateable_txt._396_4_, option_usage_fp);
        }
        if ((char *)param_1[0xf] != (char *)0x0) {
            fputs((char *)param_1[0xf], option_usage_fp);
        }
        if (param_2 == 0) {
            if (param_1[0xd] == 0) {
                if ((param_1[3] & 0x100U) != 0) {
                    fputs((char *)option_xlateable_txt._352_4_,
                          option_usage_fp);
                LAB_0009b704:
                    fprintf(option_usage_fp,
                            (char *)option_xlateable_txt._276_4_, param_1[8]);
                }
            } else {
                FUN_000957b8(param_1[0xd], param_1[9], param_1[6]);
                if ((param_1[3] & 0x100U) != 0)
                    goto LAB_0009b704;
            }
            if (DAT_001183f0 != '\0') {
                iVar6 = param_1[0x19];
                iVar2 = param_1[0x11];
                fputc(10, option_usage_fp);
                fflush(option_usage_fp);
                do {
                    uVar9 = (uint)(*(int *)(iVar2 + 0x10) << 0x10) >> 0x1c;
                    if ((uVar9 == 2) || (uVar9 == 4)) {
                        (**(code **)(iVar2 + 0x28))(1, iVar2);
                    }
                    iVar6 = iVar6 + -1;
                    iVar2 = iVar2 + 0x40;
                } while (0 < iVar6);
            }
            if ((char *)param_1[0x10] != (char *)0x0) {
                fputs((char *)param_1[0x10], option_usage_fp);
            }
        }
        if ((*param_1 < 0x22000) || ((char *)param_1[0x20] == (char *)0x0)) {
            if (param_1[0x12] != 0) {
                fprintf(option_usage_fp, (char *)option_xlateable_txt._344_4_);
            }
        } else {
            fputs((char *)param_1[0x20], option_usage_fp);
        }
        fflush(option_usage_fp);
        iVar2 = ferror(option_usage_fp);
        if (iVar2 == 0)
            goto LAB_0009b2a4;
        iVar3 = param_1[7];
        uVar5 = option_xlateable_txt._220_4_;
        if (option_usage_fp != stderr)
            goto LAB_0009b2e8;
    } else {
        DAT_001183f0 = '\0';
        FUN_00098348(param_1 + 3, 0);
        if (param_2 == 0)
            goto LAB_0009b24c;
        if (*param_1 < 0x1e000) {
            if (option_usage_fp == (FILE *)0x0) {
                __s = (char *)0x0;
                pcVar4 = (char *)0x0;
                goto LAB_0009b648;
            }
        LAB_0009b47c:
            fprintf(option_usage_fp, (char *)param_1[0xe], param_1[7]);
            uVar9 = param_1[3];
            iVar3 = param_2;
            if ((uVar9 & 0x4000) == 0)
                goto LAB_0009b314;
            uVar1 = local_3c._2_2_;
            if (*param_1 < 0x26000) {
                uVar9 = uVar9 & 3;
                if (uVar9 == 2) {
                    local_3c = CONCAT13(local_3c._3_1_, 0x682d);
                } else if ((uVar9 == 3) || (uVar9 == 1)) {
                    local_3c = 0x65682d2d;
                    local_36 = 0;
                    local_38 = 0x706c;
                } else {
                    local_3c = 0x706c6568;
                    local_38 = local_38 & 0xff00;
                }
            } else {
                iVar2 = param_1[0x11] + param_1[0x1a] * 0x40;
                if (*(int *)(iVar2 + 0x14) != 3) {
                    iVar8 = param_1[0x1a] + 1;
                    iVar6 = iVar2;
                    if (iVar8 < param_1[0x19]) {
                        do {
                            iVar2 = iVar6 + 0x40;
                            if (*(int *)(iVar6 + 0x54) == 3)
                                goto LAB_0009b6a4;
                            iVar8 = iVar8 + 1;
                            iVar6 = iVar2;
                        } while (iVar8 != param_1[0x19]);
                    }
                    FUN_0008e31c(option_xlateable_txt._56_4_);
                    /* WARNING: Bad instruction - Truncating control flow here
                     */
                    halt_baddata();
                }
            LAB_0009b6a4:
                uVar9 = uVar9 & 3;
                if (uVar9 == 2) {
                    local_3c = (uint)local_3c._3_1_ << 0x18;
                    local_3c._0_2_ =
                        CONCAT11((char)*(undefined2 *)(iVar2 + 2), 0x2d);
                } else if ((uVar9 == 3) || (uVar9 == 1)) {
                    local_3c = CONCAT22(uVar1, 0x2d00);
                    local_3c = CONCAT31(local_3c._1_3_, 0x2d);
                    strncpy((char *)((int)&local_3c + 2),
                            *(char **)(iVar2 + 0x34), 0x14);
                } else {
                    strncpy((char *)&local_3c, *(char **)(iVar2 + 0x34), 0x14);
                }
            }
            fprintf(option_usage_fp, (char *)option_xlateable_txt._212_4_,
                    param_1[7], &local_3c);
        } else {
            __s = (char *)param_1[0x1c];
            pcVar4 = __s;
            if (__s != (char *)0x0) {
                pcVar4 = (char *)0x1;
            }
            if (option_usage_fp == (FILE *)0x0) {
            LAB_0009b648:
                option_usage_fp = stderr;
            }
            uVar9 = param_1[3];
            if (((uint)pcVar4 & ((uVar9 ^ 0x100000) << 0xb) >> 0x1f) == 0)
                goto LAB_0009b47c;
        joined_r0x0009b294:
            iVar3 = param_2;
            if ((uVar9 & 0x2000) == 0) {
                fputs(__s, option_usage_fp);
            } else {
                FUN_0009aff0(__s, 1);
            }
        }
    LAB_0009b2a4:
        fflush(option_usage_fp);
        iVar2 = ferror(option_usage_fp);
        if (iVar2 == 0) {
            /* WARNING: Subroutine does not return */
            FUN_0008e2b8(iVar3);
        }
        iVar3 = param_1[7];
        uVar5 = option_xlateable_txt._220_4_;
        if (option_usage_fp == stdout)
            goto LAB_0009b2e8;
    }
    uVar5 = option_xlateable_txt._224_4_;
LAB_0009b2e8:
    /* WARNING: Subroutine does not return */
    FUN_0008e374(iVar3, option_xlateable_txt._228_4_, uVar5);
}

void FUN_0009b874(int param_1, int param_2)

{
    int iVar1;
    __pid_t _Var2;
    byte *pbVar3;
    __int32_t **pp_Var4;
    uint uVar5;
    undefined1 auStack_30[4];
    undefined4 local_2c;

    local_2c = __stack_chk_guard;
    if (param_2 != 0) {
        FUN_0009b180();
    }
    fflush(stderr);
    fflush(stdout);
    iVar1 = ferror(stdout);
    if ((iVar1 != 0) || (iVar1 = ferror(stderr), iVar1 != 0)) {
        /* WARNING: Subroutine does not return */
        FUN_0008e2b8(1);
    }
    option_usage_fp = stdout;
    _Var2 = fork();
    if (_Var2 == -1) {
        FUN_0009b180(param_1, 1);
    LAB_0009b9f4:
        DAT_001183e0 = 2;
        FUN_0009b180(param_1, 0);
        /* WARNING: Subroutine does not return */
        _exit(1);
    }
    if (_Var2 == 0)
        goto LAB_0009b9f4;
    wait(auStack_30);
    iVar1 = optionParseShellOptions;
    pbVar3 =
        (byte *)FUN_0008fa64(*(undefined4 *)(optionParseShellOptions + 0x20));
    *(byte **)(iVar1 + 0x1c) = pbVar3;
    uVar5 = (uint)*pbVar3;
    if (uVar5 != 0) {
        pp_Var4 = __ctype_tolower_loc();
        do {
            *pbVar3 = (byte)(*pp_Var4)[uVar5];
            pbVar3 = pbVar3 + 1;
            uVar5 = (uint)*pbVar3;
        } while (uVar5 != 0);
    }
    fprintf(option_usage_fp, (char *)option_xlateable_txt._292_4_,
            *(undefined4 *)(optionParseShellOptions + 0x1c));
    fflush(option_usage_fp);
    _Var2 = fork();
    if (_Var2 != -1) {
        if (_Var2 != 0)
            goto LAB_0009b9b8;
        DAT_001183e0 = 2;
    }
    FUN_0009b180(optionParseShellOptions, 1);
LAB_0009b9b8:
    wait(auStack_30);
    fflush(stdout);
    iVar1 = ferror(stdout);
    if (iVar1 != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0008e374(*(undefined4 *)(param_1 + 0x1c),
                     option_xlateable_txt._228_4_,
                     option_xlateable_txt._220_4_);
    }
    /* WARNING: Subroutine does not return */
    FUN_0008e2b8();
}

/* WARNING: Removing unreachable block (ram,0x0009bacc) */

void FUN_0009ba84(void)

{
    return;
}

void FUN_0009badc(int *param_1, uint *param_2, undefined4 *param_3,
                  FILE *param_4, char param_5)

{
    char cVar1;
    int iVar2;
    int iVar3;
    char *__s;
    undefined4 uVar4;
    undefined4 uVar5;

    iVar2 = __stack_chk_guard;
    if ((((*param_2 & 0x10000) == 0) || ((char *)*param_3 == (char *)0x0)) ||
        (cVar1 = *(char *)*param_3, cVar1 == '\0')) {
        FUN_00098348(param_1 + 3, 0);
        if ((param_1[3] & 0x1000U) == 0)
            goto LAB_0009bc24;
        goto LAB_0009bc70;
    }
    switch (cVar1) {
    case 'C':
        goto LAB_0009bc70;
    case 'D':
        break;
    case 'E':
        break;
    case 'F':
        break;
    case 'G':
        break;
    case 'H':
        break;
    case 'I':
        break;
    case 'J':
        break;
    case 'K':
        break;
    case 'L':
        break;
    case 'M':
        break;
    case 'N':
        goto LAB_0009bcb8;
    case 'O':
        break;
    case 'P':
        break;
    case 'Q':
        break;
    case 'R':
        break;
    case 'S':
        break;
    case 'T':
        break;
    case 'U':
        break;
    case 'V':
        goto LAB_0009bc24;
    case 'W':
        break;
    case 'X':
        break;
    case 'Y':
        break;
    case 'Z':
        break;
    case '[':
        break;
    case '\\':
        break;
    case ']':
        break;
    case '^':
        break;
    case '_':
        break;
    case '`':
        break;
    case 'a':
        break;
    case 'b':
        break;
    case 'c':
    LAB_0009bc70:
        __s = (char *)param_1[10];
        if ((__s == (char *)0x0) &&
            (__s = (char *)param_1[0xc], __s == (char *)0x0)) {
            FUN_0008da6c(param_4, param_1[0xe], 0, 0);
        } else {
            fputs(__s, param_4);
        }
        if ((*param_1 < 0x22000) || (param_1[0x20] == 0)) {
            if (param_1[0x12] != 0) {
                fputc(10, param_4);
                fprintf(param_4, (char *)option_xlateable_txt._344_4_,
                        param_1[0x12]);
            }
        } else {
        LAB_0009bc9c:
            fputc(10, param_4);
            fputs((char *)param_1[0x20], param_4);
        }
    LAB_0009bc38:
        fflush(param_4);
        iVar3 = ferror(param_4);
        if (iVar3 != 0) {
            uVar5 = option_xlateable_txt._220_4_;
            if (param_4 != stdout) {
                uVar5 = option_xlateable_txt._224_4_;
            }
            /* WARNING: Subroutine does not return */
            FUN_0008e374(param_1[7], option_xlateable_txt._228_4_, uVar5);
        }
        if (param_5 == '\0') {
            if (iVar2 == __stack_chk_guard) {
                return;
            }
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
        /* WARNING: Subroutine does not return */
        FUN_0008e2b8();
    case 'd':
        break;
    case 'e':
        break;
    case 'f':
        break;
    case 'g':
        break;
    case 'h':
        break;
    case 'i':
        break;
    case 'j':
        break;
    case 'k':
        break;
    case 'l':
        break;
    case 'm':
        break;
    case 'n':
    LAB_0009bcb8:
        if ((char *)param_1[10] != (char *)0x0) {
            fputs((char *)param_1[10], param_4);
        }
        if ((char *)param_1[0xb] != (char *)0x0) {
            fputs((char *)param_1[0xb], param_4);
        }
        fputc(10, param_4);
        uVar5 = option_xlateable_txt._44_4_;
        uVar4 = FUN_0009ba84();
        fprintf(param_4, (char *)uVar5, uVar4);
        if ((*param_1 < 0x22000) || (param_1[0x20] == 0)) {
            if (param_1[0x12] != 0) {
                fputc(10, param_4);
                fprintf(param_4, (char *)option_xlateable_txt._344_4_,
                        param_1[0x12]);
            }
            goto LAB_0009bc38;
        }
        goto LAB_0009bc9c;
    case 'o':
        break;
    case 'p':
        break;
    case 'q':
        break;
    case 'r':
        break;
    case 's':
        break;
    case 't':
        break;
    case 'u':
        break;
    case 'v':
    LAB_0009bc24:
        FUN_0008da6c(param_4, param_1[0xc], param_1[10], param_1[0xe]);
        goto LAB_0009bc38;
    }
    fprintf(stderr, (char *)option_xlateable_txt._104_4_);
    /* WARNING: Subroutine does not return */
    FUN_0008e2b8(1);
}

void optionPrintVersion(uint param_1, int param_2)

{
    int iVar1;
    undefined4 uVar2;

    iVar1 = __stack_chk_guard;
    uVar2 = stdout;
    if (DAT_001182e8 != '\0') {
        uVar2 = stderr;
    }
    if (0xf < param_1) {
        FUN_0009badc(param_1, param_2 + 0x10, param_2 + 0x18, uVar2, 1);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0009beb4(int param_1, int param_2, int param_3)

{
    int iVar1;
    __pid_t _Var2;
    FILE *__stream;
    int __c;
    undefined *puVar3;
    undefined4 uVar4;
    int local_34;
    int local_30;
    int local_2c;

    local_2c = __stack_chk_guard;
    fflush(stdout);
    fflush(stderr);
    iVar1 = pipe(&local_34);
    if (iVar1 != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0008e374(*(undefined4 *)(param_1 + 0x1c), &DAT_000b3f80,
                     option_xlateable_txt._100_4_);
    }
    _Var2 = fork();
    if (_Var2 == -1) {
        /* WARNING: Subroutine does not return */
        FUN_0008e374(*(undefined4 *)(param_1 + 0x1c), &DAT_000b3f88);
    }
    if (_Var2 != 0) {
        close(local_30);
        uVar4 = *(undefined4 *)(param_1 + 0x20);
        puVar3 = (&PTR_s_LONGUSAGE_000c638c)[param_2];
        __stream = fdopen(local_34, "r");
        printf("%s_%s_TEXT=\'", uVar4, puVar3);
        if (__stream != (FILE *)0x0) {
            iVar1 = 0;
            while (true) {
                while (true) {
                    while (__c = fgetc(__stream), __c == 10) {
                        iVar1 = iVar1 + 1;
                    }
                    if (__c != 0x27)
                        break;
                    for (; iVar1 != 0; iVar1 = iVar1 + -1) {
                        fputc(10, stdout);
                    }
                    fwrite(&DAT_000b16be, 1, 4, stdout);
                    iVar1 = 0;
                }
                if (__c == -1)
                    break;
                for (; iVar1 != 0; iVar1 = iVar1 + -1) {
                    fputc(10, stdout);
                }
                fputc(__c, stdout);
                iVar1 = 0;
            }
            fclose(__stream);
        }
        fwrite(&DAT_000b14fd, 1, 3, stdout);
        if (local_2c != __stack_chk_guard) {
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
        return;
    }
    dup2(local_30, 2);
    dup2(local_30, 1);
    close(local_34);
    if (param_2 == 1) {
    LAB_0009c0d4:
        (**(code **)(param_1 + 0x54))(param_1, 1);
    } else {
        if (param_2 == 0) {
            (**(code **)(param_1 + 0x54))(param_1, 0);
            goto LAB_0009c0d4;
        }
        if (param_2 != 2)
            goto LAB_0009c030;
    }
    if ((*(uint *)(param_3 + 0x10) & 0x40) != 0) {
        free(*(void **)(param_3 + 0x18));
        *(uint *)(param_3 + 0x10) = *(uint *)(param_3 + 0x10) & 0xffffffbf;
    }
    *(char **)(param_3 + 0x18) = "c";
    optionPrintVersion(param_1, param_3);
LAB_0009c030:
    /* WARNING: Subroutine does not return */
    FUN_0008e2b8(1);
}

void FUN_0009c14c(int param_1)

{
    __int32_t _Var1;
    tm *ptVar2;
    __int32_t **pp_Var3;
    char *pcVar4;
    FILE *pFVar5;
    char *__haystack;
    size_t sVar6;
    char *pcVar7;
    __int32_t *p_Var8;
    uint uVar9;
    char *pcVar10;
    int iVar11;
    int iVar12;
    int iVar13;
    byte *pbVar14;
    int iVar15;
    undefined4 uVar16;
    bool bVar17;
    stat64 local_118;
    char acStack_ac[128];
    int local_2c;

    local_2c = __stack_chk_guard;
    if ((*(uint *)(genshelloptOptions._68_4_ + 0x50) & 0xf) == 0) {
        if ((*(uint *)(genshelloptOptions._68_4_ + 0x50) & 0x20) == 0) {
            DAT_00118420 = getenv("SHELL");
            if (DAT_00118420 == (char *)0x0) {
                DAT_00118420 = "/bin/bash";
            }
            goto LAB_0009c1a4;
        }
        uVar9 = *(uint *)(genshelloptOptions._68_4_ + 0x10);
        DAT_00118420 = (char *)0x0;
    } else {
        DAT_00118420 = *(char **)(genshelloptOptions._68_4_ + 0x58);
    LAB_0009c1a4:
        uVar9 = *(uint *)(genshelloptOptions._68_4_ + 0x10);
    }
    if ((uVar9 & 0xf) != 0) {
        pcVar4 = *(char **)(genshelloptOptions._68_4_ + 0x18);
        uVar16 = *(undefined4 *)(param_1 + 0x1c);
        pFVar5 = fopen64(pcVar4, "r");
        if (pFVar5 == (FILE *)0x0) {
            DAT_00118424 = (char *)0x0;
            pcVar10 = DAT_00118428;
        } else {
            iVar15 = fileno(pFVar5);
            iVar15 = __fxstat64(3, iVar15, &local_118);
            if ((iVar15 != 0) || ((local_118.st_mode & 0xf000) != 0x8000)) {
                /* WARNING: Subroutine does not return */
                FUN_0008e374(uVar16, "fstat", pcVar4);
            }
            __haystack = (char *)FUN_0008fbe0((size_t)local_118.st_size + 1);
            pcVar10 = __haystack;
            while (sVar6 = fread(pcVar10, 1, (size_t)local_118.st_size, pFVar5),
                   sVar6 != 0) {
                bVar17 = (size_t)local_118.st_size < sVar6;
                local_118.st_size._0_4_ = (size_t)local_118.st_size - sVar6;
                local_118.st_size._4_4_ = local_118.st_size._4_4_ -
                                          (((int)sVar6 >> 0x1f) + (uint)bVar17);
                if ((size_t)local_118.st_size == 0 &&
                    local_118.st_size._4_4_ == 0)
                    break;
                pcVar10 = pcVar10 + sVar6;
            }
            *pcVar10 = '\0';
            fclose(pFVar5);
            DAT_00118424 = __haystack;
            pcVar10 = DAT_00118428;
            if ((__haystack != (char *)0x0) &&
                (pcVar7 = strstr(__haystack,
                                 "# # # # # # # # # # -- do not modify this "
                                 "marker --\n#\n#  DO NOT EDIT THIS SECTION\n"),
                 pcVar10 = __haystack, pcVar7 != (char *)0x0)) {
                *pcVar7 = '\0';
                pcVar10 = strstr(pcVar7 + 1,
                                 "\n# # # # # # # # # #\n#\n#  END OF "
                                 "AUTOMATED OPTION PROCESSING\n#\n# # # # # # "
                                 "# # # # -- do not modify this marker --\n");
                if (pcVar10 == (char *)0x0) {
                    sVar6 = strlen(__haystack);
                    pcVar10 = __haystack + sVar6 + 0x53;
                } else {
                    pcVar10 = pcVar10 + 0x73;
                    DAT_0011842c = __haystack;
                }
            }
        }
        DAT_00118428 = pcVar10;
        pFVar5 = freopen64(pcVar4, "w", stdout);
        if (stdout != pFVar5) {
            /* WARNING: Subroutine does not return */
            FUN_0008e374(uVar16, "freopen", pcVar4);
        }
    }
    if (DAT_0011842c == (char *)0x0) {
        local_118.st_dev._0_4_ = time((time_t *)0x0);
        ptVar2 = localtime((time_t *)&local_118);
        strftime(acStack_ac, 0x80, "%A %B %e, %Y at %r %Z", ptVar2);
        pcVar4 = (char *)0x0;
        if ((*(uint *)(genshelloptOptions._68_4_ + 0x10) & 0xf) != 0)
            goto LAB_0009c550;
        pcVar10 = "stdout";
    LAB_0009c55c:
        if (DAT_00118420 != (char *)0x0) {
            printf("#! %s\n");
        }
    } else {
        fputs(DAT_0011842c, stdout);
        pcVar4 = DAT_0011842c;
        local_118.st_dev._0_4_ = time((time_t *)0x0);
        ptVar2 = localtime((time_t *)&local_118);
        strftime(acStack_ac, 0x80, "%A %B %e, %Y at %r %Z", ptVar2);
        if ((*(uint *)(genshelloptOptions._68_4_ + 0x10) & 0xf) == 0) {
            pcVar10 = "stdout";
        } else {
        LAB_0009c550:
            pcVar10 = *(char **)(genshelloptOptions._68_4_ + 0x18);
        }
        if (pcVar4 == (char *)0x0)
            goto LAB_0009c55c;
    }
    printf("%s OF %s\n#\n#  From here to the next `-- do not modify this "
           "marker --\',\n#  the text has been generated %s\n",
           "# # # # # # # # # # -- do not modify this marker --\n#\n#  DO NOT "
           "EDIT THIS SECTION\n",
           pcVar10, acStack_ac);
    printf("#  From the %s option definitions\n#\n",
           *(undefined4 *)(param_1 + 0x20));
    pbVar14 = *(byte **)(param_1 + 0x20);
    pp_Var3 = __ctype_tolower_loc();
    p_Var8 = *pp_Var3;
    pcVar4 = acStack_ac;
    do {
        _Var1 = p_Var8[*pbVar14];
        *pcVar4 = (char)_Var1;
        pcVar4 = pcVar4 + 1;
        pbVar14 = pbVar14 + 1;
    } while ((char)_Var1 != '\0');
    *(char **)(param_1 + 0x18) = acStack_ac;
    *(char **)(param_1 + 0x1c) = acStack_ac;
    FUN_0009beb4(param_1, 0, 0);
    FUN_0009beb4(param_1, 1, 0);
    iVar13 = *(int *)(param_1 + 0x44);
    iVar15 = iVar13;
    if (*(code **)(iVar13 + 0x28) == optionPrintVersion) {
    LAB_0009c2f0:
        FUN_0009beb4(param_1, 2, iVar15);
        iVar13 = *(int *)(param_1 + 0x44);
    } else {
        iVar12 = *(int *)(param_1 + 100) + -1;
        iVar11 = iVar13;
        if (0 < iVar12) {
            do {
                iVar15 = iVar11 + 0x40;
                if (*(code **)(iVar11 + 0x68) == optionPrintVersion)
                    goto LAB_0009c2f0;
                iVar12 = iVar12 + -1;
                iVar11 = iVar11 + 0x40;
            } while (iVar12 != 0);
        }
    }
    iVar15 = *(int *)(param_1 + 0x68);
    if (0 < iVar15) {
        do {
            if (((*(uint *)(iVar13 + 0x10) & 0x280000) != 0) ||
                (iVar11 = *(int *)(iVar13 + 0x30), iVar11 == 0))
                goto LAB_0009c3b0;
            pcVar4 = "\n%1$s_%2$s=${%1$s_%2$s-\'%3$s\'}\n%1$s_%2$s_set="
                     "false\nexport %1$s_%2$s\n";
            if (1 < *(ushort *)(iVar13 + 0xc)) {
                pcVar4 = "\nif test -z \"${%1$s_%2$s}\"\nthen\n  "
                         "%1$s_%2$s_CT=0\n  export %1$s_%2$s_CT\nelse\n  "
                         "%1$s_%2$s_CT=1\n  %1$s_%2$s_1=${%1$s_%2$s}\n  export "
                         "%1$s_%2$s_CT %1$s_%2$s_1\nfi\n";
            }
            switch ((*(uint *)(iVar13 + 0x10) << 0x10) >> 0x1c) {
            case 2:
                (**(code **)(iVar13 + 0x28))(2, iVar13);
                pcVar10 = *(char **)(iVar13 + 0x18);
                iVar11 = *(int *)(iVar13 + 0x30);
                break;
            case 3:
                if (*(int *)(iVar13 + 0x18) == 0) {
                    pcVar10 = "false";
                } else {
                    pcVar10 = "true";
                }
                break;
            case 4:
                uVar16 = *(undefined4 *)(iVar13 + 0x18);
                pcVar10 = "%lu";
                goto LAB_0009c390;
            case 5:
                uVar16 = *(undefined4 *)(iVar13 + 0x18);
                pcVar10 = "%d";
            LAB_0009c390:
                FUN_0007d00c(acStack_ac, 0x20, pcVar10, uVar16);
                iVar11 = *(int *)(iVar13 + 0x30);
                pcVar10 = acStack_ac;
                break;
            default:
                pcVar10 = *(char **)(iVar13 + 0x18);
                if ((pcVar10 == (char *)0x0) &&
                    (pcVar4 == "\n%1$s_%2$s=${%1$s_%2$s-\'%3$s\'}\n%1$s_%2$s_"
                               "set=false\nexport %1$s_%2$s\n")) {
                    pcVar4 = "\n%1$s_%2$s=${%1$s_%2$s}\n%1$s_%2$s_set="
                             "false\nexport %1$s_%2$s\n";
                }
            }
            printf(pcVar4, *(undefined4 *)(param_1 + 0x20), iVar11, pcVar10);
        LAB_0009c3b0:
            iVar15 = iVar15 + -1;
            iVar13 = iVar13 + 0x40;
        } while (iVar15 != 0);
    }
    uVar9 = *(uint *)(param_1 + 0xc) & 3;
    if (uVar9 == 2) {
        fwrite("\nARG_COUNT=$#\nOPT_PROCESS=true\nOPT_ARG=$1\nwhile "
               "${OPT_PROCESS} && [ $# -gt 0 ]\ndo\n    OPT_ELEMENT=\'\'\n    "
               "OPT_ARG_VAL=\'\'\n\n    case \"${OPT_ARG}\" in\n    -- )\n     "
               "   OPT_PROCESS=false\n        shift\n        ;;\n",
               1, 0xce, stdout);
        fwrite(&DAT_000b152d, 1, 9, stdout);
        fwrite("        OPT_CODE=`echo \"X${OPT_ARG}\" | sed "
               "\'s/X-\\(.\\).*/\\1/\'`\n        OPT_ARG=` echo "
               "\"X${OPT_ARG}\" | sed \'s/X-.//\'`\n",
               1, 0x74, stdout);
        FUN_0009021c(param_1);
        printf("        case \"${OPT_ARG_NEEDED}\" in\n        NO )\n          "
               "  if [ -n \"${OPT_ARG}\" ]\n            then\n                "
               "OPT_ARG=-${OPT_ARG}\n            else\n                shift\n "
               "               OPT_ARG=$1\n            fi\n            ;;\n    "
               "    YES )\n            if [ -n \"${OPT_ARG}\" ]\n            "
               "then\n                OPT_ARG_VAL=${OPT_ARG}\n            "
               "else\n                if [ $# -eq 0 ]\n                then\n  "
               "                  echo No argument provided for ${OPT_NAME} "
               "option\n                    echo \"$%s_USAGE_TEXT\"\n          "
               "          exit 1\n                fi >&2\n                "
               "shift\n                OPT_ARG_VAL=$1\n            fi\n        "
               "    shift\n            OPT_ARG=$1\n            ;;\n        OK "
               ")\n            if [ -n \"${OPT_ARG}\" ]\n            then\n    "
               "            OPT_ARG_VAL=${OPT_ARG}\n                shift\n    "
               "            OPT_ARG=$1\n            else\n                "
               "shift\n                if [ $# -gt 0 ]\n                then\n "
               "                   case \"$1\" in -* ) ;; * )\n                "
               "        OPT_ARG_VAL=$1\n                        shift ;; "
               "esac\n                    OPT_ARG=$1\n                fi\n     "
               "       fi\n            ;;\n        esac\n",
               *(undefined4 *)(param_1 + 0x20));
    } else {
        if (uVar9 != 3) {
            if (uVar9 == 1) {
                fwrite("\nARG_COUNT=$#\nOPT_PROCESS=true\nOPT_ARG=$1\nwhile "
                       "${OPT_PROCESS} && [ $# -gt 0 ]\ndo\n    "
                       "OPT_ELEMENT=\'\'\n    OPT_ARG_VAL=\'\'\n\n    case "
                       "\"${OPT_ARG}\" in\n    -- )\n        "
                       "OPT_PROCESS=false\n        shift\n        ;;\n",
                       1, 0xce, stdout);
                fwrite(&DAT_000b1556, 1, 10, stdout);
                fwrite("        OPT_CODE=`echo \"X${OPT_ARG}\"|sed "
                       "\'s/^X-*//\'`\n        shift\n        OPT_ARG=$1\n     "
                       "   case \"${OPT_CODE}\" in *=* )\n            "
                       "OPT_ARG_VAL=`echo \"${OPT_CODE}\"|sed "
                       "\'s/^[^=]*=//\'`\n            OPT_CODE=`echo "
                       "\"${OPT_CODE}\"|sed \'s/=.*$//\'` ;; esac\n",
                       1, 0xfa, stdout);
                FUN_000904e0(param_1);
                printf(
                    "        case \"${OPT_ARG_NEEDED}\" in\n        NO )\n     "
                    "       OPT_ARG_VAL=\'\'\n            ;;\n        YES )\n  "
                    "          if [ -z \"${OPT_ARG_VAL}\" ]\n            "
                    "then\n                if [ $# -eq 0 ]\n                "
                    "then\n                    echo No argument provided for "
                    "${OPT_NAME} option\n                    echo "
                    "\"$%s_USAGE_TEXT\"\n                    exit 1\n          "
                    "      fi >&2\n                OPT_ARG_VAL=${OPT_ARG}\n    "
                    "            shift\n                OPT_ARG=$1\n           "
                    " fi\n            ;;\n        OK )\n            if [ -z "
                    "\"${OPT_ARG_VAL}\" ] && [ $# -gt 0 ]\n            then\n  "
                    "              case \"${OPT_ARG}\" in -* ) ;; * )\n        "
                    "            OPT_ARG_VAL=${OPT_ARG}\n                    "
                    "shift\n                    OPT_ARG=$1 ;; esac\n           "
                    " fi\n            ;;\n        esac\n",
                    *(undefined4 *)(param_1 + 0x20));
                fwrite(&DAT_000b14f0, 1, 0xc, stdout);
                fwrite("    * )\n         OPT_PROCESS=false\n         ;;\n    "
                       "esac\n",
                       1, 0x38, stdout);
            } else {
                fwrite("\nARG_COUNT=$#\nOPT_ARG=$1\nwhile [ $# -gt 0 ]\ndo\n   "
                       " OPT_ELEMENT=\'\'\n    OPT_ARG_VAL=\'\'\n    "
                       "OPT_ARG=${1}\n",
                       1, 0x66, stdout);
                fwrite("        OPT_CODE=`echo \"X${OPT_ARG}\"|sed "
                       "\'s/^X-*//\'`\n        shift\n        OPT_ARG=$1\n     "
                       "   case \"${OPT_CODE}\" in *=* )\n            "
                       "OPT_ARG_VAL=`echo \"${OPT_CODE}\"|sed "
                       "\'s/^[^=]*=//\'`\n            OPT_CODE=`echo "
                       "\"${OPT_CODE}\"|sed \'s/=.*$//\'` ;; esac\n",
                       1, 0xfa, stdout);
                FUN_000904e0(param_1);
                printf(
                    "        case \"${OPT_ARG_NEEDED}\" in\n        NO )\n     "
                    "       OPT_ARG_VAL=\'\'\n            ;;\n        YES )\n  "
                    "          if [ -z \"${OPT_ARG_VAL}\" ]\n            "
                    "then\n                if [ $# -eq 0 ]\n                "
                    "then\n                    echo No argument provided for "
                    "${OPT_NAME} option\n                    echo "
                    "\"$%s_USAGE_TEXT\"\n                    exit 1\n          "
                    "      fi >&2\n                OPT_ARG_VAL=${OPT_ARG}\n    "
                    "            shift\n                OPT_ARG=$1\n           "
                    " fi\n            ;;\n        OK )\n            if [ -z "
                    "\"${OPT_ARG_VAL}\" ] && [ $# -gt 0 ]\n            then\n  "
                    "              case \"${OPT_ARG}\" in -* ) ;; * )\n        "
                    "            OPT_ARG_VAL=${OPT_ARG}\n                    "
                    "shift\n                    OPT_ARG=$1 ;; esac\n           "
                    " fi\n            ;;\n        esac\n",
                    *(undefined4 *)(param_1 + 0x20));
            }
            goto LAB_0009c420;
        }
        fwrite("\nARG_COUNT=$#\nOPT_PROCESS=true\nOPT_ARG=$1\nwhile "
               "${OPT_PROCESS} && [ $# -gt 0 ]\ndo\n    OPT_ELEMENT=\'\'\n    "
               "OPT_ARG_VAL=\'\'\n\n    case \"${OPT_ARG}\" in\n    -- )\n     "
               "   OPT_PROCESS=false\n        shift\n        ;;\n",
               1, 0xce, stdout);
        fwrite(&DAT_000b1556, 1, 10, stdout);
        fwrite("        OPT_CODE=`echo \"X${OPT_ARG}\"|sed \'s/^X-*//\'`\n     "
               "   shift\n        OPT_ARG=$1\n        case \"${OPT_CODE}\" in "
               "*=* )\n            OPT_ARG_VAL=`echo \"${OPT_CODE}\"|sed "
               "\'s/^[^=]*=//\'`\n            OPT_CODE=`echo "
               "\"${OPT_CODE}\"|sed \'s/=.*$//\'` ;; esac\n",
               1, 0xfa, stdout);
        FUN_000904e0(param_1);
        printf(
            "        case \"${OPT_ARG_NEEDED}\" in\n        NO )\n            "
            "OPT_ARG_VAL=\'\'\n            ;;\n        YES )\n            if [ "
            "-z \"${OPT_ARG_VAL}\" ]\n            then\n                if [ "
            "$# -eq 0 ]\n                then\n                    echo No "
            "argument provided for ${OPT_NAME} option\n                    "
            "echo \"$%s_USAGE_TEXT\"\n                    exit 1\n             "
            "   fi >&2\n                OPT_ARG_VAL=${OPT_ARG}\n               "
            " shift\n                OPT_ARG=$1\n            fi\n            "
            ";;\n        OK )\n            if [ -z \"${OPT_ARG_VAL}\" ] && [ "
            "$# -gt 0 ]\n            then\n                case \"${OPT_ARG}\" "
            "in -* ) ;; * )\n                    OPT_ARG_VAL=${OPT_ARG}\n      "
            "              shift\n                    OPT_ARG=$1 ;; esac\n     "
            "       fi\n            ;;\n        esac\n",
            *(undefined4 *)(param_1 + 0x20));
        fwrite(&DAT_000b14f0, 1, 0xc, stdout);
        fwrite(&DAT_000b152d, 1, 9, stdout);
        fwrite("        OPT_CODE=`echo \"X${OPT_ARG}\" | sed "
               "\'s/X-\\(.\\).*/\\1/\'`\n        OPT_ARG=` echo "
               "\"X${OPT_ARG}\" | sed \'s/X-.//\'`\n",
               1, 0x74, stdout);
        FUN_0009021c(param_1);
        printf("        case \"${OPT_ARG_NEEDED}\" in\n        NO )\n          "
               "  if [ -n \"${OPT_ARG}\" ]\n            then\n                "
               "OPT_ARG=-${OPT_ARG}\n            else\n                shift\n "
               "               OPT_ARG=$1\n            fi\n            ;;\n    "
               "    YES )\n            if [ -n \"${OPT_ARG}\" ]\n            "
               "then\n                OPT_ARG_VAL=${OPT_ARG}\n            "
               "else\n                if [ $# -eq 0 ]\n                then\n  "
               "                  echo No argument provided for ${OPT_NAME} "
               "option\n                    echo \"$%s_USAGE_TEXT\"\n          "
               "          exit 1\n                fi >&2\n                "
               "shift\n                OPT_ARG_VAL=$1\n            fi\n        "
               "    shift\n            OPT_ARG=$1\n            ;;\n        OK "
               ")\n            if [ -n \"${OPT_ARG}\" ]\n            then\n    "
               "            OPT_ARG_VAL=${OPT_ARG}\n                shift\n    "
               "            OPT_ARG=$1\n            else\n                "
               "shift\n                if [ $# -gt 0 ]\n                then\n "
               "                   case \"$1\" in -* ) ;; * )\n                "
               "        OPT_ARG_VAL=$1\n                        shift ;; "
               "esac\n                    OPT_ARG=$1\n                fi\n     "
               "       fi\n            ;;\n        esac\n",
               *(undefined4 *)(param_1 + 0x20));
    }
    fwrite(&DAT_000b14f0, 1, 0xc, stdout);
    fwrite("    * )\n         OPT_PROCESS=false\n         ;;\n    esac\n", 1,
           0x38, stdout);
LAB_0009c420:
    iVar13 = *(int *)(param_1 + 0x68);
    iVar15 = *(int *)(param_1 + 0x44);
    printf("    if [ -n \"${OPT_ARG_VAL}\" ]\n    then\n        eval "
           "%1$s_${OPT_NAME}${OPT_ELEMENT}=\"\'${OPT_ARG_VAL}\'\"\n        "
           "export %1$s_${OPT_NAME}${OPT_ELEMENT}\n    "
           "fi\ndone\nOPTION_COUNT=`expr $ARG_COUNT - "
           "$#`\nOPERAND_COUNT=$#\nunset OPT_PROCESS || :\nunset OPT_ELEMENT "
           "|| :\nunset OPT_ARG     || :\nunset OPT_ARG_NEEDED || :\nunset "
           "OPT_NAME    || :\nunset OPT_CODE    || :\nunset OPT_ARG_VAL || :\n",
           *(undefined4 *)(param_1 + 0x20));
    if (0 < iVar13) {
        do {
            if (((*(uint *)(iVar15 + 0x10) & 0x280000) == 0) &&
                (*(int *)(iVar15 + 0x30) != 0)) {
                uVar9 = (uint) * (ushort *)(iVar15 + 10);
                if (uVar9 == 0) {
                    if ((*(uint *)(iVar15 + 0x10) & 0x100000) == 0)
                        goto LAB_0009c46c;
                    if (*(ushort *)(iVar15 + 0xc) < 2) {
                        uVar9 = 1;
                        pcVar4 =
                            "test -n \"$%1$s_%2$s\" || {\n    echo %1$s_%2$s "
                            "has not been set\n    exit 1\n} 1>&2\n";
                    } else {
                        uVar9 = 1;
                        pcVar4 =
                            "test ${%1$s_%2$s_CT-0} -ge %3$u || {\n    echo "
                            "%1$s_%2$s has not been set\n    exit 1\n} 1>&2\n";
                    }
                } else if (*(ushort *)(iVar15 + 0xc) < 2) {
                    pcVar4 = "test -n \"$%1$s_%2$s\" || {\n    echo %1$s_%2$s "
                             "has not been set\n    exit 1\n} 1>&2\n";
                } else {
                    pcVar4 = "test ${%1$s_%2$s_CT-0} -ge %3$u || {\n    echo "
                             "%1$s_%2$s has not been set\n    exit 1\n} 1>&2\n";
                }
                printf(pcVar4, *(undefined4 *)(param_1 + 0x20),
                       *(int *)(iVar15 + 0x30), uVar9);
            }
        LAB_0009c46c:
            iVar13 = iVar13 + -1;
            iVar15 = iVar15 + 0x40;
        } while (iVar13 != 0);
    }
    fwrite(
        "\n# # # # # # # # # #\n#\n#  END OF AUTOMATED OPTION PROCESSING\n#\n# "
        "# # # # # # # # # -- do not modify this marker --\n",
        1, 0x73, stdout);
    if ((DAT_00118428 == (char *)0x0) || (*DAT_00118428 == '\0')) {
        if ((*(uint *)(genshelloptOptions._68_4_ + 0x50) & 0x20) == 0) {
            printf("\nenv | grep \'^%s_\'\n", *(undefined4 *)(param_1 + 0x20));
        }
    } else {
        fputs(DAT_00118428, stdout);
    }
    fchmod(1, 0x1ed);
    fclose(stdout);
    iVar15 = ferror(stdout);
    if (iVar15 == 0) {
        free(DAT_00118424);
        DAT_0011842c = (char *)0x0;
        DAT_00118428 = (char *)0x0;
        DAT_00118424 = (char *)0x0;
        if (local_2c == __stack_chk_guard) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    /* WARNING: Subroutine does not return */
    FUN_0008e374(*(undefined4 *)(param_1 + 0x1c), option_xlateable_txt._228_4_,
                 option_xlateable_txt._220_4_);
}

ulonglong FUN_0009cbe0(uint param_1, uint param_2)

{
    uint uVar1;
    ulonglong uVar2;

    if (param_2 - 1 == 0) {
        return CONCAT44(param_2, param_1);
    }
    if (param_2 == 0) {
        uVar1 = raise(8);
        return (ulonglong)uVar1;
    }
    if (param_1 <= param_2) {
        return CONCAT44(param_2, (uint)(param_1 == param_2));
    }
    if ((param_2 & param_2 - 1) == 0) {
        return CONCAT44(param_2, param_1 >> (0x1fU - LZCOUNT(param_2) & 0xff));
    }
    /* WARNING: Could not recover jumptable at 0x0009cc10. Too many branches */
    /* WARNING: Treating indirect jump as call */
    uVar2 = (*(code *)(&UNK_0009cc18 +
                       (0x1f - (LZCOUNT(param_2) - LZCOUNT(param_1))) * 0x10))(
        param_1, param_2, 0);
    return uVar2;
}

void FUN_0009ce3c(undefined4 param_1, int param_2)

{
    if (param_2 != 0) {
        FUN_0009cbe0();
        return;
    }
    raise(8);
    return;
}

ulonglong FUN_0009ce58(uint param_1, uint param_2)

{
    uint uVar1;
    uint uVar2;
    uint uVar3;
    ulonglong uVar4;

    if (param_2 == 0) {
        uVar2 = raise(8);
        return (ulonglong)uVar2;
    }
    uVar3 = param_1 ^ param_2;
    uVar2 = param_2;
    if ((int)param_2 < 0) {
        uVar2 = -param_2;
    }
    if (uVar2 - 1 == 0) {
        if ((int)param_2 < 0) {
            param_1 = -param_1;
        }
        return CONCAT44(uVar2, param_1);
    }
    uVar1 = param_1;
    if ((int)param_1 < 0) {
        uVar1 = -param_1;
    }
    if (uVar1 <= uVar2) {
        if (uVar1 < uVar2) {
            param_1 = 0;
        }
        if (uVar1 == uVar2) {
            param_1 = (int)uVar3 >> 0x1f | 1;
        }
        return CONCAT44(uVar2, param_1);
    }
    if ((uVar2 & uVar2 - 1) == 0) {
        uVar1 = uVar1 >> (0x1fU - LZCOUNT(uVar2) & 0xff);
        if ((int)uVar3 < 0) {
            uVar1 = -uVar1;
        }
        return CONCAT44(uVar2, uVar1);
    }
    /* WARNING: Could not recover jumptable at 0x0009ce98. Too many branches */
    /* WARNING: Treating indirect jump as call */
    uVar4 = (*(code *)(&UNK_0009cea0 +
                       (0x1f - (LZCOUNT(uVar2) - LZCOUNT(uVar1))) * 0x10))(0);
    return uVar4;
}

uint FUN_0009ce5e(uint param_1, uint param_2)

{
    uint uVar1;
    uint uVar2;
    uint uVar3;
    char in_NG;

    uVar3 = param_1 ^ param_2;
    uVar1 = param_2;
    if (in_NG != '\0') {
        uVar1 = -param_2;
    }
    if (uVar1 - 1 == 0) {
        if ((int)param_2 < 0) {
            param_1 = -param_1;
        }
        return param_1;
    }
    uVar2 = param_1;
    if ((int)param_1 < 0) {
        uVar2 = -param_1;
    }
    if (uVar2 <= uVar1) {
        if (uVar2 < uVar1) {
            param_1 = 0;
        }
        if (uVar2 == uVar1) {
            param_1 = (int)uVar3 >> 0x1f | 1;
        }
        return param_1;
    }
    if ((uVar1 & uVar1 - 1) == 0) {
        uVar2 = uVar2 >> (0x1fU - LZCOUNT(uVar1) & 0xff);
        if ((int)uVar3 < 0) {
            uVar2 = -uVar2;
        }
        return uVar2;
    }
    /* WARNING: Could not recover jumptable at 0x0009ce98. Too many branches */
    /* WARNING: Treating indirect jump as call */
    uVar1 = (*(code *)(&UNK_0009cea0 +
                       (0x1f - (LZCOUNT(uVar1) - LZCOUNT(uVar2))) * 0x10))(0);
    return uVar1;
}

void FUN_0009d0ec(undefined4 param_1, int param_2)

{
    if (param_2 != 0) {
        FUN_0009ce5e();
        return;
    }
    raise(8);
    return;
}

ulonglong FUN_0009d40c(uint param_1, uint param_2)

{
    byte bVar1;
    uint uVar2;
    uint uVar3;
    uint uVar4;
    int iVar5;
    uint uVar6;
    int iVar7;
    uint uVar8;
    bool bVar9;
    bool bVar10;
    bool bVar11;

    if (param_1 == 0 && param_2 == 0) {
        return CONCAT44(param_2, param_1);
    }
    iVar7 = 0x432;
    uVar8 = param_2 >> 0x16;
    if (uVar8 != 0) {
        iVar7 = 3;
        if (param_2 >> 0x19 != 0) {
            iVar7 = 6;
        }
        if (param_2 >> 0x1c != 0) {
            iVar7 = iVar7 + 3;
        }
        uVar4 = iVar7 - ((int)param_2 >> 0x1f);
        uVar8 = param_1 << (0x20 - uVar4 & 0xff);
        param_1 = param_1 >> (uVar4 & 0xff) | param_2 << (0x20 - uVar4 & 0xff);
        param_2 = param_2 >> (uVar4 & 0xff);
        iVar7 = uVar4 + 0x432;
    }
    if (0xfffff < param_2) {
        if (0x1fffff < param_2) {
            uVar4 = param_2 & 1;
            param_2 = param_2 >> 1;
            bVar1 = (byte)param_1;
            param_1 = (uint)(uVar4 != 0) << 0x1f | param_1 >> 1;
            uVar8 = (uint)(bVar1 & 1) << 0x1f | uVar8 >> 1;
            iVar7 = iVar7 + 1;
            if (0xffbfffff < (uint)(iVar7 * 0x200000)) {
                return 0x7ff0000000000000;
            }
        }
    LAB_0009d220:
        bVar10 = 0x7fffffff < uVar8;
        if (uVar8 == 0x80000000) {
            bVar10 = (param_1 & 1) != 0;
        }
        return CONCAT44(param_2 + iVar7 * 0x100000 +
                            (uint)CARRY4(param_1, (uint)bVar10),
                        param_1 + bVar10);
    }
    bVar9 = (uVar8 & 0x80000000) != 0;
    uVar8 = uVar8 << 1;
    uVar4 = param_1 * 2;
    bVar10 = CARRY4(param_1, param_1);
    param_1 = param_1 * 2 + (uint)bVar9;
    param_2 = param_2 * 2 + (uint)(bVar10 || CARRY4(uVar4, (uint)bVar9));
    iVar7 = iVar7 + -1;
    if ((param_2 & 0x100000) != 0)
        goto LAB_0009d220;
    uVar2 = param_1;
    uVar4 = param_2;
    if (param_2 == 0) {
        uVar2 = 0;
        uVar4 = param_1;
    }
    iVar5 = LZCOUNT(uVar4);
    if (param_2 == 0) {
        iVar5 = iVar5 + 0x20;
    }
    uVar6 = iVar5 - 0xb;
    bVar11 = SBORROW4(uVar6, 0x20);
    uVar3 = iVar5 - 0x2b;
    bVar10 = (int)uVar3 < 0;
    bVar9 = uVar3 == 0;
    if ((int)uVar6 < 0x20) {
        bVar11 = SCARRY4(uVar3, 0xc);
        iVar5 = iVar5 + -0x1f;
        bVar10 = iVar5 < 0;
        bVar9 = iVar5 == 0;
        uVar3 = uVar6;
        if (!bVar9 && bVar10 == bVar11) {
            uVar2 = uVar4 << (uVar6 & 0xff);
            uVar4 = uVar4 >> (0xcU - iVar5 & 0xff);
            goto LAB_0009d298;
        }
    }
    if (bVar9 || bVar10 != bVar11) {
        uVar8 = 0x20 - uVar3;
    }
    uVar4 = uVar4 << (uVar3 & 0xff);
    if (bVar9 || bVar10 != bVar11) {
        uVar4 = uVar4 | uVar2 >> (uVar8 & 0xff);
        uVar2 = uVar2 << (uVar3 & 0xff);
    }
LAB_0009d298:
    if ((int)uVar6 <= iVar7) {
        return CONCAT44(uVar4 + (iVar7 - uVar6) * 0x100000, uVar2);
    }
    uVar8 = ~(iVar7 - uVar6);
    if (0x1e < (int)uVar8) {
        return (ulonglong)(uVar4 >> (uVar8 - 0x1f & 0xff));
    }
    iVar7 = uVar8 - 0x13;
    if (iVar7 == 0 || iVar7 < 0 != SCARRY4(uVar8 - 0x1f, 0xc)) {
        uVar8 = uVar8 + 1;
        return CONCAT44(uVar4 >> (uVar8 & 0xff),
                        uVar2 >> (uVar8 & 0xff) | uVar4
                                                      << (0x20 - uVar8 & 0xff));
    }
    return (ulonglong)(uVar2 >> (0x20 - (0xcU - iVar7) & 0xff) |
                       uVar4 << (0xcU - iVar7 & 0xff));
}

undefined8 FUN_0009d478(int param_1, int param_2, int param_3, int param_4)

{
    int iVar1;
    undefined8 uVar2;
    int local_8;

    if ((param_4 == 0) && (param_3 == 0)) {
        if (param_2 < 0) {
            param_2 = -0x80000000;
        } else if (param_2 != 0 || param_1 != 0) {
            param_2 = 0x7fffffff;
        }
        local_8 = param_2;
        iVar1 = raise(8);
        return CONCAT44(local_8, iVar1);
    }
    if (param_2 < 0) {
        iVar1 = -param_2 - (uint)(param_1 != 0);
        if (param_4 < 0) {
            uVar2 = FUN_0009d5a0(-param_1, iVar1, -param_3,
                                 -param_4 - (uint)(param_3 != 0), &local_8);
            return uVar2;
        }
        uVar2 = FUN_0009d5a0(-param_1, iVar1, param_3, param_4, &local_8);
        return CONCAT44(-(int)((ulonglong)uVar2 >> 0x20) -
                            (uint)((int)uVar2 != 0),
                        -(int)uVar2);
    }
    if (param_4 < 0) {
        uVar2 = FUN_0009d5a0(param_1, param_2, -param_3,
                             -param_4 - (uint)(param_3 != 0), &local_8);
        return CONCAT44(-(int)((ulonglong)uVar2 >> 0x20) -
                            (uint)((int)uVar2 != 0),
                        -(int)uVar2);
    }
    uVar2 = FUN_0009d5a0();
    return uVar2;
}

void FUN_0009d518(undefined4 param_1, undefined4 param_2, int param_3,
                  int param_4)

{
    if ((param_4 == 0) && (param_3 == 0)) {
        raise(8);
        return;
    }
    FUN_0009d5a0();
    return;
}

undefined8 FUN_0009d558(undefined4 param_1, undefined4 param_2)

{
    uint uVar1;
    double dVar2;

    dVar2 = (double)CONCAT44(param_2, param_1) * 2.3283064365386963e-10;
    uVar1 = (uint)(0.0 < dVar2) * (int)(longlong)dVar2;
    dVar2 = (double)CONCAT44(param_2, param_1) - (double)uVar1 * 4294967296.0;
    return CONCAT44(uVar1, (uint)(0.0 < dVar2) * (int)(longlong)dVar2);
}

undefined8 FUN_0009d5a0(uint param_1, uint param_2, uint param_3, uint param_4,
                        uint *param_5)

{
    uint uVar1;
    uint uVar2;
    uint uVar3;
    int iVar4;
    uint uVar5;
    int iVar6;
    uint uVar7;
    uint uVar8;
    uint uVar9;
    bool bVar10;

    bVar10 = param_4 <= param_2;
    if (param_2 == param_4) {
        bVar10 = param_3 <= param_1;
    }
    if (bVar10) {
        iVar6 = LZCOUNT(param_4);
        if (param_4 == 0) {
            iVar6 = LZCOUNT(param_3) + 0x20;
        }
        iVar4 = LZCOUNT(param_2);
        if (param_2 == 0) {
            iVar4 = LZCOUNT(param_1) + 0x20;
        }
        uVar3 = iVar6 - iVar4;
        uVar7 = param_3 << (uVar3 & 0xff);
        uVar8 = param_4 << (uVar3 & 0xff) | param_3 << (uVar3 - 0x20 & 0xff) |
                param_3 >> (0x20 - uVar3 & 0xff);
        bVar10 = uVar8 <= param_2;
        if (param_2 == uVar8) {
            bVar10 = uVar7 <= param_1;
        }
        if (bVar10) {
            bVar10 = param_1 < uVar7;
            param_1 = param_1 - uVar7;
            uVar1 = 1 << (uVar3 & 0xff);
            uVar2 = 1 << (uVar3 - 0x20 & 0xff) | 1U >> (0x20 - uVar3 & 0xff);
            param_2 = (param_2 - uVar8) - (uint)bVar10;
        } else {
            uVar1 = 0;
            uVar2 = 0;
        }
        if (uVar3 != 0) {
            uVar9 = uVar8 >> 1;
            uVar8 = (uint)((uVar8 & 1) != 0) << 0x1f | uVar7 >> 1;
            uVar7 = uVar3;
            do {
                while (true) {
                    bVar10 = uVar9 <= param_2;
                    if (param_2 == uVar9) {
                        bVar10 = uVar8 <= param_1;
                    }
                    if (bVar10)
                        break;
                    bVar10 = CARRY4(param_1, param_1);
                    param_1 = param_1 * 2;
                    param_2 = param_2 * 2 + (uint)bVar10;
                    uVar7 = uVar7 - 1;
                    uVar5 = param_2;
                    if (uVar7 == 0)
                        goto LAB_0009d646;
                }
                bVar10 = param_1 < uVar8;
                uVar5 = param_1 - uVar8;
                param_1 = uVar5 * 2 + 1;
                param_2 = ((param_2 - uVar9) - (uint)bVar10) * 2 +
                          (uint)CARRY4(uVar5, uVar5) +
                          (uint)(0xfffffffe < uVar5 * 2);
                uVar7 = uVar7 - 1;
                uVar5 = param_2;
            } while (uVar7 != 0);
        LAB_0009d646:
            param_2 = uVar5 >> (uVar3 & 0xff);
            bVar10 = CARRY4(uVar1, param_1);
            uVar7 = uVar1 + param_1;
            param_1 = param_1 >> (uVar3 & 0xff) |
                      uVar5 << (0x20 - uVar3 & 0xff) |
                      uVar5 >> (uVar3 - 0x20 & 0xff);
            uVar8 = param_1 << (uVar3 & 0xff);
            uVar1 = uVar7 - uVar8;
            uVar2 =
                ((uVar2 + uVar5 + (uint)bVar10) -
                 (param_2 << (uVar3 & 0xff) | param_1 << (uVar3 - 0x20 & 0xff) |
                  param_1 >> (0x20 - uVar3 & 0xff))) -
                (uint)(uVar7 < uVar8);
        }
    } else {
        uVar1 = 0;
        uVar2 = 0;
    }
    if (param_5 != (uint *)0x0) {
        *param_5 = param_1;
        param_5[1] = param_2;
    }
    return CONCAT44(uVar2, uVar1);
}

void __libc_csu_init(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                     undefined4 param_4)

{
    undefined **ppuVar1;
    int iVar2;

    _DT_INIT();
    iVar2 = 0;
    do {
        ppuVar1 = &__DT_INIT_ARRAY + iVar2;
        iVar2 = iVar2 + 1;
        (*(code *)*ppuVar1)(param_1, param_2, param_3, *ppuVar1, param_4);
    } while (iVar2 != 1);
    return;
}

void __libc_csu_fini(void)

{
    return;
}

void FUN_0009d6fc(undefined4 param_1)

{
    __cxa_atexit(param_1, 0, DAT_000c7004);
    return;
}

void _DT_FINI(void)

{
    return;
}
